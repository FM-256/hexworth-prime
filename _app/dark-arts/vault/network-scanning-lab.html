<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Scanning & Port Analysis Lab - Hexworth Prime Dark Arts</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #a855f7;
            --accent: #dc2626;
            --bg: #0a0a0f;
            --surface: #1a1a2e;
            --surface-light: #252538;
            --text: #e0e0e0;
            --text-dim: #a0a0a0;
            --success: #10b981;
            --warning: #f59e0b;
            --border: #333344;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            background: linear-gradient(135deg, var(--surface) 0%, var(--surface-light) 100%);
            padding: 30px;
            border-radius: 12px;
            border: 2px solid var(--primary);
            margin-bottom: 30px;
            box-shadow: 0 0 30px rgba(168, 85, 247, 0.2);
        }

        h1 {
            color: var(--primary);
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(168, 85, 247, 0.5);
        }

        .subtitle {
            color: var(--text-dim);
            font-size: 1.1em;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: var(--surface-light);
            color: var(--text);
            border: 1px solid var(--border);
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }

        .nav-btn:hover {
            background: var(--primary);
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(168, 85, 247, 0.3);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            background: var(--surface);
            padding: 15px;
            border-radius: 8px;
        }

        .tab-btn {
            background: var(--surface-light);
            color: var(--text);
            border: 1px solid var(--border);
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1em;
        }

        .tab-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.4);
        }

        .tab-btn:hover:not(.active) {
            background: var(--surface);
            border-color: var(--primary);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section {
            background: var(--surface);
            padding: 25px;
            border-radius: 8px;
            border: 1px solid var(--border);
            margin-bottom: 20px;
        }

        h2 {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 1.8em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        h3 {
            color: var(--primary);
            margin: 20px 0 15px 0;
            font-size: 1.3em;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .card {
            background: var(--surface-light);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--border);
            transition: all 0.3s;
        }

        .card:hover {
            border-color: var(--primary);
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.2);
            transform: translateY(-2px);
        }

        .card h4 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .command-builder {
            background: var(--surface-light);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--border);
            margin: 20px 0;
        }

        .builder-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .option-group {
            margin-bottom: 15px;
        }

        .option-group label {
            display: block;
            color: var(--primary);
            margin-bottom: 8px;
            font-weight: 600;
        }

        .option-group select,
        .option-group input {
            width: 100%;
            padding: 10px;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text);
            font-size: 1em;
        }

        .option-group input[type="checkbox"] {
            width: auto;
            margin-right: 10px;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            margin: 5px 0;
        }

        .command-output {
            background: #000;
            padding: 20px;
            border-radius: 6px;
            border: 2px solid var(--primary);
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            color: #00ff00;
            margin-top: 15px;
            word-break: break-all;
            min-height: 60px;
            display: flex;
            align-items: center;
        }

        .handshake-viz {
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 40px 20px;
            background: var(--surface-light);
            border-radius: 8px;
            margin: 20px 0;
            position: relative;
            min-height: 300px;
        }

        .endpoint {
            text-align: center;
            z-index: 2;
        }

        .endpoint-box {
            width: 100px;
            height: 100px;
            background: var(--primary);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            margin-bottom: 10px;
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.5);
        }

        .endpoint-label {
            color: var(--primary);
            font-weight: 600;
            font-size: 1.1em;
        }

        .packet {
            position: absolute;
            padding: 8px 16px;
            background: var(--accent);
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9em;
            opacity: 0;
            box-shadow: 0 0 15px rgba(220, 38, 38, 0.5);
            white-space: nowrap;
        }

        .arrow-container {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
        }

        .port-states {
            display: flex;
            gap: 20px;
            justify-content: space-around;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .port-state {
            text-align: center;
            padding: 20px;
            background: var(--surface-light);
            border-radius: 8px;
            border: 2px solid var(--border);
            min-width: 150px;
            transition: all 0.3s;
        }

        .port-state:hover {
            transform: scale(1.05);
            border-color: var(--primary);
        }

        .port-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .port-state.open .port-icon { color: var(--success); }
        .port-state.closed .port-icon { color: var(--accent); }
        .port-state.filtered .port-icon { color: var(--warning); }

        .flag-bits {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .flag-bit {
            padding: 15px 20px;
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 8px;
            text-align: center;
            min-width: 80px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .flag-bit.active {
            background: var(--primary);
            border-color: var(--primary);
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.5);
            transform: translateY(-5px);
        }

        .flag-bit-label {
            font-weight: 600;
            font-size: 1.2em;
            margin-bottom: 5px;
        }

        .flag-bit-name {
            font-size: 0.9em;
            color: var(--text-dim);
        }

        .scan-type-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .scan-type-card {
            background: var(--surface-light);
            padding: 20px;
            border-radius: 8px;
            border: 2px solid var(--border);
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .scan-type-card:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
        }

        .scan-type-card.selected {
            background: var(--primary);
            border-color: var(--primary);
            box-shadow: 0 0 25px rgba(168, 85, 247, 0.5);
        }

        .scan-type-title {
            font-weight: 600;
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .scan-type-flags {
            color: var(--accent);
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            font-size: 1.1em;
        }

        .ports-reference {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .port-item {
            background: var(--surface-light);
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid var(--primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .port-number {
            font-weight: 600;
            color: var(--primary);
            font-size: 1.2em;
        }

        .port-service {
            color: var(--text-dim);
        }

        .timing-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .timing-table th,
        .timing-table td {
            padding: 12px;
            text-align: left;
            border: 1px solid var(--border);
        }

        .timing-table th {
            background: var(--primary);
            color: var(--bg);
            font-weight: 600;
        }

        .timing-table tr:nth-child(even) {
            background: var(--surface-light);
        }

        .timing-table tr:hover {
            background: rgba(168, 85, 247, 0.1);
        }

        .quiz-container {
            background: var(--surface);
            padding: 25px;
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .question {
            margin-bottom: 30px;
            padding: 20px;
            background: var(--surface-light);
            border-radius: 8px;
            border-left: 4px solid var(--primary);
        }

        .question-text {
            font-size: 1.1em;
            margin-bottom: 15px;
            color: var(--text);
            font-weight: 600;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option {
            padding: 12px 20px;
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option:hover {
            border-color: var(--primary);
            background: var(--surface-light);
        }

        .option.selected {
            border-color: var(--primary);
            background: rgba(168, 85, 247, 0.2);
        }

        .option.correct {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.2);
        }

        .option.incorrect {
            border-color: var(--accent);
            background: rgba(220, 38, 38, 0.2);
        }

        .quiz-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s;
            margin-top: 20px;
        }

        .quiz-btn:hover {
            background: #9333ea;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(168, 85, 247, 0.4);
        }

        .quiz-btn:disabled {
            background: var(--border);
            cursor: not-allowed;
            transform: none;
        }

        .quiz-results {
            background: var(--surface-light);
            padding: 25px;
            border-radius: 8px;
            border: 2px solid var(--primary);
            text-align: center;
            margin-top: 20px;
        }

        .score {
            font-size: 3em;
            color: var(--primary);
            font-weight: 700;
            margin: 20px 0;
            text-shadow: 0 0 20px rgba(168, 85, 247, 0.5);
        }

        .xp-reward {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 20px;
            border-radius: 8px;
            font-size: 1.5em;
            font-weight: 600;
            margin-top: 20px;
            box-shadow: 0 0 30px rgba(168, 85, 247, 0.5);
        }

        .cheat-sheet {
            background: var(--surface-light);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--border);
            margin: 20px 0;
        }

        .cheat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin: 8px 0;
            background: var(--surface);
            border-radius: 6px;
            border-left: 3px solid var(--primary);
        }

        .cheat-command {
            font-family: 'Courier New', monospace;
            color: var(--primary);
            font-weight: 600;
        }

        .cheat-description {
            color: var(--text-dim);
            text-align: right;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: var(--surface);
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
            border: 2px solid var(--border);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.5);
        }

        .copy-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s;
            margin-left: 10px;
        }

        .copy-btn:hover {
            background: #b91c1c;
            transform: scale(1.05);
        }

        .info-box {
            background: rgba(168, 85, 247, 0.1);
            border-left: 4px solid var(--primary);
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }

        .warning-box {
            background: rgba(245, 158, 11, 0.1);
            border-left: 4px solid var(--warning);
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }

        .danger-box {
            background: rgba(220, 38, 38, 0.1);
            border-left: 4px solid var(--accent);
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }

        @keyframes packetMove {
            0% { opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { opacity: 0; }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .animate-pulse {
            animation: pulse 2s infinite;
        }

        code {
            background: var(--surface);
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: var(--primary);
        }

        @media (max-width: 768px) {
            h1 { font-size: 1.8em; }
            .grid { grid-template-columns: 1fr; }
            .tabs { flex-direction: column; }
            .handshake-viz { flex-direction: column; padding: 20px; }
            .port-states { flex-direction: column; }
            .timing-table { font-size: 0.9em; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Network Scanning & Port Analysis Lab</h1>
            <p class="subtitle">Master reconnaissance techniques and Nmap scanning methodologies</p>
            <div class="nav-buttons">
                <a href="../index.html" class="nav-btn">Back to Vault</a>
                <a href="../../index.html" class="nav-btn">Hexworth Prime Home</a>
            </div>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('overview')">Overview</button>
            <button class="tab-btn" onclick="switchTab('scanner')">Interactive Scanner</button>
            <button class="tab-btn" onclick="switchTab('handshake')">TCP Handshake</button>
            <button class="tab-btn" onclick="switchTab('scans')">Scan Types</button>
            <button class="tab-btn" onclick="switchTab('ports')">Common Ports</button>
            <button class="tab-btn" onclick="switchTab('timing')">Timing & Optimization</button>
            <button class="tab-btn" onclick="switchTab('cheatsheet')">Nmap Cheat Sheet</button>
            <button class="tab-btn" onclick="switchTab('quiz')">Knowledge Quiz</button>
        </div>

        <!-- Overview Tab -->
        <div id="overview" class="tab-content active">
            <div class="section">
                <h2>Scanning Fundamentals</h2>
                <p>Network scanning is the systematic process of identifying active hosts, open ports, running services, and operating systems within a target network. It forms the foundation of penetration testing and security assessments.</p>

                <div class="grid">
                    <div class="card">
                        <h4>Host Discovery</h4>
                        <p><strong>Purpose:</strong> Identify live systems on the network</p>
                        <p><strong>Techniques:</strong></p>
                        <ul>
                            <li><code>Ping Sweep</code> - ICMP echo requests</li>
                            <li><code>ARP Scan</code> - Layer 2 discovery (local network)</li>
                            <li><code>TCP SYN Ping</code> - SYN to common ports</li>
                            <li><code>UDP Ping</code> - UDP packets to ports</li>
                        </ul>
                    </div>

                    <div class="card">
                        <h4>Port Scanning</h4>
                        <p><strong>Purpose:</strong> Enumerate open ports and services</p>
                        <p><strong>Port States:</strong></p>
                        <ul>
                            <li><code>Open</code> - Application accepting connections</li>
                            <li><code>Closed</code> - Port accessible but no service</li>
                            <li><code>Filtered</code> - Firewall blocking access</li>
                            <li><code>Unfiltered</code> - Accessible but state unknown</li>
                        </ul>
                    </div>

                    <div class="card">
                        <h4>Service Detection</h4>
                        <p><strong>Purpose:</strong> Identify application versions</p>
                        <p><strong>Methods:</strong></p>
                        <ul>
                            <li><code>Banner Grabbing</code> - Read service banners</li>
                            <li><code>Version Detection</code> - Probe responses analysis</li>
                            <li><code>NSE Scripts</code> - Nmap Scripting Engine</li>
                            <li><code>Signature Matching</code> - Pattern recognition</li>
                        </ul>
                    </div>

                    <div class="card">
                        <h4>OS Fingerprinting</h4>
                        <p><strong>Purpose:</strong> Determine target operating system</p>
                        <p><strong>Techniques:</strong></p>
                        <ul>
                            <li><code>Active</code> - Send probes, analyze responses</li>
                            <li><code>Passive</code> - Observe network traffic</li>
                            <li><code>TTL Analysis</code> - Time-to-live values</li>
                            <li><code>TCP/IP Stack</code> - Implementation details</li>
                        </ul>
                    </div>
                </div>

                <div class="info-box">
                    <strong>CEH Exam Tip:</strong> Understand the difference between TCP connect scans (full handshake, logged) and SYN scans (stealth, half-open). SYN scans are default in Nmap when run with privileges.
                </div>

                <h3>Port States Explained</h3>
                <div class="port-states">
                    <div class="port-state open">
                        <div class="port-icon">‚úì</div>
                        <div><strong>OPEN</strong></div>
                        <p>Application is actively accepting TCP/UDP connections</p>
                    </div>
                    <div class="port-state closed">
                        <div class="port-icon">‚úó</div>
                        <div><strong>CLOSED</strong></div>
                        <p>Port accessible but no application listening</p>
                    </div>
                    <div class="port-state filtered">
                        <div class="port-icon">?</div>
                        <div><strong>FILTERED</strong></div>
                        <p>Firewall/filter blocking probe packets</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interactive Scanner Tab -->
        <div id="scanner" class="tab-content">
            <div class="section">
                <h2>Interactive Nmap Command Builder</h2>
                <p>Build custom Nmap commands by selecting options below. The command will update in real-time.</p>

                <div class="command-builder">
                    <div class="builder-options">
                        <div class="option-group">
                            <label>Target:</label>
                            <input type="text" id="target" value="192.168.1.1" placeholder="IP or hostname">
                        </div>

                        <div class="option-group">
                            <label>Scan Type:</label>
                            <select id="scanType">
                                <option value="-sT">TCP Connect (-sT)</option>
                                <option value="-sS" selected>SYN Stealth (-sS)</option>
                                <option value="-sU">UDP Scan (-sU)</option>
                                <option value="-sF">FIN Scan (-sF)</option>
                                <option value="-sX">XMAS Scan (-sX)</option>
                                <option value="-sN">NULL Scan (-sN)</option>
                                <option value="-sA">ACK Scan (-sA)</option>
                                <option value="-sW">Window Scan (-sW)</option>
                            </select>
                        </div>

                        <div class="option-group">
                            <label>Port Range:</label>
                            <select id="portRange">
                                <option value="">Default (1000 common)</option>
                                <option value="-p-">All ports (1-65535)</option>
                                <option value="-p 1-1024">Well-known (1-1024)</option>
                                <option value="--top-ports 100">Top 100 ports</option>
                                <option value="-p 80,443,8080">Custom (80,443,8080)</option>
                            </select>
                        </div>

                        <div class="option-group">
                            <label>Timing Template:</label>
                            <select id="timing">
                                <option value="">Default (T3)</option>
                                <option value="-T0">Paranoid (T0)</option>
                                <option value="-T1">Sneaky (T1)</option>
                                <option value="-T2">Polite (T2)</option>
                                <option value="-T3">Normal (T3)</option>
                                <option value="-T4">Aggressive (T4)</option>
                                <option value="-T5">Insane (T5)</option>
                            </select>
                        </div>
                    </div>

                    <div class="option-group">
                        <label>Additional Options:</label>
                        <div class="checkbox-group">
                            <input type="checkbox" id="optVersion">
                            <label for="optVersion">Service Version Detection (-sV)</label>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="optOS">
                            <label for="optOS">OS Detection (-O)</label>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="optScript">
                            <label for="optScript">Default Scripts (-sC)</label>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="optVerbose">
                            <label for="optVerbose">Verbose Output (-v)</label>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="optNoResolve">
                            <label for="optNoResolve">No DNS Resolution (-n)</label>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="optNoPing">
                            <label for="optNoPing">Skip Host Discovery (-Pn)</label>
                        </div>
                    </div>

                    <div class="command-output" id="commandOutput">
                        nmap -sS 192.168.1.1
                    </div>
                    <button class="copy-btn" onclick="copyCommand()">Copy Command</button>
                </div>

                <div class="warning-box">
                    <strong>Warning:</strong> Only scan networks and systems you own or have explicit permission to test. Unauthorized scanning may violate laws and policies.
                </div>
            </div>
        </div>

        <!-- TCP Handshake Tab -->
        <div id="handshake" class="tab-content">
            <div class="section">
                <h2>TCP 3-Way Handshake Visualization</h2>
                <p>Understanding the TCP handshake is crucial for comprehending different scan types.</p>

                <h3>Normal Connection (Connect Scan -sT)</h3>
                <div class="handshake-viz" id="handshakeViz">
                    <div class="endpoint">
                        <div class="endpoint-box">üñ•Ô∏è</div>
                        <div class="endpoint-label">Scanner</div>
                    </div>
                    <div class="arrow-container" id="arrowContainer"></div>
                    <div class="endpoint">
                        <div class="endpoint-box">üéØ</div>
                        <div class="endpoint-label">Target</div>
                    </div>
                </div>
                <button class="quiz-btn" onclick="animateHandshake('connect')">Animate Connect Scan</button>
                <button class="quiz-btn" onclick="animateHandshake('syn')">Animate SYN Scan</button>
                <button class="quiz-btn" onclick="animateHandshake('fin')">Animate FIN Scan</button>

                <h3>TCP Flags Explained</h3>
                <div class="flag-bits">
                    <div class="flag-bit" data-flag="SYN">
                        <div class="flag-bit-label">SYN</div>
                        <div class="flag-bit-name">Synchronize</div>
                    </div>
                    <div class="flag-bit" data-flag="ACK">
                        <div class="flag-bit-label">ACK</div>
                        <div class="flag-bit-name">Acknowledge</div>
                    </div>
                    <div class="flag-bit" data-flag="FIN">
                        <div class="flag-bit-label">FIN</div>
                        <div class="flag-bit-name">Finish</div>
                    </div>
                    <div class="flag-bit" data-flag="RST">
                        <div class="flag-bit-label">RST</div>
                        <div class="flag-bit-name">Reset</div>
                    </div>
                    <div class="flag-bit" data-flag="PSH">
                        <div class="flag-bit-label">PSH</div>
                        <div class="flag-bit-name">Push</div>
                    </div>
                    <div class="flag-bit" data-flag="URG">
                        <div class="flag-bit-label">URG</div>
                        <div class="flag-bit-name">Urgent</div>
                    </div>
                </div>

                <div class="grid">
                    <div class="card">
                        <h4>SYN (Synchronize)</h4>
                        <p>Initiates connection. Sent by client to begin TCP handshake. Sequence number synchronization.</p>
                    </div>
                    <div class="card">
                        <h4>ACK (Acknowledge)</h4>
                        <p>Acknowledges receipt of packets. Confirms sequence numbers. Present in all packets after initial SYN.</p>
                    </div>
                    <div class="card">
                        <h4>FIN (Finish)</h4>
                        <p>Gracefully terminates connection. Sender has no more data. Used in FIN scans.</p>
                    </div>
                    <div class="card">
                        <h4>RST (Reset)</h4>
                        <p>Abruptly terminates connection. Error condition or refused connection. Immediate closure.</p>
                    </div>
                    <div class="card">
                        <h4>PSH (Push)</h4>
                        <p>Pushes buffered data to application. Don't wait for buffer to fill. Used in XMAS scans.</p>
                    </div>
                    <div class="card">
                        <h4>URG (Urgent)</h4>
                        <p>Urgent data present. Process immediately. Rarely used. Part of XMAS scans.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Scan Types Tab -->
        <div id="scans" class="tab-content">
            <div class="section">
                <h2>TCP Scan Types Comparison</h2>
                <p>Select a scan type to see its characteristics and flag patterns:</p>

                <div class="scan-type-selector">
                    <div class="scan-type-card" onclick="selectScanType('connect', ['SYN', 'SYN+ACK', 'ACK'])">
                        <div class="scan-type-title">Connect Scan</div>
                        <div class="scan-type-flags">-sT</div>
                        <p>Full 3-way handshake</p>
                        <p><small>Logged, detectable</small></p>
                    </div>

                    <div class="scan-type-card" onclick="selectScanType('syn', ['SYN', 'SYN+ACK', 'RST'])">
                        <div class="scan-type-title">SYN Scan</div>
                        <div class="scan-type-flags">-sS</div>
                        <p>Half-open scan</p>
                        <p><small>Stealth, default</small></p>
                    </div>

                    <div class="scan-type-card" onclick="selectScanType('fin', ['FIN'])">
                        <div class="scan-type-title">FIN Scan</div>
                        <div class="scan-type-flags">-sF</div>
                        <p>Only FIN flag set</p>
                        <p><small>Firewall evasion</small></p>
                    </div>

                    <div class="scan-type-card" onclick="selectScanType('xmas', ['FIN', 'PSH', 'URG'])">
                        <div class="scan-type-title">XMAS Scan</div>
                        <div class="scan-type-flags">-sX</div>
                        <p>FIN+PSH+URG flags</p>
                        <p><small>"Lit up like tree"</small></p>
                    </div>

                    <div class="scan-type-card" onclick="selectScanType('null', ['NONE'])">
                        <div class="scan-type-title">NULL Scan</div>
                        <div class="scan-type-flags">-sN</div>
                        <p>No flags set</p>
                        <p><small>Bypass filters</small></p>
                    </div>

                    <div class="scan-type-card" onclick="selectScanType('ack', ['ACK'])">
                        <div class="scan-type-title">ACK Scan</div>
                        <div class="scan-type-flags">-sA</div>
                        <p>Only ACK flag</p>
                        <p><small>Firewall detection</small></p>
                    </div>
                </div>

                <div id="scanTypeDetails" class="card" style="display:none; margin-top: 20px;">
                    <h4 id="scanDetailTitle"></h4>
                    <div id="scanDetailContent"></div>
                </div>

                <h3>Scan Type Characteristics</h3>
                <table class="timing-table">
                    <thead>
                        <tr>
                            <th>Scan Type</th>
                            <th>Flags</th>
                            <th>Open Response</th>
                            <th>Closed Response</th>
                            <th>Stealth Level</th>
                            <th>Use Case</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Connect (-sT)</strong></td>
                            <td>SYN ‚Üí SYN/ACK ‚Üí ACK</td>
                            <td>Full connection</td>
                            <td>RST</td>
                            <td>Low (logged)</td>
                            <td>No privileges needed</td>
                        </tr>
                        <tr>
                            <td><strong>SYN (-sS)</strong></td>
                            <td>SYN ‚Üí SYN/ACK ‚Üí RST</td>
                            <td>SYN/ACK</td>
                            <td>RST</td>
                            <td>High (half-open)</td>
                            <td>Default, fast</td>
                        </tr>
                        <tr>
                            <td><strong>FIN (-sF)</strong></td>
                            <td>FIN</td>
                            <td>No response</td>
                            <td>RST</td>
                            <td>Very High</td>
                            <td>Firewall bypass</td>
                        </tr>
                        <tr>
                            <td><strong>XMAS (-sX)</strong></td>
                            <td>FIN+PSH+URG</td>
                            <td>No response</td>
                            <td>RST</td>
                            <td>Very High</td>
                            <td>IDS evasion</td>
                        </tr>
                        <tr>
                            <td><strong>NULL (-sN)</strong></td>
                            <td>None</td>
                            <td>No response</td>
                            <td>RST</td>
                            <td>Very High</td>
                            <td>Filter detection</td>
                        </tr>
                        <tr>
                            <td><strong>ACK (-sA)</strong></td>
                            <td>ACK</td>
                            <td>RST (unfiltered)</td>
                            <td>RST (unfiltered)</td>
                            <td>Medium</td>
                            <td>Firewall rules mapping</td>
                        </tr>
                    </tbody>
                </table>

                <div class="danger-box">
                    <strong>Important:</strong> FIN, XMAS, and NULL scans don't work against Windows systems (they respond differently to RFC 793). These are most effective against Unix/Linux systems.
                </div>
            </div>
        </div>

        <!-- Common Ports Tab -->
        <div id="ports" class="tab-content">
            <div class="section">
                <h2>Common Ports Reference</h2>
                <p>Essential ports every penetration tester should know:</p>

                <h3>Well-Known Ports (0-1023)</h3>
                <div class="ports-reference">
                    <div class="port-item"><span class="port-number">20/21</span><span class="port-service">FTP</span></div>
                    <div class="port-item"><span class="port-number">22</span><span class="port-service">SSH</span></div>
                    <div class="port-item"><span class="port-number">23</span><span class="port-service">Telnet</span></div>
                    <div class="port-item"><span class="port-number">25</span><span class="port-service">SMTP</span></div>
                    <div class="port-item"><span class="port-number">53</span><span class="port-service">DNS</span></div>
                    <div class="port-item"><span class="port-number">80</span><span class="port-service">HTTP</span></div>
                    <div class="port-item"><span class="port-number">110</span><span class="port-service">POP3</span></div>
                    <div class="port-item"><span class="port-number">143</span><span class="port-service">IMAP</span></div>
                    <div class="port-item"><span class="port-number">443</span><span class="port-service">HTTPS</span></div>
                    <div class="port-item"><span class="port-number">445</span><span class="port-service">SMB</span></div>
                    <div class="port-item"><span class="port-number">3389</span><span class="port-service">RDP</span></div>
                    <div class="port-item"><span class="port-number">3306</span><span class="port-service">MySQL</span></div>
                </div>

                <h3>Database Ports</h3>
                <div class="ports-reference">
                    <div class="port-item"><span class="port-number">1433</span><span class="port-service">MS SQL</span></div>
                    <div class="port-item"><span class="port-number">1521</span><span class="port-service">Oracle</span></div>
                    <div class="port-item"><span class="port-number">3306</span><span class="port-service">MySQL</span></div>
                    <div class="port-item"><span class="port-number">5432</span><span class="port-service">PostgreSQL</span></div>
                    <div class="port-item"><span class="port-number">27017</span><span class="port-service">MongoDB</span></div>
                    <div class="port-item"><span class="port-number">6379</span><span class="port-service">Redis</span></div>
                </div>

                <h3>Web & Application Ports</h3>
                <div class="ports-reference">
                    <div class="port-item"><span class="port-number">8080</span><span class="port-service">HTTP Alt</span></div>
                    <div class="port-item"><span class="port-number">8443</span><span class="port-service">HTTPS Alt</span></div>
                    <div class="port-item"><span class="port-number">8000</span><span class="port-service">HTTP Dev</span></div>
                    <div class="port-item"><span class="port-number">3000</span><span class="port-service">Node.js</span></div>
                    <div class="port-item"><span class="port-number">5000</span><span class="port-service">Flask</span></div>
                    <div class="port-item"><span class="port-number">9000</span><span class="port-service">PHP-FPM</span></div>
                </div>

                <h3>Security & Admin Ports</h3>
                <div class="ports-reference">
                    <div class="port-item"><span class="port-number">161/162</span><span class="port-service">SNMP</span></div>
                    <div class="port-item"><span class="port-number">389</span><span class="port-service">LDAP</span></div>
                    <div class="port-item"><span class="port-number">636</span><span class="port-service">LDAPS</span></div>
                    <div class="port-item"><span class="port-number">88</span><span class="port-service">Kerberos</span></div>
                    <div class="port-item"><span class="port-number">135</span><span class="port-service">RPC</span></div>
                    <div class="port-item"><span class="port-number">139</span><span class="port-service">NetBIOS</span></div>
                </div>

                <div class="info-box">
                    <strong>Pro Tip:</strong> Use <code>--top-ports 1000</code> to scan the most common 1000 ports quickly, or <code>-p-</code> for a comprehensive scan of all 65535 ports.
                </div>
            </div>
        </div>

        <!-- Timing & Optimization Tab -->
        <div id="timing" class="tab-content">
            <div class="section">
                <h2>Timing Templates & Optimization</h2>
                <p>Nmap provides timing templates to balance speed versus stealth and network load.</p>

                <table class="timing-table">
                    <thead>
                        <tr>
                            <th>Template</th>
                            <th>Name</th>
                            <th>Speed</th>
                            <th>Use Case</th>
                            <th>Detection Risk</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>-T0</strong></td>
                            <td>Paranoid</td>
                            <td>Extremely Slow</td>
                            <td>IDS evasion, one port at a time, 5min delays</td>
                            <td>Very Low</td>
                        </tr>
                        <tr>
                            <td><strong>-T1</strong></td>
                            <td>Sneaky</td>
                            <td>Very Slow</td>
                            <td>IDS evasion, 15 second delays between probes</td>
                            <td>Low</td>
                        </tr>
                        <tr>
                            <td><strong>-T2</strong></td>
                            <td>Polite</td>
                            <td>Slow</td>
                            <td>Reduce network load, less bandwidth consumption</td>
                            <td>Medium-Low</td>
                        </tr>
                        <tr>
                            <td><strong>-T3</strong></td>
                            <td>Normal</td>
                            <td>Normal</td>
                            <td>Default timing, balanced approach</td>
                            <td>Medium</td>
                        </tr>
                        <tr>
                            <td><strong>-T4</strong></td>
                            <td>Aggressive</td>
                            <td>Fast</td>
                            <td>Fast, reliable networks, assumes fast connection</td>
                            <td>Medium-High</td>
                        </tr>
                        <tr>
                            <td><strong>-T5</strong></td>
                            <td>Insane</td>
                            <td>Very Fast</td>
                            <td>Very fast networks, sacrifices accuracy for speed</td>
                            <td>High</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Performance Optimization Techniques</h3>
                <div class="grid">
                    <div class="card">
                        <h4>Port Specification</h4>
                        <p><code>-p 80,443,8080</code> - Specific ports</p>
                        <p><code>-p 1-1024</code> - Port range</p>
                        <p><code>--top-ports 100</code> - Most common ports</p>
                        <p><code>-p-</code> - All 65535 ports</p>
                    </div>

                    <div class="card">
                        <h4>Parallel Scanning</h4>
                        <p><code>--min-hostgroup 256</code> - Scan hosts in parallel</p>
                        <p><code>--min-parallelism 100</code> - Probe parallelization</p>
                        <p><code>--max-parallelism 300</code> - Maximum probes</p>
                    </div>

                    <div class="card">
                        <h4>Timeout Control</h4>
                        <p><code>--host-timeout 30m</code> - Skip slow hosts</p>
                        <p><code>--max-rtt-timeout 100ms</code> - Probe timeout</p>
                        <p><code>--min-rtt-timeout 50ms</code> - Minimum wait</p>
                    </div>

                    <div class="card">
                        <h4>Rate Limiting</h4>
                        <p><code>--max-rate 1000</code> - Max packets/sec</p>
                        <p><code>--min-rate 100</code> - Minimum rate</p>
                        <p><code>--scan-delay 10ms</code> - Delay between probes</p>
                    </div>
                </div>

                <h3>DNS Resolution Control</h3>
                <div class="cheat-sheet">
                    <div class="cheat-item">
                        <span class="cheat-command">-n</span>
                        <span class="cheat-description">Never resolve DNS (faster)</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">-R</span>
                        <span class="cheat-description">Always resolve DNS</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">--dns-servers 8.8.8.8</span>
                        <span class="cheat-description">Custom DNS server</span>
                    </div>
                </div>

                <div class="warning-box">
                    <strong>Performance vs. Accuracy:</strong> Aggressive timing (T4-T5) may miss hosts or ports on slow/congested networks. Use T2-T3 for more reliable results.
                </div>
            </div>
        </div>

        <!-- Cheat Sheet Tab -->
        <div id="cheatsheet" class="tab-content">
            <div class="section">
                <h2>Nmap Command Cheat Sheet</h2>

                <h3>Target Specification</h3>
                <div class="cheat-sheet">
                    <div class="cheat-item">
                        <span class="cheat-command">nmap 192.168.1.1</span>
                        <span class="cheat-description">Scan single IP</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap 192.168.1.1-20</span>
                        <span class="cheat-description">Scan IP range</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap 192.168.1.0/24</span>
                        <span class="cheat-description">Scan subnet (CIDR)</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -iL targets.txt</span>
                        <span class="cheat-description">Scan from file</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap --exclude 192.168.1.1</span>
                        <span class="cheat-description">Exclude host</span>
                    </div>
                </div>

                <h3>Host Discovery</h3>
                <div class="cheat-sheet">
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -sn 192.168.1.0/24</span>
                        <span class="cheat-description">Ping scan (no port scan)</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -Pn 192.168.1.1</span>
                        <span class="cheat-description">Skip ping (assume host up)</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -PS22,80,443 192.168.1.1</span>
                        <span class="cheat-description">TCP SYN ping on ports</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -PA80,443 192.168.1.1</span>
                        <span class="cheat-description">TCP ACK ping</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -PU 192.168.1.1</span>
                        <span class="cheat-description">UDP ping</span>
                    </div>
                </div>

                <h3>Scan Techniques</h3>
                <div class="cheat-sheet">
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -sS 192.168.1.1</span>
                        <span class="cheat-description">SYN scan (stealth)</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -sT 192.168.1.1</span>
                        <span class="cheat-description">TCP connect scan</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -sU 192.168.1.1</span>
                        <span class="cheat-description">UDP scan</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -sA 192.168.1.1</span>
                        <span class="cheat-description">ACK scan (firewall detection)</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -sF 192.168.1.1</span>
                        <span class="cheat-description">FIN scan</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -sX 192.168.1.1</span>
                        <span class="cheat-description">XMAS scan</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -sN 192.168.1.1</span>
                        <span class="cheat-description">NULL scan</span>
                    </div>
                </div>

                <h3>Service & Version Detection</h3>
                <div class="cheat-sheet">
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -sV 192.168.1.1</span>
                        <span class="cheat-description">Version detection</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -sV --version-intensity 5</span>
                        <span class="cheat-description">Aggressive version (0-9)</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -O 192.168.1.1</span>
                        <span class="cheat-description">OS detection</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -A 192.168.1.1</span>
                        <span class="cheat-description">Aggressive (OS, version, scripts)</span>
                    </div>
                </div>

                <h3>NSE Scripts</h3>
                <div class="cheat-sheet">
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -sC 192.168.1.1</span>
                        <span class="cheat-description">Default scripts</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap --script vuln 192.168.1.1</span>
                        <span class="cheat-description">Vulnerability scripts</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap --script http-* 192.168.1.1</span>
                        <span class="cheat-description">All HTTP scripts</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap --script-help http-enum</span>
                        <span class="cheat-description">Script help</span>
                    </div>
                </div>

                <h3>Output Formats</h3>
                <div class="cheat-sheet">
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -oN output.txt</span>
                        <span class="cheat-description">Normal output</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -oX output.xml</span>
                        <span class="cheat-description">XML output</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -oG output.grep</span>
                        <span class="cheat-description">Grepable output</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -oA output</span>
                        <span class="cheat-description">All formats</span>
                    </div>
                </div>

                <h3>Firewall/IDS Evasion</h3>
                <div class="cheat-sheet">
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -f 192.168.1.1</span>
                        <span class="cheat-description">Fragment packets</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -D RND:10 192.168.1.1</span>
                        <span class="cheat-description">Decoy scan (10 decoys)</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -S 192.168.1.5 192.168.1.1</span>
                        <span class="cheat-description">Spoof source IP</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap --source-port 53</span>
                        <span class="cheat-description">Spoof source port</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap --data-length 25</span>
                        <span class="cheat-description">Append random data</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap --badsum 192.168.1.1</span>
                        <span class="cheat-description">Bad checksum (firewall test)</span>
                    </div>
                </div>

                <h3>Common Combinations</h3>
                <div class="cheat-sheet">
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -sS -sV -O -T4 192.168.1.1</span>
                        <span class="cheat-description">Fast comprehensive scan</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -p- -T4 -A -v 192.168.1.1</span>
                        <span class="cheat-description">Full aggressive scan</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -sU -sS --top-ports 20 -T4</span>
                        <span class="cheat-description">Quick TCP+UDP top ports</span>
                    </div>
                    <div class="cheat-item">
                        <span class="cheat-command">nmap -sS -sV --script=vuln -T4</span>
                        <span class="cheat-description">Vulnerability scan</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quiz Tab -->
        <div id="quiz" class="tab-content">
            <div class="section">
                <h2>Network Scanning Knowledge Assessment</h2>
                <p>Test your understanding of network scanning concepts and Nmap techniques.</p>

                <div class="progress-bar">
                    <div class="progress-fill" id="quizProgress" style="width: 0%;">0/12</div>
                </div>

                <div class="quiz-container" id="quizContainer">
                    <!-- Questions will be generated by JavaScript -->
                </div>

                <button class="quiz-btn" id="submitQuiz" onclick="submitQuiz()" disabled>Submit Quiz</button>

                <div id="quizResults" style="display:none;">
                    <div class="quiz-results">
                        <h3>Assessment Complete!</h3>
                        <div class="score" id="finalScore">0/12</div>
                        <p id="scoreMessage"></p>
                        <div class="xp-reward" id="xpReward" style="display:none;">
                            +75 XP Earned!
                        </div>
                        <button class="quiz-btn" onclick="resetQuiz()">Retake Quiz</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab switching functionality
        function switchTab(tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-btn');

            tabs.forEach(tab => tab.classList.remove('active'));
            buttons.forEach(btn => btn.classList.remove('active'));

            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Command builder functionality
        function updateCommand() {
            const target = document.getElementById('target').value || '192.168.1.1';
            const scanType = document.getElementById('scanType').value;
            const portRange = document.getElementById('portRange').value;
            const timing = document.getElementById('timing').value;

            const optVersion = document.getElementById('optVersion').checked;
            const optOS = document.getElementById('optOS').checked;
            const optScript = document.getElementById('optScript').checked;
            const optVerbose = document.getElementById('optVerbose').checked;
            const optNoResolve = document.getElementById('optNoResolve').checked;
            const optNoPing = document.getElementById('optNoPing').checked;

            let command = 'nmap';

            if (scanType) command += ' ' + scanType;
            if (portRange) command += ' ' + portRange;
            if (timing) command += ' ' + timing;
            if (optVersion) command += ' -sV';
            if (optOS) command += ' -O';
            if (optScript) command += ' -sC';
            if (optVerbose) command += ' -v';
            if (optNoResolve) command += ' -n';
            if (optNoPing) command += ' -Pn';

            command += ' ' + target;

            document.getElementById('commandOutput').textContent = command;
        }

        // Initialize command builder listeners
        document.addEventListener('DOMContentLoaded', function() {
            const inputs = ['target', 'scanType', 'portRange', 'timing'];
            inputs.forEach(id => {
                document.getElementById(id).addEventListener('input', updateCommand);
                document.getElementById(id).addEventListener('change', updateCommand);
            });

            const checkboxes = ['optVersion', 'optOS', 'optScript', 'optVerbose', 'optNoResolve', 'optNoPing'];
            checkboxes.forEach(id => {
                document.getElementById(id).addEventListener('change', updateCommand);
            });

            updateCommand();
            initializeQuiz();
        });

        function copyCommand() {
            const command = document.getElementById('commandOutput').textContent;
            navigator.clipboard.writeText(command).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = 'Copied!';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 2000);
            });
        }

        // TCP Handshake Animation
        function animateHandshake(type) {
            const container = document.getElementById('arrowContainer');
            container.innerHTML = '';

            const sequences = {
                connect: [
                    { text: 'SYN', start: 20, end: 80, delay: 0 },
                    { text: 'SYN/ACK', start: 80, end: 20, delay: 1000 },
                    { text: 'ACK', start: 20, end: 80, delay: 2000 },
                    { text: 'Connection Established', start: 50, end: 50, delay: 3000, color: '#10b981' }
                ],
                syn: [
                    { text: 'SYN', start: 20, end: 80, delay: 0 },
                    { text: 'SYN/ACK', start: 80, end: 20, delay: 1000 },
                    { text: 'RST', start: 20, end: 80, delay: 2000 },
                    { text: 'Port Open (Half-Open)', start: 50, end: 50, delay: 3000, color: '#10b981' }
                ],
                fin: [
                    { text: 'FIN', start: 20, end: 80, delay: 0 },
                    { text: 'No Response', start: 50, end: 50, delay: 1500, color: '#f59e0b' },
                    { text: 'Port Open/Filtered', start: 50, end: 50, delay: 2500, color: '#10b981' }
                ]
            };

            const seq = sequences[type];
            seq.forEach(packet => {
                setTimeout(() => {
                    const packetEl = document.createElement('div');
                    packetEl.className = 'packet';
                    packetEl.textContent = packet.text;
                    packetEl.style.left = packet.start + '%';
                    packetEl.style.top = '45%';
                    if (packet.color) packetEl.style.background = packet.color;

                    container.appendChild(packetEl);

                    setTimeout(() => {
                        packetEl.style.opacity = '1';
                        if (packet.start !== packet.end) {
                            packetEl.style.transition = 'left 0.8s ease-in-out';
                            packetEl.style.left = packet.end + '%';
                        }
                    }, 50);

                    setTimeout(() => {
                        packetEl.style.opacity = '0';
                        setTimeout(() => packetEl.remove(), 300);
                    }, packet.start === packet.end ? 2000 : 1000);
                }, packet.delay);
            });
        }

        // Scan type selection
        function selectScanType(type, flags) {
            // Remove previous selection
            document.querySelectorAll('.scan-type-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');

            // Reset all flag bits
            document.querySelectorAll('.flag-bit').forEach(bit => {
                bit.classList.remove('active');
            });

            // Activate relevant flags
            flags.forEach(flag => {
                if (flag === 'SYN+ACK') {
                    document.querySelector('[data-flag="SYN"]').classList.add('active');
                    document.querySelector('[data-flag="ACK"]').classList.add('active');
                } else if (flag !== 'NONE') {
                    const flagEl = document.querySelector(`[data-flag="${flag}"]`);
                    if (flagEl) flagEl.classList.add('active');
                }
            });

            // Show details
            const details = {
                connect: {
                    title: 'TCP Connect Scan (-sT)',
                    content: `<p><strong>How it works:</strong> Completes full TCP 3-way handshake (SYN ‚Üí SYN/ACK ‚Üí ACK).</p>
                             <p><strong>Pros:</strong> Works without root privileges, most reliable.</p>
                             <p><strong>Cons:</strong> Logged by target systems, slower, easily detected.</p>
                             <p><strong>When to use:</strong> When you don't have raw socket privileges or need guaranteed accuracy.</p>`
                },
                syn: {
                    title: 'SYN Stealth Scan (-sS)',
                    content: `<p><strong>How it works:</strong> Sends SYN, receives SYN/ACK, then sends RST instead of ACK.</p>
                             <p><strong>Pros:</strong> Stealthy (half-open), fast, requires privileges.</p>
                             <p><strong>Cons:</strong> Requires root/admin, can crash unstable services.</p>
                             <p><strong>When to use:</strong> Default scan, best balance of speed and stealth.</p>`
                },
                fin: {
                    title: 'FIN Scan (-sF)',
                    content: `<p><strong>How it works:</strong> Sends packet with only FIN flag set.</p>
                             <p><strong>Pros:</strong> Can bypass non-stateful firewalls, stealthy.</p>
                             <p><strong>Cons:</strong> Doesn't work on Windows, less reliable.</p>
                             <p><strong>When to use:</strong> Evading simple packet filters, Unix/Linux targets.</p>`
                },
                xmas: {
                    title: 'XMAS Scan (-sX)',
                    content: `<p><strong>How it works:</strong> Sets FIN, PSH, and URG flags (packet "lit up like Christmas tree").</p>
                             <p><strong>Pros:</strong> Can evade some firewalls, very distinctive.</p>
                             <p><strong>Cons:</strong> Doesn't work on Windows, easily detected by modern IDS.</p>
                             <p><strong>When to use:</strong> Testing firewall rules, Unix/Linux systems.</p>`
                },
                null: {
                    title: 'NULL Scan (-sN)',
                    content: `<p><strong>How it works:</strong> Sends packet with no flags set.</p>
                             <p><strong>Pros:</strong> Can bypass some firewalls, minimal footprint.</p>
                             <p><strong>Cons:</strong> Doesn't work on Windows, unreliable results.</p>
                             <p><strong>When to use:</strong> Firewall testing, stealth scanning Unix/Linux.</p>`
                },
                ack: {
                    title: 'ACK Scan (-sA)',
                    content: `<p><strong>How it works:</strong> Sends packet with only ACK flag set.</p>
                             <p><strong>Pros:</strong> Maps firewall rules, determines if filtered.</p>
                             <p><strong>Cons:</strong> Cannot determine open ports, only filtered vs unfiltered.</p>
                             <p><strong>When to use:</strong> Firewall rule mapping, determining filtering.</p>`
                }
            };

            const detailsBox = document.getElementById('scanTypeDetails');
            const detailsTitle = document.getElementById('scanDetailTitle');
            const detailsContent = document.getElementById('scanDetailContent');

            detailsTitle.textContent = details[type].title;
            detailsContent.innerHTML = details[type].content;
            detailsBox.style.display = 'block';
        }

        // Quiz functionality
        const quizQuestions = [
            {
                question: "Which Nmap scan type completes the full TCP 3-way handshake?",
                options: [
                    "SYN Scan (-sS)",
                    "Connect Scan (-sT)",
                    "FIN Scan (-sF)",
                    "ACK Scan (-sA)"
                ],
                correct: 1
            },
            {
                question: "What is the primary advantage of a SYN scan over a Connect scan?",
                options: [
                    "Works without root privileges",
                    "More stealthy (half-open connection)",
                    "Works on all operating systems",
                    "Provides more accurate results"
                ],
                correct: 1
            },
            {
                question: "Which flags are set in an XMAS scan?",
                options: [
                    "SYN, ACK, RST",
                    "FIN, PSH, URG",
                    "SYN, FIN, ACK",
                    "All flags"
                ],
                correct: 1
            },
            {
                question: "What port state indicates a firewall is blocking the probe?",
                options: [
                    "Open",
                    "Closed",
                    "Filtered",
                    "Unfiltered"
                ],
                correct: 2
            },
            {
                question: "Which timing template is the fastest?",
                options: [
                    "T3 (Normal)",
                    "T4 (Aggressive)",
                    "T5 (Insane)",
                    "T0 (Paranoid)"
                ],
                correct: 2
            },
            {
                question: "What Nmap option enables OS detection?",
                options: [
                    "-sV",
                    "-O",
                    "-A",
                    "-sC"
                ],
                correct: 1
            },
            {
                question: "Which scan type is used primarily for firewall rule mapping?",
                options: [
                    "SYN Scan",
                    "Connect Scan",
                    "ACK Scan",
                    "UDP Scan"
                ],
                correct: 2
            },
            {
                question: "What response indicates an open port in a SYN scan?",
                options: [
                    "RST",
                    "SYN/ACK",
                    "No response",
                    "FIN"
                ],
                correct: 1
            },
            {
                question: "Which option scans all 65535 ports?",
                options: [
                    "-p 1-65535",
                    "-p-",
                    "--all-ports",
                    "Both A and B"
                ],
                correct: 3
            },
            {
                question: "FIN, XMAS, and NULL scans typically don't work against which OS?",
                options: [
                    "Linux",
                    "Unix",
                    "Windows",
                    "macOS"
                ],
                correct: 2
            },
            {
                question: "What does the -Pn option do?",
                options: [
                    "Perform ping scan only",
                    "Skip host discovery (assume host is up)",
                    "Use ICMP ping",
                    "Parallel scanning"
                ],
                correct: 1
            },
            {
                question: "Which Nmap option enables service version detection?",
                options: [
                    "-sS",
                    "-sV",
                    "-O",
                    "-sC"
                ],
                correct: 1
            }
        ];

        let selectedAnswers = new Array(quizQuestions.length).fill(null);

        function initializeQuiz() {
            const container = document.getElementById('quizContainer');
            container.innerHTML = '';

            quizQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.innerHTML = `
                    <div class="question-text">${index + 1}. ${q.question}</div>
                    <div class="options">
                        ${q.options.map((option, optIndex) => `
                            <div class="option" onclick="selectAnswer(${index}, ${optIndex})">
                                ${option}
                            </div>
                        `).join('')}
                    </div>
                `;
                container.appendChild(questionDiv);
            });
        }

        function selectAnswer(questionIndex, optionIndex) {
            selectedAnswers[questionIndex] = optionIndex;

            const question = document.querySelectorAll('.question')[questionIndex];
            const options = question.querySelectorAll('.option');

            options.forEach((opt, idx) => {
                opt.classList.remove('selected');
                if (idx === optionIndex) {
                    opt.classList.add('selected');
                }
            });

            updateQuizProgress();

            // Enable submit button if all questions answered
            const allAnswered = selectedAnswers.every(ans => ans !== null);
            document.getElementById('submitQuiz').disabled = !allAnswered;
        }

        function updateQuizProgress() {
            const answered = selectedAnswers.filter(ans => ans !== null).length;
            const progress = (answered / quizQuestions.length) * 100;
            const progressBar = document.getElementById('quizProgress');
            progressBar.style.width = progress + '%';
            progressBar.textContent = `${answered}/${quizQuestions.length}`;
        }

        function submitQuiz() {
            let score = 0;

            quizQuestions.forEach((q, index) => {
                const question = document.querySelectorAll('.question')[index];
                const options = question.querySelectorAll('.option');

                options.forEach((opt, optIndex) => {
                    opt.classList.remove('selected');

                    if (optIndex === q.correct) {
                        opt.classList.add('correct');
                    } else if (optIndex === selectedAnswers[index]) {
                        opt.classList.add('incorrect');
                    }
                });

                if (selectedAnswers[index] === q.correct) {
                    score++;
                }
            });

            // Display results
            const resultsDiv = document.getElementById('quizResults');
            const scoreDiv = document.getElementById('finalScore');
            const messageDiv = document.getElementById('scoreMessage');
            const xpDiv = document.getElementById('xpReward');

            scoreDiv.textContent = `${score}/${quizQuestions.length}`;

            const percentage = (score / quizQuestions.length) * 100;
            let message = '';

            if (percentage >= 90) {
                message = 'Outstanding! You have mastered network scanning concepts!';
                xpDiv.style.display = 'block';
            } else if (percentage >= 75) {
                message = 'Excellent work! You have a strong understanding of network scanning.';
                xpDiv.style.display = 'block';
            } else if (percentage >= 60) {
                message = 'Good job! Review the areas you missed to strengthen your knowledge.';
                xpDiv.style.display = 'none';
            } else {
                message = 'Keep practicing! Review the course materials and try again.';
                xpDiv.style.display = 'none';
            }

            messageDiv.textContent = message;
            resultsDiv.style.display = 'block';
            document.getElementById('submitQuiz').style.display = 'none';

            // Scroll to results
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function resetQuiz() {
            selectedAnswers = new Array(quizQuestions.length).fill(null);
            document.getElementById('quizResults').style.display = 'none';
            document.getElementById('submitQuiz').style.display = 'block';
            document.getElementById('submitQuiz').disabled = true;
            updateQuizProgress();

            const questions = document.querySelectorAll('.question');
            questions.forEach(question => {
                const options = question.querySelectorAll('.option');
                options.forEach(opt => {
                    opt.classList.remove('selected', 'correct', 'incorrect');
                });
            });

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
<script src="../../components/FluxCapacitor.js"></script>
</body>
</html>