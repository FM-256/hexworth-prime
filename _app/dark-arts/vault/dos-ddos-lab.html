<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DoS/DDoS Attacks Lab - Hexworth Prime Dark Arts</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #a855f7;
            --accent: #dc2626;
            --bg: #0a0a0f;
            --surface: #1a1a2e;
            --surface-light: #252538;
            --text: #e0e0e0;
            --text-dim: #a0a0a0;
            --success: #10b981;
            --warning: #f59e0b;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, var(--surface) 0%, var(--surface-light) 100%);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 2px solid var(--primary);
            box-shadow: 0 0 30px rgba(168, 85, 247, 0.3);
        }

        h1 {
            color: var(--primary);
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(168, 85, 247, 0.5);
        }

        h2 {
            color: var(--primary);
            font-size: 1.8em;
            margin: 30px 0 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
        }

        h3 {
            color: var(--accent);
            font-size: 1.4em;
            margin: 20px 0 10px;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .btn {
            padding: 12px 24px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }

        .btn:hover {
            background: #9333ea;
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(168, 85, 247, 0.4);
        }

        .btn-secondary {
            background: var(--surface-light);
            border: 2px solid var(--primary);
        }

        .btn-secondary:hover {
            background: var(--surface);
        }

        .section {
            background: var(--surface);
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            border: 1px solid var(--primary);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 10px 20px;
            background: var(--surface-light);
            color: var(--text);
            border: 2px solid transparent;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .attack-simulator {
            background: var(--bg);
            border: 2px solid var(--accent);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .network-canvas {
            width: 100%;
            height: 400px;
            background: #000;
            border-radius: 8px;
            border: 1px solid var(--primary);
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .control-group label {
            color: var(--text-dim);
            font-size: 0.9em;
        }

        select, input[type="range"] {
            padding: 8px;
            background: var(--surface-light);
            color: var(--text);
            border: 1px solid var(--primary);
            border-radius: 5px;
            cursor: pointer;
        }

        input[type="range"] {
            width: 200px;
        }

        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .metric-card {
            background: var(--surface-light);
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid var(--primary);
        }

        .metric-label {
            color: var(--text-dim);
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .metric-value {
            font-size: 1.5em;
            font-weight: bold;
            color: var(--primary);
        }

        .meter {
            width: 100%;
            height: 20px;
            background: var(--surface);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 8px;
        }

        .meter-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success), var(--warning), var(--accent));
            transition: width 0.3s;
            border-radius: 10px;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .attack-card {
            background: var(--surface-light);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid var(--primary);
            transition: all 0.3s;
        }

        .attack-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(168, 85, 247, 0.3);
        }

        .attack-type {
            color: var(--accent);
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .attack-details {
            color: var(--text-dim);
            font-size: 0.95em;
            line-height: 1.8;
        }

        .botnet-viz {
            background: var(--bg);
            border: 2px solid var(--primary);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .botnet-canvas {
            width: 100%;
            height: 450px;
            background: #000;
            border-radius: 8px;
        }

        .timeline {
            position: relative;
            padding: 20px 0;
        }

        .timeline-item {
            position: relative;
            padding: 20px;
            background: var(--surface-light);
            border-left: 4px solid var(--accent);
            margin-bottom: 20px;
            border-radius: 8px;
        }

        .timeline-date {
            color: var(--accent);
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 8px;
        }

        .timeline-title {
            color: var(--primary);
            font-size: 1.2em;
            margin-bottom: 8px;
        }

        .timeline-desc {
            color: var(--text-dim);
            line-height: 1.6;
        }

        .flowchart {
            background: var(--surface-light);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .flowchart-canvas {
            width: 100%;
            height: 500px;
            background: var(--bg);
            border-radius: 8px;
            border: 1px solid var(--primary);
        }

        .tool-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .tool-item {
            background: var(--surface-light);
            padding: 15px;
            border-radius: 8px;
            border-left: 3px solid var(--accent);
        }

        .tool-name {
            color: var(--primary);
            font-weight: bold;
            margin-bottom: 5px;
        }

        .tool-desc {
            color: var(--text-dim);
            font-size: 0.9em;
        }

        .defense-demo {
            background: var(--bg);
            border: 2px solid var(--success);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .defense-canvas {
            width: 100%;
            height: 350px;
            background: #000;
            border-radius: 8px;
        }

        .quiz {
            background: var(--surface);
            padding: 25px;
            border-radius: 12px;
            margin-top: 30px;
            border: 2px solid var(--primary);
        }

        .question {
            background: var(--surface-light);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
        }

        .question.active {
            display: block;
        }

        .question-text {
            color: var(--text);
            font-size: 1.1em;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option {
            padding: 12px 18px;
            background: var(--surface);
            border: 2px solid var(--primary);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option:hover {
            background: var(--surface-light);
            transform: translateX(5px);
        }

        .option.selected {
            background: var(--primary);
            color: white;
        }

        .option.correct {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        .option.incorrect {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }

        .quiz-nav {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .quiz-progress {
            text-align: center;
            color: var(--text-dim);
            margin-bottom: 20px;
        }

        .score-display {
            text-align: center;
            padding: 30px;
            background: var(--surface-light);
            border-radius: 10px;
            margin-top: 20px;
        }

        .score-value {
            font-size: 3em;
            color: var(--primary);
            font-weight: bold;
        }

        .xp-reward {
            background: linear-gradient(135deg, var(--success), var(--primary));
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
            font-size: 1.3em;
            font-weight: bold;
        }

        .info-box {
            background: var(--surface-light);
            border-left: 4px solid var(--warning);
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .info-box.danger {
            border-left-color: var(--accent);
        }

        .info-box.success {
            border-left-color: var(--success);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .attacking {
            animation: pulse 1s infinite;
        }

        @media (max-width: 768px) {
            h1 { font-size: 1.8em; }
            h2 { font-size: 1.4em; }
            .comparison-grid,
            .tool-list {
                grid-template-columns: 1fr;
            }
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            input[type="range"] {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>DoS/DDoS Attacks Laboratory</h1>
            <p>Understanding Denial of Service and Distributed Denial of Service attack vectors, architectures, and countermeasures</p>
        </header>

        <div class="nav-buttons">
            <a href="../index.html" class="btn btn-secondary">Back to Vault</a>
            <button class="btn" onclick="scrollToQuiz()">Jump to Quiz</button>
        </div>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('fundamentals')">Fundamentals</button>
            <button class="tab-btn" onclick="switchTab('attacks')">Attack Types</button>
            <button class="tab-btn" onclick="switchTab('simulator')">Attack Simulator</button>
            <button class="tab-btn" onclick="switchTab('botnet')">Botnet Architecture</button>
            <button class="tab-btn" onclick="switchTab('defense')">Defense Mechanisms</button>
            <button class="tab-btn" onclick="switchTab('history')">Historical Attacks</button>
        </div>

        <!-- FUNDAMENTALS TAB -->
        <div id="fundamentals" class="tab-content active">
            <div class="section">
                <h2>DoS vs DDoS: Core Concepts</h2>

                <div class="comparison-grid">
                    <div class="attack-card">
                        <div class="attack-type">DoS (Denial of Service)</div>
                        <div class="attack-details">
                            <strong>Single Source Attack</strong><br>
                            Origin: One attacking system<br>
                            Bandwidth: Limited to attacker's connection<br>
                            Mitigation: Relatively easier to block<br>
                            Detection: Single IP pattern<br>
                            Example: Single server sending SYN floods
                        </div>
                    </div>

                    <div class="attack-card">
                        <div class="attack-type">DDoS (Distributed Denial of Service)</div>
                        <div class="attack-details">
                            <strong>Multi-Source Attack</strong><br>
                            Origin: Thousands of zombie machines<br>
                            Bandwidth: Massive aggregate capacity<br>
                            Mitigation: Complex filtering required<br>
                            Detection: Distributed IP patterns<br>
                            Example: Botnet coordinated assault
                        </div>
                    </div>
                </div>

                <h3>Attack Categories</h3>
                <div class="info-box">
                    <strong>Volume-Based Attacks:</strong> Consume bandwidth through sheer packet volume (measured in Gbps/Tbps)
                </div>
                <div class="info-box danger">
                    <strong>Protocol Attacks:</strong> Exploit protocol vulnerabilities to exhaust server resources (measured in packets/second)
                </div>
                <div class="info-box success">
                    <strong>Application Layer Attacks:</strong> Target web applications with seemingly legitimate requests (measured in requests/second)
                </div>
            </div>

            <div class="section">
                <h2>Attack Objectives</h2>
                <ul style="line-height: 2; color: var(--text-dim); padding-left: 30px;">
                    <li><strong>Service Disruption:</strong> Make legitimate services unavailable to users</li>
                    <li><strong>Resource Exhaustion:</strong> Consume bandwidth, CPU, memory, or connections</li>
                    <li><strong>Distraction:</strong> Hide other malicious activities during chaos</li>
                    <li><strong>Extortion:</strong> Demand ransom to stop the attack</li>
                    <li><strong>Competitive Sabotage:</strong> Damage business rivals</li>
                    <li><strong>Political Statement:</strong> Hacktivism and protest</li>
                </ul>
            </div>
        </div>

        <!-- ATTACK TYPES TAB -->
        <div id="attacks" class="tab-content">
            <div class="section">
                <h2>Volumetric Attacks</h2>
                <p style="color: var(--text-dim); margin-bottom: 20px;">Overwhelm network bandwidth with massive traffic volume</p>

                <div class="tool-list">
                    <div class="tool-item">
                        <div class="tool-name">UDP Flood</div>
                        <div class="tool-desc">Sends massive UDP packets to random ports, forcing ICMP "destination unreachable" responses</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">ICMP Flood (Ping Flood)</div>
                        <div class="tool-desc">Overwhelms target with ICMP Echo Request packets faster than it can respond</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">Ping of Death</div>
                        <div class="tool-desc">Sends malformed or oversized ping packets exceeding maximum IP packet size (65,535 bytes)</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">Smurf Attack</div>
                        <div class="tool-desc">Spoofs victim's IP and broadcasts ICMP to network, causing all hosts to reply to victim</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">Pulse Wave</div>
                        <div class="tool-desc">Alternating bursts of high-volume traffic to evade detection thresholds</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">DNS/NTP Amplification</div>
                        <div class="tool-desc">Exploits public servers to amplify attack traffic 50-200x using spoofed requests</div>
                    </div>
                </div>

                <h2>Protocol Attacks</h2>
                <p style="color: var(--text-dim); margin-bottom: 20px;">Exploit weaknesses in network protocol stack to exhaust server resources</p>

                <div class="tool-list">
                    <div class="tool-item">
                        <div class="tool-name">SYN Flood</div>
                        <div class="tool-desc">Sends TCP SYN packets without completing handshake, exhausting connection table</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">ACK Flood</div>
                        <div class="tool-desc">Sends ACK packets to overwhelm firewall state tables and processing</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">Fragmentation Attack</div>
                        <div class="tool-desc">Sends fragmented packets that consume resources during reassembly</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">RST Attack</div>
                        <div class="tool-desc">Injects RST packets to terminate legitimate TCP connections</div>
                    </div>
                </div>

                <h2>Application Layer Attacks</h2>
                <p style="color: var(--text-dim); margin-bottom: 20px;">Target web applications with seemingly legitimate but resource-intensive requests</p>

                <div class="tool-list">
                    <div class="tool-item">
                        <div class="tool-name">Slowloris</div>
                        <div class="tool-desc">Opens many HTTP connections and sends partial requests very slowly to exhaust connection pool</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">HTTP Flood</div>
                        <div class="tool-desc">Sends legitimate-looking HTTP GET/POST requests at high rate to overwhelm web server</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">Slow Read Attack</div>
                        <div class="tool-desc">Reads server responses extremely slowly to keep connections open indefinitely</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">Hash Collision</div>
                        <div class="tool-desc">Exploits hash table algorithms with crafted input causing CPU exhaustion</div>
                    </div>
                </div>

                <h2>Advanced Attack Techniques</h2>
                <div class="attack-card" style="margin: 20px 0;">
                    <div class="attack-type">Multi-Vector Attacks</div>
                    <div class="attack-details">
                        Combines volumetric, protocol, and application layer attacks simultaneously to overwhelm multiple defense layers. Example: SYN flood + HTTP flood + DNS amplification occurring concurrently makes mitigation extremely difficult.
                    </div>
                </div>

                <div class="attack-card" style="margin: 20px 0;">
                    <div class="attack-type">Permanent DoS (PDoS/Phlashing)</div>
                    <div class="attack-details">
                        Damages hardware so severely it requires replacement. Exploits firmware vulnerabilities to "brick" devices (routers, IoT devices). Also called "phlashing" - corrupting firmware beyond repair.
                    </div>
                </div>

                <div class="attack-card" style="margin: 20px 0;">
                    <div class="attack-type">Reflected/DRDoS Attacks</div>
                    <div class="attack-details">
                        Uses third-party servers as reflectors to hide attack source. Attacker spoofs victim's IP and sends requests to public servers (DNS, NTP, SNMP) which respond to victim. Provides anonymity and amplification.
                    </div>
                </div>
            </div>
        </div>

        <!-- ATTACK SIMULATOR TAB -->
        <div id="simulator" class="tab-content">
            <div class="section">
                <h2>Interactive Attack Simulator</h2>
                <p style="color: var(--text-dim); margin-bottom: 20px;">Visualize different DDoS attack patterns and their impact on network infrastructure</p>

                <div class="attack-simulator">
                    <canvas id="networkCanvas" class="network-canvas"></canvas>

                    <div class="controls">
                        <div class="control-group">
                            <label>Attack Type</label>
                            <select id="attackType">
                                <option value="none">No Attack</option>
                                <option value="udp">UDP Flood</option>
                                <option value="syn">SYN Flood</option>
                                <option value="http">HTTP Flood</option>
                                <option value="amplification">DNS Amplification</option>
                                <option value="slowloris">Slowloris</option>
                            </select>
                        </div>

                        <div class="control-group">
                            <label>Attack Intensity: <span id="intensityValue">50</span>%</label>
                            <input type="range" id="intensity" min="0" max="100" value="50">
                        </div>

                        <button class="btn" id="startAttack">Start Attack</button>
                        <button class="btn btn-secondary" id="stopAttack">Stop Attack</button>
                    </div>

                    <div class="metrics">
                        <div class="metric-card">
                            <div class="metric-label">Bandwidth Usage</div>
                            <div class="metric-value"><span id="bandwidth">0</span> Gbps</div>
                            <div class="meter">
                                <div class="meter-fill" id="bandwidthMeter" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Packets Per Second</div>
                            <div class="metric-value"><span id="pps">0</span>K</div>
                            <div class="meter">
                                <div class="meter-fill" id="ppsMeter" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Server CPU</div>
                            <div class="metric-value"><span id="cpu">0</span>%</div>
                            <div class="meter">
                                <div class="meter-fill" id="cpuMeter" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Active Connections</div>
                            <div class="metric-value"><span id="connections">0</span></div>
                            <div class="meter">
                                <div class="meter-fill" id="connMeter" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- BOTNET TAB -->
        <div id="botnet" class="tab-content">
            <div class="section">
                <h2>Botnet Architecture & Command Structure</h2>
                <p style="color: var(--text-dim); margin-bottom: 20px;">Understanding zombie networks and distributed attack coordination</p>

                <div class="botnet-viz">
                    <canvas id="botnetCanvas" class="botnet-canvas"></canvas>
                    <div class="controls">
                        <button class="btn" onclick="animateBotnetCommand()">Send Attack Command</button>
                        <button class="btn btn-secondary" onclick="resetBotnet()">Reset Visualization</button>
                    </div>
                </div>

                <h3>Botnet Components</h3>
                <div class="tool-list">
                    <div class="tool-item">
                        <div class="tool-name">Bot Master</div>
                        <div class="tool-desc">Attacker controlling the entire botnet through command and control infrastructure</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">C&C Server (Command & Control)</div>
                        <div class="tool-desc">Server distributing commands to zombies, often using IRC, HTTP, or P2P protocols</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">Zombie/Bot</div>
                        <div class="tool-desc">Compromised computer infected with malware, awaiting attack instructions</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">Target</div>
                        <div class="tool-desc">Victim server/network receiving coordinated traffic from all zombies simultaneously</div>
                    </div>
                </div>

                <h3>C&C Communication Models</h3>
                <div class="comparison-grid">
                    <div class="attack-card">
                        <div class="attack-type">Centralized (IRC/HTTP)</div>
                        <div class="attack-details">
                            <strong>Pros:</strong> Simple, fast command distribution<br>
                            <strong>Cons:</strong> Single point of failure, easy to detect and shutdown<br>
                            <strong>Example:</strong> Traditional IRC-based botnets
                        </div>
                    </div>
                    <div class="attack-card">
                        <div class="attack-type">Peer-to-Peer (P2P)</div>
                        <div class="attack-details">
                            <strong>Pros:</strong> Resilient, no central server to takedown<br>
                            <strong>Cons:</strong> Slower propagation, complex to maintain<br>
                            <strong>Example:</strong> Storm botnet, Mirai variants
                        </div>
                    </div>
                    <div class="attack-card">
                        <div class="attack-type">Domain Generation Algorithm (DGA)</div>
                        <div class="attack-details">
                            <strong>Pros:</strong> Constantly changing C&C domains, hard to block<br>
                            <strong>Cons:</strong> Predictable patterns can be detected<br>
                            <strong>Example:</strong> Conficker, Cryptolocker
                        </div>
                    </div>
                </div>

                <h3>Famous Botnets</h3>
                <div class="info-box">
                    <strong>Mirai (2016):</strong> IoT botnet with 600K+ devices, attacked Dyn DNS causing widespread internet outage. Source code publicly released.
                </div>
                <div class="info-box danger">
                    <strong>Zeus (2007-2014):</strong> Banking trojan botnet, millions of infections, focused on financial fraud but capable of DDoS.
                </div>
                <div class="info-box">
                    <strong>Emotet (2014-2021):</strong> Polymorphic malware, evolved from banking trojan to botnet-as-a-service, taken down by global law enforcement.
                </div>
            </div>
        </div>

        <!-- DEFENSE TAB -->
        <div id="defense" class="tab-content">
            <div class="section">
                <h2>Defense Mechanisms & Countermeasures</h2>

                <div class="defense-demo">
                    <h3>Interactive Defense Visualization</h3>
                    <canvas id="defenseCanvas" class="defense-canvas"></canvas>
                    <div class="controls">
                        <button class="btn" onclick="toggleDefense('firewall')">Enable Firewall</button>
                        <button class="btn" onclick="toggleDefense('ratelimit')">Rate Limiting</button>
                        <button class="btn" onclick="toggleDefense('cdn')">CDN Protection</button>
                        <button class="btn btn-secondary" onclick="resetDefense()">Reset</button>
                    </div>
                </div>

                <h3>Network-Level Defenses</h3>
                <div class="tool-list">
                    <div class="tool-item">
                        <div class="tool-name">Rate Limiting</div>
                        <div class="tool-desc">Restricts number of requests from single IP within time window (e.g., 100 req/min)</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">SYN Cookies</div>
                        <div class="tool-desc">Prevents SYN flood by encoding connection state in sequence number, avoiding state storage</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">Ingress Filtering</div>
                        <div class="tool-desc">Blocks packets with spoofed source IPs at network edge (BCP 38)</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">Blackhole Routing</div>
                        <div class="tool-desc">Drops attack traffic at ISP level before reaching target network</div>
                    </div>
                </div>

                <h3>Infrastructure Defenses</h3>
                <div class="tool-list">
                    <div class="tool-item">
                        <div class="tool-name">CDN (Content Delivery Network)</div>
                        <div class="tool-desc">Distributes traffic across global edge servers (Cloudflare, Akamai, AWS CloudFront)</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">Scrubbing Centers</div>
                        <div class="tool-desc">Specialized facilities that filter attack traffic and forward clean traffic to origin</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">Anycast Routing</div>
                        <div class="tool-desc">Multiple servers share same IP, routing distributes attack across geographic locations</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">Overprovisioning</div>
                        <div class="tool-desc">Maintain excess bandwidth capacity (2-3x normal) to absorb attack spikes</div>
                    </div>
                </div>

                <h3>Application Defenses</h3>
                <div class="tool-list">
                    <div class="tool-item">
                        <div class="tool-name">WAF (Web Application Firewall)</div>
                        <div class="tool-desc">Filters HTTP traffic based on rules, signatures, and behavioral analysis</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">CAPTCHA Challenges</div>
                        <div class="tool-desc">Distinguishes humans from bots during suspected attack traffic</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">Connection Limits</div>
                        <div class="tool-desc">Restricts concurrent connections per IP (defense against Slowloris)</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">JavaScript Challenges</div>
                        <div class="tool-desc">Requires browser to execute JS before accessing site (filters simple bots)</div>
                    </div>
                </div>

                <h3>Mitigation Flowchart</h3>
                <div class="flowchart">
                    <canvas id="flowchartCanvas" class="flowchart-canvas"></canvas>
                </div>

                <div class="info-box success">
                    <strong>Best Practice:</strong> Defense in depth - layer multiple countermeasures (firewall + rate limiting + CDN + WAF) to ensure redundancy if one layer fails.
                </div>
            </div>

            <div class="section">
                <h2>DDoS Attack Tools (Educational Awareness)</h2>
                <div class="info-box danger">
                    <strong>WARNING:</strong> These tools are for educational understanding only. Unauthorized use against systems you don't own is illegal and punishable under CFAA and international cybercrime laws.
                </div>

                <div class="tool-list">
                    <div class="tool-item">
                        <div class="tool-name">LOIC (Low Orbit Ion Cannon)</div>
                        <div class="tool-desc">Open-source stress testing tool, TCP/UDP/HTTP floods, GUI-based, used by Anonymous</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">HOIC (High Orbit Ion Cannon)</div>
                        <div class="tool-desc">LOIC successor, HTTP floods with booster scripts, harder to detect</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">hping3</div>
                        <div class="tool-desc">Command-line packet crafting tool, can perform SYN, ACK, UDP floods with spoofing</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">Slowloris</div>
                        <div class="tool-desc">Python script for slow HTTP attacks, keeps connections open with minimal bandwidth</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">Metasploit Auxiliary</div>
                        <div class="tool-desc">Contains DoS modules for testing (synflood, udpflood, slowloris)</div>
                    </div>
                    <div class="tool-item">
                        <div class="tool-name">GoldenEye</div>
                        <div class="tool-desc">Python HTTP DoS tool, keeps connections alive, randomizes URL parameters</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- HISTORY TAB -->
        <div id="history" class="tab-content">
            <div class="section">
                <h2>Historical DDoS Attacks</h2>
                <p style="color: var(--text-dim); margin-bottom: 20px;">Major incidents that shaped cybersecurity landscape</p>

                <div class="timeline">
                    <div class="timeline-item">
                        <div class="timeline-date">February 2018</div>
                        <div class="timeline-title">GitHub - Record-Breaking 1.35 Tbps</div>
                        <div class="timeline-desc">
                            Memcached amplification attack exploiting UDP port 11211. Attack peaked at 1.35 Tbps and 126.9 million packets per second. Lasted only 20 minutes but set new record. GitHub used Akamai Prolexic to mitigate within 10 minutes.
                        </div>
                    </div>

                    <div class="timeline-item">
                        <div class="timeline-date">October 2016</div>
                        <div class="timeline-title">Dyn DNS - Mirai Botnet Attack</div>
                        <div class="timeline-desc">
                            Massive IoT botnet (cameras, DVRs, routers) attacked Dyn DNS infrastructure. Caused outages for Twitter, Netflix, Reddit, Airbnb, and major sites across US East Coast. Peak traffic exceeded 1.2 Tbps. Demonstrated IoT vulnerability at scale.
                        </div>
                    </div>

                    <div class="timeline-item">
                        <div class="timeline-date">March 2013</div>
                        <div class="timeline-title">Spamhaus - DNS Amplification 300 Gbps</div>
                        <div class="timeline-desc">
                            Attack against anti-spam organization reached 300 Gbps using DNS amplification. So large it caused congestion on London Internet Exchange. Highlighted DNS resolver vulnerability and need for response rate limiting (RRL).
                        </div>
                    </div>

                    <div class="timeline-item">
                        <div class="timeline-date">February 2000</div>
                        <div class="timeline-title">MafiaBoy - Yahoo, eBay, Amazon</div>
                        <div class="timeline-desc">
                            15-year-old Canadian launched SYN flood attacks against major websites. Yahoo offline for hours, eBay, Amazon, CNN affected. First major demonstration of DDoS impact on e-commerce. Led to increased cybercrime legislation.
                        </div>
                    </div>

                    <div class="timeline-item">
                        <div class="timeline-date">2007-2008</div>
                        <div class="timeline-title">Estonia Cyberattacks</div>
                        <div class="timeline-desc">
                            First nation-state level DDoS campaign. Government, banking, media sites targeted after Soviet war memorial relocation. Sustained attacks over weeks. Considered first cyberwar incident, led to NATO cyber defense initiatives.
                        </div>
                    </div>

                    <div class="timeline-item">
                        <div class="timeline-date">September 2016</div>
                        <div class="timeline-title">Krebs on Security - 620 Gbps</div>
                        <div class="timeline-desc">
                            Security journalist Brian Krebs's site hit with 620 Gbps attack via IoT botnet after exposing DDoS-for-hire services. Akamai dropped free protection due to cost. Moved to Google Project Shield. Highlighted economics of DDoS mitigation.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- QUIZ SECTION -->
        <div class="section quiz" id="quizSection">
            <h2>DoS/DDoS Knowledge Assessment</h2>
            <div class="quiz-progress">
                Question <span id="currentQ">1</span> of <span id="totalQ">12</span>
            </div>

            <div id="quizContainer"></div>

            <div class="quiz-nav">
                <button class="btn btn-secondary" id="prevBtn" onclick="previousQuestion()">Previous</button>
                <button class="btn" id="nextBtn" onclick="nextQuestion()">Next</button>
                <button class="btn" id="submitBtn" onclick="submitQuiz()" style="display:none;">Submit Quiz</button>
            </div>

            <div id="results" style="display:none;">
                <div class="score-display">
                    <h3>Quiz Complete!</h3>
                    <div class="score-value"><span id="score">0</span>%</div>
                    <p style="color: var(--text-dim); margin-top: 15px;">
                        You answered <span id="correctCount">0</span> out of <span id="totalCount">12</span> questions correctly
                    </p>
                </div>
                <div id="xpReward" style="display:none;" class="xp-reward">
                    +70 XP Earned! - DoS/DDoS Attacks Mastery
                </div>
                <button class="btn" onclick="restartQuiz()" style="margin-top: 20px;">Retake Quiz</button>
            </div>
        </div>
    </div>

    <script>
        // Tab switching
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        function scrollToQuiz() {
            document.getElementById('quizSection').scrollIntoView({ behavior: 'smooth' });
        }

        // ATTACK SIMULATOR
        const canvas = document.getElementById('networkCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = canvas.offsetWidth;
        canvas.height = canvas.offsetHeight;

        let attackActive = false;
        let attackType = 'none';
        let intensity = 50;
        let packets = [];

        class Packet {
            constructor(x, y, targetX, targetY, color, speed) {
                this.x = x;
                this.y = y;
                this.targetX = targetX;
                this.targetY = targetY;
                this.color = color;
                this.speed = speed;
                this.angle = Math.atan2(targetY - y, targetX - x);
            }

            update() {
                this.x += Math.cos(this.angle) * this.speed;
                this.y += Math.sin(this.angle) * this.speed;
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, 3, 0, Math.PI * 2);
                ctx.fill();
            }

            reachedTarget() {
                const dist = Math.hypot(this.targetX - this.x, this.targetY - this.y);
                return dist < 10;
            }
        }

        function drawNetwork() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw server (target)
            const serverX = canvas.width / 2;
            const serverY = canvas.height / 2;
            ctx.fillStyle = attackActive ? '#dc2626' : '#a855f7';
            ctx.fillRect(serverX - 30, serverY - 30, 60, 60);
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 2;
            ctx.strokeRect(serverX - 30, serverY - 30, 60, 60);
            ctx.fillStyle = '#fff';
            ctx.font = '12px monospace';
            ctx.textAlign = 'center';
            ctx.fillText('SERVER', serverX, serverY);

            // Draw attackers
            const numAttackers = attackType === 'none' ? 1 : Math.floor(intensity / 10) + 3;
            const attackers = [];
            for (let i = 0; i < numAttackers; i++) {
                const angle = (i / numAttackers) * Math.PI * 2;
                const radius = 150;
                const x = serverX + Math.cos(angle) * radius;
                const y = serverY + Math.sin(angle) * radius;
                attackers.push({ x, y });

                ctx.fillStyle = attackActive ? '#dc2626' : '#444';
                ctx.beginPath();
                ctx.arc(x, y, 15, 0, Math.PI * 2);
                ctx.fill();
                ctx.strokeStyle = '#fff';
                ctx.stroke();
            }

            // Generate packets during attack
            if (attackActive && Math.random() < intensity / 100) {
                const attacker = attackers[Math.floor(Math.random() * attackers.length)];
                const color = getPacketColor(attackType);
                const speed = getPacketSpeed(attackType);
                packets.push(new Packet(attacker.x, attacker.y, serverX, serverY, color, speed));
            }

            // Update and draw packets
            packets = packets.filter(p => !p.reachedTarget());
            packets.forEach(p => {
                p.update();
                p.draw();
            });

            requestAnimationFrame(drawNetwork);
        }

        function getPacketColor(type) {
            const colors = {
                'udp': '#3b82f6',
                'syn': '#f59e0b',
                'http': '#10b981',
                'amplification': '#8b5cf6',
                'slowloris': '#ec4899'
            };
            return colors[type] || '#666';
        }

        function getPacketSpeed(type) {
            const speeds = {
                'udp': 4,
                'syn': 5,
                'http': 3,
                'amplification': 6,
                'slowloris': 1
            };
            return speeds[type] || 3;
        }

        function updateMetrics() {
            if (!attackActive) {
                document.getElementById('bandwidth').textContent = '0';
                document.getElementById('pps').textContent = '0';
                document.getElementById('cpu').textContent = '0';
                document.getElementById('connections').textContent = '0';
                document.getElementById('bandwidthMeter').style.width = '0%';
                document.getElementById('ppsMeter').style.width = '0%';
                document.getElementById('cpuMeter').style.width = '0%';
                document.getElementById('connMeter').style.width = '0%';
                return;
            }

            const metrics = getAttackMetrics(attackType, intensity);
            document.getElementById('bandwidth').textContent = metrics.bandwidth;
            document.getElementById('pps').textContent = metrics.pps;
            document.getElementById('cpu').textContent = metrics.cpu;
            document.getElementById('connections').textContent = metrics.connections;

            document.getElementById('bandwidthMeter').style.width = Math.min(metrics.bandwidth * 10, 100) + '%';
            document.getElementById('ppsMeter').style.width = Math.min(metrics.pps / 10, 100) + '%';
            document.getElementById('cpuMeter').style.width = metrics.cpu + '%';
            document.getElementById('connMeter').style.width = Math.min(metrics.connections / 100, 100) + '%';
        }

        function getAttackMetrics(type, intens) {
            const base = intens / 100;
            const metrics = {
                'udp': { bandwidth: (base * 8).toFixed(1), pps: Math.floor(base * 500), cpu: Math.floor(base * 60), connections: Math.floor(base * 1000) },
                'syn': { bandwidth: (base * 2).toFixed(1), pps: Math.floor(base * 800), cpu: Math.floor(base * 80), connections: Math.floor(base * 5000) },
                'http': { bandwidth: (base * 1).toFixed(1), pps: Math.floor(base * 100), cpu: Math.floor(base * 90), connections: Math.floor(base * 3000) },
                'amplification': { bandwidth: (base * 12).toFixed(1), pps: Math.floor(base * 1000), cpu: Math.floor(base * 70), connections: Math.floor(base * 2000) },
                'slowloris': { bandwidth: '0.1', pps: Math.floor(base * 10), cpu: Math.floor(base * 95), connections: Math.floor(base * 10000) }
            };
            return metrics[type] || { bandwidth: 0, pps: 0, cpu: 0, connections: 0 };
        }

        document.getElementById('startAttack').addEventListener('click', () => {
            attackType = document.getElementById('attackType').value;
            if (attackType === 'none') {
                alert('Please select an attack type');
                return;
            }
            attackActive = true;
        });

        document.getElementById('stopAttack').addEventListener('click', () => {
            attackActive = false;
            packets = [];
        });

        document.getElementById('intensity').addEventListener('input', (e) => {
            intensity = e.target.value;
            document.getElementById('intensityValue').textContent = intensity;
        });

        setInterval(updateMetrics, 100);
        drawNetwork();

        // BOTNET VISUALIZATION
        const botnetCanvas = document.getElementById('botnetCanvas');
        const bctx = botnetCanvas.getContext('2d');
        botnetCanvas.width = botnetCanvas.offsetWidth;
        botnetCanvas.height = botnetCanvas.offsetHeight;

        let commandWave = [];

        function drawBotnet() {
            bctx.clearRect(0, 0, botnetCanvas.width, botnetCanvas.height);

            // Bot Master
            const masterX = 100;
            const masterY = botnetCanvas.height / 2;
            bctx.fillStyle = '#dc2626';
            bctx.beginPath();
            bctx.arc(masterX, masterY, 20, 0, Math.PI * 2);
            bctx.fill();
            bctx.fillStyle = '#fff';
            bctx.font = '12px monospace';
            bctx.textAlign = 'center';
            bctx.fillText('MASTER', masterX, masterY + 35);

            // C&C Server
            const ccX = 300;
            const ccY = botnetCanvas.height / 2;
            bctx.fillStyle = '#f59e0b';
            bctx.fillRect(ccX - 25, ccY - 25, 50, 50);
            bctx.strokeStyle = '#fff';
            bctx.lineWidth = 2;
            bctx.strokeRect(ccX - 25, ccY - 25, 50, 50);
            bctx.fillStyle = '#fff';
            bctx.fillText('C&C', ccX, ccY);
            bctx.fillText('SERVER', ccX, ccY + 40);

            // Line from master to C&C
            bctx.strokeStyle = '#dc2626';
            bctx.beginPath();
            bctx.moveTo(masterX + 20, masterY);
            bctx.lineTo(ccX - 25, ccY);
            bctx.stroke();

            // Zombies
            const zombies = [];
            for (let i = 0; i < 12; i++) {
                const angle = (i / 12) * Math.PI * 2 - Math.PI / 2;
                const x = ccX + Math.cos(angle) * 180 + 200;
                const y = ccY + Math.sin(angle) * 180;
                zombies.push({ x, y });

                bctx.fillStyle = '#8b5cf6';
                bctx.beginPath();
                bctx.arc(x, y, 12, 0, Math.PI * 2);
                bctx.fill();

                // Line from C&C to zombie
                bctx.strokeStyle = '#444';
                bctx.lineWidth = 1;
                bctx.beginPath();
                bctx.moveTo(ccX + 25, ccY);
                bctx.lineTo(x, y);
                bctx.stroke();
            }

            // Target
            const targetX = botnetCanvas.width - 100;
            const targetY = botnetCanvas.height / 2;
            bctx.fillStyle = '#10b981';
            bctx.fillRect(targetX - 30, targetY - 30, 60, 60);
            bctx.strokeStyle = '#fff';
            bctx.lineWidth = 2;
            bctx.strokeRect(targetX - 30, targetY - 30, 60, 60);
            bctx.fillStyle = '#fff';
            bctx.fillText('TARGET', targetX, targetY);

            // Draw command wave
            commandWave = commandWave.filter(w => w.progress < 1);
            commandWave.forEach(w => {
                w.progress += 0.02;
                const currentX = ccX + (targetX - ccX) * w.progress;
                const currentY = ccY + (targetY - ccY) * w.progress;

                bctx.fillStyle = `rgba(220, 38, 38, ${1 - w.progress})`;
                bctx.beginPath();
                bctx.arc(currentX, currentY, 8, 0, Math.PI * 2);
                bctx.fill();

                zombies.forEach(z => {
                    const zx = z.x + (targetX - z.x) * w.progress;
                    const zy = z.y + (targetY - z.y) * w.progress;
                    bctx.fillStyle = `rgba(139, 92, 246, ${1 - w.progress})`;
                    bctx.beginPath();
                    bctx.arc(zx, zy, 5, 0, Math.PI * 2);
                    bctx.fill();
                });
            });

            requestAnimationFrame(drawBotnet);
        }

        function animateBotnetCommand() {
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    commandWave.push({ progress: 0 });
                }, i * 200);
            }
        }

        function resetBotnet() {
            commandWave = [];
        }

        drawBotnet();

        // DEFENSE VISUALIZATION
        const defCanvas = document.getElementById('defenseCanvas');
        const dctx = defCanvas.getContext('2d');
        defCanvas.width = defCanvas.offsetWidth;
        defCanvas.height = defCanvas.offsetHeight;

        let defenses = {
            firewall: false,
            ratelimit: false,
            cdn: false
        };

        let defensePackets = [];

        function drawDefense() {
            dctx.clearRect(0, 0, defCanvas.width, defCanvas.height);

            const serverX = defCanvas.width - 100;
            const serverY = defCanvas.height / 2;

            // Draw server
            dctx.fillStyle = '#10b981';
            dctx.fillRect(serverX - 25, serverY - 25, 50, 50);
            dctx.strokeStyle = '#fff';
            dctx.lineWidth = 2;
            dctx.strokeRect(serverX - 25, serverY - 25, 50, 50);
            dctx.fillStyle = '#fff';
            dctx.font = '11px monospace';
            dctx.textAlign = 'center';
            dctx.fillText('SERVER', serverX, serverY);

            // Draw defense layers
            let layerX = serverX - 80;
            if (defenses.cdn) {
                dctx.strokeStyle = '#3b82f6';
                dctx.lineWidth = 3;
                dctx.strokeRect(layerX - 30, serverY - 50, 60, 100);
                dctx.fillStyle = '#3b82f6';
                dctx.fillText('CDN', layerX, serverY + 70);
                layerX -= 60;
            }
            if (defenses.firewall) {
                dctx.strokeStyle = '#f59e0b';
                dctx.lineWidth = 3;
                dctx.strokeRect(layerX - 30, serverY - 50, 60, 100);
                dctx.fillStyle = '#f59e0b';
                dctx.fillText('FIREWALL', layerX, serverY + 70);
                layerX -= 60;
            }

            // Generate attack packets
            if (Math.random() < 0.1) {
                defensePackets.push({
                    x: 50,
                    y: Math.random() * defCanvas.height,
                    speed: 3 + Math.random() * 2,
                    malicious: Math.random() < 0.7
                });
            }

            // Update and draw packets
            defensePackets = defensePackets.filter(p => {
                p.x += p.speed;

                let blocked = false;
                if (defenses.firewall && p.x > serverX - 200 && p.malicious) {
                    blocked = Math.random() < 0.6;
                }
                if (defenses.ratelimit && p.x > serverX - 150 && p.malicious) {
                    blocked = blocked || Math.random() < 0.3;
                }
                if (defenses.cdn && p.malicious) {
                    blocked = blocked || Math.random() < 0.5;
                }

                if (blocked) {
                    dctx.fillStyle = '#dc2626';
                    dctx.font = '12px monospace';
                    dctx.fillText('X', p.x, p.y);
                    return false;
                }

                dctx.fillStyle = p.malicious ? '#dc2626' : '#10b981';
                dctx.beginPath();
                dctx.arc(p.x, p.y, 4, 0, Math.PI * 2);
                dctx.fill();

                return p.x < serverX;
            });

            requestAnimationFrame(drawDefense);
        }

        function toggleDefense(type) {
            defenses[type] = !defenses[type];
            event.target.style.background = defenses[type] ? '#10b981' : '#a855f7';
        }

        function resetDefense() {
            defenses = { firewall: false, ratelimit: false, cdn: false };
            defensePackets = [];
            document.querySelectorAll('#defenseCanvas + .controls .btn').forEach(btn => {
                if (!btn.classList.contains('btn-secondary')) {
                    btn.style.background = '';
                }
            });
        }

        drawDefense();

        // FLOWCHART
        const flowCanvas = document.getElementById('flowchartCanvas');
        const fctx = flowCanvas.getContext('2d');
        flowCanvas.width = flowCanvas.offsetWidth;
        flowCanvas.height = flowCanvas.offsetHeight;

        function drawFlowchart() {
            fctx.clearRect(0, 0, flowCanvas.width, flowCanvas.height);
            fctx.font = '13px monospace';
            fctx.textAlign = 'center';

            const nodes = [
                { x: flowCanvas.width / 2, y: 30, text: 'DDoS Attack Detected', color: '#dc2626' },
                { x: flowCanvas.width / 2, y: 100, text: 'Analyze Attack Type', color: '#f59e0b' },
                { x: 200, y: 170, text: 'Volumetric?', color: '#8b5cf6' },
                { x: flowCanvas.width / 2, y: 170, text: 'Protocol?', color: '#8b5cf6' },
                { x: flowCanvas.width - 200, y: 170, text: 'Application?', color: '#8b5cf6' },
                { x: 200, y: 240, text: 'Enable CDN/Scrubbing', color: '#10b981' },
                { x: flowCanvas.width / 2, y: 240, text: 'SYN Cookies/Filtering', color: '#10b981' },
                { x: flowCanvas.width - 200, y: 240, text: 'WAF/Rate Limiting', color: '#10b981' },
                { x: flowCanvas.width / 2, y: 310, text: 'Monitor & Adjust', color: '#3b82f6' },
                { x: flowCanvas.width / 2, y: 380, text: 'Traffic Normalized', color: '#10b981' }
            ];

            const edges = [
                [0, 1], [1, 2], [1, 3], [1, 4],
                [2, 5], [3, 6], [4, 7],
                [5, 8], [6, 8], [7, 8], [8, 9]
            ];

            // Draw edges
            fctx.strokeStyle = '#a855f7';
            fctx.lineWidth = 2;
            edges.forEach(([from, to]) => {
                fctx.beginPath();
                fctx.moveTo(nodes[from].x, nodes[from].y + 20);
                fctx.lineTo(nodes[to].x, nodes[to].y - 20);
                fctx.stroke();
            });

            // Draw nodes
            nodes.forEach(node => {
                fctx.fillStyle = node.color;
                fctx.fillRect(node.x - 80, node.y - 15, 160, 30);
                fctx.strokeStyle = '#fff';
                fctx.lineWidth = 2;
                fctx.strokeRect(node.x - 80, node.y - 15, 160, 30);
                fctx.fillStyle = '#fff';
                fctx.fillText(node.text, node.x, node.y + 5);
            });
        }

        drawFlowchart();

        // QUIZ DATA
        const quizQuestions = [
            {
                question: "What is the primary difference between DoS and DDoS attacks?",
                options: [
                    "DoS uses encryption, DDoS does not",
                    "DoS comes from a single source, DDoS from multiple distributed sources",
                    "DoS targets applications, DDoS targets networks",
                    "DoS is legal for testing, DDoS is always illegal"
                ],
                correct: 1
            },
            {
                question: "Which attack type sends TCP SYN packets without completing the three-way handshake to exhaust server connection tables?",
                options: [
                    "UDP Flood",
                    "HTTP Flood",
                    "SYN Flood",
                    "Slowloris"
                ],
                correct: 2
            },
            {
                question: "What metric is primarily used to measure volumetric attacks?",
                options: [
                    "CPU percentage",
                    "Requests per second",
                    "Gigabits per second (Gbps)",
                    "Number of active connections"
                ],
                correct: 2
            },
            {
                question: "Which DDoS attack technique opens many HTTP connections and sends partial requests very slowly to keep connections alive?",
                options: [
                    "Slowloris",
                    "Ping of Death",
                    "Smurf Attack",
                    "SYN Flood"
                ],
                correct: 0
            },
            {
                question: "What amplification factor can DNS/NTP amplification attacks achieve?",
                options: [
                    "2-5x amplification",
                    "10-20x amplification",
                    "50-200x amplification",
                    "No amplification, same size"
                ],
                correct: 2
            },
            {
                question: "Which defense mechanism encodes connection state in the TCP sequence number to prevent SYN flood attacks?",
                options: [
                    "Rate Limiting",
                    "SYN Cookies",
                    "CAPTCHA",
                    "Anycast Routing"
                ],
                correct: 1
            },
            {
                question: "What is a multi-vector DDoS attack?",
                options: [
                    "An attack from multiple countries",
                    "An attack combining volumetric, protocol, and application layer techniques simultaneously",
                    "An attack that targets multiple websites",
                    "An attack using multiple programming languages"
                ],
                correct: 1
            },
            {
                question: "What type of attack is 'phlashing' or permanent DoS (PDoS)?",
                options: [
                    "Exhausting all IP addresses in a subnet",
                    "Corrupting firmware to brick hardware devices",
                    "Permanently blocking an IP at the ISP level",
                    "Destroying data with ransomware"
                ],
                correct: 1
            },
            {
                question: "Which famous 2016 DDoS attack used an IoT botnet to target Dyn DNS infrastructure, causing major internet outages?",
                options: [
                    "Zeus Botnet",
                    "Conficker",
                    "Mirai Botnet",
                    "Emotet"
                ],
                correct: 2
            },
            {
                question: "What is the purpose of a DDoS scrubbing center?",
                options: [
                    "To clean infected computers of malware",
                    "To filter attack traffic and forward only clean traffic to the origin server",
                    "To remove logs of DDoS attacks",
                    "To test attack tools in isolated environments"
                ],
                correct: 1
            },
            {
                question: "In a reflected/DRDoS attack, what is the attacker's primary objective?",
                options: [
                    "To amplify attack traffic and hide the true attack source",
                    "To steal credentials from the reflector servers",
                    "To take control of the reflector infrastructure",
                    "To encrypt traffic between attacker and target"
                ],
                correct: 0
            },
            {
                question: "What countermeasure uses multiple servers sharing the same IP address to distribute attack traffic geographically?",
                options: [
                    "Load Balancing",
                    "CDN (Content Delivery Network)",
                    "Anycast Routing",
                    "Proxy Chaining"
                ],
                correct: 2
            }
        ];

        let currentQuestion = 0;
        let userAnswers = [];

        function renderQuiz() {
            const container = document.getElementById('quizContainer');
            container.innerHTML = '';

            quizQuestions.forEach((q, index) => {
                const qDiv = document.createElement('div');
                qDiv.className = 'question';
                if (index === 0) qDiv.classList.add('active');

                qDiv.innerHTML = `
                    <div class="question-text"><strong>Question ${index + 1}:</strong> ${q.question}</div>
                    <div class="options">
                        ${q.options.map((opt, i) => `
                            <div class="option" data-question="${index}" data-option="${i}">
                                ${opt}
                            </div>
                        `).join('')}
                    </div>
                `;

                container.appendChild(qDiv);
            });

            document.querySelectorAll('.option').forEach(opt => {
                opt.addEventListener('click', selectOption);
            });

            document.getElementById('totalQ').textContent = quizQuestions.length;
            updateQuizNav();
        }

        function selectOption(e) {
            const questionIndex = parseInt(e.target.dataset.question);
            const optionIndex = parseInt(e.target.dataset.option);

            document.querySelectorAll(`[data-question="${questionIndex}"]`).forEach(opt => {
                opt.classList.remove('selected');
            });

            e.target.classList.add('selected');
            userAnswers[questionIndex] = optionIndex;
        }

        function nextQuestion() {
            if (currentQuestion < quizQuestions.length - 1) {
                document.querySelectorAll('.question')[currentQuestion].classList.remove('active');
                currentQuestion++;
                document.querySelectorAll('.question')[currentQuestion].classList.add('active');
                document.getElementById('currentQ').textContent = currentQuestion + 1;
                updateQuizNav();
            }
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                document.querySelectorAll('.question')[currentQuestion].classList.remove('active');
                currentQuestion--;
                document.querySelectorAll('.question')[currentQuestion].classList.add('active');
                document.getElementById('currentQ').textContent = currentQuestion + 1;
                updateQuizNav();
            }
        }

        function updateQuizNav() {
            document.getElementById('prevBtn').style.display = currentQuestion === 0 ? 'none' : 'block';
            document.getElementById('nextBtn').style.display = currentQuestion === quizQuestions.length - 1 ? 'none' : 'block';
            document.getElementById('submitBtn').style.display = currentQuestion === quizQuestions.length - 1 ? 'block' : 'none';
        }

        function submitQuiz() {
            if (userAnswers.length < quizQuestions.length) {
                alert('Please answer all questions before submitting.');
                return;
            }

            let correct = 0;
            quizQuestions.forEach((q, index) => {
                const options = document.querySelectorAll(`[data-question="${index}"]`);
                options.forEach((opt, i) => {
                    if (i === q.correct) {
                        opt.classList.add('correct');
                    } else if (i === userAnswers[index] && i !== q.correct) {
                        opt.classList.add('incorrect');
                    }
                });

                if (userAnswers[index] === q.correct) correct++;
            });

            const percentage = Math.round((correct / quizQuestions.length) * 100);
            document.getElementById('score').textContent = percentage;
            document.getElementById('correctCount').textContent = correct;
            document.getElementById('totalCount').textContent = quizQuestions.length;

            if (percentage >= 70) {
                document.getElementById('xpReward').style.display = 'block';
                saveProgress();
            }

            document.getElementById('quizContainer').style.display = 'none';
            document.querySelector('.quiz-nav').style.display = 'none';
            document.getElementById('results').style.display = 'block';
            document.querySelector('.quiz-progress').style.display = 'none';
        }

        function restartQuiz() {
            currentQuestion = 0;
            userAnswers = [];
            document.getElementById('quizContainer').style.display = 'block';
            document.querySelector('.quiz-nav').style.display = 'flex';
            document.getElementById('results').style.display = 'none';
            document.querySelector('.quiz-progress').style.display = 'block';
            renderQuiz();
        }

        function saveProgress() {
            const progress = {
                completed: true,
                score: document.getElementById('score').textContent,
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('hexworth_dos_ddos_lab', JSON.stringify(progress));
        }

        function loadProgress() {
            const saved = localStorage.getItem('hexworth_dos_ddos_lab');
            if (saved) {
                const progress = JSON.parse(saved);
                if (progress.completed) {
                    // Could show completion badge or status
                    console.log('Previously completed with score:', progress.score);
                }
            }
        }

        // Initialize
        renderQuiz();
        loadProgress();
    </script>
<script src="../../components/FluxCapacitor.js"></script>
</body>
</html>