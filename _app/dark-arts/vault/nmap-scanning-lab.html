<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Scanning Lab - Dark Arts Vault | Hexworth Prime</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a0a1a 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #1a0a1a 0%, #2a0a2a 100%);
            border: 2px solid #a855f7;
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(168, 85, 247, 0.3);
        }

        h1 {
            color: #a855f7;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(168, 85, 247, 0.5);
        }

        .subtitle {
            color: #dc2626;
            font-size: 1.2em;
            margin-bottom: 20px;
        }

        .chapter-ref {
            color: #c084fc;
            font-size: 0.9em;
            font-style: italic;
        }

        .ethical-warning {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            border: 2px solid #fca5a5;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.3);
        }

        .ethical-warning h3 {
            color: #fca5a5;
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .ethical-warning p {
            color: #fef2f2;
            line-height: 1.6;
        }

        .section {
            background: rgba(30, 10, 40, 0.6);
            border: 1px solid #a855f7;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .section h2 {
            color: #a855f7;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 2px solid #a855f7;
            padding-bottom: 10px;
        }

        .section h3 {
            color: #c084fc;
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .section h4 {
            color: #e9d5ff;
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .section p, .section li {
            line-height: 1.8;
            color: #d1d5db;
            margin-bottom: 10px;
        }

        .section ul {
            margin-left: 25px;
            margin-bottom: 15px;
        }

        .code-block {
            background: #0a0a0a;
            border: 1px solid #4c1d95;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            position: relative;
        }

        .code-block code {
            color: #10b981;
            font-size: 0.95em;
        }

        .cmd {
            color: #a855f7;
            font-weight: bold;
        }

        .flag {
            color: #fbbf24;
        }

        .target {
            color: #10b981;
        }

        .comment {
            color: #6b7280;
            font-style: italic;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #a855f7;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8em;
            transition: all 0.3s;
        }

        .copy-btn:hover {
            background: #9333ea;
            box-shadow: 0 0 10px rgba(168, 85, 247, 0.5);
        }

        /* Command Builder Tool */
        .command-builder {
            background: linear-gradient(135deg, #1a0520 0%, #2a0a30 100%);
            border: 2px solid #a855f7;
            border-radius: 10px;
            padding: 30px;
            margin: 30px 0;
        }

        .command-builder h3 {
            color: #a855f7;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .builder-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .builder-section {
            background: rgba(10, 10, 10, 0.5);
            border: 1px solid #4c1d95;
            border-radius: 8px;
            padding: 15px;
        }

        .builder-section label {
            display: block;
            color: #c084fc;
            margin-bottom: 8px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .builder-section select,
        .builder-section input {
            width: 100%;
            padding: 8px;
            background: #1a1a1a;
            border: 1px solid #a855f7;
            border-radius: 4px;
            color: #e0e0e0;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
        }

        .builder-section select:focus,
        .builder-section input:focus {
            outline: none;
            border-color: #dc2626;
            box-shadow: 0 0 5px rgba(168, 85, 247, 0.3);
        }

        .generated-command {
            background: #0a0a0a;
            border: 2px solid #10b981;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            position: relative;
        }

        .generated-command code {
            color: #10b981;
            font-size: 1.1em;
            word-break: break-all;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .checkbox-group label {
            display: flex;
            align-items: center;
            color: #d1d5db;
            font-weight: normal;
            cursor: pointer;
        }

        .checkbox-group input[type="checkbox"] {
            margin-right: 8px;
            width: auto;
        }

        /* Scan Output Simulator */
        .scan-simulator {
            background: linear-gradient(135deg, #0a1a0a 0%, #0a2a1a 100%);
            border: 2px solid #10b981;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
        }

        .scan-simulator h3 {
            color: #10b981;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .scan-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .scan-btn {
            background: #10b981;
            color: #0a0a0a;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            transition: all 0.3s;
        }

        .scan-btn:hover {
            background: #059669;
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.5);
        }

        .scan-output {
            background: #000000;
            border: 1px solid #10b981;
            border-radius: 5px;
            padding: 20px;
            min-height: 300px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #10b981;
            white-space: pre-wrap;
            overflow-y: auto;
            max-height: 500px;
        }

        .scan-line {
            margin: 2px 0;
            animation: typeLine 0.1s;
        }

        @keyframes typeLine {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Tab System */
        .tab-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            background: rgba(10, 10, 10, 0.5);
            border: 1px solid #4c1d95;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            color: #c084fc;
            transition: all 0.3s;
        }

        .tab:hover {
            background: rgba(168, 85, 247, 0.2);
            border-color: #a855f7;
        }

        .tab.active {
            background: #a855f7;
            color: white;
            border-color: #a855f7;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Scan Type Cards */
        .scan-types-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .scan-card {
            background: rgba(10, 10, 10, 0.5);
            border: 2px solid #a855f7;
            border-radius: 8px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .scan-card:hover {
            border-color: #10b981;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(168, 85, 247, 0.3);
        }

        .scan-card h4 {
            color: #a855f7;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .scan-card .command {
            background: #0a0a0a;
            border: 1px solid #4c1d95;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            color: #10b981;
            font-size: 0.9em;
        }

        .scan-card p {
            font-size: 0.9em;
            color: #9ca3af;
        }

        /* NSE Scripts Reference */
        .nse-script-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .nse-script {
            background: #0a0a0a;
            border: 1px solid #4c1d95;
            border-radius: 5px;
            padding: 12px;
        }

        .nse-script .script-name {
            color: #fbbf24;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .nse-script .script-desc {
            color: #9ca3af;
            font-size: 0.85em;
            line-height: 1.4;
        }

        /* Warning callouts */
        .warning-callout {
            background: rgba(220, 38, 38, 0.1);
            border-left: 4px solid #dc2626;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .warning-callout strong {
            color: #fca5a5;
        }

        .info-callout {
            background: rgba(59, 130, 246, 0.1);
            border-left: 4px solid #3b82f6;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .info-callout strong {
            color: #93c5fd;
        }

        .success-callout {
            background: rgba(16, 185, 129, 0.1);
            border-left: 4px solid #10b981;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .success-callout strong {
            color: #6ee7b7;
        }

        /* Quiz Section */
        .quiz-section {
            background: linear-gradient(135deg, #1a0a0a 0%, #2a1a0a 100%);
            border: 2px solid #fbbf24;
            border-radius: 10px;
            padding: 30px;
            margin: 40px 0;
        }

        .quiz-section h2 {
            color: #fbbf24;
            margin-bottom: 25px;
            font-size: 2em;
            text-align: center;
        }

        .question {
            background: rgba(10, 10, 10, 0.5);
            border: 1px solid #78350f;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .question-text {
            color: #fbbf24;
            font-size: 1.1em;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option {
            background: #1a1a1a;
            border: 2px solid #78350f;
            padding: 12px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            color: #d1d5db;
        }

        .option:hover {
            border-color: #fbbf24;
            background: rgba(251, 191, 36, 0.1);
        }

        .option.selected {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.2);
        }

        .option.correct {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.2);
        }

        .option.incorrect {
            border-color: #dc2626;
            background: rgba(220, 38, 38, 0.2);
        }

        .submit-quiz-btn {
            display: block;
            margin: 30px auto;
            background: #fbbf24;
            color: #0a0a0a;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .submit-quiz-btn:hover {
            background: #f59e0b;
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.5);
        }

        .quiz-result {
            background: rgba(16, 185, 129, 0.1);
            border: 2px solid #10b981;
            border-radius: 8px;
            padding: 25px;
            margin-top: 20px;
            text-align: center;
            display: none;
        }

        .quiz-result h3 {
            color: #10b981;
            font-size: 1.5em;
            margin-bottom: 15px;
        }

        /* Progress indicator */
        .progress-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(10, 10, 10, 0.9);
            border: 2px solid #a855f7;
            border-radius: 8px;
            padding: 15px;
            min-width: 200px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .progress-indicator h4 {
            color: #a855f7;
            margin-bottom: 10px;
            font-size: 0.9em;
        }

        .progress-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
            font-size: 0.85em;
        }

        .progress-checkbox {
            width: 16px;
            height: 16px;
            border: 2px solid #4c1d95;
            border-radius: 3px;
            margin-right: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .progress-checkbox.completed {
            background: #10b981;
            border-color: #10b981;
        }

        .progress-checkbox.completed::after {
            content: '✓';
            color: white;
            font-size: 12px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .builder-grid {
                grid-template-columns: 1fr;
            }

            .scan-types-grid {
                grid-template-columns: 1fr;
            }

            .progress-indicator {
                position: static;
                margin: 20px 0;
            }

            h1 {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Network Scanning Laboratory</h1>
            <div class="subtitle">Nmap Mastery & Enumeration Techniques</div>
            <div class="chapter-ref">Based on CEH v12 - Chapter 3: Scanning Networks</div>
        </header>

        <div class="ethical-warning">
            <h3>⚠️ CRITICAL - Legal & Ethical Notice</h3>
            <p>
                <strong>Network scanning is ILLEGAL without explicit written authorization.</strong>
                Only scan networks and systems you own or have written permission to test.
                Unauthorized scanning violates the Computer Fraud and Abuse Act (CFAA) and similar laws worldwide.
                Use these techniques ONLY in authorized penetration tests, CTF competitions, or your own lab environments.
            </p>
            <p style="margin-top: 10px;">
                <strong>Golden Rule:</strong> If you don't own it and don't have written permission, don't scan it.
            </p>
        </div>

        <!-- Progress Indicator -->
        <div class="progress-indicator" id="progressIndicator">
            <h4>Lab Progress</h4>
            <div class="progress-item">
                <div class="progress-checkbox" id="progress-command"></div>
                <span>Command Builder Used</span>
            </div>
            <div class="progress-item">
                <div class="progress-checkbox" id="progress-simulator"></div>
                <span>Scan Simulator Tested</span>
            </div>
            <div class="progress-item">
                <div class="progress-checkbox" id="progress-quiz"></div>
                <span>Quiz Completed (70%+)</span>
            </div>
        </div>

        <!-- Introduction -->
        <section class="section">
            <h2>Introduction to Network Scanning</h2>
            <p>
                Network scanning is the second phase of the Cyber Kill Chain, following reconnaissance.
                It involves actively probing target systems to discover live hosts, open ports, running services,
                and operating systems. This intelligence forms the foundation for exploitation planning.
            </p>

            <h3>The Three Pillars of Scanning</h3>
            <ul>
                <li><strong>Host Discovery:</strong> Identify which IP addresses are active on the network</li>
                <li><strong>Port Scanning:</strong> Determine which ports are open and what services are running</li>
                <li><strong>Service & OS Detection:</strong> Fingerprint services and identify operating systems</li>
            </ul>

            <div class="info-callout">
                <strong>Key Insight:</strong> Nmap (Network Mapper) is the industry-standard tool for network scanning.
                Created by Gordon Lyon (Fyodor), it's used by security professionals, penetration testers,
                and system administrators worldwide. Understanding Nmap is essential for both offensive and defensive security.
            </div>
        </section>

        <!-- Host Discovery -->
        <section class="section">
            <h2>1. Host Discovery</h2>
            <p>
                Before scanning ports, we need to identify which hosts are alive on the network.
                Host discovery uses various techniques to determine if a system is online.
            </p>

            <h3>Ping Sweep Techniques</h3>

            <div class="tab-container">
                <div class="tab active" onclick="switchTab('icmp-ping')">ICMP Ping</div>
                <div class="tab" onclick="switchTab('tcp-ping')">TCP Ping</div>
                <div class="tab" onclick="switchTab('arp-scan')">ARP Scan</div>
                <div class="tab" onclick="switchTab('no-ping')">Skip Discovery</div>
            </div>

            <div id="icmp-ping" class="tab-content active">
                <h4>ICMP Echo Request (Traditional Ping)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <code><span class="comment"># Ping scan entire subnet</span>
<span class="cmd">nmap</span> <span class="flag">-sn</span> <span class="target">192.168.1.0/24</span>

<span class="comment"># Same as: nmap -sP (older syntax)</span>
<span class="comment"># -sn = Ping scan (no port scan)</span></code>
                </div>
                <p>
                    Sends ICMP Echo Request packets to discover live hosts. Many firewalls block ICMP,
                    so this method may miss hosts even if they're online.
                </p>
            </div>

            <div id="tcp-ping" class="tab-content">
                <h4>TCP SYN Ping (Stealth Discovery)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <code><span class="comment"># TCP SYN to port 80</span>
<span class="cmd">nmap</span> <span class="flag">-PS80</span> <span class="target">192.168.1.0/24</span>

<span class="comment"># TCP ACK to port 443</span>
<span class="cmd">nmap</span> <span class="flag">-PA443</span> <span class="target">192.168.1.0/24</span>

<span class="comment"># Multiple ports</span>
<span class="cmd">nmap</span> <span class="flag">-PS22,80,443,3389</span> <span class="target">192.168.1.0/24</span></code>
                </div>
                <p>
                    Sends TCP SYN packets to common ports. More effective than ICMP since TCP is rarely blocked.
                    If you get a SYN/ACK or RST, the host is alive.
                </p>
            </div>

            <div id="arp-scan" class="tab-content">
                <h4>ARP Scan (Local Network Only)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <code><span class="comment"># ARP scan on local subnet (most reliable on LAN)</span>
<span class="cmd">nmap</span> <span class="flag">-PR</span> <span class="target">192.168.1.0/24</span>

<span class="comment"># Nmap automatically uses ARP for local networks</span>
<span class="cmd">nmap</span> <span class="flag">-sn</span> <span class="target">192.168.1.0/24</span></code>
                </div>
                <p>
                    On local networks, ARP scanning is the most reliable method. It operates at Layer 2
                    and cannot be blocked by firewalls. Only works on the same network segment.
                </p>
            </div>

            <div id="no-ping" class="tab-content">
                <h4>Skip Host Discovery (Treat All as Online)</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <code><span class="comment"># Force port scanning even if host appears down</span>
<span class="cmd">nmap</span> <span class="flag">-Pn</span> <span class="target">192.168.1.100</span>

<span class="comment"># Useful when firewalls block ping but services are running</span>
<span class="cmd">nmap</span> <span class="flag">-Pn -p 80,443</span> <span class="target">target.com</span></code>
                </div>
                <p>
                    Skips host discovery and proceeds directly to port scanning. Use when you know
                    a host is online but it doesn't respond to ping probes (heavy firewall filtering).
                </p>
            </div>

            <div class="warning-callout">
                <strong>Detection Risk:</strong> Ping sweeps generate noticeable network traffic.
                Intrusion Detection Systems (IDS) can detect rapid ping probes across multiple IPs.
                Use timing controls (-T options) to reduce detection likelihood.
            </div>
        </section>

        <!-- Port Scanning -->
        <section class="section">
            <h2>2. Port Scanning Techniques</h2>
            <p>
                Port scanning identifies which ports are open on a target system. Different scan types
                offer trade-offs between speed, stealth, and reliability.
            </p>

            <div class="scan-types-grid">
                <div class="scan-card" onclick="copyPayload(this)">
                    <h4>TCP Connect Scan (-sT)</h4>
                    <div class="command">nmap -sT 192.168.1.100</div>
                    <p>
                        <strong>Stealth:</strong> Low<br>
                        <strong>Speed:</strong> Slow<br>
                        <strong>Requires Root:</strong> No
                    </p>
                    <p>
                        Completes full TCP three-way handshake. Loudest scan type but doesn't require
                        root privileges. Easy to detect in logs.
                    </p>
                </div>

                <div class="scan-card" onclick="copyPayload(this)">
                    <h4>SYN Stealth Scan (-sS)</h4>
                    <div class="command">nmap -sS 192.168.1.100</div>
                    <p>
                        <strong>Stealth:</strong> Medium<br>
                        <strong>Speed:</strong> Fast<br>
                        <strong>Requires Root:</strong> Yes
                    </p>
                    <p>
                        Sends SYN, waits for SYN/ACK, then sends RST (doesn't complete handshake).
                        Default scan type. Faster and stealthier than TCP Connect.
                    </p>
                </div>

                <div class="scan-card" onclick="copyPayload(this)">
                    <h4>UDP Scan (-sU)</h4>
                    <div class="command">nmap -sU 192.168.1.100</div>
                    <p>
                        <strong>Stealth:</strong> Medium<br>
                        <strong>Speed:</strong> Very Slow<br>
                        <strong>Requires Root:</strong> Yes
                    </p>
                    <p>
                        Scans UDP ports. Much slower than TCP scans. Critical for finding DNS, SNMP,
                        DHCP services. Often overlooked by attackers and defenders.
                    </p>
                </div>

                <div class="scan-card" onclick="copyPayload(this)">
                    <h4>XMAS Scan (-sX)</h4>
                    <div class="command">nmap -sX 192.168.1.100</div>
                    <p>
                        <strong>Stealth:</strong> High<br>
                        <strong>Speed:</strong> Fast<br>
                        <strong>Requires Root:</strong> Yes
                    </p>
                    <p>
                        Sets FIN, PSH, and URG flags (packet "lit up like a Christmas tree").
                        Can bypass simple stateless firewalls. Works on Unix/Linux, not Windows.
                    </p>
                </div>

                <div class="scan-card" onclick="copyPayload(this)">
                    <h4>FIN Scan (-sF)</h4>
                    <div class="command">nmap -sF 192.168.1.100</div>
                    <p>
                        <strong>Stealth:</strong> High<br>
                        <strong>Speed:</strong> Fast<br>
                        <strong>Requires Root:</strong> Yes
                    </p>
                    <p>
                        Sends FIN flag only. Should receive RST from closed ports, nothing from open ports.
                        Stealthy but unreliable on Windows systems.
                    </p>
                </div>

                <div class="scan-card" onclick="copyPayload(this)">
                    <h4>NULL Scan (-sN)</h4>
                    <div class="command">nmap -sN 192.168.1.100</div>
                    <p>
                        <strong>Stealth:</strong> High<br>
                        <strong>Speed:</strong> Fast<br>
                        <strong>Requires Root:</strong> Yes
                    </p>
                    <p>
                        Sends packet with no flags set. Similar to FIN scan logic.
                        Very stealthy but may be flagged by modern IDS as abnormal traffic.
                    </p>
                </div>

                <div class="scan-card" onclick="copyPayload(this)">
                    <h4>ACK Scan (-sA)</h4>
                    <div class="command">nmap -sA 192.168.1.100</div>
                    <p>
                        <strong>Stealth:</strong> Medium<br>
                        <strong>Speed:</strong> Fast<br>
                        <strong>Requires Root:</strong> Yes
                    </p>
                    <p>
                        Sends ACK flag. Used to map firewall rulesets, not determine open ports.
                        Helps identify filtered vs. unfiltered ports.
                    </p>
                </div>

                <div class="scan-card" onclick="copyPayload(this)">
                    <h4>Idle/Zombie Scan (-sI)</h4>
                    <div class="command">nmap -sI zombie_host target</div>
                    <p>
                        <strong>Stealth:</strong> Maximum<br>
                        <strong>Speed:</strong> Very Slow<br>
                        <strong>Requires Root:</strong> Yes
                    </p>
                    <p>
                        Uses a "zombie" host to scan the target. Your IP never touches the target.
                        Extremely stealthy but requires finding a suitable zombie host.
                    </p>
                </div>
            </div>

            <h3>Common Port Scanning Commands</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code><span class="comment"># Scan specific ports</span>
<span class="cmd">nmap</span> <span class="flag">-p 22,80,443</span> <span class="target">192.168.1.100</span>

<span class="comment"># Scan port range</span>
<span class="cmd">nmap</span> <span class="flag">-p 1-1000</span> <span class="target">192.168.1.100</span>

<span class="comment"># Scan all 65535 ports</span>
<span class="cmd">nmap</span> <span class="flag">-p-</span> <span class="target">192.168.1.100</span>

<span class="comment"># Fast scan (top 100 ports)</span>
<span class="cmd">nmap</span> <span class="flag">-F</span> <span class="target">192.168.1.100</span>

<span class="comment"># Scan top 1000 ports (default)</span>
<span class="cmd">nmap</span> <span class="target">192.168.1.100</span>

<span class="comment"># Combined TCP SYN + UDP scan</span>
<span class="cmd">nmap</span> <span class="flag">-sS -sU -p U:53,111,137,T:21-25,80,443</span> <span class="target">192.168.1.100</span></code>
            </div>

            <div class="info-callout">
                <strong>Pro Tip:</strong> The default Nmap scan checks only the top 1000 most common ports.
                To find services on unusual ports, use <code>-p-</code> to scan all 65,535 ports,
                but be prepared for a much longer scan time.
            </div>
        </section>

        <!-- Service & Version Detection -->
        <section class="section">
            <h2>3. Service & Version Detection</h2>
            <p>
                Knowing a port is open isn't enough. We need to identify what service is running
                and its version to find potential vulnerabilities.
            </p>

            <h3>Banner Grabbing & Version Detection</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code><span class="comment"># Service version detection</span>
<span class="cmd">nmap</span> <span class="flag">-sV</span> <span class="target">192.168.1.100</span>

<span class="comment"># Aggressive version detection (more probes)</span>
<span class="cmd">nmap</span> <span class="flag">-sV --version-intensity 5</span> <span class="target">192.168.1.100</span>

<span class="comment"># Light version detection (fewer probes, faster)</span>
<span class="cmd">nmap</span> <span class="flag">-sV --version-intensity 0</span> <span class="target">192.168.1.100</span>

<span class="comment"># Version detection on specific ports</span>
<span class="cmd">nmap</span> <span class="flag">-sV -p 22,80,443</span> <span class="target">192.168.1.100</span></code>
            </div>

            <h3>OS Fingerprinting</h3>

            <h4>Active OS Detection</h4>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code><span class="comment"># OS detection</span>
<span class="cmd">nmap</span> <span class="flag">-O</span> <span class="target">192.168.1.100</span>

<span class="comment"># Aggressive OS detection attempts</span>
<span class="cmd">nmap</span> <span class="flag">-O --osscan-guess</span> <span class="target">192.168.1.100</span>

<span class="comment"># Limit OS detection to promising targets</span>
<span class="cmd">nmap</span> <span class="flag">-O --osscan-limit</span> <span class="target">192.168.1.0/24</span></code>
            </div>
            <p>
                Active OS detection sends specially crafted packets and analyzes responses to determine
                the operating system. Looks at TCP/IP stack implementation details, window sizes,
                and other unique fingerprints.
            </p>

            <h4>The Aggressive Scan (-A)</h4>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code><span class="comment"># Aggressive scan: OS detection + Version detection + Scripts + Traceroute</span>
<span class="cmd">nmap</span> <span class="flag">-A</span> <span class="target">192.168.1.100</span>

<span class="comment"># Equivalent to:</span>
<span class="cmd">nmap</span> <span class="flag">-O -sV -sC --traceroute</span> <span class="target">192.168.1.100</span></code>
            </div>

            <div class="warning-callout">
                <strong>Detection Warning:</strong> The <code>-A</code> flag is extremely loud.
                It triggers OS detection, service version probes, default NSE scripts, and traceroute.
                This will absolutely be logged and may trigger IDS alerts. Use only when stealth isn't a concern.
            </div>

            <h3>Sample Service Detection Output</h3>
            <div class="code-block">
                <code><span class="comment">Starting Nmap 7.94 ( https://nmap.org )</span>
Nmap scan report for 192.168.1.100
Host is up (0.0012s latency).

PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)
80/tcp  open  http     Apache httpd 2.4.52 ((Ubuntu))
443/tcp open  ssl/http Apache httpd 2.4.52 ((Ubuntu))
3306/tcp open mysql    MySQL 8.0.32-0ubuntu0.22.04.2

Service detection performed. Please report any incorrect results.
Nmap done: 1 IP address (1 host up) scanned in 12.45 seconds</code>
            </div>

            <div class="success-callout">
                <strong>Intelligence Value:</strong> Service versions reveal specific vulnerabilities.
                For example, "OpenSSH 8.9p1" can be checked against CVE databases.
                "Apache 2.4.52" can be tested for known exploits. This is where reconnaissance becomes actionable.
            </div>
        </section>

        <!-- IDS/Firewall Evasion -->
        <section class="section">
            <h2>4. IDS/Firewall Evasion Techniques</h2>
            <p>
                Modern networks deploy Intrusion Detection Systems (IDS), firewalls, and logging.
                These techniques help evade detection or bypass filtering.
            </p>

            <h3>Timing Templates</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code><span class="comment"># T0: Paranoid (serial, 5 min delays) - IDS evasion</span>
<span class="cmd">nmap</span> <span class="flag">-T0</span> <span class="target">192.168.1.100</span>

<span class="comment"># T1: Sneaky (serial, 15 sec delays)</span>
<span class="cmd">nmap</span> <span class="flag">-T1</span> <span class="target">192.168.1.100</span>

<span class="comment"># T2: Polite (serial, 0.4 sec delays) - reduces bandwidth</span>
<span class="cmd">nmap</span> <span class="flag">-T2</span> <span class="target">192.168.1.100</span>

<span class="comment"># T3: Normal (default) - balanced</span>
<span class="cmd">nmap</span> <span class="flag">-T3</span> <span class="target">192.168.1.100</span>

<span class="comment"># T4: Aggressive (parallel) - fast, assumes reliable network</span>
<span class="cmd">nmap</span> <span class="flag">-T4</span> <span class="target">192.168.1.100</span>

<span class="comment"># T5: Insane (parallel, very fast) - may miss results</span>
<span class="cmd">nmap</span> <span class="flag">-T5</span> <span class="target">192.168.1.100</span></code>
            </div>

            <h3>Packet Fragmentation</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code><span class="comment"># Fragment packets into 8 bytes (bypasses simple packet filters)</span>
<span class="cmd">nmap</span> <span class="flag">-f</span> <span class="target">192.168.1.100</span>

<span class="comment"># Double fragmentation (16 bytes)</span>
<span class="cmd">nmap</span> <span class="flag">-ff</span> <span class="target">192.168.1.100</span>

<span class="comment"># Custom MTU (must be multiple of 8)</span>
<span class="cmd">nmap</span> <span class="flag">--mtu 24</span> <span class="target">192.168.1.100</span></code>
            </div>
            <p>
                Fragmentation splits packets into smaller pieces. Some older firewalls and IDS
                can't properly reassemble fragmented packets, allowing scans to slip through.
            </p>

            <h3>Decoy Scanning</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code><span class="comment"># Use decoy IPs to hide your real IP in logs</span>
<span class="cmd">nmap</span> <span class="flag">-D RND:10</span> <span class="target">192.168.1.100</span>

<span class="comment"># Specify decoy IPs manually</span>
<span class="cmd">nmap</span> <span class="flag">-D 192.168.1.5,192.168.1.6,192.168.1.7,ME</span> <span class="target">192.168.1.100</span>

<span class="comment"># ME can be placed anywhere in the list</span>
<span class="cmd">nmap</span> <span class="flag">-D decoy1,decoy2,decoy3,ME,decoy4,decoy5</span> <span class="target">192.168.1.100</span></code>
            </div>
            <p>
                Decoy scanning makes it appear as if multiple IPs are scanning the target.
                Your real IP is hidden among decoys in the target's logs. Doesn't work against
                intrusion prevention systems (IPS) that can correlate responses.
            </p>

            <h3>Source Port Manipulation</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code><span class="comment"># Spoof source port (some firewalls trust port 53/DNS)</span>
<span class="cmd">nmap</span> <span class="flag">--source-port 53</span> <span class="target">192.168.1.100</span>

<span class="comment"># Alternative syntax</span>
<span class="cmd">nmap</span> <span class="flag">-g 53</span> <span class="target">192.168.1.100</span>

<span class="comment"># Common trusted ports: 20 (FTP), 53 (DNS), 88 (Kerberos)</span>
<span class="cmd">nmap</span> <span class="flag">--source-port 20</span> <span class="target">192.168.1.100</span></code>
            </div>

            <h3>MAC Address Spoofing</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code><span class="comment"># Spoof MAC address (local network only)</span>
<span class="cmd">nmap</span> <span class="flag">--spoof-mac Apple</span> <span class="target">192.168.1.100</span>

<span class="comment"># Specific MAC address</span>
<span class="cmd">nmap</span> <span class="flag">--spoof-mac 00:11:22:33:44:55</span> <span class="target">192.168.1.100</span>

<span class="comment"># Random MAC</span>
<span class="cmd">nmap</span> <span class="flag">--spoof-mac 0</span> <span class="target">192.168.1.100</span></code>
            </div>

            <h3>Combined Evasion Example</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code><span class="comment"># Maximum stealth scan combining multiple techniques</span>
<span class="cmd">nmap</span> <span class="flag">-sS -Pn -f -D RND:10 --source-port 53 -T2 --data-length 25</span> <span class="target">192.168.1.100</span>

<span class="comment"># Breakdown:</span>
<span class="comment"># -sS: SYN stealth scan</span>
<span class="comment"># -Pn: Skip ping (assume host is up)</span>
<span class="comment"># -f: Fragment packets</span>
<span class="comment"># -D RND:10: Use 10 random decoys</span>
<span class="comment"># --source-port 53: Spoof DNS source port</span>
<span class="comment"># -T2: Polite timing (slow and steady)</span>
<span class="comment"># --data-length 25: Append random data to packets</span></code>
            </div>

            <div class="warning-callout">
                <strong>Reality Check:</strong> While these evasion techniques can bypass basic firewalls,
                modern IDS/IPS systems (Snort, Suricata, commercial NGFWs) can detect and block most of them.
                Fragmentation is reassembled, decoys are correlated, and timing anomalies are flagged.
                These techniques are more effective against legacy systems.
            </div>
        </section>

        <!-- NSE Scripts -->
        <section class="section">
            <h2>5. Nmap Scripting Engine (NSE)</h2>
            <p>
                NSE extends Nmap's capabilities with hundreds of scripts for vulnerability detection,
                exploitation, authentication, and reconnaissance. Scripts are written in Lua.
            </p>

            <h3>Script Categories</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code><span class="comment"># Run default scripts (safe, fast, useful)</span>
<span class="cmd">nmap</span> <span class="flag">-sC</span> <span class="target">192.168.1.100</span>

<span class="comment"># Run specific script category</span>
<span class="cmd">nmap</span> <span class="flag">--script vuln</span> <span class="target">192.168.1.100</span>
<span class="cmd">nmap</span> <span class="flag">--script auth</span> <span class="target">192.168.1.100</span>
<span class="cmd">nmap</span> <span class="flag">--script discovery</span> <span class="target">192.168.1.100</span>
<span class="cmd">nmap</span> <span class="flag">--script exploit</span> <span class="target">192.168.1.100</span>

<span class="comment"># Run specific script</span>
<span class="cmd">nmap</span> <span class="flag">--script http-enum</span> <span class="target">192.168.1.100</span>

<span class="comment"># Run multiple scripts</span>
<span class="cmd">nmap</span> <span class="flag">--script "http-* and not http-brute"</span> <span class="target">192.168.1.100</span>

<span class="comment"># Update NSE script database</span>
<span class="cmd">nmap</span> <span class="flag">--script-updatedb</span></code>
            </div>

            <h3>Essential NSE Scripts</h3>

            <div class="nse-script-list">
                <div class="nse-script">
                    <div class="script-name">http-enum</div>
                    <div class="script-desc">Enumerates directories and files on web servers. Finds admin panels, backup files, config files.</div>
                    <div class="code-block" style="margin-top: 8px;">
                        <code>--script http-enum</code>
                    </div>
                </div>

                <div class="nse-script">
                    <div class="script-name">smb-vuln-ms17-010</div>
                    <div class="script-desc">Detects EternalBlue vulnerability (WannaCry exploit). Critical for Windows systems.</div>
                    <div class="code-block" style="margin-top: 8px;">
                        <code>--script smb-vuln-ms17-010</code>
                    </div>
                </div>

                <div class="nse-script">
                    <div class="script-name">ftp-anon</div>
                    <div class="script-desc">Checks if FTP server allows anonymous login. Common misconfiguration.</div>
                    <div class="code-block" style="margin-top: 8px;">
                        <code>--script ftp-anon</code>
                    </div>
                </div>

                <div class="nse-script">
                    <div class="script-name">ssh-auth-methods</div>
                    <div class="script-desc">Lists authentication methods supported by SSH server (password, key, etc).</div>
                    <div class="code-block" style="margin-top: 8px;">
                        <code>--script ssh-auth-methods</code>
                    </div>
                </div>

                <div class="nse-script">
                    <div class="script-name">ssl-cert</div>
                    <div class="script-desc">Retrieves SSL certificate information. Useful for identifying domains, expiration dates.</div>
                    <div class="code-block" style="margin-top: 8px;">
                        <code>--script ssl-cert</code>
                    </div>
                </div>

                <div class="nse-script">
                    <div class="script-name">dns-brute</div>
                    <div class="script-desc">Attempts to enumerate DNS hostnames by brute force. Finds subdomains.</div>
                    <div class="code-block" style="margin-top: 8px;">
                        <code>--script dns-brute</code>
                    </div>
                </div>

                <div class="nse-script">
                    <div class="script-name">mysql-empty-password</div>
                    <div class="script-desc">Checks for MySQL/MariaDB accounts with empty passwords. Common in dev environments.</div>
                    <div class="code-block" style="margin-top: 8px;">
                        <code>--script mysql-empty-password</code>
                    </div>
                </div>

                <div class="nse-script">
                    <div class="script-name">smb-os-discovery</div>
                    <div class="script-desc">Identifies OS, computer name, domain, and workgroup from SMB.</div>
                    <div class="code-block" style="margin-top: 8px;">
                        <code>--script smb-os-discovery</code>
                    </div>
                </div>

                <div class="nse-script">
                    <div class="script-name">http-sql-injection</div>
                    <div class="script-desc">Tests for SQL injection vulnerabilities in web applications.</div>
                    <div class="code-block" style="margin-top: 8px;">
                        <code>--script http-sql-injection</code>
                    </div>
                </div>

                <div class="nse-script">
                    <div class="script-name">ssh-brute</div>
                    <div class="script-desc">Performs brute force password auditing against SSH. Use responsibly.</div>
                    <div class="code-block" style="margin-top: 8px;">
                        <code>--script ssh-brute</code>
                    </div>
                </div>

                <div class="nse-script">
                    <div class="script-name">http-wordpress-enum</div>
                    <div class="script-desc">Enumerates WordPress users, plugins, themes. Critical for WordPress pentests.</div>
                    <div class="code-block" style="margin-top: 8px;">
                        <code>--script http-wordpress-enum</code>
                    </div>
                </div>

                <div class="nse-script">
                    <div class="script-name">vulners</div>
                    <div class="script-desc">Queries Vulners.com database for known CVEs based on detected service versions.</div>
                    <div class="code-block" style="margin-top: 8px;">
                        <code>--script vulners</code>
                    </div>
                </div>
            </div>

            <h3>NSE Script Arguments</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code><span class="comment"># Pass arguments to scripts</span>
<span class="cmd">nmap</span> <span class="flag">--script http-enum --script-args http-enum.basepath='/admin/'</span> <span class="target">192.168.1.100</span>

<span class="comment"># Multiple arguments</span>
<span class="cmd">nmap</span> <span class="flag">--script ssh-brute --script-args userdb=users.txt,passdb=pass.txt</span> <span class="target">192.168.1.100</span>

<span class="comment"># Get script help</span>
<span class="cmd">nmap</span> <span class="flag">--script-help http-enum</span></code>
            </div>

            <div class="success-callout">
                <strong>Offensive Arsenal:</strong> NSE scripts turn Nmap from a scanner into a vulnerability
                assessment tool. The 'vuln' category alone can identify hundreds of CVEs. Combined with
                version detection (<code>-sV</code>), you can quickly identify exploitable services.
            </div>
        </section>

        <!-- Output Formats -->
        <section class="section">
            <h2>6. Output Formats & Reporting</h2>
            <p>
                Proper output formatting is crucial for documentation, analysis, and importing
                results into other tools.
            </p>

            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code><span class="comment"># Normal output (human-readable)</span>
<span class="cmd">nmap</span> <span class="flag">-oN scan_results.txt</span> <span class="target">192.168.1.100</span>

<span class="comment"># XML output (for import into tools like Metasploit)</span>
<span class="cmd">nmap</span> <span class="flag">-oX scan_results.xml</span> <span class="target">192.168.1.100</span>

<span class="comment"># Grepable output (easy to parse with grep/awk)</span>
<span class="cmd">nmap</span> <span class="flag">-oG scan_results.gnmap</span> <span class="target">192.168.1.100</span>

<span class="comment"># All formats at once</span>
<span class="cmd">nmap</span> <span class="flag">-oA scan_results</span> <span class="target">192.168.1.100</span>

<span class="comment"># Append to existing file</span>
<span class="cmd">nmap</span> <span class="flag">-oN scan_results.txt --append-output</span> <span class="target">192.168.1.100</span>

<span class="comment"># Verbose output (realtime progress)</span>
<span class="cmd">nmap</span> <span class="flag">-v</span> <span class="target">192.168.1.100</span>

<span class="comment"># Very verbose</span>
<span class="cmd">nmap</span> <span class="flag">-vv</span> <span class="target">192.168.1.100</span>

<span class="comment"># Debug output (for troubleshooting)</span>
<span class="cmd">nmap</span> <span class="flag">-d</span> <span class="target">192.168.1.100</span></code>
            </div>

            <h3>Converting XML to HTML Report</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code><span class="comment"># Nmap includes XSLT for converting XML to HTML</span>
<span class="cmd">xsltproc</span> scan_results.xml <span class="flag">-o</span> report.html

<span class="comment"># Or use online converters/custom scripts</span></code>
            </div>
        </section>

        <!-- Interactive Command Builder -->
        <section class="section">
            <h2>Interactive Command Builder</h2>
            <p>Build custom Nmap commands with this interactive tool. Select options and copy the generated command.</p>

            <div class="command-builder">
                <h3>Nmap Command Generator</h3>

                <div class="builder-grid">
                    <div class="builder-section">
                        <label>Scan Type</label>
                        <select id="scanType">
                            <option value="">Default (SYN if root)</option>
                            <option value="-sS">SYN Stealth Scan (-sS)</option>
                            <option value="-sT">TCP Connect Scan (-sT)</option>
                            <option value="-sU">UDP Scan (-sU)</option>
                            <option value="-sN">NULL Scan (-sN)</option>
                            <option value="-sF">FIN Scan (-sF)</option>
                            <option value="-sX">XMAS Scan (-sX)</option>
                            <option value="-sA">ACK Scan (-sA)</option>
                        </select>
                    </div>

                    <div class="builder-section">
                        <label>Host Discovery</label>
                        <select id="hostDiscovery">
                            <option value="">Default (ICMP + TCP)</option>
                            <option value="-Pn">Skip Discovery (-Pn)</option>
                            <option value="-sn">Ping Scan Only (-sn)</option>
                            <option value="-PS">TCP SYN Ping (-PS)</option>
                            <option value="-PA">TCP ACK Ping (-PA)</option>
                            <option value="-PR">ARP Ping (-PR)</option>
                        </select>
                    </div>

                    <div class="builder-section">
                        <label>Port Specification</label>
                        <input type="text" id="portSpec" placeholder="e.g., 22,80,443 or 1-1000 or -">
                    </div>

                    <div class="builder-section">
                        <label>Timing Template</label>
                        <select id="timing">
                            <option value="">Normal (T3)</option>
                            <option value="-T0">Paranoid (-T0)</option>
                            <option value="-T1">Sneaky (-T1)</option>
                            <option value="-T2">Polite (-T2)</option>
                            <option value="-T3">Normal (-T3)</option>
                            <option value="-T4">Aggressive (-T4)</option>
                            <option value="-T5">Insane (-T5)</option>
                        </select>
                    </div>

                    <div class="builder-section">
                        <label>Output Format</label>
                        <select id="outputFormat">
                            <option value="">No Output File</option>
                            <option value="-oN output.txt">Normal (-oN)</option>
                            <option value="-oX output.xml">XML (-oX)</option>
                            <option value="-oG output.gnmap">Grepable (-oG)</option>
                            <option value="-oA output">All Formats (-oA)</option>
                        </select>
                    </div>

                    <div class="builder-section">
                        <label>Target (IP or hostname)</label>
                        <input type="text" id="target" placeholder="e.g., 192.168.1.100">
                    </div>
                </div>

                <div class="builder-section" style="margin-top: 20px;">
                    <label>Additional Options</label>
                    <div class="checkbox-group">
                        <label><input type="checkbox" id="opt-version"> Version Detection (-sV)</label>
                        <label><input type="checkbox" id="opt-os"> OS Detection (-O)</label>
                        <label><input type="checkbox" id="opt-scripts"> Default Scripts (-sC)</label>
                        <label><input type="checkbox" id="opt-aggressive"> Aggressive (-A)</label>
                        <label><input type="checkbox" id="opt-fragment"> Fragment Packets (-f)</label>
                        <label><input type="checkbox" id="opt-verbose"> Verbose (-v)</label>
                        <label><input type="checkbox" id="opt-allports"> All Ports (-p-)</label>
                        <label><input type="checkbox" id="opt-fastscan"> Fast Scan (-F)</label>
                    </div>
                </div>

                <div class="builder-section" style="margin-top: 20px;">
                    <label>Evasion Options</label>
                    <div class="checkbox-group">
                        <label><input type="checkbox" id="evade-decoy"> Random Decoys (-D RND:10)</label>
                        <label><input type="checkbox" id="evade-source"> Source Port 53 (--source-port 53)</label>
                        <label><input type="checkbox" id="evade-data"> Random Data (--data-length 25)</label>
                        <label><input type="checkbox" id="evade-badsum"> Bad Checksum (--badsum)</label>
                    </div>
                </div>

                <div class="generated-command" id="generatedCommand">
                    <button class="copy-btn" onclick="copyGeneratedCommand()">Copy Command</button>
                    <code id="commandOutput">nmap 192.168.1.100</code>
                </div>
            </div>
        </section>

        <!-- Scan Simulator -->
        <section class="section">
            <h2>Scan Output Simulator</h2>
            <p>Simulate different scan types to see what the output looks like. This helps understand what each scan reveals.</p>

            <div class="scan-simulator">
                <h3>Interactive Scan Simulator</h3>

                <div class="scan-controls">
                    <button class="scan-btn" onclick="simulateScan('ping')">Ping Sweep</button>
                    <button class="scan-btn" onclick="simulateScan('syn')">SYN Scan</button>
                    <button class="scan-btn" onclick="simulateScan('version')">Version Detection</button>
                    <button class="scan-btn" onclick="simulateScan('os')">OS Detection</button>
                    <button class="scan-btn" onclick="simulateScan('scripts')">NSE Scripts</button>
                    <button class="scan-btn" onclick="simulateScan('aggressive')">Aggressive Scan</button>
                    <button class="scan-btn" onclick="clearScanOutput()">Clear Output</button>
                </div>

                <div class="scan-output" id="scanOutput">Click a scan type above to see simulated output...</div>
            </div>
        </section>

        <!-- Quick Reference -->
        <section class="section">
            <h2>Quick Reference Cheat Sheet</h2>

            <h3>Most Common Commands</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code><span class="comment"># Basic scan</span>
<span class="cmd">nmap</span> <span class="target">192.168.1.100</span>

<span class="comment"># Quick scan (top 100 ports)</span>
<span class="cmd">nmap</span> <span class="flag">-F</span> <span class="target">192.168.1.100</span>

<span class="comment"># Comprehensive scan</span>
<span class="cmd">nmap</span> <span class="flag">-A -T4</span> <span class="target">192.168.1.100</span>

<span class="comment"># Scan entire subnet</span>
<span class="cmd">nmap</span> <span class="flag">-sn</span> <span class="target">192.168.1.0/24</span>

<span class="comment"># Scan specific ports with version detection</span>
<span class="cmd">nmap</span> <span class="flag">-sV -p 22,80,443,3389</span> <span class="target">192.168.1.100</span>

<span class="comment"># Stealthy scan with evasion</span>
<span class="cmd">nmap</span> <span class="flag">-sS -Pn -f -T2</span> <span class="target">192.168.1.100</span>

<span class="comment"># Vulnerability scan</span>
<span class="cmd">nmap</span> <span class="flag">-sV --script vuln</span> <span class="target">192.168.1.100</span>

<span class="comment"># UDP service discovery</span>
<span class="cmd">nmap</span> <span class="flag">-sU -p 53,67,68,161,162,500</span> <span class="target">192.168.1.100</span></code>
            </div>

            <h3>Port States</h3>
            <ul>
                <li><strong>Open:</strong> Application is listening on this port</li>
                <li><strong>Closed:</strong> Port is accessible but no application is listening</li>
                <li><strong>Filtered:</strong> Nmap can't determine if port is open (firewall blocking)</li>
                <li><strong>Unfiltered:</strong> Port is accessible but can't determine if open or closed (ACK scan)</li>
                <li><strong>Open|Filtered:</strong> Nmap can't determine between open and filtered</li>
                <li><strong>Closed|Filtered:</strong> Nmap can't determine between closed and filtered</li>
            </ul>
        </section>

        <!-- Quiz Section -->
        <div class="quiz-section">
            <h2>Knowledge Assessment Quiz</h2>
            <p style="text-align: center; color: #d1d5db; margin-bottom: 30px;">
                Test your understanding of network scanning concepts. You need 70% (7/10) to pass.
            </p>

            <div id="quizContainer"></div>

            <button class="submit-quiz-btn" onclick="gradeQuiz()">Submit Quiz</button>

            <div class="quiz-result" id="quizResult"></div>
        </div>

        <!-- Footer Navigation -->
        <div style="text-align: center; margin: 40px 0; padding: 20px;">
            <a href="../vault/index.html" style="color: #a855f7; text-decoration: none; font-size: 1.1em;">
                ← Back to Dark Arts Vault
            </a>
        </div>
    </div>

    <script>
        // Progress tracking
        const labProgress = {
            commandBuilderUsed: false,
            simulatorTested: false,
            quizCompleted: false
        };

        // Quiz Questions
        const quizQuestions = [
            {
                question: "Which Nmap scan type completes a full TCP three-way handshake and is easiest to detect in logs?",
                options: [
                    "SYN Stealth Scan (-sS)",
                    "TCP Connect Scan (-sT)",
                    "FIN Scan (-sF)",
                    "NULL Scan (-sN)"
                ],
                correct: 1
            },
            {
                question: "What does the -Pn flag do in an Nmap scan?",
                options: [
                    "Performs a ping sweep only",
                    "Skips host discovery and treats all hosts as online",
                    "Uses TCP ping instead of ICMP",
                    "Enables parallel scanning"
                ],
                correct: 1
            },
            {
                question: "Which scan type is most effective for discovering hosts on a local network (same subnet)?",
                options: [
                    "ICMP Echo Request",
                    "TCP SYN Ping",
                    "ARP Scan",
                    "UDP Ping"
                ],
                correct: 2
            },
            {
                question: "What flag combination represents an XMAS scan packet?",
                options: [
                    "SYN only",
                    "FIN, PSH, and URG",
                    "ACK only",
                    "No flags set"
                ],
                correct: 1
            },
            {
                question: "Which Nmap flag enables service version detection?",
                options: [
                    "-sV",
                    "-O",
                    "-A",
                    "-sC"
                ],
                correct: 0
            },
            {
                question: "What is the purpose of packet fragmentation (-f) in Nmap?",
                options: [
                    "To speed up the scan",
                    "To reduce bandwidth usage",
                    "To evade simple packet filters and firewalls",
                    "To improve accuracy of OS detection"
                ],
                correct: 2
            },
            {
                question: "Which timing template is the slowest and most stealthy?",
                options: [
                    "-T0 (Paranoid)",
                    "-T1 (Sneaky)",
                    "-T2 (Polite)",
                    "-T3 (Normal)"
                ],
                correct: 0
            },
            {
                question: "What does the NSE script 'smb-vuln-ms17-010' check for?",
                options: [
                    "SQL injection vulnerabilities",
                    "EternalBlue vulnerability (WannaCry)",
                    "Anonymous FTP access",
                    "Weak SSL/TLS configurations"
                ],
                correct: 1
            },
            {
                question: "Which scan type is best for mapping firewall rulesets but NOT for determining open ports?",
                options: [
                    "SYN Scan (-sS)",
                    "FIN Scan (-sF)",
                    "ACK Scan (-sA)",
                    "UDP Scan (-sU)"
                ],
                correct: 2
            },
            {
                question: "What does the -A flag in Nmap enable?",
                options: [
                    "Only OS detection",
                    "Only version detection",
                    "Aggressive scan: OS detection, version detection, scripts, and traceroute",
                    "ARP scanning only"
                ],
                correct: 2
            }
        ];

        let userAnswers = [];

        // Initialize quiz
        function initQuiz() {
            const container = document.getElementById('quizContainer');
            quizQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.innerHTML = `
                    <div class="question-text">${index + 1}. ${q.question}</div>
                    <div class="options">
                        ${q.options.map((opt, optIndex) => `
                            <div class="option" onclick="selectOption(${index}, ${optIndex}, this)">
                                ${opt}
                            </div>
                        `).join('')}
                    </div>
                `;
                container.appendChild(questionDiv);
            });
        }

        // Select quiz option
        function selectOption(questionIndex, optionIndex, element) {
            const question = element.parentElement;
            question.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
            userAnswers[questionIndex] = optionIndex;
        }

        // Grade quiz
        function gradeQuiz() {
            if (userAnswers.length !== quizQuestions.length) {
                alert('Please answer all questions before submitting.');
                return;
            }

            let correct = 0;
            quizQuestions.forEach((q, index) => {
                const questionDiv = document.querySelectorAll('.question')[index];
                const options = questionDiv.querySelectorAll('.option');

                options.forEach((opt, optIndex) => {
                    opt.classList.remove('selected');
                    if (optIndex === q.correct) {
                        opt.classList.add('correct');
                    } else if (optIndex === userAnswers[index]) {
                        opt.classList.add('incorrect');
                    }
                });

                if (userAnswers[index] === q.correct) {
                    correct++;
                }
            });

            const percentage = (correct / quizQuestions.length * 100).toFixed(0);
            const resultDiv = document.getElementById('quizResult');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `
                <h3>Quiz Results</h3>
                <p style="font-size: 2em; color: ${percentage >= 70 ? '#10b981' : '#dc2626'};">
                    ${correct} / ${quizQuestions.length} (${percentage}%)
                </p>
                <p>${percentage >= 70 ?
                    '🎯 Excellent work! You have a strong understanding of network scanning techniques.' :
                    '📚 Review the material and try again. You need 70% to pass.'}
                </p>
            `;

            if (percentage >= 70) {
                labProgress.quizCompleted = true;
                updateProgress();

                // Save progress using Hexworth systems
                if (typeof ModuleProgress !== 'undefined') {
                    ModuleProgress.complete('nmap-scanning-lab');
                }

                if (typeof AchievementManager !== 'undefined') {
                    AchievementManager.unlock('dark-arts-nmap-scanning');
                }
            }

            resultDiv.scrollIntoView({ behavior: 'smooth' });
        }

        // Command Builder
        function updateGeneratedCommand() {
            const scanType = document.getElementById('scanType').value;
            const hostDiscovery = document.getElementById('hostDiscovery').value;
            const portSpec = document.getElementById('portSpec').value.trim();
            const timing = document.getElementById('timing').value;
            const outputFormat = document.getElementById('outputFormat').value;
            const target = document.getElementById('target').value.trim() || '192.168.1.100';

            const optVersion = document.getElementById('opt-version').checked;
            const optOS = document.getElementById('opt-os').checked;
            const optScripts = document.getElementById('opt-scripts').checked;
            const optAggressive = document.getElementById('opt-aggressive').checked;
            const optFragment = document.getElementById('opt-fragment').checked;
            const optVerbose = document.getElementById('opt-verbose').checked;
            const optAllPorts = document.getElementById('opt-allports').checked;
            const optFastScan = document.getElementById('opt-fastscan').checked;

            const evadeDecoy = document.getElementById('evade-decoy').checked;
            const evadeSource = document.getElementById('evade-source').checked;
            const evadeData = document.getElementById('evade-data').checked;
            const evadeBadsum = document.getElementById('evade-badsum').checked;

            let command = 'nmap';

            if (scanType) command += ' ' + scanType;
            if (hostDiscovery) command += ' ' + hostDiscovery;
            if (portSpec && !optAllPorts && !optFastScan) command += ' -p ' + portSpec;
            if (timing) command += ' ' + timing;

            if (optAggressive) {
                command += ' -A';
            } else {
                if (optVersion) command += ' -sV';
                if (optOS) command += ' -O';
                if (optScripts) command += ' -sC';
            }

            if (optFragment) command += ' -f';
            if (optVerbose) command += ' -v';
            if (optAllPorts) command += ' -p-';
            if (optFastScan) command += ' -F';

            if (evadeDecoy) command += ' -D RND:10';
            if (evadeSource) command += ' --source-port 53';
            if (evadeData) command += ' --data-length 25';
            if (evadeBadsum) command += ' --badsum';

            if (outputFormat) command += ' ' + outputFormat;

            command += ' ' + target;

            document.getElementById('commandOutput').textContent = command;

            labProgress.commandBuilderUsed = true;
            updateProgress();
        }

        // Copy generated command
        function copyGeneratedCommand() {
            const command = document.getElementById('commandOutput').textContent;
            navigator.clipboard.writeText(command).then(() => {
                const btn = document.querySelector('.generated-command .copy-btn');
                const originalText = btn.textContent;
                btn.textContent = 'Copied!';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 2000);
            });
        }

        // Copy code blocks
        function copyCode(button) {
            const codeBlock = button.parentElement;
            const code = codeBlock.querySelector('code').innerText;
            navigator.clipboard.writeText(code).then(() => {
                const originalText = button.textContent;
                button.textContent = 'Copied!';
                setTimeout(() => {
                    button.textContent = originalText;
                }, 2000);
            });
        }

        // Copy from scan cards
        function copyPayload(card) {
            const command = card.querySelector('.command').textContent;
            navigator.clipboard.writeText(command).then(() => {
                const originalBorder = card.style.borderColor;
                card.style.borderColor = '#10b981';
                setTimeout(() => {
                    card.style.borderColor = originalBorder;
                }, 1000);
            });
        }

        // Tab switching
        function switchTab(tabId) {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabId).classList.add('active');
        }

        // Scan simulator
        function simulateScan(scanType) {
            const output = document.getElementById('scanOutput');
            output.textContent = '';

            labProgress.simulatorTested = true;
            updateProgress();

            const scanData = {
                ping: [
                    'Starting Nmap 7.94 ( https://nmap.org )',
                    'Nmap scan report for 192.168.1.1',
                    'Host is up (0.0023s latency).',
                    'MAC Address: 00:11:22:33:44:55 (Cisco Systems)',
                    '',
                    'Nmap scan report for 192.168.1.10',
                    'Host is up (0.0012s latency).',
                    'MAC Address: AA:BB:CC:DD:EE:FF (Dell)',
                    '',
                    'Nmap scan report for 192.168.1.25',
                    'Host is up (0.0008s latency).',
                    'MAC Address: 11:22:33:44:55:66 (Apple)',
                    '',
                    'Nmap done: 256 IP addresses (3 hosts up) scanned in 2.54 seconds'
                ],
                syn: [
                    'Starting Nmap 7.94 ( https://nmap.org )',
                    'Nmap scan report for webserver.local (192.168.1.100)',
                    'Host is up (0.00051s latency).',
                    '',
                    'PORT     STATE    SERVICE',
                    '21/tcp   closed   ftp',
                    '22/tcp   open     ssh',
                    '23/tcp   filtered telnet',
                    '80/tcp   open     http',
                    '443/tcp  open     https',
                    '3306/tcp open     mysql',
                    '3389/tcp closed   ms-wbt-server',
                    '8080/tcp open     http-proxy',
                    '',
                    'Nmap done: 1 IP address (1 host up) scanned in 0.84 seconds'
                ],
                version: [
                    'Starting Nmap 7.94 ( https://nmap.org )',
                    'Nmap scan report for webserver.local (192.168.1.100)',
                    'Host is up (0.00051s latency).',
                    '',
                    'PORT     STATE SERVICE  VERSION',
                    '22/tcp   open  ssh      OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)',
                    '80/tcp   open  http     Apache httpd 2.4.52 ((Ubuntu))',
                    '443/tcp  open  ssl/http Apache httpd 2.4.52 ((Ubuntu))',
                    '3306/tcp open  mysql    MySQL 8.0.32-0ubuntu0.22.04.2',
                    '8080/tcp open  http     Node.js Express framework',
                    '',
                    'Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel',
                    '',
                    'Service detection performed. Please report any incorrect results.',
                    'Nmap done: 1 IP address (1 host up) scanned in 12.34 seconds'
                ],
                os: [
                    'Starting Nmap 7.94 ( https://nmap.org )',
                    'Nmap scan report for webserver.local (192.168.1.100)',
                    'Host is up (0.00051s latency).',
                    '',
                    'PORT     STATE SERVICE',
                    '22/tcp   open  ssh',
                    '80/tcp   open  http',
                    '443/tcp  open  https',
                    '3306/tcp open  mysql',
                    '',
                    'Device type: general purpose',
                    'Running: Linux 5.X',
                    'OS CPE: cpe:/o:linux:linux_kernel:5.15',
                    'OS details: Linux 5.15 - 5.19',
                    'Network Distance: 1 hop',
                    '',
                    'OS detection performed. Please report any incorrect results.',
                    'Nmap done: 1 IP address (1 host up) scanned in 8.92 seconds'
                ],
                scripts: [
                    'Starting Nmap 7.94 ( https://nmap.org )',
                    'Nmap scan report for webserver.local (192.168.1.100)',
                    'Host is up (0.00051s latency).',
                    '',
                    'PORT     STATE SERVICE',
                    '21/tcp   open  ftp',
                    '| ftp-anon: Anonymous FTP login allowed (FTP code 230)',
                    '|_drwxr-xr-x   2 ftp      ftp          4096 Jan 15 10:23 pub',
                    '',
                    '80/tcp   open  http',
                    '| http-enum:',
                    '|   /admin/: Possible admin folder',
                    '|   /backup/: Backup folder w/ directory listing',
                    '|   /robots.txt: Robots file',
                    '|_  /phpmyadmin/: phpMyAdmin',
                    '',
                    '443/tcp  open  https',
                    '| ssl-cert: Subject: commonName=webserver.local',
                    '| Subject Alternative Name: DNS:webserver.local, DNS:www.webserver.local',
                    '| Issuer: commonName=webserver.local',
                    '| Public Key type: rsa',
                    '| Public Key bits: 2048',
                    '| Signature Algorithm: sha256WithRSAEncryption',
                    '| Not valid before: 2024-01-01T00:00:00',
                    '| Not valid after:  2025-01-01T00:00:00',
                    '|_SHA-1: 1234 5678 90AB CDEF 1234 5678 90AB CDEF 1234 5678',
                    '',
                    '3306/tcp open  mysql',
                    '| mysql-empty-password:',
                    '|_  root account has empty password',
                    '',
                    'Nmap done: 1 IP address (1 host up) scanned in 18.76 seconds'
                ],
                aggressive: [
                    'Starting Nmap 7.94 ( https://nmap.org )',
                    'Nmap scan report for webserver.local (192.168.1.100)',
                    'Host is up (0.00051s latency).',
                    '',
                    'PORT     STATE SERVICE  VERSION',
                    '22/tcp   open  ssh      OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)',
                    '| ssh-auth-methods:',
                    '|   Supported authentication methods:',
                    '|     publickey',
                    '|_    password',
                    '',
                    '80/tcp   open  http     Apache httpd 2.4.52 ((Ubuntu))',
                    '|_http-server-header: Apache/2.4.52 (Ubuntu)',
                    '|_http-title: Welcome to Ubuntu',
                    '| http-methods:',
                    '|_  Supported Methods: GET HEAD POST OPTIONS',
                    '',
                    '443/tcp  open  ssl/http Apache httpd 2.4.52',
                    '| ssl-cert: Subject: commonName=webserver.local/organizationName=Lab',
                    '| Not valid before: 2024-01-01T00:00:00',
                    '|_Not valid after:  2025-01-01T00:00:00',
                    '',
                    'Device type: general purpose',
                    'Running: Linux 5.X',
                    'OS CPE: cpe:/o:linux:linux_kernel:5.15',
                    'OS details: Linux 5.15 - 5.19',
                    '',
                    'TRACEROUTE',
                    'HOP RTT     ADDRESS',
                    '1   0.51 ms 192.168.1.100',
                    '',
                    'OS and Service detection performed.',
                    'Nmap done: 1 IP address (1 host up) scanned in 24.18 seconds'
                ]
            };

            const lines = scanData[scanType] || ['Unknown scan type'];
            let delay = 0;

            lines.forEach(line => {
                setTimeout(() => {
                    const lineDiv = document.createElement('div');
                    lineDiv.className = 'scan-line';
                    lineDiv.textContent = line;
                    output.appendChild(lineDiv);
                    output.scrollTop = output.scrollHeight;
                }, delay);
                delay += 100;
            });
        }

        function clearScanOutput() {
            document.getElementById('scanOutput').textContent = 'Click a scan type above to see simulated output...';
        }

        // Update progress indicators
        function updateProgress() {
            const progressItems = {
                'progress-command': labProgress.commandBuilderUsed,
                'progress-simulator': labProgress.simulatorTested,
                'progress-quiz': labProgress.quizCompleted
            };

            Object.entries(progressItems).forEach(([id, completed]) => {
                const element = document.getElementById(id);
                if (completed) {
                    element.classList.add('completed');
                }
            });
        }

        // Event listeners for command builder
        document.getElementById('scanType').addEventListener('change', updateGeneratedCommand);
        document.getElementById('hostDiscovery').addEventListener('change', updateGeneratedCommand);
        document.getElementById('portSpec').addEventListener('input', updateGeneratedCommand);
        document.getElementById('timing').addEventListener('change', updateGeneratedCommand);
        document.getElementById('outputFormat').addEventListener('change', updateGeneratedCommand);
        document.getElementById('target').addEventListener('input', updateGeneratedCommand);

        document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', updateGeneratedCommand);
        });

        // Initialize
        initQuiz();
        updateGeneratedCommand();
        updateProgress();

        // Console message
        console.log('%c[DARK ARTS LAB]', 'color: #a855f7; font-size: 14px; font-weight: bold;');
        console.log('%cNmap Scanning Laboratory initialized.', 'color: #c084fc; font-size: 12px;');
        console.log('%cRemember: Only scan authorized targets.', 'color: #dc2626; font-size: 11px;');
    </script>
<script src="../../components/FluxCapacitor.js"></script>
</body>
</html>
