<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Botnet Architecture & C2 - Hexworth Prime Dark Arts Vault</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #a855f7;
            --accent: #dc2626;
            --bg: #0a0a0f;
            --surface: #1a1a2e;
            --surface-light: #252538;
            --text: #e0e0e0;
            --text-dim: #a0a0a0;
            --success: #10b981;
            --warning: #f59e0b;
            --border: #333344;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .header {
            background: linear-gradient(135deg, var(--surface) 0%, var(--bg) 100%);
            border-bottom: 2px solid var(--primary);
            padding: 1.5rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .title {
            font-size: 2rem;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-buttons {
            display: flex;
            gap: 1rem;
        }

        .btn {
            padding: 0.6rem 1.2rem;
            border: 2px solid var(--primary);
            background: var(--surface);
            color: var(--text);
            cursor: pointer;
            border-radius: 8px;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn:hover {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(168, 85, 247, 0.4);
        }

        .btn-accent {
            border-color: var(--accent);
        }

        .btn-accent:hover {
            background: var(--accent);
            box-shadow: 0 5px 15px rgba(220, 38, 38, 0.4);
        }

        .progress-bar {
            background: var(--surface);
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 1rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            width: 0%;
            transition: width 0.5s ease;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .xp-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--surface);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            border: 2px solid var(--success);
            font-weight: bold;
        }

        .section {
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
        }

        .section:hover {
            border-color: var(--primary);
            box-shadow: 0 5px 20px rgba(168, 85, 247, 0.2);
        }

        .section-title {
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section-subtitle {
            font-size: 1.3rem;
            margin: 1.5rem 0 1rem;
            color: var(--accent);
        }

        .warning-box {
            background: rgba(220, 38, 38, 0.1);
            border-left: 4px solid var(--accent);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .info-box {
            background: rgba(168, 85, 247, 0.1);
            border-left: 4px solid var(--primary);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 1.5rem 0;
        }

        .card {
            background: var(--surface-light);
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .card:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(168, 85, 247, 0.3);
        }

        .card-title {
            font-size: 1.2rem;
            color: var(--primary);
            margin-bottom: 0.8rem;
        }

        .card-content {
            color: var(--text-dim);
            font-size: 0.95rem;
        }

        .canvas-container {
            position: relative;
            background: var(--bg);
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
            margin: 1.5rem 0;
        }

        canvas {
            display: block;
            width: 100%;
            border-radius: 4px;
        }

        .controls {
            display: flex;
            gap: 1rem;
            margin: 1rem 0;
            flex-wrap: wrap;
        }

        .control-btn {
            padding: 0.5rem 1rem;
            background: var(--surface-light);
            border: 2px solid var(--primary);
            color: var(--text);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: var(--primary);
        }

        .control-btn.active {
            background: var(--primary);
            box-shadow: 0 0 15px rgba(168, 85, 247, 0.5);
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 1rem;
            text-align: left;
            border: 1px solid var(--border);
        }

        .comparison-table th {
            background: var(--surface-light);
            color: var(--primary);
            font-weight: bold;
        }

        .comparison-table tr:hover {
            background: var(--surface-light);
        }

        .tag {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            background: var(--surface-light);
            border: 1px solid var(--primary);
            border-radius: 12px;
            font-size: 0.85rem;
            margin: 0.2rem;
        }

        .tag.danger {
            border-color: var(--accent);
            color: var(--accent);
        }

        .tag.warning {
            border-color: var(--warning);
            color: var(--warning);
        }

        .tag.success {
            border-color: var(--success);
            color: var(--success);
        }

        .quiz-container {
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 2rem;
            margin-top: 2rem;
        }

        .question {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--surface-light);
            border-radius: 8px;
            border: 2px solid var(--border);
        }

        .question-text {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            color: var(--primary);
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .option {
            padding: 1rem;
            background: var(--bg);
            border: 2px solid var(--border);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover {
            border-color: var(--primary);
            transform: translateX(5px);
        }

        .option.selected {
            border-color: var(--primary);
            background: rgba(168, 85, 247, 0.1);
        }

        .option.correct {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.1);
        }

        .option.incorrect {
            border-color: var(--accent);
            background: rgba(220, 38, 38, 0.1);
        }

        .quiz-results {
            text-align: center;
            padding: 2rem;
            background: var(--surface-light);
            border-radius: 8px;
            margin-top: 2rem;
        }

        .score-display {
            font-size: 3rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .lifecycle-stage {
            position: relative;
            padding: 1rem;
            background: var(--surface-light);
            border-left: 4px solid var(--primary);
            margin: 1rem 0;
            border-radius: 4px;
            opacity: 0.3;
            transition: all 0.5s ease;
        }

        .lifecycle-stage.active {
            opacity: 1;
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.5);
        }

        .timeline {
            position: relative;
            padding-left: 2rem;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--primary);
        }

        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .stat-card {
            background: var(--surface-light);
            padding: 1.5rem;
            border-radius: 8px;
            border: 2px solid var(--border);
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
        }

        .stat-label {
            color: var(--text-dim);
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .pulse {
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes slideIn {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .slide-in {
            animation: slideIn 0.5s ease-out;
        }

        .detection-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }

        .detection-indicator.low {
            background: var(--success);
        }

        .detection-indicator.medium {
            background: var(--warning);
        }

        .detection-indicator.high {
            background: var(--accent);
        }

        @media (max-width: 768px) {
            .title {
                font-size: 1.5rem;
            }

            .container {
                padding: 1rem;
            }

            .section {
                padding: 1rem;
            }

            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div>
                <h1 class="title">Botnet Architecture & C2</h1>
                <div class="xp-badge">
                    <span>üéØ</span>
                    <span id="xpDisplay">0 / 65 XP</span>
                </div>
            </div>
            <div class="nav-buttons">
                <a href="../index.html" class="btn">‚Üê Dark Arts Vault</a>
                <button class="btn btn-accent" onclick="resetProgress()">Reset Progress</button>
            </div>
        </div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressBar"></div>
        </div>
    </div>

    <div class="container">
        <!-- Introduction Section -->
        <section class="section slide-in">
            <h2 class="section-title">üï∏Ô∏è Understanding Botnets</h2>

            <div class="warning-box">
                <strong>‚ö†Ô∏è Defensive Learning:</strong> This module teaches botnet architecture and C2 mechanisms for defensive purposes only. Understanding these systems is critical for network defense, incident response, and threat intelligence.
            </div>

            <p style="margin: 1.5rem 0;">A <strong>botnet</strong> is a network of compromised computers (called bots or zombies) controlled by an attacker (botmaster) through a Command & Control (C2) infrastructure. Botnets represent one of the most significant threats in modern cybersecurity.</p>

            <div class="info-box">
                <strong>Key Concepts:</strong>
                <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                    <li><strong>Bot/Zombie:</strong> Individual compromised machine under attacker control</li>
                    <li><strong>Botmaster:</strong> The attacker controlling the botnet</li>
                    <li><strong>C2 (Command & Control):</strong> Communication infrastructure for issuing commands</li>
                    <li><strong>Botnet:</strong> Collection of all compromised bots under unified control</li>
                </ul>
            </div>

            <h3 class="section-subtitle">Botnet Uses & Motivations</h3>
            <div class="grid">
                <div class="card">
                    <div class="card-title">üí• DDoS Attacks</div>
                    <div class="card-content">
                        Overwhelming targets with massive traffic volumes from distributed bots. Can take down major websites and services.
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="tag danger">High Impact</span>
                        <span class="tag">Most Common</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">üìß Spam Distribution</div>
                    <div class="card-content">
                        Sending massive volumes of spam emails for phishing, malware distribution, or advertising campaigns.
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="tag warning">Medium Impact</span>
                        <span class="tag">Financial</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">‚õèÔ∏è Crypto Mining</div>
                    <div class="card-content">
                        Using compromised CPU/GPU resources to mine cryptocurrencies, generating revenue for attackers.
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="tag warning">Resource Drain</span>
                        <span class="tag">Growing Trend</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">üîë Credential Theft</div>
                    <div class="card-content">
                        Harvesting credentials, financial data, and personal information from infected machines.
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="tag danger">Critical</span>
                        <span class="tag">Banking Trojans</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">üñ±Ô∏è Click Fraud</div>
                    <div class="card-content">
                        Generating fake clicks on online advertisements to generate fraudulent revenue.
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="tag warning">Financial</span>
                        <span class="tag">Ad Networks</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">üéØ Proxy Networks</div>
                    <div class="card-content">
                        Using compromised machines as proxies to hide malicious traffic origins and evade detection.
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="tag">Anonymization</span>
                        <span class="tag">Traffic Routing</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- C2 Architecture Comparison -->
        <section class="section">
            <h2 class="section-title">üèóÔ∏è C2 Architecture Types</h2>

            <div class="controls">
                <button class="control-btn active" onclick="showArchitecture('centralized')">Centralized</button>
                <button class="control-btn" onclick="showArchitecture('p2p')">P2P (Decentralized)</button>
                <button class="control-btn" onclick="showArchitecture('hybrid')">Hybrid</button>
            </div>

            <div class="canvas-container">
                <canvas id="architectureCanvas" width="1200" height="500"></canvas>
            </div>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Architecture</th>
                        <th>Pros</th>
                        <th>Cons</th>
                        <th>Examples</th>
                        <th>Detection</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Centralized (IRC/HTTP)</strong></td>
                        <td>Simple to implement, easy command distribution, fast updates</td>
                        <td>Single point of failure, easy to take down, traceable</td>
                        <td>Zeus, Necurs, early botnets</td>
                        <td><span class="detection-indicator low"></span>Easy</td>
                    </tr>
                    <tr>
                        <td><strong>P2P (Decentralized)</strong></td>
                        <td>No single point of failure, resilient, hard to take down</td>
                        <td>Complex to implement, slower updates, more traffic</td>
                        <td>Conficker, ZeroAccess</td>
                        <td><span class="detection-indicator high"></span>Difficult</td>
                    </tr>
                    <tr>
                        <td><strong>Hybrid</strong></td>
                        <td>Balanced approach, fallback mechanisms, flexible</td>
                        <td>Increased complexity, multiple detection vectors</td>
                        <td>Mirai variants, modern botnets</td>
                        <td><span class="detection-indicator medium"></span>Moderate</td>
                    </tr>
                </tbody>
            </table>

            <h3 class="section-subtitle">C2 Protocol Comparison</h3>
            <div class="grid">
                <div class="card">
                    <div class="card-title">IRC-based C2</div>
                    <div class="card-content">
                        <strong>Protocol:</strong> Internet Relay Chat<br>
                        <strong>Method:</strong> Bots join IRC channels, wait for commands<br>
                        <strong>Detection:</strong> IRC traffic patterns, channel monitoring<br>
                        <strong>Era:</strong> Early botnets (2000s)
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">HTTP/HTTPS-based C2</div>
                    <div class="card-content">
                        <strong>Protocol:</strong> Web traffic (GET/POST)<br>
                        <strong>Method:</strong> Bots poll C2 servers, receive commands<br>
                        <strong>Detection:</strong> URL patterns, beaconing intervals<br>
                        <strong>Era:</strong> Modern botnets (2010s+)
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">DNS-based C2</div>
                    <div class="card-content">
                        <strong>Protocol:</strong> DNS queries/responses<br>
                        <strong>Method:</strong> Commands encoded in DNS records<br>
                        <strong>Detection:</strong> Unusual query patterns, data exfiltration<br>
                        <strong>Era:</strong> Evasive techniques (2015+)
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">P2P-based C2</div>
                    <div class="card-content">
                        <strong>Protocol:</strong> Peer-to-peer networks<br>
                        <strong>Method:</strong> Bots communicate directly, relay commands<br>
                        <strong>Detection:</strong> P2P traffic analysis, network topology<br>
                        <strong>Era:</strong> Resilient botnets (2010s+)
                    </div>
                </div>
            </div>
        </section>

        <!-- Bot Lifecycle Animation -->
        <section class="section">
            <h2 class="section-title">üîÑ Bot Lifecycle</h2>

            <div class="controls">
                <button class="control-btn" onclick="startLifecycle()">‚ñ∂Ô∏è Start Animation</button>
                <button class="control-btn" onclick="resetLifecycle()">üîÑ Reset</button>
            </div>

            <div class="canvas-container">
                <canvas id="lifecycleCanvas" width="1200" height="400"></canvas>
            </div>

            <div class="timeline">
                <div class="lifecycle-stage" id="stage1">
                    <h3 style="color: var(--primary);">1. Infection</h3>
                    <p>Target machine is compromised through exploit, phishing, drive-by download, or other attack vector. Malware payload is installed.</p>
                </div>

                <div class="lifecycle-stage" id="stage2">
                    <h3 style="color: var(--primary);">2. Callback (Phone Home)</h3>
                    <p>Bot establishes initial connection to C2 infrastructure. Registers with botnet, sends system information, awaits further instructions.</p>
                </div>

                <div class="lifecycle-stage" id="stage3">
                    <h3 style="color: var(--primary);">3. Command Reception</h3>
                    <p>Bot receives commands from C2 server. Commands may include: update malware, execute DDoS, steal data, install additional payloads.</p>
                </div>

                <div class="lifecycle-stage" id="stage4">
                    <h3 style="color: var(--primary);">4. Action Execution</h3>
                    <p>Bot executes received commands. May perform DDoS attacks, send spam, mine cryptocurrency, steal credentials, or propagate to new targets.</p>
                </div>

                <div class="lifecycle-stage" id="stage5">
                    <h3 style="color: var(--primary);">5. Persistence & Updates</h3>
                    <p>Bot maintains persistence on infected system. Receives updates, new commands, and evolves to evade detection. Cycle repeats.</p>
                </div>
            </div>
        </section>

        <!-- Infection Spread Visualization -->
        <section class="section">
            <h2 class="section-title">ü¶† Infection Spread Visualization</h2>

            <div class="controls">
                <button class="control-btn" onclick="startInfection()">‚ñ∂Ô∏è Start Spread</button>
                <button class="control-btn" onclick="pauseInfection()">‚è∏Ô∏è Pause</button>
                <button class="control-btn" onclick="resetInfection()">üîÑ Reset</button>
                <label style="color: var(--text); margin-left: 1rem;">
                    Speed: <input type="range" id="speedControl" min="1" max="10" value="5" style="vertical-align: middle;">
                </label>
            </div>

            <div class="canvas-container">
                <canvas id="infectionCanvas" width="1200" height="500"></canvas>
            </div>

            <div class="stat-grid">
                <div class="stat-card">
                    <div class="stat-value" id="infectedCount">0</div>
                    <div class="stat-label">Infected Machines</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="healthyCount">100</div>
                    <div class="stat-label">Healthy Machines</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="infectionRate">0%</div>
                    <div class="stat-label">Infection Rate</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="botsActive">0</div>
                    <div class="stat-label">Active C2 Connections</div>
                </div>
            </div>
        </section>

        <!-- Famous Botnets Case Studies -->
        <section class="section">
            <h2 class="section-title">üìö Famous Botnet Case Studies</h2>

            <div class="grid">
                <div class="card">
                    <div class="card-title">üåê Mirai (2016)</div>
                    <div class="card-content">
                        <strong>Type:</strong> IoT Botnet<br>
                        <strong>Size:</strong> ~600,000 devices<br>
                        <strong>Attack:</strong> DDoS on Dyn DNS, taking down major sites<br>
                        <strong>Method:</strong> Default credentials on IoT devices<br>
                        <strong>Impact:</strong> Netflix, Twitter, Reddit offline for hours<br>
                        <strong>Takedown:</strong> Source code leaked, spawned many variants
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="tag danger">Critical Impact</span>
                        <span class="tag">IoT</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">üí∞ Zeus (2007-2014)</div>
                    <div class="card-content">
                        <strong>Type:</strong> Banking Trojan<br>
                        <strong>Size:</strong> 3.6M+ infected machines (peak)<br>
                        <strong>Attack:</strong> Credential theft, form grabbing<br>
                        <strong>Method:</strong> Drive-by downloads, phishing<br>
                        <strong>Impact:</strong> $100M+ stolen from accounts<br>
                        <strong>Takedown:</strong> Operation Trident Breach (FBI)
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="tag danger">Financial Crime</span>
                        <span class="tag">Trojan</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">üî• Emotet (2014-2021)</div>
                    <div class="card-content">
                        <strong>Type:</strong> Polymorphic Malware<br>
                        <strong>Size:</strong> 1M+ infected machines<br>
                        <strong>Attack:</strong> Spam, credential theft, malware dropper<br>
                        <strong>Method:</strong> Malicious email attachments<br>
                        <strong>Impact:</strong> Billions in global damages<br>
                        <strong>Takedown:</strong> International law enforcement (Jan 2021)
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="tag danger">Polymorphic</span>
                        <span class="tag success">Neutralized</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">üì® Necurs (2012-2020)</div>
                    <div class="card-content">
                        <strong>Type:</strong> Spam Botnet<br>
                        <strong>Size:</strong> 9M+ infected machines<br>
                        <strong>Attack:</strong> Spam distribution (billions/day)<br>
                        <strong>Method:</strong> Exploit kits, malvertising<br>
                        <strong>Impact:</strong> 90% of global spam at peak<br>
                        <strong>Takedown:</strong> Microsoft legal/technical action (2020)
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="tag warning">Spam</span>
                        <span class="tag success">Disrupted</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">üêõ Conficker (2008-present)</div>
                    <div class="card-content">
                        <strong>Type:</strong> Worm<br>
                        <strong>Size:</strong> 15M+ infected machines<br>
                        <strong>Attack:</strong> Self-propagating, multi-purpose<br>
                        <strong>Method:</strong> MS08-067 exploit, USB propagation<br>
                        <strong>Impact:</strong> Still active in legacy systems<br>
                        <strong>Takedown:</strong> Partially disrupted, never fully eliminated
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="tag danger">Persistent</span>
                        <span class="tag">P2P</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">üé∞ ZeroAccess (2011-2013)</div>
                    <div class="card-content">
                        <strong>Type:</strong> Rootkit Botnet<br>
                        <strong>Size:</strong> 2M+ infected machines<br>
                        <strong>Attack:</strong> Click fraud, Bitcoin mining<br>
                        <strong>Method:</strong> P2P architecture, rootkit stealth<br>
                        <strong>Impact:</strong> $100K+/day in fraudulent revenue<br>
                        <strong>Takedown:</strong> Microsoft/FBI sinkhole operation
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="tag warning">Click Fraud</span>
                        <span class="tag">Rootkit</span>
                    </div>
                </div>
            </div>

            <div class="info-box" style="margin-top: 2rem;">
                <strong>üí° Pattern Analysis:</strong> Most successful botnets share common traits: self-propagation mechanisms, resilient C2 infrastructure, evasion techniques, and monetization strategies. Modern botnets increasingly target IoT devices due to weak security.
            </div>
        </section>

        <!-- Detection Techniques -->
        <section class="section">
            <h2 class="section-title">üîç Detection & Defense Techniques</h2>

            <h3 class="section-subtitle">Detection Methods</h3>
            <div class="grid">
                <div class="card">
                    <div class="card-title">üåê Network Anomaly Detection</div>
                    <div class="card-content">
                        Monitor for unusual traffic patterns: beaconing intervals, connection to known C2 IPs, abnormal DNS queries, port scanning activity.
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="tag success">Effective</span>
                        <span class="tag">Network Layer</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">üîé DNS Monitoring</div>
                    <div class="card-content">
                        Analyze DNS queries for domain generation algorithms (DGA), connections to suspicious domains, DNS tunneling attempts.
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="tag success">Critical</span>
                        <span class="tag">DNS Layer</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">üìä Behavioral Analysis</div>
                    <div class="card-content">
                        Track system behavior: unusual processes, registry modifications, file changes, CPU/network usage spikes indicating compromise.
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="tag warning">Resource Intensive</span>
                        <span class="tag">Host Layer</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">üõ°Ô∏è Signature-based Detection</div>
                    <div class="card-content">
                        Use IDS/IPS with updated signatures to identify known bot malware, C2 traffic patterns, and exploit attempts.
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="tag warning">Limited</span>
                        <span class="tag">Signature Layer</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">ü§ñ Machine Learning</div>
                    <div class="card-content">
                        Train ML models to identify botnet traffic, zero-day threats, and anomalous behavior patterns in network flows.
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="tag success">Advanced</span>
                        <span class="tag">AI-Powered</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">üî¨ Honeypot Analysis</div>
                    <div class="card-content">
                        Deploy honeypots to attract bot traffic, analyze infection methods, capture malware samples, identify C2 infrastructure.
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="tag">Research</span>
                        <span class="tag">Intelligence</span>
                    </div>
                </div>
            </div>

            <h3 class="section-subtitle">Takedown Methods</h3>
            <div class="controls">
                <button class="control-btn" onclick="demonstrateSinkhole()">üï≥Ô∏è Sinkhole Demo</button>
                <button class="control-btn" onclick="demonstrateDomain()">üåê Domain Seizure</button>
                <button class="control-btn" onclick="demonstratePatch()">üîß Patch Distribution</button>
            </div>

            <div class="canvas-container">
                <canvas id="takedownCanvas" width="1200" height="400"></canvas>
            </div>

            <div class="grid" style="margin-top: 2rem;">
                <div class="card">
                    <div class="card-title">üï≥Ô∏è Sinkholing</div>
                    <div class="card-content">
                        Redirect bot traffic to researcher-controlled servers. Allows monitoring infected machines, preventing malicious commands, gathering intelligence on botnet size and scope.
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">‚öñÔ∏è Legal Takedown</div>
                    <div class="card-content">
                        Law enforcement obtains court orders to seize C2 servers, arrest botmasters. Requires international cooperation and evidence gathering.
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">üåê Domain Seizure</div>
                    <div class="card-content">
                        Registrars seize domains used for C2. Effective against centralized botnets, less effective against P2P or DGA-based systems.
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">üîß Patch Distribution</div>
                    <div class="card-content">
                        Close exploited vulnerabilities, distribute security patches, educate users. Long-term prevention strategy requiring user cooperation.
                    </div>
                </div>
            </div>
        </section>

        <!-- Quiz Section -->
        <section class="section">
            <h2 class="section-title">üìù Knowledge Assessment</h2>

            <div class="quiz-container" id="quizContainer">
                <!-- Quiz questions will be inserted here by JavaScript -->
            </div>

            <div style="text-align: center; margin-top: 2rem;">
                <button class="btn btn-accent" onclick="submitQuiz()" id="submitBtn">Submit Answers</button>
                <button class="btn" onclick="retakeQuiz()" id="retakeBtn" style="display: none;">Retake Quiz</button>
            </div>

            <div id="quizResults" style="display: none;"></div>
        </section>

        <!-- Completion -->
        <section class="section" id="completionSection" style="display: none;">
            <h2 class="section-title">üéâ Module Complete!</h2>
            <div style="text-align: center; padding: 2rem;">
                <div class="score-display">65 XP Earned!</div>
                <p style="margin: 2rem 0; font-size: 1.2rem;">You've mastered Botnet Architecture & C2 fundamentals!</p>
                <div class="controls" style="justify-content: center;">
                    <a href="../index.html" class="btn">‚Üê Return to Dark Arts Vault</a>
                    <button class="btn btn-accent" onclick="retakeQuiz()">Review Quiz</button>
                </div>
            </div>
        </section>
    </div>

    <script>
        // Progress Tracking
        let currentXP = 0;
        const totalXP = 65;
        let quizCompleted = false;

        // Load saved progress
        function loadProgress() {
            const saved = localStorage.getItem('botnet_progress');
            if (saved) {
                const data = JSON.parse(saved);
                currentXP = data.xp || 0;
                quizCompleted = data.quizCompleted || false;
                updateProgress();
                if (quizCompleted) {
                    document.getElementById('completionSection').style.display = 'block';
                }
            }
        }

        function saveProgress() {
            localStorage.setItem('botnet_progress', JSON.stringify({
                xp: currentXP,
                quizCompleted: quizCompleted
            }));
        }

        function updateProgress() {
            document.getElementById('xpDisplay').textContent = `${currentXP} / ${totalXP} XP`;
            const percentage = (currentXP / totalXP) * 100;
            document.getElementById('progressBar').style.width = percentage + '%';
        }

        function awardXP(amount) {
            currentXP = Math.min(currentXP + amount, totalXP);
            updateProgress();
            saveProgress();
        }

        function resetProgress() {
            if (confirm('Reset all progress? This will clear your XP and quiz results.')) {
                localStorage.removeItem('botnet_progress');
                currentXP = 0;
                quizCompleted = false;
                updateProgress();
                location.reload();
            }
        }

        // C2 Architecture Visualization
        const archCanvas = document.getElementById('architectureCanvas');
        const archCtx = archCanvas.getContext('2d');
        let currentArchitecture = 'centralized';

        function showArchitecture(type) {
            currentArchitecture = type;

            // Update button states
            document.querySelectorAll('.controls .control-btn').forEach((btn, idx) => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            drawArchitecture();
        }

        function drawArchitecture() {
            archCtx.clearRect(0, 0, archCanvas.width, archCanvas.height);

            if (currentArchitecture === 'centralized') {
                drawCentralized();
            } else if (currentArchitecture === 'p2p') {
                drawP2P();
            } else {
                drawHybrid();
            }
        }

        function drawCentralized() {
            const centerX = archCanvas.width / 2;
            const centerY = archCanvas.height / 2;

            // Draw C2 server
            archCtx.fillStyle = '#dc2626';
            archCtx.beginPath();
            archCtx.arc(centerX, centerY, 40, 0, Math.PI * 2);
            archCtx.fill();
            archCtx.strokeStyle = '#fff';
            archCtx.lineWidth = 3;
            archCtx.stroke();

            archCtx.fillStyle = '#fff';
            archCtx.font = 'bold 14px Arial';
            archCtx.textAlign = 'center';
            archCtx.fillText('C2 Server', centerX, centerY);

            // Draw bots in circle
            const numBots = 12;
            const radius = 200;

            for (let i = 0; i < numBots; i++) {
                const angle = (i / numBots) * Math.PI * 2;
                const x = centerX + Math.cos(angle) * radius;
                const y = centerY + Math.sin(angle) * radius;

                // Draw connection line
                archCtx.strokeStyle = '#a855f7';
                archCtx.lineWidth = 2;
                archCtx.setLineDash([5, 5]);
                archCtx.beginPath();
                archCtx.moveTo(centerX, centerY);
                archCtx.lineTo(x, y);
                archCtx.stroke();
                archCtx.setLineDash([]);

                // Draw bot
                archCtx.fillStyle = '#a855f7';
                archCtx.beginPath();
                archCtx.arc(x, y, 20, 0, Math.PI * 2);
                archCtx.fill();
                archCtx.strokeStyle = '#fff';
                archCtx.lineWidth = 2;
                archCtx.stroke();
            }

            // Draw label
            archCtx.fillStyle = '#e0e0e0';
            archCtx.font = '16px Arial';
            archCtx.fillText('Centralized Architecture: All bots connect to single C2 server', centerX, 30);
        }

        function drawP2P() {
            const centerX = archCanvas.width / 2;
            const centerY = archCanvas.height / 2;

            // Create nodes
            const nodes = [];
            const numNodes = 15;
            const radius = 180;

            for (let i = 0; i < numNodes; i++) {
                const angle = (i / numNodes) * Math.PI * 2;
                nodes.push({
                    x: centerX + Math.cos(angle) * radius,
                    y: centerY + Math.sin(angle) * radius
                });
            }

            // Draw connections between peers
            archCtx.strokeStyle = '#a855f7';
            archCtx.lineWidth = 2;
            archCtx.setLineDash([5, 5]);

            for (let i = 0; i < nodes.length; i++) {
                // Connect to 2-3 neighbors
                for (let j = 1; j <= 3; j++) {
                    const target = (i + j) % nodes.length;
                    archCtx.beginPath();
                    archCtx.moveTo(nodes[i].x, nodes[i].y);
                    archCtx.lineTo(nodes[target].x, nodes[target].y);
                    archCtx.stroke();
                }
            }
            archCtx.setLineDash([]);

            // Draw nodes
            nodes.forEach((node, idx) => {
                archCtx.fillStyle = idx === 0 ? '#dc2626' : '#a855f7';
                archCtx.beginPath();
                archCtx.arc(node.x, node.y, 20, 0, Math.PI * 2);
                archCtx.fill();
                archCtx.strokeStyle = '#fff';
                archCtx.lineWidth = 2;
                archCtx.stroke();
            });

            // Draw label
            archCtx.fillStyle = '#e0e0e0';
            archCtx.font = '16px Arial';
            archCtx.textAlign = 'center';
            archCtx.fillText('P2P Architecture: Bots communicate directly, no central server', centerX, 30);
        }

        function drawHybrid() {
            const centerX = archCanvas.width / 2;
            const centerY = archCanvas.height / 2;

            // Draw primary C2
            archCtx.fillStyle = '#dc2626';
            archCtx.beginPath();
            archCtx.arc(centerX - 150, centerY, 35, 0, Math.PI * 2);
            archCtx.fill();
            archCtx.strokeStyle = '#fff';
            archCtx.lineWidth = 3;
            archCtx.stroke();

            archCtx.fillStyle = '#fff';
            archCtx.font = 'bold 12px Arial';
            archCtx.textAlign = 'center';
            archCtx.fillText('Primary', centerX - 150, centerY - 5);
            archCtx.fillText('C2', centerX - 150, centerY + 8);

            // Draw backup C2
            archCtx.fillStyle = '#dc2626';
            archCtx.beginPath();
            archCtx.arc(centerX + 150, centerY, 35, 0, Math.PI * 2);
            archCtx.fill();
            archCtx.strokeStyle = '#fff';
            archCtx.lineWidth = 3;
            archCtx.stroke();

            archCtx.fillStyle = '#fff';
            archCtx.fillText('Backup', centerX + 150, centerY - 5);
            archCtx.fillText('C2', centerX + 150, centerY + 8);

            // Draw bot clusters
            const cluster1 = { x: centerX - 150, y: centerY + 150 };
            const cluster2 = { x: centerX + 150, y: centerY + 150 };
            const cluster3 = { x: centerX, y: centerY - 150 };

            const clusters = [cluster1, cluster2, cluster3];

            clusters.forEach(cluster => {
                // Draw P2P connections within cluster
                const clusterBots = [];
                for (let i = 0; i < 5; i++) {
                    const angle = (i / 5) * Math.PI * 2;
                    clusterBots.push({
                        x: cluster.x + Math.cos(angle) * 60,
                        y: cluster.y + Math.sin(angle) * 60
                    });
                }

                // P2P connections
                archCtx.strokeStyle = '#a855f7';
                archCtx.lineWidth = 1;
                archCtx.setLineDash([3, 3]);
                for (let i = 0; i < clusterBots.length; i++) {
                    const next = (i + 1) % clusterBots.length;
                    archCtx.beginPath();
                    archCtx.moveTo(clusterBots[i].x, clusterBots[i].y);
                    archCtx.lineTo(clusterBots[next].x, clusterBots[next].y);
                    archCtx.stroke();
                }
                archCtx.setLineDash([]);

                // Draw bots
                clusterBots.forEach(bot => {
                    archCtx.fillStyle = '#a855f7';
                    archCtx.beginPath();
                    archCtx.arc(bot.x, bot.y, 15, 0, Math.PI * 2);
                    archCtx.fill();
                    archCtx.strokeStyle = '#fff';
                    archCtx.lineWidth = 2;
                    archCtx.stroke();
                });

                // Connection to C2
                archCtx.strokeStyle = '#10b981';
                archCtx.lineWidth = 3;
                archCtx.beginPath();
                if (cluster === cluster3) {
                    archCtx.moveTo(centerX - 150, centerY);
                } else {
                    archCtx.moveTo(cluster.x, centerY);
                }
                archCtx.lineTo(cluster.x, cluster.y - 60);
                archCtx.stroke();
            });

            // Draw label
            archCtx.fillStyle = '#e0e0e0';
            archCtx.font = '16px Arial';
            archCtx.textAlign = 'center';
            archCtx.fillText('Hybrid Architecture: Central C2 + P2P fallback for resilience', centerX, 30);
        }

        // Bot Lifecycle Animation
        let lifecycleStage = 0;
        let lifecycleInterval;

        function startLifecycle() {
            lifecycleStage = 0;
            clearInterval(lifecycleInterval);

            lifecycleInterval = setInterval(() => {
                // Deactivate all stages
                for (let i = 1; i <= 5; i++) {
                    document.getElementById(`stage${i}`).classList.remove('active');
                }

                // Activate current stage
                lifecycleStage++;
                if (lifecycleStage <= 5) {
                    document.getElementById(`stage${lifecycleStage}`).classList.add('active');
                    drawLifecycleFrame(lifecycleStage);

                    if (lifecycleStage === 1 && currentXP < 10) {
                        awardXP(10);
                    }
                } else {
                    clearInterval(lifecycleInterval);
                }
            }, 2000);
        }

        function resetLifecycle() {
            clearInterval(lifecycleInterval);
            lifecycleStage = 0;
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`stage${i}`).classList.remove('active');
            }
            const ctx = document.getElementById('lifecycleCanvas').getContext('2d');
            ctx.clearRect(0, 0, 1200, 400);
        }

        function drawLifecycleFrame(stage) {
            const canvas = document.getElementById('lifecycleCanvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const stageWidth = canvas.width / 5;
            const centerY = canvas.height / 2;

            for (let i = 1; i <= 5; i++) {
                const x = (i - 0.5) * stageWidth;
                const isActive = i === stage;

                // Draw stage circle
                ctx.fillStyle = isActive ? '#a855f7' : '#333';
                ctx.beginPath();
                ctx.arc(x, centerY, 40, 0, Math.PI * 2);
                ctx.fill();

                if (isActive) {
                    ctx.strokeStyle = '#fff';
                    ctx.lineWidth = 4;
                    ctx.stroke();
                }

                // Draw stage number
                ctx.fillStyle = '#fff';
                ctx.font = 'bold 24px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(i, x, centerY);

                // Draw arrow
                if (i < 5) {
                    ctx.strokeStyle = i < stage ? '#a855f7' : '#333';
                    ctx.lineWidth = 3;
                    ctx.beginPath();
                    ctx.moveTo(x + 50, centerY);
                    ctx.lineTo(x + stageWidth - 50, centerY);
                    ctx.stroke();

                    // Arrowhead
                    ctx.beginPath();
                    ctx.moveTo(x + stageWidth - 50, centerY);
                    ctx.lineTo(x + stageWidth - 65, centerY - 10);
                    ctx.lineTo(x + stageWidth - 65, centerY + 10);
                    ctx.closePath();
                    ctx.fillStyle = i < stage ? '#a855f7' : '#333';
                    ctx.fill();
                }
            }

            // Draw stage labels
            const labels = ['Infection', 'Callback', 'Command', 'Action', 'Persist'];
            ctx.font = '14px Arial';
            ctx.fillStyle = '#e0e0e0';
            labels.forEach((label, i) => {
                const x = (i + 0.5) * stageWidth;
                ctx.fillText(label, x, centerY + 70);
            });
        }

        // Infection Spread Simulation
        let infectionNodes = [];
        let infectionRunning = false;
        let infectionInterval;
        let infectedCount = 0;

        function initInfectionNodes() {
            infectionNodes = [];
            const canvas = document.getElementById('infectionCanvas');
            const numNodes = 100;

            for (let i = 0; i < numNodes; i++) {
                infectionNodes.push({
                    x: Math.random() * (canvas.width - 40) + 20,
                    y: Math.random() * (canvas.height - 40) + 20,
                    infected: i === 0, // First node is patient zero
                    c2Connected: false,
                    infectTime: i === 0 ? 0 : null
                });
            }

            infectedCount = 1;
            updateInfectionStats();
        }

        function startInfection() {
            if (!infectionNodes.length) {
                initInfectionNodes();
            }

            infectionRunning = true;
            const speed = 11 - parseInt(document.getElementById('speedControl').value);

            infectionInterval = setInterval(() => {
                updateInfection();
                drawInfection();
            }, speed * 100);

            if (currentXP < 20) {
                awardXP(10);
            }
        }

        function pauseInfection() {
            infectionRunning = false;
            clearInterval(infectionInterval);
        }

        function resetInfection() {
            pauseInfection();
            initInfectionNodes();
            drawInfection();
        }

        function updateInfection() {
            const infectionChance = 0.05;
            const c2ConnectChance = 0.1;

            // Find infected nodes
            const infected = infectionNodes.filter(n => n.infected);

            infected.forEach(infectedNode => {
                // Attempt to infect nearby nodes
                infectionNodes.forEach(node => {
                    if (!node.infected) {
                        const dx = node.x - infectedNode.x;
                        const dy = node.y - infectedNode.y;
                        const distance = Math.sqrt(dx * dx + dy * dy);

                        if (distance < 100 && Math.random() < infectionChance) {
                            node.infected = true;
                            node.infectTime = Date.now();
                            infectedCount++;
                        }
                    }

                    // Connect to C2
                    if (node.infected && !node.c2Connected && Math.random() < c2ConnectChance) {
                        node.c2Connected = true;
                    }
                });
            });

            updateInfectionStats();
        }

        function drawInfection() {
            const canvas = document.getElementById('infectionCanvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw C2 server
            const c2X = canvas.width / 2;
            const c2Y = 50;

            ctx.fillStyle = '#dc2626';
            ctx.beginPath();
            ctx.arc(c2X, c2Y, 30, 0, Math.PI * 2);
            ctx.fill();
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 3;
            ctx.stroke();

            ctx.fillStyle = '#fff';
            ctx.font = 'bold 14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('C2', c2X, c2Y + 5);

            // Draw C2 connections
            ctx.strokeStyle = '#10b981';
            ctx.lineWidth = 1;
            ctx.setLineDash([3, 3]);
            infectionNodes.forEach(node => {
                if (node.c2Connected) {
                    ctx.beginPath();
                    ctx.moveTo(c2X, c2Y);
                    ctx.lineTo(node.x, node.y);
                    ctx.stroke();
                }
            });
            ctx.setLineDash([]);

            // Draw infection spread lines
            const infected = infectionNodes.filter(n => n.infected);
            ctx.strokeStyle = 'rgba(168, 85, 247, 0.2)';
            ctx.lineWidth = 1;
            infected.forEach(infectedNode => {
                infectionNodes.forEach(node => {
                    if (!node.infected) {
                        const dx = node.x - infectedNode.x;
                        const dy = node.y - infectedNode.y;
                        const distance = Math.sqrt(dx * dx + dy * dy);

                        if (distance < 100) {
                            ctx.beginPath();
                            ctx.moveTo(infectedNode.x, infectedNode.y);
                            ctx.lineTo(node.x, node.y);
                            ctx.stroke();
                        }
                    }
                });
            });

            // Draw nodes
            infectionNodes.forEach(node => {
                ctx.fillStyle = node.infected ? '#a855f7' : '#333';
                ctx.beginPath();
                ctx.arc(node.x, node.y, 6, 0, Math.PI * 2);
                ctx.fill();

                if (node.c2Connected) {
                    ctx.strokeStyle = '#10b981';
                    ctx.lineWidth = 2;
                    ctx.stroke();
                }
            });
        }

        function updateInfectionStats() {
            const healthy = infectionNodes.length - infectedCount;
            const rate = ((infectedCount / infectionNodes.length) * 100).toFixed(1);
            const active = infectionNodes.filter(n => n.c2Connected).length;

            document.getElementById('infectedCount').textContent = infectedCount;
            document.getElementById('healthyCount').textContent = healthy;
            document.getElementById('infectionRate').textContent = rate + '%';
            document.getElementById('botsActive').textContent = active;
        }

        // Takedown Demonstrations
        function demonstrateSinkhole() {
            const canvas = document.getElementById('takedownCanvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;

            // Draw old C2 (crossed out)
            ctx.fillStyle = '#666';
            ctx.beginPath();
            ctx.arc(centerX - 200, centerY, 35, 0, Math.PI * 2);
            ctx.fill();

            ctx.strokeStyle = '#dc2626';
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(centerX - 230, centerY - 30);
            ctx.lineTo(centerX - 170, centerY + 30);
            ctx.moveTo(centerX - 230, centerY + 30);
            ctx.lineTo(centerX - 170, centerY - 30);
            ctx.stroke();

            ctx.fillStyle = '#fff';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Old C2', centerX - 200, centerY - 50);
            ctx.fillText('(Seized)', centerX - 200, centerY - 35);

            // Draw sinkhole
            ctx.fillStyle = '#10b981';
            ctx.beginPath();
            ctx.arc(centerX + 200, centerY, 35, 0, Math.PI * 2);
            ctx.fill();
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 3;
            ctx.stroke();

            ctx.fillStyle = '#fff';
            ctx.fillText('Sinkhole', centerX + 200, centerY - 50);
            ctx.fillText('(Research)', centerX + 200, centerY - 35);

            // Draw bots
            const numBots = 8;
            for (let i = 0; i < numBots; i++) {
                const angle = (i / numBots) * Math.PI * 2 - Math.PI / 2;
                const botX = centerX + Math.cos(angle) * 250;
                const botY = centerY + Math.sin(angle) * 150 + 100;

                // Redirected connection
                ctx.strokeStyle = '#10b981';
                ctx.lineWidth = 2;
                ctx.setLineDash([5, 5]);
                ctx.beginPath();
                ctx.moveTo(botX, botY);
                ctx.lineTo(centerX + 200, centerY);
                ctx.stroke();
                ctx.setLineDash([]);

                // Bot
                ctx.fillStyle = '#a855f7';
                ctx.beginPath();
                ctx.arc(botX, botY, 15, 0, Math.PI * 2);
                ctx.fill();
            }

            ctx.fillStyle = '#e0e0e0';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Sinkholing: Bot traffic redirected to researcher-controlled server', centerX, 30);

            if (currentXP < 30) {
                awardXP(10);
            }
        }

        function demonstrateDomain() {
            const canvas = document.getElementById('takedownCanvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;

            // Timeline
            const domains = [
                { x: centerX - 300, label: 'Domain 1', status: 'seized' },
                { x: centerX - 100, label: 'Domain 2', status: 'seized' },
                { x: centerX + 100, label: 'Domain 3', status: 'active' },
                { x: centerX + 300, label: 'Domain 4', status: 'future' }
            ];

            domains.forEach(domain => {
                let color;
                if (domain.status === 'seized') color = '#dc2626';
                else if (domain.status === 'active') color = '#10b981';
                else color = '#666';

                ctx.fillStyle = color;
                ctx.beginPath();
                ctx.arc(domain.x, centerY, 30, 0, Math.PI * 2);
                ctx.fill();
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 2;
                ctx.stroke();

                ctx.fillStyle = '#fff';
                ctx.font = '12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(domain.label, domain.x, centerY + 50);
                ctx.fillText(`(${domain.status})`, domain.x, centerY + 65);

                if (domain.status === 'seized') {
                    ctx.strokeStyle = '#dc2626';
                    ctx.lineWidth = 3;
                    ctx.beginPath();
                    ctx.moveTo(domain.x - 20, centerY - 20);
                    ctx.lineTo(domain.x + 20, centerY + 20);
                    ctx.moveTo(domain.x - 20, centerY + 20);
                    ctx.lineTo(domain.x + 20, centerY - 20);
                    ctx.stroke();
                }
            });

            // Timeline arrow
            ctx.strokeStyle = '#a855f7';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(centerX - 350, centerY);
            ctx.lineTo(centerX + 350, centerY);
            ctx.stroke();

            // Arrowhead
            ctx.beginPath();
            ctx.moveTo(centerX + 350, centerY);
            ctx.lineTo(centerX + 335, centerY - 10);
            ctx.lineTo(centerX + 335, centerY + 10);
            ctx.closePath();
            ctx.fillStyle = '#a855f7';
            ctx.fill();

            ctx.fillStyle = '#e0e0e0';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Domain Seizure: Progressive takedown of C2 domains over time', centerX, 30);
            ctx.font = '14px Arial';
            ctx.fillText('Botmasters often use DGA (Domain Generation Algorithms) to generate new domains', centerX, centerY + 100);
        }

        function demonstratePatch() {
            const canvas = document.getElementById('takedownCanvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;

            // Draw vulnerability
            ctx.fillStyle = '#dc2626';
            ctx.fillRect(centerX - 250, centerY - 50, 200, 100);
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Vulnerability', centerX - 150, centerY - 10);
            ctx.font = '12px Arial';
            ctx.fillText('(Exploited)', centerX - 150, centerY + 10);

            // Arrow
            ctx.strokeStyle = '#10b981';
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(centerX - 40, centerY);
            ctx.lineTo(centerX + 40, centerY);
            ctx.stroke();

            // Arrowhead
            ctx.beginPath();
            ctx.moveTo(centerX + 40, centerY);
            ctx.lineTo(centerX + 25, centerY - 10);
            ctx.lineTo(centerX + 25, centerY + 10);
            ctx.closePath();
            ctx.fillStyle = '#10b981';
            ctx.fill();

            // Draw patch
            ctx.fillStyle = '#10b981';
            ctx.fillRect(centerX + 50, centerY - 50, 200, 100);
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 16px Arial';
            ctx.fillText('Patch Applied', centerX + 150, centerY - 10);
            ctx.font = '12px Arial';
            ctx.fillText('(Protected)', centerX + 150, centerY + 10);

            // Draw stats
            ctx.fillStyle = '#e0e0e0';
            ctx.font = '14px Arial';
            ctx.textAlign = 'left';
            ctx.fillText('Before Patch: 85% vulnerable', centerX - 250, centerY + 80);
            ctx.fillText('After Patch: 15% vulnerable (unpatched systems)', centerX - 250, centerY + 100);

            ctx.textAlign = 'center';
            ctx.font = '16px Arial';
            ctx.fillText('Patch Distribution: Long-term prevention through vulnerability remediation', centerX, 30);
        }

        // Quiz System
        const quizQuestions = [
            {
                question: "What is a botnet?",
                options: [
                    "A single infected computer",
                    "A network of compromised computers controlled by an attacker",
                    "A type of firewall",
                    "An antivirus program"
                ],
                correct: 1
            },
            {
                question: "What does C2 stand for in botnet terminology?",
                options: [
                    "Computer Control",
                    "Command & Control",
                    "Code Compiler",
                    "Cyber Connect"
                ],
                correct: 1
            },
            {
                question: "Which botnet architecture has NO single point of failure?",
                options: [
                    "IRC-based centralized",
                    "HTTP-based centralized",
                    "P2P (Peer-to-Peer)",
                    "DNS-based"
                ],
                correct: 2
            },
            {
                question: "What was the Mirai botnet primarily composed of?",
                options: [
                    "Windows PCs",
                    "Linux servers",
                    "IoT devices (cameras, routers)",
                    "Mobile phones"
                ],
                correct: 2
            },
            {
                question: "Which botnet was famous for banking credential theft?",
                options: [
                    "Mirai",
                    "Zeus",
                    "Conficker",
                    "All of the above"
                ],
                correct: 1
            },
            {
                question: "What is the first stage in the bot lifecycle?",
                options: [
                    "Command Reception",
                    "Callback",
                    "Infection",
                    "Action Execution"
                ],
                correct: 2
            },
            {
                question: "What is sinkholing in botnet takedown?",
                options: [
                    "Physically destroying C2 servers",
                    "Redirecting bot traffic to researcher-controlled servers",
                    "Installing antivirus on all infected machines",
                    "Blocking all network traffic"
                ],
                correct: 1
            },
            {
                question: "Which detection method analyzes DNS queries for suspicious patterns?",
                options: [
                    "Signature-based detection",
                    "Behavioral analysis",
                    "DNS monitoring for DGA",
                    "Honeypot analysis"
                ],
                correct: 2
            },
            {
                question: "What is a primary advantage of centralized C2 architecture?",
                options: [
                    "Hard to take down",
                    "No single point of failure",
                    "Simple to implement and manage",
                    "Invisible to detection"
                ],
                correct: 2
            },
            {
                question: "Which botnet use case involves generating fraudulent ad revenue?",
                options: [
                    "DDoS attacks",
                    "Click fraud",
                    "Spam distribution",
                    "Credential theft"
                ],
                correct: 1
            }
        ];

        function initQuiz() {
            const container = document.getElementById('quizContainer');
            container.innerHTML = '';

            quizQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.innerHTML = `
                    <div class="question-text">${index + 1}. ${q.question}</div>
                    <div class="options" id="options${index}">
                        ${q.options.map((opt, i) => `
                            <div class="option" data-question="${index}" data-option="${i}">
                                ${opt}
                            </div>
                        `).join('')}
                    </div>
                `;
                container.appendChild(questionDiv);
            });

            // Add click handlers
            document.querySelectorAll('.option').forEach(opt => {
                opt.addEventListener('click', function() {
                    const qIndex = this.dataset.question;
                    const options = document.querySelectorAll(`[data-question="${qIndex}"]`);
                    options.forEach(o => o.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });
        }

        function submitQuiz() {
            let correct = 0;

            quizQuestions.forEach((q, index) => {
                const selected = document.querySelector(`[data-question="${index}"].selected`);
                const options = document.querySelectorAll(`[data-question="${index}"]`);

                options.forEach(opt => {
                    const optIndex = parseInt(opt.dataset.option);
                    if (optIndex === q.correct) {
                        opt.classList.add('correct');
                    }
                    if (selected && opt === selected && optIndex !== q.correct) {
                        opt.classList.add('incorrect');
                    }
                });

                if (selected && parseInt(selected.dataset.option) === q.correct) {
                    correct++;
                }
            });

            const percentage = (correct / quizQuestions.length) * 100;
            const passed = percentage >= 70;

            const resultsDiv = document.getElementById('quizResults');
            resultsDiv.style.display = 'block';
            resultsDiv.className = 'quiz-results';
            resultsDiv.innerHTML = `
                <div class="score-display">${correct}/${quizQuestions.length}</div>
                <p style="font-size: 1.2rem; margin: 1rem 0;">
                    ${passed ? 'üéâ Excellent work!' : 'üìö Keep studying!'}
                </p>
                <p>You scored ${percentage.toFixed(0)}% (${passed ? 'PASSED' : 'Need 70% to pass'})</p>
            `;

            document.getElementById('submitBtn').style.display = 'none';
            document.getElementById('retakeBtn').style.display = 'inline-block';

            if (passed && !quizCompleted) {
                quizCompleted = true;
                awardXP(35);
                document.getElementById('completionSection').style.display = 'block';
                document.getElementById('completionSection').scrollIntoView({ behavior: 'smooth' });
            }
        }

        function retakeQuiz() {
            initQuiz();
            document.getElementById('quizResults').style.display = 'none';
            document.getElementById('submitBtn').style.display = 'inline-block';
            document.getElementById('retakeBtn').style.display = 'none';
        }

        // Initialize on load
        window.addEventListener('load', () => {
            loadProgress();
            drawArchitecture();
            initInfectionNodes();
            drawInfection();
            initQuiz();
        });
    </script>
<script src="../../components/FluxCapacitor.js"></script>
</body>
</html>