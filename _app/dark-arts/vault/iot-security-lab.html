<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IoT Security Lab - Dark Arts Vault | Hexworth Prime</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary: #a855f7;
      --accent: #dc2626;
      --bg-dark: #0a0a0f;
      --bg-card: #1a1a2e;
      --bg-hover: #252538;
      --text-primary: #e2e8f0;
      --text-secondary: #94a3b8;
      --border: #2d2d44;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg-dark);
      color: var(--text-primary);
      line-height: 1.6;
      overflow-x: hidden;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }

    /* Header */
    header {
      background: linear-gradient(135deg, var(--bg-card) 0%, #16213e 100%);
      padding: 30px;
      border-radius: 12px;
      margin-bottom: 30px;
      border: 2px solid var(--primary);
      position: relative;
      overflow: hidden;
    }

    header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--primary), var(--accent));
      animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subtitle {
      color: var(--text-secondary);
      font-size: 1.1em;
    }

    /* Progress Bar */
    .progress-container {
      background: var(--bg-card);
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 30px;
      border: 1px solid var(--border);
    }

    .progress-bar {
      width: 100%;
      height: 30px;
      background: var(--bg-dark);
      border-radius: 15px;
      overflow: hidden;
      position: relative;
      margin-top: 10px;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary), var(--accent));
      transition: width 0.5s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 0.9em;
    }

    .xp-display {
      text-align: center;
      margin-top: 10px;
      font-size: 1.2em;
      color: var(--primary);
    }

    /* Tab Navigation */
    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }

    .tab {
      padding: 12px 24px;
      background: var(--bg-card);
      border: 2px solid var(--border);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
    }

    .tab:hover {
      background: var(--bg-hover);
      border-color: var(--primary);
    }

    .tab.active {
      background: var(--primary);
      border-color: var(--primary);
      color: white;
    }

    /* Content Sections */
    .content-section {
      display: none;
      animation: fadeIn 0.5s ease;
    }

    .content-section.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .card {
      background: var(--bg-card);
      padding: 25px;
      border-radius: 12px;
      margin-bottom: 25px;
      border: 1px solid var(--border);
      transition: transform 0.3s ease, border-color 0.3s ease;
    }

    .card:hover {
      transform: translateY(-2px);
      border-color: var(--primary);
    }

    h2 {
      color: var(--primary);
      margin-bottom: 15px;
      font-size: 1.8em;
    }

    h3 {
      color: var(--text-primary);
      margin: 20px 0 10px 0;
      font-size: 1.3em;
    }

    /* IoT Architecture Diagram */
    .architecture-diagram {
      display: flex;
      flex-direction: column;
      gap: 20px;
      margin: 20px 0;
    }

    .arch-layer {
      background: var(--bg-dark);
      padding: 20px;
      border-radius: 8px;
      border-left: 4px solid var(--primary);
      position: relative;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .arch-layer:hover {
      background: var(--bg-hover);
      transform: translateX(5px);
    }

    .arch-layer::after {
      content: '‚Üì';
      position: absolute;
      bottom: -20px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 1.5em;
      color: var(--primary);
    }

    .arch-layer:last-child::after {
      display: none;
    }

    .layer-title {
      font-weight: bold;
      color: var(--primary);
      font-size: 1.2em;
      margin-bottom: 8px;
    }

    .layer-description {
      color: var(--text-secondary);
      font-size: 0.95em;
    }

    .layer-examples {
      margin-top: 10px;
      font-size: 0.9em;
      color: var(--text-primary);
    }

    /* Network Topology Builder */
    .topology-builder {
      background: var(--bg-dark);
      padding: 20px;
      border-radius: 12px;
      min-height: 400px;
      position: relative;
    }

    .device-palette {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 10px;
      margin-bottom: 20px;
    }

    .device-item {
      background: var(--bg-card);
      padding: 15px;
      border-radius: 8px;
      text-align: center;
      cursor: grab;
      border: 2px solid var(--border);
      transition: all 0.3s ease;
    }

    .device-item:hover {
      border-color: var(--primary);
      transform: scale(1.05);
    }

    .device-icon {
      font-size: 2em;
      margin-bottom: 5px;
    }

    .device-name {
      font-size: 0.85em;
      color: var(--text-secondary);
    }

    .topology-canvas {
      background: repeating-linear-gradient(
        0deg,
        var(--bg-card) 0px,
        var(--bg-card) 1px,
        transparent 1px,
        transparent 20px
      ),
      repeating-linear-gradient(
        90deg,
        var(--bg-card) 0px,
        var(--bg-card) 1px,
        transparent 1px,
        transparent 20px
      );
      min-height: 300px;
      border-radius: 8px;
      position: relative;
      border: 2px dashed var(--border);
    }

    .placed-device {
      position: absolute;
      background: var(--bg-card);
      padding: 10px;
      border-radius: 8px;
      border: 2px solid var(--primary);
      cursor: move;
      text-align: center;
      min-width: 80px;
    }

    .placed-device .device-icon {
      font-size: 1.5em;
    }

    .placed-device .device-name {
      font-size: 0.75em;
    }

    .remove-device {
      position: absolute;
      top: -8px;
      right: -8px;
      background: var(--accent);
      color: white;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 0.8em;
    }

    /* Protocol Comparison Matrix */
    .protocol-matrix {
      overflow-x: auto;
    }

    .protocol-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }

    .protocol-table th,
    .protocol-table td {
      padding: 12px;
      text-align: left;
      border: 1px solid var(--border);
    }

    .protocol-table th {
      background: var(--primary);
      color: white;
      font-weight: 600;
    }

    .protocol-table tr:hover {
      background: var(--bg-hover);
    }

    .security-badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 0.85em;
      font-weight: bold;
    }

    .security-high {
      background: var(--success);
      color: white;
    }

    .security-medium {
      background: var(--warning);
      color: white;
    }

    .security-low {
      background: var(--danger);
      color: white;
    }

    /* Smart Home Floor Plan */
    .floor-plan {
      background: var(--bg-dark);
      padding: 30px;
      border-radius: 12px;
      position: relative;
      min-height: 500px;
    }

    .room {
      position: absolute;
      border: 2px solid var(--border);
      border-radius: 8px;
      background: rgba(168, 85, 247, 0.05);
      padding: 10px;
    }

    .room-label {
      font-weight: bold;
      color: var(--primary);
      margin-bottom: 10px;
    }

    .iot-device {
      position: relative;
      display: inline-block;
      margin: 5px;
      padding: 8px 12px;
      background: var(--bg-card);
      border: 2px solid var(--border);
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .iot-device:hover {
      border-color: var(--accent);
      transform: scale(1.1);
    }

    .iot-device.vulnerable {
      border-color: var(--accent);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.7); }
      50% { box-shadow: 0 0 0 10px rgba(220, 38, 38, 0); }
    }

    .vulnerability-badge {
      position: absolute;
      top: -8px;
      right: -8px;
      background: var(--accent);
      color: white;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.7em;
      font-weight: bold;
    }

    /* Device Info Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: var(--bg-card);
      padding: 30px;
      border-radius: 12px;
      max-width: 600px;
      width: 90%;
      border: 2px solid var(--primary);
      position: relative;
    }

    .modal-close {
      position: absolute;
      top: 15px;
      right: 15px;
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      cursor: pointer;
      font-size: 1.2em;
    }

    .vulnerability-list {
      list-style: none;
      margin: 15px 0;
    }

    .vulnerability-list li {
      padding: 10px;
      margin: 8px 0;
      background: var(--bg-dark);
      border-left: 3px solid var(--accent);
      border-radius: 4px;
    }

    /* Attack Scenario Walkthrough */
    .scenario-step {
      background: var(--bg-dark);
      padding: 20px;
      margin: 15px 0;
      border-radius: 8px;
      border-left: 4px solid var(--primary);
      opacity: 0.5;
      transition: all 0.3s ease;
    }

    .scenario-step.active {
      opacity: 1;
      border-left-color: var(--accent);
    }

    .scenario-step.completed {
      opacity: 1;
      border-left-color: var(--success);
    }

    .step-number {
      display: inline-block;
      background: var(--primary);
      color: white;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      text-align: center;
      line-height: 30px;
      margin-right: 10px;
      font-weight: bold;
    }

    .scenario-step.active .step-number {
      background: var(--accent);
    }

    .scenario-step.completed .step-number {
      background: var(--success);
    }

    .scenario-controls {
      margin-top: 20px;
      display: flex;
      gap: 10px;
      justify-content: center;
    }

    /* Firmware Analysis Workflow */
    .workflow-container {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin: 20px 0;
    }

    .workflow-step {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px;
      background: var(--bg-dark);
      border-radius: 8px;
      border: 2px solid var(--border);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .workflow-step:hover {
      border-color: var(--primary);
      transform: translateX(10px);
    }

    .workflow-icon {
      font-size: 2em;
      min-width: 50px;
      text-align: center;
    }

    .workflow-content {
      flex: 1;
    }

    .workflow-title {
      font-weight: bold;
      color: var(--primary);
      margin-bottom: 5px;
    }

    .workflow-description {
      color: var(--text-secondary);
      font-size: 0.9em;
    }

    /* Quiz Section */
    .quiz-container {
      max-width: 800px;
      margin: 0 auto;
    }

    .question {
      background: var(--bg-card);
      padding: 25px;
      border-radius: 12px;
      margin-bottom: 20px;
      border: 2px solid var(--border);
    }

    .question-number {
      color: var(--primary);
      font-weight: bold;
      margin-bottom: 10px;
    }

    .question-text {
      font-size: 1.1em;
      margin-bottom: 20px;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .option {
      padding: 15px;
      background: var(--bg-dark);
      border: 2px solid var(--border);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .option:hover {
      border-color: var(--primary);
      background: var(--bg-hover);
    }

    .option.selected {
      border-color: var(--primary);
      background: var(--primary);
      color: white;
    }

    .option.correct {
      border-color: var(--success);
      background: var(--success);
      color: white;
    }

    .option.incorrect {
      border-color: var(--accent);
      background: var(--accent);
      color: white;
    }

    .feedback {
      margin-top: 15px;
      padding: 15px;
      border-radius: 8px;
      display: none;
    }

    .feedback.show {
      display: block;
    }

    .feedback.correct {
      background: rgba(16, 185, 129, 0.2);
      border: 1px solid var(--success);
      color: var(--success);
    }

    .feedback.incorrect {
      background: rgba(220, 38, 38, 0.2);
      border: 1px solid var(--accent);
      color: var(--accent);
    }

    /* Buttons */
    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
      font-size: 1em;
    }

    .btn-primary {
      background: var(--primary);
      color: white;
    }

    .btn-primary:hover {
      background: #9333ea;
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: var(--bg-card);
      color: var(--text-primary);
      border: 2px solid var(--border);
    }

    .btn-secondary:hover {
      border-color: var(--primary);
    }

    .btn-danger {
      background: var(--accent);
      color: white;
    }

    .btn-danger:hover {
      background: #b91c1c;
    }

    /* Vulnerability Scanner */
    .scanner-interface {
      background: var(--bg-dark);
      padding: 20px;
      border-radius: 12px;
      margin: 20px 0;
    }

    .scanner-header {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }

    .scanner-input {
      flex: 1;
      padding: 12px;
      background: var(--bg-card);
      border: 2px solid var(--border);
      border-radius: 8px;
      color: var(--text-primary);
      font-size: 1em;
    }

    .scanner-results {
      background: #000;
      padding: 20px;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      min-height: 200px;
      color: #00ff00;
      overflow-y: auto;
      max-height: 400px;
    }

    .scan-line {
      margin: 5px 0;
      opacity: 0;
      animation: typeLine 0.3s forwards;
    }

    @keyframes typeLine {
      to { opacity: 1; }
    }

    .vulnerability-found {
      color: #ff4444;
      font-weight: bold;
    }

    .info-line {
      color: #44aaff;
    }

    /* Footer Navigation */
    .footer-nav {
      margin-top: 40px;
      padding: 20px;
      background: var(--bg-card);
      border-radius: 12px;
      text-align: center;
      border: 1px solid var(--border);
    }

    .nav-links {
      display: flex;
      gap: 15px;
      justify-content: center;
      flex-wrap: wrap;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      h1 {
        font-size: 1.8em;
      }

      .tabs {
        flex-direction: column;
      }

      .device-palette {
        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      }

      .protocol-table {
        font-size: 0.85em;
      }

      .floor-plan {
        overflow-x: auto;
      }
    }

    /* Loading Animation */
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid var(--border);
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Info Box */
    .info-box {
      background: rgba(168, 85, 247, 0.1);
      border-left: 4px solid var(--primary);
      padding: 15px;
      margin: 15px 0;
      border-radius: 4px;
    }

    .warning-box {
      background: rgba(245, 158, 11, 0.1);
      border-left: 4px solid var(--warning);
      padding: 15px;
      margin: 15px 0;
      border-radius: 4px;
    }

    .danger-box {
      background: rgba(220, 38, 38, 0.1);
      border-left: 4px solid var(--accent);
      padding: 15px;
      margin: 15px 0;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>IoT Security Lab</h1>
      <p class="subtitle">Dark Arts Vault - Securing the Connected World</p>
    </header>

    <div class="progress-container">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <strong>Lab Progress</strong>
        <span id="progress-text">0%</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" id="progress-fill" style="width: 0%;">
          <span id="progress-percent"></span>
        </div>
      </div>
      <div class="xp-display">XP Earned: <span id="xp-earned">0</span> / 70</div>
    </div>

    <div class="tabs">
      <div class="tab active" onclick="switchTab('overview')">Overview</div>
      <div class="tab" onclick="switchTab('architecture')">Architecture</div>
      <div class="tab" onclick="switchTab('topology')">Network Builder</div>
      <div class="tab" onclick="switchTab('protocols')">Protocols</div>
      <div class="tab" onclick="switchTab('floorplan')">Smart Home</div>
      <div class="tab" onclick="switchTab('scanner')">Vulnerability Scanner</div>
      <div class="tab" onclick="switchTab('attacks')">Attack Scenarios</div>
      <div class="tab" onclick="switchTab('firmware')">Firmware Analysis</div>
      <div class="tab" onclick="switchTab('quiz')">Quiz</div>
    </div>

    <!-- Overview Section -->
    <div id="overview" class="content-section active">
      <div class="card">
        <h2>Welcome to the IoT Security Lab</h2>
        <p>The Internet of Things (IoT) represents the interconnection of everyday physical objects through network infrastructure, enabling them to collect, exchange, and act upon data. This lab explores the security challenges and attack vectors inherent in IoT ecosystems.</p>

        <div class="info-box">
          <strong>Lab Objectives:</strong>
          <ul>
            <li>Understand IoT architecture and communication models</li>
            <li>Identify security vulnerabilities in IoT devices</li>
            <li>Analyze attack vectors and defensive strategies</li>
            <li>Evaluate communication protocols and their security implications</li>
          </ul>
        </div>

        <h3>IoT Categories</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0;">
          <div style="background: var(--bg-dark); padding: 20px; border-radius: 8px; border-left: 4px solid var(--primary);">
            <h4 style="color: var(--primary);">Consumer IoT</h4>
            <p style="color: var(--text-secondary); margin-top: 10px;">Smart homes, wearables, connected appliances, entertainment systems, and personal devices.</p>
            <p style="margin-top: 10px;"><strong>Examples:</strong> Smart thermostats, fitness trackers, voice assistants, smart locks</p>
          </div>
          <div style="background: var(--bg-dark); padding: 20px; border-radius: 8px; border-left: 4px solid var(--accent);">
            <h4 style="color: var(--accent);">Industrial IoT (IIoT)</h4>
            <p style="color: var(--text-secondary); margin-top: 10px;">Manufacturing equipment, SCADA systems, supply chain management, and critical infrastructure.</p>
            <p style="margin-top: 10px;"><strong>Examples:</strong> Industrial sensors, automated factories, power grid controls, logistics tracking</p>
          </div>
        </div>

        <h3>Core IoT Components</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
          <div class="iot-component" style="background: var(--bg-dark); padding: 15px; border-radius: 8px; text-align: center;">
            <div style="font-size: 2em;">üì°</div>
            <strong>Sensors</strong>
            <p style="font-size: 0.9em; color: var(--text-secondary); margin-top: 5px;">Data collection devices</p>
          </div>
          <div class="iot-component" style="background: var(--bg-dark); padding: 15px; border-radius: 8px; text-align: center;">
            <div style="font-size: 2em;">üìπ</div>
            <strong>Cameras</strong>
            <p style="font-size: 0.9em; color: var(--text-secondary); margin-top: 5px;">Visual monitoring</p>
          </div>
          <div class="iot-component" style="background: var(--bg-dark); padding: 15px; border-radius: 8px; text-align: center;">
            <div style="font-size: 2em;">üåê</div>
            <strong>Gateways</strong>
            <p style="font-size: 0.9em; color: var(--text-secondary); margin-top: 5px;">Network bridges</p>
          </div>
          <div class="iot-component" style="background: var(--bg-dark); padding: 15px; border-radius: 8px; text-align: center;">
            <div style="font-size: 2em;">‚òÅÔ∏è</div>
            <strong>Cloud Servers</strong>
            <p style="font-size: 0.9em; color: var(--text-secondary); margin-top: 5px;">Data processing</p>
          </div>
          <div class="iot-component" style="background: var(--bg-dark); padding: 15px; border-radius: 8px; text-align: center;">
            <div style="font-size: 2em;">üì±</div>
            <strong>Remote Apps</strong>
            <p style="font-size: 0.9em; color: var(--text-secondary); margin-top: 5px;">User interfaces</p>
          </div>
        </div>

        <div class="warning-box">
          <strong>Security Challenge:</strong> Each component introduces potential attack surfaces. Weak authentication, poor access control, and clear-text communications create exploitable vulnerabilities.
        </div>
      </div>

      <div class="card">
        <h3>IoT Operating Systems</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 20px 0;">
          <div style="background: var(--bg-dark); padding: 15px; border-radius: 8px;">
            <strong style="color: var(--primary);">ARM mbed OS</strong>
            <p style="color: var(--text-secondary); font-size: 0.9em; margin-top: 5px;">Optimized for ARM Cortex-M microcontrollers, designed for low-power IoT devices</p>
          </div>
          <div style="background: var(--bg-dark); padding: 15px; border-radius: 8px;">
            <strong style="color: var(--primary);">Windows 10 IoT</strong>
            <p style="color: var(--text-secondary); font-size: 0.9em; margin-top: 5px;">Microsoft's IoT platform for enterprise and industrial applications</p>
          </div>
          <div style="background: var(--bg-dark); padding: 15px; border-radius: 8px;">
            <strong style="color: var(--primary);">Contiki</strong>
            <p style="color: var(--text-secondary); font-size: 0.9em; margin-top: 5px;">Open-source OS for constrained IoT devices with network connectivity</p>
          </div>
          <div style="background: var(--bg-dark); padding: 15px; border-radius: 8px;">
            <strong style="color: var(--primary);">Ubuntu Core</strong>
            <p style="color: var(--text-secondary); font-size: 0.9em; margin-top: 5px;">Minimal Ubuntu for secure IoT deployments with transactional updates</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Architecture Section -->
    <div id="architecture" class="content-section">
      <div class="card">
        <h2>IoT Architecture Layers</h2>
        <p>IoT systems follow a layered architecture that enables data flow from physical devices to user applications. Understanding this architecture is crucial for identifying security vulnerabilities at each layer.</p>

        <div class="architecture-diagram">
          <div class="arch-layer" onclick="highlightLayer(this)">
            <div class="layer-title">1. Edge Technology Layer (Perception)</div>
            <div class="layer-description">Physical devices that sense and collect data from the environment</div>
            <div class="layer-examples"><strong>Components:</strong> Sensors, actuators, RFID tags, smart meters, cameras, wearables</div>
            <div class="layer-examples"><strong>Vulnerabilities:</strong> Physical tampering, weak device authentication, firmware exploitation</div>
          </div>

          <div class="arch-layer" onclick="highlightLayer(this)">
            <div class="layer-title">2. Access Gateway Layer</div>
            <div class="layer-description">Bridges between edge devices and the internet, performing protocol translation and aggregation</div>
            <div class="layer-examples"><strong>Components:</strong> IoT gateways, routers, base stations, edge computing nodes</div>
            <div class="layer-examples"><strong>Vulnerabilities:</strong> Man-in-the-middle attacks, gateway compromise, traffic interception</div>
          </div>

          <div class="arch-layer" onclick="highlightLayer(this)">
            <div class="layer-title">3. Internet Layer</div>
            <div class="layer-description">Network infrastructure that enables global connectivity and data transmission</div>
            <div class="layer-examples"><strong>Components:</strong> Internet protocols (IPv4/IPv6), cellular networks, satellite communications</div>
            <div class="layer-examples"><strong>Vulnerabilities:</strong> DDoS attacks, packet sniffing, routing attacks, DNS spoofing</div>
          </div>

          <div class="arch-layer" onclick="highlightLayer(this)">
            <div class="layer-title">4. Middleware Layer</div>
            <div class="layer-description">Data processing, storage, and management infrastructure</div>
            <div class="layer-examples"><strong>Components:</strong> Cloud platforms, databases, analytics engines, message queues</div>
            <div class="layer-examples"><strong>Vulnerabilities:</strong> Data breaches, unauthorized access, injection attacks, insecure APIs</div>
          </div>

          <div class="arch-layer" onclick="highlightLayer(this)">
            <div class="layer-title">5. Application Layer</div>
            <div class="layer-description">User-facing applications and services that consume IoT data</div>
            <div class="layer-examples"><strong>Components:</strong> Mobile apps, web dashboards, automation rules, analytics interfaces</div>
            <div class="layer-examples"><strong>Vulnerabilities:</strong> Weak authentication, session hijacking, XSS, CSRF, privilege escalation</div>
          </div>
        </div>
      </div>

      <div class="card">
        <h3>Communication Models</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0;">
          <div style="background: var(--bg-dark); padding: 20px; border-radius: 8px; border: 2px solid var(--primary);">
            <h4 style="color: var(--primary);">Device-to-Device (D2D)</h4>
            <p style="margin: 10px 0;">Direct communication between IoT devices without intermediary infrastructure.</p>
            <p style="font-size: 0.9em; color: var(--text-secondary);"><strong>Examples:</strong> Bluetooth pairing, Zigbee mesh networks, NFC transactions</p>
            <p style="margin-top: 10px; color: var(--accent);"><strong>Security Risks:</strong> Eavesdropping, unauthorized pairing, replay attacks</p>
          </div>

          <div style="background: var(--bg-dark); padding: 20px; border-radius: 8px; border: 2px solid var(--primary);">
            <h4 style="color: var(--primary);">Device-to-Cloud (D2C)</h4>
            <p style="margin: 10px 0;">Devices connect directly to cloud services for data storage and processing.</p>
            <p style="font-size: 0.9em; color: var(--text-secondary);"><strong>Examples:</strong> Smart thermostats, fitness trackers, connected cameras</p>
            <p style="margin-top: 10px; color: var(--accent);"><strong>Security Risks:</strong> Credential theft, API vulnerabilities, data interception</p>
          </div>

          <div style="background: var(--bg-dark); padding: 20px; border-radius: 8px; border: 2px solid var(--primary);">
            <h4 style="color: var(--primary);">Device-to-Gateway (D2G)</h4>
            <p style="margin: 10px 0;">Devices communicate through a local gateway that aggregates and forwards data.</p>
            <p style="font-size: 0.9em; color: var(--text-secondary);"><strong>Examples:</strong> Smart home hubs, industrial controllers, home automation systems</p>
            <p style="margin-top: 10px; color: var(--accent);"><strong>Security Risks:</strong> Gateway compromise, local network attacks, lateral movement</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Network Topology Builder -->
    <div id="topology" class="content-section">
      <div class="card">
        <h2>IoT Network Topology Builder</h2>
        <p>Build your own IoT network by dragging devices onto the canvas. Visualize how different components interact in a typical IoT deployment.</p>

        <div class="topology-builder">
          <h3>Device Palette</h3>
          <div class="device-palette">
            <div class="device-item" draggable="true" data-device="sensor">
              <div class="device-icon">üì°</div>
              <div class="device-name">Sensor</div>
            </div>
            <div class="device-item" draggable="true" data-device="camera">
              <div class="device-icon">üìπ</div>
              <div class="device-name">Camera</div>
            </div>
            <div class="device-item" draggable="true" data-device="thermostat">
              <div class="device-icon">üå°Ô∏è</div>
              <div class="device-name">Thermostat</div>
            </div>
            <div class="device-item" draggable="true" data-device="lock">
              <div class="device-icon">üîí</div>
              <div class="device-name">Smart Lock</div>
            </div>
            <div class="device-item" draggable="true" data-device="light">
              <div class="device-icon">üí°</div>
              <div class="device-name">Smart Light</div>
            </div>
            <div class="device-item" draggable="true" data-device="gateway">
              <div class="device-icon">üåê</div>
              <div class="device-name">Gateway</div>
            </div>
            <div class="device-item" draggable="true" data-device="router">
              <div class="device-icon">üì∂</div>
              <div class="device-name">Router</div>
            </div>
            <div class="device-item" draggable="true" data-device="cloud">
              <div class="device-icon">‚òÅÔ∏è</div>
              <div class="device-name">Cloud</div>
            </div>
          </div>

          <h3>Network Canvas</h3>
          <div class="topology-canvas" id="topology-canvas">
            <p style="text-align: center; color: var(--text-secondary); padding: 140px 20px;">Drag devices here to build your network</p>
          </div>

          <div style="margin-top: 20px; text-align: center;">
            <button class="btn btn-danger" onclick="clearTopology()">Clear Network</button>
            <button class="btn btn-primary" onclick="analyzeTopology()">Analyze Security</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Protocols Section -->
    <div id="protocols" class="content-section">
      <div class="card">
        <h2>IoT Communication Protocols</h2>
        <p>Different IoT applications require different communication protocols based on range, power consumption, bandwidth, and security requirements.</p>

        <div class="protocol-matrix">
          <table class="protocol-table">
            <thead>
              <tr>
                <th>Protocol</th>
                <th>Range</th>
                <th>Power</th>
                <th>Bandwidth</th>
                <th>Security Level</th>
                <th>Common Uses</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>WiFi (802.11)</strong></td>
                <td>~100m</td>
                <td>High</td>
                <td>High (Mbps)</td>
                <td><span class="security-badge security-high">High</span></td>
                <td>Smart home, cameras, streaming devices</td>
              </tr>
              <tr>
                <td><strong>Zigbee</strong></td>
                <td>10-100m</td>
                <td>Low</td>
                <td>Low (250 Kbps)</td>
                <td><span class="security-badge security-medium">Medium</span></td>
                <td>Home automation, sensors, mesh networks</td>
              </tr>
              <tr>
                <td><strong>RFID</strong></td>
                <td>~10m</td>
                <td>Very Low</td>
                <td>Very Low</td>
                <td><span class="security-badge security-low">Low</span></td>
                <td>Asset tracking, access control, inventory</td>
              </tr>
              <tr>
                <td><strong>LTE-Advanced</strong></td>
                <td>Wide Area</td>
                <td>High</td>
                <td>Very High (Gbps)</td>
                <td><span class="security-badge security-high">High</span></td>
                <td>Connected vehicles, industrial IoT, remote monitoring</td>
              </tr>
              <tr>
                <td><strong>LPWAN (LoRaWAN)</strong></td>
                <td>~15km</td>
                <td>Very Low</td>
                <td>Very Low</td>
                <td><span class="security-badge security-medium">Medium</span></td>
                <td>Agriculture, smart cities, environmental monitoring</td>
              </tr>
              <tr>
                <td><strong>Sigfox</strong></td>
                <td>~50km</td>
                <td>Very Low</td>
                <td>Very Low (100 bps)</td>
                <td><span class="security-badge security-low">Low</span></td>
                <td>Asset tracking, simple sensors, utilities</td>
              </tr>
              <tr>
                <td><strong>Bluetooth/BLE</strong></td>
                <td>~10m</td>
                <td>Low</td>
                <td>Medium (2 Mbps)</td>
                <td><span class="security-badge security-medium">Medium</span></td>
                <td>Wearables, beacons, proximity devices</td>
              </tr>
              <tr>
                <td><strong>Z-Wave</strong></td>
                <td>~30m</td>
                <td>Low</td>
                <td>Low (100 Kbps)</td>
                <td><span class="security-badge security-high">High</span></td>
                <td>Home automation, security systems</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="danger-box">
          <strong>Security Considerations:</strong>
          <ul style="margin-top: 10px;">
            <li><strong>RFID & Sigfox:</strong> Limited or no encryption, vulnerable to eavesdropping and replay attacks</li>
            <li><strong>Zigbee & Bluetooth:</strong> Encryption available but often poorly implemented or using default keys</li>
            <li><strong>WiFi & LTE:</strong> Strong encryption standards (WPA3, TLS) but vulnerable if misconfigured</li>
            <li><strong>LPWAN:</strong> Security varies by implementation; LoRaWAN supports AES-128 encryption</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Smart Home Floor Plan -->
    <div id="floorplan" class="content-section">
      <div class="card">
        <h2>Smart Home Vulnerability Assessment</h2>
        <p>Click on devices to discover their vulnerabilities. This smart home contains multiple security weaknesses common in real-world deployments.</p>

        <div class="floor-plan" style="position: relative; height: 600px;">
          <!-- Living Room -->
          <div class="room" style="left: 20px; top: 20px; width: 300px; height: 250px;">
            <div class="room-label">Living Room</div>
            <div class="iot-device vulnerable" data-device="smart-tv" onclick="showDeviceInfo('smart-tv')">
              üì∫ Smart TV
              <span class="vulnerability-badge">3</span>
            </div>
            <div class="iot-device vulnerable" data-device="voice-assistant" onclick="showDeviceInfo('voice-assistant')">
              üîä Voice Assistant
              <span class="vulnerability-badge">4</span>
            </div>
            <div class="iot-device" data-device="smart-light-1" onclick="showDeviceInfo('smart-light-1')">
              üí° Smart Lights
            </div>
          </div>

          <!-- Kitchen -->
          <div class="room" style="left: 340px; top: 20px; width: 280px; height: 250px;">
            <div class="room-label">Kitchen</div>
            <div class="iot-device vulnerable" data-device="smart-fridge" onclick="showDeviceInfo('smart-fridge')">
              üßä Smart Fridge
              <span class="vulnerability-badge">2</span>
            </div>
            <div class="iot-device" data-device="coffee-maker" onclick="showDeviceInfo('coffee-maker')">
              ‚òï Coffee Maker
            </div>
          </div>

          <!-- Bedroom -->
          <div class="room" style="left: 20px; top: 290px; width: 300px; height: 250px;">
            <div class="room-label">Bedroom</div>
            <div class="iot-device vulnerable" data-device="smart-lock" onclick="showDeviceInfo('smart-lock')">
              üîí Smart Lock
              <span class="vulnerability-badge">5</span>
            </div>
            <div class="iot-device vulnerable" data-device="security-camera" onclick="showDeviceInfo('security-camera')">
              üìπ Security Camera
              <span class="vulnerability-badge">4</span>
            </div>
            <div class="iot-device" data-device="thermostat" onclick="showDeviceInfo('thermostat')">
              üå°Ô∏è Thermostat
            </div>
          </div>

          <!-- Office -->
          <div class="room" style="left: 340px; top: 290px; width: 280px; height: 250px;">
            <div class="room-label">Office</div>
            <div class="iot-device vulnerable" data-device="router" onclick="showDeviceInfo('router')">
              üì∂ WiFi Router
              <span class="vulnerability-badge">3</span>
            </div>
            <div class="iot-device vulnerable" data-device="printer" onclick="showDeviceInfo('printer')">
              üñ®Ô∏è Network Printer
              <span class="vulnerability-badge">2</span>
            </div>
          </div>

          <!-- Gateway -->
          <div style="position: absolute; right: 20px; top: 250px; background: var(--bg-card); padding: 20px; border-radius: 8px; border: 2px solid var(--primary);">
            <div style="text-align: center; margin-bottom: 10px;">
              <div style="font-size: 3em;">üåê</div>
              <strong>IoT Gateway</strong>
            </div>
            <div style="font-size: 0.85em; color: var(--text-secondary);">
              Central hub connecting all devices
            </div>
          </div>
        </div>

        <div class="info-box" style="margin-top: 20px;">
          <strong>Total Devices:</strong> 10 | <strong>Vulnerable Devices:</strong> 7 | <strong>Known Vulnerabilities:</strong> 23
        </div>
      </div>
    </div>

    <!-- Vulnerability Scanner -->
    <div id="scanner" class="content-section">
      <div class="card">
        <h2>IoT Vulnerability Scanner Simulator</h2>
        <p>This simulated scanner demonstrates how security professionals discover and assess IoT devices on a network. In real-world scenarios, tools like Shodan, Nmap, and specialized IoT scanners are used for defensive security assessments.</p>

        <div class="warning-box">
          <strong>Educational Purpose:</strong> This is a simulation. Never scan networks or devices without explicit authorization. Unauthorized scanning is illegal and unethical.
        </div>

        <div class="scanner-interface">
          <div class="scanner-header">
            <input type="text" class="scanner-input" id="scan-target" placeholder="Enter network range (e.g., 192.168.1.0/24)" value="192.168.1.0/24">
            <button class="btn btn-primary" onclick="startScan()">Start Scan</button>
            <button class="btn btn-secondary" onclick="clearScanResults()">Clear</button>
          </div>

          <div class="scanner-results" id="scanner-results">
            <div style="color: #00ff00;">IoT Vulnerability Scanner v3.2</div>
            <div style="color: #888;">Ready to scan... Enter target and click Start Scan</div>
          </div>
        </div>

        <h3>Common IoT Vulnerabilities Detected</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin: 20px 0;">
          <div style="background: var(--bg-dark); padding: 15px; border-radius: 8px; border-left: 3px solid var(--accent);">
            <strong style="color: var(--accent);">Default Credentials</strong>
            <p style="color: var(--text-secondary); font-size: 0.9em; margin-top: 5px;">Devices shipped with factory default usernames and passwords (admin/admin, root/12345)</p>
          </div>
          <div style="background: var(--bg-dark); padding: 15px; border-radius: 8px; border-left: 3px solid var(--accent);">
            <strong style="color: var(--accent);">Outdated Firmware</strong>
            <p style="color: var(--text-secondary); font-size: 0.9em; margin-top: 5px;">Unpatched vulnerabilities in device firmware with known exploits</p>
          </div>
          <div style="background: var(--bg-dark); padding: 15px; border-radius: 8px; border-left: 3px solid var(--accent);">
            <strong style="color: var(--accent);">Open Debug Ports</strong>
            <p style="color: var(--text-secondary); font-size: 0.9em; margin-top: 5px;">Telnet (23), SSH (22), or custom debug interfaces exposed to network</p>
          </div>
          <div style="background: var(--bg-dark); padding: 15px; border-radius: 8px; border-left: 3px solid var(--accent);">
            <strong style="color: var(--accent);">Unencrypted Communications</strong>
            <p style="color: var(--text-secondary); font-size: 0.9em; margin-top: 5px;">Data transmitted in clear-text, allowing network sniffing attacks</p>
          </div>
          <div style="background: var(--bg-dark); padding: 15px; border-radius: 8px; border-left: 3px solid var(--accent);">
            <strong style="color: var(--accent);">Buffer Overflows</strong>
            <p style="color: var(--text-secondary); font-size: 0.9em; margin-top: 5px;">Input validation failures allowing code execution via malformed data</p>
          </div>
          <div style="background: var(--bg-dark); padding: 15px; border-radius: 8px; border-left: 3px solid var(--accent);">
            <strong style="color: var(--accent);">Insecure APIs</strong>
            <p style="color: var(--text-secondary); font-size: 0.9em; margin-top: 5px;">Web APIs lacking authentication, authorization, or input validation</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Attack Scenarios -->
    <div id="attacks" class="content-section">
      <div class="card">
        <h2>IoT Attack Scenario Walkthrough</h2>
        <p>Follow this realistic attack scenario to understand how IoT vulnerabilities are exploited. This educational walkthrough demonstrates defensive principles through offensive awareness.</p>

        <div class="danger-box">
          <strong>Ethical Reminder:</strong> This scenario is for educational purposes only. Attacking systems without authorization is illegal. Use this knowledge to defend, not to harm.
        </div>

        <div id="scenario-container">
          <div class="scenario-step active" data-step="1">
            <span class="step-number">1</span>
            <div style="display: inline-block; vertical-align: top; width: calc(100% - 50px);">
              <strong>Reconnaissance - Network Discovery</strong>
              <p style="margin-top: 8px; color: var(--text-secondary);">Attacker uses Shodan or network scanning tools to identify IoT devices exposed to the internet. Searches for specific device types, open ports, and default configurations.</p>
              <p style="margin-top: 8px;"><strong>Defense:</strong> Implement network segmentation, use firewalls to restrict internet-facing devices, disable UPnP.</p>
            </div>
          </div>

          <div class="scenario-step" data-step="2">
            <span class="step-number">2</span>
            <div style="display: inline-block; vertical-align: top; width: calc(100% - 50px);">
              <strong>Initial Access - Default Credentials</strong>
              <p style="margin-top: 8px; color: var(--text-secondary);">Attacker attempts authentication using manufacturer default credentials found in documentation or credential databases. Many IoT devices never have passwords changed.</p>
              <p style="margin-top: 8px;"><strong>Defense:</strong> Force password change on first setup, implement strong password policies, use multi-factor authentication.</p>
            </div>
          </div>

          <div class="scenario-step" data-step="3">
            <span class="step-number">3</span>
            <div style="display: inline-block; vertical-align: top; width: calc(100% - 50px);">
              <strong>Firmware Exploitation</strong>
              <p style="margin-top: 8px; color: var(--text-secondary);">Attacker downloads device firmware, extracts it using binwalk, and analyzes for hardcoded credentials, backdoors, or vulnerable services. Known vulnerabilities are exploited for root access.</p>
              <p style="margin-top: 8px;"><strong>Defense:</strong> Regular firmware updates, encrypted firmware, secure boot mechanisms, vulnerability scanning.</p>
            </div>
          </div>

          <div class="scenario-step" data-step="4">
            <span class="step-number">4</span>
            <div style="display: inline-block; vertical-align: top; width: calc(100% - 50px);">
              <strong>Lateral Movement</strong>
              <p style="margin-top: 8px; color: var(--text-secondary);">With one device compromised, attacker pivots to other devices on the same network. IoT devices often trust local network traffic, allowing easy lateral movement.</p>
              <p style="margin-top: 8px;"><strong>Defense:</strong> Network segmentation (VLANs), zero-trust architecture, micro-segmentation for IoT devices.</p>
            </div>
          </div>

          <div class="scenario-step" data-step="5">
            <span class="step-number">5</span>
            <div style="display: inline-block; vertical-align: top; width: calc(100% - 50px);">
              <strong>Data Exfiltration & Persistence</strong>
              <p style="margin-top: 8px; color: var(--text-secondary);">Attacker establishes persistent access (backdoor), monitors network traffic, exfiltrates sensitive data, or recruits device into botnet for DDoS attacks (Mirai-style).</p>
              <p style="margin-top: 8px;"><strong>Defense:</strong> Network monitoring, intrusion detection systems, regular security audits, device behavior analysis.</p>
            </div>
          </div>

          <div class="scenario-step" data-step="6">
            <span class="step-number">6</span>
            <div style="display: inline-block; vertical-align: top; width: calc(100% - 50px);">
              <strong>Impact & Consequences</strong>
              <p style="margin-top: 8px; color: var(--text-secondary);">Privacy breach (camera/microphone access), physical security compromise (smart locks), data theft, botnet participation, ransom demands, or use as attack platform.</p>
              <p style="margin-top: 8px;"><strong>Defense:</strong> Incident response plan, device isolation capabilities, backup and recovery procedures, security awareness training.</p>
            </div>
          </div>
        </div>

        <div class="scenario-controls">
          <button class="btn btn-secondary" onclick="previousStep()" id="prev-btn">Previous Step</button>
          <button class="btn btn-primary" onclick="nextStep()" id="next-btn">Next Step</button>
          <button class="btn btn-secondary" onclick="resetScenario()">Reset</button>
        </div>
      </div>
    </div>

    <!-- Firmware Analysis -->
    <div id="firmware" class="content-section">
      <div class="card">
        <h2>Firmware Analysis Workflow</h2>
        <p>Firmware analysis is critical for discovering vulnerabilities in IoT devices. This workflow demonstrates the process used by security researchers to analyze device firmware.</p>

        <div class="workflow-container">
          <div class="workflow-step" onclick="highlightWorkflow(this)">
            <div class="workflow-icon">üì•</div>
            <div class="workflow-content">
              <div class="workflow-title">1. Firmware Acquisition</div>
              <div class="workflow-description">Obtain firmware from manufacturer website, device extraction (JTAG/UART), or intercept during update process. May require physical access to device flash memory.</div>
            </div>
          </div>

          <div class="workflow-step" onclick="highlightWorkflow(this)">
            <div class="workflow-icon">üì¶</div>
            <div class="workflow-content">
              <div class="workflow-title">2. Firmware Extraction</div>
              <div class="workflow-description">Use tools like binwalk to identify and extract filesystem from firmware image. Common formats include SquashFS, JFFS2, YAFFS2, or encrypted containers.</div>
            </div>
          </div>

          <div class="workflow-step" onclick="highlightWorkflow(this)">
            <div class="workflow-icon">üîç</div>
            <div class="workflow-content">
              <div class="workflow-title">3. File System Analysis</div>
              <div class="workflow-description">Examine extracted files for configuration files, scripts, binaries, and web interfaces. Search for hardcoded credentials, API keys, certificates, and backdoors.</div>
            </div>
          </div>

          <div class="workflow-step" onclick="highlightWorkflow(this)">
            <div class="workflow-icon">üî¨</div>
            <div class="workflow-content">
              <div class="workflow-title">4. Binary Analysis</div>
              <div class="workflow-description">Disassemble binaries using tools like Ghidra or IDA Pro. Identify architecture (ARM, MIPS), analyze functions, look for buffer overflows, format string vulnerabilities, and logic flaws.</div>
            </div>
          </div>

          <div class="workflow-step" onclick="highlightWorkflow(this)">
            <div class="workflow-icon">üåê</div>
            <div class="workflow-content">
              <div class="workflow-title">5. Network Service Analysis</div>
              <div class="workflow-description">Identify running services (web servers, telnet, SSH), analyze authentication mechanisms, test for injection vulnerabilities, and assess API security.</div>
            </div>
          </div>

          <div class="workflow-step" onclick="highlightWorkflow(this)">
            <div class="workflow-icon">üß™</div>
            <div class="workflow-content">
              <div class="workflow-title">6. Dynamic Testing (Emulation)</div>
              <div class="workflow-description">Emulate firmware using QEMU or similar tools. Test discovered vulnerabilities in safe environment. Develop proof-of-concept exploits and validate findings.</div>
            </div>
          </div>

          <div class="workflow-step" onclick="highlightWorkflow(this)">
            <div class="workflow-icon">üìã</div>
            <div class="workflow-content">
              <div class="workflow-title">7. Reporting & Disclosure</div>
              <div class="workflow-description">Document findings, assess severity (CVSS scoring), follow responsible disclosure practices. Provide manufacturers time to patch before public disclosure.</div>
            </div>
          </div>
        </div>

        <div class="info-box">
          <strong>Common Firmware Analysis Tools:</strong>
          <ul style="margin-top: 10px;">
            <li><strong>binwalk:</strong> Firmware extraction and analysis</li>
            <li><strong>Ghidra/IDA Pro:</strong> Reverse engineering and disassembly</li>
            <li><strong>QEMU:</strong> Firmware emulation</li>
            <li><strong>firmwalker:</strong> Automated firmware security analysis</li>
            <li><strong>strings:</strong> Extract readable text from binaries</li>
            <li><strong>radare2:</strong> Advanced binary analysis framework</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Quiz Section -->
    <div id="quiz" class="content-section">
      <div class="card">
        <h2>IoT Security Assessment Quiz</h2>
        <p>Test your knowledge of IoT security concepts. Answer all 12 questions to earn your XP and track your progress.</p>
      </div>

      <div class="quiz-container" id="quiz-container">
        <!-- Questions will be generated by JavaScript -->
      </div>

      <div class="card" style="text-align: center;">
        <button class="btn btn-primary" onclick="submitQuiz()" id="submit-quiz">Submit Quiz</button>
        <div id="quiz-results" style="margin-top: 20px; display: none;"></div>
      </div>
    </div>

    <!-- Device Info Modal -->
    <div class="modal" id="device-modal">
      <div class="modal-content">
        <button class="modal-close" onclick="closeModal()">&times;</button>
        <h2 id="modal-device-name"></h2>
        <div id="modal-device-content"></div>
      </div>
    </div>

    <!-- Footer Navigation -->
    <div class="footer-nav">
      <p style="margin-bottom: 15px;"><strong>Dark Arts Vault Navigation</strong></p>
      <div class="nav-links">
        <a href="../index.html" class="btn btn-secondary">Back to Vault</a>
        <a href="../../index.html" class="btn btn-secondary">Hexworth Prime Home</a>
      </div>
    </div>
  </div>

  <script>
    // State Management
    let currentTab = 'overview';
    let progress = 0;
    let xpEarned = 0;
    let currentScenarioStep = 1;
    let quizAnswers = {};
    let placedDevices = [];
    let deviceIdCounter = 0;

    // Quiz Questions
    const quizQuestions = [
      {
        id: 1,
        question: "Which layer of IoT architecture is responsible for physical data collection from the environment?",
        options: [
          "Middleware Layer",
          "Edge Technology Layer (Perception)",
          "Application Layer",
          "Internet Layer"
        ],
        correct: 1,
        explanation: "The Edge Technology Layer (Perception Layer) contains sensors, actuators, and other devices that directly interact with the physical environment to collect data."
      },
      {
        id: 2,
        question: "What is the primary difference between Consumer IoT and Industrial IoT (IIoT)?",
        options: [
          "IIoT uses different protocols than Consumer IoT",
          "Consumer IoT focuses on personal devices while IIoT targets manufacturing and critical infrastructure",
          "IIoT devices are always more secure than Consumer IoT",
          "Consumer IoT cannot connect to the cloud"
        ],
        correct: 1,
        explanation: "Consumer IoT focuses on personal and home devices (smart homes, wearables), while IIoT targets industrial applications like manufacturing, SCADA systems, and critical infrastructure."
      },
      {
        id: 3,
        question: "Which communication protocol offers the longest range for IoT devices?",
        options: [
          "Bluetooth",
          "Zigbee",
          "Sigfox",
          "WiFi"
        ],
        correct: 2,
        explanation: "Sigfox can reach up to 50km range, making it suitable for wide-area applications. It's a Low Power Wide Area Network (LPWAN) protocol designed for long-range, low-bandwidth communications."
      },
      {
        id: 4,
        question: "What is the most common vulnerability found in IoT devices?",
        options: [
          "SQL Injection",
          "Cross-Site Scripting",
          "Default or weak credentials",
          "DDoS attacks"
        ],
        correct: 2,
        explanation: "Default or weak credentials are the most prevalent vulnerability in IoT devices. Many devices ship with factory default passwords that users never change, making them easy targets for attackers."
      },
      {
        id: 5,
        question: "In the Device-to-Gateway communication model, what role does the gateway play?",
        options: [
          "It only provides power to devices",
          "It aggregates data from multiple devices and forwards it to the cloud or local network",
          "It encrypts all communications automatically",
          "It serves as a backup storage device"
        ],
        correct: 1,
        explanation: "In the Device-to-Gateway model, the gateway acts as an intermediary that aggregates data from multiple devices, performs local processing, and forwards information to cloud services or local networks."
      },
      {
        id: 6,
        question: "Which IoT protocol typically offers the highest security level when properly implemented?",
        options: [
          "RFID",
          "Sigfox",
          "WiFi (with WPA3)",
          "Bluetooth Classic"
        ],
        correct: 2,
        explanation: "WiFi with WPA3 offers the highest security level when properly implemented, providing strong encryption, authentication, and protection against various attacks. However, misconfiguration can still lead to vulnerabilities."
      },
      {
        id: 7,
        question: "What tool is commonly used to discover IoT devices exposed on the internet?",
        options: [
          "Wireshark",
          "Shodan",
          "Metasploit",
          "Nessus"
        ],
        correct: 1,
        explanation: "Shodan is a search engine specifically designed to discover internet-connected devices, including IoT devices, servers, and industrial control systems. It's used by both security researchers and attackers."
      },
      {
        id: 8,
        question: "Which of the following is NOT a typical component of IoT architecture?",
        options: [
          "Sensors",
          "Gateways",
          "Mainframe computers",
          "Cloud servers"
        ],
        correct: 2,
        explanation: "Mainframe computers are not typical components of IoT architecture. IoT systems typically consist of sensors, gateways, cloud servers, and applications, focusing on distributed and edge computing rather than centralized mainframe systems."
      },
      {
        id: 9,
        question: "What is the primary purpose of firmware analysis in IoT security?",
        options: [
          "To improve device performance",
          "To discover vulnerabilities, hardcoded credentials, and backdoors",
          "To update the device interface",
          "To reduce power consumption"
        ],
        correct: 1,
        explanation: "Firmware analysis is conducted to discover security vulnerabilities, hardcoded credentials, backdoors, and other security issues within IoT device firmware before they can be exploited by attackers."
      },
      {
        id: 10,
        question: "Which attack vector involves extracting and analyzing device firmware to find vulnerabilities?",
        options: [
          "Network sniffing",
          "Firmware exploitation",
          "Physical tampering",
          "DDoS attack"
        ],
        correct: 1,
        explanation: "Firmware exploitation involves obtaining, extracting, and analyzing device firmware to discover vulnerabilities such as hardcoded credentials, buffer overflows, or backdoors that can be exploited."
      },
      {
        id: 11,
        question: "What security practice should be implemented to prevent lateral movement after an IoT device is compromised?",
        options: [
          "Using stronger WiFi passwords",
          "Network segmentation and VLANs",
          "Installing antivirus software",
          "Increasing bandwidth"
        ],
        correct: 1,
        explanation: "Network segmentation using VLANs creates isolated network zones, preventing attackers from easily moving from a compromised IoT device to other systems on the network. This limits the blast radius of a security breach."
      },
      {
        id: 12,
        question: "Which IoT operating system is optimized for ARM Cortex-M microcontrollers?",
        options: [
          "Windows 10 IoT",
          "Ubuntu Core",
          "ARM mbed OS",
          "Contiki"
        ],
        correct: 2,
        explanation: "ARM mbed OS is specifically designed and optimized for ARM Cortex-M microcontrollers, providing a lightweight operating system for resource-constrained IoT devices."
      }
    ];

    // Device vulnerability data
    const deviceVulnerabilities = {
      'smart-tv': {
        name: 'Smart TV',
        icon: 'üì∫',
        vulnerabilities: [
          'Outdated firmware with known CVEs',
          'Microphone/camera privacy concerns',
          'Unencrypted data transmission to manufacturer servers'
        ],
        severity: 'Medium-High',
        recommendation: 'Disable unused features, update firmware regularly, use network isolation'
      },
      'voice-assistant': {
        name: 'Voice Assistant',
        icon: 'üîä',
        vulnerabilities: [
          'Always-listening microphone (privacy risk)',
          'Cloud-dependent with data retention concerns',
          'Third-party skill security issues',
          'Vulnerable to voice command injection attacks'
        ],
        severity: 'High',
        recommendation: 'Review privacy settings, disable when not in use, audit connected skills'
      },
      'smart-light-1': {
        name: 'Smart Lights',
        icon: 'üí°',
        vulnerabilities: [],
        severity: 'Low',
        recommendation: 'Generally secure, ensure gateway security and update firmware'
      },
      'smart-fridge': {
        name: 'Smart Refrigerator',
        icon: 'üßä',
        vulnerabilities: [
          'Default credentials on web interface',
          'Outdated Linux kernel with known vulnerabilities'
        ],
        severity: 'Medium',
        recommendation: 'Change default passwords, segment from main network, disable internet access if not needed'
      },
      'coffee-maker': {
        name: 'Smart Coffee Maker',
        icon: '‚òï',
        vulnerabilities: [],
        severity: 'Low',
        recommendation: 'Limited attack surface, basic security sufficient'
      },
      'smart-lock': {
        name: 'Smart Door Lock',
        icon: 'üîí',
        vulnerabilities: [
          'Bluetooth pairing vulnerabilities',
          'Relay attacks possible due to weak authentication',
          'Physical bypass using electromagnetic interference',
          'Cloud service dependency for remote access',
          'Battery depletion can cause lockout'
        ],
        severity: 'Critical',
        recommendation: 'Use as secondary lock, implement strong authentication, keep firmware updated, monitor battery levels'
      },
      'security-camera': {
        name: 'Security Camera',
        icon: 'üìπ',
        vulnerabilities: [
          'Default admin credentials (admin/12345)',
          'Unencrypted video stream accessible on local network',
          'Open Telnet port (23) exposed',
          'Vulnerable web interface with directory traversal'
        ],
        severity: 'Critical',
        recommendation: 'Change credentials immediately, enable encryption, close unnecessary ports, isolate on separate VLAN'
      },
      'thermostat': {
        name: 'Smart Thermostat',
        icon: 'üå°Ô∏è',
        vulnerabilities: [],
        severity: 'Low',
        recommendation: 'Generally secure, monitor for unusual patterns that could indicate compromise'
      },
      'router': {
        name: 'WiFi Router',
        icon: 'üì∂',
        vulnerabilities: [
          'UPnP enabled allowing automatic port forwarding',
          'WPS vulnerability (brute force attack possible)',
          'Outdated firmware with known exploits'
        ],
        severity: 'High',
        recommendation: 'Disable UPnP, disable WPS, update firmware, use WPA3 encryption, change admin credentials'
      },
      'printer': {
        name: 'Network Printer',
        icon: 'üñ®Ô∏è',
        vulnerabilities: [
          'Open print ports accessible from network',
          'No authentication for print jobs (potential for data exfiltration)'
        ],
        severity: 'Medium',
        recommendation: 'Implement authentication, segment on separate network, disable unused protocols'
      }
    };

    // Initialize
    function init() {
      generateQuiz();
      updateProgress();
      setupDragAndDrop();
    }

    // Tab Switching
    function switchTab(tabName) {
      // Hide all sections
      document.querySelectorAll('.content-section').forEach(section => {
        section.classList.remove('active');
      });

      // Remove active class from all tabs
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
      });

      // Show selected section
      document.getElementById(tabName).classList.add('active');

      // Add active class to clicked tab
      event.target.classList.add('active');

      currentTab = tabName;
    }

    // Progress Management
    function updateProgress() {
      const sections = ['overview', 'architecture', 'topology', 'protocols', 'floorplan', 'scanner', 'attacks', 'firmware'];
      const completedSections = Object.keys(localStorage).filter(key => key.startsWith('iot-lab-')).length;

      progress = Math.min((completedSections / sections.length) * 100, 100);

      document.getElementById('progress-fill').style.width = progress + '%';
      document.getElementById('progress-text').textContent = Math.round(progress) + '%';
      document.getElementById('progress-percent').textContent = Math.round(progress) + '%';
      document.getElementById('xp-earned').textContent = xpEarned;
    }

    function markSectionComplete(sectionName) {
      if (!localStorage.getItem('iot-lab-' + sectionName)) {
        localStorage.setItem('iot-lab-' + sectionName, 'true');
        xpEarned += 8;
        updateProgress();
      }
    }

    // Architecture Layer Highlighting
    function highlightLayer(element) {
      document.querySelectorAll('.arch-layer').forEach(layer => {
        layer.style.background = 'var(--bg-dark)';
      });
      element.style.background = 'var(--bg-hover)';

      markSectionComplete('architecture');
    }

    // Topology Builder - Drag and Drop
    function setupDragAndDrop() {
      const canvas = document.getElementById('topology-canvas');
      const deviceItems = document.querySelectorAll('.device-item');

      deviceItems.forEach(item => {
        item.addEventListener('dragstart', (e) => {
          e.dataTransfer.setData('device', e.target.dataset.device);
          e.dataTransfer.setData('icon', e.target.querySelector('.device-icon').textContent);
          e.dataTransfer.setData('name', e.target.querySelector('.device-name').textContent);
        });
      });

      canvas.addEventListener('dragover', (e) => {
        e.preventDefault();
      });

      canvas.addEventListener('drop', (e) => {
        e.preventDefault();

        const device = e.dataTransfer.getData('device');
        const icon = e.dataTransfer.getData('icon');
        const name = e.dataTransfer.getData('name');

        const rect = canvas.getBoundingClientRect();
        const x = e.clientX - rect.left - 40;
        const y = e.clientY - rect.top - 40;

        addDeviceToCanvas(device, icon, name, x, y);
        markSectionComplete('topology');
      });
    }

    function addDeviceToCanvas(device, icon, name, x, y) {
      const canvas = document.getElementById('topology-canvas');

      // Remove placeholder text if exists
      const placeholder = canvas.querySelector('p');
      if (placeholder) placeholder.remove();

      const deviceDiv = document.createElement('div');
      deviceDiv.className = 'placed-device';
      deviceDiv.style.left = x + 'px';
      deviceDiv.style.top = y + 'px';
      deviceDiv.dataset.deviceId = deviceIdCounter++;
      deviceDiv.dataset.deviceType = device;

      deviceDiv.innerHTML = `
        <div class="device-icon">${icon}</div>
        <div class="device-name">${name}</div>
        <div class="remove-device" onclick="removeDevice(this)">&times;</div>
      `;

      // Make draggable within canvas
      deviceDiv.addEventListener('mousedown', startDrag);

      canvas.appendChild(deviceDiv);
      placedDevices.push({id: deviceIdCounter - 1, type: device, x, y});
    }

    function startDrag(e) {
      if (e.target.classList.contains('remove-device')) return;

      const device = e.currentTarget;
      const canvas = document.getElementById('topology-canvas');
      const rect = canvas.getBoundingClientRect();

      let shiftX = e.clientX - device.getBoundingClientRect().left;
      let shiftY = e.clientY - device.getBoundingClientRect().top;

      function moveAt(pageX, pageY) {
        let newX = pageX - rect.left - shiftX;
        let newY = pageY - rect.top - shiftY;

        // Keep within canvas bounds
        newX = Math.max(0, Math.min(newX, rect.width - device.offsetWidth));
        newY = Math.max(0, Math.min(newY, rect.height - device.offsetHeight));

        device.style.left = newX + 'px';
        device.style.top = newY + 'px';
      }

      function onMouseMove(e) {
        moveAt(e.pageX, e.pageY);
      }

      canvas.addEventListener('mousemove', onMouseMove);

      device.addEventListener('mouseup', function() {
        canvas.removeEventListener('mousemove', onMouseMove);
      }, {once: true});
    }

    function removeDevice(btn) {
      const device = btn.parentElement;
      const deviceId = device.dataset.deviceId;
      placedDevices = placedDevices.filter(d => d.id != deviceId);
      device.remove();

      // Add placeholder if no devices left
      const canvas = document.getElementById('topology-canvas');
      if (canvas.querySelectorAll('.placed-device').length === 0) {
        canvas.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 140px 20px;">Drag devices here to build your network</p>';
      }
    }

    function clearTopology() {
      const canvas = document.getElementById('topology-canvas');
      canvas.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 140px 20px;">Drag devices here to build your network</p>';
      placedDevices = [];
    }

    function analyzeTopology() {
      if (placedDevices.length === 0) {
        alert('Add devices to the network first!');
        return;
      }

      const hasGateway = placedDevices.some(d => d.type === 'gateway' || d.type === 'router');
      const hasCloud = placedDevices.some(d => d.type === 'cloud');
      const deviceCount = placedDevices.length;

      let analysis = `Network Topology Analysis:\n\n`;
      analysis += `Total Devices: ${deviceCount}\n`;
      analysis += `Gateway Present: ${hasGateway ? 'Yes' : 'No'}\n`;
      analysis += `Cloud Connection: ${hasCloud ? 'Yes' : 'No'}\n\n`;

      analysis += `Security Recommendations:\n`;
      if (!hasGateway) {
        analysis += '- Add a gateway to centralize security controls\n';
      }
      if (deviceCount > 5 && hasGateway) {
        analysis += '- Consider network segmentation for IoT devices\n';
      }
      analysis += '- Implement strong authentication for all devices\n';
      analysis += '- Use encrypted communications (TLS/DTLS)\n';
      analysis += '- Regular firmware updates and security monitoring\n';

      alert(analysis);
      markSectionComplete('topology');
    }

    // Scanner Simulation
    let scanInterval;
    function startScan() {
      const target = document.getElementById('scan-target').value;
      const results = document.getElementById('scanner-results');

      results.innerHTML = '<div style="color: #00ff00;">IoT Vulnerability Scanner v3.2</div>';
      results.innerHTML += `<div class="info-line">Target: ${target}</div>`;
      results.innerHTML += '<div class="info-line">Starting scan...</div><br>';

      const devices = [
        {ip: '192.168.1.15', type: 'Security Camera', port: '80,23', vuln: 'Default credentials (admin/12345), Open Telnet'},
        {ip: '192.168.1.23', type: 'Smart Thermostat', port: '443', vuln: 'None detected'},
        {ip: '192.168.1.34', type: 'Smart TV', port: '80,8080', vuln: 'Outdated firmware (CVE-2023-1234)'},
        {ip: '192.168.1.45', type: 'WiFi Router', port: '80,443', vuln: 'UPnP enabled, WPS vulnerable'},
        {ip: '192.168.1.56', type: 'Smart Lock', port: '443', vuln: 'Weak encryption (TLS 1.0)'},
        {ip: '192.168.1.67', type: 'Network Printer', port: '9100,515', vuln: 'No authentication required'},
        {ip: '192.168.1.78', type: 'Voice Assistant', port: '443', vuln: 'Privacy concerns - always listening'},
        {ip: '192.168.1.89', type: 'Smart Fridge', port: '80', vuln: 'Default credentials, outdated kernel'}
      ];

      let delay = 500;
      devices.forEach((device, index) => {
        setTimeout(() => {
          results.innerHTML += `<div class="scan-line info-line">Scanning ${device.ip}...</div>`;

          setTimeout(() => {
            results.innerHTML += `<div class="scan-line">Found: ${device.type} | Ports: ${device.port}</div>`;
            if (device.vuln !== 'None detected') {
              results.innerHTML += `<div class="scan-line vulnerability-found">VULNERABILITY: ${device.vuln}</div>`;
            } else {
              results.innerHTML += `<div class="scan-line" style="color: #00ff00;">Status: Secure</div>`;
            }
            results.innerHTML += '<br>';
            results.scrollTop = results.scrollHeight;
          }, 300);

        }, delay * index);
      });

      setTimeout(() => {
        results.innerHTML += '<div class="info-line">Scan complete.</div>';
        results.innerHTML += '<div class="vulnerability-found">Total vulnerabilities found: 7</div>';
        results.scrollTop = results.scrollHeight;
        markSectionComplete('scanner');
      }, delay * devices.length + 500);
    }

    function clearScanResults() {
      document.getElementById('scanner-results').innerHTML = `
        <div style="color: #00ff00;">IoT Vulnerability Scanner v3.2</div>
        <div style="color: #888;">Ready to scan... Enter target and click Start Scan</div>
      `;
    }

    // Attack Scenario Navigation
    function nextStep() {
      const steps = document.querySelectorAll('.scenario-step');
      if (currentScenarioStep < steps.length) {
        steps[currentScenarioStep - 1].classList.remove('active');
        steps[currentScenarioStep - 1].classList.add('completed');
        steps[currentScenarioStep].classList.add('active');
        currentScenarioStep++;

        if (currentScenarioStep === steps.length) {
          document.getElementById('next-btn').textContent = 'Scenario Complete';
          document.getElementById('next-btn').disabled = true;
          markSectionComplete('attacks');
        }
      }
    }

    function previousStep() {
      const steps = document.querySelectorAll('.scenario-step');
      if (currentScenarioStep > 1) {
        steps[currentScenarioStep - 1].classList.remove('active');
        steps[currentScenarioStep - 2].classList.remove('completed');
        steps[currentScenarioStep - 2].classList.add('active');
        currentScenarioStep--;

        document.getElementById('next-btn').textContent = 'Next Step';
        document.getElementById('next-btn').disabled = false;
      }
    }

    function resetScenario() {
      const steps = document.querySelectorAll('.scenario-step');
      steps.forEach((step, index) => {
        step.classList.remove('active', 'completed');
        if (index === 0) step.classList.add('active');
      });
      currentScenarioStep = 1;
      document.getElementById('next-btn').textContent = 'Next Step';
      document.getElementById('next-btn').disabled = false;
    }

    // Firmware Workflow
    function highlightWorkflow(element) {
      document.querySelectorAll('.workflow-step').forEach(step => {
        step.style.borderColor = 'var(--border)';
      });
      element.style.borderColor = 'var(--primary)';
      markSectionComplete('firmware');
    }

    // Device Info Modal
    function showDeviceInfo(deviceId) {
      const device = deviceVulnerabilities[deviceId];
      const modal = document.getElementById('device-modal');
      const modalName = document.getElementById('modal-device-name');
      const modalContent = document.getElementById('modal-device-content');

      modalName.textContent = device.icon + ' ' + device.name;

      let content = `<p><strong>Severity Level:</strong> <span style="color: var(--accent);">${device.severity}</span></p>`;

      if (device.vulnerabilities.length > 0) {
        content += '<h3>Known Vulnerabilities:</h3>';
        content += '<ul class="vulnerability-list">';
        device.vulnerabilities.forEach(vuln => {
          content += `<li>${vuln}</li>`;
        });
        content += '</ul>';
      } else {
        content += '<p style="color: var(--success);">No critical vulnerabilities detected.</p>';
      }

      content += `<h3>Security Recommendations:</h3>`;
      content += `<p>${device.recommendation}</p>`;

      modalContent.innerHTML = content;
      modal.classList.add('active');
      markSectionComplete('floorplan');
    }

    function closeModal() {
      document.getElementById('device-modal').classList.remove('active');
    }

    // Quiz Generation
    function generateQuiz() {
      const container = document.getElementById('quiz-container');
      container.innerHTML = '';

      quizQuestions.forEach((q, index) => {
        const questionDiv = document.createElement('div');
        questionDiv.className = 'question';
        questionDiv.innerHTML = `
          <div class="question-number">Question ${q.id} of ${quizQuestions.length}</div>
          <div class="question-text">${q.question}</div>
          <div class="options">
            ${q.options.map((option, i) => `
              <div class="option" onclick="selectOption(${q.id}, ${i})">
                ${option}
              </div>
            `).join('')}
          </div>
          <div class="feedback" id="feedback-${q.id}"></div>
        `;
        container.appendChild(questionDiv);
      });
    }

    function selectOption(questionId, optionIndex) {
      const question = quizQuestions.find(q => q.id === questionId);
      const options = document.querySelectorAll(`#quiz-container .question:nth-child(${questionId}) .option`);

      // Remove previous selections
      options.forEach(opt => {
        opt.classList.remove('selected');
      });

      // Mark selected
      options[optionIndex].classList.add('selected');
      quizAnswers[questionId] = optionIndex;
    }

    function submitQuiz() {
      if (Object.keys(quizAnswers).length < quizQuestions.length) {
        alert('Please answer all questions before submitting!');
        return;
      }

      let correct = 0;

      quizQuestions.forEach(q => {
        const userAnswer = quizAnswers[q.id];
        const options = document.querySelectorAll(`#quiz-container .question:nth-child(${q.id}) .option`);
        const feedback = document.getElementById(`feedback-${q.id}`);

        options.forEach((opt, i) => {
          opt.classList.remove('selected');
          if (i === q.correct) {
            opt.classList.add('correct');
          } else if (i === userAnswer && userAnswer !== q.correct) {
            opt.classList.add('incorrect');
          }
        });

        if (userAnswer === q.correct) {
          correct++;
          feedback.className = 'feedback show correct';
          feedback.textContent = 'Correct! ' + q.explanation;
        } else {
          feedback.className = 'feedback show incorrect';
          feedback.textContent = 'Incorrect. ' + q.explanation;
        }
      });

      const percentage = (correct / quizQuestions.length) * 100;
      const quizXP = Math.round((correct / quizQuestions.length) * 30);

      if (!localStorage.getItem('iot-lab-quiz')) {
        xpEarned += quizXP;
        localStorage.setItem('iot-lab-quiz', 'true');
        updateProgress();
      }

      const results = document.getElementById('quiz-results');
      results.innerHTML = `
        <h3 style="color: ${percentage >= 70 ? 'var(--success)' : 'var(--accent)'};">
          Quiz Results: ${correct}/${quizQuestions.length} (${percentage.toFixed(0)}%)
        </h3>
        <p>XP Earned: ${quizXP} / 30</p>
        ${percentage >= 70 ?
          '<p style="color: var(--success);">Excellent work! You have a strong understanding of IoT security.</p>' :
          '<p style="color: var(--warning);">Review the material and try again to improve your score.</p>'
        }
      `;
      results.style.display = 'block';

      document.getElementById('submit-quiz').textContent = 'Retake Quiz';
      document.getElementById('submit-quiz').onclick = function() {
        location.reload();
      };
    }

    // Close modal on outside click
    window.onclick = function(event) {
      const modal = document.getElementById('device-modal');
      if (event.target === modal) {
        closeModal();
      }
    }

    // Initialize on load
    window.onload = init;
  </script>
</body>
</html>