<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Access Control -->
    <script src="../../../components/AccessGuard.js"></script>
    <script>
        AccessGuard.require('dark-arts');
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Incident Response - The Dark Arts</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: #0a0508;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #c0a0d0;
            line-height: 1.7;
            overflow-x: hidden;
        }

        /* Ambient background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                radial-gradient(ellipse at 20% 30%, rgba(80, 40, 100, 0.08) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 70%, rgba(60, 20, 80, 0.06) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        /* Header */
        .module-header {
            background: linear-gradient(180deg, rgba(60, 30, 80, 0.3) 0%, transparent 100%);
            border-bottom: 1px solid rgba(100, 60, 130, 0.2);
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .back-btn {
            background: rgba(80, 40, 100, 0.2);
            border: 1px solid rgba(100, 60, 130, 0.3);
            color: #9a7aaa;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(100, 60, 130, 0.3);
            border-color: rgba(120, 80, 150, 0.5);
        }

        .module-title {
            font-size: 1.1rem;
            color: #b090c0;
            letter-spacing: 0.1em;
        }

        .tier-badge {
            padding: 6px 14px;
            background: linear-gradient(135deg, rgba(100, 60, 130, 0.3), rgba(80, 40, 110, 0.3));
            border: 1px solid rgba(120, 80, 150, 0.4);
            border-radius: 15px;
            font-size: 0.65rem;
            letter-spacing: 0.15em;
            color: #9a7aaa;
        }

        .progress-bar {
            width: 200px;
            height: 6px;
            background: rgba(60, 30, 80, 0.3);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6a4a8a, #9a6aba);
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Main content */
        .module-content {
            max-width: 1100px;
            margin: 0 auto;
            padding: 40px;
            position: relative;
            z-index: 10;
        }

        /* Intro section */
        .intro-section {
            text-align: center;
            padding: 40px 0 60px;
        }

        .intro-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            opacity: 0.8;
        }

        .intro-title {
            font-size: 2.2rem;
            color: #c9b8d9;
            margin-bottom: 15px;
            font-weight: 300;
            letter-spacing: 0.1em;
        }

        .intro-subtitle {
            font-size: 1rem;
            color: #8a6a9a;
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.8;
        }

        /* Section styling */
        .section {
            margin-bottom: 80px;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.6s ease;
        }

        .section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .section-number {
            font-size: 0.7rem;
            color: #6a4a7a;
            letter-spacing: 0.3em;
            margin-bottom: 10px;
        }

        .section-title {
            font-size: 1.8rem;
            color: #c0a0d0;
            margin-bottom: 20px;
            font-weight: 300;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .section-icon {
            font-size: 1.6rem;
            opacity: 0.7;
        }

        .section-content {
            color: #a080b0;
            font-size: 1rem;
        }

        .section-content p {
            margin-bottom: 15px;
        }

        .section-content ul {
            list-style: none;
            padding-left: 20px;
        }

        .section-content li {
            margin-bottom: 10px;
            position: relative;
            padding-left: 20px;
        }

        .section-content li::before {
            content: '‚ñ∏';
            position: absolute;
            left: 0;
            color: #7a5a8a;
        }

        /* Info boxes */
        .info-box {
            background: linear-gradient(135deg, rgba(40, 20, 60, 0.4), rgba(30, 15, 50, 0.3));
            border-left: 3px solid #7a5a9a;
            border-radius: 6px;
            padding: 20px 25px;
            margin: 25px 0;
        }

        .info-box-title {
            font-size: 0.85rem;
            color: #9a7aaa;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .info-box-content {
            color: #a080b0;
            font-size: 0.95rem;
        }

        /* Interactive visualizations */
        .visualization {
            background: rgba(20, 10, 30, 0.6);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 10px;
            padding: 30px;
            margin: 30px 0;
        }

        .viz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(80, 50, 100, 0.2);
        }

        .viz-title {
            font-size: 1rem;
            color: #b090c0;
            letter-spacing: 0.05em;
        }

        .viz-controls {
            display: flex;
            gap: 10px;
        }

        .viz-btn {
            background: rgba(80, 40, 100, 0.3);
            border: 1px solid rgba(100, 60, 130, 0.4);
            color: #9a7aaa;
            padding: 6px 14px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.75rem;
            transition: all 0.3s ease;
        }

        .viz-btn:hover {
            background: rgba(100, 60, 130, 0.4);
            border-color: rgba(120, 80, 150, 0.6);
        }

        .viz-btn.active {
            background: rgba(120, 80, 150, 0.5);
            border-color: rgba(140, 100, 170, 0.7);
        }

        /* IR Timeline */
        .ir-timeline {
            position: relative;
            padding: 30px 0;
        }

        .timeline-line {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg,
                rgba(100, 60, 130, 0.3) 0%,
                rgba(120, 80, 150, 0.5) 50%,
                rgba(100, 60, 130, 0.3) 100%);
            transform: translateY(-50%);
        }

        .timeline-phases {
            display: flex;
            justify-content: space-between;
            position: relative;
        }

        .timeline-phase {
            flex: 1;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .phase-circle {
            width: 60px;
            height: 60px;
            margin: 0 auto 15px;
            background: rgba(30, 15, 40, 0.8);
            border: 3px solid rgba(100, 60, 130, 0.4);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: all 0.3s ease;
            position: relative;
            z-index: 2;
        }

        .timeline-phase:hover .phase-circle {
            transform: scale(1.1);
            border-color: rgba(140, 100, 170, 0.7);
            box-shadow: 0 0 20px rgba(120, 80, 150, 0.4);
        }

        .timeline-phase.active .phase-circle {
            background: rgba(80, 40, 100, 0.6);
            border-color: rgba(140, 100, 170, 0.8);
            box-shadow: 0 0 30px rgba(120, 80, 150, 0.6);
        }

        .phase-name {
            font-size: 0.8rem;
            color: #8a6a9a;
            letter-spacing: 0.05em;
            margin-bottom: 5px;
        }

        .phase-desc {
            font-size: 0.65rem;
            color: #6a4a7a;
        }

        .phase-details {
            display: none;
            margin-top: 30px;
            padding: 25px;
            background: rgba(30, 15, 40, 0.5);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 8px;
        }

        .phase-details.active {
            display: block;
        }

        /* Alert Triage Simulator */
        .triage-container {
            display: grid;
            gap: 15px;
        }

        .alert-card {
            background: rgba(30, 15, 40, 0.5);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-left: 4px solid transparent;
            border-radius: 6px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .alert-card:hover {
            background: rgba(40, 20, 50, 0.6);
            transform: translateX(5px);
        }

        .alert-card.critical {
            border-left-color: #aa5a5a;
        }

        .alert-card.high {
            border-left-color: #aa7a5a;
        }

        .alert-card.medium {
            border-left-color: #aa9a5a;
        }

        .alert-card.low {
            border-left-color: #7a9a7a;
        }

        .alert-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .alert-severity {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.65rem;
            font-weight: bold;
            letter-spacing: 0.1em;
        }

        .alert-severity.critical {
            background: rgba(150, 60, 60, 0.3);
            color: #cc8a8a;
        }

        .alert-severity.high {
            background: rgba(150, 100, 60, 0.3);
            color: #ccaa8a;
        }

        .alert-severity.medium {
            background: rgba(150, 140, 60, 0.3);
            color: #ccca8a;
        }

        .alert-severity.low {
            background: rgba(80, 120, 80, 0.3);
            color: #aacc8a;
        }

        .alert-title {
            font-size: 1rem;
            color: #b090c0;
            margin-bottom: 8px;
        }

        .alert-details {
            font-size: 0.85rem;
            color: #8a6a9a;
            line-height: 1.6;
        }

        .triage-feedback {
            margin-top: 15px;
            padding: 15px;
            background: rgba(40, 20, 60, 0.4);
            border-radius: 6px;
            border-left: 3px solid #7a5a9a;
            display: none;
        }

        .triage-feedback.show {
            display: block;
        }

        /* Decision Tree */
        .decision-tree {
            padding: 20px;
        }

        .decision-node {
            background: rgba(30, 15, 40, 0.5);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            display: none;
        }

        .decision-node.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .decision-question {
            font-size: 1.1rem;
            color: #b090c0;
            margin-bottom: 20px;
        }

        .decision-options {
            display: grid;
            gap: 12px;
        }

        .decision-option {
            padding: 15px 20px;
            background: rgba(40, 20, 60, 0.3);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #9a7aaa;
        }

        .decision-option:hover {
            background: rgba(60, 30, 80, 0.4);
            border-color: rgba(100, 60, 130, 0.5);
            transform: translateX(5px);
        }

        /* Log Analysis */
        .log-viewer {
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            background: rgba(10, 5, 15, 0.8);
            border-radius: 6px;
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        .log-entry {
            margin: 8px 0;
            padding: 8px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .log-entry:hover {
            background: rgba(40, 20, 60, 0.3);
        }

        .log-entry.suspicious {
            background: rgba(100, 60, 40, 0.2);
            border-left: 3px solid #aa7a5a;
        }

        .log-entry.malicious {
            background: rgba(100, 40, 40, 0.2);
            border-left: 3px solid #aa5a5a;
        }

        .log-timestamp {
            color: #7a5a9a;
        }

        .log-source {
            color: #6a9a7a;
        }

        .log-message {
            color: #c0a0d0;
        }

        /* Tabletop Exercise */
        .tabletop-container {
            background: rgba(20, 10, 30, 0.6);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 10px;
            padding: 30px;
            margin: 30px 0;
        }

        .scenario-card {
            background: rgba(30, 15, 40, 0.7);
            border: 1px solid rgba(100, 60, 130, 0.4);
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .scenario-time {
            display: inline-block;
            padding: 6px 12px;
            background: rgba(80, 40, 100, 0.3);
            border-radius: 15px;
            font-size: 0.7rem;
            letter-spacing: 0.1em;
            color: #9a7aaa;
            margin-bottom: 15px;
        }

        .scenario-text {
            color: #b090c0;
            line-height: 1.8;
            margin-bottom: 20px;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }

        .action-btn {
            padding: 12px 20px;
            background: rgba(60, 30, 80, 0.3);
            border: 1px solid rgba(100, 60, 130, 0.4);
            border-radius: 6px;
            color: #a080b0;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .action-btn:hover {
            background: rgba(80, 40, 100, 0.4);
            border-color: rgba(120, 80, 150, 0.6);
            transform: translateY(-2px);
        }

        .action-btn.selected {
            background: rgba(100, 60, 130, 0.4);
            border-color: rgba(140, 100, 170, 0.6);
        }

        .action-btn.good {
            background: rgba(40, 80, 40, 0.3);
            border-color: rgba(60, 120, 60, 0.6);
            color: #7aaa7a;
        }

        .action-btn.bad {
            background: rgba(80, 40, 40, 0.3);
            border-color: rgba(120, 60, 60, 0.6);
            color: #aa7a7a;
        }

        .exercise-score {
            text-align: center;
            padding: 20px;
            background: rgba(40, 20, 60, 0.4);
            border-radius: 8px;
            margin-top: 20px;
        }

        .score-display {
            font-size: 2rem;
            color: #c0a0d0;
            margin-bottom: 10px;
        }

        /* Grid layouts */
        .two-col-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 25px 0;
        }

        .info-card {
            background: rgba(30, 15, 40, 0.5);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 8px;
            padding: 20px;
        }

        .info-card h3 {
            font-size: 1.1rem;
            color: #b090c0;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-card ul {
            list-style: none;
            padding: 0;
        }

        .info-card li {
            margin-bottom: 10px;
            padding-left: 20px;
            position: relative;
        }

        .info-card li::before {
            content: '‚Ä¢';
            position: absolute;
            left: 0;
            color: #7a5a8a;
            font-weight: bold;
        }

        /* Certificate */
        .certificate-container {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(10, 5, 15, 0.98);
            border: 2px solid rgba(140, 100, 170, 0.6);
            border-radius: 10px;
            padding: 40px;
            max-width: 600px;
            text-align: center;
            z-index: 1000;
            box-shadow: 0 0 50px rgba(120, 80, 150, 0.5);
        }

        .certificate-container.show {
            display: block;
            animation: certificateAppear 0.5s ease;
        }

        @keyframes certificateAppear {
            from {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .certificate-title {
            font-size: 1.8rem;
            color: #c9b8d9;
            margin-bottom: 20px;
        }

        .certificate-text {
            color: #a080b0;
            margin-bottom: 30px;
            line-height: 1.8;
        }

        .certificate-close {
            padding: 12px 30px;
            background: linear-gradient(135deg, rgba(100, 60, 130, 0.4), rgba(80, 40, 110, 0.3));
            border: 1px solid rgba(140, 100, 170, 0.5);
            border-radius: 25px;
            color: #c0a0d0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .certificate-close:hover {
            background: linear-gradient(135deg, rgba(120, 80, 150, 0.5), rgba(100, 60, 130, 0.4));
            transform: translateY(-2px);
        }

        /* Completion section */
        .completion-section {
            text-align: center;
            padding: 60px 40px;
            background: linear-gradient(135deg, rgba(40, 20, 60, 0.3), rgba(30, 15, 50, 0.4));
            border: 1px solid rgba(100, 60, 130, 0.3);
            border-radius: 12px;
            margin: 60px 0 40px;
        }

        .completion-icon {
            font-size: 3.5rem;
            margin-bottom: 20px;
            opacity: 0.8;
        }

        .completion-title {
            font-size: 1.8rem;
            color: #c9b8d9;
            margin-bottom: 15px;
            font-weight: 300;
        }

        .completion-text {
            color: #8a6a9a;
            font-size: 1rem;
            max-width: 600px;
            margin: 0 auto 30px;
            line-height: 1.8;
        }

        .completion-btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 14px 32px;
            background: linear-gradient(135deg, rgba(100, 60, 130, 0.4), rgba(80, 40, 110, 0.3));
            border: 1px solid rgba(140, 100, 170, 0.5);
            border-radius: 25px;
            color: #c0a0d0;
            font-size: 0.9rem;
            letter-spacing: 0.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .completion-btn:hover {
            background: linear-gradient(135deg, rgba(120, 80, 150, 0.5), rgba(100, 60, 130, 0.4));
            border-color: rgba(160, 120, 190, 0.6);
            box-shadow: 0 0 30px rgba(120, 80, 150, 0.4);
            transform: translateY(-3px);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .module-content {
                padding: 20px;
            }

            .two-col-grid {
                grid-template-columns: 1fr;
            }

            .timeline-phases {
                flex-direction: column;
                gap: 30px;
            }

            .timeline-line {
                display: none;
            }

            .intro-title {
                font-size: 1.6rem;
            }

            .section-title {
                font-size: 1.4rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="module-header">
        <div class="header-left">
            <a href="../index.html" class="back-btn">‚Üê Back to Vault</a>
            <span class="module-title">INCIDENT RESPONSE</span>
        </div>
        <div style="display: flex; align-items: center; gap: 15px;">
            <span class="tier-badge">TIER 3</span>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="module-content">
        <!-- Introduction -->
        <div class="intro-section">
            <div class="intro-icon">üö®</div>
            <h1 class="intro-title">Incident Response</h1>
            <p class="intro-subtitle">
                When the breach happens, chaos becomes clarity. This is where defenders shine‚Äî
                coordinating detection, containment, and recovery with precision. Master the NIST IR framework,
                triage alerts like a pro, and lead your team through the storm of a real-world cyber incident.
            </p>
        </div>

        <!-- Section 1: Incident Response Overview -->
        <section class="section" data-section="1">
            <div class="section-number">SECTION 01</div>
            <h2 class="section-title">
                <span class="section-icon">üìã</span>
                Incident Response Overview
            </h2>
            <div class="section-content">
                <p>
                    Incident Response (IR) is the systematic approach to managing and recovering from security breaches
                    or cyberattacks. The NIST IR framework provides a battle-tested methodology used by organizations worldwide.
                </p>

                <div class="visualization">
                    <div class="viz-header">
                        <div class="viz-title">NIST Incident Response Lifecycle</div>
                    </div>
                    <div class="ir-timeline">
                        <div class="timeline-line"></div>
                        <div class="timeline-phases">
                            <div class="timeline-phase active" onclick="showPhase(1)">
                                <div class="phase-circle">üõ°Ô∏è</div>
                                <div class="phase-name">Preparation</div>
                                <div class="phase-desc">Ready the team</div>
                            </div>
                            <div class="timeline-phase" onclick="showPhase(2)">
                                <div class="phase-circle">üîç</div>
                                <div class="phase-name">Detection & Analysis</div>
                                <div class="phase-desc">Find the threat</div>
                            </div>
                            <div class="timeline-phase" onclick="showPhase(3)">
                                <div class="phase-circle">‚õî</div>
                                <div class="phase-name">Containment</div>
                                <div class="phase-desc">Stop the spread</div>
                            </div>
                            <div class="timeline-phase" onclick="showPhase(4)">
                                <div class="phase-circle">üîß</div>
                                <div class="phase-name">Eradication & Recovery</div>
                                <div class="phase-desc">Remove & restore</div>
                            </div>
                            <div class="timeline-phase" onclick="showPhase(5)">
                                <div class="phase-circle">üìä</div>
                                <div class="phase-name">Post-Incident</div>
                                <div class="phase-desc">Learn & improve</div>
                            </div>
                        </div>

                        <div class="phase-details active" id="phase1">
                            <h3 style="color: #b090c0; margin-bottom: 15px;">Phase 1: Preparation</h3>
                            <p style="color: #a080b0; margin-bottom: 15px;">
                                Build your IR capability before incidents occur. This phase sets the foundation for all response activities.
                            </p>
                            <ul style="color: #9a7aaa;">
                                <li>Establish IR policy and procedures</li>
                                <li>Form and train the CSIRT (Computer Security Incident Response Team)</li>
                                <li>Deploy monitoring and detection tools (SIEM, EDR, IDS)</li>
                                <li>Create runbooks for common incident types</li>
                                <li>Conduct tabletop exercises and simulations</li>
                            </ul>
                        </div>

                        <div class="phase-details" id="phase2">
                            <h3 style="color: #b090c0; margin-bottom: 15px;">Phase 2: Detection & Analysis</h3>
                            <p style="color: #a080b0; margin-bottom: 15px;">
                                Identify potential incidents and determine their scope and severity. Speed and accuracy are critical.
                            </p>
                            <ul style="color: #9a7aaa;">
                                <li>Monitor alerts from SIEM, EDR, and security tools</li>
                                <li>Triage alerts by severity and potential impact</li>
                                <li>Collect and preserve evidence (logs, memory dumps, network captures)</li>
                                <li>Identify indicators of compromise (IOCs)</li>
                                <li>Determine attack vectors and timeline</li>
                                <li>Assess scope of compromise and affected systems</li>
                            </ul>
                        </div>

                        <div class="phase-details" id="phase3">
                            <h3 style="color: #b090c0; margin-bottom: 15px;">Phase 3: Containment</h3>
                            <p style="color: #a080b0; margin-bottom: 15px;">
                                Limit the damage and prevent the incident from spreading. Balance business continuity with security.
                            </p>
                            <ul style="color: #9a7aaa;">
                                <li><strong>Short-term containment:</strong> Immediate actions to stop active threats (isolate infected hosts)</li>
                                <li><strong>Long-term containment:</strong> Temporary fixes to allow continued operations (apply patches, change passwords)</li>
                                <li>Network segmentation and firewall rules</li>
                                <li>Account lockdowns and credential resets</li>
                                <li>Preserve evidence while containing the threat</li>
                            </ul>
                        </div>

                        <div class="phase-details" id="phase4">
                            <h3 style="color: #b090c0; margin-bottom: 15px;">Phase 4: Eradication & Recovery</h3>
                            <p style="color: #a080b0; margin-bottom: 15px;">
                                Remove the threat completely and restore systems to normal operations. Verify no backdoors remain.
                            </p>
                            <ul style="color: #9a7aaa;">
                                <li>Remove malware, backdoors, and unauthorized access</li>
                                <li>Rebuild compromised systems from known-good backups</li>
                                <li>Apply security patches and hardening measures</li>
                                <li>Restore data from verified clean backups</li>
                                <li>Monitor for signs of persistence or re-infection</li>
                                <li>Gradually return systems to production</li>
                            </ul>
                        </div>

                        <div class="phase-details" id="phase5">
                            <h3 style="color: #b090c0; margin-bottom: 15px;">Phase 5: Post-Incident Activities</h3>
                            <p style="color: #a080b0; margin-bottom: 15px;">
                                Document lessons learned and improve defenses. Turn the incident into organizational resilience.
                            </p>
                            <ul style="color: #9a7aaa;">
                                <li>Conduct post-incident review meeting</li>
                                <li>Document timeline, actions taken, and outcomes</li>
                                <li>Update IR procedures based on lessons learned</li>
                                <li>Identify gaps in detection or response capabilities</li>
                                <li>Implement long-term security improvements</li>
                                <li>Consider legal, regulatory, and notification requirements</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">IR Team Roles</h3>

                <div class="two-col-grid">
                    <div class="info-card">
                        <h3>üéØ Core Roles</h3>
                        <ul>
                            <li><strong>Incident Commander:</strong> Leads response, makes decisions, coordinates communication</li>
                            <li><strong>Security Analyst:</strong> Triages alerts, analyzes IOCs, investigates threats</li>
                            <li><strong>Forensics Specialist:</strong> Preserves evidence, conducts deep analysis</li>
                            <li><strong>IT Operations:</strong> Implements containment, restores systems</li>
                        </ul>
                    </div>

                    <div class="info-card">
                        <h3>ü§ù Supporting Roles</h3>
                        <ul>
                            <li><strong>Legal Counsel:</strong> Advises on compliance and notification</li>
                            <li><strong>Public Relations:</strong> Manages external communication</li>
                            <li><strong>Executive Sponsor:</strong> Provides authority and resources</li>
                            <li><strong>External Partners:</strong> Law enforcement, threat intel, vendors</li>
                        </ul>
                    </div>
                </div>

                <div class="info-box">
                    <div class="info-box-title">üì° Communication Plans</div>
                    <div class="info-box-content">
                        <p><strong>Clear communication is critical during incidents:</strong></p>
                        <ul style="margin-top: 10px;">
                            <li><strong>Internal:</strong> Secure channels for IR team, regular status updates to stakeholders</li>
                            <li><strong>External:</strong> Customer notifications, regulatory reporting, law enforcement coordination</li>
                            <li><strong>Documentation:</strong> Incident logs, decision justifications, timeline tracking</li>
                            <li><strong>Escalation:</strong> Defined thresholds for executive notification and external help</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 2: Preparation Phase -->
        <section class="section" data-section="2">
            <div class="section-number">SECTION 02</div>
            <h2 class="section-title">
                <span class="section-icon">üõ°Ô∏è</span>
                Preparation Phase
            </h2>
            <div class="section-content">
                <p>
                    Preparation is the most important phase‚Äîit determines how well you'll respond when the incident hits.
                    Organizations that prepare thoroughly recover faster and with less damage.
                </p>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">IR Policy Development</h3>
                <p>Your IR policy should define:</p>
                <ul>
                    <li><strong>Scope:</strong> What constitutes an incident vs. routine security event</li>
                    <li><strong>Roles & responsibilities:</strong> Who does what during an incident</li>
                    <li><strong>Authority:</strong> Who can make critical decisions (isolate systems, shut down services)</li>
                    <li><strong>Escalation criteria:</strong> When to involve executives, law enforcement, external help</li>
                    <li><strong>Communication protocols:</strong> Internal notifications, customer disclosures, media handling</li>
                    <li><strong>Legal & compliance:</strong> Regulatory requirements, evidence preservation, breach notification laws</li>
                </ul>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Tool Readiness</h3>

                <div class="two-col-grid">
                    <div class="info-card">
                        <h3>üîß Detection Tools</h3>
                        <ul>
                            <li>SIEM (Splunk, ELK, Sentinel)</li>
                            <li>EDR (CrowdStrike, Carbon Black, Defender)</li>
                            <li>IDS/IPS (Snort, Suricata)</li>
                            <li>Network monitoring (Zeek, Wireshark)</li>
                            <li>Threat intelligence feeds</li>
                        </ul>
                    </div>

                    <div class="info-card">
                        <h3>üîç Analysis Tools</h3>
                        <ul>
                            <li>Forensics suite (EnCase, FTK, Autopsy)</li>
                            <li>Memory analysis (Volatility, Rekall)</li>
                            <li>Malware sandbox (Cuckoo, ANY.RUN)</li>
                            <li>Log parsers and correlation tools</li>
                            <li>Threat hunting platforms</li>
                        </ul>
                    </div>
                </div>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Runbook Creation</h3>
                <p>
                    Runbooks are step-by-step playbooks for common incident types. They ensure consistent,
                    rapid response even under pressure.
                </p>

                <div class="info-box">
                    <div class="info-box-title">üìñ Example Runbook Topics</div>
                    <div class="info-box-content">
                        <ul>
                            <li><strong>Ransomware:</strong> Isolate, identify scope, check backups, coordinate recovery</li>
                            <li><strong>Phishing:</strong> Quarantine emails, analyze payload, remediate compromised accounts</li>
                            <li><strong>Data breach:</strong> Determine data exposed, legal notification, evidence preservation</li>
                            <li><strong>DDoS:</strong> Traffic analysis, upstream filtering, service restoration</li>
                            <li><strong>Insider threat:</strong> Account lockdown, forensic collection, HR coordination</li>
                        </ul>
                    </div>
                </div>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Training and Exercises</h3>
                <p>
                    Regular practice keeps skills sharp and reveals gaps in your IR plan. Use multiple training methods:
                </p>
                <ul>
                    <li><strong>Tabletop exercises:</strong> Discussion-based scenarios to test decision-making</li>
                    <li><strong>Purple team exercises:</strong> Red team attacks while blue team defends and responds</li>
                    <li><strong>Breach simulations:</strong> Inject realistic attack indicators into production environment</li>
                    <li><strong>Knowledge reviews:</strong> Regular training on tools, procedures, and threat landscape</li>
                    <li><strong>Post-mortem drills:</strong> Practice the post-incident review process</li>
                </ul>
            </div>
        </section>

        <!-- Section 3: Detection & Analysis -->
        <section class="section" data-section="3">
            <div class="section-number">SECTION 03</div>
            <h2 class="section-title">
                <span class="section-icon">üîç</span>
                Detection & Analysis
            </h2>
            <div class="section-content">
                <p>
                    This is where incidents are identified and characterized. Speed matters‚Äîbut accuracy matters more.
                    A rushed, incorrect analysis wastes time and resources.
                </p>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Alert Triage</h3>
                <p>
                    Security teams face alert fatigue‚Äîthousands of alerts daily. Effective triage separates signal from noise.
                </p>

                <div class="visualization">
                    <div class="viz-header">
                        <div class="viz-title">Alert Triage Simulator</div>
                        <div class="viz-controls">
                            <button class="viz-btn" onclick="resetTriage()">Reset Alerts</button>
                        </div>
                    </div>
                    <div class="triage-container" id="triageContainer">
                        <!-- Alert cards populated by JavaScript -->
                    </div>
                </div>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">IOC Identification</h3>
                <p>Indicators of Compromise (IOCs) are forensic artifacts that suggest an intrusion:</p>

                <div class="two-col-grid">
                    <div class="info-card">
                        <h3>üî¥ Network-based IOCs</h3>
                        <ul>
                            <li>Suspicious IP addresses or domains</li>
                            <li>Unusual outbound connections</li>
                            <li>Large data transfers to unknown hosts</li>
                            <li>C2 beaconing patterns</li>
                            <li>DGA (Domain Generation Algorithm) activity</li>
                        </ul>
                    </div>

                    <div class="info-card">
                        <h3>üíæ Host-based IOCs</h3>
                        <ul>
                            <li>File hashes of known malware</li>
                            <li>Registry modifications (persistence keys)</li>
                            <li>Unusual processes or services</li>
                            <li>Suspicious scheduled tasks</li>
                            <li>Modified system files or binaries</li>
                        </ul>
                    </div>
                </div>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Scope Determination</h3>
                <p>Understanding the full extent of compromise is critical for effective response:</p>
                <ul>
                    <li><strong>Lateral movement:</strong> Did the attacker move to other systems?</li>
                    <li><strong>Data access:</strong> What sensitive data was viewed or exfiltrated?</li>
                    <li><strong>Privilege escalation:</strong> Did the attacker gain admin/domain admin access?</li>
                    <li><strong>Persistence mechanisms:</strong> How many backdoors were installed?</li>
                    <li><strong>Timeline:</strong> When did the breach start? How long were they in the environment?</li>
                </ul>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Timeline Construction</h3>
                <p>
                    Building an accurate timeline helps understand the attack progression and guides containment.
                    Correlate logs from multiple sources:
                </p>

                <div class="info-box">
                    <div class="info-box-title">üìÖ Key Timeline Events</div>
                    <div class="info-box-content">
                        <ol style="list-style-type: decimal; padding-left: 30px;">
                            <li><strong>Initial compromise:</strong> Phishing email clicked, exploit executed</li>
                            <li><strong>Foothold establishment:</strong> Malware installed, persistence achieved</li>
                            <li><strong>Reconnaissance:</strong> Attacker maps network, identifies targets</li>
                            <li><strong>Lateral movement:</strong> Spread to additional systems</li>
                            <li><strong>Privilege escalation:</strong> Gained higher-level access</li>
                            <li><strong>Objective completion:</strong> Data exfiltration, ransomware deployment, etc.</li>
                        </ol>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4: Containment Strategies -->
        <section class="section" data-section="4">
            <div class="section-number">SECTION 04</div>
            <h2 class="section-title">
                <span class="section-icon">‚õî</span>
                Containment Strategies
            </h2>
            <div class="section-content">
                <p>
                    Containment stops the bleeding. But containment decisions have trade-offs‚Äîshutting down
                    critical systems impacts business operations. Balance is key.
                </p>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Short-Term vs Long-Term Containment</h3>

                <div class="two-col-grid">
                    <div class="info-card">
                        <h3>‚ö° Short-Term Containment</h3>
                        <p style="font-size: 0.9rem; color: #8a6a9a; margin-bottom: 12px;">
                            Immediate actions to stop active attacks. May sacrifice availability for security.
                        </p>
                        <ul>
                            <li>Disconnect infected systems from network</li>
                            <li>Block malicious IPs at firewall</li>
                            <li>Disable compromised user accounts</li>
                            <li>Shutdown affected services temporarily</li>
                            <li>Isolate network segments</li>
                        </ul>
                    </div>

                    <div class="info-card">
                        <h3>üîí Long-Term Containment</h3>
                        <p style="font-size: 0.9rem; color: #8a6a9a; margin-bottom: 12px;">
                            Sustained measures while preparing for eradication. Maintains some business function.
                        </p>
                        <ul>
                            <li>Apply emergency patches</li>
                            <li>Implement temporary firewall rules</li>
                            <li>Force password resets</li>
                            <li>Deploy compensating controls</li>
                            <li>Increase monitoring on critical systems</li>
                        </ul>
                    </div>
                </div>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Network Isolation Methods</h3>
                <ul>
                    <li><strong>Physical disconnection:</strong> Pull network cable‚Äîmost effective but disruptive</li>
                    <li><strong>VLAN isolation:</strong> Move infected systems to quarantine VLAN</li>
                    <li><strong>Firewall rules:</strong> Block traffic to/from compromised hosts</li>
                    <li><strong>Endpoint containment:</strong> EDR tools can isolate hosts remotely</li>
                    <li><strong>DNS sinkholing:</strong> Redirect malware C2 traffic to controlled server</li>
                </ul>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Account Lockdown</h3>
                <p>Compromised credentials are often the attacker's most valuable asset:</p>
                <ul>
                    <li><strong>Disable compromised accounts:</strong> Immediately, across all systems</li>
                    <li><strong>Force password reset:</strong> For affected users and potentially all privileged accounts</li>
                    <li><strong>Revoke active sessions:</strong> Kill existing login sessions</li>
                    <li><strong>MFA enforcement:</strong> Require multi-factor authentication</li>
                    <li><strong>Token/certificate revocation:</strong> Invalidate API keys, SSH keys, certificates</li>
                </ul>

                <div class="visualization">
                    <div class="viz-header">
                        <div class="viz-title">Containment Decision Tree</div>
                        <div class="viz-controls">
                            <button class="viz-btn" onclick="resetDecisionTree()">Start Over</button>
                        </div>
                    </div>
                    <div class="decision-tree" id="decisionTree">
                        <!-- Decision nodes populated by JavaScript -->
                    </div>
                </div>

                <div class="info-box">
                    <div class="info-box-title">‚öñÔ∏è Containment Trade-offs</div>
                    <div class="info-box-content">
                        <p><strong>Every containment action has business impact. Consider:</strong></p>
                        <ul style="margin-top: 10px;">
                            <li><strong>Availability:</strong> Will containment disrupt critical operations?</li>
                            <li><strong>Evidence preservation:</strong> Will actions destroy forensic evidence?</li>
                            <li><strong>Attacker awareness:</strong> Will aggressive containment tip off the attacker?</li>
                            <li><strong>Coordination:</strong> Are all affected teams informed and ready?</li>
                            <li><strong>Legal considerations:</strong> Are there legal or regulatory constraints?</li>
                        </ul>
                        <p style="margin-top: 15px; color: #b090c0;">
                            Document all containment decisions and their justifications. In high-stakes incidents,
                            get executive approval before taking disruptive actions.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 5: Eradication & Recovery -->
        <section class="section" data-section="5">
            <div class="section-number">SECTION 05</div>
            <h2 class="section-title">
                <span class="section-icon">üîß</span>
                Eradication & Recovery
            </h2>
            <div class="section-content">
                <p>
                    Removing the attacker from your environment is only half the battle. You must verify
                    they're truly gone and restore operations without re-introducing the threat.
                </p>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Malware Removal</h3>
                <ul>
                    <li><strong>Identify all instances:</strong> Use IOCs to hunt for malware across entire environment</li>
                    <li><strong>Remove malicious files:</strong> Delete executables, scripts, and dropped files</li>
                    <li><strong>Clean registry:</strong> Remove persistence mechanisms and malicious keys</li>
                    <li><strong>Remove scheduled tasks:</strong> Delete attacker-created tasks and services</li>
                    <li><strong>Eliminate backdoors:</strong> Close unauthorized access points and remove implants</li>
                </ul>

                <div class="info-box">
                    <div class="info-box-title">‚ö†Ô∏è Rebuild vs. Clean</div>
                    <div class="info-box-content">
                        <p><strong>When should you rebuild vs. clean a compromised system?</strong></p>
                        <ul style="margin-top: 10px;">
                            <li><strong>Rebuild (recommended):</strong> Domain controllers, critical servers, systems with rootkits</li>
                            <li><strong>Clean (acceptable):</strong> Low-privilege workstations, systems with simple malware</li>
                        </ul>
                        <p style="margin-top: 15px; color: #b090c0;">
                            Rule of thumb: If the attacker had admin/SYSTEM access, rebuild from scratch.
                            You can never be 100% certain all backdoors are removed.
                        </p>
                    </div>
                </div>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">System Restoration</h3>

                <div class="two-col-grid">
                    <div class="info-card">
                        <h3>üì¶ From Backups</h3>
                        <ul>
                            <li>Verify backup integrity (not infected)</li>
                            <li>Use backups from before initial compromise</li>
                            <li>Test restore in isolated environment first</li>
                            <li>Scan restored data for malware</li>
                            <li>Document what was restored vs. rebuilt</li>
                        </ul>
                    </div>

                    <div class="info-card">
                        <h3>üèóÔ∏è Clean Rebuild</h3>
                        <ul>
                            <li>Reimage from known-good media</li>
                            <li>Apply all security patches before connecting</li>
                            <li>Implement hardening configurations</li>
                            <li>Install only necessary software</li>
                            <li>Change all passwords and keys</li>
                        </ul>
                    </div>
                </div>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Verification Steps</h3>
                <p>Before declaring victory, verify the threat is truly gone:</p>
                <ul>
                    <li><strong>IOC sweep:</strong> Re-scan environment for all known IOCs</li>
                    <li><strong>Behavioral monitoring:</strong> Watch for signs of attacker activity (beaconing, lateral movement)</li>
                    <li><strong>Log review:</strong> Check for suspicious authentication attempts or network connections</li>
                    <li><strong>Threat hunting:</strong> Proactively search for signs of persistence</li>
                    <li><strong>Endpoint validation:</strong> EDR tools confirm systems are clean</li>
                </ul>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Return to Operations</h3>
                <p>Phased restoration minimizes risk of re-infection:</p>
                <ol style="list-style-type: decimal; padding-left: 30px; color: #a080b0;">
                    <li style="margin-bottom: 10px;"><strong>Pilot systems:</strong> Restore a small subset, monitor closely</li>
                    <li style="margin-bottom: 10px;"><strong>Gradual rollout:</strong> Expand restoration in waves</li>
                    <li style="margin-bottom: 10px;"><strong>Enhanced monitoring:</strong> Increase alerting sensitivity during recovery</li>
                    <li style="margin-bottom: 10px;"><strong>User communication:</strong> Inform users of changes (password resets, new procedures)</li>
                    <li style="margin-bottom: 10px;"><strong>Validation period:</strong> Operate with heightened vigilance for 30+ days</li>
                </ol>

                <div class="info-box">
                    <div class="info-box-title">üîÑ Quick Recovery Checklist</div>
                    <div class="info-box-content">
                        <ul>
                            <li>‚úì All malware removed or systems rebuilt</li>
                            <li>‚úì All persistence mechanisms eliminated</li>
                            <li>‚úì All compromised credentials changed</li>
                            <li>‚úì Vulnerabilities patched or mitigated</li>
                            <li>‚úì Enhanced monitoring deployed</li>
                            <li>‚úì Backups verified and tested</li>
                            <li>‚úì Threat hunt completed with no findings</li>
                            <li>‚úì Stakeholders informed of status</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 6: Post-Incident Activities -->
        <section class="section" data-section="6">
            <div class="section-number">SECTION 06</div>
            <h2 class="section-title">
                <span class="section-icon">üìä</span>
                Post-Incident Activities
            </h2>
            <div class="section-content">
                <p>
                    The incident isn't over when systems are restored. This phase transforms the incident
                    from a crisis into an opportunity for organizational improvement.
                </p>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Lessons Learned</h3>
                <p>
                    Conduct a blameless post-mortem within 1-2 weeks of incident resolution.
                    Focus on improving processes, not punishing individuals.
                </p>

                <div class="info-box">
                    <div class="info-box-title">üéØ Post-Mortem Questions</div>
                    <div class="info-box-content">
                        <ul>
                            <li><strong>What happened?</strong> Factual timeline without speculation</li>
                            <li><strong>How was it detected?</strong> Did detection work as designed?</li>
                            <li><strong>What went well?</strong> Celebrate successes and effective procedures</li>
                            <li><strong>What could be improved?</strong> Gaps in tools, training, or processes</li>
                            <li><strong>What actions will we take?</strong> Concrete improvements with owners and deadlines</li>
                            <li><strong>Did we follow our IR plan?</strong> Where did reality differ from plan?</li>
                        </ul>
                    </div>
                </div>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Report Writing</h3>
                <p>Document the incident thoroughly for multiple audiences:</p>

                <div class="two-col-grid">
                    <div class="info-card">
                        <h3>üìÑ Technical Report</h3>
                        <p style="font-size: 0.9rem; color: #8a6a9a; margin-bottom: 12px;">
                            For IR team, IT, and security stakeholders
                        </p>
                        <ul>
                            <li>Detailed timeline with timestamps</li>
                            <li>IOCs and TTPs used by attacker</li>
                            <li>Systems affected and scope</li>
                            <li>Actions taken and tools used</li>
                            <li>Evidence collected and chain of custody</li>
                        </ul>
                    </div>

                    <div class="info-card">
                        <h3>üìä Executive Report</h3>
                        <p style="font-size: 0.9rem; color: #8a6a9a; margin-bottom: 12px;">
                            For leadership and board
                        </p>
                        <ul>
                            <li>Business impact (downtime, data loss, cost)</li>
                            <li>Root cause (how did breach happen?)</li>
                            <li>Response effectiveness</li>
                            <li>Recommended investments and improvements</li>
                            <li>Regulatory and legal implications</li>
                        </ul>
                    </div>
                </div>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Process Improvement</h3>
                <p>Turn lessons learned into actionable improvements:</p>
                <ul>
                    <li><strong>Update IR plan:</strong> Fix procedures that didn't work, add new runbooks</li>
                    <li><strong>Tool gaps:</strong> Deploy missing detection or response capabilities</li>
                    <li><strong>Training needs:</strong> Address skill gaps revealed during incident</li>
                    <li><strong>Architecture changes:</strong> Network segmentation, least privilege, etc.</li>
                    <li><strong>Policy updates:</strong> Adjust security policies based on new threats</li>
                </ul>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Legal Considerations</h3>

                <div class="info-box">
                    <div class="info-box-title">‚öñÔ∏è Legal and Regulatory Requirements</div>
                    <div class="info-box-content">
                        <p><strong>Many incidents trigger legal obligations:</strong></p>
                        <ul style="margin-top: 10px;">
                            <li><strong>Breach notification laws:</strong> GDPR, CCPA, HIPAA, state laws (timelines vary)</li>
                            <li><strong>Evidence preservation:</strong> Legal hold for potential litigation or prosecution</li>
                            <li><strong>Law enforcement:</strong> When to involve FBI, Secret Service, local authorities</li>
                            <li><strong>Insurance claims:</strong> Cyber insurance requires documentation and notification</li>
                            <li><strong>Regulatory reporting:</strong> SEC, banking regulators, industry-specific bodies</li>
                            <li><strong>Attorney-client privilege:</strong> Route sensitive communications through legal counsel</li>
                        </ul>
                        <p style="margin-top: 15px; color: #b090c0;">
                            Involve legal counsel early in the incident. They can guide disclosure decisions
                            and protect communications under attorney-client privilege.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 7: SIEM and Log Analysis -->
        <section class="section" data-section="7">
            <div class="section-number">SECTION 07</div>
            <h2 class="section-title">
                <span class="section-icon">üìà</span>
                SIEM and Log Analysis
            </h2>
            <div class="section-content">
                <p>
                    Security Information and Event Management (SIEM) platforms are the nervous system of IR.
                    They aggregate, correlate, and alert on security events across your entire environment.
                </p>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Common Log Sources</h3>

                <div class="two-col-grid">
                    <div class="info-card">
                        <h3>ü™ü Windows Event Logs</h3>
                        <ul>
                            <li><strong>4624:</strong> Successful logon</li>
                            <li><strong>4625:</strong> Failed logon attempt</li>
                            <li><strong>4688:</strong> Process creation</li>
                            <li><strong>4720:</strong> User account created</li>
                            <li><strong>4732:</strong> User added to security group</li>
                            <li><strong>7045:</strong> Service installed</li>
                        </ul>
                    </div>

                    <div class="info-card">
                        <h3>üêß Linux Syslog</h3>
                        <ul>
                            <li><strong>/var/log/auth.log:</strong> Authentication events</li>
                            <li><strong>/var/log/syslog:</strong> System messages</li>
                            <li><strong>/var/log/secure:</strong> Security and auth logs</li>
                            <li><strong>/var/log/messages:</strong> General system activity</li>
                            <li><strong>/var/log/audit/audit.log:</strong> SELinux audit trail</li>
                        </ul>
                    </div>
                </div>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Additional Critical Log Sources</h3>
                <ul>
                    <li><strong>Firewall logs:</strong> Network traffic allowed/blocked, connection attempts</li>
                    <li><strong>Proxy logs:</strong> Web traffic, downloads, C2 communication</li>
                    <li><strong>DNS logs:</strong> Domain lookups, potential DGA activity</li>
                    <li><strong>VPN logs:</strong> Remote access connections and authentication</li>
                    <li><strong>Cloud platform logs:</strong> AWS CloudTrail, Azure Activity Log, GCP Audit Logs</li>
                    <li><strong>Application logs:</strong> Web servers, databases, custom applications</li>
                </ul>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Correlation Rules</h3>
                <p>
                    SIEM correlation rules combine multiple events to detect complex attack patterns
                    that individual events wouldn't reveal.
                </p>

                <div class="info-box">
                    <div class="info-box-title">üîó Example Correlation Rules</div>
                    <div class="info-box-content">
                        <ul>
                            <li><strong>Brute force:</strong> 5+ failed logins followed by successful login from same IP within 10 minutes</li>
                            <li><strong>Lateral movement:</strong> Account authenticates to 10+ systems in 5 minutes</li>
                            <li><strong>Data exfiltration:</strong> Large outbound transfer (>1GB) to unusual destination</li>
                            <li><strong>Privilege escalation:</strong> Service account logs in interactively (should only be service logins)</li>
                            <li><strong>Impossible travel:</strong> User logs in from two geographic locations within impossible timeframe</li>
                        </ul>
                    </div>
                </div>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Hunting Queries</h3>
                <p>
                    Proactive threat hunting uses queries to find threats that automated detections miss.
                    Hunt for TTPs (Tactics, Techniques, and Procedures) rather than specific IOCs.
                </p>

                <div class="visualization">
                    <div class="viz-header">
                        <div class="viz-title">Log Analysis Challenge</div>
                        <div class="viz-controls">
                            <button class="viz-btn" onclick="generateLogs()">Generate New Logs</button>
                        </div>
                    </div>
                    <div class="log-viewer" id="logViewer">
                        <!-- Log entries populated by JavaScript -->
                    </div>
                    <div class="triage-feedback" id="logFeedback">
                        <div style="color: #b090c0; font-size: 0.9rem;">
                            Click on log entries that look suspicious or malicious. Look for patterns like
                            failed authentication followed by success, unusual process names, or suspicious network connections.
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 8: Tabletop Exercise -->
        <section class="section" data-section="8">
            <div class="section-number">SECTION 08</div>
            <h2 class="section-title">
                <span class="section-icon">üéÆ</span>
                Tabletop Exercise: Ransomware Incident
            </h2>
            <div class="section-content">
                <p>
                    Put your IR skills to the test. You're the incident commander responding to a ransomware attack.
                    Each decision affects the outcome. Choose wisely.
                </p>

                <div class="tabletop-container">
                    <div id="exerciseContainer">
                        <!-- Exercise scenarios populated by JavaScript -->
                    </div>

                    <div class="exercise-score" id="exerciseScore" style="display: none;">
                        <div class="score-display">
                            Your Score: <span id="scoreValue">0</span>/100
                        </div>
                        <div style="color: #a080b0; margin-top: 10px;">
                            <span id="scoreMessage"></span>
                        </div>
                        <button class="viz-btn" onclick="restartExercise()" style="margin-top: 20px;">
                            Restart Exercise
                        </button>
                        <button class="viz-btn" onclick="generateCertificate()" style="margin-top: 20px;">
                            Generate Certificate
                        </button>
                    </div>
                </div>

                <div class="info-box" style="margin-top: 30px;">
                    <div class="info-box-title">üéØ Exercise Scoring</div>
                    <div class="info-box-content">
                        <ul>
                            <li><strong>Excellent (90-100):</strong> Textbook IR execution, minimal business impact</li>
                            <li><strong>Good (75-89):</strong> Effective response with minor missteps</li>
                            <li><strong>Fair (60-74):</strong> Incident contained but with significant impact</li>
                            <li><strong>Needs Improvement (<60):</strong> Review IR procedures and try again</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Completion Section -->
        <section class="completion-section">
            <div class="completion-icon">üéì</div>
            <h2 class="completion-title">Module Complete</h2>
            <p class="completion-text">
                You've mastered the art of incident response. From preparation through post-mortem,
                you can now lead your organization through the chaos of a cyber incident with confidence,
                precision, and the systematic approach that separates panic from professional response.
            </p>
            <a href="../index.html" class="completion-btn" onclick="markModuleComplete()">
                <span>Return to Vault</span>
                <span>‚úì</span>
            </a>
        </section>
    </main>

    <!-- Certificate Modal -->
    <div class="certificate-container" id="certificateModal">
        <div class="certificate-title">üèÜ Incident Response Certificate</div>
        <div class="certificate-text">
            <p>You have successfully completed the Incident Response tabletop exercise
            and demonstrated proficiency in the NIST IR framework.</p>
            <p style="margin-top: 15px;">Your performance has been recorded to localStorage.</p>
            <p style="margin-top: 15px; color: #c0a0d0; font-weight: bold;">
                Score: <span id="certScore">0</span>/100
            </p>
        </div>
        <button class="certificate-close" onclick="closeCertificate()">Close</button>
    </div>

    <script>
        // ============================================
        // SCROLL ANIMATION
        // ============================================
        function initScrollAnimation() {
            const sections = document.querySelectorAll('.section');
            const observerOptions = {
                threshold: 0.15,
                rootMargin: '0px 0px -100px 0px'
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        updateProgress();
                    }
                });
            }, observerOptions);

            sections.forEach(section => observer.observe(section));
        }

        // ============================================
        // PROGRESS TRACKING
        // ============================================
        function updateProgress() {
            const sections = document.querySelectorAll('.section');
            const visibleSections = document.querySelectorAll('.section.visible');
            const progress = (visibleSections.length / sections.length) * 100;

            const progressFill = document.getElementById('progressFill');
            if (progressFill) {
                progressFill.style.width = progress + '%';
            }
        }

        // ============================================
        // IR TIMELINE PHASES
        // ============================================
        function showPhase(phaseNum) {
            // Update active phase circle
            document.querySelectorAll('.timeline-phase').forEach((phase, index) => {
                if (index + 1 === phaseNum) {
                    phase.classList.add('active');
                } else {
                    phase.classList.remove('active');
                }
            });

            // Show corresponding phase details
            document.querySelectorAll('.phase-details').forEach((details, index) => {
                if (index + 1 === phaseNum) {
                    details.classList.add('active');
                } else {
                    details.classList.remove('active');
                }
            });
        }

        // ============================================
        // ALERT TRIAGE SIMULATOR
        // ============================================
        const alerts = [
            {
                severity: 'critical',
                title: 'Ransomware Encryption Detected',
                details: 'Multiple files with .encrypted extension created on FILE-SRV-01. CryptoLocker behavior detected.',
                correct: true,
                feedback: 'CRITICAL - Immediate action required. Isolate affected system, identify patient zero, check backups.'
            },
            {
                severity: 'high',
                title: 'Lateral Movement via PsExec',
                details: 'Admin account used PsExec to access 15 workstations in 2 minutes from WORKSTATION-42.',
                correct: true,
                feedback: 'HIGH - Likely attacker lateral movement. Investigate admin account compromise, contain spread.'
            },
            {
                severity: 'medium',
                title: 'Failed Login Attempts',
                details: '8 failed login attempts for user jdoe from IP 203.0.113.45 over 30 minutes.',
                correct: false,
                feedback: 'MEDIUM - Possible brute force but below critical threshold. Monitor and alert if exceeds 20 attempts.'
            },
            {
                severity: 'low',
                title: 'Antivirus Update Failed',
                details: 'Workstation DESK-12 failed to download latest virus definitions.',
                correct: false,
                feedback: 'LOW - Routine issue. Create IT ticket, but not an active threat indicator.'
            },
            {
                severity: 'critical',
                title: 'C2 Beaconing Detected',
                details: 'Endpoint EDR detected periodic HTTPS connections to known Cobalt Strike C2 domain from SALES-PC-08.',
                correct: true,
                feedback: 'CRITICAL - Active C2 communication indicates compromised system. Isolate immediately, begin forensics.'
            },
            {
                severity: 'medium',
                title: 'USB Device Connected',
                details: 'Unknown USB device connected to secure workstation. Device blocked by policy.',
                correct: false,
                feedback: 'MEDIUM - Policy working as designed. Investigate user intent, no immediate threat.'
            }
        ];

        function populateTriage() {
            const container = document.getElementById('triageContainer');
            container.innerHTML = '';

            alerts.forEach((alert, index) => {
                const card = document.createElement('div');
                card.className = `alert-card ${alert.severity}`;
                card.innerHTML = `
                    <div class="alert-header">
                        <span class="alert-severity ${alert.severity}">${alert.severity.toUpperCase()}</span>
                        <span style="font-size: 0.7rem; color: #6a4a7a;">Alert #${index + 1}</span>
                    </div>
                    <div class="alert-title">${alert.title}</div>
                    <div class="alert-details">${alert.details}</div>
                    <div class="triage-feedback" id="alert-feedback-${index}">
                        <div style="color: #b090c0; font-size: 0.85rem;">${alert.feedback}</div>
                    </div>
                `;
                card.onclick = () => triageAlert(index, alert.correct);
                container.appendChild(card);
            });
        }

        function triageAlert(index, isCorrect) {
            const feedback = document.getElementById(`alert-feedback-${index}`);
            feedback.classList.add('show');
        }

        function resetTriage() {
            document.querySelectorAll('.triage-feedback').forEach(fb => fb.classList.remove('show'));
        }

        // ============================================
        // CONTAINMENT DECISION TREE
        // ============================================
        const decisionTree = {
            start: {
                question: 'You detect ransomware encrypting files on a file server. What is your FIRST action?',
                options: [
                    { text: 'Immediately power off the server', next: 'poweroff', points: 5 },
                    { text: 'Disconnect server from network (physical or VLAN)', next: 'isolate', points: 10 },
                    { text: 'Run antivirus scan', next: 'scan', points: 0 },
                    { text: 'Alert all users via email', next: 'email', points: 2 }
                ]
            },
            isolate: {
                question: 'Good! Server isolated. Ransomware contained. What next?',
                options: [
                    { text: 'Check if backups are available and clean', next: 'backups', points: 10 },
                    { text: 'Try to decrypt the files immediately', next: 'decrypt', points: 3 },
                    { text: 'Pay the ransom to get files back quickly', next: 'ransom', points: 0 },
                    { text: 'Investigate how ransomware entered the network', next: 'investigate', points: 8 }
                ]
            },
            backups: {
                question: 'Excellent! Backups are clean and from yesterday. How do you proceed?',
                options: [
                    { text: 'Immediately restore from backups to production server', next: 'restore-fast', points: 3 },
                    { text: 'Build new server, apply patches, then restore data', next: 'restore-proper', points: 10 },
                    { text: 'Restore to test environment first to verify', next: 'restore-test', points: 8 },
                    { text: 'Wait a week to make sure ransomware is gone', next: 'wait', points: 0 }
                ]
            },
            'restore-proper': {
                question: 'Perfect response! You\'ve rebuilt securely. Final step?',
                options: [
                    { text: 'Return to normal operations immediately', next: 'end-good', points: 5 },
                    { text: 'Monitor closely for re-infection for 30 days', next: 'end-excellent', points: 10 },
                    { text: 'Run a full network security audit', next: 'end-excellent', points: 10 }
                ],
                final: true
            },
            poweroff: {
                question: 'Powering off may corrupt volatile memory evidence, but stops encryption. What now?',
                options: [
                    { text: 'Power back on and disconnect network', next: 'isolate', points: 5 },
                    { text: 'Leave it off and check backups', next: 'backups', points: 7 }
                ]
            },
            scan: {
                question: 'Scan takes too long. Ransomware continues encrypting. Recovery will be harder.',
                options: [
                    { text: 'Stop scan and isolate server immediately', next: 'isolate', points: 5 }
                ]
            },
            email: {
                question: 'Email may tip off attacker if they have email access. Isolation first is better.',
                options: [
                    { text: 'Isolate server now', next: 'isolate', points: 8 }
                ]
            },
            decrypt: {
                question: 'Decryption without ransomware family identification rarely works. Check backups first.',
                options: [
                    { text: 'Check backups instead', next: 'backups', points: 7 }
                ]
            },
            ransom: {
                question: 'Paying ransom funds criminals and doesn\'t guarantee file recovery. Never pay without exhausting all options.',
                options: [
                    { text: 'Check if backups are available instead', next: 'backups', points: 5 }
                ]
            },
            investigate: {
                question: 'Good thinking, but contain the threat first. Investigation comes after containment.',
                options: [
                    { text: 'Check backups first, investigate later', next: 'backups', points: 8 }
                ]
            },
            'restore-fast': {
                question: 'Restoring to the same vulnerable server may result in re-infection.',
                options: [
                    { text: 'Rebuild server first, then restore', next: 'restore-proper', points: 7 }
                ]
            },
            'restore-test': {
                question: 'Smart! Testing first prevents spreading potential remnants. After successful test?',
                options: [
                    { text: 'Restore to newly built production server', next: 'restore-proper', points: 10 }
                ]
            },
            wait: {
                question: 'Waiting a week causes unnecessary downtime. Proper rebuild and monitoring is better.',
                options: [
                    { text: 'Rebuild properly instead', next: 'restore-proper', points: 5 }
                ]
            },
            'end-good': {
                question: 'Incident resolved! Score: 70/100. Good response with room for improvement.',
                options: [],
                final: true,
                score: 70
            },
            'end-excellent': {
                question: 'Outstanding! Textbook IR execution. Score: 95/100. You\'re ready to lead incident response.',
                options: [],
                final: true,
                score: 95
            }
        };

        let currentDecisionNode = 'start';
        let decisionScore = 0;

        function populateDecisionTree() {
            const container = document.getElementById('decisionTree');
            const node = decisionTree[currentDecisionNode];

            if (!node) return;

            let html = `
                <div class="decision-node active">
                    <div class="decision-question">${node.question}</div>
            `;

            if (node.options && node.options.length > 0) {
                html += '<div class="decision-options">';
                node.options.forEach((option, index) => {
                    html += `
                        <div class="decision-option" onclick="selectDecision('${option.next}', ${option.points})">
                            ${option.text}
                        </div>
                    `;
                });
                html += '</div>';
            }

            if (node.final) {
                html += `
                    <div style="margin-top: 20px; padding: 15px; background: rgba(60, 100, 60, 0.2); border-radius: 6px; color: #7aaa7a; text-align: center;">
                        Final Score: ${decisionScore}/100
                    </div>
                `;
            }

            html += '</div>';
            container.innerHTML = html;
        }

        function selectDecision(nextNode, points) {
            decisionScore += points;
            currentDecisionNode = nextNode;
            populateDecisionTree();
        }

        function resetDecisionTree() {
            currentDecisionNode = 'start';
            decisionScore = 0;
            populateDecisionTree();
        }

        // ============================================
        // LOG ANALYSIS CHALLENGE
        // ============================================
        const logEntries = [
            { type: 'normal', text: '2024-01-15 08:15:23 | AUTH | User alice logged in from 192.168.1.45' },
            { type: 'normal', text: '2024-01-15 08:16:12 | FILE | Document.docx opened by alice' },
            { type: 'suspicious', text: '2024-01-15 09:22:41 | AUTH | Failed login for admin from 203.0.113.78' },
            { type: 'suspicious', text: '2024-01-15 09:22:45 | AUTH | Failed login for admin from 203.0.113.78' },
            { type: 'suspicious', text: '2024-01-15 09:22:49 | AUTH | Failed login for admin from 203.0.113.78' },
            { type: 'malicious', text: '2024-01-15 09:23:01 | AUTH | Successful login for admin from 203.0.113.78' },
            { type: 'normal', text: '2024-01-15 09:30:15 | NETWORK | DNS query: www.google.com' },
            { type: 'malicious', text: '2024-01-15 09:35:44 | PROCESS | powershell.exe -encodedCommand SGVsbG8=' },
            { type: 'normal', text: '2024-01-15 09:40:11 | FILE | Report.xlsx saved by bob' },
            { type: 'suspicious', text: '2024-01-15 09:45:22 | NETWORK | Large outbound transfer (1.2GB) to 185.220.101.34' },
            { type: 'malicious', text: '2024-01-15 09:50:33 | REGISTRY | New Run key: HKCU\\...\\Run\\WindowsUpdate = C:\\Users\\admin\\AppData\\malware.exe' },
            { type: 'normal', text: '2024-01-15 10:00:00 | SYSTEM | Daily backup completed successfully' }
        ];

        function generateLogs() {
            const viewer = document.getElementById('logViewer');
            viewer.innerHTML = '';

            logEntries.forEach((entry, index) => {
                const div = document.createElement('div');
                div.className = `log-entry ${entry.type}`;
                div.innerHTML = `
                    <span class="log-timestamp">${entry.text.split('|')[0]}</span> |
                    <span class="log-source">${entry.text.split('|')[1]}</span> |
                    <span class="log-message">${entry.text.split('|')[2]}</span>
                `;
                div.onclick = () => {
                    if (entry.type === 'malicious') {
                        alert('‚úì Correct! This is a clear IOC of malicious activity.');
                    } else if (entry.type === 'suspicious') {
                        alert('‚ö†Ô∏è Good catch! This is suspicious and warrants investigation.');
                    } else {
                        alert('‚úó This appears to be normal activity.');
                    }
                };
                viewer.appendChild(div);
            });

            document.getElementById('logFeedback').classList.add('show');
        }

        // ============================================
        // TABLETOP EXERCISE
        // ============================================
        const exerciseScenarios = [
            {
                time: 'DAY 1 - 08:30 AM',
                text: 'Your SOC analyst alerts you: "We\'re seeing EDR alerts for file encryption on multiple workstations. Looks like ransomware." Users are calling the helpdesk about files they can\'t open. What do you do FIRST?',
                actions: [
                    { text: 'Activate the incident response team', points: 20, feedback: 'Correct! IR team activation is priority #1.' },
                    { text: 'Shut down the entire network', points: 5, feedback: 'Too extreme. Targeted isolation is better.' },
                    { text: 'Send company-wide email warning', points: 10, feedback: 'Good intent but premature. Contain first.' },
                    { text: 'Start investigating patient zero', points: 8, feedback: 'Important but second to team activation.' }
                ]
            },
            {
                time: 'DAY 1 - 09:00 AM',
                text: 'IR team assembled. SOC identifies 8 infected workstations. Ransomware is spreading via network shares. Immediate containment action?',
                actions: [
                    { text: 'Isolate infected workstations from network', points: 20, feedback: 'Excellent! Stop the spread immediately.' },
                    { text: 'Disable all network shares globally', points: 15, feedback: 'Effective but impacts business. Targeted isolation is better.' },
                    { text: 'Run antivirus on all systems', points: 5, feedback: 'Too slow. Active ransomware needs immediate isolation.' },
                    { text: 'Call law enforcement', points: 8, feedback: 'May be needed but containment comes first.' }
                ]
            },
            {
                time: 'DAY 1 - 11:00 AM',
                text: 'Ransomware contained to 8 workstations. Forensics reveals initial infection was phishing email 3 days ago. Attacker had domain admin credentials. What now?',
                actions: [
                    { text: 'Force password reset for all domain admin accounts', points: 20, feedback: 'Critical! Revoke attacker\'s access immediately.' },
                    { text: 'Review all domain admin activity for past 3 days', points: 15, feedback: 'Important but credentials must be changed first.' },
                    { text: 'Identify and quarantine the phishing email', points: 10, feedback: 'Good but horse has left the barn. Focus on active threat.' },
                    { text: 'Restore the 8 workstations from backup', points: 5, feedback: 'Not yet‚Äîattacker may still have access with stolen credentials.' }
                ]
            },
            {
                time: 'DAY 1 - 02:00 PM',
                text: 'Credentials reset. Threat hunt reveals attacker also installed backdoor on file server. Server has critical business data. Action?',
                actions: [
                    { text: 'Isolate server and begin forensic imaging', points: 20, feedback: 'Perfect! Preserve evidence and prevent further compromise.' },
                    { text: 'Immediately wipe and rebuild server', points: 10, feedback: 'Rushing may destroy evidence. Image first.' },
                    { text: 'Leave server running to monitor attacker', points: 5, feedback: 'Too risky with critical data. Isolate first.' },
                    { text: 'Restore server from last week\'s backup', points: 8, feedback: 'Not yet. Need to understand scope and remove backdoor first.' }
                ]
            },
            {
                time: 'DAY 2 - 10:00 AM',
                text: 'Forensics complete. All systems cleaned or rebuilt. Backups restored. Before declaring "all clear", what\'s your final check?',
                actions: [
                    { text: 'Conduct threat hunt for additional persistence', points: 20, feedback: 'Excellent! Verify attacker is truly gone.' },
                    { text: 'Return all systems to production immediately', points: 5, feedback: 'Rushing risks re-infection. Hunt first.' },
                    { text: 'Schedule post-incident review next week', points: 10, feedback: 'Needed but not the final verification step.' },
                    { text: 'Scan all systems with antivirus', points: 12, feedback: 'Good baseline but threat hunting is more thorough.' }
                ]
            }
        ];

        let currentScenario = 0;
        let exerciseScore = 0;

        function populateExercise() {
            const container = document.getElementById('exerciseContainer');
            const scenario = exerciseScenarios[currentScenario];

            if (!scenario) {
                // Exercise complete
                showExerciseResults();
                return;
            }

            let html = `
                <div class="scenario-card">
                    <div class="scenario-time">${scenario.time}</div>
                    <div class="scenario-text">${scenario.text}</div>
                    <div class="action-buttons">
            `;

            scenario.actions.forEach((action, index) => {
                html += `
                    <div class="action-btn" onclick="selectAction(${index})">
                        ${action.text}
                    </div>
                `;
            });

            html += `
                    </div>
                </div>
            `;

            container.innerHTML = html;
        }

        function selectAction(actionIndex) {
            const scenario = exerciseScenarios[currentScenario];
            const action = scenario.actions[actionIndex];

            exerciseScore += action.points;

            // Show feedback
            alert(`${action.feedback}\n\nPoints earned: ${action.points}/20`);

            // Move to next scenario
            currentScenario++;
            populateExercise();
        }

        function showExerciseResults() {
            document.getElementById('exerciseContainer').style.display = 'none';
            document.getElementById('exerciseScore').style.display = 'block';
            document.getElementById('scoreValue').textContent = exerciseScore;

            let message = '';
            if (exerciseScore >= 90) {
                message = 'üèÜ Outstanding! You demonstrated expert-level incident response skills.';
            } else if (exerciseScore >= 75) {
                message = '‚úÖ Good job! Solid IR performance with minor room for improvement.';
            } else if (exerciseScore >= 60) {
                message = '‚ö†Ô∏è Fair response. Review the NIST IR framework and try again.';
            } else {
                message = '‚ùå Needs improvement. Study incident response procedures and retry.';
            }

            document.getElementById('scoreMessage').textContent = message;

            // Save score to localStorage
            localStorage.setItem('ir_tabletop_score', exerciseScore);
            localStorage.setItem('ir_tabletop_complete', 'true');
        }

        function restartExercise() {
            currentScenario = 0;
            exerciseScore = 0;
            document.getElementById('exerciseScore').style.display = 'none';
            document.getElementById('exerciseContainer').style.display = 'block';
            populateExercise();
        }

        function generateCertificate() {
            const score = localStorage.getItem('ir_tabletop_score') || exerciseScore;
            document.getElementById('certScore').textContent = score;
            document.getElementById('certificateModal').classList.add('show');
        }

        function closeCertificate() {
            document.getElementById('certificateModal').classList.remove('show');
        }

        // ============================================
        // MODULE COMPLETION
        // ============================================
        function markModuleComplete() {
            const completedModules = JSON.parse(localStorage.getItem('vault_modules_complete') || '[]');
            if (!completedModules.includes('incident-response')) {
                completedModules.push('incident-response');
                localStorage.setItem('vault_modules_complete', JSON.stringify(completedModules));
                console.log('%c‚úì Incident Response Module Complete', 'color: #7aaa7a; font-size: 14px;');
            }
        }

        // ============================================
        // INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', () => {
            initScrollAnimation();
            populateTriage();
            populateDecisionTree();
            generateLogs();
            populateExercise();

            // Console easter egg
            console.log('%cüö® Incident Response', 'color: #c0a0d0; font-size: 16px; font-weight: bold;');
            console.log('%cWhen chaos strikes, become the calm.', 'color: #8a6a9a; font-size: 12px;');
        });
    </script>
<script src="../../../components/FluxCapacitor.js"></script>
</body>
</html>
