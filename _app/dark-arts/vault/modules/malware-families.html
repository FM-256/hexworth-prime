<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Access Control -->
    <script src="../../../components/AccessGuard.js"></script>
    <script>
        AccessGuard.require('dark-arts');
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malware Families - The Dark Arts</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: #0a0508;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #c0a0d0;
            line-height: 1.7;
        }

        /* Header */
        .module-header {
            background: linear-gradient(180deg, rgba(60, 30, 80, 0.3) 0%, transparent 100%);
            border-bottom: 1px solid rgba(100, 60, 130, 0.2);
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .back-btn {
            background: rgba(80, 40, 100, 0.2);
            border: 1px solid rgba(100, 60, 130, 0.3);
            color: #9a7aaa;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(100, 60, 130, 0.3);
        }

        .module-title {
            font-size: 1.1rem;
            color: #b090c0;
            letter-spacing: 0.1em;
        }

        .progress-bar {
            width: 200px;
            height: 6px;
            background: rgba(60, 30, 80, 0.3);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6a4a8a, #9a6aba);
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Main content */
        .module-content {
            max-width: 1100px;
            margin: 0 auto;
            padding: 40px;
        }

        /* Intro */
        .intro-section {
            text-align: center;
            padding: 40px 0 60px;
            border-bottom: 1px solid rgba(80, 50, 100, 0.2);
            margin-bottom: 60px;
        }

        .intro-icon {
            font-size: 3rem;
            margin-bottom: 20px;
        }

        .intro-title {
            font-size: 2rem;
            color: #c0a0d0;
            margin-bottom: 15px;
            font-weight: 300;
        }

        .intro-text {
            color: #9080a0;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Timeline */
        .timeline {
            position: relative;
            padding-left: 40px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(180deg, #6a4a8a, #4a2a5a);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 60px;
            opacity: 0;
            transform: translateX(-20px);
            transition: all 0.5s ease;
        }

        .timeline-item.visible {
            opacity: 1;
            transform: translateX(0);
        }

        .timeline-dot {
            position: absolute;
            left: -33px;
            top: 5px;
            width: 12px;
            height: 12px;
            background: #6a4a8a;
            border-radius: 50%;
            border: 2px solid #0a0508;
            box-shadow: 0 0 10px rgba(100, 60, 130, 0.5);
        }

        .timeline-year {
            font-size: 0.75rem;
            color: #7a5a8a;
            letter-spacing: 0.2em;
            margin-bottom: 10px;
        }

        /* Malware cards */
        .malware-card {
            background: rgba(20, 10, 30, 0.6);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .malware-card:hover {
            border-color: rgba(120, 80, 150, 0.5);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .malware-header {
            padding: 25px 30px;
            background: linear-gradient(135deg, rgba(60, 30, 80, 0.4), rgba(40, 20, 60, 0.3));
            border-bottom: 1px solid rgba(80, 50, 100, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .malware-name {
            font-size: 1.5rem;
            color: #c0a0d0;
            margin-bottom: 5px;
        }

        .malware-type {
            font-size: 0.75rem;
            color: #8a6a9a;
            letter-spacing: 0.1em;
        }

        .malware-severity {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }

        .severity-label {
            font-size: 0.65rem;
            color: #7a5a8a;
            letter-spacing: 0.15em;
            margin-bottom: 5px;
        }

        .severity-dots {
            display: flex;
            gap: 4px;
        }

        .severity-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(80, 50, 100, 0.3);
        }

        .severity-dot.active {
            background: #c06060;
            box-shadow: 0 0 8px rgba(200, 100, 100, 0.5);
        }

        .malware-body {
            padding: 30px;
        }

        .malware-description {
            color: #a090b0;
            margin-bottom: 25px;
            font-size: 0.95rem;
        }

        /* Stats grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-box {
            background: rgba(40, 20, 60, 0.4);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.3rem;
            color: #c0a0d0;
            font-weight: 300;
        }

        .stat-label {
            font-size: 0.7rem;
            color: #7a5a8a;
            letter-spacing: 0.1em;
            margin-top: 5px;
        }

        /* Techniques */
        .techniques-section {
            margin-bottom: 25px;
        }

        .section-label {
            font-size: 0.7rem;
            color: #7a5a8a;
            letter-spacing: 0.2em;
            margin-bottom: 12px;
        }

        .technique-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .technique-tag {
            padding: 6px 14px;
            background: rgba(60, 30, 80, 0.4);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 20px;
            font-size: 0.8rem;
            color: #a090b0;
            transition: all 0.3s ease;
            cursor: help;
        }

        .technique-tag:hover {
            background: rgba(80, 40, 100, 0.5);
            border-color: rgba(120, 80, 150, 0.5);
        }

        .technique-tag.persistence { border-left: 3px solid #9a6a6a; }
        .technique-tag.evasion { border-left: 3px solid #6a6a9a; }
        .technique-tag.exfil { border-left: 3px solid #6a9a6a; }
        .technique-tag.lateral { border-left: 3px solid #9a9a6a; }
        .technique-tag.impact { border-left: 3px solid #9a6a9a; }

        /* IOCs */
        .ioc-section {
            background: rgba(15, 8, 20, 0.5);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .ioc-list {
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
        }

        .ioc-item {
            padding: 8px 12px;
            background: rgba(30, 15, 40, 0.5);
            border-radius: 4px;
            margin-bottom: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ioc-value {
            color: #a090b0;
        }

        .ioc-type {
            font-size: 0.65rem;
            padding: 2px 8px;
            border-radius: 10px;
            background: rgba(60, 30, 80, 0.4);
            color: #8a6a9a;
        }

        /* Kill chain diagram */
        .killchain-section {
            margin-bottom: 25px;
        }

        .killchain {
            display: flex;
            gap: 5px;
            overflow-x: auto;
            padding: 10px 0;
        }

        .kc-step {
            flex: 1;
            min-width: 120px;
            background: rgba(40, 20, 60, 0.4);
            border-radius: 6px;
            padding: 15px 10px;
            text-align: center;
            position: relative;
            transition: all 0.3s ease;
        }

        .kc-step:not(:last-child)::after {
            content: 'â†’';
            position: absolute;
            right: -12px;
            top: 50%;
            transform: translateY(-50%);
            color: #5a3a6a;
            font-size: 1.2rem;
        }

        .kc-step:hover {
            background: rgba(60, 30, 80, 0.5);
            transform: translateY(-3px);
        }

        .kc-number {
            font-size: 0.65rem;
            color: #6a4a7a;
            margin-bottom: 5px;
        }

        .kc-name {
            font-size: 0.8rem;
            color: #b090c0;
            margin-bottom: 5px;
        }

        .kc-desc {
            font-size: 0.7rem;
            color: #7a6a8a;
        }

        /* Lessons learned */
        .lessons-section {
            background: rgba(40, 60, 40, 0.15);
            border: 1px solid rgba(60, 100, 60, 0.2);
            border-radius: 8px;
            padding: 20px;
        }

        .lesson-item {
            display: flex;
            gap: 12px;
            margin-bottom: 12px;
            color: #90b090;
            font-size: 0.9rem;
        }

        .lesson-item:last-child {
            margin-bottom: 0;
        }

        .lesson-icon {
            color: #6a9a6a;
        }

        /* Case study selector */
        .case-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .case-btn {
            padding: 12px 24px;
            background: rgba(40, 20, 60, 0.4);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 6px;
            color: #9a7aaa;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .case-btn:hover {
            background: rgba(60, 30, 80, 0.5);
            border-color: rgba(100, 60, 130, 0.5);
        }

        .case-btn.active {
            background: linear-gradient(135deg, rgba(80, 40, 100, 0.5), rgba(100, 60, 130, 0.4));
            border-color: rgba(120, 80, 150, 0.6);
            color: #c0a0d0;
        }

        /* Comparison table */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
            font-size: 0.85rem;
        }

        .comparison-table th {
            background: rgba(60, 30, 80, 0.3);
            padding: 15px;
            text-align: left;
            color: #b090c0;
            font-weight: normal;
            letter-spacing: 0.1em;
            border-bottom: 1px solid rgba(80, 50, 100, 0.3);
        }

        .comparison-table td {
            padding: 15px;
            border-bottom: 1px solid rgba(60, 30, 80, 0.2);
            color: #a090b0;
        }

        .comparison-table tr:hover td {
            background: rgba(40, 20, 60, 0.2);
        }

        /* Navigation */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 60px;
            padding-top: 30px;
            border-top: 1px solid rgba(80, 50, 100, 0.2);
        }

        .nav-btn {
            padding: 15px 30px;
            background: rgba(60, 30, 80, 0.3);
            border: 1px solid rgba(100, 60, 130, 0.3);
            color: #9a7aaa;
            font-size: 0.9rem;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .nav-btn:hover {
            background: rgba(80, 40, 100, 0.4);
            border-color: rgba(120, 80, 150, 0.5);
            color: #c0a0d0;
        }

        .nav-btn.primary {
            background: linear-gradient(135deg, rgba(80, 40, 100, 0.5), rgba(100, 60, 130, 0.4));
        }

        /* Callout */
        .callout {
            padding: 20px;
            border-radius: 6px;
            margin: 20px 0;
        }

        .callout.warning {
            background: rgba(100, 80, 40, 0.2);
            border-left: 4px solid #c0a060;
            color: #d0c090;
        }

        .callout.info {
            background: rgba(40, 60, 100, 0.2);
            border-left: 4px solid #6090c0;
            color: #90b0d0;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(20, 10, 30, 0.5);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(80, 50, 100, 0.5);
            border-radius: 4px;
        }

        /* Completion */
        .completion-section {
            text-align: center;
            padding: 60px 40px;
            background: linear-gradient(180deg, transparent, rgba(60, 30, 80, 0.1));
            border-radius: 8px;
            margin-top: 60px;
        }

        .completion-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .completion-title {
            font-size: 1.8rem;
            color: #c0a0d0;
            margin-bottom: 15px;
        }

        .completion-text {
            color: #9080a0;
            margin-bottom: 30px;
        }

        .completion-btn {
            display: inline-block;
            padding: 15px 40px;
            background: linear-gradient(135deg, rgba(80, 40, 100, 0.6), rgba(100, 60, 130, 0.5));
            border: 1px solid rgba(120, 80, 150, 0.5);
            color: #c0a0d0;
            font-size: 1rem;
            cursor: pointer;
            border-radius: 6px;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .completion-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(100, 50, 150, 0.3);
        }
    </style>
</head>
<body>
    <header class="module-header">
        <div class="header-left">
            <a href="../index.html" class="back-btn">&larr; Back to Vault</a>
            <span class="module-title">Malware Families</span>
        </div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
    </header>

    <main class="module-content">
        <!-- Intro -->
        <section class="intro-section">
            <div class="intro-icon">ðŸ“š</div>
            <h1 class="intro-title">Malware Families Case Studies</h1>
            <p class="intro-text">Understanding historical malware gives us insight into attacker techniques, evolution of threats, and lessons for defense. These case studies cover some of the most impactful malware in history.</p>
        </section>

        <!-- Case selector -->
        <div class="case-selector">
            <button class="case-btn active" onclick="showCase('wannacry')">WannaCry</button>
            <button class="case-btn" onclick="showCase('emotet')">EMOTET</button>
            <button class="case-btn" onclick="showCase('stuxnet')">Stuxnet</button>
            <button class="case-btn" onclick="showCase('slowloris')">Slowloris</button>
            <button class="case-btn" onclick="showCase('notpetya')">NotPetya</button>
        </div>

        <!-- WannaCry Case Study -->
        <div class="case-study" id="case-wannacry">
            <div class="timeline">
                <div class="timeline-item visible">
                    <div class="timeline-dot"></div>
                    <div class="timeline-year">MAY 2017</div>

                    <div class="malware-card">
                        <div class="malware-header">
                            <div>
                                <h2 class="malware-name">WannaCry</h2>
                                <span class="malware-type">RANSOMWARE / WORM</span>
                            </div>
                            <div class="malware-severity">
                                <span class="severity-label">SEVERITY</span>
                                <div class="severity-dots">
                                    <div class="severity-dot active"></div>
                                    <div class="severity-dot active"></div>
                                    <div class="severity-dot active"></div>
                                    <div class="severity-dot active"></div>
                                    <div class="severity-dot active"></div>
                                </div>
                            </div>
                        </div>

                        <div class="malware-body">
                            <p class="malware-description">
                                WannaCry was a devastating ransomware attack that spread globally in May 2017, exploiting the EternalBlue vulnerability (CVE-2017-0144) in Windows SMB protocol. It infected over 230,000 computers across 150 countries in just one day, causing an estimated $4-8 billion in damages.
                            </p>

                            <div class="stats-grid">
                                <div class="stat-box">
                                    <div class="stat-value">230K+</div>
                                    <div class="stat-label">SYSTEMS INFECTED</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value">150</div>
                                    <div class="stat-label">COUNTRIES</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value">$4-8B</div>
                                    <div class="stat-label">EST. DAMAGES</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value">$300</div>
                                    <div class="stat-label">RANSOM (BTC)</div>
                                </div>
                            </div>

                            <div class="techniques-section">
                                <div class="section-label">TECHNIQUES USED</div>
                                <div class="technique-tags">
                                    <span class="technique-tag lateral" title="T1210: Exploitation of Remote Services">EternalBlue Exploit</span>
                                    <span class="technique-tag impact" title="T1486: Data Encrypted for Impact">File Encryption</span>
                                    <span class="technique-tag persistence" title="T1547: Boot or Logon Autostart">Registry Persistence</span>
                                    <span class="technique-tag evasion" title="T1027: Obfuscated Files">Kill Switch Domain</span>
                                    <span class="technique-tag lateral" title="T1021.002: SMB/Windows Admin Shares">SMB Propagation</span>
                                </div>
                            </div>

                            <div class="killchain-section">
                                <div class="section-label">KILL CHAIN</div>
                                <div class="killchain">
                                    <div class="kc-step">
                                        <div class="kc-number">01</div>
                                        <div class="kc-name">Initial Access</div>
                                        <div class="kc-desc">SMB exploit (port 445)</div>
                                    </div>
                                    <div class="kc-step">
                                        <div class="kc-number">02</div>
                                        <div class="kc-name">Execution</div>
                                        <div class="kc-desc">Payload deployment</div>
                                    </div>
                                    <div class="kc-step">
                                        <div class="kc-number">03</div>
                                        <div class="kc-name">Persistence</div>
                                        <div class="kc-desc">Service installation</div>
                                    </div>
                                    <div class="kc-step">
                                        <div class="kc-number">04</div>
                                        <div class="kc-name">Lateral Move</div>
                                        <div class="kc-desc">Scan & spread</div>
                                    </div>
                                    <div class="kc-step">
                                        <div class="kc-number">05</div>
                                        <div class="kc-name">Impact</div>
                                        <div class="kc-desc">Encrypt & ransom</div>
                                    </div>
                                </div>
                            </div>

                            <div class="ioc-section">
                                <div class="section-label">INDICATORS OF COMPROMISE</div>
                                <div class="ioc-list">
                                    <div class="ioc-item">
                                        <span class="ioc-value">iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com</span>
                                        <span class="ioc-type">KILL SWITCH</span>
                                    </div>
                                    <div class="ioc-item">
                                        <span class="ioc-value">mssecsvc.exe, tasksche.exe</span>
                                        <span class="ioc-type">FILENAME</span>
                                    </div>
                                    <div class="ioc-item">
                                        <span class="ioc-value">.WNCRY, .WNCRYT file extensions</span>
                                        <span class="ioc-type">FILE EXT</span>
                                    </div>
                                    <div class="ioc-item">
                                        <span class="ioc-value">TCP/445 scanning activity</span>
                                        <span class="ioc-type">NETWORK</span>
                                    </div>
                                </div>
                            </div>

                            <div class="lessons-section">
                                <div class="section-label">LESSONS LEARNED</div>
                                <div class="lesson-item">
                                    <span class="lesson-icon">âœ“</span>
                                    <span>Patch critical vulnerabilities immediately - MS17-010 was released 2 months before the attack</span>
                                </div>
                                <div class="lesson-item">
                                    <span class="lesson-icon">âœ“</span>
                                    <span>Network segmentation limits worm propagation</span>
                                </div>
                                <div class="lesson-item">
                                    <span class="lesson-icon">âœ“</span>
                                    <span>Kill switches can stop malware - researcher @MalwareTechBlog discovered WannaCry's</span>
                                </div>
                                <div class="lesson-item">
                                    <span class="lesson-icon">âœ“</span>
                                    <span>Air-gapped backups are critical for ransomware recovery</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- EMOTET Case Study -->
        <div class="case-study" id="case-emotet" style="display: none;">
            <div class="timeline">
                <div class="timeline-item visible">
                    <div class="timeline-dot"></div>
                    <div class="timeline-year">2014-2021</div>

                    <div class="malware-card">
                        <div class="malware-header">
                            <div>
                                <h2 class="malware-name">EMOTET</h2>
                                <span class="malware-type">BANKING TROJAN / LOADER</span>
                            </div>
                            <div class="malware-severity">
                                <span class="severity-label">SEVERITY</span>
                                <div class="severity-dots">
                                    <div class="severity-dot active"></div>
                                    <div class="severity-dot active"></div>
                                    <div class="severity-dot active"></div>
                                    <div class="severity-dot active"></div>
                                    <div class="severity-dot active"></div>
                                </div>
                            </div>
                        </div>

                        <div class="malware-body">
                            <p class="malware-description">
                                EMOTET evolved from a simple banking trojan to "the world's most dangerous malware" - a sophisticated botnet that served as a delivery platform for other malware. It pioneered thread hijacking in phishing and was finally disrupted by law enforcement in January 2021.
                            </p>

                            <div class="stats-grid">
                                <div class="stat-box">
                                    <div class="stat-value">1.6M+</div>
                                    <div class="stat-label">INFECTED MACHINES</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value">7 Years</div>
                                    <div class="stat-label">ACTIVE PERIOD</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value">$2.5B+</div>
                                    <div class="stat-label">EST. DAMAGES</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value">3</div>
                                    <div class="stat-label">BOTNETS (EPOCHS)</div>
                                </div>
                            </div>

                            <div class="techniques-section">
                                <div class="section-label">TECHNIQUES USED</div>
                                <div class="technique-tags">
                                    <span class="technique-tag persistence" title="T1566.001: Spearphishing Attachment">Malicious Documents</span>
                                    <span class="technique-tag evasion" title="T1027.002: Software Packing">Heavy Obfuscation</span>
                                    <span class="technique-tag lateral" title="T1534: Internal Spearphishing">Thread Hijacking</span>
                                    <span class="technique-tag persistence" title="T1053: Scheduled Task">Scheduled Tasks</span>
                                    <span class="technique-tag exfil" title="T1041: Exfiltration Over C2">Modular Payloads</span>
                                </div>
                            </div>

                            <div class="callout info">
                                <strong>Evolution:</strong> EMOTET transformed from a banking trojan (2014) â†’ botnet (2017) â†’ malware-as-a-service platform delivering TrickBot, Ryuk, and Qakbot.
                            </div>

                            <div class="ioc-section">
                                <div class="section-label">INDICATORS OF COMPROMISE</div>
                                <div class="ioc-list">
                                    <div class="ioc-item">
                                        <span class="ioc-value">Reply-chain phishing emails with .doc attachments</span>
                                        <span class="ioc-type">DELIVERY</span>
                                    </div>
                                    <div class="ioc-item">
                                        <span class="ioc-value">PowerShell download cradles</span>
                                        <span class="ioc-type">EXECUTION</span>
                                    </div>
                                    <div class="ioc-item">
                                        <span class="ioc-value">%LOCALAPPDATA%\[random]\[random].exe</span>
                                        <span class="ioc-type">FILE PATH</span>
                                    </div>
                                    <div class="ioc-item">
                                        <span class="ioc-value">Port 8080, 443 C2 traffic</span>
                                        <span class="ioc-type">NETWORK</span>
                                    </div>
                                </div>
                            </div>

                            <div class="lessons-section">
                                <div class="section-label">LESSONS LEARNED</div>
                                <div class="lesson-item">
                                    <span class="lesson-icon">âœ“</span>
                                    <span>Disable Office macros by default - primary infection vector</span>
                                </div>
                                <div class="lesson-item">
                                    <span class="lesson-icon">âœ“</span>
                                    <span>User awareness training for phishing recognition</span>
                                </div>
                                <div class="lesson-item">
                                    <span class="lesson-icon">âœ“</span>
                                    <span>Email authentication (DMARC, DKIM, SPF) helps prevent spoofing</span>
                                </div>
                                <div class="lesson-item">
                                    <span class="lesson-icon">âœ“</span>
                                    <span>International law enforcement cooperation can disrupt major botnets</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stuxnet Case Study -->
        <div class="case-study" id="case-stuxnet" style="display: none;">
            <div class="timeline">
                <div class="timeline-item visible">
                    <div class="timeline-dot"></div>
                    <div class="timeline-year">2010</div>

                    <div class="malware-card">
                        <div class="malware-header">
                            <div>
                                <h2 class="malware-name">Stuxnet</h2>
                                <span class="malware-type">CYBER WEAPON / WORM</span>
                            </div>
                            <div class="malware-severity">
                                <span class="severity-label">SOPHISTICATION</span>
                                <div class="severity-dots">
                                    <div class="severity-dot active"></div>
                                    <div class="severity-dot active"></div>
                                    <div class="severity-dot active"></div>
                                    <div class="severity-dot active"></div>
                                    <div class="severity-dot active"></div>
                                </div>
                            </div>
                        </div>

                        <div class="malware-body">
                            <p class="malware-description">
                                Stuxnet was the first known cyber weapon designed to cause physical damage. It targeted Iranian nuclear enrichment facilities, specifically Siemens PLCs controlling uranium centrifuges. It destroyed approximately 1,000 centrifuges by causing them to spin at incorrect speeds while reporting normal operations.
                            </p>

                            <div class="stats-grid">
                                <div class="stat-box">
                                    <div class="stat-value">4</div>
                                    <div class="stat-label">ZERO-DAYS USED</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value">~1,000</div>
                                    <div class="stat-label">CENTRIFUGES DESTROYED</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value">500KB</div>
                                    <div class="stat-label">PAYLOAD SIZE</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value">5</div>
                                    <div class="stat-label">ORGANIZATIONS HIT</div>
                                </div>
                            </div>

                            <div class="techniques-section">
                                <div class="section-label">TECHNIQUES USED</div>
                                <div class="technique-tags">
                                    <span class="technique-tag lateral" title="Multiple 0-days">4 Zero-Day Exploits</span>
                                    <span class="technique-tag evasion" title="Stolen certificates">Signed with Stolen Certs</span>
                                    <span class="technique-tag persistence" title="USB propagation">Air-Gap Jumping</span>
                                    <span class="technique-tag impact" title="ICS/SCADA targeting">PLC Manipulation</span>
                                    <span class="technique-tag evasion" title="Rootkit functionality">Process Hiding</span>
                                </div>
                            </div>

                            <div class="callout warning">
                                <strong>Attribution:</strong> Widely believed to be a joint US-Israeli operation (codenamed "Olympic Games"). This was the first publicly known instance of a nation-state using malware to cause physical destruction.
                            </div>

                            <div class="lessons-section">
                                <div class="section-label">LESSONS LEARNED</div>
                                <div class="lesson-item">
                                    <span class="lesson-icon">âœ“</span>
                                    <span>Air-gapped networks are not immune - USB vectors can bridge gaps</span>
                                </div>
                                <div class="lesson-item">
                                    <span class="lesson-icon">âœ“</span>
                                    <span>ICS/SCADA systems require specialized security approaches</span>
                                </div>
                                <div class="lesson-item">
                                    <span class="lesson-icon">âœ“</span>
                                    <span>Nation-state actors have significant resources and patience</span>
                                </div>
                                <div class="lesson-item">
                                    <span class="lesson-icon">âœ“</span>
                                    <span>Supply chain attacks can reach high-security targets</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slowloris Case Study -->
        <div class="case-study" id="case-slowloris" style="display: none;">
            <div class="timeline">
                <div class="timeline-item visible">
                    <div class="timeline-dot"></div>
                    <div class="timeline-year">2009</div>

                    <div class="malware-card">
                        <div class="malware-header">
                            <div>
                                <h2 class="malware-name">Slowloris</h2>
                                <span class="malware-type">DoS TOOL</span>
                            </div>
                            <div class="malware-severity">
                                <span class="severity-label">SIMPLICITY</span>
                                <div class="severity-dots">
                                    <div class="severity-dot active"></div>
                                    <div class="severity-dot active"></div>
                                    <div class="severity-dot active"></div>
                                    <div class="severity-dot"></div>
                                    <div class="severity-dot"></div>
                                </div>
                            </div>
                        </div>

                        <div class="malware-body">
                            <p class="malware-description">
                                Slowloris is an elegant denial-of-service tool that exhausts web server connections by opening many connections and keeping them alive with partial HTTP requests. Unlike volumetric DDoS, it requires minimal bandwidth - a single machine can take down a vulnerable server.
                            </p>

                            <div class="stats-grid">
                                <div class="stat-box">
                                    <div class="stat-value">~150</div>
                                    <div class="stat-label">LINES OF CODE</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value">Low</div>
                                    <div class="stat-label">BANDWIDTH NEEDED</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value">Apache</div>
                                    <div class="stat-label">PRIMARY TARGET</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value">2009</div>
                                    <div class="stat-label">RELEASED</div>
                                </div>
                            </div>

                            <div class="techniques-section">
                                <div class="section-label">HOW IT WORKS</div>
                                <div class="technique-tags">
                                    <span class="technique-tag impact">Partial HTTP Requests</span>
                                    <span class="technique-tag impact">Connection Exhaustion</span>
                                    <span class="technique-tag evasion">Low & Slow</span>
                                    <span class="technique-tag impact">Keep-Alive Abuse</span>
                                </div>
                            </div>

                            <div class="killchain-section">
                                <div class="section-label">ATTACK MECHANISM</div>
                                <div class="killchain">
                                    <div class="kc-step">
                                        <div class="kc-number">01</div>
                                        <div class="kc-name">Connect</div>
                                        <div class="kc-desc">Open HTTP connection</div>
                                    </div>
                                    <div class="kc-step">
                                        <div class="kc-number">02</div>
                                        <div class="kc-name">Partial Request</div>
                                        <div class="kc-desc">Send incomplete headers</div>
                                    </div>
                                    <div class="kc-step">
                                        <div class="kc-number">03</div>
                                        <div class="kc-name">Keep Alive</div>
                                        <div class="kc-desc">Send bytes periodically</div>
                                    </div>
                                    <div class="kc-step">
                                        <div class="kc-number">04</div>
                                        <div class="kc-name">Exhaust</div>
                                        <div class="kc-desc">Fill connection pool</div>
                                    </div>
                                    <div class="kc-step">
                                        <div class="kc-number">05</div>
                                        <div class="kc-name">Deny Service</div>
                                        <div class="kc-desc">Block new users</div>
                                    </div>
                                </div>
                            </div>

                            <div class="ioc-section">
                                <div class="section-label">DETECTION INDICATORS</div>
                                <div class="ioc-list">
                                    <div class="ioc-item">
                                        <span class="ioc-value">Many connections from single IP in TIME_WAIT</span>
                                        <span class="ioc-type">NETWORK</span>
                                    </div>
                                    <div class="ioc-item">
                                        <span class="ioc-value">Incomplete HTTP requests in logs</span>
                                        <span class="ioc-type">LOG</span>
                                    </div>
                                    <div class="ioc-item">
                                        <span class="ioc-value">Connection count near max limit</span>
                                        <span class="ioc-type">SERVER</span>
                                    </div>
                                </div>
                            </div>

                            <div class="lessons-section">
                                <div class="section-label">DEFENSES</div>
                                <div class="lesson-item">
                                    <span class="lesson-icon">âœ“</span>
                                    <span>Use web servers with async I/O (Nginx, IIS) - not vulnerable</span>
                                </div>
                                <div class="lesson-item">
                                    <span class="lesson-icon">âœ“</span>
                                    <span>Configure aggressive connection timeouts</span>
                                </div>
                                <div class="lesson-item">
                                    <span class="lesson-icon">âœ“</span>
                                    <span>Rate limit connections per IP</span>
                                </div>
                                <div class="lesson-item">
                                    <span class="lesson-icon">âœ“</span>
                                    <span>Use reverse proxy or load balancer in front of Apache</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- NotPetya Case Study -->
        <div class="case-study" id="case-notpetya" style="display: none;">
            <div class="timeline">
                <div class="timeline-item visible">
                    <div class="timeline-dot"></div>
                    <div class="timeline-year">JUNE 2017</div>

                    <div class="malware-card">
                        <div class="malware-header">
                            <div>
                                <h2 class="malware-name">NotPetya</h2>
                                <span class="malware-type">WIPER / PSEUDO-RANSOMWARE</span>
                            </div>
                            <div class="malware-severity">
                                <span class="severity-label">SEVERITY</span>
                                <div class="severity-dots">
                                    <div class="severity-dot active"></div>
                                    <div class="severity-dot active"></div>
                                    <div class="severity-dot active"></div>
                                    <div class="severity-dot active"></div>
                                    <div class="severity-dot active"></div>
                                </div>
                            </div>
                        </div>

                        <div class="malware-body">
                            <p class="malware-description">
                                NotPetya was disguised as ransomware but was actually a destructive wiper. It spread via a compromised Ukrainian accounting software (M.E.Doc) and caused over $10 billion in damages worldwide. The "ransom" mechanism was non-functional - data destruction was the goal.
                            </p>

                            <div class="stats-grid">
                                <div class="stat-box">
                                    <div class="stat-value">$10B+</div>
                                    <div class="stat-label">TOTAL DAMAGES</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value">$300M</div>
                                    <div class="stat-label">MAERSK LOSS</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value">65+</div>
                                    <div class="stat-label">COUNTRIES HIT</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value">Ukraine</div>
                                    <div class="stat-label">PRIMARY TARGET</div>
                                </div>
                            </div>

                            <div class="techniques-section">
                                <div class="section-label">TECHNIQUES USED</div>
                                <div class="technique-tags">
                                    <span class="technique-tag persistence" title="T1195.002: Supply Chain Compromise">Supply Chain Attack</span>
                                    <span class="technique-tag lateral" title="EternalBlue + EternalRomance">SMB Exploits</span>
                                    <span class="technique-tag lateral" title="T1003: Credential Dumping">Mimikatz (Credential Theft)</span>
                                    <span class="technique-tag impact" title="T1561: Disk Wipe">MBR Overwrite</span>
                                    <span class="technique-tag evasion" title="Fake ransomware">False Flag (Ransomware)</span>
                                </div>
                            </div>

                            <div class="callout warning">
                                <strong>Supply Chain Vector:</strong> NotPetya's initial infection came through a legitimate software update from M.E.Doc, a Ukrainian accounting application. This demonstrated how supply chain compromises can bypass traditional security.
                            </div>

                            <div class="lessons-section">
                                <div class="section-label">LESSONS LEARNED</div>
                                <div class="lesson-item">
                                    <span class="lesson-icon">âœ“</span>
                                    <span>Supply chain security is critical - vet software vendors</span>
                                </div>
                                <div class="lesson-item">
                                    <span class="lesson-icon">âœ“</span>
                                    <span>Not all "ransomware" can be recovered from - some is pure destruction</span>
                                </div>
                                <div class="lesson-item">
                                    <span class="lesson-icon">âœ“</span>
                                    <span>Geographic targeting can have global collateral damage</span>
                                </div>
                                <div class="lesson-item">
                                    <span class="lesson-icon">âœ“</span>
                                    <span>Credential hygiene prevents lateral movement</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Comparison Table -->
        <section style="margin-top: 60px;">
            <h2 style="color: #b090c0; font-size: 1.3rem; margin-bottom: 20px;">Comparison Matrix</h2>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Malware</th>
                        <th>Type</th>
                        <th>Primary Vector</th>
                        <th>Goal</th>
                        <th>Attribution</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>WannaCry</td>
                        <td>Ransomware/Worm</td>
                        <td>SMB Exploit</td>
                        <td>Financial</td>
                        <td>North Korea (Lazarus)</td>
                    </tr>
                    <tr>
                        <td>EMOTET</td>
                        <td>Loader/Botnet</td>
                        <td>Phishing</td>
                        <td>MaaS Platform</td>
                        <td>Criminal (TA542)</td>
                    </tr>
                    <tr>
                        <td>Stuxnet</td>
                        <td>Cyber Weapon</td>
                        <td>USB/Supply Chain</td>
                        <td>Sabotage</td>
                        <td>US/Israel</td>
                    </tr>
                    <tr>
                        <td>Slowloris</td>
                        <td>DoS Tool</td>
                        <td>Direct Attack</td>
                        <td>Service Disruption</td>
                        <td>RSnake (researcher)</td>
                    </tr>
                    <tr>
                        <td>NotPetya</td>
                        <td>Wiper</td>
                        <td>Supply Chain</td>
                        <td>Destruction</td>
                        <td>Russia (Sandworm)</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Completion -->
        <section class="completion-section">
            <div class="completion-icon">ðŸ“š</div>
            <h2 class="completion-title">Module Complete!</h2>
            <p class="completion-text">You've studied historical malware families and their techniques. Continue to the next module to learn how to safely analyze malware in a sandbox environment.</p>
            <a href="sandbox-setup.html" class="completion-btn">Next: Sandbox Setup &rarr;</a>
        </section>

        <div class="nav-buttons">
            <a href="static-analysis.html" class="nav-btn">&larr; Previous: Static Analysis</a>
            <a href="sandbox-setup.html" class="nav-btn primary">Next Module &rarr;</a>
        </div>
    </main>

    <script>
        // Case study switcher
        function showCase(caseName) {
            document.querySelectorAll('.case-study').forEach(cs => cs.style.display = 'none');
            document.querySelectorAll('.case-btn').forEach(btn => btn.classList.remove('active'));

            document.getElementById('case-' + caseName).style.display = 'block';
            event.target.classList.add('active');

            // Track progress
            viewedCases.add(caseName);
            updateProgress();
        }

        // Progress tracking
        let viewedCases = new Set(['wannacry']);
        const totalCases = 5;

        function updateProgress() {
            const progress = (viewedCases.size / totalCases) * 100;
            document.getElementById('progressFill').style.width = progress + '%';

            if (viewedCases.size === totalCases) {
                localStorage.setItem('vault_families_complete', 'true');
            }
        }

        // Intersection observer for animations
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, { threshold: 0.2 });

        document.querySelectorAll('.timeline-item').forEach(item => {
            observer.observe(item);
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            if (localStorage.getItem('vault_families_complete')) {
                document.getElementById('progressFill').style.width = '100%';
            }
            updateProgress();
        });
    </script>
<script src="../../../components/FluxCapacitor.js"></script>
</body>
</html>
