<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Access Control -->
    <script src="../../../components/AccessGuard.js"></script>
    <script>
        AccessGuard.require('dark-arts');
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Behavioral Analysis - The Dark Arts</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: #0a0508;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #c0a0d0;
            line-height: 1.7;
            overflow-x: hidden;
        }

        /* Ambient background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                radial-gradient(ellipse at 20% 30%, rgba(80, 40, 100, 0.08) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 70%, rgba(60, 20, 80, 0.06) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        /* Header */
        .module-header {
            background: linear-gradient(180deg, rgba(60, 30, 80, 0.3) 0%, transparent 100%);
            border-bottom: 1px solid rgba(100, 60, 130, 0.2);
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .back-btn {
            background: rgba(80, 40, 100, 0.2);
            border: 1px solid rgba(100, 60, 130, 0.3);
            color: #9a7aaa;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(100, 60, 130, 0.3);
            border-color: rgba(120, 80, 150, 0.5);
        }

        .module-title {
            font-size: 1.1rem;
            color: #b090c0;
            letter-spacing: 0.1em;
        }

        .progress-bar {
            width: 200px;
            height: 6px;
            background: rgba(60, 30, 80, 0.3);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6a4a8a, #9a6aba);
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Main content */
        .module-content {
            max-width: 1100px;
            margin: 0 auto;
            padding: 40px;
            position: relative;
            z-index: 10;
        }

        /* Intro section */
        .intro-section {
            text-align: center;
            padding: 40px 0 60px;
        }

        .intro-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            opacity: 0.8;
        }

        .intro-title {
            font-size: 2.2rem;
            color: #c9b8d9;
            margin-bottom: 15px;
            font-weight: 300;
            letter-spacing: 0.1em;
        }

        .intro-subtitle {
            font-size: 1rem;
            color: #8a6a9a;
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.8;
        }

        /* Section styling */
        .section {
            margin-bottom: 80px;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.6s ease;
        }

        .section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .section-number {
            font-size: 0.7rem;
            color: #6a4a7a;
            letter-spacing: 0.3em;
            margin-bottom: 10px;
        }

        .section-title {
            font-size: 1.8rem;
            color: #c0a0d0;
            margin-bottom: 20px;
            font-weight: 300;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .section-icon {
            font-size: 1.6rem;
            opacity: 0.7;
        }

        .section-content {
            color: #a080b0;
            font-size: 1rem;
        }

        .section-content p {
            margin-bottom: 15px;
        }

        .section-content ul {
            list-style: none;
            padding-left: 20px;
        }

        .section-content li {
            margin-bottom: 10px;
            position: relative;
            padding-left: 20px;
        }

        .section-content li::before {
            content: '‚ñ∏';
            position: absolute;
            left: 0;
            color: #7a5a8a;
        }

        /* Comparison grid */
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 30px 0;
        }

        .comparison-card {
            background: rgba(30, 15, 40, 0.5);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 8px;
            padding: 30px;
        }

        .comparison-card h3 {
            font-size: 1.2rem;
            color: #b090c0;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .comparison-card ul {
            list-style: none;
            padding: 0;
        }

        .comparison-card li {
            margin-bottom: 12px;
            padding-left: 25px;
            position: relative;
        }

        .comparison-card li::before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: #7a9a7a;
            font-weight: bold;
        }

        /* Info boxes */
        .info-box {
            background: linear-gradient(135deg, rgba(40, 20, 60, 0.4), rgba(30, 15, 50, 0.3));
            border-left: 3px solid #7a5a9a;
            border-radius: 6px;
            padding: 20px 25px;
            margin: 25px 0;
        }

        .info-box-title {
            font-size: 0.85rem;
            color: #9a7aaa;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .info-box-content {
            color: #a080b0;
            font-size: 0.95rem;
        }

        /* Interactive visualizations */
        .visualization {
            background: rgba(20, 10, 30, 0.6);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 10px;
            padding: 30px;
            margin: 30px 0;
        }

        .viz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(80, 50, 100, 0.2);
        }

        .viz-title {
            font-size: 1rem;
            color: #b090c0;
            letter-spacing: 0.05em;
        }

        .viz-controls {
            display: flex;
            gap: 10px;
        }

        .viz-btn {
            background: rgba(80, 40, 100, 0.3);
            border: 1px solid rgba(100, 60, 130, 0.4);
            color: #9a7aaa;
            padding: 6px 14px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.75rem;
            transition: all 0.3s ease;
        }

        .viz-btn:hover {
            background: rgba(100, 60, 130, 0.4);
            border-color: rgba(120, 80, 150, 0.6);
        }

        .viz-btn.active {
            background: rgba(120, 80, 150, 0.5);
            border-color: rgba(140, 100, 170, 0.7);
        }

        /* Process tree visualization */
        .process-tree {
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            line-height: 1.8;
            color: #a080b0;
            padding: 20px;
            background: rgba(10, 5, 15, 0.5);
            border-radius: 6px;
            overflow-x: auto;
        }

        .process-node {
            margin: 5px 0;
            padding: 8px 12px;
            background: rgba(40, 20, 60, 0.3);
            border-left: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .process-node:hover {
            background: rgba(60, 30, 80, 0.4);
            border-left-color: #7a5a9a;
        }

        .process-node.benign {
            border-left-color: #5a7a5a;
        }

        .process-node.suspicious {
            border-left-color: #9a8a5a;
        }

        .process-node.malicious {
            border-left-color: #9a5a5a;
        }

        .process-pid {
            color: #7a5a9a;
        }

        .process-name {
            color: #c0a0d0;
            font-weight: bold;
        }

        .process-path {
            color: #8a6a9a;
            font-size: 0.75rem;
        }

        /* File system tree */
        .file-tree {
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            line-height: 1.8;
            padding: 20px;
            background: rgba(10, 5, 15, 0.5);
            border-radius: 6px;
        }

        .file-item {
            margin: 4px 0;
            padding: 6px 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-radius: 4px;
        }

        .file-item:hover {
            background: rgba(60, 30, 80, 0.3);
        }

        .file-item.danger {
            background: rgba(100, 40, 40, 0.2);
            border-left: 2px solid #9a5a5a;
        }

        .file-icon {
            color: #7a5a9a;
            margin-right: 8px;
        }

        .file-name {
            color: #c0a0d0;
        }

        .file-note {
            color: #9a5a5a;
            font-size: 0.7rem;
            margin-left: 10px;
        }

        /* Registry viewer */
        .registry-viewer {
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            padding: 20px;
            background: rgba(10, 5, 15, 0.5);
            border-radius: 6px;
        }

        .reg-key {
            margin: 10px 0;
            padding: 12px;
            background: rgba(40, 20, 60, 0.3);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .reg-key:hover {
            background: rgba(60, 30, 80, 0.4);
        }

        .reg-key.persistence {
            border-left: 3px solid #9a7a5a;
        }

        .reg-path {
            color: #9a7aaa;
            font-size: 0.75rem;
            margin-bottom: 5px;
        }

        .reg-value {
            color: #c0a0d0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .reg-data {
            color: #8a6a9a;
            font-size: 0.8rem;
        }

        /* Network timeline */
        .network-timeline {
            position: relative;
            padding: 30px 20px;
            background: rgba(10, 5, 15, 0.5);
            border-radius: 6px;
        }

        .timeline-axis {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: rgba(100, 60, 130, 0.3);
            transform: translateY(-50%);
        }

        .timeline-events {
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 200px;
        }

        .timeline-event {
            position: relative;
            width: 100px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .timeline-event:hover .event-marker {
            transform: scale(1.3);
            box-shadow: 0 0 20px currentColor;
        }

        .event-marker {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #7a5a9a;
            border: 2px solid #9a7aaa;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.3s ease;
        }

        .event-marker.beacon {
            background: #9a7a5a;
            animation: pulse 2s infinite;
        }

        .event-marker.dns {
            background: #7a9a7a;
        }

        .event-marker.http {
            background: #9a7a9a;
        }

        .event-info {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 20px;
            padding: 10px 12px;
            background: rgba(30, 15, 40, 0.95);
            border: 1px solid rgba(100, 60, 130, 0.4);
            border-radius: 6px;
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .timeline-event:hover .event-info {
            opacity: 1;
        }

        .event-time {
            color: #7a5a9a;
            margin-bottom: 3px;
        }

        .event-desc {
            color: #c0a0d0;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* API call flow */
        .api-flow {
            padding: 30px 20px;
            background: rgba(10, 5, 15, 0.5);
            border-radius: 6px;
        }

        .api-sequence {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .api-call {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            background: rgba(40, 20, 60, 0.3);
            border-radius: 6px;
            border-left: 3px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .api-call:hover {
            background: rgba(60, 30, 80, 0.4);
            transform: translateX(5px);
        }

        .api-call.danger {
            border-left-color: #9a5a5a;
        }

        .api-call.warning {
            border-left-color: #9a8a5a;
        }

        .api-call.safe {
            border-left-color: #5a7a5a;
        }

        .api-number {
            min-width: 30px;
            height: 30px;
            border-radius: 50%;
            background: rgba(100, 60, 130, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            color: #9a7aaa;
            margin-right: 15px;
        }

        .api-name {
            flex: 1;
            font-family: 'Courier New', monospace;
            color: #c0a0d0;
            font-size: 0.9rem;
        }

        .api-description {
            color: #8a6a9a;
            font-size: 0.75rem;
        }

        /* Tool grid */
        .tool-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .tool-card {
            background: rgba(30, 15, 40, 0.5);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 8px;
            padding: 25px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .tool-card:hover {
            transform: translateY(-5px);
            border-color: rgba(120, 80, 150, 0.5);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .tool-icon {
            font-size: 2rem;
            margin-bottom: 15px;
            opacity: 0.8;
        }

        .tool-name {
            font-size: 1.1rem;
            color: #b090c0;
            margin-bottom: 10px;
        }

        .tool-description {
            color: #8a6a9a;
            font-size: 0.85rem;
            line-height: 1.6;
        }

        .tool-category {
            display: inline-block;
            margin-top: 10px;
            padding: 4px 10px;
            background: rgba(80, 40, 100, 0.3);
            border-radius: 12px;
            font-size: 0.65rem;
            color: #9a7aaa;
            letter-spacing: 0.1em;
        }

        /* Challenge box */
        .challenge-box {
            background: linear-gradient(135deg, rgba(60, 20, 80, 0.3), rgba(40, 15, 60, 0.4));
            border: 1px solid rgba(100, 60, 130, 0.4);
            border-radius: 10px;
            padding: 30px;
            margin: 40px 0;
        }

        .challenge-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }

        .challenge-icon {
            font-size: 1.8rem;
        }

        .challenge-title {
            font-size: 1.2rem;
            color: #c0a0d0;
            letter-spacing: 0.05em;
        }

        .challenge-question {
            color: #a080b0;
            font-size: 1rem;
            margin-bottom: 20px;
            line-height: 1.7;
        }

        .challenge-options {
            display: grid;
            gap: 12px;
        }

        .challenge-option {
            padding: 15px 20px;
            background: rgba(30, 15, 40, 0.5);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #9a7aaa;
        }

        .challenge-option:hover {
            background: rgba(50, 25, 60, 0.6);
            border-color: rgba(100, 60, 130, 0.5);
        }

        .challenge-option.selected {
            background: rgba(80, 40, 100, 0.4);
            border-color: rgba(120, 80, 150, 0.6);
        }

        .challenge-option.correct {
            background: rgba(40, 80, 40, 0.3);
            border-color: rgba(60, 120, 60, 0.6);
            color: #7aaa7a;
        }

        .challenge-option.incorrect {
            background: rgba(80, 40, 40, 0.3);
            border-color: rgba(120, 60, 60, 0.6);
            color: #aa7a7a;
        }

        .challenge-feedback {
            margin-top: 20px;
            padding: 15px 20px;
            background: rgba(40, 20, 60, 0.4);
            border-radius: 6px;
            border-left: 3px solid #7a5a9a;
            display: none;
        }

        .challenge-feedback.show {
            display: block;
        }

        .feedback-text {
            color: #a080b0;
            font-size: 0.9rem;
        }

        /* Completion section */
        .completion-section {
            text-align: center;
            padding: 60px 40px;
            background: linear-gradient(135deg, rgba(40, 20, 60, 0.3), rgba(30, 15, 50, 0.4));
            border: 1px solid rgba(100, 60, 130, 0.3);
            border-radius: 12px;
            margin: 60px 0 40px;
        }

        .completion-icon {
            font-size: 3.5rem;
            margin-bottom: 20px;
            opacity: 0.8;
        }

        .completion-title {
            font-size: 1.8rem;
            color: #c9b8d9;
            margin-bottom: 15px;
            font-weight: 300;
        }

        .completion-text {
            color: #8a6a9a;
            font-size: 1rem;
            max-width: 600px;
            margin: 0 auto 30px;
            line-height: 1.8;
        }

        .completion-btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 14px 32px;
            background: linear-gradient(135deg, rgba(100, 60, 130, 0.4), rgba(80, 40, 110, 0.3));
            border: 1px solid rgba(140, 100, 170, 0.5);
            border-radius: 25px;
            color: #c0a0d0;
            font-size: 0.9rem;
            letter-spacing: 0.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .completion-btn:hover {
            background: linear-gradient(135deg, rgba(120, 80, 150, 0.5), rgba(100, 60, 130, 0.4));
            border-color: rgba(160, 120, 190, 0.6);
            box-shadow: 0 0 30px rgba(120, 80, 150, 0.4);
            transform: translateY(-3px);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .module-content {
                padding: 20px;
            }

            .comparison-grid {
                grid-template-columns: 1fr;
            }

            .tool-grid {
                grid-template-columns: 1fr;
            }

            .timeline-events {
                flex-wrap: wrap;
                height: auto;
                gap: 30px;
            }

            .intro-title {
                font-size: 1.6rem;
            }

            .section-title {
                font-size: 1.4rem;
            }
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            cursor: help;
            border-bottom: 1px dotted #7a5a9a;
        }

        .tooltip:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 8px;
            padding: 8px 12px;
            background: rgba(30, 15, 40, 0.95);
            border: 1px solid rgba(100, 60, 130, 0.5);
            border-radius: 6px;
            font-size: 0.75rem;
            white-space: nowrap;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="module-header">
        <div class="header-left">
            <a href="../index.html" class="back-btn">‚Üê Back to Vault</a>
            <span class="module-title">BEHAVIORAL ANALYSIS</span>
        </div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="module-content">
        <!-- Introduction -->
        <div class="intro-section">
            <div class="intro-icon">üé≠</div>
            <h1 class="intro-title">Behavioral Analysis</h1>
            <p class="intro-subtitle">
                Observing malware in motion. Understanding not just what it is, but what it does.
                In this module, you'll learn to analyze the runtime behavior of malicious code‚Äîthe processes it spawns,
                the files it touches, the network connections it makes, and the persistence mechanisms it employs.
            </p>
        </div>

        <!-- Section 1: Introduction to Behavioral Analysis -->
        <section class="section" data-section="1">
            <div class="section-number">SECTION 01</div>
            <h2 class="section-title">
                <span class="section-icon">üîç</span>
                Introduction to Behavioral Analysis
            </h2>
            <div class="section-content">
                <p>
                    Behavioral analysis is the art of observing malware in a controlled environment to understand
                    its actions, intentions, and capabilities. Unlike static analysis, which examines the code without
                    executing it, behavioral analysis reveals the true nature of malicious software through observation.
                </p>

                <div class="comparison-grid">
                    <div class="comparison-card">
                        <h3>üìÑ Static Analysis</h3>
                        <ul>
                            <li>Examines code without execution</li>
                            <li>Analyzes file structure and strings</li>
                            <li>No risk of infection</li>
                            <li>Can be defeated by obfuscation</li>
                            <li>Fast and safe</li>
                        </ul>
                    </div>
                    <div class="comparison-card">
                        <h3>üé≠ Dynamic/Behavioral Analysis</h3>
                        <ul>
                            <li>Observes malware during execution</li>
                            <li>Reveals actual behavior</li>
                            <li>Requires isolated environment</li>
                            <li>Bypasses obfuscation naturally</li>
                            <li>Time-consuming but thorough</li>
                        </ul>
                    </div>
                </div>

                <div class="info-box">
                    <div class="info-box-title">üí° Why Behavior Matters</div>
                    <div class="info-box-content">
                        <p>Modern malware employs sophisticated evasion techniques:</p>
                        <ul>
                            <li><strong>Packing:</strong> Code is compressed or encrypted, hiding its true functionality</li>
                            <li><strong>Polymorphism:</strong> Code changes with each infection, defeating signature detection</li>
                            <li><strong>Anti-analysis:</strong> Malware detects sandboxes and alters behavior</li>
                            <li><strong>Delayed execution:</strong> Malware waits before activating to avoid detection</li>
                        </ul>
                        <p style="margin-top: 15px;">
                            Behavioral analysis cuts through these tricks by observing what the malware <em>actually does</em>,
                            regardless of how it obfuscates its code.
                        </p>
                    </div>
                </div>

                <div class="info-box">
                    <div class="info-box-title">üõ°Ô∏è Safe Execution Environments</div>
                    <div class="info-box-content">
                        <p>Never execute malware on your production system. Always use:</p>
                        <ul>
                            <li><strong>Virtual Machines:</strong> Isolated systems that can be reverted (snapshots are essential)</li>
                            <li><strong>Network Isolation:</strong> Prevent malware from reaching the internet or your local network</li>
                            <li><strong>Analysis Tools:</strong> Pre-installed monitoring software (Process Monitor, Wireshark, etc.)</li>
                            <li><strong>Hardened OS:</strong> Disable Windows Defender, enable hidden files, configure logging</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 2: Process Behavior -->
        <section class="section" data-section="2">
            <div class="section-number">SECTION 02</div>
            <h2 class="section-title">
                <span class="section-icon">üîÑ</span>
                Process Behavior
            </h2>
            <div class="section-content">
                <p>
                    Processes are the heartbeat of malware. Understanding parent-child relationships, process injection,
                    and privilege escalation is fundamental to behavioral analysis.
                </p>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Process Creation Chains</h3>
                <p>
                    Malware often spawns multiple processes to accomplish its goals. The <span class="tooltip" data-tooltip="Parent-Child Hierarchy">process tree</span>
                    reveals the execution flow and can identify suspicious behavior patterns.
                </p>

                <div class="visualization">
                    <div class="viz-header">
                        <div class="viz-title">Process Tree: DLL Injection Example</div>
                        <div class="viz-controls">
                            <button class="viz-btn active" onclick="showProcessTree('injection')">DLL Injection</button>
                            <button class="viz-btn" onclick="showProcessTree('hollowing')">Process Hollowing</button>
                            <button class="viz-btn" onclick="showProcessTree('apc')">APC Injection</button>
                        </div>
                    </div>
                    <div class="process-tree" id="processTree">
                        <!-- Process tree will be populated by JavaScript -->
                    </div>
                </div>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Common Injection Techniques</h3>
                <ul>
                    <li><strong>DLL Injection:</strong> Loads malicious DLL into another process's address space using CreateRemoteThread</li>
                    <li><strong>Process Hollowing:</strong> Creates a legitimate process in suspended state, replaces its memory, then resumes</li>
                    <li><strong>APC Injection:</strong> Uses Asynchronous Procedure Calls to execute code in target thread</li>
                    <li><strong>Reflective DLL Injection:</strong> Manually maps DLL into memory without using LoadLibrary</li>
                    <li><strong>Process Doppelg√§nging:</strong> Abuses NTFS transactions to load malicious code</li>
                </ul>

                <div class="info-box">
                    <div class="info-box-title">üéØ What to Look For</div>
                    <div class="info-box-content">
                        <ul>
                            <li>Unexpected parent-child relationships (e.g., Excel spawning PowerShell)</li>
                            <li>Processes running from unusual locations (TEMP, AppData, etc.)</li>
                            <li>Legitimate processes with suspicious command-line arguments</li>
                            <li>Rapid process creation and termination</li>
                            <li>Processes with elevated privileges from unprivileged parents</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 3: File System Activity -->
        <section class="section" data-section="3">
            <div class="section-number">SECTION 03</div>
            <h2 class="section-title">
                <span class="section-icon">üìÅ</span>
                File System Activity
            </h2>
            <div class="section-content">
                <p>
                    Malware leaves fingerprints throughout the file system. Monitoring file creation, modification,
                    and deletion reveals persistence mechanisms and data exfiltration attempts.
                </p>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Common Malware File Operations</h3>
                <ul>
                    <li><strong>Dropping executables:</strong> Creates additional malware components</li>
                    <li><strong>Configuration files:</strong> Stores C2 addresses, encryption keys, or stolen credentials</li>
                    <li><strong>Persistence mechanisms:</strong> Modifies startup folders or scheduled tasks</li>
                    <li><strong>Log/artifact deletion:</strong> Covers tracks by removing evidence</li>
                    <li><strong>Data staging:</strong> Prepares stolen data for exfiltration</li>
                </ul>

                <div class="visualization">
                    <div class="viz-header">
                        <div class="viz-title">File System Tree: Typical Malware Locations</div>
                    </div>
                    <div class="file-tree">
                        <div class="file-item"><span class="file-icon">üìÇ</span><span class="file-name">C:\Windows\System32\</span></div>
                        <div class="file-item" style="padding-left: 30px;"><span class="file-icon">üìÑ</span><span class="file-name">services.exe</span> <span style="color: #7a9a7a; font-size: 0.7rem;">[Legitimate]</span></div>
                        <div class="file-item" style="padding-left: 30px;"><span class="file-icon">üìÑ</span><span class="file-name">lsass.exe</span> <span style="color: #7a9a7a; font-size: 0.7rem;">[Legitimate]</span></div>

                        <div class="file-item" style="margin-top: 15px;"><span class="file-icon">üìÇ</span><span class="file-name">C:\Users\[Username]\AppData\Roaming\</span></div>
                        <div class="file-item danger" style="padding-left: 30px;"><span class="file-icon">üìÑ</span><span class="file-name">WindowsUpdate.exe</span> <span class="file-note">[SUSPICIOUS - Masquerading]</span></div>
                        <div class="file-item danger" style="padding-left: 30px;"><span class="file-icon">üìÑ</span><span class="file-name">config.dat</span> <span class="file-note">[C2 Configuration]</span></div>

                        <div class="file-item" style="margin-top: 15px;"><span class="file-icon">üìÇ</span><span class="file-name">C:\Users\[Username]\AppData\Local\Temp\</span></div>
                        <div class="file-item danger" style="padding-left: 30px;"><span class="file-icon">üìÑ</span><span class="file-name">payload.dll</span> <span class="file-note">[Dropped Component]</span></div>
                        <div class="file-item danger" style="padding-left: 30px;"><span class="file-icon">üìÑ</span><span class="file-name">creds.txt</span> <span class="file-note">[Credential Theft]</span></div>

                        <div class="file-item" style="margin-top: 15px;"><span class="file-icon">üìÇ</span><span class="file-name">C:\Users\[Username]\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\</span></div>
                        <div class="file-item danger" style="padding-left: 30px;"><span class="file-icon">üìÑ</span><span class="file-name">OneDriveSync.exe</span> <span class="file-note">[Persistence - Startup]</span></div>

                        <div class="file-item" style="margin-top: 15px;"><span class="file-icon">üìÇ</span><span class="file-name">C:\ProgramData\</span></div>
                        <div class="file-item danger" style="padding-left: 30px;"><span class="file-icon">üìÇ</span><span class="file-name">SystemServices\</span> <span class="file-note">[Hidden Directory]</span></div>
                        <div class="file-item danger" style="padding-left: 50px;"><span class="file-icon">üìÑ</span><span class="file-name">svchost.exe</span> <span class="file-note">[CRITICAL - Masquerading]</span></div>
                    </div>
                </div>

                <div class="info-box">
                    <div class="info-box-title">üö© Red Flags in File Activity</div>
                    <div class="info-box-content">
                        <ul>
                            <li>Executables in user directories (AppData, Temp, Downloads)</li>
                            <li>Files with double extensions (.pdf.exe, .docx.scr)</li>
                            <li>Hidden or system files in unusual locations</li>
                            <li>Rapid creation of many small files (ransomware encryption)</li>
                            <li>Legitimate filenames in wrong locations (svchost.exe outside System32)</li>
                            <li>Files created by unexpected processes (browser creating .exe files)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4: Registry Modifications -->
        <section class="section" data-section="4">
            <div class="section-number">SECTION 04</div>
            <h2 class="section-title">
                <span class="section-icon">üóÇÔ∏è</span>
                Registry Modifications
            </h2>
            <div class="section-content">
                <p>
                    The Windows Registry is a prime target for malware persistence and configuration storage.
                    Monitoring registry modifications reveals how malware ensures it survives reboots and evades detection.
                </p>

                <div class="visualization">
                    <div class="viz-header">
                        <div class="viz-title">Registry Viewer: Common Persistence Keys</div>
                    </div>
                    <div class="registry-viewer">
                        <div class="reg-key persistence">
                            <div class="reg-path">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</div>
                            <div class="reg-value">
                                <span class="reg-name" style="color: #c0a0d0;">WindowsDefender</span>
                                <span class="reg-data">"C:\Users\Admin\AppData\Roaming\WinDefend.exe"</span>
                            </div>
                        </div>

                        <div class="reg-key persistence">
                            <div class="reg-path">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</div>
                            <div class="reg-value">
                                <span class="reg-name" style="color: #c0a0d0;">SecurityUpdate</span>
                                <span class="reg-data">"C:\ProgramData\Security\updater.exe -silent"</span>
                            </div>
                        </div>

                        <div class="reg-key persistence">
                            <div class="reg-path">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce</div>
                            <div class="reg-value">
                                <span class="reg-name" style="color: #c0a0d0;">Install</span>
                                <span class="reg-data">"C:\Temp\setup.bat"</span>
                            </div>
                        </div>

                        <div class="reg-key persistence">
                            <div class="reg-path">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\[ServiceName]</div>
                            <div class="reg-value">
                                <span class="reg-name" style="color: #c0a0d0;">ImagePath</span>
                                <span class="reg-data">"C:\Windows\System32\malicious_service.exe"</span>
                            </div>
                        </div>

                        <div class="reg-key persistence">
                            <div class="reg-path">HKEY_CURRENT_USER\Software\Classes\*\shell\open\command</div>
                            <div class="reg-value">
                                <span class="reg-name" style="color: #c0a0d0;">(Default)</span>
                                <span class="reg-data">"C:\malware.exe %1"</span>
                            </div>
                        </div>
                    </div>
                </div>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Key Registry Locations for Persistence</h3>
                <ul>
                    <li><strong>Run/RunOnce Keys:</strong> Execute at user login or system startup</li>
                    <li><strong>Services:</strong> Install as Windows service for automatic startup</li>
                    <li><strong>Winlogon:</strong> Hook into Windows login process</li>
                    <li><strong>File Associations:</strong> Hijack file extensions to execute malware when files open</li>
                    <li><strong>Scheduled Tasks:</strong> Configure automatic execution at specific times</li>
                    <li><strong>Browser Helper Objects (BHOs):</strong> Load into browser processes</li>
                    <li><strong>AppInit_DLLs:</strong> Inject into every process (deprecated in modern Windows)</li>
                </ul>

                <div class="info-box">
                    <div class="info-box-title">‚ö†Ô∏è Registry Indicators of Compromise</div>
                    <div class="info-box-content">
                        <ul>
                            <li>New or modified Run/RunOnce entries pointing to suspicious locations</li>
                            <li>Services with unusual ImagePath values</li>
                            <li>Registry keys with random or gibberish names</li>
                            <li>Modifications to security-critical keys (SafeBoot, Image File Execution Options)</li>
                            <li>Creation of keys in uncommon persistence locations</li>
                            <li>Registry values containing Base64 or encoded data</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 5: Network Behavior -->
        <section class="section" data-section="5">
            <div class="section-number">SECTION 05</div>
            <h2 class="section-title">
                <span class="section-icon">üåê</span>
                Network Behavior
            </h2>
            <div class="section-content">
                <p>
                    Network activity is the lifeline of modern malware. Command and Control (C2) communications,
                    data exfiltration, and lateral movement all leave distinct network signatures.
                </p>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">C2 Communication Patterns</h3>

                <div class="visualization">
                    <div class="viz-header">
                        <div class="viz-title">Network Timeline: C2 Beaconing Pattern</div>
                        <div class="viz-controls">
                            <button class="viz-btn active" onclick="animateBeacons()">Start Animation</button>
                            <button class="viz-btn" onclick="stopBeacons()">Stop</button>
                        </div>
                    </div>
                    <div class="network-timeline">
                        <div class="timeline-axis"></div>
                        <div class="timeline-events" id="timelineEvents">
                            <div class="timeline-event">
                                <div class="event-marker beacon"></div>
                                <div class="event-info">
                                    <div class="event-time">T+0s</div>
                                    <div class="event-desc">Initial Beacon</div>
                                </div>
                            </div>
                            <div class="timeline-event">
                                <div class="event-marker dns"></div>
                                <div class="event-info">
                                    <div class="event-time">T+2s</div>
                                    <div class="event-desc">DNS Query (C2 Domain)</div>
                                </div>
                            </div>
                            <div class="timeline-event">
                                <div class="event-marker http"></div>
                                <div class="event-info">
                                    <div class="event-time">T+5s</div>
                                    <div class="event-desc">HTTPS POST (Encrypted)</div>
                                </div>
                            </div>
                            <div class="timeline-event">
                                <div class="event-marker beacon"></div>
                                <div class="event-info">
                                    <div class="event-time">T+10s</div>
                                    <div class="event-desc">Heartbeat Beacon</div>
                                </div>
                            </div>
                            <div class="timeline-event">
                                <div class="event-marker beacon"></div>
                                <div class="event-info">
                                    <div class="event-time">T+20s</div>
                                    <div class="event-desc">Heartbeat Beacon</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <ul style="margin: 30px 0;">
                    <li><strong>Beaconing:</strong> Regular, periodic connections to C2 server (heartbeat pattern)</li>
                    <li><strong>DNS Tunneling:</strong> Exfiltrates data through DNS queries (subdomain encoding)</li>
                    <li><strong>HTTP/HTTPS:</strong> Disguises traffic as normal web browsing</li>
                    <li><strong>Custom Protocols:</strong> Uses non-standard ports or proprietary protocols</li>
                    <li><strong>Domain Generation Algorithms (DGA):</strong> Generates random domains for C2 resilience</li>
                </ul>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Network Indicators to Monitor</h3>
                <ul>
                    <li>Connections to unusual or newly-registered domains</li>
                    <li>Traffic on non-standard ports (not 80, 443, 53, etc.)</li>
                    <li>Excessive DNS queries or queries to suspicious domains</li>
                    <li>Large data transfers to external IPs</li>
                    <li>Use of encryption or encoding to obfuscate data</li>
                    <li>Connections initiated by unexpected processes</li>
                    <li>Lateral movement attempts (SMB, RDP, WMI to other internal hosts)</li>
                </ul>

                <div class="challenge-box">
                    <div class="challenge-header">
                        <span class="challenge-icon">üéØ</span>
                        <h3 class="challenge-title">Spot the Malicious Behavior</h3>
                    </div>
                    <p class="challenge-question">
                        You observe the following network activity. Which is MOST likely to be malicious C2 communication?
                    </p>
                    <div class="challenge-options">
                        <div class="challenge-option" data-answer="wrong" onclick="selectChallenge(this, 1)">
                            A) chrome.exe connecting to www.google.com:443 every 30 minutes
                        </div>
                        <div class="challenge-option" data-answer="correct" onclick="selectChallenge(this, 1)">
                            B) svchost.exe connecting to random-generated-domain.tk:8443 every 60 seconds with identical payload sizes
                        </div>
                        <div class="challenge-option" data-answer="wrong" onclick="selectChallenge(this, 1)">
                            C) outlook.exe connecting to mail.company.com:993 intermittently
                        </div>
                        <div class="challenge-option" data-answer="wrong" onclick="selectChallenge(this, 1)">
                            D) OneDrive.exe uploading files to onedrive.live.com:443
                        </div>
                    </div>
                    <div class="challenge-feedback" id="challenge1-feedback">
                        <div class="feedback-text">
                            <strong>Correct!</strong> This exhibits classic C2 beaconing behavior: regular intervals,
                            suspicious domain (.tk is a free TLD often used by malware), non-standard port (8443),
                            identical payload sizes, and svchost.exe (often abused) making external connections.
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 6: API Monitoring -->
        <section class="section" data-section="6">
            <div class="section-number">SECTION 06</div>
            <h2 class="section-title">
                <span class="section-icon">‚öôÔ∏è</span>
                API Monitoring
            </h2>
            <div class="section-content">
                <p>
                    Windows API calls are the building blocks of malware functionality. By monitoring API sequences,
                    we can identify malicious behavior patterns even in obfuscated or packed samples.
                </p>

                <div class="visualization">
                    <div class="viz-header">
                        <div class="viz-title">API Call Sequence: Process Injection Pattern</div>
                    </div>
                    <div class="api-flow">
                        <div class="api-sequence">
                            <div class="api-call safe" onclick="toggleApiInfo(this)">
                                <div class="api-number">1</div>
                                <div class="api-name">OpenProcess(PROCESS_ALL_ACCESS, ...)</div>
                                <div class="api-description">Opens target process with full access rights</div>
                            </div>
                            <div class="api-call warning" onclick="toggleApiInfo(this)">
                                <div class="api-number">2</div>
                                <div class="api-name">VirtualAllocEx(hProcess, NULL, size, MEM_COMMIT, PAGE_EXECUTE_READWRITE)</div>
                                <div class="api-description">Allocates executable memory in remote process</div>
                            </div>
                            <div class="api-call danger" onclick="toggleApiInfo(this)">
                                <div class="api-number">3</div>
                                <div class="api-name">WriteProcessMemory(hProcess, pRemoteBuffer, pMaliciousCode, ...)</div>
                                <div class="api-description">Writes malicious code into target process memory</div>
                            </div>
                            <div class="api-call danger" onclick="toggleApiInfo(this)">
                                <div class="api-number">4</div>
                                <div class="api-name">CreateRemoteThread(hProcess, NULL, 0, pRemoteBuffer, ...)</div>
                                <div class="api-description">Executes injected code in remote process</div>
                            </div>
                            <div class="api-call safe" onclick="toggleApiInfo(this)">
                                <div class="api-number">5</div>
                                <div class="api-name">CloseHandle(hProcess)</div>
                                <div class="api-description">Closes handle to target process</div>
                            </div>
                        </div>
                    </div>
                </div>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Key Windows APIs to Monitor</h3>

                <div class="comparison-grid">
                    <div class="comparison-card">
                        <h3>üîß Process Manipulation</h3>
                        <ul>
                            <li>CreateProcess / CreateProcessInternal</li>
                            <li>OpenProcess</li>
                            <li>VirtualAllocEx / VirtualProtectEx</li>
                            <li>WriteProcessMemory</li>
                            <li>CreateRemoteThread / NtQueueApcThread</li>
                        </ul>
                    </div>

                    <div class="comparison-card">
                        <h3>üìÅ File Operations</h3>
                        <ul>
                            <li>CreateFile / NtCreateFile</li>
                            <li>WriteFile / ReadFile</li>
                            <li>DeleteFile / MoveFile</li>
                            <li>FindFirstFile / FindNextFile</li>
                            <li>SetFileAttributes</li>
                        </ul>
                    </div>

                    <div class="comparison-card">
                        <h3>üóÇÔ∏è Registry Operations</h3>
                        <ul>
                            <li>RegCreateKeyEx / RegOpenKeyEx</li>
                            <li>RegSetValueEx / RegQueryValueEx</li>
                            <li>RegDeleteKey / RegDeleteValue</li>
                            <li>NtSetValueKey</li>
                        </ul>
                    </div>

                    <div class="comparison-card">
                        <h3>üåê Network Operations</h3>
                        <ul>
                            <li>InternetOpen / InternetConnect</li>
                            <li>HttpOpenRequest / HttpSendRequest</li>
                            <li>WSAStartup / socket / connect</li>
                            <li>send / recv</li>
                            <li>GetAddrInfo / DnsQuery</li>
                        </ul>
                    </div>
                </div>

                <h3 style="margin: 30px 0 15px; color: #b090c0; font-size: 1.2rem;">Malicious API Sequences</h3>
                <ul>
                    <li><strong>Credential Theft:</strong> OpenProcess(lsass.exe) ‚Üí ReadProcessMemory ‚Üí CreateFile(creds.txt)</li>
                    <li><strong>Keylogging:</strong> SetWindowsHookEx(WH_KEYBOARD_LL) ‚Üí GetAsyncKeyState ‚Üí WriteFile</li>
                    <li><strong>Ransomware:</strong> FindFirstFile ‚Üí CryptEncrypt ‚Üí WriteFile ‚Üí DeleteFile(original)</li>
                    <li><strong>Persistence:</strong> RegCreateKeyEx(Run) ‚Üí RegSetValueEx ‚Üí CloseHandle</li>
                    <li><strong>Anti-Analysis:</strong> CreateToolhelp32Snapshot ‚Üí Process32First ‚Üí TerminateProcess(procmon.exe)</li>
                </ul>

                <div class="challenge-box">
                    <div class="challenge-header">
                        <span class="challenge-icon">üéØ</span>
                        <h3 class="challenge-title">Identify the Attack Technique</h3>
                    </div>
                    <p class="challenge-question">
                        You observe this API call sequence. What attack is likely being performed?<br><br>
                        <code style="display: block; margin: 10px 0; padding: 10px; background: rgba(20,10,30,0.6); border-radius: 4px;">
                        1. CreateFile("C:\\Windows\\System32\\svchost.exe")<br>
                        2. CreateProcess(... CREATE_SUSPENDED ...)<br>
                        3. NtUnmapViewOfSection(hProcess, ...)<br>
                        4. VirtualAllocEx(hProcess, ...)<br>
                        5. WriteProcessMemory(hProcess, maliciousPayload, ...)<br>
                        6. SetThreadContext(hThread, ...)<br>
                        7. ResumeThread(hThread)
                        </code>
                    </p>
                    <div class="challenge-options">
                        <div class="challenge-option" data-answer="wrong" onclick="selectChallenge(this, 2)">
                            A) Standard DLL Injection
                        </div>
                        <div class="challenge-option" data-answer="correct" onclick="selectChallenge(this, 2)">
                            B) Process Hollowing (RunPE)
                        </div>
                        <div class="challenge-option" data-answer="wrong" onclick="selectChallenge(this, 2)">
                            C) APC Injection
                        </div>
                        <div class="challenge-option" data-answer="wrong" onclick="selectChallenge(this, 2)">
                            D) Reflective DLL Injection
                        </div>
                    </div>
                    <div class="challenge-feedback" id="challenge2-feedback">
                        <div class="feedback-text">
                            <strong>Correct!</strong> This is classic Process Hollowing (also called RunPE). The malware
                            creates a legitimate process (svchost.exe) in suspended state, unmaps its memory, allocates new memory,
                            writes malicious code, updates the thread context, and resumes execution. The result: a legitimate-looking
                            process executing malicious code.
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 7: Tools of the Trade -->
        <section class="section" data-section="7">
            <div class="section-number">SECTION 07</div>
            <h2 class="section-title">
                <span class="section-icon">üõ†Ô∏è</span>
                Tools of the Trade
            </h2>
            <div class="section-content">
                <p>
                    Effective behavioral analysis requires the right toolkit. These tools capture and present
                    the runtime behavior of malware in ways that reveal its true intentions.
                </p>

                <div class="tool-grid">
                    <div class="tool-card">
                        <div class="tool-icon">üìä</div>
                        <div class="tool-name">Process Monitor (Procmon)</div>
                        <div class="tool-description">
                            Real-time monitoring of file system, registry, and process/thread activity.
                            Essential for capturing comprehensive system events during malware execution.
                        </div>
                        <span class="tool-category">SYSTEM MONITORING</span>
                    </div>

                    <div class="tool-card">
                        <div class="tool-icon">üîç</div>
                        <div class="tool-name">Process Explorer (Procexp)</div>
                        <div class="tool-description">
                            Advanced task manager showing process trees, DLLs loaded, handles, and network connections.
                            Reveals hidden processes and suspicious parent-child relationships.
                        </div>
                        <span class="tool-category">PROCESS ANALYSIS</span>
                    </div>

                    <div class="tool-card">
                        <div class="tool-icon">üåê</div>
                        <div class="tool-name">Wireshark</div>
                        <div class="tool-description">
                            Network protocol analyzer capturing and inspecting packets. Decodes network traffic
                            to reveal C2 communication, data exfiltration, and lateral movement.
                        </div>
                        <span class="tool-category">NETWORK ANALYSIS</span>
                    </div>

                    <div class="tool-card">
                        <div class="tool-icon">üîê</div>
                        <div class="tool-name">Fiddler</div>
                        <div class="tool-description">
                            Web debugging proxy capturing HTTP/HTTPS traffic. Decrypts SSL/TLS to inspect
                            encrypted web communications from malware.
                        </div>
                        <span class="tool-category">WEB PROXY</span>
                    </div>

                    <div class="tool-card">
                        <div class="tool-icon">‚öôÔ∏è</div>
                        <div class="tool-name">API Monitor</div>
                        <div class="tool-description">
                            Monitors and displays API calls made by applications. Shows parameters, return values,
                            and call stacks‚Äîinvaluable for understanding malware behavior at the API level.
                        </div>
                        <span class="tool-category">API MONITORING</span>
                    </div>

                    <div class="tool-card">
                        <div class="tool-icon">üêõ</div>
                        <div class="tool-name">x64dbg / WinDbg</div>
                        <div class="tool-description">
                            Debuggers for examining code execution at the assembly level. Set breakpoints on API calls,
                            inspect memory, and step through malware logic.
                        </div>
                        <span class="tool-category">DEBUGGING</span>
                    </div>

                    <div class="tool-card">
                        <div class="tool-icon">üì¶</div>
                        <div class="tool-name">Any.Run</div>
                        <div class="tool-description">
                            Interactive online sandbox providing real-time analysis in an isolated environment.
                            Interact with malware while it runs, observe behavior, and download detailed reports.
                        </div>
                        <span class="tool-category">CLOUD SANDBOX</span>
                    </div>

                    <div class="tool-card">
                        <div class="tool-icon">üî¨</div>
                        <div class="tool-name">Joe Sandbox</div>
                        <div class="tool-description">
                            Advanced automated malware analysis platform. Executes samples in multiple environments,
                            generates comprehensive reports with behavioral indicators and MITRE ATT&CK mappings.
                        </div>
                        <span class="tool-category">AUTOMATED SANDBOX</span>
                    </div>

                    <div class="tool-card">
                        <div class="tool-icon">üß¨</div>
                        <div class="tool-name">Cuckoo Sandbox</div>
                        <div class="tool-description">
                            Open-source automated malware analysis system. Deploy locally for full control,
                            customizable analysis modules, and integration with your workflow.
                        </div>
                        <span class="tool-category">OPEN SOURCE SANDBOX</span>
                    </div>

                    <div class="tool-card">
                        <div class="tool-icon">üìù</div>
                        <div class="tool-name">Regshot</div>
                        <div class="tool-description">
                            Registry snapshot comparison tool. Take before/after snapshots to identify exactly
                            what registry changes malware made during execution.
                        </div>
                        <span class="tool-category">REGISTRY ANALYSIS</span>
                    </div>

                    <div class="tool-card">
                        <div class="tool-icon">üîå</div>
                        <div class="tool-name">FakeNet-NG</div>
                        <div class="tool-description">
                            Network simulation tool emulating DNS, HTTP, FTP servers, etc. Intercepts and logs
                            malware network requests without allowing actual C2 communication.
                        </div>
                        <span class="tool-category">NETWORK SIMULATION</span>
                    </div>

                    <div class="tool-card">
                        <div class="tool-icon">üíâ</div>
                        <div class="tool-name">Noriben</div>
                        <div class="tool-description">
                            Automated Process Monitor wrapper that runs Procmon, executes malware, filters results,
                            and generates a clean report of malware activity.
                        </div>
                        <span class="tool-category">AUTOMATION</span>
                    </div>
                </div>

                <div class="info-box">
                    <div class="info-box-title">üí° Analysis Workflow Best Practices</div>
                    <div class="info-box-content">
                        <ol style="list-style-type: decimal; padding-left: 30px;">
                            <li style="margin-bottom: 10px;"><strong>Prepare Environment:</strong> Take VM snapshot, disable AV, configure monitoring tools</li>
                            <li style="margin-bottom: 10px;"><strong>Start Monitoring:</strong> Launch Process Monitor, Wireshark, API Monitor before executing malware</li>
                            <li style="margin-bottom: 10px;"><strong>Execute Sample:</strong> Run malware and observe initial behavior</li>
                            <li style="margin-bottom: 10px;"><strong>Interact:</strong> Click through prompts, wait for time-delayed execution, simulate user activity</li>
                            <li style="margin-bottom: 10px;"><strong>Stop Monitoring:</strong> After sufficient observation, stop tools and save logs</li>
                            <li style="margin-bottom: 10px;"><strong>Analyze Results:</strong> Filter logs, correlate events, identify IOCs</li>
                            <li style="margin-bottom: 10px;"><strong>Document Findings:</strong> Create detailed report with screenshots, IOCs, and MITRE ATT&CK mapping</li>
                            <li style="margin-bottom: 10px;"><strong>Restore Environment:</strong> Revert VM to clean snapshot for next analysis</li>
                        </ol>
                    </div>
                </div>
            </div>
        </section>

        <!-- Completion Section -->
        <section class="completion-section">
            <div class="completion-icon">üéì</div>
            <h2 class="completion-title">Module Complete</h2>
            <p class="completion-text">
                You've mastered the fundamentals of behavioral analysis. You can now observe malware in motion,
                identify malicious patterns across processes, files, registry, network, and API calls,
                and use industry-standard tools to dissect sophisticated threats.
            </p>
            <a href="../index.html" class="completion-btn" onclick="markModuleComplete()">
                <span>Return to Vault</span>
                <span>‚úì</span>
            </a>
        </section>
    </main>

    <script>
        // ============================================
        // SCROLL ANIMATION
        // ============================================
        function initScrollAnimation() {
            const sections = document.querySelectorAll('.section');
            const observerOptions = {
                threshold: 0.15,
                rootMargin: '0px 0px -100px 0px'
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        updateProgress();
                    }
                });
            }, observerOptions);

            sections.forEach(section => observer.observe(section));
        }

        // ============================================
        // PROGRESS TRACKING
        // ============================================
        function updateProgress() {
            const sections = document.querySelectorAll('.section');
            const visibleSections = document.querySelectorAll('.section.visible');
            const progress = (visibleSections.length / sections.length) * 100;

            const progressFill = document.getElementById('progressFill');
            if (progressFill) {
                progressFill.style.width = progress + '%';
            }
        }

        // ============================================
        // PROCESS TREE VISUALIZATION
        // ============================================
        const processTrees = {
            injection: `
<div class="process-node benign">
‚îú‚îÄ <span class="process-name">explorer.exe</span> <span class="process-pid">[PID: 1024]</span>
   <span class="process-path">C:\\Windows\\explorer.exe</span>
</div>
<div class="process-node suspicious" style="padding-left: 30px;">
   ‚îú‚îÄ <span class="process-name">malware.exe</span> <span class="process-pid">[PID: 2048]</span>
      <span class="process-path">C:\\Users\\Admin\\AppData\\Local\\Temp\\malware.exe</span>
</div>
<div class="process-node benign" style="padding-left: 60px;">
      ‚îú‚îÄ <span class="process-name">svchost.exe</span> <span class="process-pid">[PID: 3072]</span>
         <span class="process-path">C:\\Windows\\System32\\svchost.exe</span>
</div>
<div class="process-node malicious" style="padding-left: 90px;">
         ‚îî‚îÄ <span class="process-name">[INJECTED CODE]</span>
            <span class="process-path">DLL injected via CreateRemoteThread</span>
</div>`,
            hollowing: `
<div class="process-node benign">
‚îú‚îÄ <span class="process-name">explorer.exe</span> <span class="process-pid">[PID: 1024]</span>
   <span class="process-path">C:\\Windows\\explorer.exe</span>
</div>
<div class="process-node suspicious" style="padding-left: 30px;">
   ‚îú‚îÄ <span class="process-name">dropper.exe</span> <span class="process-pid">[PID: 2048]</span>
      <span class="process-path">C:\\Users\\Admin\\Downloads\\invoice.exe</span>
</div>
<div class="process-node malicious" style="padding-left: 60px;">
      ‚îî‚îÄ <span class="process-name">RegAsm.exe</span> <span class="process-pid">[PID: 3072]</span> <span style="color: #9a5a5a;">[HOLLOWED]</span>
         <span class="process-path">Created suspended, memory replaced, resumed with malicious code</span>
</div>`,
            apc: `
<div class="process-node benign">
‚îú‚îÄ <span class="process-name">services.exe</span> <span class="process-pid">[PID: 512]</span>
   <span class="process-path">C:\\Windows\\System32\\services.exe</span>
</div>
<div class="process-node benign" style="padding-left: 30px;">
   ‚îú‚îÄ <span class="process-name">svchost.exe</span> <span class="process-pid">[PID: 1024]</span>
      <span class="process-path">C:\\Windows\\System32\\svchost.exe -k netsvcs</span>
</div>
<div class="process-node suspicious" style="padding-left: 30px;">
   ‚îú‚îÄ <span class="process-name">malicious_service.exe</span> <span class="process-pid">[PID: 2048]</span>
      <span class="process-path">C:\\ProgramData\\SystemServices\\service.exe</span>
</div>
<div class="process-node malicious" style="padding-left: 60px;">
      ‚îî‚îÄ <span class="process-name">[APC Queue]</span>
         <span class="process-path">Code queued to svchost.exe thread via NtQueueApcThread</span>
</div>`
        };

        function showProcessTree(type) {
            const treeContainer = document.getElementById('processTree');
            if (treeContainer) {
                treeContainer.innerHTML = processTrees[type];
            }

            // Update active button
            document.querySelectorAll('.viz-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        // Initialize with injection tree
        document.addEventListener('DOMContentLoaded', () => {
            showProcessTree('injection');
        });

        // ============================================
        // NETWORK BEACON ANIMATION
        // ============================================
        let beaconInterval;

        function animateBeacons() {
            const events = document.querySelectorAll('.timeline-event .event-marker.beacon');
            let index = 0;

            clearInterval(beaconInterval);
            beaconInterval = setInterval(() => {
                events.forEach(e => e.style.transform = 'translate(-50%, -50%) scale(1)');
                if (events[index]) {
                    events[index].style.transform = 'translate(-50%, -50%) scale(1.5)';
                    index = (index + 1) % events.length;
                }
            }, 1000);
        }

        function stopBeacons() {
            clearInterval(beaconInterval);
            document.querySelectorAll('.timeline-event .event-marker').forEach(e => {
                e.style.transform = 'translate(-50%, -50%) scale(1)';
            });
        }

        // ============================================
        // API INFO TOGGLE
        // ============================================
        function toggleApiInfo(element) {
            const description = element.querySelector('.api-description');
            if (description) {
                description.style.display = description.style.display === 'none' ? 'block' : 'none';
            }
        }

        // ============================================
        // CHALLENGE INTERACTIONS
        // ============================================
        function selectChallenge(element, challengeNum) {
            const options = element.parentElement.querySelectorAll('.challenge-option');
            const feedback = document.getElementById(`challenge${challengeNum}-feedback`);
            const isCorrect = element.dataset.answer === 'correct';

            // Remove previous selections
            options.forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
            });

            // Mark selected and show result
            element.classList.add('selected');
            if (isCorrect) {
                element.classList.add('correct');
                feedback.classList.add('show');
            } else {
                element.classList.add('incorrect');
                feedback.classList.remove('show');

                // Show correct answer after 1 second
                setTimeout(() => {
                    options.forEach(opt => {
                        if (opt.dataset.answer === 'correct') {
                            opt.classList.add('correct');
                        }
                    });
                    feedback.classList.add('show');
                }, 1000);
            }
        }

        // ============================================
        // MODULE COMPLETION
        // ============================================
        function markModuleComplete() {
            const completedModules = JSON.parse(localStorage.getItem('vault_modules_complete') || '[]');
            if (!completedModules.includes('behavioral-analysis')) {
                completedModules.push('behavioral-analysis');
                localStorage.setItem('vault_modules_complete', JSON.stringify(completedModules));
                console.log('%c‚úì Behavioral Analysis Module Complete', 'color: #7aaa7a; font-size: 14px;');
            }
        }

        // ============================================
        // INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', () => {
            initScrollAnimation();

            // Console easter egg
            console.log('%cüé≠ Behavioral Analysis', 'color: #c0a0d0; font-size: 16px; font-weight: bold;');
            console.log('%cWatch what they do, not what they say.', 'color: #8a6a9a; font-size: 12px;');
        });
    </script>
<script src="../../../components/FluxCapacitor.js"></script>
</body>
</html>
