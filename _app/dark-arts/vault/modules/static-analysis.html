<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Access Control -->
    <script src="../../../components/AccessGuard.js"></script>
    <script>
        AccessGuard.require('dark-arts');
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Static Analysis 101 - The Dark Arts</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: #0a0508;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #c0a0d0;
            line-height: 1.7;
        }

        /* Header */
        .module-header {
            background: linear-gradient(180deg, rgba(60, 30, 80, 0.3) 0%, transparent 100%);
            border-bottom: 1px solid rgba(100, 60, 130, 0.2);
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .back-btn {
            background: rgba(80, 40, 100, 0.2);
            border: 1px solid rgba(100, 60, 130, 0.3);
            color: #9a7aaa;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(100, 60, 130, 0.3);
            border-color: rgba(120, 80, 150, 0.5);
        }

        .module-title {
            font-size: 1.1rem;
            color: #b090c0;
            letter-spacing: 0.1em;
        }

        .progress-bar {
            width: 200px;
            height: 6px;
            background: rgba(60, 30, 80, 0.3);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6a4a8a, #9a6aba);
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Main content */
        .module-content {
            max-width: 1000px;
            margin: 0 auto;
            padding: 40px;
        }

        /* Section styling */
        .section {
            margin-bottom: 60px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
        }

        .section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .section-number {
            font-size: 0.7rem;
            color: #6a4a7a;
            letter-spacing: 0.3em;
            margin-bottom: 10px;
        }

        .section-title {
            font-size: 1.8rem;
            color: #c0a0d0;
            margin-bottom: 20px;
            font-weight: 300;
        }

        .section-content {
            color: #a080b0;
            font-size: 1rem;
        }

        .section-content p {
            margin-bottom: 15px;
        }

        /* Concept cards */
        .concept-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .concept-card {
            background: rgba(40, 20, 60, 0.4);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 8px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .concept-card:hover {
            transform: translateY(-5px);
            border-color: rgba(120, 80, 150, 0.5);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .concept-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .concept-title {
            color: #b090c0;
            font-size: 1rem;
            margin-bottom: 10px;
        }

        .concept-desc {
            color: #8070a0;
            font-size: 0.85rem;
        }

        /* Interactive PE Viewer */
        .pe-viewer {
            background: rgba(15, 8, 20, 0.8);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 8px;
            margin: 30px 0;
            overflow: hidden;
        }

        .pe-header {
            background: rgba(60, 30, 80, 0.3);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(80, 50, 100, 0.2);
        }

        .pe-title {
            color: #9a7aaa;
            font-size: 0.85rem;
            font-family: 'Courier New', monospace;
        }

        .pe-tabs {
            display: flex;
            gap: 5px;
        }

        .pe-tab {
            padding: 6px 15px;
            background: rgba(40, 20, 60, 0.5);
            border: 1px solid rgba(80, 50, 100, 0.3);
            color: #8070a0;
            font-size: 0.75rem;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .pe-tab.active {
            background: rgba(100, 60, 130, 0.4);
            color: #c0a0d0;
            border-color: rgba(120, 80, 150, 0.5);
        }

        .pe-body {
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            min-height: 300px;
        }

        .pe-section {
            display: none;
        }

        .pe-section.active {
            display: block;
        }

        .hex-line {
            display: flex;
            margin-bottom: 5px;
        }

        .hex-offset {
            color: #6a4a7a;
            width: 80px;
        }

        .hex-bytes {
            color: #9a7aaa;
            flex: 1;
        }

        .hex-ascii {
            color: #7a9a7a;
            width: 150px;
            text-align: right;
        }

        .highlight {
            background: rgba(100, 60, 130, 0.4);
            padding: 2px 4px;
            border-radius: 2px;
        }

        .field-row {
            display: flex;
            padding: 8px 0;
            border-bottom: 1px solid rgba(60, 30, 80, 0.2);
        }

        .field-name {
            color: #7a5a8a;
            width: 200px;
        }

        .field-value {
            color: #a080c0;
            flex: 1;
        }

        .field-desc {
            color: #6a5a7a;
            font-size: 0.8rem;
            width: 300px;
        }

        /* Strings analyzer */
        .strings-box {
            background: rgba(15, 8, 20, 0.8);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 8px;
            margin: 30px 0;
            overflow: hidden;
        }

        .strings-header {
            background: rgba(60, 30, 80, 0.3);
            padding: 15px 20px;
            border-bottom: 1px solid rgba(80, 50, 100, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .strings-filter {
            display: flex;
            gap: 10px;
        }

        .filter-btn {
            padding: 5px 12px;
            background: rgba(40, 20, 60, 0.5);
            border: 1px solid rgba(80, 50, 100, 0.3);
            color: #8070a0;
            font-size: 0.7rem;
            cursor: pointer;
            border-radius: 3px;
            transition: all 0.3s ease;
        }

        .filter-btn.active {
            background: rgba(100, 60, 130, 0.4);
            color: #c0a0d0;
        }

        .strings-list {
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
        }

        .string-item {
            padding: 8px 12px;
            margin-bottom: 5px;
            background: rgba(30, 15, 40, 0.5);
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .string-item:hover {
            background: rgba(50, 25, 70, 0.5);
        }

        .string-text {
            color: #a090b0;
        }

        .string-type {
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 10px;
        }

        .type-url { background: rgba(100, 60, 60, 0.4); color: #d09090; }
        .type-registry { background: rgba(60, 100, 60, 0.4); color: #90d090; }
        .type-api { background: rgba(60, 60, 100, 0.4); color: #9090d0; }
        .type-file { background: rgba(100, 100, 60, 0.4); color: #d0d090; }
        .type-crypto { background: rgba(100, 60, 100, 0.4); color: #d090d0; }

        /* Entropy visualization */
        .entropy-viz {
            background: rgba(15, 8, 20, 0.8);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 8px;
            margin: 30px 0;
            padding: 25px;
        }

        .entropy-bar-container {
            display: flex;
            gap: 2px;
            height: 100px;
            align-items: flex-end;
            margin: 20px 0;
            padding: 10px;
            background: rgba(20, 10, 30, 0.5);
            border-radius: 4px;
        }

        .entropy-bar {
            flex: 1;
            background: linear-gradient(180deg, #9a6aba, #6a4a8a);
            border-radius: 2px 2px 0 0;
            transition: height 0.5s ease;
            position: relative;
        }

        .entropy-bar.high {
            background: linear-gradient(180deg, #ba6a6a, #8a4a4a);
        }

        .entropy-bar:hover::after {
            content: attr(data-section);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(30, 15, 40, 0.95);
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.7rem;
            white-space: nowrap;
            color: #c0a0d0;
        }

        .entropy-legend {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: #7a5a8a;
            margin-top: 10px;
        }

        .entropy-warning {
            background: rgba(100, 50, 50, 0.2);
            border: 1px solid rgba(150, 80, 80, 0.3);
            border-radius: 4px;
            padding: 15px;
            margin-top: 20px;
            color: #c09090;
            font-size: 0.9rem;
        }

        /* Import analysis */
        .imports-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .import-dll {
            background: rgba(25, 12, 35, 0.6);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 8px;
            overflow: hidden;
        }

        .dll-header {
            background: rgba(60, 30, 80, 0.3);
            padding: 12px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(80, 50, 100, 0.2);
        }

        .dll-name {
            color: #b090c0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .dll-count {
            color: #7a5a8a;
            font-size: 0.75rem;
        }

        .dll-functions {
            padding: 10px 15px;
            max-height: 200px;
            overflow-y: auto;
        }

        .function-item {
            padding: 6px 10px;
            margin-bottom: 4px;
            background: rgba(40, 20, 60, 0.3);
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            color: #9a8aaa;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .function-item:hover {
            background: rgba(60, 30, 80, 0.4);
            color: #c0a0d0;
        }

        .function-item.suspicious {
            border-left: 3px solid #ba6a6a;
        }

        /* MITRE mapping */
        .mitre-section {
            background: rgba(15, 8, 20, 0.8);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 8px;
            padding: 25px;
            margin: 30px 0;
        }

        .mitre-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .mitre-item {
            background: rgba(40, 20, 60, 0.4);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 6px;
            padding: 15px;
            transition: all 0.3s ease;
        }

        .mitre-item:hover {
            border-color: rgba(120, 80, 150, 0.5);
            transform: translateX(5px);
        }

        .mitre-id {
            color: #9a6aba;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            margin-bottom: 5px;
        }

        .mitre-name {
            color: #b090c0;
            font-size: 0.95rem;
            margin-bottom: 8px;
        }

        .mitre-evidence {
            color: #7a6a8a;
            font-size: 0.8rem;
        }

        /* Quiz section */
        .quiz-box {
            background: rgba(30, 15, 45, 0.6);
            border: 1px solid rgba(100, 60, 130, 0.3);
            border-radius: 8px;
            padding: 30px;
            margin: 30px 0;
        }

        .quiz-question {
            color: #c0a0d0;
            font-size: 1.1rem;
            margin-bottom: 20px;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quiz-option {
            padding: 15px 20px;
            background: rgba(40, 20, 60, 0.4);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 6px;
            color: #a090b0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-option:hover {
            background: rgba(60, 30, 80, 0.4);
            border-color: rgba(100, 60, 130, 0.5);
        }

        .quiz-option.correct {
            background: rgba(60, 100, 60, 0.3);
            border-color: rgba(80, 150, 80, 0.5);
            color: #a0d0a0;
        }

        .quiz-option.incorrect {
            background: rgba(100, 60, 60, 0.3);
            border-color: rgba(150, 80, 80, 0.5);
            color: #d0a0a0;
        }

        .quiz-feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 6px;
            display: none;
        }

        .quiz-feedback.show {
            display: block;
        }

        .quiz-feedback.correct {
            background: rgba(60, 100, 60, 0.2);
            border: 1px solid rgba(80, 150, 80, 0.3);
            color: #a0d0a0;
        }

        .quiz-feedback.incorrect {
            background: rgba(100, 60, 60, 0.2);
            border: 1px solid rgba(150, 80, 80, 0.3);
            color: #d0a0a0;
        }

        /* Navigation */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 60px;
            padding-top: 30px;
            border-top: 1px solid rgba(80, 50, 100, 0.2);
        }

        .nav-btn {
            padding: 15px 30px;
            background: rgba(60, 30, 80, 0.3);
            border: 1px solid rgba(100, 60, 130, 0.3);
            color: #9a7aaa;
            font-size: 0.9rem;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .nav-btn:hover {
            background: rgba(80, 40, 100, 0.4);
            border-color: rgba(120, 80, 150, 0.5);
            color: #c0a0d0;
        }

        .nav-btn.primary {
            background: linear-gradient(135deg, rgba(80, 40, 100, 0.5), rgba(100, 60, 130, 0.4));
        }

        /* Callout boxes */
        .callout {
            padding: 20px;
            border-radius: 6px;
            margin: 20px 0;
        }

        .callout.warning {
            background: rgba(100, 80, 40, 0.2);
            border-left: 4px solid #c0a060;
            color: #d0c090;
        }

        .callout.info {
            background: rgba(40, 60, 100, 0.2);
            border-left: 4px solid #6090c0;
            color: #90b0d0;
        }

        .callout.tip {
            background: rgba(40, 100, 60, 0.2);
            border-left: 4px solid #60c080;
            color: #90d0a0;
        }

        /* Code blocks */
        code {
            background: rgba(40, 20, 60, 0.5);
            padding: 2px 8px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: #c0a0d0;
        }

        pre {
            background: rgba(20, 10, 30, 0.8);
            padding: 20px;
            border-radius: 6px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            color: #a090b0;
            margin: 20px 0;
        }

        /* Completion section */
        .completion-section {
            text-align: center;
            padding: 60px 40px;
            background: linear-gradient(180deg, transparent, rgba(60, 30, 80, 0.1));
            border-radius: 8px;
            margin-top: 60px;
        }

        .completion-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .completion-title {
            font-size: 1.8rem;
            color: #c0a0d0;
            margin-bottom: 15px;
        }

        .completion-text {
            color: #9080a0;
            margin-bottom: 30px;
        }

        .completion-btn {
            display: inline-block;
            padding: 15px 40px;
            background: linear-gradient(135deg, rgba(80, 40, 100, 0.6), rgba(100, 60, 130, 0.5));
            border: 1px solid rgba(120, 80, 150, 0.5);
            color: #c0a0d0;
            font-size: 1rem;
            cursor: pointer;
            border-radius: 6px;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .completion-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(100, 50, 150, 0.3);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(20, 10, 30, 0.5);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(80, 50, 100, 0.5);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(100, 60, 130, 0.6);
        }
    </style>
</head>
<body>
    <header class="module-header">
        <div class="header-left">
            <a href="../index.html" class="back-btn">&larr; Back to Vault</a>
            <span class="module-title">Static Analysis 101</span>
        </div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
    </header>

    <main class="module-content">
        <!-- Section 1: Introduction -->
        <section class="section" id="section1">
            <div class="section-number">SECTION 01</div>
            <h2 class="section-title">What is Static Analysis?</h2>
            <div class="section-content">
                <p>Static analysis is the process of examining malware <strong>without executing it</strong>. Think of it like examining a suspicious package without opening it - you can learn a lot from the outside before deciding to interact with it.</p>

                <p>This approach is crucial because:</p>

                <div class="concept-grid">
                    <div class="concept-card">
                        <div class="concept-icon">üõ°Ô∏è</div>
                        <div class="concept-title">Safe</div>
                        <div class="concept-desc">No risk of infection since the malware never runs</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">‚ö°</div>
                        <div class="concept-title">Fast</div>
                        <div class="concept-desc">Quick triage to determine threat level</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">üîç</div>
                        <div class="concept-title">Thorough</div>
                        <div class="concept-desc">Reveals hidden code that may not execute</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">üìä</div>
                        <div class="concept-title">Scalable</div>
                        <div class="concept-desc">Can be automated for large sample sets</div>
                    </div>
                </div>

                <div class="callout warning">
                    <strong>Remember:</strong> Static analysis shows you what a sample <em>could</em> do, not necessarily what it <em>will</em> do. Some code paths may never execute, and some functionality may be hidden through obfuscation.
                </div>
            </div>
        </section>

        <!-- Section 2: PE File Structure -->
        <section class="section" id="section2">
            <div class="section-number">SECTION 02</div>
            <h2 class="section-title">PE File Structure</h2>
            <div class="section-content">
                <p>Windows executables use the <strong>Portable Executable (PE)</strong> format. Understanding this structure is fundamental to malware analysis.</p>

                <div class="pe-viewer">
                    <div class="pe-header">
                        <span class="pe-title">sample.exe - PE Viewer</span>
                        <div class="pe-tabs">
                            <button class="pe-tab active" onclick="showPESection('dos')">DOS Header</button>
                            <button class="pe-tab" onclick="showPESection('pe')">PE Header</button>
                            <button class="pe-tab" onclick="showPESection('sections')">Sections</button>
                            <button class="pe-tab" onclick="showPESection('hex')">Hex View</button>
                        </div>
                    </div>
                    <div class="pe-body">
                        <div class="pe-section active" id="pe-dos">
                            <div class="field-row">
                                <span class="field-name">e_magic</span>
                                <span class="field-value"><span class="highlight">0x5A4D</span> ("MZ")</span>
                                <span class="field-desc">DOS signature - every PE starts with this</span>
                            </div>
                            <div class="field-row">
                                <span class="field-name">e_lfanew</span>
                                <span class="field-value">0x00000080</span>
                                <span class="field-desc">Offset to PE header</span>
                            </div>
                            <div class="callout tip" style="margin-top: 20px;">
                                <strong>Quick Check:</strong> If a file doesn't start with "MZ", it's not a valid Windows executable.
                            </div>
                        </div>
                        <div class="pe-section" id="pe-pe">
                            <div class="field-row">
                                <span class="field-name">Signature</span>
                                <span class="field-value"><span class="highlight">0x00004550</span> ("PE\0\0")</span>
                                <span class="field-desc">PE signature</span>
                            </div>
                            <div class="field-row">
                                <span class="field-name">Machine</span>
                                <span class="field-value">0x8664 (AMD64)</span>
                                <span class="field-desc">Target architecture</span>
                            </div>
                            <div class="field-row">
                                <span class="field-name">TimeDateStamp</span>
                                <span class="field-value">0x5F8A2B3C</span>
                                <span class="field-desc">Compilation time (can be faked)</span>
                            </div>
                            <div class="field-row">
                                <span class="field-name">Characteristics</span>
                                <span class="field-value">0x0022</span>
                                <span class="field-desc">EXECUTABLE_IMAGE | LARGE_ADDRESS_AWARE</span>
                            </div>
                        </div>
                        <div class="pe-section" id="pe-sections">
                            <div class="field-row">
                                <span class="field-name">.text</span>
                                <span class="field-value">VirtualSize: 0x1A00, RawSize: 0x1C00</span>
                                <span class="field-desc">Executable code</span>
                            </div>
                            <div class="field-row">
                                <span class="field-name">.rdata</span>
                                <span class="field-value">VirtualSize: 0x0800, RawSize: 0x0A00</span>
                                <span class="field-desc">Read-only data, imports</span>
                            </div>
                            <div class="field-row">
                                <span class="field-name">.data</span>
                                <span class="field-value">VirtualSize: 0x0400, RawSize: 0x0200</span>
                                <span class="field-desc">Initialized data</span>
                            </div>
                            <div class="field-row" style="color: #c09090;">
                                <span class="field-name">.enigma</span>
                                <span class="field-value">VirtualSize: 0x2000, RawSize: 0x2000</span>
                                <span class="field-desc">‚ö†Ô∏è Suspicious - non-standard section</span>
                            </div>
                        </div>
                        <div class="pe-section" id="pe-hex">
                            <div class="hex-line">
                                <span class="hex-offset">00000000</span>
                                <span class="hex-bytes"><span class="highlight">4D 5A</span> 90 00 03 00 00 00 04 00 00 00 FF FF 00 00</span>
                                <span class="hex-ascii">MZ..............</span>
                            </div>
                            <div class="hex-line">
                                <span class="hex-offset">00000010</span>
                                <span class="hex-bytes">B8 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00</span>
                                <span class="hex-ascii">........@.......</span>
                            </div>
                            <div class="hex-line">
                                <span class="hex-offset">00000080</span>
                                <span class="hex-bytes"><span class="highlight">50 45</span> 00 00 64 86 06 00 3C 2B 8A 5F 00 00 00 00</span>
                                <span class="hex-ascii">PE..d...<+._.....</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="callout info">
                    <strong>Red Flags in PE Headers:</strong>
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li>Non-standard section names (.enigma, .packed, .UPX)</li>
                        <li>Section with write + execute permissions</li>
                        <li>Very old or very recent timestamps</li>
                        <li>Mismatched virtual and raw sizes</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Section 3: Strings Analysis -->
        <section class="section" id="section3">
            <div class="section-number">SECTION 03</div>
            <h2 class="section-title">Strings Analysis</h2>
            <div class="section-content">
                <p>Extracting strings from a binary can reveal valuable intelligence: URLs, file paths, registry keys, error messages, and API names that hint at the malware's capabilities.</p>

                <div class="strings-box">
                    <div class="strings-header">
                        <span style="color: #9a7aaa; font-size: 0.85rem;">Extracted Strings (156 found)</span>
                        <div class="strings-filter">
                            <button class="filter-btn active" onclick="filterStrings('all')">All</button>
                            <button class="filter-btn" onclick="filterStrings('url')">URLs</button>
                            <button class="filter-btn" onclick="filterStrings('registry')">Registry</button>
                            <button class="filter-btn" onclick="filterStrings('api')">APIs</button>
                            <button class="filter-btn" onclick="filterStrings('file')">Files</button>
                        </div>
                    </div>
                    <div class="strings-list" id="stringsList">
                        <div class="string-item" data-type="url">
                            <span class="string-text">http://185.234.xx.xx/gate.php</span>
                            <span class="string-type type-url">URL</span>
                        </div>
                        <div class="string-item" data-type="url">
                            <span class="string-text">https://pastebin.com/raw/XXXXXX</span>
                            <span class="string-type type-url">URL</span>
                        </div>
                        <div class="string-item" data-type="registry">
                            <span class="string-text">SOFTWARE\Microsoft\Windows\CurrentVersion\Run</span>
                            <span class="string-type type-registry">REGISTRY</span>
                        </div>
                        <div class="string-item" data-type="registry">
                            <span class="string-text">SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer</span>
                            <span class="string-type type-registry">REGISTRY</span>
                        </div>
                        <div class="string-item" data-type="api">
                            <span class="string-text">VirtualAllocEx</span>
                            <span class="string-type type-api">API</span>
                        </div>
                        <div class="string-item" data-type="api">
                            <span class="string-text">WriteProcessMemory</span>
                            <span class="string-type type-api">API</span>
                        </div>
                        <div class="string-item" data-type="api">
                            <span class="string-text">CreateRemoteThread</span>
                            <span class="string-type type-api">API</span>
                        </div>
                        <div class="string-item" data-type="file">
                            <span class="string-text">%APPDATA%\Microsoft\svchost.exe</span>
                            <span class="string-type type-file">FILE</span>
                        </div>
                        <div class="string-item" data-type="file">
                            <span class="string-text">C:\Windows\Temp\payload.dll</span>
                            <span class="string-type type-file">FILE</span>
                        </div>
                        <div class="string-item" data-type="crypto">
                            <span class="string-text">CryptEncrypt</span>
                            <span class="string-type type-crypto">CRYPTO</span>
                        </div>
                        <div class="string-item" data-type="crypto">
                            <span class="string-text">-----BEGIN RSA PUBLIC KEY-----</span>
                            <span class="string-type type-crypto">CRYPTO</span>
                        </div>
                    </div>
                </div>

                <div class="callout warning">
                    <strong>Interpreting Strings:</strong> The combination of <code>VirtualAllocEx</code> + <code>WriteProcessMemory</code> + <code>CreateRemoteThread</code> is a classic indicator of <strong>process injection</strong> - a technique to hide malicious code in legitimate processes.
                </div>
            </div>
        </section>

        <!-- Section 4: Entropy Analysis -->
        <section class="section" id="section4">
            <div class="section-number">SECTION 04</div>
            <h2 class="section-title">Entropy Analysis</h2>
            <div class="section-content">
                <p><strong>Entropy</strong> measures the randomness of data. High entropy (close to 8.0) indicates encrypted or compressed data, which is often a sign of packed malware trying to evade detection.</p>

                <div class="entropy-viz">
                    <h3 style="color: #9a7aaa; font-size: 0.9rem; margin-bottom: 15px;">Section Entropy Analysis</h3>
                    <div class="entropy-bar-container">
                        <div class="entropy-bar" style="height: 65%;" data-section=".text (5.2)"></div>
                        <div class="entropy-bar" style="height: 45%;" data-section=".rdata (3.6)"></div>
                        <div class="entropy-bar" style="height: 30%;" data-section=".data (2.4)"></div>
                        <div class="entropy-bar high" style="height: 95%;" data-section=".enigma (7.6) ‚ö†Ô∏è"></div>
                        <div class="entropy-bar" style="height: 20%;" data-section=".rsrc (1.6)"></div>
                    </div>
                    <div class="entropy-legend">
                        <span>0.0 (Uniform)</span>
                        <span>4.0 (Normal code)</span>
                        <span>8.0 (Random/Encrypted)</span>
                    </div>

                    <div class="entropy-warning">
                        <strong>‚ö†Ô∏è High Entropy Detected:</strong> The <code>.enigma</code> section has entropy of 7.6, strongly suggesting encrypted or compressed content. This sample is likely packed.
                    </div>
                </div>

                <div class="concept-grid" style="grid-template-columns: repeat(3, 1fr);">
                    <div class="concept-card">
                        <div class="concept-icon">üìÑ</div>
                        <div class="concept-title">Low (0-3)</div>
                        <div class="concept-desc">Plain text, resources, sparse data</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">‚öôÔ∏è</div>
                        <div class="concept-title">Normal (4-6)</div>
                        <div class="concept-desc">Compiled code, typical executable</div>
                    </div>
                    <div class="concept-card" style="border-color: rgba(150, 80, 80, 0.5);">
                        <div class="concept-icon">üîê</div>
                        <div class="concept-title">High (7-8)</div>
                        <div class="concept-desc">Encrypted, compressed, or packed</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 5: Import Analysis -->
        <section class="section" id="section5">
            <div class="section-number">SECTION 05</div>
            <h2 class="section-title">Import Analysis</h2>
            <div class="section-content">
                <p>The Import Address Table (IAT) lists all external functions the executable uses. Certain API combinations are strong indicators of malicious behavior.</p>

                <div class="imports-grid">
                    <div class="import-dll">
                        <div class="dll-header">
                            <span class="dll-name">kernel32.dll</span>
                            <span class="dll-count">12 functions</span>
                        </div>
                        <div class="dll-functions">
                            <div class="function-item">CreateFileW</div>
                            <div class="function-item">ReadFile</div>
                            <div class="function-item">WriteFile</div>
                            <div class="function-item suspicious">VirtualAllocEx</div>
                            <div class="function-item suspicious">WriteProcessMemory</div>
                            <div class="function-item suspicious">CreateRemoteThread</div>
                            <div class="function-item">GetProcAddress</div>
                            <div class="function-item">LoadLibraryA</div>
                        </div>
                    </div>
                    <div class="import-dll">
                        <div class="dll-header">
                            <span class="dll-name">advapi32.dll</span>
                            <span class="dll-count">6 functions</span>
                        </div>
                        <div class="dll-functions">
                            <div class="function-item suspicious">RegSetValueExW</div>
                            <div class="function-item">RegOpenKeyExW</div>
                            <div class="function-item">RegCloseKey</div>
                            <div class="function-item suspicious">OpenProcessToken</div>
                            <div class="function-item suspicious">AdjustTokenPrivileges</div>
                            <div class="function-item">LookupPrivilegeValueW</div>
                        </div>
                    </div>
                    <div class="import-dll">
                        <div class="dll-header">
                            <span class="dll-name">ws2_32.dll</span>
                            <span class="dll-count">5 functions</span>
                        </div>
                        <div class="dll-functions">
                            <div class="function-item">WSAStartup</div>
                            <div class="function-item">socket</div>
                            <div class="function-item">connect</div>
                            <div class="function-item">send</div>
                            <div class="function-item">recv</div>
                        </div>
                    </div>
                </div>

                <div class="mitre-section">
                    <h3 style="color: #9a7aaa; font-size: 1rem; margin-bottom: 10px;">MITRE ATT&CK Mapping</h3>
                    <p style="color: #7a6a8a; font-size: 0.85rem;">Based on imported functions, this sample likely uses these techniques:</p>

                    <div class="mitre-grid">
                        <div class="mitre-item">
                            <div class="mitre-id">T1055.001</div>
                            <div class="mitre-name">Process Injection: DLL Injection</div>
                            <div class="mitre-evidence">Evidence: VirtualAllocEx, WriteProcessMemory, CreateRemoteThread</div>
                        </div>
                        <div class="mitre-item">
                            <div class="mitre-id">T1547.001</div>
                            <div class="mitre-name">Boot/Logon Autostart: Registry Run Keys</div>
                            <div class="mitre-evidence">Evidence: RegSetValueExW + Run key string</div>
                        </div>
                        <div class="mitre-item">
                            <div class="mitre-id">T1134.001</div>
                            <div class="mitre-name">Access Token Manipulation</div>
                            <div class="mitre-evidence">Evidence: OpenProcessToken, AdjustTokenPrivileges</div>
                        </div>
                        <div class="mitre-item">
                            <div class="mitre-id">T1071.001</div>
                            <div class="mitre-name">Application Layer Protocol: Web</div>
                            <div class="mitre-evidence">Evidence: ws2_32.dll imports + HTTP URLs</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 6: Knowledge Check -->
        <section class="section" id="section6">
            <div class="section-number">SECTION 06</div>
            <h2 class="section-title">Knowledge Check</h2>
            <div class="section-content">
                <div class="quiz-box" id="quiz1">
                    <div class="quiz-question">A PE section has entropy of 7.8. What does this most likely indicate?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="checkQuiz(1, this, false)">Normal compiled code</div>
                        <div class="quiz-option" onclick="checkQuiz(1, this, true)">Encrypted or packed content</div>
                        <div class="quiz-option" onclick="checkQuiz(1, this, false)">Plain text strings</div>
                        <div class="quiz-option" onclick="checkQuiz(1, this, false)">Image resources</div>
                    </div>
                    <div class="quiz-feedback" id="quiz1-feedback"></div>
                </div>

                <div class="quiz-box" id="quiz2">
                    <div class="quiz-question">Which API combination is a classic indicator of process injection?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="checkQuiz(2, this, false)">CreateFile, ReadFile, WriteFile</div>
                        <div class="quiz-option" onclick="checkQuiz(2, this, false)">RegOpenKey, RegSetValue, RegCloseKey</div>
                        <div class="quiz-option" onclick="checkQuiz(2, this, true)">VirtualAllocEx, WriteProcessMemory, CreateRemoteThread</div>
                        <div class="quiz-option" onclick="checkQuiz(2, this, false)">socket, connect, send, recv</div>
                    </div>
                    <div class="quiz-feedback" id="quiz2-feedback"></div>
                </div>

                <div class="quiz-box" id="quiz3">
                    <div class="quiz-question">What does "MZ" at the beginning of a file indicate?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="checkQuiz(3, this, false)">The file is a ZIP archive</div>
                        <div class="quiz-option" onclick="checkQuiz(3, this, true)">The file is a Windows executable (PE format)</div>
                        <div class="quiz-option" onclick="checkQuiz(3, this, false)">The file is encrypted</div>
                        <div class="quiz-option" onclick="checkQuiz(3, this, false)">The file is a PDF document</div>
                    </div>
                    <div class="quiz-feedback" id="quiz3-feedback"></div>
                </div>
            </div>
        </section>

        <!-- Completion -->
        <section class="completion-section" id="completion">
            <div class="completion-icon">üî¨</div>
            <h2 class="completion-title">Module Complete!</h2>
            <p class="completion-text">You've learned the fundamentals of static malware analysis. Continue to the next module to study real-world malware families.</p>
            <a href="malware-families.html" class="completion-btn">Next: Malware Families &rarr;</a>
        </section>

        <div class="nav-buttons">
            <a href="../index.html" class="nav-btn">&larr; Back to Vault</a>
            <a href="malware-families.html" class="nav-btn primary">Next Module &rarr;</a>
        </div>
    </main>

    <script>
        // Track progress
        let sectionsViewed = new Set();
        const totalSections = 6;

        // Intersection Observer for sections
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    const sectionNum = entry.target.id.replace('section', '');
                    if (sectionNum) {
                        sectionsViewed.add(sectionNum);
                        updateProgress();
                    }
                }
            });
        }, { threshold: 0.2 });

        document.querySelectorAll('.section').forEach(section => {
            observer.observe(section);
        });

        function updateProgress() {
            const progress = (sectionsViewed.size / totalSections) * 100;
            document.getElementById('progressFill').style.width = progress + '%';

            if (sectionsViewed.size === totalSections) {
                localStorage.setItem('vault_static_complete', 'true');
            }
        }

        // PE Viewer tabs
        function showPESection(section) {
            document.querySelectorAll('.pe-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.pe-section').forEach(sec => sec.classList.remove('active'));

            event.target.classList.add('active');
            document.getElementById('pe-' + section).classList.add('active');
        }

        // Strings filter
        function filterStrings(type) {
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            document.querySelectorAll('.string-item').forEach(item => {
                if (type === 'all' || item.dataset.type === type) {
                    item.style.display = 'flex';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        // Quiz handling
        const quizAnswered = {};

        function checkQuiz(quizNum, element, isCorrect) {
            if (quizAnswered[quizNum]) return;
            quizAnswered[quizNum] = true;

            const feedback = document.getElementById(`quiz${quizNum}-feedback`);
            const options = element.parentElement.querySelectorAll('.quiz-option');

            options.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });

            if (isCorrect) {
                element.classList.add('correct');
                feedback.className = 'quiz-feedback show correct';
                feedback.innerHTML = '‚úì Correct! Well done.';
            } else {
                element.classList.add('incorrect');
                feedback.className = 'quiz-feedback show incorrect';
                feedback.innerHTML = '‚úó Not quite. Review the section above for the answer.';

                // Highlight correct answer
                options.forEach(opt => {
                    if (opt.onclick.toString().includes('true')) {
                        opt.classList.add('correct');
                    }
                });
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Check if already completed
            if (localStorage.getItem('vault_static_complete')) {
                document.getElementById('progressFill').style.width = '100%';
            }
        });
    </script>
<script src="../../../components/FluxCapacitor.js"></script>
</body>
</html>
