<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Access Control -->
    <script src="../../../components/AccessGuard.js"></script>
    <script>
        AccessGuard.require('dark-arts');
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Analysis - The Dark Arts</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: #0a0508;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #c0a0d0;
            line-height: 1.7;
        }

        /* Header */
        .module-header {
            background: linear-gradient(180deg, rgba(60, 30, 80, 0.3) 0%, transparent 100%);
            border-bottom: 1px solid rgba(100, 60, 130, 0.2);
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .back-btn {
            background: rgba(80, 40, 100, 0.2);
            border: 1px solid rgba(100, 60, 130, 0.3);
            color: #9a7aaa;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(100, 60, 130, 0.3);
            border-color: rgba(120, 80, 150, 0.5);
        }

        .module-title {
            font-size: 1.1rem;
            color: #b090c0;
            letter-spacing: 0.1em;
        }

        .progress-bar {
            width: 200px;
            height: 6px;
            background: rgba(60, 30, 80, 0.3);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6a4a8a, #9a6aba);
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Main content */
        .module-content {
            max-width: 1000px;
            margin: 0 auto;
            padding: 40px;
        }

        /* Section styling */
        .section {
            margin-bottom: 60px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
        }

        .section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .section-number {
            font-size: 0.7rem;
            color: #6a4a7a;
            letter-spacing: 0.3em;
            margin-bottom: 10px;
        }

        .section-title {
            font-size: 1.8rem;
            color: #c0a0d0;
            margin-bottom: 20px;
            font-weight: 300;
        }

        .section-content {
            color: #a080b0;
            font-size: 1rem;
        }

        .section-content p {
            margin-bottom: 15px;
        }

        .section-content ul {
            margin-left: 25px;
            margin-bottom: 15px;
        }

        .section-content li {
            margin-bottom: 8px;
        }

        /* Concept cards */
        .concept-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .concept-card {
            background: rgba(40, 20, 60, 0.4);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 8px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .concept-card:hover {
            transform: translateY(-5px);
            border-color: rgba(120, 80, 150, 0.5);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .concept-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .concept-title {
            color: #b090c0;
            font-size: 1rem;
            margin-bottom: 10px;
        }

        .concept-desc {
            color: #8070a0;
            font-size: 0.85rem;
        }

        /* Interactive viewers */
        .interactive-box {
            background: rgba(15, 8, 20, 0.8);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 8px;
            margin: 30px 0;
            overflow: hidden;
        }

        .interactive-header {
            background: rgba(60, 30, 80, 0.3);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(80, 50, 100, 0.2);
        }

        .interactive-title {
            color: #9a7aaa;
            font-size: 0.85rem;
            font-family: 'Courier New', monospace;
        }

        .interactive-controls {
            display: flex;
            gap: 8px;
        }

        .control-btn {
            padding: 5px 12px;
            background: rgba(40, 20, 60, 0.5);
            border: 1px solid rgba(80, 50, 100, 0.3);
            color: #8070a0;
            font-size: 0.7rem;
            cursor: pointer;
            border-radius: 3px;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: rgba(60, 30, 80, 0.5);
            border-color: rgba(100, 60, 130, 0.5);
        }

        .control-btn.active {
            background: rgba(100, 60, 130, 0.4);
            color: #c0a0d0;
        }

        .interactive-body {
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            max-height: 400px;
            overflow-y: auto;
        }

        /* ProcMon viewer */
        .procmon-filter {
            background: rgba(30, 15, 40, 0.6);
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 15px;
        }

        .filter-row {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
        }

        .filter-row:last-child {
            margin-bottom: 0;
        }

        .filter-label {
            color: #9a8aaa;
            width: 100px;
        }

        .filter-input, .filter-select {
            flex: 1;
            padding: 6px 10px;
            background: rgba(20, 10, 30, 0.8);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 4px;
            color: #c0a0d0;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
        }

        .procmon-entry {
            display: grid;
            grid-template-columns: 80px 150px 200px 1fr 100px;
            gap: 10px;
            padding: 8px 10px;
            margin-bottom: 4px;
            background: rgba(30, 15, 40, 0.5);
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .procmon-entry:hover {
            background: rgba(40, 20, 60, 0.5);
        }

        .procmon-entry.hidden {
            display: none;
        }

        .entry-time {
            color: #7a6a8a;
        }

        .entry-process {
            color: #9a8aaa;
        }

        .entry-operation {
            color: #8a9aaa;
        }

        .entry-path {
            color: #a090b0;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .entry-result {
            text-align: right;
        }

        .result-success {
            color: #80c080;
        }

        .result-error {
            color: #c08080;
        }

        /* API trace viewer */
        .api-call {
            background: rgba(30, 15, 40, 0.5);
            border-left: 3px solid rgba(100, 60, 130, 0.5);
            padding: 12px 15px;
            margin-bottom: 10px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .api-call:hover {
            background: rgba(40, 20, 60, 0.5);
            border-left-color: rgba(150, 100, 180, 0.8);
        }

        .api-call.suspicious {
            border-left-color: rgba(180, 80, 80, 0.8);
            background: rgba(50, 20, 20, 0.3);
        }

        .api-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .api-name {
            color: #b090c0;
            font-weight: bold;
        }

        .api-category {
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 10px;
            background: rgba(60, 40, 80, 0.5);
            color: #9080a0;
        }

        .api-params {
            color: #8a8aaa;
            font-size: 0.8rem;
            margin-left: 15px;
        }

        .api-return {
            color: #7a9a7a;
            font-size: 0.8rem;
            margin-top: 5px;
        }

        /* Packet viewer */
        .packet {
            background: rgba(30, 15, 40, 0.5);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 4px;
            padding: 12px;
            margin-bottom: 10px;
        }

        .packet-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(60, 30, 80, 0.3);
        }

        .packet-number {
            color: #6a5a7a;
            font-size: 0.75rem;
        }

        .packet-protocol {
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .protocol-http {
            background: rgba(100, 80, 60, 0.4);
            color: #d0c090;
        }

        .protocol-tcp {
            background: rgba(60, 80, 100, 0.4);
            color: #90c0d0;
        }

        .protocol-dns {
            background: rgba(80, 60, 100, 0.4);
            color: #c090d0;
        }

        .packet-info {
            display: grid;
            grid-template-columns: 80px 1fr;
            gap: 8px 15px;
            font-size: 0.8rem;
        }

        .info-label {
            color: #7a6a8a;
        }

        .info-value {
            color: #a090b0;
        }

        /* Memory strings viewer */
        .memory-string {
            padding: 8px 12px;
            margin-bottom: 5px;
            background: rgba(30, 15, 40, 0.5);
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .memory-string:hover {
            background: rgba(50, 25, 70, 0.5);
        }

        .string-address {
            color: #6a5a7a;
            font-size: 0.75rem;
            width: 100px;
        }

        .string-content {
            flex: 1;
            color: #a090b0;
        }

        .string-tag {
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 10px;
        }

        .tag-url {
            background: rgba(100, 60, 60, 0.4);
            color: #d09090;
        }

        .tag-key {
            background: rgba(100, 100, 60, 0.4);
            color: #d0d090;
        }

        .tag-command {
            background: rgba(60, 100, 60, 0.4);
            color: #90d090;
        }

        /* Workflow diagram */
        .workflow-diagram {
            background: rgba(20, 10, 30, 0.8);
            padding: 30px;
            border-radius: 8px;
            margin: 30px 0;
        }

        .workflow-steps {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .workflow-step {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .step-number {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, rgba(100, 60, 130, 0.5), rgba(80, 40, 100, 0.5));
            border: 1px solid rgba(120, 80, 150, 0.5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #c0a0d0;
            font-weight: bold;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
            background: rgba(40, 20, 60, 0.3);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 6px;
            padding: 15px 20px;
        }

        .step-title {
            color: #b090c0;
            font-size: 1rem;
            margin-bottom: 5px;
        }

        .step-desc {
            color: #8070a0;
            font-size: 0.85rem;
        }

        /* Sandbox comparison */
        .sandbox-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .sandbox-card {
            background: rgba(25, 12, 35, 0.6);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 8px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .sandbox-card:hover {
            transform: translateY(-5px);
            border-color: rgba(120, 80, 150, 0.5);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .sandbox-header {
            background: rgba(60, 30, 80, 0.3);
            padding: 15px 20px;
            border-bottom: 1px solid rgba(80, 50, 100, 0.2);
        }

        .sandbox-name {
            color: #b090c0;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .sandbox-type {
            color: #7a6a8a;
            font-size: 0.75rem;
        }

        .sandbox-body {
            padding: 20px;
        }

        .sandbox-features {
            list-style: none;
            margin-bottom: 15px;
        }

        .sandbox-features li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(60, 30, 80, 0.2);
            color: #9080a0;
            font-size: 0.85rem;
        }

        .sandbox-features li:before {
            content: "‚úì ";
            color: #80c080;
            margin-right: 8px;
        }

        .sandbox-note {
            background: rgba(40, 20, 60, 0.3);
            padding: 10px 12px;
            border-radius: 4px;
            font-size: 0.8rem;
            color: #7a6a8a;
        }

        /* Mini-lab challenge */
        .challenge-box {
            background: rgba(30, 15, 45, 0.6);
            border: 1px solid rgba(100, 60, 130, 0.3);
            border-radius: 8px;
            padding: 30px;
            margin: 30px 0;
        }

        .challenge-title {
            color: #c0a0d0;
            font-size: 1.3rem;
            margin-bottom: 15px;
        }

        .challenge-scenario {
            background: rgba(20, 10, 30, 0.8);
            padding: 20px;
            border-radius: 6px;
            margin: 20px 0;
            border-left: 4px solid rgba(150, 100, 180, 0.6);
        }

        .challenge-question {
            color: #b090c0;
            margin-bottom: 15px;
        }

        .challenge-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .challenge-option {
            padding: 15px 20px;
            background: rgba(40, 20, 60, 0.4);
            border: 1px solid rgba(80, 50, 100, 0.3);
            border-radius: 6px;
            color: #a090b0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .challenge-option:hover {
            background: rgba(60, 30, 80, 0.4);
            border-color: rgba(100, 60, 130, 0.5);
        }

        .challenge-option.correct {
            background: rgba(60, 100, 60, 0.3);
            border-color: rgba(80, 150, 80, 0.5);
            color: #a0d0a0;
        }

        .challenge-option.incorrect {
            background: rgba(100, 60, 60, 0.3);
            border-color: rgba(150, 80, 80, 0.5);
            color: #d0a0a0;
        }

        .challenge-feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 6px;
            display: none;
        }

        .challenge-feedback.show {
            display: block;
        }

        .challenge-feedback.correct {
            background: rgba(60, 100, 60, 0.2);
            border: 1px solid rgba(80, 150, 80, 0.3);
            color: #a0d0a0;
        }

        .challenge-feedback.incorrect {
            background: rgba(100, 60, 60, 0.2);
            border: 1px solid rgba(150, 80, 80, 0.3);
            color: #d0a0a0;
        }

        /* Callout boxes */
        .callout {
            padding: 20px;
            border-radius: 6px;
            margin: 20px 0;
        }

        .callout.warning {
            background: rgba(100, 80, 40, 0.2);
            border-left: 4px solid #c0a060;
            color: #d0c090;
        }

        .callout.danger {
            background: rgba(100, 40, 40, 0.2);
            border-left: 4px solid #c06060;
            color: #d09090;
        }

        .callout.info {
            background: rgba(40, 60, 100, 0.2);
            border-left: 4px solid #6090c0;
            color: #90b0d0;
        }

        .callout.tip {
            background: rgba(40, 100, 60, 0.2);
            border-left: 4px solid #60c080;
            color: #90d0a0;
        }

        /* Code blocks */
        code {
            background: rgba(40, 20, 60, 0.5);
            padding: 2px 8px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: #c0a0d0;
        }

        pre {
            background: rgba(20, 10, 30, 0.8);
            padding: 20px;
            border-radius: 6px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            color: #a090b0;
            margin: 20px 0;
        }

        /* Navigation */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 60px;
            padding-top: 30px;
            border-top: 1px solid rgba(80, 50, 100, 0.2);
        }

        .nav-btn {
            padding: 15px 30px;
            background: rgba(60, 30, 80, 0.3);
            border: 1px solid rgba(100, 60, 130, 0.3);
            color: #9a7aaa;
            font-size: 0.9rem;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .nav-btn:hover {
            background: rgba(80, 40, 100, 0.4);
            border-color: rgba(120, 80, 150, 0.5);
            color: #c0a0d0;
        }

        .nav-btn.primary {
            background: linear-gradient(135deg, rgba(80, 40, 100, 0.5), rgba(100, 60, 130, 0.4));
        }

        /* Completion section */
        .completion-section {
            text-align: center;
            padding: 60px 40px;
            background: linear-gradient(180deg, transparent, rgba(60, 30, 80, 0.1));
            border-radius: 8px;
            margin-top: 60px;
        }

        .completion-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .completion-title {
            font-size: 1.8rem;
            color: #c0a0d0;
            margin-bottom: 15px;
        }

        .completion-text {
            color: #9080a0;
            margin-bottom: 30px;
        }

        .completion-btn {
            display: inline-block;
            padding: 15px 40px;
            background: linear-gradient(135deg, rgba(80, 40, 100, 0.6), rgba(100, 60, 130, 0.5));
            border: 1px solid rgba(120, 80, 150, 0.5);
            color: #c0a0d0;
            font-size: 1rem;
            cursor: pointer;
            border-radius: 6px;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .completion-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(100, 50, 150, 0.3);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(20, 10, 30, 0.5);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(80, 50, 100, 0.5);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(100, 60, 130, 0.6);
        }
    </style>
</head>
<body>
    <header class="module-header">
        <div class="header-left">
            <a href="../index.html" class="back-btn">&larr; Back to Vault</a>
            <span class="module-title">Dynamic Analysis</span>
        </div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
    </header>

    <main class="module-content">
        <!-- Section 1: What is Dynamic Analysis? -->
        <section class="section" id="section1">
            <div class="section-number">SECTION 01</div>
            <h2 class="section-title">What is Dynamic Analysis?</h2>
            <div class="section-content">
                <p>Dynamic analysis is the art of <strong>observing malware in action</strong>. Unlike static analysis where you examine the file without running it, dynamic analysis involves executing the sample in a controlled environment and watching what it does.</p>

                <p>Think of it like this: Static analysis is reading a cookbook, dynamic analysis is watching the chef cook.</p>

                <div class="concept-grid">
                    <div class="concept-card">
                        <div class="concept-icon">üëÅÔ∏è</div>
                        <div class="concept-title">Behavioral</div>
                        <div class="concept-desc">See what malware actually does, not what it claims</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">üîì</div>
                        <div class="concept-title">Defeats Obfuscation</div>
                        <div class="concept-desc">Packed code must unpack itself to run</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">üåê</div>
                        <div class="concept-title">Network Activity</div>
                        <div class="concept-desc">Capture C2 communications in real-time</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">‚è±Ô∏è</div>
                        <div class="concept-title">Time-Based</div>
                        <div class="concept-desc">Observe behaviors that trigger on conditions</div>
                    </div>
                </div>

                <h3 style="color: #b090c0; font-size: 1.1rem; margin: 30px 0 15px;">When to Use Dynamic vs Static</h3>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div style="background: rgba(60, 40, 80, 0.2); padding: 20px; border-radius: 6px;">
                        <h4 style="color: #9a7aaa; margin-bottom: 10px;">Use Static When:</h4>
                        <ul>
                            <li>Initial triage / quick assessment</li>
                            <li>Sample is heavily packed</li>
                            <li>You need to find all possible code paths</li>
                            <li>Sample won't run in your environment</li>
                        </ul>
                    </div>
                    <div style="background: rgba(40, 60, 80, 0.2); padding: 20px; border-radius: 6px;">
                        <h4 style="color: #7a9aaa; margin-bottom: 10px;">Use Dynamic When:</h4>
                        <ul>
                            <li>Need to see actual behavior</li>
                            <li>Investigating C2 infrastructure</li>
                            <li>Sample uses anti-analysis tricks</li>
                            <li>Time to understand < time to reverse</li>
                        </ul>
                    </div>
                </div>

                <div class="callout danger">
                    <strong>‚ö†Ô∏è CRITICAL WARNING:</strong> Dynamic analysis means running live malware. <strong>ALWAYS</strong> do this in an isolated VM with snapshots. One mistake can compromise your entire network. If you're unsure, use automated sandboxes instead.
                </div>
            </div>
        </section>

        <!-- Section 2: Setting Up Your Lab -->
        <section class="section" id="section2">
            <div class="section-number">SECTION 02</div>
            <h2 class="section-title">Setting Up Your Lab</h2>
            <div class="section-content">
                <p>Your analysis lab is your fortress. One mistake and malware escapes into your production network. Here's how to build a proper isolation environment:</p>

                <div class="concept-grid" style="grid-template-columns: repeat(2, 1fr);">
                    <div class="concept-card">
                        <div class="concept-icon">üì∏</div>
                        <div class="concept-title">VM Snapshots</div>
                        <div class="concept-desc">Take before every analysis. Revert immediately after.</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">üîå</div>
                        <div class="concept-title">Network Isolation</div>
                        <div class="concept-desc">Host-only network or completely disconnected</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">üåê</div>
                        <div class="concept-title">Fake Internet</div>
                        <div class="concept-desc">INetSim simulates common services</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">üéØ</div>
                        <div class="concept-title">Fake DNS</div>
                        <div class="concept-desc">FakeDNS catches all domain queries</div>
                    </div>
                </div>

                <h3 style="color: #b090c0; font-size: 1.1rem; margin: 30px 0 15px;">Essential Tools Setup</h3>

                <pre>
<span style="color: #8a9aaa;"># INetSim - Simulates internet services</span>
sudo apt install inetsim
sudo service inetsim start

<span style="color: #8a9aaa;"># Configure VM to use INetSim as DNS</span>
# Set DNS to your INetSim host IP (e.g., 192.168.56.1)

<span style="color: #8a9aaa;"># FakeDNS - Python alternative</span>
git clone https://github.com/Crypt0s/FakeDNS
cd FakeDNS
python fakedns.py -c fakedns.conf
</pre>

                <div class="callout tip">
                    <strong>Pro Tip:</strong> Create a "golden image" VM with all analysis tools pre-installed. Clone it for each analysis, run sample, then delete the clone. Never analyze directly on the golden image.
                </div>

                <h3 style="color: #b090c0; font-size: 1.1rem; margin: 30px 0 15px;">Network Isolation Methods</h3>

                <div style="background: rgba(20, 10, 30, 0.8); padding: 20px; border-radius: 6px;">
                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #9a8aaa; margin-bottom: 8px;">Host-Only Network (Recommended)</h4>
                        <p style="color: #8080a0; font-size: 0.9rem;">VM can talk to host machine only. Perfect for running INetSim on host and capturing traffic.</p>
                    </div>
                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #9a8aaa; margin-bottom: 8px;">Internal Network</h4>
                        <p style="color: #8080a0; font-size: 0.9rem;">Multiple VMs can talk to each other but not outside. Good for multi-machine infections.</p>
                    </div>
                    <div>
                        <h4 style="color: #9a8aaa; margin-bottom: 8px;">Completely Disconnected</h4>
                        <p style="color: #8080a0; font-size: 0.9rem;">No network at all. Safest but limits analysis of network behavior.</p>
                    </div>
                </div>

                <div class="callout warning">
                    <strong>Important:</strong> Sophisticated malware can detect VMs and alter behavior. Change MAC addresses, customize VM artifacts, and use bare-metal if analyzing advanced threats.
                </div>
            </div>
        </section>

        <!-- Section 3: Execution Monitoring -->
        <section class="section" id="section3">
            <div class="section-number">SECTION 03</div>
            <h2 class="section-title">Execution Monitoring with Process Monitor</h2>
            <div class="section-content">
                <p><strong>Process Monitor (ProcMon)</strong> is your window into everything happening on the system. Every file access, registry change, and process creation - all in real-time.</p>

                <div class="concept-grid" style="grid-template-columns: repeat(4, 1fr);">
                    <div class="concept-card">
                        <div class="concept-icon">üìÅ</div>
                        <div class="concept-title">File System</div>
                        <div class="concept-desc">CreateFile, WriteFile, DeleteFile</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">üóùÔ∏è</div>
                        <div class="concept-title">Registry</div>
                        <div class="concept-desc">RegSetValue, RegCreateKey</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">üåê</div>
                        <div class="concept-title">Network</div>
                        <div class="concept-desc">TCP/UDP connections</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">‚öôÔ∏è</div>
                        <div class="concept-title">Process</div>
                        <div class="concept-desc">CreateProcess, Thread creation</div>
                    </div>
                </div>

                <h3 style="color: #b090c0; font-size: 1.1rem; margin: 30px 0 15px;">Interactive ProcMon Filter Builder</h3>

                <div class="interactive-box">
                    <div class="interactive-header">
                        <span class="interactive-title">Process Monitor - Filter Configuration</span>
                        <div class="interactive-controls">
                            <button class="control-btn" onclick="applyProcMonFilter()">Apply Filter</button>
                            <button class="control-btn" onclick="clearProcMonFilter()">Clear</button>
                        </div>
                    </div>
                    <div class="interactive-body">
                        <div class="procmon-filter">
                            <div class="filter-row">
                                <span class="filter-label">Process Name:</span>
                                <input type="text" class="filter-input" id="filter-process" placeholder="e.g., malware.exe">
                            </div>
                            <div class="filter-row">
                                <span class="filter-label">Operation:</span>
                                <select class="filter-select" id="filter-operation">
                                    <option value="">All Operations</option>
                                    <option value="WriteFile">WriteFile</option>
                                    <option value="RegSetValue">RegSetValue</option>
                                    <option value="CreateFile">CreateFile</option>
                                    <option value="TCP Connect">TCP Connect</option>
                                </select>
                            </div>
                            <div class="filter-row">
                                <span class="filter-label">Result:</span>
                                <select class="filter-select" id="filter-result">
                                    <option value="">All Results</option>
                                    <option value="SUCCESS">SUCCESS only</option>
                                    <option value="ERROR">Errors only</option>
                                </select>
                            </div>
                        </div>

                        <div id="procmon-results">
                            <div class="procmon-entry" data-process="malware.exe" data-operation="CreateFile" data-result="SUCCESS">
                                <span class="entry-time">12:34:56</span>
                                <span class="entry-process">malware.exe</span>
                                <span class="entry-operation">CreateFile</span>
                                <span class="entry-path">C:\Users\victim\AppData\Roaming\updater.exe</span>
                                <span class="entry-result result-success">SUCCESS</span>
                            </div>
                            <div class="procmon-entry" data-process="malware.exe" data-operation="WriteFile" data-result="SUCCESS">
                                <span class="entry-time">12:34:57</span>
                                <span class="entry-process">malware.exe</span>
                                <span class="entry-operation">WriteFile</span>
                                <span class="entry-path">C:\Users\victim\AppData\Roaming\updater.exe</span>
                                <span class="entry-result result-success">SUCCESS</span>
                            </div>
                            <div class="procmon-entry" data-process="malware.exe" data-operation="RegSetValue" data-result="SUCCESS">
                                <span class="entry-time">12:34:58</span>
                                <span class="entry-process">malware.exe</span>
                                <span class="entry-operation">RegSetValue</span>
                                <span class="entry-path">HKCU\Software\Microsoft\Windows\CurrentVersion\Run\Updater</span>
                                <span class="entry-result result-success">SUCCESS</span>
                            </div>
                            <div class="procmon-entry" data-process="malware.exe" data-operation="TCP Connect" data-result="SUCCESS">
                                <span class="entry-time">12:34:59</span>
                                <span class="entry-process">malware.exe</span>
                                <span class="entry-operation">TCP Connect</span>
                                <span class="entry-path">185.234.219.45:8080</span>
                                <span class="entry-result result-success">SUCCESS</span>
                            </div>
                            <div class="procmon-entry" data-process="explorer.exe" data-operation="ReadFile" data-result="SUCCESS">
                                <span class="entry-time">12:35:00</span>
                                <span class="entry-process">explorer.exe</span>
                                <span class="entry-operation">ReadFile</span>
                                <span class="entry-path">C:\Windows\explorer.exe</span>
                                <span class="entry-result result-success">SUCCESS</span>
                            </div>
                            <div class="procmon-entry" data-process="malware.exe" data-operation="CreateFile" data-result="ERROR">
                                <span class="entry-time">12:35:01</span>
                                <span class="entry-process">malware.exe</span>
                                <span class="entry-operation">CreateFile</span>
                                <span class="entry-path">C:\Windows\System32\drivers\rootkit.sys</span>
                                <span class="entry-result result-error">ACCESS DENIED</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="callout tip">
                    <strong>First-Run Capture Technique:</strong> Start ProcMon BEFORE running the sample, then let it run for 30-60 seconds. Look for the initial burst of activity - that's usually the most revealing. Save the log before the noise becomes overwhelming.
                </div>

                <div class="callout info">
                    <strong>Key Indicators to Watch For:</strong>
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li><strong>Persistence:</strong> Registry Run keys, Startup folder writes</li>
                        <li><strong>File Drops:</strong> New executables in %APPDATA%, %TEMP%</li>
                        <li><strong>Credential Theft:</strong> Reads from SAM, LSA, browser databases</li>
                        <li><strong>Lateral Movement:</strong> Writes to network shares, PsExec activity</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Section 4: API Tracing -->
        <section class="section" id="section4">
            <div class="section-number">SECTION 04</div>
            <h2 class="section-title">API Tracing & Hooking</h2>
            <div class="section-content">
                <p><strong>API Monitor</strong> shows you the actual Windows API calls a process makes - the low-level functions that do the real work. This is deeper than ProcMon's high-level operations.</p>

                <h3 style="color: #b090c0; font-size: 1.1rem; margin: 30px 0 15px;">Key API Categories to Monitor</h3>

                <div class="concept-grid">
                    <div class="concept-card">
                        <div class="concept-icon">üìÇ</div>
                        <div class="concept-title">File APIs</div>
                        <div class="concept-desc">CreateFileW, WriteFile, DeleteFileW, MoveFileEx</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">üóÑÔ∏è</div>
                        <div class="concept-title">Registry APIs</div>
                        <div class="concept-desc">RegOpenKeyEx, RegSetValueEx, RegDeleteKey</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">üåê</div>
                        <div class="concept-title">Network APIs</div>
                        <div class="concept-desc">WSAStartup, connect, send, recv, InternetOpen</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">‚öôÔ∏è</div>
                        <div class="concept-title">Process APIs</div>
                        <div class="concept-desc">CreateProcess, VirtualAllocEx, WriteProcessMemory</div>
                    </div>
                </div>

                <h3 style="color: #b090c0; font-size: 1.1rem; margin: 30px 0 15px;">Live API Trace Example</h3>

                <div class="interactive-box">
                    <div class="interactive-header">
                        <span class="interactive-title">API Monitor - Malware API Calls</span>
                        <div class="interactive-controls">
                            <button class="control-btn active" onclick="filterAPIs('all')">All</button>
                            <button class="control-btn" onclick="filterAPIs('suspicious')">Suspicious Only</button>
                        </div>
                    </div>
                    <div class="interactive-body" id="api-trace">
                        <div class="api-call" data-category="normal">
                            <div class="api-header">
                                <span class="api-name">GetSystemInfo</span>
                                <span class="api-category">SYSTEM</span>
                            </div>
                            <div class="api-params">Parameters: ( )</div>
                            <div class="api-return">Returns: [System Information Structure]</div>
                        </div>

                        <div class="api-call suspicious" data-category="suspicious">
                            <div class="api-header">
                                <span class="api-name">VirtualAllocEx</span>
                                <span class="api-category">MEMORY</span>
                            </div>
                            <div class="api-params">hProcess: 0x1234 (explorer.exe), dwSize: 4096, flProtect: PAGE_EXECUTE_READWRITE</div>
                            <div class="api-return">Returns: 0x7FFF0000</div>
                        </div>

                        <div class="api-call suspicious" data-category="suspicious">
                            <div class="api-header">
                                <span class="api-name">WriteProcessMemory</span>
                                <span class="api-category">MEMORY</span>
                            </div>
                            <div class="api-params">hProcess: 0x1234 (explorer.exe), lpBaseAddress: 0x7FFF0000, nSize: 2048</div>
                            <div class="api-return">Returns: TRUE</div>
                        </div>

                        <div class="api-call suspicious" data-category="suspicious">
                            <div class="api-header">
                                <span class="api-name">CreateRemoteThread</span>
                                <span class="api-category">PROCESS</span>
                            </div>
                            <div class="api-params">hProcess: 0x1234 (explorer.exe), lpStartAddress: 0x7FFF0000</div>
                            <div class="api-return">Returns: 0x5678 (Thread Handle)</div>
                        </div>

                        <div class="api-call" data-category="normal">
                            <div class="api-header">
                                <span class="api-name">InternetOpenW</span>
                                <span class="api-category">NETWORK</span>
                            </div>
                            <div class="api-params">lpszAgent: "Mozilla/5.0", dwAccessType: INTERNET_OPEN_TYPE_DIRECT</div>
                            <div class="api-return">Returns: 0x9ABC (Internet Handle)</div>
                        </div>

                        <div class="api-call suspicious" data-category="suspicious">
                            <div class="api-header">
                                <span class="api-name">HttpOpenRequestW</span>
                                <span class="api-category">NETWORK</span>
                            </div>
                            <div class="api-params">lpszObjectName: "/gate.php", lpszVerb: "POST"</div>
                            <div class="api-return">Returns: 0xDEF0 (Request Handle)</div>
                        </div>

                        <div class="api-call suspicious" data-category="suspicious">
                            <div class="api-header">
                                <span class="api-name">RegSetValueExW</span>
                                <span class="api-category">REGISTRY</span>
                            </div>
                            <div class="api-params">hKey: HKCU\Software\Microsoft\Windows\CurrentVersion\Run, lpValueName: "SystemUpdate", lpData: "C:\Users\victim\AppData\updater.exe"</div>
                            <div class="api-return">Returns: ERROR_SUCCESS</div>
                        </div>
                    </div>
                </div>

                <div class="callout warning">
                    <strong>Classic Process Injection Pattern:</strong> The sequence <code>VirtualAllocEx</code> ‚Üí <code>WriteProcessMemory</code> ‚Üí <code>CreateRemoteThread</code> is textbook process injection. The malware allocated memory in explorer.exe, wrote shellcode, and executed it. This is how it hides in legitimate processes.
                </div>

                <h3 style="color: #b090c0; font-size: 1.1rem; margin: 30px 0 15px;">Understanding API Hooking</h3>

                <p>API hooking intercepts function calls to monitor or modify behavior. Tools like API Monitor insert themselves between the malware and Windows APIs to capture everything.</p>

                <div style="background: rgba(20, 10, 30, 0.8); padding: 20px; border-radius: 6px; margin: 20px 0;">
                    <pre style="margin: 0; padding: 0; background: none;">
Malware calls CreateFileW
    ‚Üì
Hook intercepts call
    ‚Üì
Hook logs: "CreateFileW(L\"secrets.txt\", GENERIC_READ, ...)"
    ‚Üì
Hook forwards to real CreateFileW
    ‚Üì
Returns result to malware
</pre>
                </div>

                <div class="callout tip">
                    <strong>Pro Tip:</strong> Enable pre-defined API filters in API Monitor for "Cryptography" when analyzing ransomware. You'll immediately see CryptEncrypt calls that show what's being encrypted in real-time.
                </div>
            </div>
        </section>

        <!-- Section 5: Network Capture -->
        <section class="section" id="section5">
            <div class="section-number">SECTION 05</div>
            <h2 class="section-title">Network Traffic Analysis</h2>
            <div class="section-content">
                <p><strong>Wireshark</strong> is your network microscope. Every packet the malware sends - DNS queries, HTTP requests, C2 beacons - all captured and dissected.</p>

                <div class="concept-grid">
                    <div class="concept-card">
                        <div class="concept-icon">üîç</div>
                        <div class="concept-title">DNS Queries</div>
                        <div class="concept-desc">Domain lookups reveal C2 infrastructure</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">üì°</div>
                        <div class="concept-title">HTTP Traffic</div>
                        <div class="concept-desc">POST/GET requests to command servers</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">üîí</div>
                        <div class="concept-title">SSL/TLS</div>
                        <div class="concept-desc">Encrypted traffic (harder to analyze)</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">‚ö°</div>
                        <div class="concept-title">Raw TCP</div>
                        <div class="concept-desc">Custom protocols on non-standard ports</div>
                    </div>
                </div>

                <h3 style="color: #b090c0; font-size: 1.1rem; margin: 30px 0 15px;">Interactive Packet Analysis</h3>

                <div class="interactive-box">
                    <div class="interactive-header">
                        <span class="interactive-title">Wireshark Capture - malware_traffic.pcap</span>
                        <div class="interactive-controls">
                            <button class="control-btn active" onclick="filterPackets('all')">All</button>
                            <button class="control-btn" onclick="filterPackets('http')">HTTP</button>
                            <button class="control-btn" onclick="filterPackets('dns')">DNS</button>
                        </div>
                    </div>
                    <div class="interactive-body" id="packet-list">
                        <div class="packet" data-protocol="dns">
                            <div class="packet-header">
                                <span class="packet-number">Packet #1</span>
                                <span class="packet-protocol protocol-dns">DNS</span>
                            </div>
                            <div class="packet-info">
                                <span class="info-label">Source:</span>
                                <span class="info-value">192.168.1.100</span>
                                <span class="info-label">Destination:</span>
                                <span class="info-value">8.8.8.8</span>
                                <span class="info-label">Query:</span>
                                <span class="info-value">c2-server.malicious-domain.com</span>
                            </div>
                        </div>

                        <div class="packet" data-protocol="dns">
                            <div class="packet-header">
                                <span class="packet-number">Packet #2</span>
                                <span class="packet-protocol protocol-dns">DNS</span>
                            </div>
                            <div class="packet-info">
                                <span class="info-label">Source:</span>
                                <span class="info-value">8.8.8.8</span>
                                <span class="info-label">Destination:</span>
                                <span class="info-value">192.168.1.100</span>
                                <span class="info-label">Answer:</span>
                                <span class="info-value">185.234.219.45</span>
                            </div>
                        </div>

                        <div class="packet" data-protocol="tcp">
                            <div class="packet-header">
                                <span class="packet-number">Packet #3</span>
                                <span class="packet-protocol protocol-tcp">TCP</span>
                            </div>
                            <div class="packet-info">
                                <span class="info-label">Source:</span>
                                <span class="info-value">192.168.1.100:49152</span>
                                <span class="info-label">Destination:</span>
                                <span class="info-value">185.234.219.45:8080</span>
                                <span class="info-label">Flags:</span>
                                <span class="info-value">SYN (Connection Attempt)</span>
                            </div>
                        </div>

                        <div class="packet" data-protocol="http">
                            <div class="packet-header">
                                <span class="packet-number">Packet #4</span>
                                <span class="packet-protocol protocol-http">HTTP</span>
                            </div>
                            <div class="packet-info">
                                <span class="info-label">Method:</span>
                                <span class="info-value">POST /gate.php</span>
                                <span class="info-label">Host:</span>
                                <span class="info-value">185.234.219.45</span>
                                <span class="info-label">User-Agent:</span>
                                <span class="info-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64)</span>
                                <span class="info-label">Body:</span>
                                <span class="info-value">id=VICTIM-PC&os=Win10&ver=2.3&data=BASE64_ENCODED_DATA</span>
                            </div>
                        </div>

                        <div class="packet" data-protocol="http">
                            <div class="packet-header">
                                <span class="packet-number">Packet #5</span>
                                <span class="packet-protocol protocol-http">HTTP</span>
                            </div>
                            <div class="packet-info">
                                <span class="info-label">Status:</span>
                                <span class="info-value">200 OK</span>
                                <span class="info-label">Content-Type:</span>
                                <span class="info-value">application/octet-stream</span>
                                <span class="info-label">Body:</span>
                                <span class="info-value">[Binary shellcode - 4096 bytes]</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="callout warning">
                    <strong>What Just Happened?</strong> The malware:
                    <ol style="margin-top: 10px; margin-left: 20px;">
                        <li>Resolved C2 domain via DNS (Packet #1-2)</li>
                        <li>Connected to C2 server (Packet #3)</li>
                        <li>Sent victim information via POST (Packet #4)</li>
                        <li>Received shellcode payload from C2 (Packet #5)</li>
                    </ol>
                    This is a classic C2 beacon followed by second-stage payload download.
                </div>

                <h3 style="color: #b090c0; font-size: 1.1rem; margin: 30px 0 15px;">SSL/TLS Inspection Challenges</h3>

                <p>Modern malware often uses HTTPS to hide C2 traffic. You have a few options:</p>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                    <div style="background: rgba(40, 20, 60, 0.3); padding: 15px; border-radius: 6px;">
                        <h4 style="color: #9a8aaa; margin-bottom: 10px;">SSL Interception Proxy</h4>
                        <p style="color: #8080a0; font-size: 0.85rem;">Install a proxy certificate on the VM and use mitmproxy or Burp Suite to decrypt traffic. Requires SSL/TLS configuration.</p>
                    </div>
                    <div style="background: rgba(40, 20, 60, 0.3); padding: 15px; border-radius: 6px;">
                        <h4 style="color: #9a8aaa; margin-bottom: 10px;">Metadata Analysis</h4>
                        <p style="color: #8080a0; font-size: 0.85rem;">Even encrypted, you can see: destination IPs, connection timing, packet sizes. Often enough to identify C2 patterns.</p>
                    </div>
                </div>

                <div class="callout tip">
                    <strong>Wireshark Display Filters:</strong>
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li><code>http.request.method == "POST"</code> - Find data exfiltration</li>
                        <li><code>dns.qry.name contains "pastebin"</code> - Popular C2 channel</li>
                        <li><code>tcp.port != 80 && tcp.port != 443</code> - Non-standard ports</li>
                        <li><code>ip.addr == 192.168.1.100 && http</code> - All HTTP from victim</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Section 6: Memory Analysis -->
        <section class="section" id="section6">
            <div class="section-number">SECTION 06</div>
            <h2 class="section-title">Memory Analysis</h2>
            <div class="section-content">
                <p>Memory is where secrets live. Decrypted payloads, injected code, command history, credentials - all sitting in RAM even if never written to disk.</p>

                <div class="concept-grid">
                    <div class="concept-card">
                        <div class="concept-icon">üß†</div>
                        <div class="concept-title">Process Memory</div>
                        <div class="concept-desc">Running code, loaded DLLs, heap allocations</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">üîì</div>
                        <div class="concept-title">Unpacked Code</div>
                        <div class="concept-desc">Packed malware must unpack to execute</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">üîë</div>
                        <div class="concept-title">Credentials</div>
                        <div class="concept-desc">Passwords, hashes, tokens in cleartext</div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon">üíâ</div>
                        <div class="concept-title">Injected Code</div>
                        <div class="concept-desc">Shellcode hidden in legitimate processes</div>
                    </div>
                </div>

                <h3 style="color: #b090c0; font-size: 1.1rem; margin: 30px 0 15px;">Volatility Framework Basics</h3>

                <p><strong>Volatility</strong> is the premier framework for memory forensics. Point it at a memory dump and extract running processes, network connections, injected code, and more.</p>

                <pre>
<span style="color: #8a9aaa;"># List running processes</span>
volatility -f memory.dmp windows.pslist

<span style="color: #8a9aaa;"># Show network connections</span>
volatility -f memory.dmp windows.netscan

<span style="color: #8a9aaa;"># Detect process injection</span>
volatility -f memory.dmp windows.malfind

<span style="color: #8a9aaa;"># Dump a specific process</span>
volatility -f memory.dmp -p 1234 windows.memmap --dump

<span style="color: #8a9aaa;"># Extract command line history</span>
volatility -f memory.dmp windows.cmdline
</pre>

                <h3 style="color: #b090c0; font-size: 1.1rem; margin: 30px 0 15px;">Memory Strings Analysis</h3>

                <div class="interactive-box">
                    <div class="interactive-header">
                        <span class="interactive-title">Memory Dump Strings - malware.exe (PID 1234)</span>
                        <div class="interactive-controls">
                            <button class="control-btn active" onclick="filterMemStrings('all')">All</button>
                            <button class="control-btn" onclick="filterMemStrings('url')">URLs</button>
                            <button class="control-btn" onclick="filterMemStrings('key')">Keys</button>
                            <button class="control-btn" onclick="filterMemStrings('cmd')">Commands</button>
                        </div>
                    </div>
                    <div class="interactive-body" id="memory-strings">
                        <div class="memory-string" data-type="url">
                            <span class="string-address">0x00400000</span>
                            <span class="string-content">http://185.234.219.45:8080/gate.php</span>
                            <span class="string-tag tag-url">URL</span>
                        </div>
                        <div class="memory-string" data-type="url">
                            <span class="string-address">0x00401200</span>
                            <span class="string-content">https://pastebin.com/raw/C2Config</span>
                            <span class="string-tag tag-url">URL</span>
                        </div>
                        <div class="memory-string" data-type="key">
                            <span class="string-address">0x00402400</span>
                            <span class="string-content">SOFTWARE\Microsoft\Windows\CurrentVersion\Run</span>
                            <span class="string-tag tag-key">REGISTRY</span>
                        </div>
                        <div class="memory-string" data-type="cmd">
                            <span class="string-address">0x00403800</span>
                            <span class="string-content">cmd.exe /c powershell -enc BASE64_PAYLOAD</span>
                            <span class="string-tag tag-command">COMMAND</span>
                        </div>
                        <div class="memory-string" data-type="key">
                            <span class="string-address">0x00404C00</span>
                            <span class="string-content">MySecretEncryptionKey2024!</span>
                            <span class="string-tag tag-key">CRYPTO KEY</span>
                        </div>
                        <div class="memory-string" data-type="cmd">
                            <span class="string-address">0x00406000</span>
                            <span class="string-content">net user admin P@ssw0rd123 /add</span>
                            <span class="string-tag tag-command">COMMAND</span>
                        </div>
                        <div class="memory-string" data-type="url">
                            <span class="string-address">0x00407400</span>
                            <span class="string-content">ftp://backup-server.internal.local/exfil/</span>
                            <span class="string-tag tag-url">URL</span>
                        </div>
                    </div>
                </div>

                <div class="callout tip">
                    <strong>Memory Dump Timing:</strong> Take a memory snapshot 30-60 seconds after malware execution. This captures initial unpacking and C2 communication before anti-analysis tricks kick in. Take multiple snapshots over time to catch time-delayed behaviors.
                </div>

                <div class="callout info">
                    <strong>Common Memory Artifacts:</strong>
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li><strong>Mutexes:</strong> Unique strings malware uses to prevent multiple infections</li>
                        <li><strong>Decrypted URLs:</strong> C2 domains that were encrypted in the binary</li>
                        <li><strong>Shellcode:</strong> Small executable payloads injected into other processes</li>
                        <li><strong>Configuration:</strong> C2 addresses, encryption keys, campaign IDs</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Section 7: Automation & Sandboxes -->
        <section class="section" id="section7">
            <div class="section-number">SECTION 07</div>
            <h2 class="section-title">Automated Analysis & Sandboxes</h2>
            <div class="section-content">
                <p>Manual analysis is powerful but time-consuming. Automated sandboxes let you analyze hundreds of samples quickly, then manually investigate the interesting ones.</p>

                <div class="sandbox-grid">
                    <div class="sandbox-card">
                        <div class="sandbox-header">
                            <div class="sandbox-name">Cuckoo Sandbox</div>
                            <div class="sandbox-type">Self-Hosted / Open Source</div>
                        </div>
                        <div class="sandbox-body">
                            <ul class="sandbox-features">
                                <li>Complete control and privacy</li>
                                <li>API call tracing</li>
                                <li>Network traffic capture</li>
                                <li>Memory dumps</li>
                                <li>YARA rule scanning</li>
                            </ul>
                            <div class="sandbox-note">
                                <strong>Best For:</strong> Organizations needing private analysis infrastructure or custom detection rules.
                            </div>
                        </div>
                    </div>

                    <div class="sandbox-card">
                        <div class="sandbox-header">
                            <div class="sandbox-name">Any.Run</div>
                            <div class="sandbox-type">Cloud / Interactive</div>
                        </div>
                        <div class="sandbox-body">
                            <ul class="sandbox-features">
                                <li>Real-time interaction with sample</li>
                                <li>Windows & Linux VMs</li>
                                <li>Built-in MITRE ATT&CK mapping</li>
                                <li>Threat intelligence integration</li>
                                <li>Public submission sharing</li>
                            </ul>
                            <div class="sandbox-note">
                                <strong>Best For:</strong> Quick analysis with ability to manually interact during execution.
                            </div>
                        </div>
                    </div>

                    <div class="sandbox-card">
                        <div class="sandbox-header">
                            <div class="sandbox-name">Joe Sandbox</div>
                            <div class="sandbox-type">Cloud / Enterprise</div>
                        </div>
                        <div class="sandbox-body">
                            <ul class="sandbox-features">
                                <li>Advanced behavior analysis</li>
                                <li>Code similarity detection</li>
                                <li>Mobile malware support</li>
                                <li>Deep API tracing</li>
                                <li>Detailed PDF reports</li>
                            </ul>
                            <div class="sandbox-note">
                                <strong>Best For:</strong> Enterprise environments needing comprehensive reports and threat correlation.
                            </div>
                        </div>
                    </div>
                </div>

                <h3 style="color: #b090c0; font-size: 1.1rem; margin: 30px 0 15px;">When to Use Automated vs Manual</h3>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 30px 0;">
                    <div style="background: rgba(60, 80, 40, 0.2); padding: 20px; border-radius: 6px; border: 1px solid rgba(80, 120, 60, 0.3);">
                        <h4 style="color: #9aaa8a; margin-bottom: 10px;">Use Automation When:</h4>
                        <ul>
                            <li>Triaging large sample sets</li>
                            <li>Initial reconnaissance phase</li>
                            <li>Time-sensitive incident response</li>
                            <li>Known malware family confirmation</li>
                            <li>Quick IoC extraction needed</li>
                        </ul>
                    </div>
                    <div style="background: rgba(40, 60, 80, 0.2); padding: 20px; border-radius: 6px; border: 1px solid rgba(60, 90, 120, 0.3);">
                        <h4 style="color: #8a9aaa; margin-bottom: 10px;">Use Manual When:</h4>
                        <ul>
                            <li>Advanced/targeted attack analysis</li>
                            <li>Sample uses sandbox evasion</li>
                            <li>Need to understand exact technique</li>
                            <li>Custom/unknown malware family</li>
                            <li>Preparing detailed threat report</li>
                        </ul>
                    </div>
                </div>

                <div class="callout warning">
                    <strong>Sandbox Evasion Techniques:</strong> Sophisticated malware can detect sandboxes and alter behavior. Look for:
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li>VM artifact checks (VMware, VirtualBox registry keys)</li>
                        <li>Sleep/delay functions to timeout analysis</li>
                        <li>User interaction requirements (click dialogs, move mouse)</li>
                        <li>Geolocation checks (only runs in specific countries)</li>
                        <li>Time bombs (execute only at specific dates/times)</li>
                    </ul>
                </div>

                <div class="callout tip">
                    <strong>Hybrid Approach:</strong> Start with automated sandbox to get quick results and IoCs. If behavior looks interesting or sophisticated, switch to manual analysis for deeper investigation. Think of sandboxes as your first filter, not your only tool.
                </div>
            </div>
        </section>

        <!-- Section 8: Putting It Together -->
        <section class="section" id="section8">
            <div class="section-number">SECTION 08</div>
            <h2 class="section-title">Analysis Workflow & Documentation</h2>
            <div class="section-content">
                <p>Effective dynamic analysis follows a methodical workflow. Here's the process professional analysts use:</p>

                <div class="workflow-diagram">
                    <div class="workflow-steps">
                        <div class="workflow-step">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <div class="step-title">Preparation</div>
                                <div class="step-desc">Take VM snapshot, start monitoring tools (ProcMon, Wireshark, API Monitor), establish baseline</div>
                            </div>
                        </div>
                        <div class="workflow-step">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <div class="step-title">Execution</div>
                                <div class="step-desc">Launch malware, watch for initial burst of activity (first 60 seconds critical)</div>
                            </div>
                        </div>
                        <div class="workflow-step">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <div class="step-title">Observation</div>
                                <div class="step-desc">Monitor for 5-10 minutes, interact if needed (click dialogs, browse web), capture all logs</div>
                            </div>
                        </div>
                        <div class="workflow-step">
                            <div class="step-number">4</div>
                            <div class="step-content">
                                <div class="step-title">Memory Capture</div>
                                <div class="step-desc">Take memory dump of malicious process, pause VM before artifacts decay</div>
                            </div>
                        </div>
                        <div class="workflow-step">
                            <div class="step-number">5</div>
                            <div class="step-content">
                                <div class="step-title">Artifact Collection</div>
                                <div class="step-desc">Export logs (ProcMon, Wireshark), copy dropped files, document registry changes</div>
                            </div>
                        </div>
                        <div class="workflow-step">
                            <div class="step-number">6</div>
                            <div class="step-content">
                                <div class="step-title">Analysis</div>
                                <div class="step-desc">Review logs, analyze memory, identify IoCs, map to MITRE ATT&CK framework</div>
                            </div>
                        </div>
                        <div class="workflow-step">
                            <div class="step-number">7</div>
                            <div class="step-content">
                                <div class="step-title">Documentation</div>
                                <div class="step-desc">Write report with findings, IoCs, detection rules, and remediation steps</div>
                            </div>
                        </div>
                    </div>
                </div>

                <h3 style="color: #b090c0; font-size: 1.1rem; margin: 30px 0 15px;">Report Writing Best Practices</h3>

                <div style="background: rgba(20, 10, 30, 0.8); padding: 25px; border-radius: 6px; margin: 20px 0;">
                    <h4 style="color: #9a8aaa; margin-bottom: 15px;">Essential Report Sections:</h4>

                    <div style="margin-bottom: 20px;">
                        <div style="color: #b090c0; margin-bottom: 5px;"><strong>Executive Summary</strong></div>
                        <div style="color: #8080a0; font-size: 0.9rem;">What it does in plain English. Threat level, affected systems, urgent actions needed.</div>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <div style="color: #b090c0; margin-bottom: 5px;"><strong>Technical Analysis</strong></div>
                        <div style="color: #8080a0; font-size: 0.9rem;">Detailed behavior: persistence mechanisms, C2 communication, data exfiltration, lateral movement capabilities.</div>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <div style="color: #b090c0; margin-bottom: 5px;"><strong>Indicators of Compromise (IoCs)</strong></div>
                        <div style="color: #8080a0; font-size: 0.9rem;">File hashes, IPs, domains, registry keys, mutex names, file paths - everything detection can use.</div>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <div style="color: #b090c0; margin-bottom: 5px;"><strong>MITRE ATT&CK Mapping</strong></div>
                        <div style="color: #8080a0; font-size: 0.9rem;">Map observed behaviors to technique IDs (T1055, T1547.001, etc.) for threat hunting.</div>
                    </div>

                    <div>
                        <div style="color: #b090c0; margin-bottom: 5px;"><strong>Detection & Remediation</strong></div>
                        <div style="color: #8080a0; font-size: 0.9rem;">YARA rules, Sigma rules, EDR queries, cleanup steps, hardening recommendations.</div>
                    </div>
                </div>

                <div class="callout tip">
                    <strong>Pro Documentation Tip:</strong> Take screenshots of key moments - suspicious API calls, C2 traffic, process injection. A single screenshot can explain what takes paragraphs to write. Store them with meaningful filenames: <code>01-persistence-reg-key.png</code>
                </div>
            </div>
        </section>

        <!-- Section 9: Mini-Lab Challenge -->
        <section class="section" id="section9">
            <div class="section-number">SECTION 09</div>
            <h2 class="section-title">Analysis Challenge: Put Your Skills to Test</h2>
            <div class="section-content">
                <div class="challenge-box">
                    <div class="challenge-title">Scenario: Suspicious Email Attachment</div>

                    <div class="challenge-scenario">
                        <p style="color: #c0a0d0; margin-bottom: 15px;">
                            You've received an incident report about a suspicious email attachment named <code>Invoice_Q4_2024.exe</code>.
                            An employee opened it but claims "nothing happened."
                        </p>
                        <p style="color: #a090b0;">
                            After running dynamic analysis for 2 minutes, you observe the following behaviors. Based on what you've learned,
                            what is the PRIMARY objective of this malware?
                        </p>
                    </div>

                    <div style="background: rgba(30, 15, 40, 0.8); padding: 20px; border-radius: 6px; margin: 20px 0; font-family: 'Courier New', monospace; font-size: 0.8rem;">
                        <div style="color: #7a6a8a; margin-bottom: 10px;">Observed Behaviors:</div>
                        <div style="color: #a090b0; line-height: 1.8;">
                            1. Creates: C:\Users\victim\AppData\Roaming\WindowsDefender\svchost.exe<br>
                            2. RegSetValue: HKCU\Software\Microsoft\Windows\CurrentVersion\Run\WindowsDefender<br>
                            3. API: VirtualAllocEx ‚Üí WriteProcessMemory ‚Üí CreateRemoteThread (target: explorer.exe)<br>
                            4. Network: HTTP POST to 45.142.212.61/panel/check.php<br>
                            5. POST Body: hwid=ABC123&os=Win10&av=defender&admin=false<br>
                            6. Response: {"status":"registered","interval":3600,"tasks":[]}
                        </div>
                    </div>

                    <div class="challenge-question">What is this malware's primary purpose?</div>

                    <div class="challenge-options">
                        <div class="challenge-option" onclick="checkChallenge(this, false)">
                            Ransomware - Encrypts files and demands payment
                        </div>
                        <div class="challenge-option" onclick="checkChallenge(this, false)">
                            Wiper - Destroys data to cause maximum damage
                        </div>
                        <div class="challenge-option" onclick="checkChallenge(this, true)">
                            Trojan/Backdoor - Establishes persistent remote access for future commands
                        </div>
                        <div class="challenge-option" onclick="checkChallenge(this, false)">
                            Information Stealer - Immediately harvests credentials and exfiltrates
                        </div>
                    </div>

                    <div class="challenge-feedback" id="challenge-feedback"></div>
                </div>

                <div class="challenge-box" style="margin-top: 30px;">
                    <div class="challenge-title">Bonus Challenge: Attack Chain Analysis</div>

                    <div class="challenge-scenario">
                        <p style="color: #c0a0d0;">
                            Map the observed behaviors to MITRE ATT&CK techniques. Which technique ID corresponds to
                            the registry persistence mechanism?
                        </p>
                    </div>

                    <div class="challenge-options">
                        <div class="challenge-option" onclick="checkChallenge2(this, false)">
                            T1055.001 - Process Injection: DLL Injection
                        </div>
                        <div class="challenge-option" onclick="checkChallenge2(this, true)">
                            T1547.001 - Boot or Logon Autostart Execution: Registry Run Keys
                        </div>
                        <div class="challenge-option" onclick="checkChallenge2(this, false)">
                            T1071.001 - Application Layer Protocol: Web Protocols
                        </div>
                        <div class="challenge-option" onclick="checkChallenge2(this, false)">
                            T1036.005 - Masquerading: Match Legitimate Name or Location
                        </div>
                    </div>

                    <div class="challenge-feedback" id="challenge-feedback2"></div>
                </div>
            </div>
        </section>

        <!-- Completion -->
        <section class="completion-section" id="completion">
            <div class="completion-icon">üéØ</div>
            <h2 class="completion-title">Module Complete!</h2>
            <p class="completion-text">
                You've mastered dynamic analysis techniques. You can now observe malware behavior in real-time,
                capture network communications, analyze memory, and document your findings like a professional analyst.
            </p>
            <a href="../index.html" class="completion-btn">Return to Vault &rarr;</a>
        </section>

        <div class="nav-buttons">
            <a href="../index.html" class="nav-btn">&larr; Back to Vault</a>
            <a href="../index.html" class="nav-btn primary">Complete Module &rarr;</a>
        </div>
    </main>

    <script>
        // Track progress
        let sectionsViewed = new Set();
        const totalSections = 9;

        // Intersection Observer for sections
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    const sectionNum = entry.target.id.replace('section', '');
                    if (sectionNum) {
                        sectionsViewed.add(sectionNum);
                        updateProgress();
                    }
                }
            });
        }, { threshold: 0.2 });

        document.querySelectorAll('.section').forEach(section => {
            observer.observe(section);
        });

        function updateProgress() {
            const progress = (sectionsViewed.size / totalSections) * 100;
            document.getElementById('progressFill').style.width = progress + '%';

            if (sectionsViewed.size === totalSections) {
                localStorage.setItem('vault_dynamic_complete', 'true');
            }
        }

        // ProcMon filter functionality
        function applyProcMonFilter() {
            const processFilter = document.getElementById('filter-process').value.toLowerCase();
            const operationFilter = document.getElementById('filter-operation').value;
            const resultFilter = document.getElementById('filter-result').value;

            document.querySelectorAll('.procmon-entry').forEach(entry => {
                const process = entry.dataset.process.toLowerCase();
                const operation = entry.dataset.operation;
                const result = entry.dataset.result;

                let show = true;

                if (processFilter && !process.includes(processFilter)) {
                    show = false;
                }
                if (operationFilter && operation !== operationFilter) {
                    show = false;
                }
                if (resultFilter && result !== resultFilter) {
                    show = false;
                }

                entry.classList.toggle('hidden', !show);
            });
        }

        function clearProcMonFilter() {
            document.getElementById('filter-process').value = '';
            document.getElementById('filter-operation').value = '';
            document.getElementById('filter-result').value = '';
            document.querySelectorAll('.procmon-entry').forEach(entry => {
                entry.classList.remove('hidden');
            });
        }

        // API trace filter
        function filterAPIs(category) {
            document.querySelectorAll('.control-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            document.querySelectorAll('.api-call').forEach(call => {
                if (category === 'all') {
                    call.style.display = 'block';
                } else if (category === 'suspicious' && call.classList.contains('suspicious')) {
                    call.style.display = 'block';
                } else if (category === 'suspicious') {
                    call.style.display = 'none';
                }
            });
        }

        // Packet filter
        function filterPackets(protocol) {
            document.querySelectorAll('#packet-list .control-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            document.querySelectorAll('.packet').forEach(packet => {
                if (protocol === 'all') {
                    packet.style.display = 'block';
                } else if (packet.dataset.protocol === protocol) {
                    packet.style.display = 'block';
                } else {
                    packet.style.display = 'none';
                }
            });
        }

        // Memory strings filter
        function filterMemStrings(type) {
            document.querySelectorAll('#memory-strings .control-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            document.querySelectorAll('.memory-string').forEach(str => {
                if (type === 'all') {
                    str.style.display = 'flex';
                } else if (str.dataset.type === type) {
                    str.style.display = 'flex';
                } else {
                    str.style.display = 'none';
                }
            });
        }

        // Challenge checking
        let challengeAnswered = false;

        function checkChallenge(element, isCorrect) {
            if (challengeAnswered) return;
            challengeAnswered = true;

            const feedback = document.getElementById('challenge-feedback');
            const options = element.parentElement.querySelectorAll('.challenge-option');

            options.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });

            if (isCorrect) {
                element.classList.add('correct');
                feedback.className = 'challenge-feedback show correct';
                feedback.innerHTML = `
                    <strong>‚úì Correct!</strong><br><br>
                    This is a <strong>Trojan/Backdoor</strong>. Key indicators:<br>
                    ‚Ä¢ <strong>Persistence</strong> via registry Run key (survives reboot)<br>
                    ‚Ä¢ <strong>Process injection</strong> to hide in legitimate process<br>
                    ‚Ä¢ <strong>Beacon behavior</strong> - checks in with C2 but receives no immediate tasks<br>
                    ‚Ä¢ <strong>"interval":3600</strong> suggests hourly check-ins for future commands<br><br>
                    The malware establishes a foothold and waits for operator commands. This is Stage 1 of a multi-stage attack.
                `;
            } else {
                element.classList.add('incorrect');
                feedback.className = 'challenge-feedback show incorrect';
                feedback.innerHTML = `
                    <strong>‚úó Not quite.</strong><br><br>
                    Look at the network response: <code>{"tasks":[]}</code> - No immediate action. This suggests the malware is
                    <strong>waiting</strong> for commands rather than executing a specific payload now. Also note the persistence
                    mechanism and process injection - hallmarks of establishing long-term access.
                `;

                // Highlight correct answer
                options.forEach(opt => {
                    if (opt.textContent.includes('Trojan/Backdoor')) {
                        opt.classList.add('correct');
                    }
                });
            }
        }

        let challenge2Answered = false;

        function checkChallenge2(element, isCorrect) {
            if (challenge2Answered) return;
            challenge2Answered = true;

            const feedback = document.getElementById('challenge-feedback2');
            const options = element.parentElement.querySelectorAll('.challenge-option');

            options.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });

            if (isCorrect) {
                element.classList.add('correct');
                feedback.className = 'challenge-feedback show correct';
                feedback.innerHTML = `
                    <strong>‚úì Excellent!</strong><br><br>
                    <strong>T1547.001 - Boot or Logon Autostart Execution: Registry Run Keys</strong><br>
                    The malware writes to <code>HKCU\...\Run</code> to ensure it starts every time the user logs in.
                    This is one of the most common persistence techniques and should trigger immediate alerts in your environment.
                `;
            } else {
                element.classList.add('incorrect');
                feedback.className = 'challenge-feedback show incorrect';
                feedback.innerHTML = `
                    <strong>‚úó Not quite.</strong><br><br>
                    While those techniques are present, the question asks specifically about the <strong>registry persistence</strong>.
                    Look for the technique that covers registry Run keys for autostart execution.
                `;

                options.forEach(opt => {
                    if (opt.textContent.includes('T1547.001')) {
                        opt.classList.add('correct');
                    }
                });
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Check if already completed
            if (localStorage.getItem('vault_dynamic_complete')) {
                document.getElementById('progressFill').style.width = '100%';
            }
        });
    </script>
<script src="../../../components/FluxCapacitor.js"></script>
</body>
</html>
