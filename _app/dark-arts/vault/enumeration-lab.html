<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enumeration Techniques Lab | Dark Arts Vault | Hexworth Prime</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #a855f7;
            --accent: #dc2626;
            --bg: #0a0a0f;
            --surface: #1a1a2e;
            --surface-light: #2a2a3e;
            --text: #e0e0e0;
            --text-dim: #a0a0a0;
            --success: #10b981;
            --warning: #f59e0b;
            --border: #3a3a4e;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, var(--surface) 0%, var(--surface-light) 100%);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 2px solid var(--primary);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(168, 85, 247, 0.1) 0%, transparent 70%);
            animation: pulse 4s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        h1 {
            font-size: 2.5em;
            color: var(--primary);
            text-shadow: 0 0 20px rgba(168, 85, 247, 0.5);
            position: relative;
            z-index: 1;
        }

        .subtitle {
            color: var(--text-dim);
            font-size: 1.1em;
            margin-top: 10px;
            position: relative;
            z-index: 1;
        }

        .nav-breadcrumb {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            font-size: 0.9em;
            position: relative;
            z-index: 1;
        }

        .nav-breadcrumb a {
            color: var(--primary);
            text-decoration: none;
            transition: color 0.3s;
        }

        .nav-breadcrumb a:hover {
            color: var(--accent);
        }

        .nav-breadcrumb span {
            color: var(--text-dim);
        }

        .progress-bar {
            background: var(--surface);
            height: 8px;
            border-radius: 10px;
            margin-top: 20px;
            overflow: hidden;
            position: relative;
            z-index: 1;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            width: 0%;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px var(--primary);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab-btn {
            background: var(--surface);
            color: var(--text);
            border: 2px solid var(--border);
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1em;
        }

        .tab-btn:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .tab-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.4);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        .card:hover {
            border-color: var(--primary);
            box-shadow: 0 5px 20px rgba(168, 85, 247, 0.2);
        }

        .card h2 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.8em;
        }

        .card h3 {
            color: var(--accent);
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .protocol-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .protocol-card {
            background: var(--surface-light);
            border: 2px solid var(--border);
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .protocol-card:hover {
            border-color: var(--primary);
            transform: scale(1.02);
        }

        .protocol-card.selected {
            border-color: var(--accent);
            background: linear-gradient(135deg, var(--surface-light), rgba(220, 38, 38, 0.1));
        }

        .protocol-name {
            font-size: 1.5em;
            color: var(--primary);
            margin-bottom: 10px;
            font-weight: bold;
        }

        .protocol-port {
            background: var(--accent);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            display: inline-block;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .protocol-description {
            color: var(--text-dim);
            font-size: 0.95em;
            margin-top: 10px;
        }

        .command-builder {
            background: var(--bg);
            border: 2px solid var(--primary);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .builder-section {
            margin-bottom: 20px;
        }

        .builder-label {
            color: var(--primary);
            font-weight: bold;
            margin-bottom: 8px;
            display: block;
        }

        .builder-input {
            width: 100%;
            background: var(--surface);
            border: 2px solid var(--border);
            color: var(--text);
            padding: 10px;
            border-radius: 6px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .builder-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .tool-options {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .tool-option {
            background: var(--surface);
            border: 2px solid var(--border);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tool-option:hover {
            border-color: var(--primary);
        }

        .tool-option.selected {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .command-output {
            background: #000;
            border: 2px solid var(--primary);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            color: #0f0;
            font-size: 0.9em;
            min-height: 100px;
            max-height: 400px;
            overflow-y: auto;
        }

        .command-line {
            color: var(--accent);
            font-weight: bold;
            margin-bottom: 10px;
            word-break: break-all;
        }

        .execute-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s;
            margin-top: 15px;
        }

        .execute-btn:hover {
            background: #b91c1c;
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.5);
        }

        .execute-btn:disabled {
            background: #555;
            cursor: not-allowed;
            transform: none;
        }

        .flowchart {
            background: var(--surface-light);
            border: 2px solid var(--border);
            border-radius: 10px;
            padding: 30px;
            margin-top: 20px;
            overflow-x: auto;
        }

        .flow-step {
            background: var(--surface);
            border: 2px solid var(--primary);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            text-align: center;
            position: relative;
        }

        .flow-step::after {
            content: 'â†“';
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2em;
            color: var(--primary);
        }

        .flow-step:last-child::after {
            display: none;
        }

        .flow-step-title {
            color: var(--accent);
            font-weight: bold;
            margin-bottom: 5px;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .comparison-table th,
        .comparison-table td {
            border: 2px solid var(--border);
            padding: 12px;
            text-align: left;
        }

        .comparison-table th {
            background: var(--primary);
            color: white;
            font-weight: bold;
        }

        .comparison-table tr:nth-child(even) {
            background: var(--surface-light);
        }

        .comparison-table tr:hover {
            background: rgba(168, 85, 247, 0.1);
        }

        .cheat-sheet-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .cheat-card {
            background: var(--surface-light);
            border: 2px solid var(--border);
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s;
        }

        .cheat-card:hover {
            border-color: var(--accent);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(220, 38, 38, 0.2);
        }

        .cheat-card-title {
            color: var(--accent);
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .cheat-command {
            background: #000;
            color: #0f0;
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            word-break: break-all;
        }

        .cheat-description {
            color: var(--text-dim);
            font-size: 0.9em;
            margin-top: 5px;
        }

        .port-diagram {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .port-box {
            background: var(--surface-light);
            border: 2px solid var(--primary);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s;
        }

        .port-box:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.3);
        }

        .port-number {
            font-size: 2em;
            color: var(--accent);
            font-weight: bold;
        }

        .port-protocol {
            color: var(--primary);
            font-size: 1.2em;
            margin-top: 5px;
        }

        .port-service {
            color: var(--text-dim);
            font-size: 0.9em;
            margin-top: 5px;
        }

        .quiz-container {
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 25px;
            margin-top: 20px;
        }

        .quiz-question {
            margin-bottom: 25px;
            padding: 20px;
            background: var(--surface-light);
            border-radius: 8px;
            border: 2px solid var(--border);
        }

        .question-text {
            color: var(--primary);
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quiz-option {
            background: var(--surface);
            border: 2px solid var(--border);
            padding: 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quiz-option:hover {
            border-color: var(--primary);
            transform: translateX(5px);
        }

        .quiz-option.selected {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .quiz-option.correct {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        .quiz-option.incorrect {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }

        .submit-quiz-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: bold;
            transition: all 0.3s;
            margin-top: 20px;
        }

        .submit-quiz-btn:hover {
            background: #b91c1c;
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.5);
        }

        .quiz-result {
            background: var(--surface-light);
            border: 2px solid var(--success);
            border-radius: 10px;
            padding: 25px;
            margin-top: 20px;
            text-align: center;
            display: none;
        }

        .quiz-result.show {
            display: block;
            animation: fadeIn 0.5s;
        }

        .result-score {
            font-size: 3em;
            color: var(--success);
            font-weight: bold;
        }

        .result-message {
            font-size: 1.3em;
            color: var(--primary);
            margin-top: 10px;
        }

        .xp-reward {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 1.2em;
            text-align: center;
            font-weight: bold;
        }

        .info-box {
            background: rgba(168, 85, 247, 0.1);
            border-left: 4px solid var(--primary);
            padding: 15px;
            margin: 15px 0;
            border-radius: 6px;
        }

        .warning-box {
            background: rgba(245, 158, 11, 0.1);
            border-left: 4px solid var(--warning);
            padding: 15px;
            margin: 15px 0;
            border-radius: 6px;
        }

        .code-block {
            background: #000;
            color: #0f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 10px 0;
            border: 2px solid var(--primary);
        }

        .syntax-highlight .command {
            color: #f59e0b;
        }

        .syntax-highlight .flag {
            color: #3b82f6;
        }

        .syntax-highlight .target {
            color: #ec4899;
        }

        .syntax-highlight .comment {
            color: #6b7280;
        }

        footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px;
            color: var(--text-dim);
            border-top: 2px solid var(--border);
        }

        .back-to-vault {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 12px 30px;
            border-radius: 8px;
            text-decoration: none;
            transition: all 0.3s;
            margin-top: 20px;
        }

        .back-to-vault:hover {
            background: var(--accent);
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.5);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }

            .protocol-grid,
            .cheat-sheet-grid,
            .port-diagram {
                grid-template-columns: 1fr;
            }

            .tabs {
                flex-direction: column;
            }

            .tab-btn {
                width: 100%;
            }
        }

        .loading-spinner {
            border: 4px solid var(--surface);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Enumeration Techniques Lab</h1>
            <p class="subtitle">Master network service enumeration and information gathering</p>
            <div class="nav-breadcrumb">
                <a href="../index.html">Dark Arts Vault</a>
                <span>/</span>
                <span>Enumeration Lab</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('overview')">Overview</button>
            <button class="tab-btn" onclick="switchTab('protocols')">Protocols</button>
            <button class="tab-btn" onclick="switchTab('tools')">Interactive Tools</button>
            <button class="tab-btn" onclick="switchTab('methodology')">Methodology</button>
            <button class="tab-btn" onclick="switchTab('cheatsheet')">Cheat Sheet</button>
            <button class="tab-btn" onclick="switchTab('quiz')">Quiz</button>
        </div>

        <!-- Overview Tab -->
        <div id="overview" class="tab-content active">
            <div class="card">
                <h2>What is Enumeration?</h2>
                <p>Enumeration is the process of extracting detailed information about network resources, shares, users, groups, and services from target systems. It goes beyond simple scanning to actively query services for valuable intelligence.</p>

                <div class="info-box">
                    <strong>Key Difference:</strong> While scanning identifies open ports and services, enumeration extracts detailed information like usernames, shares, configurations, and system details.
                </div>

                <h3>Why Enumeration Matters</h3>
                <ul style="margin-left: 20px; margin-top: 10px; line-height: 2;">
                    <li>Identifies potential attack vectors through service misconfigurations</li>
                    <li>Reveals user accounts and group memberships for privilege escalation</li>
                    <li>Discovers shared resources and network topology</li>
                    <li>Gathers OS and application version information</li>
                    <li>Maps trust relationships and domain structures</li>
                </ul>

                <h3>Port Reference Quick Guide</h3>
                <div class="port-diagram">
                    <div class="port-box">
                        <div class="port-number">137-139</div>
                        <div class="port-protocol">NetBIOS</div>
                        <div class="port-service">Name Service, Session</div>
                    </div>
                    <div class="port-box">
                        <div class="port-number">445</div>
                        <div class="port-protocol">SMB</div>
                        <div class="port-service">File Sharing</div>
                    </div>
                    <div class="port-box">
                        <div class="port-number">161/162</div>
                        <div class="port-protocol">SNMP</div>
                        <div class="port-service">Network Management</div>
                    </div>
                    <div class="port-box">
                        <div class="port-number">389</div>
                        <div class="port-protocol">LDAP</div>
                        <div class="port-service">Directory Services</div>
                    </div>
                    <div class="port-box">
                        <div class="port-number">123</div>
                        <div class="port-protocol">NTP</div>
                        <div class="port-service">Time Sync</div>
                    </div>
                    <div class="port-box">
                        <div class="port-number">2049</div>
                        <div class="port-protocol">NFS</div>
                        <div class="port-service">Network File System</div>
                    </div>
                    <div class="port-box">
                        <div class="port-number">25</div>
                        <div class="port-protocol">SMTP</div>
                        <div class="port-service">Email Transfer</div>
                    </div>
                </div>

                <h3>Enumeration Targets</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Protocol</th>
                            <th>Information Gathered</th>
                            <th>Common Tools</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>NetBIOS</strong></td>
                            <td>Computer names, workgroups, MAC addresses</td>
                            <td>nbtstat, nbtscan, nmap</td>
                        </tr>
                        <tr>
                            <td><strong>SMB</strong></td>
                            <td>Shares, users, groups, policies</td>
                            <td>smbclient, enum4linux, smbmap</td>
                        </tr>
                        <tr>
                            <td><strong>SNMP</strong></td>
                            <td>System info, network configs, routing tables</td>
                            <td>snmpwalk, snmp-check, onesixtyone</td>
                        </tr>
                        <tr>
                            <td><strong>LDAP</strong></td>
                            <td>User accounts, groups, organizational units</td>
                            <td>ldapsearch, ldapenum, AD Explorer</td>
                        </tr>
                        <tr>
                            <td><strong>NTP</strong></td>
                            <td>System time, connected clients, versions</td>
                            <td>ntpdc, ntpq, ntp-scan</td>
                        </tr>
                        <tr>
                            <td><strong>NFS</strong></td>
                            <td>Exported shares, mount points, permissions</td>
                            <td>showmount, nfsstat, rpcinfo</td>
                        </tr>
                        <tr>
                            <td><strong>SMTP</strong></td>
                            <td>Valid email addresses, user accounts</td>
                            <td>smtp-user-enum, telnet, metasploit</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Protocols Tab -->
        <div id="protocols" class="tab-content">
            <div class="card">
                <h2>Enumeration Protocols Deep Dive</h2>
                <p>Click on each protocol to explore detailed enumeration techniques, commands, and best practices.</p>

                <div class="protocol-grid">
                    <div class="protocol-card" onclick="showProtocolDetails('netbios')">
                        <div class="protocol-name">NetBIOS</div>
                        <span class="protocol-port">TCP/UDP 137-139</span>
                        <div class="protocol-description">
                            Windows file and printer sharing protocol. Reveals computer names, workgroups, and MAC addresses.
                        </div>
                    </div>

                    <div class="protocol-card" onclick="showProtocolDetails('smb')">
                        <div class="protocol-name">SMB</div>
                        <span class="protocol-port">TCP 445, 137-139</span>
                        <div class="protocol-description">
                            Server Message Block for file sharing. Enumerates shares, users, groups, and system policies.
                        </div>
                    </div>

                    <div class="protocol-card" onclick="showProtocolDetails('snmp')">
                        <div class="protocol-name">SNMP</div>
                        <span class="protocol-port">UDP 161/162</span>
                        <div class="protocol-description">
                            Simple Network Management Protocol. Extracts detailed system configurations using community strings.
                        </div>
                    </div>

                    <div class="protocol-card" onclick="showProtocolDetails('ldap')">
                        <div class="protocol-name">LDAP</div>
                        <span class="protocol-port">TCP 389/636</span>
                        <div class="protocol-description">
                            Lightweight Directory Access Protocol. Queries Active Directory for users, groups, and OUs.
                        </div>
                    </div>

                    <div class="protocol-card" onclick="showProtocolDetails('ntp')">
                        <div class="protocol-name">NTP</div>
                        <span class="protocol-port">UDP 123</span>
                        <div class="protocol-description">
                            Network Time Protocol. Reveals time sync info, connected peers, and system uptime.
                        </div>
                    </div>

                    <div class="protocol-card" onclick="showProtocolDetails('nfs')">
                        <div class="protocol-name">NFS</div>
                        <span class="protocol-port">TCP 2049</span>
                        <div class="protocol-description">
                            Network File System. Shows exported directories and mount permissions.
                        </div>
                    </div>

                    <div class="protocol-card" onclick="showProtocolDetails('smtp')">
                        <div class="protocol-name">SMTP</div>
                        <span class="protocol-port">TCP 25</span>
                        <div class="protocol-description">
                            Simple Mail Transfer Protocol. Validates user accounts through VRFY and EXPN commands.
                        </div>
                    </div>
                </div>

                <div id="protocolDetails" style="margin-top: 30px;"></div>
            </div>
        </div>

        <!-- Interactive Tools Tab -->
        <div id="tools" class="tab-content">
            <div class="card">
                <h2>Interactive Command Builder</h2>
                <p>Select a protocol and configure your enumeration command. The tool will generate the proper syntax and simulate output.</p>

                <div class="command-builder">
                    <div class="builder-section">
                        <label class="builder-label">Select Protocol:</label>
                        <div class="tool-options" id="protocolSelector">
                            <div class="tool-option" onclick="selectProtocol('netbios')">NetBIOS</div>
                            <div class="tool-option" onclick="selectProtocol('smb')">SMB</div>
                            <div class="tool-option" onclick="selectProtocol('snmp')">SNMP</div>
                            <div class="tool-option" onclick="selectProtocol('ldap')">LDAP</div>
                            <div class="tool-option" onclick="selectProtocol('ntp')">NTP</div>
                            <div class="tool-option" onclick="selectProtocol('nfs')">NFS</div>
                            <div class="tool-option" onclick="selectProtocol('smtp')">SMTP</div>
                        </div>
                    </div>

                    <div class="builder-section" id="toolSelector" style="display: none;">
                        <label class="builder-label">Select Tool:</label>
                        <div class="tool-options" id="toolOptions"></div>
                    </div>

                    <div class="builder-section">
                        <label class="builder-label">Target IP/Hostname:</label>
                        <input type="text" class="builder-input" id="targetInput" placeholder="192.168.1.100">
                    </div>

                    <div class="builder-section" id="additionalOptions" style="display: none;"></div>

                    <button class="execute-btn" onclick="executeCommand()">Execute Command</button>

                    <div class="command-output" id="commandOutput" style="display: none;">
                        <div class="command-line" id="commandLine"></div>
                        <div id="outputText"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Methodology Tab -->
        <div id="methodology" class="tab-content">
            <div class="card">
                <h2>Enumeration Methodology</h2>
                <p>Follow this systematic approach to conduct thorough and organized enumeration.</p>

                <div class="flowchart">
                    <div class="flow-step">
                        <div class="flow-step-title">1. Network Discovery</div>
                        <div>Identify live hosts and open ports using Nmap, Masscan, or similar tools</div>
                    </div>
                    <div class="flow-step" style="margin-top: 40px;">
                        <div class="flow-step-title">2. Service Identification</div>
                        <div>Determine running services and versions on discovered ports</div>
                    </div>
                    <div class="flow-step" style="margin-top: 40px;">
                        <div class="flow-step-title">3. Protocol-Specific Enumeration</div>
                        <div>Apply targeted enumeration based on identified services (NetBIOS, SMB, SNMP, etc.)</div>
                    </div>
                    <div class="flow-step" style="margin-top: 40px;">
                        <div class="flow-step-title">4. Data Collection</div>
                        <div>Gather usernames, shares, configurations, and system information</div>
                    </div>
                    <div class="flow-step" style="margin-top: 40px;">
                        <div class="flow-step-title">5. Analysis & Documentation</div>
                        <div>Organize findings, identify vulnerabilities, and document attack surface</div>
                    </div>
                    <div class="flow-step" style="margin-top: 40px;">
                        <div class="flow-step-title">6. Exploitation Planning</div>
                        <div>Use enumerated data to plan targeted attacks and privilege escalation</div>
                    </div>
                </div>

                <h3>Best Practices</h3>
                <div class="info-box">
                    <ul style="margin-left: 20px; line-height: 2;">
                        <li><strong>Start Passive:</strong> Use non-intrusive techniques before active enumeration</li>
                        <li><strong>Document Everything:</strong> Keep detailed notes of commands, outputs, and findings</li>
                        <li><strong>Verify Findings:</strong> Cross-reference information from multiple sources</li>
                        <li><strong>Respect Scope:</strong> Only enumerate systems within authorized scope</li>
                        <li><strong>Automate Wisely:</strong> Use scripts for repetitive tasks but understand each command</li>
                        <li><strong>Monitor Traffic:</strong> Be aware of detection mechanisms and adjust techniques</li>
                    </ul>
                </div>

                <h3>Common Pitfalls to Avoid</h3>
                <div class="warning-box">
                    <ul style="margin-left: 20px; line-height: 2;">
                        <li>Relying on default community strings (public/private) without trying custom wordlists</li>
                        <li>Ignoring null sessions and anonymous access opportunities</li>
                        <li>Not checking for SMB signing disabled or weak NTLM configurations</li>
                        <li>Overlooking LDAP anonymous binds in Active Directory environments</li>
                        <li>Failing to enumerate DNS for zone transfers and subdomain discovery</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Cheat Sheet Tab -->
        <div id="cheatsheet" class="tab-content">
            <div class="card">
                <h2>Enumeration Command Cheat Sheet</h2>
                <p>Quick reference for the most essential enumeration commands across all protocols.</p>

                <div class="cheat-sheet-grid">
                    <!-- NetBIOS Commands -->
                    <div class="cheat-card">
                        <div class="cheat-card-title">NetBIOS Enumeration</div>

                        <div class="cheat-command">nbtstat -A 192.168.1.100</div>
                        <div class="cheat-description">Display NetBIOS name table of remote computer</div>

                        <div class="cheat-command">nbtstat -c</div>
                        <div class="cheat-description">Show NetBIOS name cache with IP addresses</div>

                        <div class="cheat-command">nbtscan -r 192.168.1.0/24</div>
                        <div class="cheat-description">Scan network range for NetBIOS information</div>

                        <div class="cheat-command">nmap -sV -p 137-139 --script nbstat.nse 192.168.1.100</div>
                        <div class="cheat-description">Nmap NetBIOS enumeration with NSE script</div>
                    </div>

                    <!-- SMB Commands -->
                    <div class="cheat-card">
                        <div class="cheat-card-title">SMB Enumeration</div>

                        <div class="cheat-command">smbclient -L //192.168.1.100 -N</div>
                        <div class="cheat-description">List shares with null session</div>

                        <div class="cheat-command">enum4linux -a 192.168.1.100</div>
                        <div class="cheat-description">Complete SMB enumeration (users, shares, groups)</div>

                        <div class="cheat-command">smbmap -H 192.168.1.100</div>
                        <div class="cheat-description">Enumerate shares and permissions</div>

                        <div class="cheat-command">net view \\192.168.1.100 /ALL</div>
                        <div class="cheat-description">Windows command to view all shares</div>
                    </div>

                    <!-- SNMP Commands -->
                    <div class="cheat-card">
                        <div class="cheat-card-title">SNMP Enumeration</div>

                        <div class="cheat-command">snmpwalk -v2c -c public 192.168.1.100</div>
                        <div class="cheat-description">Walk entire MIB tree with public community string</div>

                        <div class="cheat-command">snmp-check 192.168.1.100 -c public</div>
                        <div class="cheat-description">Comprehensive SNMP enumeration tool</div>

                        <div class="cheat-command">onesixtyone -c community.txt -i hosts.txt</div>
                        <div class="cheat-description">Brute force SNMP community strings</div>

                        <div class="cheat-command">nmap -sU -p 161 --script snmp-* 192.168.1.100</div>
                        <div class="cheat-description">Nmap SNMP enumeration scripts</div>
                    </div>

                    <!-- LDAP Commands -->
                    <div class="cheat-card">
                        <div class="cheat-card-title">LDAP Enumeration</div>

                        <div class="cheat-command">ldapsearch -x -h 192.168.1.100 -b "dc=domain,dc=com"</div>
                        <div class="cheat-description">Anonymous LDAP search for domain info</div>

                        <div class="cheat-command">ldapsearch -x -h 192.168.1.100 -b "dc=domain,dc=com" "(objectClass=user)"</div>
                        <div class="cheat-description">Enumerate all user objects</div>

                        <div class="cheat-command">nmap -p 389 --script ldap-search 192.168.1.100</div>
                        <div class="cheat-description">Nmap LDAP enumeration script</div>
                    </div>

                    <!-- NTP Commands -->
                    <div class="cheat-card">
                        <div class="cheat-card-title">NTP Enumeration</div>

                        <div class="cheat-command">ntpq -c readlist 192.168.1.100</div>
                        <div class="cheat-description">Query NTP server variables</div>

                        <div class="cheat-command">ntpq -c peers 192.168.1.100</div>
                        <div class="cheat-description">List NTP peer connections</div>

                        <div class="cheat-command">ntpdc -c monlist 192.168.1.100</div>
                        <div class="cheat-description">Show last 600 clients (CVE-2013-5211)</div>

                        <div class="cheat-command">nmap -sU -p 123 --script ntp-info 192.168.1.100</div>
                        <div class="cheat-description">Nmap NTP enumeration</div>
                    </div>

                    <!-- NFS Commands -->
                    <div class="cheat-card">
                        <div class="cheat-card-title">NFS Enumeration</div>

                        <div class="cheat-command">showmount -e 192.168.1.100</div>
                        <div class="cheat-description">List exported NFS shares</div>

                        <div class="cheat-command">rpcinfo -p 192.168.1.100</div>
                        <div class="cheat-description">Query RPC services on target</div>

                        <div class="cheat-command">nmap -p 2049 --script nfs-* 192.168.1.100</div>
                        <div class="cheat-description">Nmap NFS enumeration scripts</div>

                        <div class="cheat-command">mount -t nfs 192.168.1.100:/share /mnt/nfs</div>
                        <div class="cheat-description">Mount discovered NFS share</div>
                    </div>

                    <!-- SMTP Commands -->
                    <div class="cheat-card">
                        <div class="cheat-card-title">SMTP Enumeration</div>

                        <div class="cheat-command">smtp-user-enum -M VRFY -U users.txt -t 192.168.1.100</div>
                        <div class="cheat-description">Verify user accounts via VRFY command</div>

                        <div class="cheat-command">nmap -p 25 --script smtp-enum-users 192.168.1.100</div>
                        <div class="cheat-description">Nmap SMTP user enumeration</div>

                        <div class="cheat-command">telnet 192.168.1.100 25<br>VRFY root</div>
                        <div class="cheat-description">Manual SMTP user verification</div>

                        <div class="cheat-command">nc 192.168.1.100 25<br>EXPN all</div>
                        <div class="cheat-description">Expand mailing list members</div>
                    </div>

                    <!-- General Commands -->
                    <div class="cheat-card">
                        <div class="cheat-card-title">General Enumeration</div>

                        <div class="cheat-command">nmap -sV -sC -p- 192.168.1.100</div>
                        <div class="cheat-description">Comprehensive service version detection</div>

                        <div class="cheat-command">nikto -h http://192.168.1.100</div>
                        <div class="cheat-description">Web server vulnerability scanning</div>

                        <div class="cheat-command">enum4linux -a 192.168.1.100</div>
                        <div class="cheat-description">All-in-one Windows enumeration</div>

                        <div class="cheat-command">dnsenum domain.com</div>
                        <div class="cheat-description">DNS enumeration and zone transfers</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quiz Tab -->
        <div id="quiz" class="tab-content">
            <div class="card">
                <h2>Enumeration Mastery Quiz</h2>
                <p>Test your knowledge of enumeration techniques. Answer all 12 questions to earn 75 XP!</p>

                <div class="quiz-container" id="quizContainer">
                    <!-- Questions will be generated by JavaScript -->
                </div>

                <button class="submit-quiz-btn" onclick="submitQuiz()">Submit Quiz</button>

                <div class="quiz-result" id="quizResult">
                    <div class="result-score" id="resultScore"></div>
                    <div class="result-message" id="resultMessage"></div>
                    <div class="xp-reward" id="xpReward" style="display: none;">
                        +75 XP Earned! Enumeration Master Achieved!
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <p>&copy; 2025 Hexworth Prime Academy | Dark Arts Vault</p>
            <a href="../index.html" class="back-to-vault">Return to Vault</a>
        </footer>
    </div>

    <script>
        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tab contents
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));

            // Remove active class from all buttons
            const buttons = document.querySelectorAll('.tab-btn');
            buttons.forEach(btn => btn.classList.remove('active'));

            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            // Update progress
            updateProgress();
        }

        // Progress tracking
        let visitedTabs = new Set(['overview']);
        let quizCompleted = false;

        function updateProgress() {
            const activeTab = document.querySelector('.tab-content.active').id;
            visitedTabs.add(activeTab);

            let progress = (visitedTabs.size / 6) * 100;
            if (quizCompleted) progress = 100;

            document.getElementById('progressFill').style.width = progress + '%';
        }

        // Protocol details data
        const protocolData = {
            netbios: {
                name: 'NetBIOS Enumeration',
                description: 'NetBIOS (Network Basic Input/Output System) provides services for session layer communication in Windows networks.',
                commands: [
                    { cmd: 'nbtstat -A 192.168.1.100', desc: 'Display remote machine name table' },
                    { cmd: 'nbtstat -c', desc: 'Show NetBIOS name cache' },
                    { cmd: 'nbtstat -n', desc: 'Display local NetBIOS names' },
                    { cmd: 'nbtscan -r 192.168.1.0/24', desc: 'Scan entire subnet' }
                ],
                info: 'NetBIOS names are 16 bytes long. The 16th byte identifies the service type. Common types include <00> (workstation), <20> (file server), and <1B> (domain master browser).'
            },
            smb: {
                name: 'SMB Enumeration',
                description: 'Server Message Block protocol used for file sharing, printer sharing, and inter-process communication.',
                commands: [
                    { cmd: 'smbclient -L //192.168.1.100 -N', desc: 'List shares without password' },
                    { cmd: 'enum4linux -a 192.168.1.100', desc: 'Comprehensive enumeration' },
                    { cmd: 'smbmap -H 192.168.1.100 -u guest', desc: 'Map shares with guest account' },
                    { cmd: 'crackmapexec smb 192.168.1.100 --shares', desc: 'Enumerate shares with CME' }
                ],
                info: 'SMB signing, when disabled, allows for relay attacks. Always check for null sessions and guest account access which can reveal sensitive information.'
            },
            snmp: {
                name: 'SNMP Enumeration',
                description: 'Simple Network Management Protocol exposes detailed system configuration through MIB (Management Information Base) queries.',
                commands: [
                    { cmd: 'snmpwalk -v2c -c public 192.168.1.100', desc: 'Walk entire MIB tree' },
                    { cmd: 'snmp-check 192.168.1.100', desc: 'Automated SNMP enumeration' },
                    { cmd: 'onesixtyone -c community.txt 192.168.1.100', desc: 'Brute force community strings' },
                    { cmd: 'snmpget -v2c -c public 192.168.1.100 1.3.6.1.2.1.1.1.0', desc: 'Get system description' }
                ],
                info: 'Default community strings (public/private) are often unchanged. SNMP v1/v2c transmit in cleartext. Always try common strings: public, private, manager, community.'
            },
            ldap: {
                name: 'LDAP Enumeration',
                description: 'Lightweight Directory Access Protocol queries directory services, commonly Active Directory in Windows environments.',
                commands: [
                    { cmd: 'ldapsearch -x -h 192.168.1.100 -b "dc=corp,dc=com"', desc: 'Anonymous LDAP search' },
                    { cmd: 'ldapsearch -x -h 192.168.1.100 -b "dc=corp,dc=com" "(objectClass=person)"', desc: 'Enumerate users' },
                    { cmd: 'ldapsearch -x -h 192.168.1.100 -b "dc=corp,dc=com" "(objectClass=group)"', desc: 'Enumerate groups' },
                    { cmd: 'nmap -p 389 --script ldap-rootdse 192.168.1.100', desc: 'Get LDAP root DSE info' }
                ],
                info: 'Anonymous binds may be allowed on port 389. Use LDAP to enumerate users, groups, computers, and organizational units in Active Directory.'
            },
            ntp: {
                name: 'NTP Enumeration',
                description: 'Network Time Protocol can leak information about connected clients and internal network architecture.',
                commands: [
                    { cmd: 'ntpq -c readlist 192.168.1.100', desc: 'Query NTP variables' },
                    { cmd: 'ntpq -c peers 192.168.1.100', desc: 'List peer connections' },
                    { cmd: 'ntpdc -c monlist 192.168.1.100', desc: 'Get client list (if vulnerable)' },
                    { cmd: 'nmap -sU -p 123 --script ntp-info 192.168.1.100', desc: 'NTP information gathering' }
                ],
                info: 'The monlist command (CVE-2013-5211) on older NTP servers reveals the last 600 clients. This can expose internal network topology.'
            },
            nfs: {
                name: 'NFS Enumeration',
                description: 'Network File System allows remote file access. Misconfigured exports can expose sensitive data.',
                commands: [
                    { cmd: 'showmount -e 192.168.1.100', desc: 'List exported shares' },
                    { cmd: 'rpcinfo -p 192.168.1.100', desc: 'Query RPC services' },
                    { cmd: 'nmap -p 2049 --script nfs-ls 192.168.1.100', desc: 'List NFS exports' },
                    { cmd: 'mount -t nfs 192.168.1.100:/share /mnt/nfs', desc: 'Mount NFS share' }
                ],
                info: 'NFS access control is based on UID/GID. Check /etc/exports for misconfigured permissions like no_root_squash which allows root access.'
            },
            smtp: {
                name: 'SMTP Enumeration',
                description: 'Simple Mail Transfer Protocol can validate user accounts through VRFY, EXPN, and RCPT TO commands.',
                commands: [
                    { cmd: 'smtp-user-enum -M VRFY -U users.txt -t 192.168.1.100', desc: 'Verify users from wordlist' },
                    { cmd: 'nmap -p 25 --script smtp-enum-users 192.168.1.100', desc: 'Nmap SMTP enumeration' },
                    { cmd: 'telnet 192.168.1.100 25 (then VRFY username)', desc: 'Manual user verification' },
                    { cmd: 'nc 192.168.1.100 25 (then EXPN all)', desc: 'Expand mailing lists' }
                ],
                info: 'VRFY confirms if a user exists. EXPN expands mailing lists. RCPT TO can validate recipients. Many modern servers disable these for security.'
            }
        };

        // Show protocol details
        function showProtocolDetails(protocol) {
            const data = protocolData[protocol];
            const detailsDiv = document.getElementById('protocolDetails');

            // Remove selected class from all cards
            document.querySelectorAll('.protocol-card').forEach(card => {
                card.classList.remove('selected');
            });

            // Add selected class to clicked card
            event.currentTarget.classList.add('selected');

            let html = `
                <div class="card" style="background: var(--surface-light); border-color: var(--accent);">
                    <h2>${data.name}</h2>
                    <p>${data.description}</p>

                    <div class="info-box">
                        <strong>Key Information:</strong> ${data.info}
                    </div>

                    <h3>Essential Commands</h3>
                    ${data.commands.map(cmd => `
                        <div class="code-block syntax-highlight">
                            <span class="command">${cmd.cmd}</span>
                        </div>
                        <p style="color: var(--text-dim); margin-top: -5px; margin-bottom: 15px;">${cmd.desc}</p>
                    `).join('')}
                </div>
            `;

            detailsDiv.innerHTML = html;
            detailsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Command builder functionality
        let selectedProtocol = null;
        let selectedTool = null;

        const toolsByProtocol = {
            netbios: ['nbtstat', 'nbtscan', 'nmap'],
            smb: ['smbclient', 'enum4linux', 'smbmap', 'net view'],
            snmp: ['snmpwalk', 'snmp-check', 'onesixtyone'],
            ldap: ['ldapsearch', 'nmap'],
            ntp: ['ntpq', 'ntpdc', 'nmap'],
            nfs: ['showmount', 'rpcinfo', 'nmap'],
            smtp: ['smtp-user-enum', 'telnet', 'nmap']
        };

        function selectProtocol(protocol) {
            selectedProtocol = protocol;
            selectedTool = null;

            // Update UI
            document.querySelectorAll('#protocolSelector .tool-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            event.target.classList.add('selected');

            // Show tool selector
            const toolSelector = document.getElementById('toolSelector');
            toolSelector.style.display = 'block';

            // Populate tools
            const toolOptions = document.getElementById('toolOptions');
            toolOptions.innerHTML = '';
            toolsByProtocol[protocol].forEach(tool => {
                const div = document.createElement('div');
                div.className = 'tool-option';
                div.textContent = tool;
                div.onclick = () => selectTool(tool);
                toolOptions.appendChild(div);
            });

            // Hide output
            document.getElementById('commandOutput').style.display = 'none';
        }

        function selectTool(tool) {
            selectedTool = tool;

            // Update UI
            document.querySelectorAll('#toolOptions .tool-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            event.target.classList.add('selected');

            // Show additional options if needed
            showAdditionalOptions();
        }

        function showAdditionalOptions() {
            const optionsDiv = document.getElementById('additionalOptions');
            optionsDiv.innerHTML = '';

            if (selectedProtocol === 'snmp' && selectedTool === 'snmpwalk') {
                optionsDiv.style.display = 'block';
                optionsDiv.innerHTML = `
                    <label class="builder-label">Community String:</label>
                    <input type="text" class="builder-input" id="communityString" placeholder="public" value="public">
                `;
            } else if (selectedProtocol === 'ldap') {
                optionsDiv.style.display = 'block';
                optionsDiv.innerHTML = `
                    <label class="builder-label">Base DN:</label>
                    <input type="text" class="builder-input" id="baseDN" placeholder="dc=example,dc=com">
                `;
            } else if (selectedProtocol === 'smtp' && selectedTool === 'smtp-user-enum') {
                optionsDiv.style.display = 'block';
                optionsDiv.innerHTML = `
                    <label class="builder-label">Wordlist Path:</label>
                    <input type="text" class="builder-input" id="wordlist" placeholder="/usr/share/wordlists/users.txt">
                `;
            } else {
                optionsDiv.style.display = 'none';
            }
        }

        function executeCommand() {
            if (!selectedProtocol || !selectedTool) {
                alert('Please select a protocol and tool first!');
                return;
            }

            const target = document.getElementById('targetInput').value;
            if (!target) {
                alert('Please enter a target IP or hostname!');
                return;
            }

            const outputDiv = document.getElementById('commandOutput');
            const commandLine = document.getElementById('commandLine');
            const outputText = document.getElementById('outputText');

            // Build command
            let command = buildCommand(target);
            commandLine.textContent = '$ ' + command;

            // Show loading
            outputText.innerHTML = '<div class="loading-spinner"></div>';
            outputDiv.style.display = 'block';

            // Simulate execution
            setTimeout(() => {
                outputText.innerHTML = generateOutput();
            }, 1500);
        }

        function buildCommand(target) {
            let cmd = '';

            switch (selectedProtocol) {
                case 'netbios':
                    if (selectedTool === 'nbtstat') cmd = `nbtstat -A ${target}`;
                    else if (selectedTool === 'nbtscan') cmd = `nbtscan -r ${target}`;
                    else if (selectedTool === 'nmap') cmd = `nmap -sV -p 137-139 --script nbstat.nse ${target}`;
                    break;
                case 'smb':
                    if (selectedTool === 'smbclient') cmd = `smbclient -L //${target} -N`;
                    else if (selectedTool === 'enum4linux') cmd = `enum4linux -a ${target}`;
                    else if (selectedTool === 'smbmap') cmd = `smbmap -H ${target}`;
                    else if (selectedTool === 'net view') cmd = `net view \\\\${target} /ALL`;
                    break;
                case 'snmp':
                    const community = document.getElementById('communityString')?.value || 'public';
                    if (selectedTool === 'snmpwalk') cmd = `snmpwalk -v2c -c ${community} ${target}`;
                    else if (selectedTool === 'snmp-check') cmd = `snmp-check ${target} -c ${community}`;
                    else if (selectedTool === 'onesixtyone') cmd = `onesixtyone -c community.txt ${target}`;
                    break;
                case 'ldap':
                    const baseDN = document.getElementById('baseDN')?.value || 'dc=example,dc=com';
                    if (selectedTool === 'ldapsearch') cmd = `ldapsearch -x -h ${target} -b "${baseDN}"`;
                    else if (selectedTool === 'nmap') cmd = `nmap -p 389 --script ldap-search ${target}`;
                    break;
                case 'ntp':
                    if (selectedTool === 'ntpq') cmd = `ntpq -c readlist ${target}`;
                    else if (selectedTool === 'ntpdc') cmd = `ntpdc -c monlist ${target}`;
                    else if (selectedTool === 'nmap') cmd = `nmap -sU -p 123 --script ntp-info ${target}`;
                    break;
                case 'nfs':
                    if (selectedTool === 'showmount') cmd = `showmount -e ${target}`;
                    else if (selectedTool === 'rpcinfo') cmd = `rpcinfo -p ${target}`;
                    else if (selectedTool === 'nmap') cmd = `nmap -p 2049 --script nfs-ls,nfs-showmount ${target}`;
                    break;
                case 'smtp':
                    const wordlist = document.getElementById('wordlist')?.value || 'users.txt';
                    if (selectedTool === 'smtp-user-enum') cmd = `smtp-user-enum -M VRFY -U ${wordlist} -t ${target}`;
                    else if (selectedTool === 'telnet') cmd = `telnet ${target} 25`;
                    else if (selectedTool === 'nmap') cmd = `nmap -p 25 --script smtp-enum-users ${target}`;
                    break;
            }

            return cmd;
        }

        function generateOutput() {
            const outputs = {
                netbios: `
NetBIOS Name Table for Remote Machine

Name               Type         Status
---------------------------------------------
WORKSTATION    <00>  UNIQUE      Registered
WORKSTATION    <20>  UNIQUE      Registered
WORKGROUP      <00>  GROUP       Registered
WORKGROUP      <1E>  GROUP       Registered
MAC Address = 00-0C-29-3F-4A-2B

[+] Found: WORKSTATION (Windows 10 Professional)`,

                smb: `
Starting enum4linux v0.8.9

Target Information
==================
Target ........... ${document.getElementById('targetInput').value}
RID Range ........ 500-550,1000-1050
Username ......... ''
Password ......... ''

 ==============================
|    Share Enumeration        |
 ==============================
[+] Attempting to map shares on ${document.getElementById('targetInput').value}

//192.168.1.100/ADMIN$    Mapping: DENIED, Listing: N/A
//192.168.1.100/C$        Mapping: DENIED, Listing: N/A
//192.168.1.100/IPC$      Mapping: OK, Listing: DENIED
//192.168.1.100/Users     Mapping: OK, Listing: OK
//192.168.1.100/Public    Mapping: OK, Listing: OK

 =============================
|    Users on ${document.getElementById('targetInput').value}    |
 =============================
user:[Administrator] rid:[0x1f4]
user:[Guest] rid:[0x1f5]
user:[john.doe] rid:[0x3e8]
user:[jane.smith] rid:[0x3e9]

[+] Enumeration complete`,

                snmp: `
SNMPv2-MIB::sysDescr.0 = STRING: Linux workstation 5.4.0-42-generic
SNMPv2-MIB::sysObjectID.0 = OID: NET-SNMP-MIB::netSnmpAgentOIDs.10
DISMAN-EVENT-MIB::sysUpTimeInstance = Timeticks: (123456789) 14 days, 6:56:07.89
SNMPv2-MIB::sysContact.0 = STRING: System Administrator <admin@example.com>
SNMPv2-MIB::sysName.0 = STRING: web-server-01
SNMPv2-MIB::sysLocation.0 = STRING: Server Room A, Rack 3

IF-MIB::ifNumber.0 = INTEGER: 2
IF-MIB::ifDescr.1 = STRING: eth0
IF-MIB::ifDescr.2 = STRING: lo

[+] System: Linux 5.4.0-42-generic
[+] Hostname: web-server-01
[+] Interfaces: eth0, lo`,

                ldap: `
# extended LDIF
# LDAPv3
# base <dc=example,dc=com> with scope subtree
# filter: (objectclass=*)

dn: dc=example,dc=com
objectClass: top
objectClass: domain
dc: example

dn: cn=Administrator,cn=Users,dc=example,dc=com
objectClass: top
objectClass: person
objectClass: user
cn: Administrator
memberOf: CN=Domain Admins,CN=Users,DC=example,DC=com

dn: cn=john.doe,cn=Users,dc=example,dc=com
objectClass: top
objectClass: person
objectClass: user
cn: john.doe
sAMAccountName: john.doe
mail: john.doe@example.com

# search result
search: 2
result: 0 Success
numEntries: 127`,

                ntp: `
remote           refid      st t when poll reach   delay   offset  jitter
==============================================================================
*time.nist.gov  .NIST.           1 u   64  128  377    12.345   0.123   0.456
+ntp.ubuntu.com .GPS.            1 u   32  128  377    23.456   0.234   0.567

     remote           refid      st t when poll reach   delay   offset  jitter
==============================================================================
 192.168.1.1     time.nist.gov    2 u   16   64  377     1.234   0.012   0.123
 192.168.1.50    time.nist.gov    2 u   32   64  377     2.345   0.023   0.234

[+] NTP server synchronized with time.nist.gov
[+] System uptime: 14 days, 6 hours, 23 minutes`,

                nfs: `
Export list for ${document.getElementById('targetInput').value}:
/home/shared         192.168.1.0/24
/var/www/html        192.168.1.100
/mnt/backup          (everyone)

[+] Found 3 exported shares

Mount Options:
/home/shared    - rw,sync,no_root_squash
/var/www/html   - ro,sync
/mnt/backup     - rw,async,no_subtree_check

[!] Warning: /home/shared has no_root_squash enabled
[!] Warning: /mnt/backup is world-accessible`,

                smtp: `
Starting smtp-user-enum v1.2

Mode ......... VRFY
Target ....... ${document.getElementById('targetInput').value}
Port ......... 25
Users ........ 100

220 mail.example.com ESMTP Postfix
######## Scan started at Tue Dec 23 10:15:42 2025 #########
250 2.1.5 <admin@example.com>
250 2.1.5 <john.doe@example.com>
250 2.1.5 <jane.smith@example.com>
550 5.1.1 <test@example.com>... User unknown
250 2.1.5 <support@example.com>

[+] Valid users found: admin, john.doe, jane.smith, support
######## Scan completed at Tue Dec 23 10:16:18 2025 #########
4 results.`
            };

            return outputs[selectedProtocol] || 'Enumeration complete. No results to display.';
        }

        // Quiz functionality
        const quizQuestions = [
            {
                question: 'Which NetBIOS command displays the name table of a remote computer?',
                options: ['nbtstat -a', 'nbtstat -A', 'nbtstat -c', 'nbtstat -n'],
                correct: 1
            },
            {
                question: 'What is the default TCP port for SMB file sharing?',
                options: ['139', '445', '389', '25'],
                correct: 1
            },
            {
                question: 'Which SNMP version transmits community strings in cleartext?',
                options: ['SNMPv3 only', 'SNMPv1 and v2c', 'SNMPv2c only', 'All versions'],
                correct: 1
            },
            {
                question: 'What does the SMTP VRFY command do?',
                options: ['Verifies server version', 'Validates user accounts', 'Verifies message routing', 'Validates DNS records'],
                correct: 1
            },
            {
                question: 'Which tool is specifically designed for comprehensive SMB enumeration?',
                options: ['nmap', 'nbtscan', 'enum4linux', 'snmpwalk'],
                correct: 2
            },
            {
                question: 'What port does LDAP commonly use for unencrypted communication?',
                options: ['636', '389', '3268', '88'],
                correct: 1
            },
            {
                question: 'The NTP monlist command is associated with which vulnerability?',
                options: ['CVE-2014-0160', 'CVE-2013-5211', 'CVE-2017-0144', 'CVE-2019-0708'],
                correct: 1
            },
            {
                question: 'Which command lists exported NFS shares on a target?',
                options: ['nfsstat -e', 'showmount -e', 'rpcinfo -n', 'mount -l'],
                correct: 1
            },
            {
                question: 'What does MIB stand for in SNMP context?',
                options: ['Machine Information Base', 'Management Information Base', 'Memory Index Block', 'Main Interface Bridge'],
                correct: 1
            },
            {
                question: 'Which NetBIOS suffix <1B> indicates?',
                options: ['Workstation service', 'File server service', 'Domain master browser', 'Messenger service'],
                correct: 2
            },
            {
                question: 'The no_root_squash option in NFS exports is dangerous because:',
                options: ['It disables encryption', 'It allows root access from clients', 'It exposes all files', 'It enables write access'],
                correct: 1
            },
            {
                question: 'Which command performs anonymous LDAP binding?',
                options: ['ldapsearch -x', 'ldapsearch -a', 'ldapsearch -n', 'ldapsearch -b'],
                correct: 0
            }
        ];

        function initQuiz() {
            const container = document.getElementById('quizContainer');
            container.innerHTML = '';

            quizQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'quiz-question';
                questionDiv.innerHTML = `
                    <div class="question-text">Question ${index + 1}: ${q.question}</div>
                    <div class="quiz-options">
                        ${q.options.map((opt, i) => `
                            <div class="quiz-option" onclick="selectOption(${index}, ${i})" data-question="${index}" data-option="${i}">
                                ${String.fromCharCode(65 + i)}. ${opt}
                            </div>
                        `).join('')}
                    </div>
                `;
                container.appendChild(questionDiv);
            });
        }

        let userAnswers = new Array(quizQuestions.length).fill(null);

        function selectOption(questionIndex, optionIndex) {
            userAnswers[questionIndex] = optionIndex;

            // Remove selected class from all options in this question
            document.querySelectorAll(`[data-question="${questionIndex}"]`).forEach(opt => {
                opt.classList.remove('selected');
            });

            // Add selected class to clicked option
            document.querySelector(`[data-question="${questionIndex}"][data-option="${optionIndex}"]`).classList.add('selected');
        }

        function submitQuiz() {
            // Check if all questions answered
            if (userAnswers.includes(null)) {
                alert('Please answer all questions before submitting!');
                return;
            }

            // Calculate score
            let correct = 0;
            quizQuestions.forEach((q, index) => {
                const optionElements = document.querySelectorAll(`[data-question="${index}"]`);

                if (userAnswers[index] === q.correct) {
                    correct++;
                    optionElements[userAnswers[index]].classList.add('correct');
                } else {
                    optionElements[userAnswers[index]].classList.add('incorrect');
                    optionElements[q.correct].classList.add('correct');
                }

                // Disable all options
                optionElements.forEach(opt => {
                    opt.style.pointerEvents = 'none';
                });
            });

            // Show results
            const percentage = (correct / quizQuestions.length * 100).toFixed(0);
            const resultDiv = document.getElementById('quizResult');
            const scoreDiv = document.getElementById('resultScore');
            const messageDiv = document.getElementById('resultMessage');
            const xpDiv = document.getElementById('xpReward');

            scoreDiv.textContent = `${correct}/${quizQuestions.length} (${percentage}%)`;

            if (percentage >= 80) {
                messageDiv.textContent = 'Excellent! You are an Enumeration Master!';
                messageDiv.style.color = 'var(--success)';
                xpDiv.style.display = 'block';
                quizCompleted = true;
                updateProgress();
            } else if (percentage >= 60) {
                messageDiv.textContent = 'Good job! Review the incorrect answers to improve.';
                messageDiv.style.color = 'var(--warning)';
            } else {
                messageDiv.textContent = 'Keep studying! Review the material and try again.';
                messageDiv.style.color = 'var(--accent)';
            }

            resultDiv.classList.add('show');
            resultDiv.scrollIntoView({ behavior: 'smooth' });

            // Disable submit button
            event.target.disabled = true;
            event.target.textContent = 'Quiz Completed';
        }

        // Initialize quiz when page loads
        document.addEventListener('DOMContentLoaded', () => {
            initQuiz();
        });
    </script>
<script src="../../components/FluxCapacitor.js"></script>
</body>
</html>