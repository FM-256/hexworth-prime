<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQLMap Training Lab - Web House | Hexworth Prime</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a1628 0%, #0f2847 100%);
            min-height: 100vh;
            padding: 20px;
            color: #e0e0e0;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(10, 22, 40, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            border: 2px solid rgba(6, 182, 212, 0.3);
        }

        .header {
            background: linear-gradient(135deg, #0369a1 0%, #06b6d4 100%);
            padding: 30px;
            text-align: center;
            border-bottom: 3px solid #06b6d4;
        }

        .header h1 {
            color: #ffffff;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            color: #e0f2fe;
            font-size: 1.1em;
        }

        .back-link {
            display: inline-block;
            margin-top: 15px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .back-link:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 0;
            min-height: calc(100vh - 200px);
        }

        .workspace {
            display: flex;
            flex-direction: column;
            border-right: 2px solid rgba(6, 182, 212, 0.3);
        }

        .tab-container {
            display: flex;
            background: rgba(10, 22, 40, 0.9);
            border-bottom: 2px solid rgba(6, 182, 212, 0.3);
            padding: 10px 20px 0;
            gap: 5px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 20px;
            background: rgba(3, 105, 161, 0.3);
            color: #06b6d4;
            border: none;
            cursor: pointer;
            border-radius: 10px 10px 0 0;
            transition: all 0.3s ease;
            font-size: 0.95em;
            font-weight: 500;
            border: 2px solid transparent;
            border-bottom: none;
        }

        .tab:hover {
            background: rgba(6, 182, 212, 0.3);
            color: #e0e0e0;
        }

        .tab.active {
            background: rgba(3, 105, 161, 0.6);
            color: #ffffff;
            border-color: #06b6d4;
        }

        .tab-content {
            display: none;
            flex: 1;
            overflow: hidden;
            flex-direction: column;
        }

        .tab-content.active {
            display: flex;
        }

        /* Learn Tab Styles */
        .learn-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .learn-section {
            margin-bottom: 30px;
        }

        .learn-section h2 {
            color: #06b6d4;
            font-size: 1.8em;
            margin-bottom: 15px;
            border-bottom: 2px solid #0369a1;
            padding-bottom: 10px;
        }

        .learn-section h3 {
            color: #38bdf8;
            font-size: 1.3em;
            margin: 20px 0 10px;
        }

        .learn-section p {
            line-height: 1.8;
            margin-bottom: 15px;
            color: #d0d0d0;
        }

        .learn-section ul, .learn-section ol {
            margin-left: 25px;
            margin-bottom: 15px;
        }

        .learn-section li {
            line-height: 1.8;
            margin-bottom: 8px;
            color: #d0d0d0;
        }

        .info-box {
            background: rgba(6, 182, 212, 0.15);
            border-left: 4px solid #06b6d4;
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        .info-box.warning {
            background: rgba(251, 146, 60, 0.15);
            border-left-color: #fb923c;
        }

        .info-box.success {
            background: rgba(34, 197, 94, 0.15);
            border-left-color: #22c55e;
        }

        .info-box.danger {
            background: rgba(239, 68, 68, 0.15);
            border-left-color: #ef4444;
        }

        .info-box strong {
            color: #06b6d4;
            display: block;
            margin-bottom: 5px;
        }

        .info-box.warning strong {
            color: #fb923c;
        }

        .info-box.success strong {
            color: #22c55e;
        }

        .info-box.danger strong {
            color: #ef4444;
        }

        code {
            background: rgba(3, 105, 161, 0.3);
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #06b6d4;
            font-size: 0.9em;
        }

        .code-block {
            background: rgba(0, 0, 0, 0.6);
            padding: 15px 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
            border: 1px solid rgba(6, 182, 212, 0.3);
            font-size: 0.9em;
            line-height: 1.6;
        }

        .code-block .comment {
            color: #6b7280;
        }

        .code-block .flag {
            color: #22c55e;
            font-weight: 600;
        }

        .code-block .url {
            color: #06b6d4;
        }

        .code-block .option {
            color: #fbbf24;
        }

        .code-block .value {
            color: #a78bfa;
        }

        /* Injection Lab Styles */
        .injection-lab {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .terminal-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: rgba(0, 0, 0, 0.4);
        }

        .terminal-header {
            background: rgba(0, 0, 0, 0.6);
            padding: 12px 20px;
            border-bottom: 2px solid rgba(6, 182, 212, 0.2);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .terminal-header h3 {
            color: #06b6d4;
            font-size: 1.1em;
        }

        .scenario-selector {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .scenario-selector label {
            color: #06b6d4;
            font-size: 0.9em;
        }

        .scenario-selector select {
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid rgba(6, 182, 212, 0.3);
            color: #e0e0e0;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.9em;
        }

        .terminal-output {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.6;
        }

        .terminal-line {
            margin-bottom: 8px;
            white-space: pre-wrap;
        }

        .terminal-line.info {
            color: #06b6d4;
        }

        .terminal-line.success {
            color: #22c55e;
        }

        .terminal-line.warning {
            color: #fb923c;
        }

        .terminal-line.error {
            color: #ef4444;
        }

        .terminal-line.prompt {
            color: #a78bfa;
            font-weight: 600;
        }

        .terminal-input-wrapper {
            background: rgba(0, 0, 0, 0.6);
            padding: 15px 20px;
            border-top: 2px solid rgba(6, 182, 212, 0.2);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .terminal-prompt {
            color: #22c55e;
            font-family: 'Courier New', monospace;
            font-weight: 600;
        }

        .terminal-input {
            flex: 1;
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid rgba(6, 182, 212, 0.3);
            color: #e0e0e0;
            padding: 10px 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
        }

        .terminal-input:focus {
            outline: none;
            border-color: #06b6d4;
            background: rgba(0, 0, 0, 0.8);
        }

        .autocomplete-dropdown {
            position: absolute;
            bottom: 100%;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.95);
            border: 2px solid #06b6d4;
            border-radius: 6px 6px 0 0;
            max-height: 200px;
            overflow-y: auto;
            display: none;
        }

        .autocomplete-dropdown.show {
            display: block;
        }

        .autocomplete-item {
            padding: 8px 15px;
            color: #d0d0d0;
            cursor: pointer;
            border-bottom: 1px solid rgba(6, 182, 212, 0.2);
        }

        .autocomplete-item:hover,
        .autocomplete-item.selected {
            background: rgba(6, 182, 212, 0.3);
            color: #ffffff;
        }

        .autocomplete-item:last-child {
            border-bottom: none;
        }

        .execute-btn {
            padding: 10px 20px;
            background: linear-gradient(135deg, #0369a1, #06b6d4);
            border: 2px solid #06b6d4;
            color: #ffffff;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .execute-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.4);
        }

        .clear-btn {
            padding: 10px 20px;
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid #ef4444;
            color: #ef4444;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .clear-btn:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        /* Challenges Tab Styles */
        .challenges-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .challenge-card {
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(6, 182, 212, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .challenge-card:hover {
            border-color: #06b6d4;
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.2);
        }

        .challenge-card.completed {
            border-color: #22c55e;
            background: rgba(34, 197, 94, 0.1);
        }

        .challenge-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .challenge-title {
            color: #06b6d4;
            font-size: 1.3em;
            font-weight: 600;
        }

        .challenge-card.completed .challenge-title {
            color: #22c55e;
        }

        .challenge-points {
            background: rgba(6, 182, 212, 0.3);
            padding: 6px 12px;
            border-radius: 20px;
            color: #06b6d4;
            font-weight: 600;
            font-size: 0.9em;
        }

        .challenge-card.completed .challenge-points {
            background: rgba(34, 197, 94, 0.3);
            color: #22c55e;
        }

        .challenge-description {
            color: #d0d0d0;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .challenge-target {
            background: rgba(0, 0, 0, 0.6);
            padding: 10px 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            color: #06b6d4;
            margin-bottom: 15px;
            font-size: 0.9em;
        }

        .challenge-input-wrapper {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .challenge-input {
            flex: 1;
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid rgba(6, 182, 212, 0.3);
            color: #e0e0e0;
            padding: 10px 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .challenge-input:focus {
            outline: none;
            border-color: #06b6d4;
        }

        .submit-btn {
            padding: 10px 20px;
            background: linear-gradient(135deg, #0369a1, #06b6d4);
            border: 2px solid #06b6d4;
            color: #ffffff;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.4);
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .challenge-result {
            padding: 10px 15px;
            border-radius: 6px;
            font-weight: 600;
            text-align: center;
            margin-top: 10px;
            display: none;
        }

        .challenge-result.show {
            display: block;
        }

        .challenge-result.success {
            background: rgba(34, 197, 94, 0.2);
            border: 2px solid #22c55e;
            color: #22c55e;
        }

        .challenge-result.error {
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid #ef4444;
            color: #ef4444;
        }

        /* Reference Tab Styles */
        .reference-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .reference-section {
            margin-bottom: 30px;
        }

        .reference-section h2 {
            color: #06b6d4;
            font-size: 1.6em;
            margin-bottom: 15px;
            border-bottom: 2px solid #0369a1;
            padding-bottom: 10px;
        }

        .reference-section h3 {
            color: #38bdf8;
            font-size: 1.2em;
            margin: 20px 0 10px;
        }

        .reference-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        .reference-table th {
            background: rgba(3, 105, 161, 0.4);
            color: #06b6d4;
            padding: 12px;
            text-align: left;
            border: 1px solid rgba(6, 182, 212, 0.3);
        }

        .reference-table td {
            padding: 10px 12px;
            border: 1px solid rgba(6, 182, 212, 0.2);
            color: #d0d0d0;
        }

        .reference-table td:first-child {
            font-family: 'Courier New', monospace;
            color: #06b6d4;
            font-size: 0.9em;
        }

        .reference-table tr:hover {
            background: rgba(6, 182, 212, 0.1);
        }

        /* Settings Tab Styles */
        .settings-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .settings-section {
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(6, 182, 212, 0.3);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .settings-section h2 {
            color: #06b6d4;
            font-size: 1.5em;
            margin-bottom: 20px;
            border-bottom: 2px solid #0369a1;
            padding-bottom: 10px;
        }

        .setting-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid rgba(6, 182, 212, 0.2);
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-label {
            flex: 1;
        }

        .setting-label h3 {
            color: #38bdf8;
            font-size: 1.1em;
            margin-bottom: 5px;
        }

        .setting-label p {
            color: #9ca3af;
            font-size: 0.9em;
        }

        .toggle-switch {
            position: relative;
            width: 60px;
            height: 30px;
            background: rgba(239, 68, 68, 0.3);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #ef4444;
        }

        .toggle-switch.on {
            background: rgba(34, 197, 94, 0.3);
            border-color: #22c55e;
        }

        .toggle-knob {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 22px;
            height: 22px;
            background: #ef4444;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .toggle-switch.on .toggle-knob {
            left: 32px;
            background: #22c55e;
        }

        .action-btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #0369a1, #06b6d4);
            border: 2px solid #06b6d4;
            color: #ffffff;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 0.95em;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.4);
        }

        .action-btn.danger {
            background: linear-gradient(135deg, #b91c1c, #ef4444);
            border-color: #ef4444;
        }

        .action-btn.danger:hover {
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4);
        }

        /* Sidebar Styles */
        .sidebar {
            background: rgba(0, 0, 0, 0.3);
            padding: 25px;
            overflow-y: auto;
        }

        .stats-panel {
            background: rgba(3, 105, 161, 0.2);
            border: 2px solid rgba(6, 182, 212, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .stats-panel h3 {
            color: #06b6d4;
            font-size: 1.3em;
            margin-bottom: 15px;
            text-align: center;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(6, 182, 212, 0.2);
        }

        .stat-item:last-child {
            border-bottom: none;
        }

        .stat-label {
            color: #9ca3af;
            font-size: 0.9em;
        }

        .stat-value {
            color: #06b6d4;
            font-weight: 600;
        }

        .progress-bar {
            background: rgba(0, 0, 0, 0.6);
            height: 25px;
            border-radius: 12px;
            overflow: hidden;
            margin-top: 10px;
            border: 1px solid rgba(6, 182, 212, 0.3);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #0369a1, #06b6d4);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ffffff;
            font-size: 0.8em;
            font-weight: 600;
        }

        .hints-panel {
            background: rgba(251, 146, 60, 0.15);
            border: 2px solid rgba(251, 146, 60, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .hints-panel h3 {
            color: #fb923c;
            font-size: 1.2em;
            margin-bottom: 15px;
        }

        .hint-item {
            background: rgba(0, 0, 0, 0.4);
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 10px;
            color: #d0d0d0;
            font-size: 0.9em;
            line-height: 1.6;
        }

        .hint-item:last-child {
            margin-bottom: 0;
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(6, 182, 212, 0.5);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(6, 182, 212, 0.7);
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .workspace {
                border-right: none;
                border-bottom: 2px solid rgba(6, 182, 212, 0.3);
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .tab {
                font-size: 0.85em;
                padding: 10px 15px;
            }

            .learn-content,
            .challenges-content,
            .reference-content,
            .settings-content {
                padding: 20px;
            }
        }

        /* Dark Mode Toggle */
        body.light-mode {
            background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%);
            color: #1e293b;
        }

        body.light-mode .container {
            background: rgba(255, 255, 255, 0.95);
            border-color: #0369a1;
        }

        body.light-mode .learn-section h2,
        body.light-mode .stats-panel h3,
        body.light-mode .challenge-title {
            color: #0369a1;
        }

        body.light-mode .learn-section p,
        body.light-mode .learn-section li,
        body.light-mode .challenge-description,
        body.light-mode .stat-label {
            color: #334155;
        }

        body.light-mode .terminal-output {
            background: rgba(255, 255, 255, 0.8);
        }

        body.light-mode .terminal-line {
            color: #1e293b;
        }

        /* Animation for successful challenge completion */
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        .challenge-card.completed {
            animation: pulse 0.5s ease-in-out;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>SQLMap Training Lab</h1>
            <p>Master SQL Injection Detection and Exploitation - Educational Purposes Only</p>
            <a href="../../../dashboard.html" class="back-link">Back to Dashboard</a>
        </div>

        <div class="main-content">
            <div class="workspace">
                <div class="tab-container">
                    <button class="tab active" data-tab="learn">Learn</button>
                    <button class="tab" data-tab="injection-lab">Injection Lab</button>
                    <button class="tab" data-tab="challenges">Challenges</button>
                    <button class="tab" data-tab="reference">Reference</button>
                    <button class="tab" data-tab="settings">Settings</button>
                </div>

                <!-- Learn Tab -->
                <div class="tab-content active" id="learn">
                    <div class="learn-content">
                        <div class="info-box danger">
                            <strong>Legal and Ethical Warning</strong>
                            This training module is for EDUCATIONAL PURPOSES ONLY. SQL injection is illegal when performed without explicit written authorization. Only test on systems you own or have permission to test. Unauthorized access to computer systems is a crime under laws including the Computer Fraud and Abuse Act (CFAA) and equivalent international legislation. This tool simulates SQLMap behavior in a safe, controlled environment.
                        </div>

                        <div class="learn-section">
                            <h2>What is SQLMap?</h2>
                            <p>SQLMap is an open-source penetration testing tool that automates the process of detecting and exploiting SQL injection vulnerabilities in web applications. It supports a wide range of database management systems including MySQL, PostgreSQL, Oracle, Microsoft SQL Server, SQLite, and many others.</p>

                            <h3>Key Capabilities</h3>
                            <ul>
                                <li><strong>Automatic SQL Injection Detection:</strong> Identifies vulnerable parameters in URLs, forms, cookies, and HTTP headers</li>
                                <li><strong>Database Fingerprinting:</strong> Determines the exact DBMS type and version</li>
                                <li><strong>Data Extraction:</strong> Retrieves database names, tables, columns, and data</li>
                                <li><strong>Advanced Exploitation:</strong> File system access, OS command execution (in specific scenarios)</li>
                                <li><strong>Bypass Techniques:</strong> WAF/IPS evasion using tamper scripts and encoding</li>
                                <li><strong>Multiple Injection Techniques:</strong> Supports UNION, Boolean-based blind, time-based blind, error-based, and stacked queries</li>
                            </ul>

                            <h3>Why Learn SQLMap?</h3>
                            <p>Understanding SQLMap is crucial for both offensive and defensive security:</p>
                            <ul>
                                <li><strong>Security Testing:</strong> Identify SQL injection vulnerabilities in your applications before attackers do</li>
                                <li><strong>Vulnerability Assessment:</strong> Comprehensive testing of web application attack surfaces</li>
                                <li><strong>Defense Understanding:</strong> Learn how attackers exploit SQL injection to better defend against it</li>
                                <li><strong>Compliance:</strong> Meet security testing requirements for standards like PCI-DSS, OWASP Top 10</li>
                            </ul>
                        </div>

                        <div class="learn-section">
                            <h2>SQL Injection Types</h2>

                            <h3>1. UNION-Based SQL Injection</h3>
                            <p>The most straightforward type. Uses the UNION SQL operator to combine the results of the original query with injected queries, allowing direct data extraction.</p>
                            <div class="code-block">
<span class="comment"># Original vulnerable query</span>
SELECT * FROM products WHERE id = '1'

<span class="comment"># Injected payload</span>
' UNION SELECT username, password, NULL FROM users--

<span class="comment"># Final query</span>
SELECT * FROM products WHERE id = '1' UNION SELECT username, password, NULL FROM users--'
                            </div>
                            <div class="info-box">
                                <strong>Detection Method:</strong>
                                SQLMap tests for UNION injection by determining the number of columns and injecting payloads to extract data directly from the database.
                            </div>

                            <h3>2. Boolean-Based Blind SQL Injection</h3>
                            <p>Used when the application doesn't return error messages or data, but behaves differently based on TRUE or FALSE conditions. Data is extracted one bit at a time.</p>
                            <div class="code-block">
<span class="comment"># Test if first character of database name is 'a'</span>
' AND SUBSTRING(database(), 1, 1) = 'a'--

<span class="comment"># If true: page loads normally</span>
<span class="comment"># If false: page behaves differently (error, different content, etc.)</span>
                            </div>
                            <div class="info-box">
                                <strong>Detection Method:</strong>
                                SQLMap sends payloads that cause TRUE/FALSE conditions and analyzes page responses to infer data character by character.
                            </div>

                            <h3>3. Time-Based Blind SQL Injection</h3>
                            <p>When even boolean responses aren't visible, time delays are used. The application pauses execution based on injected conditions.</p>
                            <div class="code-block">
<span class="comment"># MySQL example - delay if condition is true</span>
' AND IF(SUBSTRING(database(),1,1)='a', SLEEP(5), 0)--

<span class="comment"># SQL Server example</span>
'; IF (1=1) WAITFOR DELAY '00:00:05'--

<span class="comment"># PostgreSQL example</span>
'; SELECT CASE WHEN (1=1) THEN pg_sleep(5) ELSE pg_sleep(0) END--
                            </div>
                            <div class="info-box warning">
                                <strong>Slowest Method:</strong>
                                Time-based blind injection is extremely slow because each bit of information requires waiting for timeout delays. Extracting a single database name can take minutes or hours.
                            </div>

                            <h3>4. Error-Based SQL Injection</h3>
                            <p>Leverages database error messages to extract information. Some DBMS functions return data within error messages.</p>
                            <div class="code-block">
<span class="comment"># MySQL - Extract data via error message</span>
' AND extractvalue(1, concat(0x7e, (SELECT database()), 0x7e))--

<span class="comment"># MSSQL - Use type conversion errors</span>
' AND 1=CONVERT(int, (SELECT @@version))--

<span class="comment"># Error message reveals: "Conversion failed when converting the nvarchar value 'Microsoft SQL Server 2019...' to data type int."</span>
                            </div>

                            <h3>5. Stacked Queries</h3>
                            <p>Allows execution of multiple SQL statements separated by semicolons. Enables advanced exploitation like INSERT, UPDATE, or stored procedure calls.</p>
                            <div class="code-block">
<span class="comment"># Original query</span>
SELECT * FROM products WHERE id = 1

<span class="comment"># Injected payload (creates new admin user)</span>
1; INSERT INTO users (username, password, role) VALUES ('hacker', 'pwned', 'admin')--

<span class="comment"># Both queries execute</span>
SELECT * FROM products WHERE id = 1;
INSERT INTO users (username, password, role) VALUES ('hacker', 'pwned', 'admin')--
                            </div>
                            <div class="info-box danger">
                                <strong>Most Dangerous:</strong>
                                Stacked queries can modify database contents, execute stored procedures, and potentially execute OS commands through database features like xp_cmdshell (MSSQL) or LOAD_FILE (MySQL).
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>SQLMap Detection Techniques</h2>

                            <h3>Parameter Discovery</h3>
                            <p>SQLMap can test multiple parameter types:</p>
                            <ul>
                                <li><strong>GET Parameters:</strong> URL query strings like <code>?id=1&cat=books</code></li>
                                <li><strong>POST Data:</strong> Form submissions and request body data</li>
                                <li><strong>HTTP Headers:</strong> Cookie, User-Agent, Referer, X-Forwarded-For</li>
                                <li><strong>URI Path:</strong> RESTful parameters in the URL path</li>
                            </ul>

                            <h3>Fingerprinting Process</h3>
                            <p>SQLMap identifies the database system through:</p>
                            <ol>
                                <li><strong>Banner Grabbing:</strong> Extract version information using functions like <code>@@version</code>, <code>version()</code></li>
                                <li><strong>Syntax Differences:</strong> Test DBMS-specific syntax (e.g., MySQL uses <code>#</code> for comments, MSSQL uses <code>--</code>)</li>
                                <li><strong>Function Behavior:</strong> Test database-specific functions like <code>SUBSTRING</code> vs <code>SUBSTR</code></li>
                                <li><strong>Error Messages:</strong> Analyze error message patterns unique to each DBMS</li>
                                <li><strong>Response Timing:</strong> Different databases have different execution speeds and behaviors</li>
                            </ol>

                            <h3>Injection Point Testing</h3>
                            <div class="code-block">
<span class="comment"># SQLMap tests various payloads to confirm vulnerability:</span>

<span class="comment"># 1. Basic syntax test</span>
id=1'  <span class="comment">(causes syntax error if vulnerable)</span>

<span class="comment"># 2. Boolean test</span>
id=1' AND '1'='1  <span class="comment">(should return normal page)</span>
id=1' AND '1'='2  <span class="comment">(should return different/error page)</span>

<span class="comment"># 3. UNION test</span>
id=1' UNION ALL SELECT NULL--  <span class="comment">(incrementally adds columns)</span>

<span class="comment"># 4. Time delay test</span>
id=1' AND SLEEP(5)--  <span class="comment">(response delayed by 5 seconds)</span>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Database Fingerprinting</h2>

                            <h3>Version Detection</h3>
                            <p>Each DBMS has specific functions to reveal version information:</p>
                            <div class="code-block">
<span class="comment"># MySQL/MariaDB</span>
SELECT VERSION()
SELECT @@version

<span class="comment"># PostgreSQL</span>
SELECT version()

<span class="comment"># Microsoft SQL Server</span>
SELECT @@VERSION

<span class="comment"># Oracle</span>
SELECT * FROM v$version
SELECT banner FROM v$version WHERE banner LIKE 'Oracle%'

<span class="comment"># SQLite</span>
SELECT sqlite_version()
                            </div>

                            <h3>Database Enumeration</h3>
                            <p>SQLMap uses system tables to enumerate database structure:</p>
                            <div class="code-block">
<span class="comment"># MySQL - List all databases</span>
SELECT schema_name FROM information_schema.schemata

<span class="comment"># List tables in specific database</span>
SELECT table_name FROM information_schema.tables WHERE table_schema='targetdb'

<span class="comment"># List columns in specific table</span>
SELECT column_name FROM information_schema.columns WHERE table_name='users'

<span class="comment"># MSSQL - List databases</span>
SELECT name FROM sys.databases

<span class="comment"># PostgreSQL - List databases</span>
SELECT datname FROM pg_database
                            </div>

                            <h3>Data Extraction</h3>
                            <div class="code-block">
<span class="comment"># Once structure is known, extract data:</span>
SELECT username, password FROM users

<span class="comment"># Count rows (for optimization)</span>
SELECT COUNT(*) FROM users

<span class="comment"># Extract specific rows</span>
SELECT username, password FROM users LIMIT 0,1  <span class="comment">(MySQL)</span>
SELECT TOP 1 username, password FROM users     <span class="comment">(MSSQL)</span>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Defense Against SQL Injection</h2>

                            <h3>Primary Defenses</h3>
                            <ol>
                                <li>
                                    <strong>Prepared Statements (Parameterized Queries)</strong>
                                    <div class="code-block">
<span class="comment"># VULNERABLE CODE (Python example)</span>
cursor.execute("SELECT * FROM users WHERE id = '" + user_id + "'")

<span class="comment"># SECURE CODE</span>
cursor.execute("SELECT * FROM users WHERE id = ?", (user_id,))
                                    </div>
                                </li>
                                <li>
                                    <strong>Input Validation and Sanitization</strong>
                                    <ul>
                                        <li>Whitelist allowed characters</li>
                                        <li>Validate data types (ensure numbers are numeric)</li>
                                        <li>Limit input length</li>
                                        <li>Escape special characters</li>
                                    </ul>
                                </li>
                                <li>
                                    <strong>Least Privilege Principle</strong>
                                    <ul>
                                        <li>Database user should only have necessary permissions</li>
                                        <li>Never use 'root' or 'sa' for web application database connections</li>
                                        <li>Disable dangerous functions (xp_cmdshell, LOAD_FILE, etc.)</li>
                                    </ul>
                                </li>
                                <li>
                                    <strong>Web Application Firewalls (WAF)</strong>
                                    <ul>
                                        <li>Filter common SQL injection patterns</li>
                                        <li>Rate limiting to slow down automated attacks</li>
                                        <li>Not a replacement for secure coding, but adds defense in depth</li>
                                    </ul>
                                </li>
                            </ol>

                            <h3>Detection and Monitoring</h3>
                            <ul>
                                <li>Log all database errors and unusual query patterns</li>
                                <li>Monitor for suspicious characters in inputs (', --, /*, UNION, etc.)</li>
                                <li>Alert on multiple failed queries from same source</li>
                                <li>Implement intrusion detection systems (IDS)</li>
                            </ul>

                            <div class="info-box success">
                                <strong>Best Practice:</strong>
                                Defense in depth is key. Use multiple layers: secure code + input validation + least privilege + WAF + monitoring. No single defense is perfect.
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Responsible Disclosure</h2>
                            <p>If you discover SQL injection vulnerabilities during authorized testing:</p>
                            <ol>
                                <li><strong>Document thoroughly:</strong> Steps to reproduce, affected parameters, potential impact</li>
                                <li><strong>Report responsibly:</strong> Contact the organization's security team, not social media</li>
                                <li><strong>Give time to patch:</strong> Typically 90 days before public disclosure</li>
                                <li><strong>Don't exfiltrate data:</strong> Proving the vulnerability exists is enough; don't steal data</li>
                                <li><strong>Follow bug bounty rules:</strong> If participating in a program, adhere to their guidelines</li>
                            </ol>

                            <div class="info-box warning">
                                <strong>Remember:</strong>
                                The goal of security testing is to improve security, not to cause harm. Always act ethically and within legal boundaries.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Injection Lab Tab -->
                <div class="tab-content" id="injection-lab">
                    <div class="injection-lab">
                        <div class="terminal-wrapper">
                            <div class="terminal-header">
                                <h3>SQLMap Command Simulator</h3>
                                <div class="scenario-selector">
                                    <label>Target Scenario:</label>
                                    <select id="scenario-select">
                                        <option value="basic-get">Basic GET Parameter (UNION)</option>
                                        <option value="blind-boolean">Boolean-Based Blind</option>
                                        <option value="time-based">Time-Based Blind</option>
                                        <option value="error-based">Error-Based Injection</option>
                                        <option value="post-injection">POST Data Injection</option>
                                        <option value="cookie-injection">Cookie Parameter Injection</option>
                                    </select>
                                </div>
                            </div>
                            <div class="terminal-output" id="terminal-output">
                                <div class="terminal-line info">SQLMap Training Simulator v1.0</div>
                                <div class="terminal-line info">Type 'help' for available commands or start with: sqlmap -u "http://target.com/page?id=1" --dbs</div>
                                <div class="terminal-line warning">WARNING: This is a SIMULATION. No real network requests are made.</div>
                                <div class="terminal-line">Ready for commands...</div>
                            </div>
                            <div class="terminal-input-wrapper">
                                <div class="autocomplete-dropdown" id="autocomplete"></div>
                                <span class="terminal-prompt">root@kali:~#</span>
                                <input type="text" class="terminal-input" id="command-input" placeholder="Enter SQLMap command..." autocomplete="off">
                                <button class="execute-btn" id="execute-btn">Execute</button>
                                <button class="clear-btn" id="clear-btn">Clear</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Challenges Tab -->
                <div class="tab-content" id="challenges">
                    <div class="challenges-content">
                        <div class="info-box">
                            <strong>Challenge Mode</strong>
                            Complete these challenges to test your SQLMap knowledge. Each challenge awards points and tracks your progress. Use the Injection Lab to practice commands!
                        </div>

                        <!-- Challenge 1 -->
                        <div class="challenge-card" data-challenge="1">
                            <div class="challenge-header">
                                <h3 class="challenge-title">Challenge 1: Basic Detection</h3>
                                <span class="challenge-points">10 points</span>
                            </div>
                            <p class="challenge-description">
                                Use SQLMap to detect if the target URL is vulnerable to SQL injection. What flag should you use to enumerate all available databases?
                            </p>
                            <div class="challenge-target">Target: http://shop.local/product.php?id=5</div>
                            <div class="challenge-input-wrapper">
                                <input type="text" class="challenge-input" placeholder="Enter the flag (e.g., --flag)" data-answer="--dbs">
                                <button class="submit-btn">Submit</button>
                            </div>
                            <div class="challenge-result"></div>
                        </div>

                        <!-- Challenge 2 -->
                        <div class="challenge-card" data-challenge="2">
                            <div class="challenge-header">
                                <h3 class="challenge-title">Challenge 2: Database Enumeration</h3>
                                <span class="challenge-points">15 points</span>
                            </div>
                            <p class="challenge-description">
                                After discovering databases named 'shop_db', 'mysql', and 'information_schema', you need to enumerate tables in 'shop_db'. What flag specifies the target database?
                            </p>
                            <div class="challenge-target">Available databases: shop_db, mysql, information_schema</div>
                            <div class="challenge-input-wrapper">
                                <input type="text" class="challenge-input" placeholder="Enter the flag with value (e.g., --flag=value)" data-answer="-D shop_db">
                                <button class="submit-btn">Submit</button>
                            </div>
                            <div class="challenge-result"></div>
                        </div>

                        <!-- Challenge 3 -->
                        <div class="challenge-card" data-challenge="3">
                            <div class="challenge-header">
                                <h3 class="challenge-title">Challenge 3: Table Discovery</h3>
                                <span class="challenge-points">15 points</span>
                            </div>
                            <p class="challenge-description">
                                You're targeting the 'shop_db' database. What flag will enumerate all tables in this database?
                            </p>
                            <div class="challenge-target">Database: shop_db</div>
                            <div class="challenge-input-wrapper">
                                <input type="text" class="challenge-input" placeholder="Enter the flag" data-answer="--tables">
                                <button class="submit-btn">Submit</button>
                            </div>
                            <div class="challenge-result"></div>
                        </div>

                        <!-- Challenge 4 -->
                        <div class="challenge-card" data-challenge="4">
                            <div class="challenge-header">
                                <h3 class="challenge-title">Challenge 4: Column Extraction</h3>
                                <span class="challenge-points">20 points</span>
                            </div>
                            <p class="challenge-description">
                                You've found a 'users' table in 'shop_db'. What flag combination will show you all columns in this table? (format: -D database -T table --flag)
                            </p>
                            <div class="challenge-target">Database: shop_db | Table: users</div>
                            <div class="challenge-input-wrapper">
                                <input type="text" class="challenge-input" placeholder="Enter complete flag combo" data-answer="-D shop_db -T users --columns">
                                <button class="submit-btn">Submit</button>
                            </div>
                            <div class="challenge-result"></div>
                        </div>

                        <!-- Challenge 5 -->
                        <div class="challenge-card" data-challenge="5">
                            <div class="challenge-header">
                                <h3 class="challenge-title">Challenge 5: Data Dumping</h3>
                                <span class="challenge-points">20 points</span>
                            </div>
                            <p class="challenge-description">
                                Extract all data from the 'users' table. What flag dumps the data? (Provide just the dump flag)
                            </p>
                            <div class="challenge-target">Database: shop_db | Table: users | Columns: id, username, password, email</div>
                            <div class="challenge-input-wrapper">
                                <input type="text" class="challenge-input" placeholder="Enter the flag" data-answer="--dump">
                                <button class="submit-btn">Submit</button>
                            </div>
                            <div class="challenge-result"></div>
                        </div>

                        <!-- Challenge 6 -->
                        <div class="challenge-card" data-challenge="6">
                            <div class="challenge-header">
                                <h3 class="challenge-title">Challenge 6: DBMS Fingerprinting</h3>
                                <span class="challenge-points">15 points</span>
                            </div>
                            <p class="challenge-description">
                                What flag forces SQLMap to perform extensive DBMS version fingerprinting?
                            </p>
                            <div class="challenge-target">Target: http://app.local/search.php?q=test</div>
                            <div class="challenge-input-wrapper">
                                <input type="text" class="challenge-input" placeholder="Enter the flag" data-answer="--fingerprint">
                                <button class="submit-btn">Submit</button>
                            </div>
                            <div class="challenge-result"></div>
                        </div>

                        <!-- Challenge 7 -->
                        <div class="challenge-card" data-challenge="7">
                            <div class="challenge-header">
                                <h3 class="challenge-title">Challenge 7: POST Request Testing</h3>
                                <span class="challenge-points">25 points</span>
                            </div>
                            <p class="challenge-description">
                                The login form uses POST method with parameters 'username' and 'password'. What flag specifies POST data for testing?
                            </p>
                            <div class="challenge-target">Method: POST | Parameters: username, password</div>
                            <div class="challenge-input-wrapper">
                                <input type="text" class="challenge-input" placeholder="Enter the flag (e.g., --flag)" data-answer="--data">
                                <button class="submit-btn">Submit</button>
                            </div>
                            <div class="challenge-result"></div>
                        </div>

                        <!-- Challenge 8 -->
                        <div class="challenge-card" data-challenge="8">
                            <div class="challenge-header">
                                <h3 class="challenge-title">Challenge 8: Cookie Testing</h3>
                                <span class="challenge-points">25 points</span>
                            </div>
                            <p class="challenge-description">
                                You suspect the 'session_id' cookie might be vulnerable. What flag tests cookie parameters?
                            </p>
                            <div class="challenge-target">Cookie: session_id=abc123; user_pref=dark</div>
                            <div class="challenge-input-wrapper">
                                <input type="text" class="challenge-input" placeholder="Enter the flag" data-answer="--cookie">
                                <button class="submit-btn">Submit</button>
                            </div>
                            <div class="challenge-result"></div>
                        </div>

                        <!-- Challenge 9 -->
                        <div class="challenge-card" data-challenge="9">
                            <div class="challenge-header">
                                <h3 class="challenge-title">Challenge 9: Risk and Level</h3>
                                <span class="challenge-points">30 points</span>
                            </div>
                            <p class="challenge-description">
                                You want SQLMap to perform more thorough testing with higher risk payloads. What flags set both risk and level to maximum (3 and 5 respectively)?
                            </p>
                            <div class="challenge-target">Requirement: Risk=3, Level=5</div>
                            <div class="challenge-input-wrapper">
                                <input type="text" class="challenge-input" placeholder="Enter both flags (e.g., --flag1=X --flag2=Y)" data-answer="--risk=3 --level=5">
                                <button class="submit-btn">Submit</button>
                            </div>
                            <div class="challenge-result"></div>
                        </div>

                        <!-- Challenge 10 -->
                        <div class="challenge-card" data-challenge="10">
                            <div class="challenge-header">
                                <h3 class="challenge-title">Challenge 10: Batch Mode</h3>
                                <span class="challenge-points">20 points</span>
                            </div>
                            <p class="challenge-description">
                                You're running SQLMap in an automated script and need it to never prompt for user input, always using default options. What flag enables this?
                            </p>
                            <div class="challenge-target">Requirement: Non-interactive, automatic mode</div>
                            <div class="challenge-input-wrapper">
                                <input type="text" class="challenge-input" placeholder="Enter the flag" data-answer="--batch">
                                <button class="submit-btn">Submit</button>
                            </div>
                            <div class="challenge-result"></div>
                        </div>
                    </div>
                </div>

                <!-- Reference Tab -->
                <div class="tab-content" id="reference">
                    <div class="reference-content">
                        <div class="reference-section">
                            <h2>Common SQLMap Options</h2>

                            <h3>Target Options</h3>
                            <table class="reference-table">
                                <thead>
                                    <tr>
                                        <th>Option</th>
                                        <th>Description</th>
                                        <th>Example</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>-u URL</td>
                                        <td>Target URL</td>
                                        <td>-u "http://site.com/page.php?id=1"</td>
                                    </tr>
                                    <tr>
                                        <td>-g GOOGLEDORK</td>
                                        <td>Use Google dork results as target</td>
                                        <td>-g "inurl:.php?id="</td>
                                    </tr>
                                    <tr>
                                        <td>-r REQUESTFILE</td>
                                        <td>Load HTTP request from file</td>
                                        <td>-r request.txt</td>
                                    </tr>
                                    <tr>
                                        <td>--data=DATA</td>
                                        <td>POST data string</td>
                                        <td>--data="user=admin&pass=test"</td>
                                    </tr>
                                    <tr>
                                        <td>--cookie=COOKIE</td>
                                        <td>HTTP Cookie header value</td>
                                        <td>--cookie="PHPSESSID=abc123"</td>
                                    </tr>
                                    <tr>
                                        <td>--headers=HEADERS</td>
                                        <td>Extra HTTP headers (newline separated)</td>
                                        <td>--headers="X-Forwarded-For: 127.0.0.1"</td>
                                    </tr>
                                </tbody>
                            </table>

                            <h3>Enumeration Options</h3>
                            <table class="reference-table">
                                <thead>
                                    <tr>
                                        <th>Option</th>
                                        <th>Description</th>
                                        <th>Example</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>--dbs</td>
                                        <td>Enumerate databases</td>
                                        <td>--dbs</td>
                                    </tr>
                                    <tr>
                                        <td>-D DB</td>
                                        <td>Specify database to enumerate</td>
                                        <td>-D shop_db</td>
                                    </tr>
                                    <tr>
                                        <td>--tables</td>
                                        <td>Enumerate tables</td>
                                        <td>-D shop_db --tables</td>
                                    </tr>
                                    <tr>
                                        <td>-T TABLE</td>
                                        <td>Specify table to enumerate</td>
                                        <td>-T users</td>
                                    </tr>
                                    <tr>
                                        <td>--columns</td>
                                        <td>Enumerate columns</td>
                                        <td>-D shop_db -T users --columns</td>
                                    </tr>
                                    <tr>
                                        <td>--dump</td>
                                        <td>Dump table data</td>
                                        <td>-D shop_db -T users --dump</td>
                                    </tr>
                                    <tr>
                                        <td>--dump-all</td>
                                        <td>Dump all databases tables entries</td>
                                        <td>--dump-all</td>
                                    </tr>
                                    <tr>
                                        <td>-C COLUMNS</td>
                                        <td>Specify columns to dump</td>
                                        <td>-C username,password</td>
                                    </tr>
                                    <tr>
                                        <td>--schema</td>
                                        <td>Enumerate database schema</td>
                                        <td>--schema</td>
                                    </tr>
                                    <tr>
                                        <td>--count</td>
                                        <td>Get number of entries in table</td>
                                        <td>-D shop_db -T users --count</td>
                                    </tr>
                                </tbody>
                            </table>

                            <h3>Detection and Techniques</h3>
                            <table class="reference-table">
                                <thead>
                                    <tr>
                                        <th>Option</th>
                                        <th>Description</th>
                                        <th>Example</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>--level=LEVEL</td>
                                        <td>Level of tests (1-5, default 1)</td>
                                        <td>--level=5</td>
                                    </tr>
                                    <tr>
                                        <td>--risk=RISK</td>
                                        <td>Risk of tests (1-3, default 1)</td>
                                        <td>--risk=3</td>
                                    </tr>
                                    <tr>
                                        <td>--technique=TECH</td>
                                        <td>SQL injection techniques (BEUSTQ)</td>
                                        <td>--technique=BEU</td>
                                    </tr>
                                    <tr>
                                        <td>--dbms=DBMS</td>
                                        <td>Force DBMS type</td>
                                        <td>--dbms=MySQL</td>
                                    </tr>
                                    <tr>
                                        <td>--os=OS</td>
                                        <td>Force OS type</td>
                                        <td>--os=Linux</td>
                                    </tr>
                                    <tr>
                                        <td>--fingerprint</td>
                                        <td>Extensive DBMS fingerprinting</td>
                                        <td>--fingerprint</td>
                                    </tr>
                                </tbody>
                            </table>

                            <h3>Optimization</h3>
                            <table class="reference-table">
                                <thead>
                                    <tr>
                                        <th>Option</th>
                                        <th>Description</th>
                                        <th>Example</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>--threads=THREADS</td>
                                        <td>Max concurrent HTTP requests</td>
                                        <td>--threads=5</td>
                                    </tr>
                                    <tr>
                                        <td>--batch</td>
                                        <td>Never ask for user input (automatic)</td>
                                        <td>--batch</td>
                                    </tr>
                                    <tr>
                                        <td>--keep-alive</td>
                                        <td>Use persistent HTTP connections</td>
                                        <td>--keep-alive</td>
                                    </tr>
                                    <tr>
                                        <td>--null-connection</td>
                                        <td>Retrieve page length without content</td>
                                        <td>--null-connection</td>
                                    </tr>
                                </tbody>
                            </table>

                            <h3>Evasion Techniques</h3>
                            <table class="reference-table">
                                <thead>
                                    <tr>
                                        <th>Option</th>
                                        <th>Description</th>
                                        <th>Example</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>--tamper=TAMPER</td>
                                        <td>Use tamper scripts</td>
                                        <td>--tamper=space2comment</td>
                                    </tr>
                                    <tr>
                                        <td>--random-agent</td>
                                        <td>Use random User-Agent</td>
                                        <td>--random-agent</td>
                                    </tr>
                                    <tr>
                                        <td>--delay=DELAY</td>
                                        <td>Delay between requests (seconds)</td>
                                        <td>--delay=2</td>
                                    </tr>
                                    <tr>
                                        <td>--timeout=TIMEOUT</td>
                                        <td>Connection timeout (seconds)</td>
                                        <td>--timeout=30</td>
                                    </tr>
                                    <tr>
                                        <td>--proxy=PROXY</td>
                                        <td>Use proxy</td>
                                        <td>--proxy="http://127.0.0.1:8080"</td>
                                    </tr>
                                    <tr>
                                        <td>--tor</td>
                                        <td>Use Tor anonymity network</td>
                                        <td>--tor</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="reference-section">
                            <h2>Injection Technique Codes</h2>
                            <p>Use with <code>--technique</code> flag to specify which techniques to use:</p>
                            <table class="reference-table">
                                <thead>
                                    <tr>
                                        <th>Code</th>
                                        <th>Technique</th>
                                        <th>Speed</th>
                                        <th>Stealth</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>B</td>
                                        <td>Boolean-based blind</td>
                                        <td>Slow</td>
                                        <td>Medium</td>
                                    </tr>
                                    <tr>
                                        <td>E</td>
                                        <td>Error-based</td>
                                        <td>Fast</td>
                                        <td>Low</td>
                                    </tr>
                                    <tr>
                                        <td>U</td>
                                        <td>UNION query-based</td>
                                        <td>Very Fast</td>
                                        <td>Low</td>
                                    </tr>
                                    <tr>
                                        <td>S</td>
                                        <td>Stacked queries</td>
                                        <td>Fast</td>
                                        <td>Very Low</td>
                                    </tr>
                                    <tr>
                                        <td>T</td>
                                        <td>Time-based blind</td>
                                        <td>Very Slow</td>
                                        <td>High</td>
                                    </tr>
                                    <tr>
                                        <td>Q</td>
                                        <td>Inline queries</td>
                                        <td>Medium</td>
                                        <td>Medium</td>
                                    </tr>
                                </tbody>
                            </table>
                            <div class="code-block">
<span class="comment"># Examples:</span>
--technique=U          <span class="comment">(Only UNION-based)</span>
--technique=BEU        <span class="comment">(Boolean, Error, and UNION)</span>
--technique=T          <span class="comment">(Only time-based blind - slowest but stealthiest)</span>
                            </div>
                        </div>

                        <div class="reference-section">
                            <h2>Popular Tamper Scripts</h2>
                            <p>Tamper scripts modify payloads to bypass WAF/IPS filters:</p>
                            <table class="reference-table">
                                <thead>
                                    <tr>
                                        <th>Tamper Script</th>
                                        <th>Purpose</th>
                                        <th>Example Transformation</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>space2comment</td>
                                        <td>Replace spaces with comments</td>
                                        <td>SELECT * FROM  SELECT/**/FROM</td>
                                    </tr>
                                    <tr>
                                        <td>between</td>
                                        <td>Replace > with BETWEEN</td>
                                        <td>id > 1  id BETWEEN 1 AND 9999</td>
                                    </tr>
                                    <tr>
                                        <td>charencode</td>
                                        <td>URL-encode characters</td>
                                        <td>SELECT  %53%45%4C%45%43%54</td>
                                    </tr>
                                    <tr>
                                        <td>randomcase</td>
                                        <td>Random uppercase/lowercase</td>
                                        <td>SELECT  SeLeCt</td>
                                    </tr>
                                    <tr>
                                        <td>base64encode</td>
                                        <td>Base64 encode payload</td>
                                        <td>1' OR '1'='1  MScgT1IgJzEnPScx</td>
                                    </tr>
                                    <tr>
                                        <td>apostrophenullencode</td>
                                        <td>Replace apostrophe with %00%27</td>
                                        <td>'  %00%27</td>
                                    </tr>
                                    <tr>
                                        <td>equaltolike</td>
                                        <td>Replace = with LIKE</td>
                                        <td>WHERE id = 1  WHERE id LIKE 1</td>
                                    </tr>
                                </tbody>
                            </table>
                            <div class="code-block">
<span class="comment"># Use multiple tamper scripts (comma-separated):</span>
--tamper=space2comment,between,randomcase
                            </div>
                        </div>

                        <div class="reference-section">
                            <h2>Common Command Patterns</h2>

                            <h3>Basic Vulnerability Testing</h3>
                            <div class="code-block">
<span class="comment"># Test GET parameter</span>
sqlmap -u "http://target.com/page.php?id=1"

<span class="comment"># Test with cookies</span>
sqlmap -u "http://target.com/page.php" --cookie="PHPSESSID=abc123"

<span class="comment"># Test POST data</span>
sqlmap -u "http://target.com/login.php" --data="user=admin&pass=test"
                            </div>

                            <h3>Full Database Enumeration</h3>
                            <div class="code-block">
<span class="comment"># 1. List databases</span>
sqlmap -u "http://target.com/page.php?id=1" --dbs

<span class="comment"># 2. List tables in specific database</span>
sqlmap -u "http://target.com/page.php?id=1" -D shop_db --tables

<span class="comment"># 3. List columns in specific table</span>
sqlmap -u "http://target.com/page.php?id=1" -D shop_db -T users --columns

<span class="comment"># 4. Dump specific columns</span>
sqlmap -u "http://target.com/page.php?id=1" -D shop_db -T users -C username,password --dump
                            </div>

                            <h3>Advanced Testing</h3>
                            <div class="code-block">
<span class="comment"># Maximum testing depth</span>
sqlmap -u "http://target.com/page.php?id=1" --level=5 --risk=3

<span class="comment"># WAF bypass with tamper scripts</span>
sqlmap -u "http://target.com/page.php?id=1" --tamper=space2comment,between --random-agent

<span class="comment"># Automated mode with threading</span>
sqlmap -u "http://target.com/page.php?id=1" --batch --threads=5 --dbs
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Tab -->
                <div class="tab-content" id="settings">
                    <div class="settings-content">
                        <div class="settings-section">
                            <h2>Progress Management</h2>

                            <div class="setting-item">
                                <div class="setting-label">
                                    <h3>Export Progress</h3>
                                    <p>Download your challenge progress and statistics as JSON</p>
                                </div>
                                <button class="action-btn" id="export-btn">Export Data</button>
                            </div>

                            <div class="setting-item">
                                <div class="setting-label">
                                    <h3>Import Progress</h3>
                                    <p>Restore previously exported progress data</p>
                                </div>
                                <input type="file" id="import-file" accept=".json" style="display: none;">
                                <button class="action-btn" id="import-btn">Import Data</button>
                            </div>

                            <div class="setting-item">
                                <div class="setting-label">
                                    <h3>Reset Progress</h3>
                                    <p>Clear all challenge completions and reset points to zero</p>
                                </div>
                                <button class="action-btn danger" id="reset-btn">Reset All</button>
                            </div>
                        </div>

                        <div class="settings-section">
                            <h2>Appearance</h2>

                            <div class="setting-item">
                                <div class="setting-label">
                                    <h3>Dark Mode</h3>
                                    <p>Toggle between dark and light theme</p>
                                </div>
                                <div class="toggle-switch on" id="dark-mode-toggle">
                                    <div class="toggle-knob"></div>
                                </div>
                            </div>
                        </div>

                        <div class="settings-section">
                            <h2>About</h2>
                            <div class="info-box">
                                <strong>SQLMap Training Lab v1.0</strong>
                                <p style="margin-top: 10px;">An educational platform for learning SQL injection detection and exploitation techniques using SQLMap. This simulator provides a safe, controlled environment to practice SQLMap commands without conducting actual attacks.</p>
                                <p style="margin-top: 10px;"><strong>Educational Use Only:</strong> This tool is designed for cybersecurity education and authorized penetration testing training. Never use SQL injection techniques on systems you don't own or have explicit permission to test.</p>
                            </div>

                            <div class="info-box warning" style="margin-top: 15px;">
                                <strong>Legal Notice</strong>
                                <p style="margin-top: 10px;">Unauthorized access to computer systems is illegal. This training module simulates SQLMap functionality for educational purposes only. Users are responsible for ensuring their activities comply with all applicable laws and regulations.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="sidebar">
                <div class="stats-panel">
                    <h3>Your Progress</h3>
                    <div class="stat-item">
                        <span class="stat-label">Total Points</span>
                        <span class="stat-value" id="total-points">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Challenges Complete</span>
                        <span class="stat-value"><span id="completed-challenges">0</span> / 10</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Success Rate</span>
                        <span class="stat-value" id="success-rate">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill" style="width: 0%;">0%</div>
                    </div>
                </div>

                <div class="hints-panel">
                    <h3>Quick Tips</h3>
                    <div class="hint-item">
                        <strong>Tip:</strong> Use Tab key in the Injection Lab for autocomplete suggestions
                    </div>
                    <div class="hint-item">
                        <strong>Tip:</strong> Start with --dbs to enumerate databases before diving deeper
                    </div>
                    <div class="hint-item">
                        <strong>Tip:</strong> Increase --level and --risk for more thorough testing (but slower)
                    </div>
                    <div class="hint-item">
                        <strong>Tip:</strong> Use --batch flag to prevent interactive prompts in automated scans
                    </div>
                    <div class="hint-item">
                        <strong>Tip:</strong> Check the Reference tab for complete flag documentation
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== State Management ====================
        const state = {
            currentTab: 'learn',
            currentScenario: 'basic-get',
            commandHistory: [],
            historyIndex: -1,
            challengeProgress: {},
            totalPoints: 0,
            darkMode: true,
            autocompleteIndex: -1
        };

        // ==================== SQLMap Command Database ====================
        const sqlmapCommands = {
            flags: [
                '-u', '--url', '-d', '--data', '-r', '--requestfile', '-g', '--googledork',
                '--cookie', '--headers', '--method', '--random-agent', '--user-agent',
                '--referer', '--host', '--auth-type', '--auth-cred', '--proxy', '--tor',
                '--batch', '--flush-session', '--fresh-queries', '--forms', '--crawl',
                '--dbs', '--tables', '--columns', '--dump', '--dump-all', '--schema',
                '--count', '--comments', '--all', '-D', '-T', '-C', '--exclude-sysdbs',
                '--level', '--risk', '--technique', '--dbms', '--os', '--tamper',
                '--fingerprint', '--threads', '--delay', '--timeout', '--retries',
                '--keep-alive', '--null-connection', '--skip', '--skip-waf',
                '--identify-waf', '--check-waf', '--hpp', '--time-sec',
                '--union-cols', '--union-char', '--union-from', '--dns-domain',
                '--second-url', '--second-req', '--safe-url', '--safe-post',
                '--safe-req', '--safe-freq', '--test-filter', '--test-skip',
                '--sql-query', '--sql-shell', '--os-cmd', '--os-shell',
                '--os-pwn', '--os-smbrelay', '--os-bof', '--priv-esc',
                '--file-read', '--file-write', '--file-dest', '--reg-read',
                '--reg-add', '--reg-del', '--reg-key', '--reg-value',
                '--reg-data', '--reg-type', '-v', '--parse-errors',
                '--save', '--scope', '--test-parameter', '--skip-parameter',
                '--param-exclude', '--param-filter', '--dbms-cred',
                '--charset', '--encoding', '--eta', '--flush-session',
                '--hex', '--output-dir', '--parse-errors', '--dump-format',
                '--csv-del', '--invalid-bignum', '--invalid-logical',
                '--invalid-string', '--no-cast', '--no-escape',
                '--prefix', '--suffix', '--skip-static', '--skip-urlencode',
                '--smart', '--mobile', '--page-rank', '--wizard'
            ],
            dbms: ['MySQL', 'PostgreSQL', 'MSSQL', 'Oracle', 'SQLite', 'Access', 'Firebird', 'Sybase', 'DB2'],
            techniques: ['B', 'E', 'U', 'S', 'T', 'Q'],
            tamperScripts: [
                'space2comment', 'between', 'charencode', 'randomcase', 'base64encode',
                'apostrophenullencode', 'equaltolike', 'greatest', 'ifnull2ifisnull',
                'multiplespaces', 'percentage', 'randomcomments', 'space2hash',
                'space2morehash', 'space2mssqlblank', 'space2mysqldash', 'space2plus',
                'space2randomblank', 'unionalltounion', 'unmagicquotes', 'versionedkeywords',
                'versionedmorekeywords', 'xforwardedfor'
            ]
        };

        // ==================== Scenario Database ====================
        const scenarios = {
            'basic-get': {
                name: 'Basic GET Parameter (UNION)',
                url: 'http://shop.vulnerable.local/product.php?id=5',
                vulnerability: 'UNION-based SQL injection',
                dbms: 'MySQL 5.7.34',
                databases: ['shop_db', 'information_schema', 'mysql'],
                tables: {
                    'shop_db': ['users', 'products', 'orders', 'reviews']
                },
                columns: {
                    'users': ['id', 'username', 'password', 'email', 'role', 'created_at'],
                    'products': ['id', 'name', 'description', 'price', 'stock'],
                    'orders': ['id', 'user_id', 'product_id', 'quantity', 'total', 'order_date']
                },
                data: {
                    'users': [
                        { id: 1, username: 'admin', password: 'f3b7d8a9c1e2d4a6', email: 'admin@shop.local', role: 'administrator' },
                        { id: 2, username: 'john_doe', password: '5f4dcc3b5aa765d61d8327deb882cf99', email: 'john@example.com', role: 'customer' },
                        { id: 3, username: 'jane_smith', password: '098f6bcd4621d373cade4e832627b4f6', email: 'jane@example.com', role: 'customer' }
                    ]
                }
            },
            'blind-boolean': {
                name: 'Boolean-Based Blind',
                url: 'http://blog.vulnerable.local/article.php?id=12',
                vulnerability: 'Boolean-based blind SQL injection',
                dbms: 'PostgreSQL 12.8',
                databases: ['blog_db', 'postgres', 'template0', 'template1'],
                tables: {
                    'blog_db': ['users', 'articles', 'comments', 'categories']
                },
                columns: {
                    'users': ['id', 'username', 'password_hash', 'email', 'is_admin'],
                    'articles': ['id', 'title', 'content', 'author_id', 'published_date']
                },
                data: {
                    'users': [
                        { id: 1, username: 'blogger', password_hash: '$2a$10$N9qo8uLOickgx2ZMRZoMye', email: 'blogger@blog.local', is_admin: true },
                        { id: 2, username: 'contributor', password_hash: '$2a$10$Xfj9k2LpO7mN8qK1zR3Pq', email: 'contrib@blog.local', is_admin: false }
                    ]
                }
            },
            'time-based': {
                name: 'Time-Based Blind',
                url: 'http://api.vulnerable.local/search?q=test',
                vulnerability: 'Time-based blind SQL injection',
                dbms: 'Microsoft SQL Server 2019',
                databases: ['api_db', 'master', 'model', 'msdb', 'tempdb'],
                tables: {
                    'api_db': ['users', 'api_keys', 'logs', 'settings']
                },
                columns: {
                    'users': ['id', 'username', 'password', 'email', 'api_tier'],
                    'api_keys': ['id', 'user_id', 'key_value', 'created_at', 'expires_at']
                },
                data: {
                    'users': [
                        { id: 1, username: 'api_admin', password: 'c4ca4238a0b923820dcc509a6f75849b', email: 'api@company.com', api_tier: 'premium' }
                    ]
                }
            },
            'error-based': {
                name: 'Error-Based Injection',
                url: 'http://portal.vulnerable.local/user.php?uid=42',
                vulnerability: 'Error-based SQL injection',
                dbms: 'MySQL 8.0.26',
                databases: ['portal_db', 'information_schema', 'mysql', 'performance_schema'],
                tables: {
                    'portal_db': ['employees', 'departments', 'salaries', 'projects']
                },
                columns: {
                    'employees': ['id', 'firstname', 'lastname', 'email', 'department_id', 'salary_grade'],
                    'salaries': ['id', 'employee_id', 'amount', 'currency', 'effective_date']
                },
                data: {
                    'employees': [
                        { id: 42, firstname: 'Alice', lastname: 'Johnson', email: 'alice@company.com', department_id: 5, salary_grade: 'E4' },
                        { id: 43, firstname: 'Bob', lastname: 'Williams', email: 'bob@company.com', department_id: 3, salary_grade: 'E3' }
                    ]
                }
            },
            'post-injection': {
                name: 'POST Data Injection',
                url: 'http://auth.vulnerable.local/login.php',
                vulnerability: 'POST parameter SQL injection',
                dbms: 'MySQL 5.6.51',
                databases: ['auth_db', 'information_schema', 'mysql'],
                tables: {
                    'auth_db': ['users', 'sessions', 'login_attempts', 'permissions']
                },
                columns: {
                    'users': ['id', 'username', 'password', 'email', 'role', 'mfa_enabled'],
                    'sessions': ['id', 'user_id', 'session_token', 'ip_address', 'created_at']
                },
                data: {
                    'users': [
                        { id: 1, username: 'sysadmin', password: 'e10adc3949ba59abbe56e057f20f883e', email: 'admin@auth.local', role: 'admin', mfa_enabled: false }
                    ]
                }
            },
            'cookie-injection': {
                name: 'Cookie Parameter Injection',
                url: 'http://store.vulnerable.local/dashboard.php',
                vulnerability: 'Cookie-based SQL injection',
                dbms: 'PostgreSQL 13.4',
                databases: ['store_db', 'postgres'],
                tables: {
                    'store_db': ['customers', 'orders', 'products', 'wishlist', 'payment_methods']
                },
                columns: {
                    'customers': ['id', 'email', 'password', 'firstname', 'lastname', 'credit_card_last4'],
                    'payment_methods': ['id', 'customer_id', 'card_type', 'card_number_encrypted', 'expiry']
                },
                data: {
                    'customers': [
                        { id: 1, email: 'customer@example.com', password: '5f4dcc3b5aa765d61d8327deb882cf99', firstname: 'John', lastname: 'Doe', credit_card_last4: '4242' }
                    ]
                }
            }
        };

        // ==================== Command Simulator ====================
        class SQLMapSimulator {
            constructor() {
                this.currentScenario = scenarios['basic-get'];
            }

            setScenario(scenarioKey) {
                this.currentScenario = scenarios[scenarioKey];
            }

            parseCommand(command) {
                // Remove sqlmap from the beginning if present
                command = command.trim().replace(/^sqlmap\s+/i, '');

                const args = this.parseArguments(command);
                return args;
            }

            parseArguments(command) {
                const args = {
                    url: null,
                    data: null,
                    cookie: null,
                    flags: []
                };

                // Extract URL
                const urlMatch = command.match(/-u\s+["']([^"']+)["']|--url[=\s]+["']([^"']+)["']/);
                if (urlMatch) {
                    args.url = urlMatch[1] || urlMatch[2];
                }

                // Extract data
                const dataMatch = command.match(/--data[=\s]+["']([^"']+)["']/);
                if (dataMatch) {
                    args.data = dataMatch[1];
                }

                // Extract cookie
                const cookieMatch = command.match(/--cookie[=\s]+["']([^"']+)["']/);
                if (cookieMatch) {
                    args.cookie = cookieMatch[1];
                }

                // Extract all flags
                const flagRegex = /--?([a-zA-Z-]+)(?:[=\s]+([^\s-][^\s]*))?/g;
                let match;
                while ((match = flagRegex.exec(command)) !== null) {
                    args.flags.push({
                        name: match[1],
                        value: match[2] || true
                    });
                }

                return args;
            }

            execute(command) {
                const output = [];

                if (command.toLowerCase().trim() === 'help') {
                    return this.showHelp();
                }

                if (command.toLowerCase().trim() === 'clear') {
                    return null; // Signal to clear terminal
                }

                if (!command.toLowerCase().includes('sqlmap')) {
                    return [{
                        text: 'Error: Command must start with "sqlmap"',
                        type: 'error'
                    }];
                }

                const args = this.parseCommand(command);

                // Simulate sqlmap banner
                output.push({ text: '        ___', type: 'info' });
                output.push({ text: '       __H__', type: 'info' });
                output.push({ text: ' ___ ___[.]_____ ___ ___  {1.6.12#stable}', type: 'info' });
                output.push({ text: '|_ -| . [)]     | .\'| . |', type: 'info' });
                output.push({ text: '|___|_  ["]_|_|_|__,|  _|', type: 'info' });
                output.push({ text: '      |_|V...       |_|   https://sqlmap.org', type: 'info' });
                output.push({ text: '', type: 'info' });
                output.push({ text: '[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal.', type: 'warning' });
                output.push({ text: '', type: 'info' });

                // Check if URL is provided
                if (!args.url && !args.flags.find(f => f.name === 'r' || f.name === 'requestfile')) {
                    output.push({ text: '[CRITICAL] missing a mandatory option (-u, -d, -r, -g). Use -h for help', type: 'error' });
                    return output;
                }

                // Initial connection
                output.push({ text: '[INFO] testing connection to the target URL', type: 'info' });
                output.push({ text: `[INFO] testing if the target URL content is stable`, type: 'info' });

                // DBMS detection
                output.push({ text: `[INFO] heuristic (basic) test shows that GET parameter 'id' might be injectable`, type: 'success' });
                output.push({ text: `[INFO] testing for SQL injection on GET parameter 'id'`, type: 'info' });
                output.push({ text: `[INFO] testing '${this.currentScenario.vulnerability}'`, type: 'info' });
                output.push({ text: `[INFO] GET parameter 'id' appears to be '${this.currentScenario.vulnerability}' injectable`, type: 'success' });
                output.push({ text: `[INFO] the back-end DBMS is ${this.currentScenario.dbms}`, type: 'success' });
                output.push({ text: '', type: 'info' });

                // Process flags
                const hasDbsFlag = args.flags.find(f => f.name === 'dbs');
                const hasTablesFlag = args.flags.find(f => f.name === 'tables');
                const hasColumnsFlag = args.flags.find(f => f.name === 'columns');
                const hasDumpFlag = args.flags.find(f => f.name === 'dump');
                const hasFingerprintFlag = args.flags.find(f => f.name === 'fingerprint');

                const dbFlag = args.flags.find(f => f.name === 'D');
                const tableFlag = args.flags.find(f => f.name === 'T');

                if (hasFingerprintFlag) {
                    output.push({ text: '[INFO] actively fingerprinting ' + this.currentScenario.dbms, type: 'info' });
                    output.push({ text: `[INFO] the back-end DBMS is ${this.currentScenario.dbms}`, type: 'success' });
                    output.push({ text: `back-end DBMS: active fingerprint: ${this.currentScenario.dbms}`, type: 'success' });
                }

                if (hasDbsFlag) {
                    output.push({ text: '[INFO] fetching database names', type: 'info' });
                    output.push({ text: `available databases [${this.currentScenario.databases.length}]:`, type: 'success' });
                    this.currentScenario.databases.forEach(db => {
                        output.push({ text: `[*] ${db}`, type: 'success' });
                    });
                }

                if (hasTablesFlag) {
                    if (dbFlag && dbFlag.value) {
                        const dbName = dbFlag.value;
                        if (this.currentScenario.tables[dbName]) {
                            output.push({ text: `[INFO] fetching tables for database: '${dbName}'`, type: 'info' });
                            output.push({ text: `Database: ${dbName}`, type: 'success' });
                            output.push({ text: `[${this.currentScenario.tables[dbName].length} tables]`, type: 'success' });
                            this.currentScenario.tables[dbName].forEach(table => {
                                output.push({ text: `| ${table}`, type: 'success' });
                            });
                        } else {
                            output.push({ text: `[WARNING] database '${dbName}' not found`, type: 'warning' });
                        }
                    } else {
                        output.push({ text: '[ERROR] missing mandatory option -D for --tables', type: 'error' });
                    }
                }

                if (hasColumnsFlag) {
                    if (dbFlag && tableFlag) {
                        const dbName = dbFlag.value;
                        const tableName = tableFlag.value;

                        if (this.currentScenario.columns[tableName]) {
                            output.push({ text: `[INFO] fetching columns for table '${tableName}' in database '${dbName}'`, type: 'info' });
                            output.push({ text: `Database: ${dbName}`, type: 'success' });
                            output.push({ text: `Table: ${tableName}`, type: 'success' });
                            output.push({ text: `[${this.currentScenario.columns[tableName].length} columns]`, type: 'success' });
                            this.currentScenario.columns[tableName].forEach(col => {
                                output.push({ text: `| ${col}`, type: 'success' });
                            });
                        } else {
                            output.push({ text: `[WARNING] table '${tableName}' not found`, type: 'warning' });
                        }
                    } else {
                        output.push({ text: '[ERROR] missing mandatory options -D and -T for --columns', type: 'error' });
                    }
                }

                if (hasDumpFlag) {
                    if (dbFlag && tableFlag) {
                        const tableName = tableFlag.value;

                        if (this.currentScenario.data[tableName]) {
                            output.push({ text: `[INFO] fetching entries for table '${tableName}'`, type: 'info' });
                            output.push({ text: `Database: ${dbFlag.value}`, type: 'success' });
                            output.push({ text: `Table: ${tableName}`, type: 'success' });
                            output.push({ text: `[${this.currentScenario.data[tableName].length} entries]`, type: 'success' });
                            output.push({ text: '', type: 'info' });

                            // Format as table
                            const data = this.currentScenario.data[tableName];
                            const columns = Object.keys(data[0]);

                            // Header
                            output.push({ text: columns.map(c => c.padEnd(25)).join(' | '), type: 'success' });
                            output.push({ text: '-'.repeat(columns.length * 27), type: 'success' });

                            // Data rows
                            data.forEach(row => {
                                const rowText = columns.map(col => String(row[col]).padEnd(25)).join(' | ');
                                output.push({ text: rowText, type: 'success' });
                            });
                        } else {
                            output.push({ text: `[WARNING] table '${tableName}' has no data to dump`, type: 'warning' });
                        }
                    } else {
                        output.push({ text: '[ERROR] missing mandatory options -D and -T for --dump', type: 'error' });
                    }
                }

                output.push({ text: '', type: 'info' });
                output.push({ text: '[INFO] fetched data logged to text files', type: 'info' });

                return output;
            }

            showHelp() {
                return [
                    { text: 'SQLMap Training Simulator - Available Commands:', type: 'info' },
                    { text: '', type: 'info' },
                    { text: 'Basic Usage:', type: 'success' },
                    { text: '  sqlmap -u "URL" [options]', type: 'info' },
                    { text: '', type: 'info' },
                    { text: 'Common Options:', type: 'success' },
                    { text: '  --dbs              Enumerate databases', type: 'info' },
                    { text: '  -D DB --tables     Enumerate tables in database', type: 'info' },
                    { text: '  -D DB -T TBL --columns    Enumerate columns in table', type: 'info' },
                    { text: '  -D DB -T TBL --dump       Dump table data', type: 'info' },
                    { text: '  --fingerprint      Fingerprint DBMS', type: 'info' },
                    { text: '', type: 'info' },
                    { text: 'Examples:', type: 'success' },
                    { text: '  sqlmap -u "http://shop.local/product.php?id=5" --dbs', type: 'info' },
                    { text: '  sqlmap -u "http://shop.local/product.php?id=5" -D shop_db --tables', type: 'info' },
                    { text: '  sqlmap -u "http://shop.local/product.php?id=5" -D shop_db -T users --dump', type: 'info' },
                    { text: '', type: 'info' },
                    { text: 'Other Commands:', type: 'success' },
                    { text: '  help               Show this help message', type: 'info' },
                    { text: '  clear              Clear terminal output', type: 'info' }
                ];
            }
        }

        // Initialize simulator
        const simulator = new SQLMapSimulator();

        // ==================== DOM Elements ====================
        const elements = {
            tabs: document.querySelectorAll('.tab'),
            tabContents: document.querySelectorAll('.tab-content'),
            scenarioSelect: document.getElementById('scenario-select'),
            terminalOutput: document.getElementById('terminal-output'),
            commandInput: document.getElementById('command-input'),
            executeBtn: document.getElementById('execute-btn'),
            clearBtn: document.getElementById('clear-btn'),
            autocomplete: document.getElementById('autocomplete'),
            challengeCards: document.querySelectorAll('.challenge-card'),
            totalPoints: document.getElementById('total-points'),
            completedChallenges: document.getElementById('completed-challenges'),
            successRate: document.getElementById('success-rate'),
            progressFill: document.getElementById('progress-fill'),
            exportBtn: document.getElementById('export-btn'),
            importBtn: document.getElementById('import-btn'),
            importFile: document.getElementById('import-file'),
            resetBtn: document.getElementById('reset-btn'),
            darkModeToggle: document.getElementById('dark-mode-toggle')
        };

        // ==================== Tab Switching ====================
        elements.tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const tabName = tab.dataset.tab;
                switchTab(tabName);
            });
        });

        function switchTab(tabName) {
            elements.tabs.forEach(t => t.classList.remove('active'));
            elements.tabContents.forEach(tc => tc.classList.remove('active'));

            const activeTab = document.querySelector(`.tab[data-tab="${tabName}"]`);
            const activeContent = document.getElementById(tabName);

            if (activeTab && activeContent) {
                activeTab.classList.add('active');
                activeContent.classList.add('active');
                state.currentTab = tabName;
            }
        }

        // ==================== Scenario Switching ====================
        elements.scenarioSelect.addEventListener('change', (e) => {
            const scenarioKey = e.target.value;
            state.currentScenario = scenarioKey;
            simulator.setScenario(scenarioKey);

            // Add scenario change message to terminal
            addTerminalLine(`[INFO] Scenario changed to: ${scenarios[scenarioKey].name}`, 'info');
            addTerminalLine(`[INFO] Target: ${scenarios[scenarioKey].url}`, 'info');
            addTerminalLine(`[INFO] Vulnerability Type: ${scenarios[scenarioKey].vulnerability}`, 'info');
        });

        // ==================== Terminal Functions ====================
        function addTerminalLine(text, type = 'info') {
            const line = document.createElement('div');
            line.className = `terminal-line ${type}`;
            line.textContent = text;
            elements.terminalOutput.appendChild(line);
            elements.terminalOutput.scrollTop = elements.terminalOutput.scrollHeight;
        }

        function clearTerminal() {
            elements.terminalOutput.innerHTML = '';
            addTerminalLine('Terminal cleared.', 'info');
            addTerminalLine('Ready for commands...', 'info');
        }

        function executeCommand(command) {
            if (!command.trim()) return;

            // Add command to history
            state.commandHistory.push(command);
            state.historyIndex = state.commandHistory.length;

            // Display the command
            addTerminalLine(`root@kali:~# ${command}`, 'prompt');

            // Execute the command
            const output = simulator.execute(command);

            if (output === null) {
                // Clear command
                clearTerminal();
            } else {
                // Display output
                output.forEach(line => {
                    addTerminalLine(line.text, line.type);
                });
            }

            // Clear input
            elements.commandInput.value = '';
            hideAutocomplete();
        }

        // ==================== Command Input Handling ====================
        elements.executeBtn.addEventListener('click', () => {
            executeCommand(elements.commandInput.value);
        });

        elements.commandInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                executeCommand(elements.commandInput.value);
            } else if (e.key === 'ArrowUp') {
                e.preventDefault();
                navigateHistory(-1);
            } else if (e.key === 'ArrowDown') {
                e.preventDefault();
                navigateHistory(1);
            } else if (e.key === 'Tab') {
                e.preventDefault();
                if (elements.autocomplete.classList.contains('show')) {
                    selectAutocompleteItem();
                }
            } else if (e.key === 'ArrowUp' || e.key === 'ArrowDown') {
                if (elements.autocomplete.classList.contains('show')) {
                    e.preventDefault();
                    navigateAutocomplete(e.key === 'ArrowDown' ? 1 : -1);
                }
            }
        });

        elements.commandInput.addEventListener('input', (e) => {
            handleAutocomplete(e.target.value);
        });

        elements.clearBtn.addEventListener('click', clearTerminal);

        function navigateHistory(direction) {
            state.historyIndex += direction;

            if (state.historyIndex < 0) {
                state.historyIndex = 0;
            } else if (state.historyIndex > state.commandHistory.length) {
                state.historyIndex = state.commandHistory.length;
            }

            if (state.historyIndex === state.commandHistory.length) {
                elements.commandInput.value = '';
            } else {
                elements.commandInput.value = state.commandHistory[state.historyIndex] || '';
            }
        }

        // ==================== Autocomplete ====================
        function handleAutocomplete(input) {
            if (!input.trim()) {
                hideAutocomplete();
                return;
            }

            const words = input.split(' ');
            const currentWord = words[words.length - 1];

            if (currentWord.startsWith('--') || currentWord.startsWith('-')) {
                const matches = sqlmapCommands.flags.filter(flag =>
                    flag.toLowerCase().startsWith(currentWord.toLowerCase())
                );

                if (matches.length > 0) {
                    showAutocomplete(matches, words, currentWord);
                } else {
                    hideAutocomplete();
                }
            } else {
                hideAutocomplete();
            }
        }

        function showAutocomplete(matches, words, currentWord) {
            elements.autocomplete.innerHTML = '';

            matches.slice(0, 10).forEach((match, index) => {
                const item = document.createElement('div');
                item.className = 'autocomplete-item';
                if (index === state.autocompleteIndex) {
                    item.classList.add('selected');
                }
                item.textContent = match;
                item.addEventListener('click', () => {
                    selectAutocompleteMatch(match, words, currentWord);
                });
                elements.autocomplete.appendChild(item);
            });

            elements.autocomplete.classList.add('show');
        }

        function hideAutocomplete() {
            elements.autocomplete.classList.remove('show');
            elements.autocomplete.innerHTML = '';
            state.autocompleteIndex = -1;
        }

        function navigateAutocomplete(direction) {
            const items = elements.autocomplete.querySelectorAll('.autocomplete-item');
            if (items.length === 0) return;

            items[state.autocompleteIndex]?.classList.remove('selected');

            state.autocompleteIndex += direction;

            if (state.autocompleteIndex < 0) {
                state.autocompleteIndex = items.length - 1;
            } else if (state.autocompleteIndex >= items.length) {
                state.autocompleteIndex = 0;
            }

            items[state.autocompleteIndex].classList.add('selected');
            items[state.autocompleteIndex].scrollIntoView({ block: 'nearest' });
        }

        function selectAutocompleteItem() {
            const selected = elements.autocomplete.querySelector('.autocomplete-item.selected');
            if (selected) {
                const words = elements.commandInput.value.split(' ');
                const currentWord = words[words.length - 1];
                selectAutocompleteMatch(selected.textContent, words, currentWord);
            }
        }

        function selectAutocompleteMatch(match, words, currentWord) {
            words[words.length - 1] = match;
            elements.commandInput.value = words.join(' ') + ' ';
            elements.commandInput.focus();
            hideAutocomplete();
        }

        // ==================== Challenge System ====================
        function initializeChallenges() {
            // Load progress from localStorage
            const savedProgress = localStorage.getItem('sqlmapChallengeProgress');
            if (savedProgress) {
                state.challengeProgress = JSON.parse(savedProgress);
                updateChallengeUI();
            }

            // Add submit button listeners
            elements.challengeCards.forEach(card => {
                const submitBtn = card.querySelector('.submit-btn');
                const input = card.querySelector('.challenge-input');
                const result = card.querySelector('.challenge-result');
                const challengeId = card.dataset.challenge;

                submitBtn.addEventListener('click', () => {
                    checkChallenge(challengeId, input, result, card);
                });

                input.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter') {
                        checkChallenge(challengeId, input, result, card);
                    }
                });

                // Disable if already completed
                if (state.challengeProgress[challengeId]) {
                    card.classList.add('completed');
                    submitBtn.disabled = true;
                    input.disabled = true;
                    result.textContent = 'Challenge Completed!';
                    result.classList.add('success', 'show');
                }
            });
        }

        function checkChallenge(challengeId, input, result, card) {
            const userAnswer = input.value.trim().toLowerCase();
            const correctAnswer = input.dataset.answer.toLowerCase();

            // Normalize whitespace for comparison
            const normalizedUser = userAnswer.replace(/\s+/g, ' ');
            const normalizedCorrect = correctAnswer.replace(/\s+/g, ' ');

            if (normalizedUser === normalizedCorrect) {
                // Correct answer
                const points = parseInt(card.querySelector('.challenge-points').textContent);

                if (!state.challengeProgress[challengeId]) {
                    state.challengeProgress[challengeId] = true;
                    state.totalPoints += points;
                    saveProgress();
                }

                result.textContent = `Correct! +${points} points`;
                result.classList.remove('error');
                result.classList.add('success', 'show');

                card.classList.add('completed');
                input.disabled = true;
                card.querySelector('.submit-btn').disabled = true;

                updateStats();
            } else {
                // Wrong answer
                result.textContent = 'Incorrect. Try again!';
                result.classList.remove('success');
                result.classList.add('error', 'show');

                setTimeout(() => {
                    result.classList.remove('show');
                }, 3000);
            }
        }

        function saveProgress() {
            localStorage.setItem('sqlmapChallengeProgress', JSON.stringify(state.challengeProgress));
            localStorage.setItem('sqlmapTotalPoints', state.totalPoints.toString());
        }

        function updateChallengeUI() {
            elements.challengeCards.forEach(card => {
                const challengeId = card.dataset.challenge;
                if (state.challengeProgress[challengeId]) {
                    card.classList.add('completed');
                    const input = card.querySelector('.challenge-input');
                    const submitBtn = card.querySelector('.submit-btn');
                    const result = card.querySelector('.challenge-result');

                    input.disabled = true;
                    submitBtn.disabled = true;
                    result.textContent = 'Challenge Completed!';
                    result.classList.add('success', 'show');
                }
            });

            // Calculate total points
            state.totalPoints = 0;
            elements.challengeCards.forEach(card => {
                const challengeId = card.dataset.challenge;
                if (state.challengeProgress[challengeId]) {
                    const points = parseInt(card.querySelector('.challenge-points').textContent);
                    state.totalPoints += points;
                }
            });

            updateStats();
        }

        function updateStats() {
            const completed = Object.keys(state.challengeProgress).length;
            const total = elements.challengeCards.length;
            const percentage = Math.round((completed / total) * 100);

            elements.totalPoints.textContent = state.totalPoints;
            elements.completedChallenges.textContent = completed;
            elements.successRate.textContent = percentage + '%';
            elements.progressFill.style.width = percentage + '%';
            elements.progressFill.textContent = percentage + '%';
        }

        // ==================== Settings ====================
        elements.exportBtn.addEventListener('click', () => {
            const data = {
                challengeProgress: state.challengeProgress,
                totalPoints: state.totalPoints,
                exportDate: new Date().toISOString()
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `sqlmap-training-progress-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        });

        elements.importBtn.addEventListener('click', () => {
            elements.importFile.click();
        });

        elements.importFile.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (event) => {
                try {
                    const data = JSON.parse(event.target.result);
                    state.challengeProgress = data.challengeProgress || {};
                    state.totalPoints = data.totalPoints || 0;
                    saveProgress();
                    updateChallengeUI();
                    alert('Progress imported successfully!');
                } catch (error) {
                    alert('Error importing file. Please ensure it\'s a valid JSON file.');
                }
            };
            reader.readAsText(file);

            // Reset file input
            e.target.value = '';
        });

        elements.resetBtn.addEventListener('click', () => {
            if (confirm('Are you sure you want to reset all progress? This cannot be undone.')) {
                state.challengeProgress = {};
                state.totalPoints = 0;
                localStorage.removeItem('sqlmapChallengeProgress');
                localStorage.removeItem('sqlmapTotalPoints');

                // Reset UI
                elements.challengeCards.forEach(card => {
                    card.classList.remove('completed');
                    const input = card.querySelector('.challenge-input');
                    const submitBtn = card.querySelector('.submit-btn');
                    const result = card.querySelector('.challenge-result');

                    input.disabled = false;
                    input.value = '';
                    submitBtn.disabled = false;
                    result.classList.remove('show', 'success', 'error');
                    result.textContent = '';
                });

                updateStats();
                alert('Progress reset successfully!');
            }
        });

        // Dark mode toggle
        elements.darkModeToggle.addEventListener('click', () => {
            state.darkMode = !state.darkMode;
            elements.darkModeToggle.classList.toggle('on');
            document.body.classList.toggle('light-mode');
            localStorage.setItem('sqlmapDarkMode', state.darkMode);
        });

        // ==================== Initialization ====================
        function initialize() {
            // Load dark mode preference
            const savedDarkMode = localStorage.getItem('sqlmapDarkMode');
            if (savedDarkMode !== null) {
                state.darkMode = savedDarkMode === 'true';
                if (!state.darkMode) {
                    elements.darkModeToggle.classList.remove('on');
                    document.body.classList.add('light-mode');
                }
            }

            // Load total points
            const savedPoints = localStorage.getItem('sqlmapTotalPoints');
            if (savedPoints) {
                state.totalPoints = parseInt(savedPoints);
            }

            // Initialize challenges
            initializeChallenges();

            // Initial stats update
            updateStats();

            // Set initial scenario
            simulator.setScenario('basic-get');
        }

        // Start the application
        initialize();
    </script>
</body>
</html>
