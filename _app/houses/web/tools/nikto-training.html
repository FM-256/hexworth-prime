<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nikto Training Lab - Web House | Hexworth Prime</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a1628 0%, #0f2847 100%);
            min-height: 100vh;
            padding: 20px;
            color: #e0e0e0;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(10, 22, 40, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            border: 2px solid rgba(6, 182, 212, 0.3);
        }

        .header {
            background: linear-gradient(135deg, #0369a1 0%, #06b6d4 100%);
            padding: 30px;
            text-align: center;
            border-bottom: 3px solid #06b6d4;
        }

        .header h1 {
            color: #ffffff;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            color: #e0f2fe;
            font-size: 1.1em;
        }

        .back-link {
            display: inline-block;
            margin-top: 15px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .back-link:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 0;
            min-height: calc(100vh - 200px);
        }

        .workspace {
            display: flex;
            flex-direction: column;
            border-right: 2px solid rgba(6, 182, 212, 0.3);
        }

        .tab-container {
            display: flex;
            background: rgba(10, 22, 40, 0.9);
            border-bottom: 2px solid rgba(6, 182, 212, 0.3);
            padding: 10px 20px 0;
            gap: 5px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 20px;
            background: rgba(3, 105, 161, 0.3);
            color: #06b6d4;
            border: none;
            cursor: pointer;
            border-radius: 10px 10px 0 0;
            transition: all 0.3s ease;
            font-size: 0.95em;
            font-weight: 500;
            border: 2px solid transparent;
            border-bottom: none;
        }

        .tab:hover {
            background: rgba(6, 182, 212, 0.3);
            color: #e0e0e0;
        }

        .tab.active {
            background: rgba(3, 105, 161, 0.6);
            color: #ffffff;
            border-color: #06b6d4;
        }

        .tab-content {
            display: none;
            flex: 1;
            overflow: hidden;
            flex-direction: column;
        }

        .tab-content.active {
            display: flex;
        }

        /* Learn Tab Styles */
        .learn-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .learn-section {
            margin-bottom: 30px;
        }

        .learn-section h2 {
            color: #06b6d4;
            font-size: 1.8em;
            margin-bottom: 15px;
            border-bottom: 2px solid #0369a1;
            padding-bottom: 10px;
        }

        .learn-section h3 {
            color: #38bdf8;
            font-size: 1.3em;
            margin: 20px 0 10px;
        }

        .learn-section p {
            line-height: 1.8;
            margin-bottom: 15px;
            color: #d0d0d0;
        }

        .learn-section ul, .learn-section ol {
            margin-left: 25px;
            margin-bottom: 15px;
        }

        .learn-section li {
            line-height: 1.8;
            margin-bottom: 8px;
            color: #d0d0d0;
        }

        .info-box {
            background: rgba(6, 182, 212, 0.15);
            border-left: 4px solid #06b6d4;
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        .info-box.warning {
            background: rgba(251, 146, 60, 0.15);
            border-left-color: #fb923c;
        }

        .info-box.success {
            background: rgba(34, 197, 94, 0.15);
            border-left-color: #22c55e;
        }

        .info-box.danger {
            background: rgba(239, 68, 68, 0.15);
            border-left-color: #ef4444;
        }

        .info-box strong {
            color: #06b6d4;
            display: block;
            margin-bottom: 5px;
        }

        .info-box.warning strong {
            color: #fb923c;
        }

        .info-box.success strong {
            color: #22c55e;
        }

        .info-box.danger strong {
            color: #ef4444;
        }

        code {
            background: rgba(3, 105, 161, 0.3);
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #06b6d4;
        }

        .code-block {
            background: rgba(0, 0, 0, 0.6);
            padding: 15px 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
            border: 1px solid rgba(6, 182, 212, 0.3);
            font-size: 0.9em;
        }

        .code-block .command {
            color: #22c55e;
            font-weight: 600;
        }

        .code-block .url {
            color: #06b6d4;
        }

        .code-block .option {
            color: #fbbf24;
        }

        .code-block .value {
            color: #a78bfa;
        }

        .code-block .comment {
            color: #888;
        }

        /* Scanner Lab Styles */
        .scanner-lab {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .scanner-toolbar {
            background: rgba(0, 0, 0, 0.4);
            padding: 15px 20px;
            border-bottom: 2px solid rgba(6, 182, 212, 0.2);
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .scanner-toolbar label {
            color: #06b6d4;
            font-weight: 600;
        }

        .scanner-toolbar select {
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid rgba(6, 182, 212, 0.3);
            color: #e0e0e0;
            padding: 8px 15px;
            border-radius: 6px;
            font-size: 0.95em;
        }

        .scanner-toolbar select:focus {
            outline: none;
            border-color: #06b6d4;
        }

        .scanner-input-area {
            background: rgba(0, 0, 0, 0.4);
            padding: 20px;
            border-bottom: 2px solid rgba(6, 182, 212, 0.2);
        }

        .command-input-wrapper {
            position: relative;
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid rgba(6, 182, 212, 0.3);
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
        }

        .command-prompt {
            color: #22c55e;
            margin-right: 10px;
        }

        #commandInput {
            background: transparent;
            border: none;
            color: #e0e0e0;
            font-family: 'Courier New', monospace;
            font-size: 1em;
            width: calc(100% - 40px);
            outline: none;
        }

        .autocomplete-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.95);
            border: 2px solid rgba(6, 182, 212, 0.5);
            border-radius: 0 0 8px 8px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }

        .autocomplete-suggestions.visible {
            display: block;
        }

        .suggestion-item {
            padding: 10px 15px;
            cursor: pointer;
            color: #06b6d4;
            border-bottom: 1px solid rgba(6, 182, 212, 0.2);
            transition: all 0.2s ease;
        }

        .suggestion-item:hover, .suggestion-item.selected {
            background: rgba(6, 182, 212, 0.3);
            color: #ffffff;
        }

        .suggestion-item .suggestion-desc {
            font-size: 0.85em;
            color: #888;
            margin-top: 3px;
        }

        .scan-button {
            margin-top: 15px;
            padding: 12px 30px;
            background: linear-gradient(135deg, #0369a1 0%, #06b6d4 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .scan-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(6, 182, 212, 0.4);
        }

        .scan-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .output-area {
            flex: 1;
            background: rgba(0, 0, 0, 0.6);
            padding: 20px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .output-line {
            margin-bottom: 5px;
            color: #d0d0d0;
        }

        .output-line.header {
            color: #06b6d4;
            font-weight: 600;
        }

        .output-line.success {
            color: #22c55e;
        }

        .output-line.warning {
            color: #fbbf24;
        }

        .output-line.error {
            color: #ef4444;
        }

        .output-line.info {
            color: #38bdf8;
        }

        .vuln-finding {
            background: rgba(239, 68, 68, 0.15);
            border-left: 3px solid #ef4444;
            padding: 10px 15px;
            margin: 10px 0;
            border-radius: 0 5px 5px 0;
        }

        .vuln-finding.medium {
            background: rgba(251, 146, 60, 0.15);
            border-left-color: #fb923c;
        }

        .vuln-finding.low {
            background: rgba(251, 191, 36, 0.15);
            border-left-color: #fbbf24;
        }

        .vuln-finding.info {
            background: rgba(6, 182, 212, 0.15);
            border-left-color: #06b6d4;
        }

        /* Challenges Tab Styles */
        .challenges-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .challenges-header {
            background: rgba(3, 105, 161, 0.3);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 2px solid rgba(6, 182, 212, 0.3);
        }

        .challenges-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .stat-card {
            background: rgba(0, 0, 0, 0.4);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid rgba(6, 182, 212, 0.2);
        }

        .stat-value {
            font-size: 2em;
            font-weight: 700;
            color: #06b6d4;
            display: block;
        }

        .stat-label {
            color: #888;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .challenge-card {
            background: rgba(3, 105, 161, 0.2);
            border: 2px solid rgba(6, 182, 212, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .challenge-card:hover {
            border-color: #06b6d4;
            transform: translateX(5px);
        }

        .challenge-card.completed {
            background: rgba(34, 197, 94, 0.15);
            border-color: #22c55e;
        }

        .challenge-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 15px;
        }

        .challenge-title {
            color: #06b6d4;
            font-size: 1.2em;
            font-weight: 600;
        }

        .challenge-card.completed .challenge-title {
            color: #22c55e;
        }

        .challenge-points {
            background: rgba(251, 191, 36, 0.3);
            color: #fbbf24;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9em;
        }

        .challenge-description {
            color: #d0d0d0;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .challenge-hint {
            background: rgba(6, 182, 212, 0.1);
            border-left: 3px solid #06b6d4;
            padding: 10px 15px;
            margin-bottom: 15px;
            border-radius: 0 5px 5px 0;
            font-size: 0.9em;
            color: #888;
        }

        .challenge-input-area {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .challenge-input {
            flex: 1;
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid rgba(6, 182, 212, 0.3);
            color: #e0e0e0;
            padding: 10px 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
        }

        .challenge-input:focus {
            outline: none;
            border-color: #06b6d4;
        }

        .challenge-submit {
            padding: 10px 25px;
            background: linear-gradient(135deg, #0369a1 0%, #06b6d4 100%);
            color: white;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .challenge-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(6, 182, 212, 0.4);
        }

        .challenge-submit:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .challenge-feedback {
            margin-top: 10px;
            padding: 10px 15px;
            border-radius: 6px;
            font-weight: 600;
            display: none;
        }

        .challenge-feedback.correct {
            background: rgba(34, 197, 94, 0.2);
            border: 2px solid #22c55e;
            color: #22c55e;
            display: block;
        }

        .challenge-feedback.incorrect {
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid #ef4444;
            color: #ef4444;
            display: block;
        }

        /* Reference Tab Styles */
        .reference-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .reference-section {
            margin-bottom: 30px;
        }

        .reference-section h2 {
            color: #06b6d4;
            font-size: 1.6em;
            margin-bottom: 15px;
            border-bottom: 2px solid #0369a1;
            padding-bottom: 10px;
        }

        .reference-section h3 {
            color: #38bdf8;
            font-size: 1.2em;
            margin: 15px 0 10px;
        }

        .reference-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        .reference-table th {
            background: rgba(3, 105, 161, 0.4);
            color: #06b6d4;
            padding: 12px;
            text-align: left;
            border: 1px solid rgba(6, 182, 212, 0.3);
        }

        .reference-table td {
            background: rgba(0, 0, 0, 0.3);
            color: #d0d0d0;
            padding: 10px 12px;
            border: 1px solid rgba(6, 182, 212, 0.2);
        }

        .reference-table code {
            font-size: 0.9em;
        }

        /* Settings Tab Styles */
        .settings-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .settings-panel {
            max-width: 800px;
        }

        .settings-section {
            background: rgba(3, 105, 161, 0.2);
            border: 2px solid rgba(6, 182, 212, 0.3);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .settings-section h3 {
            color: #06b6d4;
            font-size: 1.3em;
            margin-bottom: 15px;
        }

        .settings-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid rgba(6, 182, 212, 0.2);
        }

        .settings-row:last-child {
            border-bottom: none;
        }

        .settings-row label {
            color: #d0d0d0;
            font-weight: 500;
        }

        .settings-btn {
            padding: 10px 25px;
            background: linear-gradient(135deg, #0369a1 0%, #06b6d4 100%);
            color: white;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .settings-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(6, 182, 212, 0.4);
        }

        .settings-btn.secondary {
            background: linear-gradient(135deg, #475569 0%, #64748b 100%);
        }

        .theme-toggle {
            display: flex;
            gap: 10px;
        }

        .theme-option {
            padding: 8px 20px;
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(6, 182, 212, 0.3);
            color: #06b6d4;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-option.active {
            background: rgba(6, 182, 212, 0.3);
            border-color: #06b6d4;
            color: #ffffff;
        }

        /* Sidebar Styles */
        .sidebar {
            background: rgba(0, 0, 0, 0.4);
            padding: 25px;
            overflow-y: auto;
        }

        .sidebar h3 {
            color: #06b6d4;
            font-size: 1.4em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #0369a1;
        }

        .sidebar h4 {
            color: #38bdf8;
            font-size: 1.1em;
            margin: 20px 0 10px;
        }

        .sidebar p {
            color: #d0d0d0;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .tip-box {
            background: rgba(6, 182, 212, 0.15);
            border-left: 4px solid #06b6d4;
            padding: 15px;
            border-radius: 0 8px 8px 0;
            margin: 15px 0;
        }

        .tip-box strong {
            color: #06b6d4;
            display: block;
            margin-bottom: 8px;
        }

        .progress-summary {
            background: rgba(3, 105, 161, 0.3);
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .progress-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            color: #d0d0d0;
        }

        .progress-value {
            color: #06b6d4;
            font-weight: 600;
        }

        .quick-filters {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin: 15px 0;
        }

        .quick-filter-btn {
            padding: 10px 15px;
            background: rgba(3, 105, 161, 0.3);
            border: 2px solid rgba(6, 182, 212, 0.3);
            color: #06b6d4;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            font-size: 0.95em;
        }

        .quick-filter-btn:hover {
            background: rgba(6, 182, 212, 0.3);
            border-color: #06b6d4;
            color: #ffffff;
            transform: translateX(5px);
        }

        /* Dark mode support */
        body.dark-mode {
            background: linear-gradient(135deg, #000000 0%, #0a1628 100%);
        }

        body.dark-mode .container {
            background: rgba(0, 0, 0, 0.95);
        }

        /* Scrollbar Styles */
        ::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(6, 182, 212, 0.5);
            border-radius: 6px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(6, 182, 212, 0.7);
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .workspace {
                border-right: none;
                border-bottom: 2px solid rgba(6, 182, 212, 0.3);
            }

            .sidebar {
                max-height: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Nikto Training Lab</h1>
            <p>Master web server vulnerability scanning with interactive simulations</p>
            <a href="../index.html" class="back-link">Back to Web House</a>
        </div>

        <div class="main-content">
            <div class="workspace">
                <div class="tab-container">
                    <button class="tab active" onclick="switchTab('learn')">Learn</button>
                    <button class="tab" onclick="switchTab('scanner-lab')">Scanner Lab</button>
                    <button class="tab" onclick="switchTab('challenges')">Challenges</button>
                    <button class="tab" onclick="switchTab('reference')">Reference</button>
                    <button class="tab" onclick="switchTab('settings')">Settings</button>
                </div>

                <!-- LEARN TAB -->
                <div id="learn" class="tab-content active">
                    <div class="learn-content">
                        <div class="learn-section">
                            <h2>What is Nikto?</h2>
                            <p>Nikto is an open-source web server scanner that performs comprehensive tests against web servers for multiple security vulnerabilities and configuration issues. It's one of the most popular tools in the web security tester's arsenal.</p>

                            <div class="info-box danger">
                                <strong>Legal Warning</strong>
                                <p>Only scan web servers you own or have explicit written permission to test. Unauthorized scanning is illegal and unethical. This training module provides a safe, simulated environment for learning.</p>
                            </div>

                            <h3>Key Features</h3>
                            <ul>
                                <li>Detects over 6,700 potentially dangerous files and programs</li>
                                <li>Checks for outdated server software versions (over 1,250 server versions)</li>
                                <li>Identifies version-specific security problems on over 270 servers</li>
                                <li>Scans for dangerous HTTP server options and methods</li>
                                <li>Tests for common misconfigurations</li>
                                <li>Finds default files and directories</li>
                                <li>Supports SSL/TLS scanning</li>
                                <li>Performs subdomain enumeration</li>
                                <li>Exports results in multiple formats (HTML, XML, CSV, JSON)</li>
                            </ul>

                            <h3>How Nikto Works</h3>
                            <p>Nikto operates by sending HTTP requests to a target web server and analyzing the responses. It doesn't perform sophisticated application-level testing but excels at identifying:</p>
                            <ul>
                                <li><strong>Server Information Leakage:</strong> Exposed server versions, technologies, and configurations</li>
                                <li><strong>Dangerous Files:</strong> Admin interfaces, configuration files, backup files, and sensitive directories</li>
                                <li><strong>Outdated Software:</strong> Old server versions with known vulnerabilities</li>
                                <li><strong>HTTP Methods:</strong> Dangerous methods like PUT, DELETE, TRACE, and DEBUG</li>
                                <li><strong>Security Headers:</strong> Missing or misconfigured security headers</li>
                                <li><strong>Default Credentials:</strong> Common default installations and login pages</li>
                            </ul>

                            <div class="info-box warning">
                                <strong>Important Limitation</strong>
                                <p>Nikto is NOT a stealth tool. It makes numerous requests and is easily detected by intrusion detection systems (IDS). It's designed for authorized security assessments, not covert penetration testing.</p>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Basic Nikto Syntax</h2>
                            <p>The basic command structure for Nikto is straightforward:</p>

                            <div class="code-block">
<span class="command">nikto</span> <span class="option">-h</span> <span class="url">&lt;target&gt;</span> <span class="option">[options]</span>
                            </div>

                            <h3>Essential Options</h3>
                            <table class="reference-table">
                                <tr>
                                    <th>Option</th>
                                    <th>Description</th>
                                    <th>Example</th>
                                </tr>
                                <tr>
                                    <td><code>-h</code></td>
                                    <td>Target host/IP (required)</td>
                                    <td><code>-h http://target.com</code></td>
                                </tr>
                                <tr>
                                    <td><code>-p</code></td>
                                    <td>Target port(s)</td>
                                    <td><code>-p 80,443,8080</code></td>
                                </tr>
                                <tr>
                                    <td><code>-ssl</code></td>
                                    <td>Force SSL/TLS mode</td>
                                    <td><code>-ssl</code></td>
                                </tr>
                                <tr>
                                    <td><code>-Tuning</code></td>
                                    <td>Scan tuning (see below)</td>
                                    <td><code>-Tuning 123</code></td>
                                </tr>
                                <tr>
                                    <td><code>-o</code></td>
                                    <td>Output file</td>
                                    <td><code>-o results.html</code></td>
                                </tr>
                                <tr>
                                    <td><code>-Format</code></td>
                                    <td>Output format</td>
                                    <td><code>-Format html</code></td>
                                </tr>
                            </table>

                            <h3>Example Commands</h3>
                            <div class="code-block">
<span class="comment"># Basic scan</span>
<span class="command">nikto</span> <span class="option">-h</span> <span class="url">http://example.com</span>

<span class="comment"># SSL/TLS scan on specific port</span>
<span class="command">nikto</span> <span class="option">-h</span> <span class="url">https://example.com</span> <span class="option">-p</span> <span class="value">443</span> <span class="option">-ssl</span>

<span class="comment"># Tuned scan with HTML output</span>
<span class="command">nikto</span> <span class="option">-h</span> <span class="url">http://example.com</span> <span class="option">-Tuning</span> <span class="value">123</span> <span class="option">-o</span> <span class="value">scan.html</span> <span class="option">-Format</span> <span class="value">html</span>

<span class="comment"># Scan multiple ports</span>
<span class="command">nikto</span> <span class="option">-h</span> <span class="url">192.168.1.10</span> <span class="option">-p</span> <span class="value">80,443,8080,8443</span>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Scan Tuning</h2>
                            <p>Nikto's <code>-Tuning</code> option allows you to focus scans on specific vulnerability categories. You can combine multiple tuning codes.</p>

                            <h3>Tuning Categories</h3>
                            <table class="reference-table">
                                <tr>
                                    <th>Code</th>
                                    <th>Category</th>
                                    <th>Description</th>
                                </tr>
                                <tr>
                                    <td><code>0</code></td>
                                    <td>File Upload</td>
                                    <td>Tests for file upload functionality</td>
                                </tr>
                                <tr>
                                    <td><code>1</code></td>
                                    <td>Interesting Files</td>
                                    <td>Searches for interesting files (logs, backups, configs)</td>
                                </tr>
                                <tr>
                                    <td><code>2</code></td>
                                    <td>Misconfiguration</td>
                                    <td>Checks for common misconfigurations</td>
                                </tr>
                                <tr>
                                    <td><code>3</code></td>
                                    <td>Information Disclosure</td>
                                    <td>Tests for information leakage</td>
                                </tr>
                                <tr>
                                    <td><code>4</code></td>
                                    <td>Injection (XSS/Script)</td>
                                    <td>Basic XSS and injection tests</td>
                                </tr>
                                <tr>
                                    <td><code>5</code></td>
                                    <td>Remote File Retrieval</td>
                                    <td>Tests for remote file inclusion</td>
                                </tr>
                                <tr>
                                    <td><code>6</code></td>
                                    <td>Denial of Service</td>
                                    <td>Checks for DoS vulnerabilities</td>
                                </tr>
                                <tr>
                                    <td><code>7</code></td>
                                    <td>Remote File Execution</td>
                                    <td>Tests for command execution</td>
                                </tr>
                                <tr>
                                    <td><code>8</code></td>
                                    <td>Command Execution</td>
                                    <td>Additional command injection tests</td>
                                </tr>
                                <tr>
                                    <td><code>9</code></td>
                                    <td>SQL Injection</td>
                                    <td>Basic SQL injection tests</td>
                                </tr>
                                <tr>
                                    <td><code>a</code></td>
                                    <td>Authentication Bypass</td>
                                    <td>Tests for auth bypass vulnerabilities</td>
                                </tr>
                                <tr>
                                    <td><code>b</code></td>
                                    <td>Software Identification</td>
                                    <td>Identifies software versions</td>
                                </tr>
                                <tr>
                                    <td><code>x</code></td>
                                    <td>Reverse Tuning</td>
                                    <td>Exclude the specified categories</td>
                                </tr>
                            </table>

                            <div class="info-box success">
                                <strong>Pro Tip: Combining Tuning Codes</strong>
                                <p>Use <code>-Tuning 123</code> to scan only for interesting files (1), misconfigurations (2), and information disclosure (3). This is one of the most common combinations for initial reconnaissance.</p>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Understanding Nikto Output</h2>
                            <p>Nikto provides detailed output about discovered vulnerabilities and server information. Here's how to interpret the results:</p>

                            <h3>Typical Output Format</h3>
                            <div class="code-block">
<span class="option">---------------------------------------------------------------------------</span>
<span class="header">+ Target IP:          192.168.1.100</span>
<span class="header">+ Target Hostname:    vulnerable-server.com</span>
<span class="header">+ Target Port:        80</span>
<span class="option">+ Start Time:         2025-12-22 10:30:00 (GMT-5)</span>
<span class="option">---------------------------------------------------------------------------</span>
<span class="header">+ Server: Apache/2.2.15 (CentOS)</span>
<span class="error">+ Server leaks inodes via ETags, header found with file /, fields: 0x12ab 0x4f3a</span>
<span class="warning">+ OSVDB-3233: /phpinfo.php: Contains PHP configuration information</span>
<span class="error">+ OSVDB-3092: /admin/: This might be interesting...</span>
<span class="warning">+ OSVDB-3268: /backup/: Directory indexing found.</span>
<span class="info">+ 7535 requests: 0 error(s) and 15 item(s) reported on remote host</span>
<span class="option">+ End Time:           2025-12-22 10:45:00 (GMT-5) (900 seconds)</span>
                            </div>

                            <h3>Finding Severity Levels</h3>
                            <ul>
                                <li><strong>Critical/High:</strong> Outdated software with known exploits, dangerous files (phpinfo.php, web shells)</li>
                                <li><strong>Medium:</strong> Information disclosure, default credentials, dangerous HTTP methods</li>
                                <li><strong>Low:</strong> Directory indexing, missing security headers, version disclosure</li>
                                <li><strong>Informational:</strong> Server identification, available HTTP methods</li>
                            </ul>

                            <h3>OSVDB References</h3>
                            <p>Many Nikto findings include OSVDB (Open Source Vulnerability Database) references. These numeric codes can be searched online for detailed vulnerability information, even though the OSVDB project itself has been discontinued.</p>
                        </div>

                        <div class="learn-section">
                            <h2>Advanced Techniques</h2>

                            <h3>Evading Detection (Ethical Use Only)</h3>
                            <p>While Nikto is inherently noisy, you can reduce its footprint:</p>
                            <ul>
                                <li><code>-Pause</code>: Add delay between requests (e.g., <code>-Pause 5</code> for 5 seconds)</li>
                                <li><code>-mutate</code>: Use mutation techniques to try different request variations</li>
                                <li><code>-useragent</code>: Change User-Agent string to blend in</li>
                                <li>Tunnel through proxies for IP obfuscation</li>
                            </ul>

                            <h3>Authentication</h3>
                            <p>Test authenticated areas of web applications:</p>
                            <div class="code-block">
<span class="comment"># Basic authentication</span>
<span class="command">nikto</span> <span class="option">-h</span> <span class="url">http://example.com</span> <span class="option">-id</span> <span class="value">username:password</span>

<span class="comment"># Use cookies for session-based auth</span>
<span class="command">nikto</span> <span class="option">-h</span> <span class="url">http://example.com</span> <span class="option">-usecookies</span> <span class="value">sessionid=abc123xyz</span>
                            </div>

                            <h3>Plugin Management</h3>
                            <p>Nikto uses plugins for different test categories. You can list, enable, or disable specific plugins:</p>
                            <div class="code-block">
<span class="comment"># List available plugins</span>
<span class="command">nikto</span> <span class="option">-list-plugins</span>

<span class="comment"># Use specific plugins</span>
<span class="command">nikto</span> <span class="option">-h</span> <span class="url">http://example.com</span> <span class="option">-Plugins</span> <span class="value">'apacheusers;outdated'</span>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Real-World Application</h2>

                            <h3>Typical Security Assessment Workflow</h3>
                            <ol>
                                <li><strong>Reconnaissance:</strong> Use Nmap to identify web servers and open ports</li>
                                <li><strong>Initial Scan:</strong> Run Nikto with <code>-Tuning 123b</code> for quick identification</li>
                                <li><strong>Focused Scanning:</strong> Based on initial findings, run targeted scans</li>
                                <li><strong>Manual Verification:</strong> Verify high-priority findings manually (Nikto has false positives)</li>
                                <li><strong>Documentation:</strong> Export results in HTML format for reporting</li>
                                <li><strong>Remediation Tracking:</strong> Re-scan after fixes to verify resolution</li>
                            </ol>

                            <h3>Integration with Other Tools</h3>
                            <p>Nikto works best as part of a comprehensive toolkit:</p>
                            <ul>
                                <li><strong>Nmap:</strong> Port scanning and service enumeration before Nikto</li>
                                <li><strong>Burp Suite:</strong> Deep application testing of Nikto findings</li>
                                <li><strong>Metasploit:</strong> Exploit verification for identified vulnerabilities</li>
                                <li><strong>OWASP ZAP:</strong> Complementary web application scanning</li>
                                <li><strong>SQLMap:</strong> Advanced SQL injection testing of flagged parameters</li>
                            </ul>

                            <div class="info-box">
                                <strong>Best Practice</strong>
                                <p>Always run Nikto from an authorized IP address, save all scan output for documentation, and verify findings manually before reporting. Remember: Nikto is a discovery tool, not a definitive proof of vulnerability.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SCANNER LAB TAB -->
                <div id="scanner-lab" class="tab-content">
                    <div class="scanner-lab">
                        <div class="scanner-toolbar">
                            <label>Select Target:</label>
                            <select id="targetSelect">
                                <option value="">-- Choose a target --</option>
                                <option value="apache-old">vulnerable-apache.com (Outdated Apache)</option>
                                <option value="nginx-misconfig">secure-nginx.net (Misconfigured Nginx)</option>
                                <option value="iis-default">windows-iis.local (Default IIS)</option>
                                <option value="tomcat-admin">webapp-tomcat.com (Exposed Tomcat)</option>
                                <option value="wordpress-old">blog-wordpress.org (Old WordPress)</option>
                                <option value="api-server">api.company.com (REST API Server)</option>
                            </select>
                        </div>

                        <div class="scanner-input-area">
                            <div class="command-input-wrapper">
                                <span class="command-prompt">root@kali:~$</span>
                                <input type="text" id="commandInput" placeholder="Type nikto command... (try Tab for autocomplete)" autocomplete="off">
                                <div id="autocompleteSuggestions" class="autocomplete-suggestions"></div>
                            </div>
                            <button class="scan-button" onclick="executeScan()">Execute Scan</button>
                        </div>

                        <div class="output-area" id="scanOutput">
                            <div class="output-line info">Nikto Training Lab - Scanner Simulator</div>
                            <div class="output-line">Select a target and enter a command to begin scanning...</div>
                            <div class="output-line" style="margin-top: 20px; color: #06b6d4;">Example commands:</div>
                            <div class="output-line">  nikto -h http://target.com</div>
                            <div class="output-line">  nikto -h https://target.com -ssl -Tuning 123</div>
                            <div class="output-line">  nikto -h http://target.com -p 80,443,8080</div>
                            <div class="output-line">  nikto -h http://target.com -Tuning 1 -Format html -o output.html</div>
                        </div>
                    </div>
                </div>

                <!-- CHALLENGES TAB -->
                <div id="challenges" class="tab-content">
                    <div class="challenges-content">
                        <div class="challenges-header">
                            <h2 style="color: #06b6d4; margin-bottom: 15px;">Security Challenges</h2>
                            <p style="color: #d0d0d0;">Test your Nikto skills with these practical challenges. Use the Scanner Lab to investigate targets!</p>

                            <div class="challenges-stats">
                                <div class="stat-card">
                                    <span class="stat-value" id="completedCount">0</span>
                                    <span class="stat-label">Challenges Completed</span>
                                </div>
                                <div class="stat-card">
                                    <span class="stat-value" id="totalPointsDisplay">0</span>
                                    <span class="stat-label">Points Earned</span>
                                </div>
                                <div class="stat-card">
                                    <span class="stat-value">225</span>
                                    <span class="stat-label">Total Available</span>
                                </div>
                            </div>
                        </div>

                        <div id="challengesList"></div>
                    </div>
                </div>

                <!-- REFERENCE TAB -->
                <div id="reference" class="tab-content">
                    <div class="reference-content">
                        <div class="reference-section">
                            <h2>Quick Reference Guide</h2>

                            <h3>Essential Command Options</h3>
                            <table class="reference-table">
                                <tr>
                                    <th style="width: 25%;">Option</th>
                                    <th style="width: 50%;">Description</th>
                                    <th style="width: 25%;">Example</th>
                                </tr>
                                <tr>
                                    <td><code>-h [host]</code></td>
                                    <td>Target host/IP/URL (required)</td>
                                    <td><code>-h 192.168.1.1</code></td>
                                </tr>
                                <tr>
                                    <td><code>-p [port(s)]</code></td>
                                    <td>Port number(s) to scan</td>
                                    <td><code>-p 80,443</code></td>
                                </tr>
                                <tr>
                                    <td><code>-ssl</code></td>
                                    <td>Force SSL/TLS connection</td>
                                    <td><code>-ssl</code></td>
                                </tr>
                                <tr>
                                    <td><code>-nossl</code></td>
                                    <td>Disable SSL/TLS</td>
                                    <td><code>-nossl</code></td>
                                </tr>
                                <tr>
                                    <td><code>-Tuning [x]</code></td>
                                    <td>Scan tuning options (0-9,a,b,x)</td>
                                    <td><code>-Tuning 123</code></td>
                                </tr>
                                <tr>
                                    <td><code>-o [file]</code></td>
                                    <td>Output file path</td>
                                    <td><code>-o scan.txt</code></td>
                                </tr>
                                <tr>
                                    <td><code>-Format [fmt]</code></td>
                                    <td>Output format (txt, html, csv, xml, json)</td>
                                    <td><code>-Format html</code></td>
                                </tr>
                                <tr>
                                    <td><code>-id [user:pass]</code></td>
                                    <td>HTTP basic authentication</td>
                                    <td><code>-id admin:p@ss</code></td>
                                </tr>
                                <tr>
                                    <td><code>-useragent [ua]</code></td>
                                    <td>Custom User-Agent string</td>
                                    <td><code>-useragent "Mozilla/5.0"</code></td>
                                </tr>
                                <tr>
                                    <td><code>-Pause [n]</code></td>
                                    <td>Pause n seconds between tests</td>
                                    <td><code>-Pause 5</code></td>
                                </tr>
                                <tr>
                                    <td><code>-timeout [n]</code></td>
                                    <td>Timeout for requests (seconds)</td>
                                    <td><code>-timeout 10</code></td>
                                </tr>
                                <tr>
                                    <td><code>-mutate [1-6]</code></td>
                                    <td>Mutation technique number</td>
                                    <td><code>-mutate 1</code></td>
                                </tr>
                                <tr>
                                    <td><code>-Plugins [list]</code></td>
                                    <td>Select plugins to run</td>
                                    <td><code>-Plugins "outdated"</code></td>
                                </tr>
                                <tr>
                                    <td><code>-list-plugins</code></td>
                                    <td>List available plugins</td>
                                    <td><code>-list-plugins</code></td>
                                </tr>
                                <tr>
                                    <td><code>-update</code></td>
                                    <td>Update database and plugins</td>
                                    <td><code>-update</code></td>
                                </tr>
                            </table>

                            <h3>Tuning Categories Reference</h3>
                            <table class="reference-table">
                                <tr>
                                    <th style="width: 15%;">Code</th>
                                    <th style="width: 35%;">Category</th>
                                    <th style="width: 50%;">What It Tests</th>
                                </tr>
                                <tr>
                                    <td><code>0</code></td>
                                    <td>File Upload</td>
                                    <td>Upload forms and file handling vulnerabilities</td>
                                </tr>
                                <tr>
                                    <td><code>1</code></td>
                                    <td>Interesting Files</td>
                                    <td>Logs, backups, configs, source files</td>
                                </tr>
                                <tr>
                                    <td><code>2</code></td>
                                    <td>Misconfiguration</td>
                                    <td>Server misconfigurations, dangerous settings</td>
                                </tr>
                                <tr>
                                    <td><code>3</code></td>
                                    <td>Information Disclosure</td>
                                    <td>Version numbers, server info, banner grabbing</td>
                                </tr>
                                <tr>
                                    <td><code>4</code></td>
                                    <td>Injection</td>
                                    <td>XSS, script injection vulnerabilities</td>
                                </tr>
                                <tr>
                                    <td><code>5</code></td>
                                    <td>Remote File Retrieval</td>
                                    <td>RFI (Remote File Inclusion) vulnerabilities</td>
                                </tr>
                                <tr>
                                    <td><code>6</code></td>
                                    <td>Denial of Service</td>
                                    <td>DoS vulnerabilities and resource exhaustion</td>
                                </tr>
                                <tr>
                                    <td><code>7</code></td>
                                    <td>Remote File Execution</td>
                                    <td>Code execution vulnerabilities</td>
                                </tr>
                                <tr>
                                    <td><code>8</code></td>
                                    <td>Command Execution</td>
                                    <td>Command injection vulnerabilities</td>
                                </tr>
                                <tr>
                                    <td><code>9</code></td>
                                    <td>SQL Injection</td>
                                    <td>SQLi vulnerabilities</td>
                                </tr>
                                <tr>
                                    <td><code>a</code></td>
                                    <td>Authentication Bypass</td>
                                    <td>Auth bypass and broken authentication</td>
                                </tr>
                                <tr>
                                    <td><code>b</code></td>
                                    <td>Software Identification</td>
                                    <td>Identify software and versions</td>
                                </tr>
                                <tr>
                                    <td><code>x</code></td>
                                    <td>Reverse Tuning</td>
                                    <td>Exclude specified tuning codes</td>
                                </tr>
                            </table>

                            <h3>Output Formats</h3>
                            <table class="reference-table">
                                <tr>
                                    <th style="width: 20%;">Format</th>
                                    <th style="width: 40%;">Description</th>
                                    <th style="width: 40%;">Use Case</th>
                                </tr>
                                <tr>
                                    <td><code>txt</code></td>
                                    <td>Plain text (default)</td>
                                    <td>Command line viewing, grep parsing</td>
                                </tr>
                                <tr>
                                    <td><code>html</code></td>
                                    <td>HTML report</td>
                                    <td>Client reports, web viewing</td>
                                </tr>
                                <tr>
                                    <td><code>csv</code></td>
                                    <td>Comma-separated values</td>
                                    <td>Spreadsheet analysis, data processing</td>
                                </tr>
                                <tr>
                                    <td><code>xml</code></td>
                                    <td>XML format</td>
                                    <td>Integration with other tools, parsing</td>
                                </tr>
                                <tr>
                                    <td><code>json</code></td>
                                    <td>JSON format</td>
                                    <td>API integration, modern toolchains</td>
                                </tr>
                            </table>

                            <h3>Common Vulnerability Findings</h3>
                            <table class="reference-table">
                                <tr>
                                    <th style="width: 30%;">Finding Type</th>
                                    <th style="width: 40%;">Example</th>
                                    <th style="width: 30%;">Severity</th>
                                </tr>
                                <tr>
                                    <td>Outdated Software</td>
                                    <td>Apache/2.2.15 (known exploits)</td>
                                    <td>High/Critical</td>
                                </tr>
                                <tr>
                                    <td>Default Files</td>
                                    <td>/phpinfo.php, /admin/, /test.php</td>
                                    <td>Medium/High</td>
                                </tr>
                                <tr>
                                    <td>Directory Indexing</td>
                                    <td>/backup/, /uploads/ listing enabled</td>
                                    <td>Low/Medium</td>
                                </tr>
                                <tr>
                                    <td>Dangerous HTTP Methods</td>
                                    <td>PUT, DELETE, TRACE enabled</td>
                                    <td>Medium</td>
                                </tr>
                                <tr>
                                    <td>Information Disclosure</td>
                                    <td>Server version in headers</td>
                                    <td>Low</td>
                                </tr>
                                <tr>
                                    <td>Missing Headers</td>
                                    <td>X-Frame-Options, CSP, HSTS</td>
                                    <td>Low/Medium</td>
                                </tr>
                                <tr>
                                    <td>Default Credentials</td>
                                    <td>Admin panels with default passwords</td>
                                    <td>Critical</td>
                                </tr>
                                <tr>
                                    <td>Backup Files</td>
                                    <td>.bak, .old, ~ files accessible</td>
                                    <td>Medium/High</td>
                                </tr>
                            </table>

                            <h3>Quick Command Examples</h3>
                            <div class="code-block">
<span class="comment"># Basic HTTP scan</span>
<span class="command">nikto</span> <span class="option">-h</span> <span class="url">http://target.com</span>

<span class="comment"># HTTPS scan with SSL</span>
<span class="command">nikto</span> <span class="option">-h</span> <span class="url">https://target.com</span> <span class="option">-ssl</span>

<span class="comment"># Scan specific ports</span>
<span class="command">nikto</span> <span class="option">-h</span> <span class="url">192.168.1.10</span> <span class="option">-p</span> <span class="value">80,443,8080,8443</span>

<span class="comment"># Tuned scan for misconfigurations and info disclosure</span>
<span class="command">nikto</span> <span class="option">-h</span> <span class="url">http://target.com</span> <span class="option">-Tuning</span> <span class="value">23</span>

<span class="comment"># Comprehensive scan with HTML output</span>
<span class="command">nikto</span> <span class="option">-h</span> <span class="url">http://target.com</span> <span class="option">-Tuning</span> <span class="value">123b</span> <span class="option">-o</span> <span class="value">report.html</span> <span class="option">-Format</span> <span class="value">html</span>

<span class="comment"># Scan with authentication</span>
<span class="command">nikto</span> <span class="option">-h</span> <span class="url">http://target.com</span> <span class="option">-id</span> <span class="value">admin:password123</span>

<span class="comment"># Slow scan to evade detection</span>
<span class="command">nikto</span> <span class="option">-h</span> <span class="url">http://target.com</span> <span class="option">-Pause</span> <span class="value">5</span> <span class="option">-timeout</span> <span class="value">20</span>

<span class="comment"># Multiple targets from file</span>
<span class="command">nikto</span> <span class="option">-h</span> <span class="value">targets.txt</span>

<span class="comment"># Update Nikto database</span>
<span class="command">nikto</span> <span class="option">-update</span>

<span class="comment"># List all plugins</span>
<span class="command">nikto</span> <span class="option">-list-plugins</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SETTINGS TAB -->
                <div id="settings" class="tab-content">
                    <div class="settings-content">
                        <div class="settings-panel">
                            <div class="settings-section">
                                <h3>Export Progress</h3>
                                <p style="color: #888; margin-bottom: 15px;">Save your challenge progress and settings to continue later.</p>
                                <div class="settings-row">
                                    <label>Export your progress data</label>
                                    <button class="settings-btn" onclick="exportProgress()">Export to File</button>
                                </div>
                            </div>

                            <div class="settings-section">
                                <h3>Import Progress</h3>
                                <p style="color: #888; margin-bottom: 15px;">Load previously saved progress.</p>
                                <div class="settings-row">
                                    <label>Import progress data</label>
                                    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importProgress(event)">
                                    <button class="settings-btn secondary" onclick="document.getElementById('importFile').click()">Import from File</button>
                                </div>
                            </div>

                            <div class="settings-section">
                                <h3>Reset Progress</h3>
                                <p style="color: #888; margin-bottom: 15px;">Clear all challenge progress and start fresh.</p>
                                <div class="settings-row">
                                    <label>This cannot be undone!</label>
                                    <button class="settings-btn" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);" onclick="resetProgress()">Reset All Progress</button>
                                </div>
                            </div>

                            <div class="settings-section">
                                <h3>Appearance</h3>
                                <div class="settings-row">
                                    <label>Theme</label>
                                    <div class="theme-toggle">
                                        <div class="theme-option active" data-theme="default" onclick="setTheme('default')">Default</div>
                                        <div class="theme-option" data-theme="dark" onclick="setTheme('dark')">Dark Mode</div>
                                    </div>
                                </div>
                            </div>

                            <div class="settings-section">
                                <h3>Statistics</h3>
                                <div class="settings-row">
                                    <label>Total Challenges Completed</label>
                                    <span id="statsCompleted" style="color: #22c55e; font-weight: 600;">0</span>
                                </div>
                                <div class="settings-row">
                                    <label>Total Points Earned</label>
                                    <span id="statsPoints" style="color: #fbbf24; font-weight: 600;">0</span>
                                </div>
                                <div class="settings-row">
                                    <label>Scans Executed</label>
                                    <span id="statsScans" style="color: #06b6d4; font-weight: 600;">0</span>
                                </div>
                                <div class="settings-row">
                                    <label>Vulnerabilities Found</label>
                                    <span id="statsVulns" style="color: #ef4444; font-weight: 600;">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SIDEBAR -->
            <div class="sidebar" id="sidebar">
                <h3>Learning Panel</h3>
                <div id="learningContent">
                    <h4>Welcome to Nikto Training!</h4>
                    <p>This interactive lab will teach you how to use Nikto to identify web server vulnerabilities and misconfigurations.</p>

                    <div class="tip-box">
                        <strong>Getting Started</strong>
                        <p>Start with the <strong>Learn</strong> tab for fundamentals, then practice in the <strong>Scanner Lab</strong>!</p>
                    </div>

                    <div class="progress-summary">
                        <h4 style="color: #06b6d4; margin-bottom: 10px;">Your Progress</h4>
                        <div class="progress-item">
                            <span>Challenges:</span>
                            <span class="progress-value" id="sidebarProgress">0/10</span>
                        </div>
                        <div class="progress-item">
                            <span>Points:</span>
                            <span class="progress-value" id="sidebarPoints">0/225</span>
                        </div>
                    </div>

                    <h4>Quick Actions</h4>
                    <p>Try these scenarios:</p>
                    <div class="quick-filters">
                        <button class="quick-filter-btn" onclick="switchTab('scanner-lab'); document.getElementById('targetSelect').value='apache-old'; loadQuickScan('apache-old');">Apache Server Scan</button>
                        <button class="quick-filter-btn" onclick="switchTab('scanner-lab'); document.getElementById('targetSelect').value='nginx-misconfig'; loadQuickScan('nginx-misconfig');">Nginx Scan</button>
                        <button class="quick-filter-btn" onclick="switchTab('scanner-lab'); document.getElementById('targetSelect').value='iis-default'; loadQuickScan('iis-default');">IIS Default Scan</button>
                        <button class="quick-filter-btn" onclick="switchTab('scanner-lab'); document.getElementById('targetSelect').value='wordpress-old'; loadQuickScan('wordpress-old');">WordPress Scan</button>
                    </div>

                    <div class="tip-box" style="margin-top: 15px; background: rgba(239, 68, 68, 0.15); border-left-color: #ef4444;">
                        <strong style="color: #ef4444;">Legal Warning</strong>
                        <p>Only scan web servers you own or have explicit written permission to test. Unauthorized scanning is illegal!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== STATE MANAGEMENT ====================
        let completedChallenges = new Set();
        let totalPoints = 0;
        let scanCount = 0;
        let vulnCount = 0;
        let selectedSuggestionIndex = -1;

        // ==================== CHALLENGE DEFINITIONS ====================
        const challenges = [
            {
                id: 1,
                title: 'Identify Outdated Apache Version',
                description: 'Scan the "vulnerable-apache.com" target. What version of Apache is it running?',
                hint: 'Look for "Server:" in the scan output. The version will be in format Apache/X.X.XX',
                points: 15,
                answer: 'Apache/2.2.15',
                caseSensitive: false,
                inputType: 'text'
            },
            {
                id: 2,
                title: 'Find Dangerous HTTP Method',
                description: 'On the "vulnerable-apache.com" target, which dangerous HTTP method is enabled that allows file modification?',
                hint: 'Look for allowed HTTP methods. The answer is a 3-letter method that can modify files.',
                points: 20,
                answer: 'PUT',
                caseSensitive: false,
                inputType: 'text'
            },
            {
                id: 3,
                title: 'Locate Admin Panel',
                description: 'On the "windows-iis.local" target, what is the path to the exposed admin interface? (Include the leading /)',
                hint: 'Look for directories that might contain administration panels. Format: /path/',
                points: 25,
                answer: '/admin/',
                caseSensitive: false,
                inputType: 'text'
            },
            {
                id: 4,
                title: 'Identify Information Disclosure File',
                description: 'On "vulnerable-apache.com", which PHP file exposes server configuration information?',
                hint: 'This is a common PHP file used for debugging that shows all PHP configuration.',
                points: 20,
                answer: 'phpinfo.php',
                caseSensitive: false,
                inputType: 'text'
            },
            {
                id: 5,
                title: 'Detect Directory Indexing',
                description: 'On "secure-nginx.net", which directory has indexing enabled, exposing its contents? (Format: /directory/)',
                hint: 'Look for "Directory indexing found" messages. The directory name relates to data backups.',
                points: 20,
                answer: '/backup/',
                caseSensitive: false,
                inputType: 'text'
            },
            {
                id: 6,
                title: 'Find WordPress Version',
                description: 'Scan "blog-wordpress.org". What version of WordPress is installed?',
                hint: 'Look for WordPress version information in the scan output. Format: X.X.X',
                points: 25,
                answer: '4.7.0',
                caseSensitive: false,
                inputType: 'text'
            },
            {
                id: 7,
                title: 'Tomcat Manager Discovery',
                description: 'On "webapp-tomcat.com", what is the complete path to the Tomcat manager interface?',
                hint: 'Tomcat has a standard manager path. Format: /path/subpath',
                points: 20,
                answer: '/manager/html',
                caseSensitive: false,
                inputType: 'text'
            },
            {
                id: 8,
                title: 'Count Vulnerabilities on Apache',
                description: 'How many total vulnerabilities/findings are reported on "vulnerable-apache.com"?',
                hint: 'Count all the findings in the scan output, including misconfigurations and dangerous files.',
                points: 25,
                answer: '7',
                caseSensitive: false,
                inputType: 'text'
            },
            {
                id: 9,
                title: 'Missing Security Header',
                description: 'On "api.company.com", which important security header is missing? (Hint: prevents clickjacking)',
                hint: 'This header is X-Frame-Options or similar. Answer with the full header name.',
                points: 30,
                answer: 'X-Frame-Options',
                caseSensitive: false,
                inputType: 'text'
            },
            {
                id: 10,
                title: 'Identify TRACE Method Risk',
                description: 'The TRACE method is enabled on "vulnerable-apache.com". What is the OSVDB reference number for this finding?',
                hint: 'Look for the OSVDB number associated with the TRACE method finding in the output.',
                points: 25,
                answer: 'OSVDB-877',
                caseSensitive: false,
                inputType: 'text'
            }
        ];

        // ==================== TARGET DEFINITIONS ====================
        const targets = {
            'apache-old': {
                name: 'vulnerable-apache.com',
                ip: '192.168.1.100',
                port: '80',
                server: 'Apache/2.2.15 (CentOS)',
                vulnerabilities: [
                    { type: 'error', msg: '+ Server leaks inodes via ETags, header found with file /, fields: 0x12ab 0x4f3a5b2c 0x1c2e', osvdb: 'OSVDB-3233' },
                    { type: 'warning', msg: '+ OSVDB-3233: /phpinfo.php: Contains PHP configuration information', osvdb: 'OSVDB-3233' },
                    { type: 'error', msg: '+ OSVDB-3092: /admin/: This might be interesting...', osvdb: 'OSVDB-3092' },
                    { type: 'warning', msg: '+ OSVDB-3268: /backup/: Directory indexing found.', osvdb: 'OSVDB-3268' },
                    { type: 'error', msg: '+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST', osvdb: 'OSVDB-877' },
                    { type: 'warning', msg: '+ OSVDB-3233: /icons/README: Apache default file found.', osvdb: 'OSVDB-3233' },
                    { type: 'error', msg: '+ HTTP method PUT is enabled, this could allow clients to upload files', osvdb: 'OSVDB-397' }
                ],
                summary: '7 item(s) reported on remote host'
            },
            'nginx-misconfig': {
                name: 'secure-nginx.net',
                ip: '10.0.0.50',
                port: '443',
                server: 'nginx/1.14.0',
                vulnerabilities: [
                    { type: 'info', msg: '+ Server: nginx/1.14.0', osvdb: '' },
                    { type: 'warning', msg: '+ OSVDB-3268: /backup/: Directory indexing found.', osvdb: 'OSVDB-3268' },
                    { type: 'warning', msg: '+ OSVDB-3092: /.git/: Git repository found. This might contain sensitive information.', osvdb: 'OSVDB-3092' },
                    { type: 'warning', msg: '+ Missing security header: X-Content-Type-Options', osvdb: '' },
                    { type: 'info', msg: '+ nginx server allows HTTP 1.0 protocol which is outdated and insecure', osvdb: '' }
                ],
                summary: '5 item(s) reported on remote host'
            },
            'iis-default': {
                name: 'windows-iis.local',
                ip: '172.16.0.10',
                port: '80',
                server: 'Microsoft-IIS/7.5',
                vulnerabilities: [
                    { type: 'info', msg: '+ Server: Microsoft-IIS/7.5', osvdb: '' },
                    { type: 'error', msg: '+ OSVDB-3092: /admin/: Admin interface detected. Default credentials may exist.', osvdb: 'OSVDB-3092' },
                    { type: 'warning', msg: '+ OSVDB-3233: /test.asp: ASP test file found.', osvdb: 'OSVDB-3233' },
                    { type: 'error', msg: '+ OSVDB-3233: /web.config.old: Backup configuration file found.', osvdb: 'OSVDB-3233' },
                    { type: 'warning', msg: '+ X-AspNet-Version header found: 4.0.30319', osvdb: '' },
                    { type: 'warning', msg: '+ Missing security header: X-Frame-Options', osvdb: '' }
                ],
                summary: '6 item(s) reported on remote host'
            },
            'tomcat-admin': {
                name: 'webapp-tomcat.com',
                ip: '10.10.10.25',
                port: '8080',
                server: 'Apache-Coyote/1.1',
                vulnerabilities: [
                    { type: 'info', msg: '+ Server: Apache-Coyote/1.1', osvdb: '' },
                    { type: 'error', msg: '+ OSVDB-3092: /manager/html: Tomcat Manager interface found. Default credentials should be checked.', osvdb: 'OSVDB-3092' },
                    { type: 'error', msg: '+ OSVDB-3233: /host-manager/html: Tomcat Host Manager found.', osvdb: 'OSVDB-3233' },
                    { type: 'warning', msg: '+ OSVDB-3233: /examples/: Sample application found.', osvdb: 'OSVDB-3233' },
                    { type: 'warning', msg: '+ OSVDB-3268: /docs/: Directory indexing found.', osvdb: 'OSVDB-3268' },
                    { type: 'info', msg: '+ Default Tomcat installation detected', osvdb: '' }
                ],
                summary: '6 item(s) reported on remote host'
            },
            'wordpress-old': {
                name: 'blog-wordpress.org',
                ip: '203.0.113.45',
                port: '80',
                server: 'Apache/2.4.18 (Ubuntu)',
                vulnerabilities: [
                    { type: 'info', msg: '+ Server: Apache/2.4.18 (Ubuntu)', osvdb: '' },
                    { type: 'error', msg: '+ WordPress version 4.7.0 identified (insecure, outdated)', osvdb: '' },
                    { type: 'error', msg: '+ OSVDB-3092: /wp-admin/: WordPress admin panel accessible.', osvdb: 'OSVDB-3092' },
                    { type: 'warning', msg: '+ /wp-content/uploads/: Directory indexing enabled.', osvdb: '' },
                    { type: 'warning', msg: '+ /readme.html: WordPress installation readme file accessible.', osvdb: '' },
                    { type: 'warning', msg: '+ /wp-config.php.bak: Backup of WordPress config file found!', osvdb: '' },
                    { type: 'error', msg: '+ XML-RPC interface enabled at /xmlrpc.php (can be used for brute force attacks)', osvdb: '' }
                ],
                summary: '7 item(s) reported on remote host'
            },
            'api-server': {
                name: 'api.company.com',
                ip: '198.51.100.12',
                port: '443',
                server: 'nginx/1.18.0',
                vulnerabilities: [
                    { type: 'info', msg: '+ Server: nginx/1.18.0', osvdb: '' },
                    { type: 'warning', msg: '+ Missing security header: X-Frame-Options', osvdb: '' },
                    { type: 'warning', msg: '+ Missing security header: X-Content-Type-Options', osvdb: '' },
                    { type: 'warning', msg: '+ Missing security header: Strict-Transport-Security (HSTS)', osvdb: '' },
                    { type: 'info', msg: '+ /api/v1/: API endpoint detected', osvdb: '' },
                    { type: 'warning', msg: '+ /api/docs: API documentation exposed publicly', osvdb: '' }
                ],
                summary: '6 item(s) reported on remote host'
            }
        };

        // ==================== AUTOCOMPLETE DATA ====================
        const autocompleteData = {
            commands: ['nikto'],
            options: [
                { value: '-h', desc: 'Target host (required)' },
                { value: '-p', desc: 'Port number(s)' },
                { value: '-ssl', desc: 'Force SSL mode' },
                { value: '-nossl', desc: 'Disable SSL' },
                { value: '-Tuning', desc: 'Scan tuning (0-9, a, b, x)' },
                { value: '-o', desc: 'Output file' },
                { value: '-Format', desc: 'Output format' },
                { value: '-id', desc: 'Authentication (user:pass)' },
                { value: '-useragent', desc: 'Custom User-Agent' },
                { value: '-Pause', desc: 'Pause between requests (seconds)' },
                { value: '-timeout', desc: 'Request timeout (seconds)' },
                { value: '-mutate', desc: 'Mutation techniques' },
                { value: '-Plugins', desc: 'Plugin selection' },
                { value: '-list-plugins', desc: 'List available plugins' },
                { value: '-update', desc: 'Update database' }
            ],
            formats: ['txt', 'html', 'csv', 'xml', 'json'],
            tunings: ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'x', '123', '123b', '23', '1234']
        };

        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', () => {
            loadProgress();
            renderChallenges();
            updateStats();
            setupCommandInput();
        });

        // ==================== TAB SWITCHING ====================
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // ==================== COMMAND INPUT & AUTOCOMPLETE ====================
        function setupCommandInput() {
            const input = document.getElementById('commandInput');
            const suggestions = document.getElementById('autocompleteSuggestions');

            input.addEventListener('input', (e) => {
                handleAutocomplete(e.target.value);
            });

            input.addEventListener('keydown', (e) => {
                const suggestionItems = suggestions.querySelectorAll('.suggestion-item');

                if (e.key === 'Tab') {
                    e.preventDefault();
                    if (suggestionItems.length > 0) {
                        const selectedItem = suggestionItems[selectedSuggestionIndex >= 0 ? selectedSuggestionIndex : 0];
                        if (selectedItem) {
                            applySuggestion(selectedItem.textContent.split('\n')[0].trim());
                        }
                    }
                } else if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    if (suggestionItems.length > 0) {
                        selectedSuggestionIndex = Math.min(selectedSuggestionIndex + 1, suggestionItems.length - 1);
                        updateSuggestionSelection(suggestionItems);
                    }
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    if (suggestionItems.length > 0) {
                        selectedSuggestionIndex = Math.max(selectedSuggestionIndex - 1, 0);
                        updateSuggestionSelection(suggestionItems);
                    }
                } else if (e.key === 'Enter') {
                    e.preventDefault();
                    executeScan();
                } else if (e.key === 'Escape') {
                    suggestions.classList.remove('visible');
                    selectedSuggestionIndex = -1;
                }
            });

            // Close suggestions when clicking outside
            document.addEventListener('click', (e) => {
                if (!input.contains(e.target) && !suggestions.contains(e.target)) {
                    suggestions.classList.remove('visible');
                    selectedSuggestionIndex = -1;
                }
            });
        }

        function handleAutocomplete(value) {
            const suggestions = document.getElementById('autocompleteSuggestions');
            const words = value.trim().split(/\s+/);
            const lastWord = words[words.length - 1] || '';
            const prevWord = words[words.length - 2] || '';

            let matches = [];

            // Suggest commands if at beginning
            if (words.length === 1 && !value.endsWith(' ')) {
                matches = autocompleteData.commands.filter(cmd =>
                    cmd.startsWith(lastWord)
                ).map(cmd => ({ value: cmd, desc: 'Web server scanner' }));
            }
            // Suggest options
            else if (lastWord.startsWith('-') || value.endsWith(' ')) {
                matches = autocompleteData.options.filter(opt =>
                    lastWord === '' || opt.value.startsWith(lastWord)
                );
            }
            // Suggest format values
            else if (prevWord === '-Format') {
                matches = autocompleteData.formats.filter(fmt =>
                    fmt.startsWith(lastWord)
                ).map(fmt => ({ value: fmt, desc: `${fmt.toUpperCase()} output format` }));
            }
            // Suggest tuning values
            else if (prevWord === '-Tuning') {
                matches = autocompleteData.tunings.filter(t =>
                    t.startsWith(lastWord)
                ).map(t => ({ value: t, desc: `Tuning code ${t}` }));
            }

            if (matches.length > 0) {
                displaySuggestions(matches, lastWord);
            } else {
                suggestions.classList.remove('visible');
                selectedSuggestionIndex = -1;
            }
        }

        function displaySuggestions(matches, partial) {
            const suggestions = document.getElementById('autocompleteSuggestions');
            suggestions.innerHTML = '';

            matches.slice(0, 10).forEach((match, index) => {
                const div = document.createElement('div');
                div.className = 'suggestion-item';
                if (index === selectedSuggestionIndex) {
                    div.classList.add('selected');
                }

                const valueSpan = document.createElement('div');
                valueSpan.textContent = match.value;
                div.appendChild(valueSpan);

                if (match.desc) {
                    const descSpan = document.createElement('div');
                    descSpan.className = 'suggestion-desc';
                    descSpan.textContent = match.desc;
                    div.appendChild(descSpan);
                }

                div.addEventListener('click', () => {
                    applySuggestion(match.value);
                });

                suggestions.appendChild(div);
            });

            suggestions.classList.add('visible');
            selectedSuggestionIndex = -1;
        }

        function updateSuggestionSelection(items) {
            items.forEach((item, index) => {
                if (index === selectedSuggestionIndex) {
                    item.classList.add('selected');
                } else {
                    item.classList.remove('selected');
                }
            });
        }

        function applySuggestion(value) {
            const input = document.getElementById('commandInput');
            const words = input.value.trim().split(/\s+/);

            if (input.value.endsWith(' ')) {
                words.push(value);
            } else {
                words[words.length - 1] = value;
            }

            input.value = words.join(' ') + ' ';
            input.focus();

            document.getElementById('autocompleteSuggestions').classList.remove('visible');
            selectedSuggestionIndex = -1;
        }

        // ==================== SCAN EXECUTION ====================
        function executeScan() {
            const command = document.getElementById('commandInput').value.trim();
            const targetSelect = document.getElementById('targetSelect').value;
            const output = document.getElementById('scanOutput');

            if (!command.startsWith('nikto')) {
                output.innerHTML = '<div class="output-line error">Error: Command must start with "nikto"</div>';
                return;
            }

            if (!targetSelect) {
                output.innerHTML = '<div class="output-line error">Error: Please select a target from the dropdown first!</div>';
                return;
            }

            // Simulate scan execution
            scanCount++;
            const target = targets[targetSelect];

            output.innerHTML = '<div class="output-line info">Executing scan...</div>';

            setTimeout(() => {
                const scanOutput = generateScanOutput(target, command);
                output.innerHTML = scanOutput;
                vulnCount += target.vulnerabilities.length;
                updateStats();
                saveProgress();
            }, 1500);
        }

        function generateScanOutput(target, command) {
            let output = '';
            const timestamp = new Date().toLocaleString();

            // Header
            output += `<div class="output-line">- Nikto v2.5.0</div>`;
            output += `<div class="output-line">---------------------------------------------------------------------------</div>`;
            output += `<div class="output-line header">+ Target IP:          ${target.ip}</div>`;
            output += `<div class="output-line header">+ Target Hostname:    ${target.name}</div>`;
            output += `<div class="output-line header">+ Target Port:        ${target.port}</div>`;
            output += `<div class="output-line">+ Start Time:         ${timestamp}</div>`;
            output += `<div class="output-line">---------------------------------------------------------------------------</div>`;
            output += `<div class="output-line header">+ Server: ${target.server}</div>`;
            output += `<div class="output-line">---------------------------------------------------------------------------</div>`;

            // Vulnerabilities
            target.vulnerabilities.forEach(vuln => {
                const severity = vuln.type === 'error' ? 'high' : vuln.type === 'warning' ? 'medium' : 'low';
                const cssClass = vuln.type === 'error' ? 'error' : vuln.type === 'warning' ? 'warning' : 'info';

                output += `<div class="vuln-finding ${severity}">`;
                output += `<div class="output-line ${cssClass}">${vuln.msg}</div>`;
                output += `</div>`;
            });

            // Footer
            output += `<div class="output-line">---------------------------------------------------------------------------</div>`;
            output += `<div class="output-line info">+ ${target.summary}</div>`;
            output += `<div class="output-line">+ End Time:           ${new Date().toLocaleString()}</div>`;
            output += `<div class="output-line">---------------------------------------------------------------------------</div>`;
            output += `<div class="output-line success">+ Scan complete.</div>`;

            return output;
        }

        function loadQuickScan(targetKey) {
            const target = targets[targetKey];
            const input = document.getElementById('commandInput');
            input.value = `nikto -h http://${target.name} -Tuning 123`;
            setTimeout(() => executeScan(), 100);
        }

        // ==================== CHALLENGES ====================
        function renderChallenges() {
            const container = document.getElementById('challengesList');
            container.innerHTML = '';

            challenges.forEach(challenge => {
                const isCompleted = completedChallenges.has(challenge.id);

                const card = document.createElement('div');
                card.className = `challenge-card ${isCompleted ? 'completed' : ''}`;
                card.id = `challenge-${challenge.id}`;

                card.innerHTML = `
                    <div class="challenge-header">
                        <div class="challenge-title">${isCompleted ? ' ' : ''}${challenge.title}</div>
                        <div class="challenge-points">${challenge.points} pts</div>
                    </div>
                    <div class="challenge-description">${challenge.description}</div>
                    <div class="challenge-hint">${challenge.hint}</div>
                    <div class="challenge-input-area">
                        <input
                            type="${challenge.inputType}"
                            class="challenge-input"
                            id="input-${challenge.id}"
                            placeholder="Enter your answer..."
                            ${isCompleted ? 'disabled' : ''}
                        >
                        <button
                            class="challenge-submit"
                            onclick="checkAnswer(${challenge.id})"
                            ${isCompleted ? 'disabled' : ''}
                        >
                            ${isCompleted ? 'Completed' : 'Submit'}
                        </button>
                    </div>
                    <div class="challenge-feedback" id="feedback-${challenge.id}"></div>
                `;

                container.appendChild(card);

                // Add enter key support
                if (!isCompleted) {
                    document.getElementById(`input-${challenge.id}`).addEventListener('keypress', (e) => {
                        if (e.key === 'Enter') {
                            checkAnswer(challenge.id);
                        }
                    });
                }
            });
        }

        function checkAnswer(challengeId) {
            const challenge = challenges.find(c => c.id === challengeId);
            const input = document.getElementById(`input-${challengeId}`);
            const feedback = document.getElementById(`feedback-${challengeId}`);

            let userAnswer = input.value.trim();
            let correctAnswer = challenge.answer;

            if (!challenge.caseSensitive) {
                userAnswer = userAnswer.toLowerCase();
                correctAnswer = correctAnswer.toLowerCase();
            }

            if (userAnswer === correctAnswer) {
                completedChallenges.add(challengeId);
                totalPoints += challenge.points;

                feedback.className = 'challenge-feedback correct';
                feedback.textContent = `Correct! +${challenge.points} points`;

                input.disabled = true;
                document.querySelector(`#challenge-${challengeId} .challenge-submit`).disabled = true;
                document.querySelector(`#challenge-${challengeId} .challenge-submit`).textContent = 'Completed';
                document.getElementById(`challenge-${challengeId}`).classList.add('completed');
                document.querySelector(`#challenge-${challengeId} .challenge-title`).textContent = ' ' + challenge.title;

                updateStats();
                saveProgress();
            } else {
                feedback.className = 'challenge-feedback incorrect';
                feedback.textContent = 'Incorrect. Try again!';

                setTimeout(() => {
                    feedback.style.display = 'none';
                }, 3000);
            }
        }

        // ==================== PROGRESS MANAGEMENT ====================
        function saveProgress() {
            const progress = {
                completedChallenges: Array.from(completedChallenges),
                totalPoints: totalPoints,
                scanCount: scanCount,
                vulnCount: vulnCount,
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('nikto-training-progress', JSON.stringify(progress));
        }

        function loadProgress() {
            const saved = localStorage.getItem('nikto-training-progress');
            if (saved) {
                try {
                    const progress = JSON.parse(saved);
                    completedChallenges = new Set(progress.completedChallenges || []);
                    totalPoints = progress.totalPoints || 0;
                    scanCount = progress.scanCount || 0;
                    vulnCount = progress.vulnCount || 0;
                } catch (e) {
                    console.error('Failed to load progress:', e);
                }
            }
        }

        function exportProgress() {
            const progress = {
                completedChallenges: Array.from(completedChallenges),
                totalPoints: totalPoints,
                scanCount: scanCount,
                vulnCount: vulnCount,
                timestamp: new Date().toISOString(),
                version: '1.0'
            };

            const blob = new Blob([JSON.stringify(progress, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `nikto-training-progress-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function importProgress(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const progress = JSON.parse(e.target.result);
                    completedChallenges = new Set(progress.completedChallenges || []);
                    totalPoints = progress.totalPoints || 0;
                    scanCount = progress.scanCount || 0;
                    vulnCount = progress.vulnCount || 0;

                    saveProgress();
                    updateStats();
                    renderChallenges();

                    alert('Progress imported successfully!');
                } catch (err) {
                    alert('Failed to import progress. Invalid file format.');
                }
            };
            reader.readAsText(file);
        }

        function resetProgress() {
            if (confirm('Are you sure you want to reset all progress? This cannot be undone!')) {
                completedChallenges.clear();
                totalPoints = 0;
                scanCount = 0;
                vulnCount = 0;

                localStorage.removeItem('nikto-training-progress');
                updateStats();
                renderChallenges();

                alert('Progress reset successfully!');
            }
        }

        // ==================== STATISTICS ====================
        function updateStats() {
            const completed = completedChallenges.size;
            const total = challenges.length;

            // Update all stat displays
            document.getElementById('completedCount').textContent = completed;
            document.getElementById('totalPointsDisplay').textContent = totalPoints;
            document.getElementById('statsCompleted').textContent = completed;
            document.getElementById('statsPoints').textContent = totalPoints;
            document.getElementById('statsScans').textContent = scanCount;
            document.getElementById('statsVulns').textContent = vulnCount;
            document.getElementById('sidebarProgress').textContent = `${completed}/${total}`;
            document.getElementById('sidebarPoints').textContent = `${totalPoints}/225`;
        }

        // ==================== THEME MANAGEMENT ====================
        function setTheme(theme) {
            document.querySelectorAll('.theme-option').forEach(opt => {
                opt.classList.remove('active');
            });

            event.target.classList.add('active');

            if (theme === 'dark') {
                document.body.classList.add('dark-mode');
                localStorage.setItem('nikto-training-theme', 'dark');
            } else {
                document.body.classList.remove('dark-mode');
                localStorage.setItem('nikto-training-theme', 'default');
            }
        }

        // Load saved theme
        const savedTheme = localStorage.getItem('nikto-training-theme');
        if (savedTheme === 'dark') {
            document.body.classList.add('dark-mode');
            document.querySelectorAll('.theme-option').forEach(opt => {
                opt.classList.remove('active');
                if (opt.dataset.theme === 'dark') {
                    opt.classList.add('active');
                }
            });
        }
    </script>
<script src="../../../components/FluxCapacitor.js"></script>
</body>
</html>