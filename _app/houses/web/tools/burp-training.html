<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Burp Suite Training Lab - Web House | Hexworth Prime</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a1628 0%, #0f2847 100%);
            min-height: 100vh;
            padding: 20px;
            color: #e0e0e0;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(10, 22, 40, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            border: 2px solid rgba(6, 182, 212, 0.3);
        }

        .header {
            background: linear-gradient(135deg, #0369a1 0%, #06b6d4 100%);
            padding: 30px;
            text-align: center;
            border-bottom: 3px solid #06b6d4;
        }

        .header h1 {
            color: #ffffff;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            color: #e0f2fe;
            font-size: 1.1em;
        }

        .back-link {
            display: inline-block;
            margin-top: 15px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .back-link:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 0;
            min-height: calc(100vh - 200px);
        }

        .workspace {
            display: flex;
            flex-direction: column;
            border-right: 2px solid rgba(6, 182, 212, 0.3);
        }

        .tab-container {
            display: flex;
            background: rgba(10, 22, 40, 0.9);
            border-bottom: 2px solid rgba(6, 182, 212, 0.3);
            padding: 10px 20px 0;
            gap: 5px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 20px;
            background: rgba(3, 105, 161, 0.3);
            color: #06b6d4;
            border: none;
            cursor: pointer;
            border-radius: 10px 10px 0 0;
            transition: all 0.3s ease;
            font-size: 0.95em;
            font-weight: 500;
            border: 2px solid transparent;
            border-bottom: none;
        }

        .tab:hover {
            background: rgba(6, 182, 212, 0.3);
            color: #e0e0e0;
        }

        .tab.active {
            background: rgba(3, 105, 161, 0.6);
            color: #ffffff;
            border-color: #06b6d4;
        }

        .tab-content {
            display: none;
            flex: 1;
            overflow: hidden;
            flex-direction: column;
        }

        .tab-content.active {
            display: flex;
        }

        /* Learn Tab Styles */
        .learn-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .learn-section {
            margin-bottom: 30px;
        }

        .learn-section h2 {
            color: #06b6d4;
            font-size: 1.8em;
            margin-bottom: 15px;
            border-bottom: 2px solid #0369a1;
            padding-bottom: 10px;
        }

        .learn-section h3 {
            color: #38bdf8;
            font-size: 1.3em;
            margin: 20px 0 10px;
        }

        .learn-section p {
            line-height: 1.8;
            margin-bottom: 15px;
            color: #d0d0d0;
        }

        .learn-section ul, .learn-section ol {
            margin-left: 25px;
            margin-bottom: 15px;
        }

        .learn-section li {
            line-height: 1.8;
            margin-bottom: 8px;
            color: #d0d0d0;
        }

        .info-box {
            background: rgba(6, 182, 212, 0.15);
            border-left: 4px solid #06b6d4;
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        .info-box.warning {
            background: rgba(251, 146, 60, 0.15);
            border-left-color: #fb923c;
        }

        .info-box.success {
            background: rgba(34, 197, 94, 0.15);
            border-left-color: #22c55e;
        }

        .info-box.danger {
            background: rgba(239, 68, 68, 0.15);
            border-left-color: #ef4444;
        }

        .info-box strong {
            color: #06b6d4;
            display: block;
            margin-bottom: 5px;
        }

        .info-box.warning strong {
            color: #fb923c;
        }

        .info-box.success strong {
            color: #22c55e;
        }

        .info-box.danger strong {
            color: #ef4444;
        }

        code {
            background: rgba(3, 105, 161, 0.3);
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #06b6d4;
        }

        .code-block {
            background: rgba(0, 0, 0, 0.6);
            padding: 15px 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
            border: 1px solid rgba(6, 182, 212, 0.3);
            font-size: 0.9em;
        }

        .code-block .method {
            color: #22c55e;
            font-weight: 600;
        }

        .code-block .url {
            color: #06b6d4;
        }

        .code-block .header-name {
            color: #fbbf24;
        }

        .code-block .header-value {
            color: #a78bfa;
        }

        .code-block .param {
            color: #f472b6;
        }

        /* Proxy Lab Styles */
        .proxy-lab {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .toolbar {
            background: rgba(0, 0, 0, 0.4);
            padding: 15px 20px;
            border-bottom: 2px solid rgba(6, 182, 212, 0.2);
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .toolbar label {
            color: #06b6d4;
            font-weight: 600;
        }

        .toolbar select {
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid rgba(6, 182, 212, 0.3);
            color: #e0e0e0;
            padding: 8px 15px;
            border-radius: 6px;
            font-size: 0.95em;
        }

        .toolbar select:focus {
            outline: none;
            border-color: #06b6d4;
        }

        .intercept-toggle {
            padding: 10px 20px;
            border: 2px solid #06b6d4;
            border-radius: 6px;
            background: rgba(6, 182, 212, 0.2);
            color: #06b6d4;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .intercept-toggle.on {
            background: rgba(34, 197, 94, 0.3);
            border-color: #22c55e;
            color: #22c55e;
        }

        .action-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .forward-btn {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            color: white;
        }

        .forward-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(34, 197, 94, 0.4);
        }

        .forward-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .drop-btn {
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid #ef4444;
            color: #ef4444;
        }

        .drop-btn:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        .drop-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .modify-btn {
            background: rgba(6, 182, 212, 0.2);
            border: 2px solid #06b6d4;
            color: #06b6d4;
        }

        .modify-btn:hover {
            background: rgba(6, 182, 212, 0.3);
        }

        .proxy-display {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .request-editor {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: rgba(0, 0, 0, 0.4);
            border-bottom: 2px solid rgba(6, 182, 212, 0.2);
        }

        .editor-header {
            background: rgba(3, 105, 161, 0.3);
            padding: 10px 20px;
            color: #06b6d4;
            font-weight: 600;
            border-bottom: 1px solid rgba(6, 182, 212, 0.2);
        }

        .request-textarea {
            flex: 1;
            background: rgba(0, 0, 0, 0.6);
            color: #e0e0e0;
            border: none;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            resize: none;
            line-height: 1.6;
        }

        .request-textarea:focus {
            outline: none;
        }

        .response-viewer {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: rgba(0, 0, 0, 0.3);
        }

        .history-panel {
            background: rgba(0, 0, 0, 0.5);
            max-height: 200px;
            overflow-y: auto;
            border-bottom: 2px solid rgba(6, 182, 212, 0.2);
        }

        .history-item {
            padding: 10px 15px;
            border-bottom: 1px solid rgba(6, 182, 212, 0.1);
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .history-item:hover {
            background: rgba(6, 182, 212, 0.1);
        }

        .history-item.selected {
            background: rgba(6, 182, 212, 0.2);
            border-left: 4px solid #06b6d4;
        }

        .history-method {
            font-weight: 600;
            color: #22c55e;
            font-family: 'Courier New', monospace;
        }

        .history-url {
            color: #06b6d4;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            flex: 1;
            margin: 0 10px;
        }

        .history-status {
            font-size: 0.85em;
            padding: 3px 8px;
            border-radius: 4px;
        }

        .status-forwarded {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
        }

        .status-dropped {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        .status-modified {
            background: rgba(6, 182, 212, 0.2);
            color: #06b6d4;
        }

        /* Challenges Tab */
        .challenges-container {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .challenge-card {
            background: rgba(3, 105, 161, 0.15);
            border: 2px solid rgba(6, 182, 212, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .challenge-card:hover {
            border-color: #06b6d4;
            transform: translateX(5px);
        }

        .challenge-card.completed {
            border-color: #22c55e;
            background: rgba(34, 197, 94, 0.1);
        }

        .challenge-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
        }

        .challenge-title {
            color: #06b6d4;
            font-size: 1.1em;
            font-weight: 600;
        }

        .challenge-card.completed .challenge-title {
            color: #22c55e;
        }

        .challenge-points {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .challenge-desc {
            color: #b0b0b0;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .challenge-input {
            width: 100%;
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid rgba(6, 182, 212, 0.3);
            color: #e0e0e0;
            padding: 10px 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            margin-bottom: 10px;
        }

        .challenge-input:focus {
            outline: none;
            border-color: #06b6d4;
        }

        .challenge-status {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-badge {
            padding: 5px 15px;
            border-radius: 5px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .status-pending {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
            border: 1px solid #fbbf24;
        }

        .status-complete {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
            border: 1px solid #22c55e;
        }

        .hint-btn {
            background: rgba(3, 105, 161, 0.3);
            border: none;
            color: #06b6d4;
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.3s ease;
        }

        .hint-btn:hover {
            background: rgba(3, 105, 161, 0.5);
        }

        .hint-text {
            display: none;
            margin-top: 10px;
            padding: 10px 15px;
            background: rgba(6, 182, 212, 0.1);
            border-left: 3px solid #06b6d4;
            color: #a0a0a0;
            font-size: 0.9em;
        }

        .hint-text.show {
            display: block;
        }

        .submit-btn {
            background: linear-gradient(135deg, #06b6d4 0%, #0369a1 100%);
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(6, 182, 212, 0.4);
        }

        /* Reference Tab */
        .reference-container {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .ref-category {
            margin-bottom: 25px;
        }

        .ref-category h3 {
            color: #06b6d4;
            font-size: 1.2em;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid rgba(6, 182, 212, 0.3);
        }

        .ref-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 10px;
        }

        .ref-item {
            background: rgba(3, 105, 161, 0.1);
            border: 1px solid rgba(6, 182, 212, 0.2);
            border-radius: 8px;
            padding: 12px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .ref-item:hover {
            border-color: #06b6d4;
            background: rgba(3, 105, 161, 0.2);
            transform: translateY(-2px);
        }

        .ref-item-title {
            color: #06b6d4;
            font-weight: 600;
            margin-bottom: 5px;
            font-family: 'Courier New', monospace;
        }

        .ref-item-desc {
            color: #888;
            font-size: 0.85em;
            line-height: 1.4;
        }

        .ref-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .ref-table th {
            background: rgba(3, 105, 161, 0.3);
            color: #06b6d4;
            padding: 10px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid rgba(6, 182, 212, 0.3);
        }

        .ref-table td {
            padding: 10px;
            border-bottom: 1px solid rgba(6, 182, 212, 0.1);
            color: #d0d0d0;
        }

        .ref-table td:first-child {
            color: #06b6d4;
            font-family: 'Courier New', monospace;
            font-weight: 600;
        }

        /* Settings Tab */
        .settings-panel {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .settings-section {
            background: rgba(3, 105, 161, 0.1);
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .settings-section h3 {
            color: #06b6d4;
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .settings-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(6, 182, 212, 0.1);
        }

        .settings-row:last-child {
            border-bottom: none;
        }

        .settings-row label {
            color: #d0d0d0;
            font-weight: 500;
        }

        .settings-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #06b6d4 0%, #0369a1 100%);
            color: white;
        }

        .settings-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(6, 182, 212, 0.4);
        }

        .settings-btn.secondary {
            background: rgba(3, 105, 161, 0.3);
            color: #06b6d4;
            border: 2px solid #06b6d4;
        }

        .settings-btn.secondary:hover {
            background: rgba(3, 105, 161, 0.5);
        }

        /* Sidebar */
        .sidebar {
            background: rgba(0, 0, 0, 0.4);
            padding: 20px;
            overflow-y: auto;
            border-left: 2px solid rgba(6, 182, 212, 0.3);
        }

        .sidebar h3 {
            color: #06b6d4;
            font-size: 1.3em;
            margin-bottom: 15px;
            text-align: center;
        }

        .sidebar h4 {
            color: #38bdf8;
            font-size: 1em;
            margin: 15px 0 10px;
        }

        .sidebar p {
            color: #b0b0b0;
            line-height: 1.6;
            margin-bottom: 10px;
            font-size: 0.9em;
        }

        .tip-box {
            background: rgba(6, 182, 212, 0.1);
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-radius: 8px;
            padding: 12px;
            margin: 15px 0;
        }

        .tip-box strong {
            color: #06b6d4;
            display: block;
            margin-bottom: 5px;
        }

        .quick-filters {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin: 10px 0;
        }

        .quick-filter-btn {
            background: rgba(3, 105, 161, 0.3);
            border: 1px solid rgba(6, 182, 212, 0.3);
            color: #06b6d4;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.3s ease;
            font-family: 'Courier New', monospace;
        }

        .quick-filter-btn:hover {
            background: rgba(3, 105, 161, 0.5);
            border-color: #06b6d4;
        }

        .progress-summary {
            background: linear-gradient(135deg, rgba(3, 105, 161, 0.2), rgba(6, 182, 212, 0.1));
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .progress-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            color: #d0d0d0;
        }

        .progress-value {
            font-weight: 600;
            color: #06b6d4;
        }

        /* Scrollbar Styles */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(6, 182, 212, 0.5);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(6, 182, 212, 0.7);
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .sidebar {
                border-left: none;
                border-top: 2px solid rgba(6, 182, 212, 0.3);
                max-height: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Burp Suite Training Lab</h1>
            <p>Master Web Application Security Testing</p>
            <a href="../index.html" class="back-link">← Back to Web House</a>
        </div>

        <div class="main-content">
            <div class="workspace">
                <div class="tab-container">
                    <button class="tab active" onclick="switchTab('learn')">Learn</button>
                    <button class="tab" onclick="switchTab('proxy-lab')">Proxy Lab</button>
                    <button class="tab" onclick="switchTab('challenges')">Challenges</button>
                    <button class="tab" onclick="switchTab('reference')">Reference</button>
                    <button class="tab" onclick="switchTab('settings')">Settings</button>
                </div>

                <!-- LEARN TAB -->
                <div id="learn" class="tab-content active">
                    <div class="learn-content">
                        <div class="learn-section">
                            <h2>What is Burp Suite?</h2>
                            <p>Burp Suite is the industry-standard toolkit for web application security testing. Created by PortSwigger, it's an integrated platform that allows security professionals to perform comprehensive security assessments of web applications.</p>

                            <p>Burp Suite acts as an intercepting proxy, sitting between your browser and the web application. This allows you to:</p>
                            <ul>
                                <li>Intercept and modify HTTP/HTTPS requests and responses in real-time</li>
                                <li>Analyze application behavior and identify vulnerabilities</li>
                                <li>Test for common web vulnerabilities like SQL injection, XSS, CSRF, and more</li>
                                <li>Map application structure and enumerate hidden functionality</li>
                                <li>Automate custom attacks with powerful tools like Intruder and Repeater</li>
                            </ul>

                            <div class="info-box">
                                <strong>Why Web Application Security Matters</strong>
                                <p>Web applications are the primary attack vector for modern cyber threats. Over 90% of applications have vulnerabilities, and web application attacks account for the majority of data breaches. Understanding how to test and secure web applications is essential for any security professional.</p>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Burp Suite Editions</h2>

                            <h3>Burp Suite Community Edition (Free)</h3>
                            <ul>
                                <li>Manual testing tools: Proxy, Repeater, Decoder, Comparer, Sequencer</li>
                                <li>Limited Intruder functionality (throttled speed)</li>
                                <li>No automated scanning</li>
                                <li>Perfect for learning and manual testing</li>
                            </ul>

                            <h3>Burp Suite Professional ($399/year)</h3>
                            <ul>
                                <li>All Community features plus automated vulnerability scanning</li>
                                <li>Full-speed Intruder for automated attacks</li>
                                <li>Advanced manual tools and extensions API</li>
                                <li>Continuous scanning and issue tracking</li>
                                <li>Essential for professional penetration testers</li>
                            </ul>

                            <div class="info-box success">
                                <strong>Getting Started</strong>
                                <p>Download Burp Suite Community Edition from <code>portswigger.net/burp/communitydownload</code> to practice along with this training lab!</p>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Core Tools Overview</h2>

                            <h3>1. Proxy</h3>
                            <p>The heart of Burp Suite. The Proxy intercepts all traffic between your browser and target applications, allowing you to view and modify requests before they're sent.</p>
                            <ul>
                                <li><strong>Intercept:</strong> Pause, inspect, and modify requests/responses in real-time</li>
                                <li><strong>HTTP History:</strong> View all captured traffic</li>
                                <li><strong>WebSockets History:</strong> Capture WebSocket messages</li>
                                <li><strong>Options:</strong> Configure proxy behavior, match/replace rules, and more</li>
                            </ul>

                            <h3>2. Repeater</h3>
                            <p>Manually modify and resend individual HTTP requests to test how the application responds to different inputs. Essential for testing vulnerabilities.</p>
                            <ul>
                                <li>Edit requests and see responses immediately</li>
                                <li>Great for testing SQL injection, XSS, authentication bypasses</li>
                                <li>Compare multiple responses side-by-side</li>
                            </ul>

                            <h3>3. Intruder</h3>
                            <p>Automate customized attacks by sending many variations of a request with different payloads. Perfect for fuzzing, brute-forcing, and parameter manipulation.</p>
                            <ul>
                                <li>Sniper, Battering Ram, Pitchfork, and Cluster Bomb attack types</li>
                                <li>Built-in payload lists and generators</li>
                                <li>Extract and analyze patterns in responses</li>
                                <li><em>Note: Throttled in Community Edition</em></li>
                            </ul>

                            <h3>4. Decoder</h3>
                            <p>Encode and decode data using common schemes like Base64, URL encoding, HTML entities, and more. Essential for analyzing encoded payloads.</p>
                            <ul>
                                <li>Smart decode automatically detects encoding</li>
                                <li>Hash generation (MD5, SHA-1, SHA-256, etc.)</li>
                                <li>Hex editor for binary data</li>
                            </ul>

                            <h3>5. Comparer</h3>
                            <p>Compare two pieces of data (requests, responses, or any text) to identify differences. Useful for finding subtle changes in application behavior.</p>
                            <ul>
                                <li>Word-level and byte-level comparison</li>
                                <li>Highlight differences visually</li>
                                <li>Compare responses to detect anomalies</li>
                            </ul>
                        </div>

                        <div class="learn-section">
                            <h2>Setting Up Browser Proxy</h2>
                            <p>To use Burp Suite, you need to configure your browser to route traffic through Burp's proxy.</p>

                            <h3>Default Proxy Settings</h3>
                            <div class="code-block">
Proxy Address: <span class="url">127.0.0.1</span> (localhost)
Port: <span class="param">8080</span>
                            </div>

                            <h3>Browser Configuration Steps</h3>
                            <ol>
                                <li><strong>Firefox (Recommended):</strong>
                                    <ul>
                                        <li>Preferences → Network Settings → Manual proxy configuration</li>
                                        <li>HTTP Proxy: 127.0.0.1, Port: 8080</li>
                                        <li>Check "Also use this proxy for HTTPS"</li>
                                    </ul>
                                </li>
                                <li><strong>Chrome/Edge:</strong>
                                    <ul>
                                        <li>Use FoxyProxy extension for easy switching</li>
                                        <li>Or system proxy settings (applies to all apps)</li>
                                    </ul>
                                </li>
                                <li><strong>Install Burp CA Certificate:</strong>
                                    <ul>
                                        <li>With proxy configured, visit <code>http://burp</code></li>
                                        <li>Download "CA Certificate"</li>
                                        <li>Import in browser settings to avoid SSL warnings</li>
                                    </ul>
                                </li>
                            </ol>

                            <div class="info-box warning">
                                <strong>HTTPS Decryption</strong>
                                <p>Burp's CA certificate allows it to decrypt HTTPS traffic. This is necessary for testing but means Burp can see all your encrypted traffic. Only use Burp on test systems, and disable the proxy when not testing!</p>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Intercepting and Modifying Requests</h2>

                            <h3>Basic Workflow</h3>
                            <ol>
                                <li><strong>Enable Intercept:</strong> Click "Intercept is on" in Proxy tab</li>
                                <li><strong>Browse Target Site:</strong> Navigate normally in your configured browser</li>
                                <li><strong>Request Appears:</strong> Burp pauses the request for your inspection</li>
                                <li><strong>Analyze/Modify:</strong> Edit any part of the request (headers, parameters, body)</li>
                                <li><strong>Forward or Drop:</strong> Send the modified request or discard it</li>
                                <li><strong>View Response:</strong> See how the application responds to your changes</li>
                            </ol>

                            <h3>Common Modifications</h3>
                            <ul>
                                <li><strong>Parameter Tampering:</strong> Change values like user IDs, prices, roles</li>
                                <li><strong>Adding Headers:</strong> Inject custom headers to test authentication</li>
                                <li><strong>Method Changes:</strong> Switch GET to POST or vice versa</li>
                                <li><strong>Removing Restrictions:</strong> Delete client-side validation parameters</li>
                                <li><strong>Injecting Payloads:</strong> Test for SQL injection, XSS, command injection</li>
                            </ul>

                            <div class="info-box">
                                <strong>Pro Tip: Send to Repeater</strong>
                                <p>Right-click any request in Proxy → "Send to Repeater" for easier testing. Repeater lets you modify and resend requests multiple times without browsing through the site again.</p>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>HTTP Request/Response Structure</h2>

                            <h3>HTTP Request Format</h3>
                            <div class="code-block">
<span class="method">POST</span> <span class="url">/api/login</span> HTTP/1.1
<span class="header-name">Host:</span> <span class="header-value">vulnerable-app.com</span>
<span class="header-name">Content-Type:</span> <span class="header-value">application/x-www-form-urlencoded</span>
<span class="header-name">Content-Length:</span> <span class="header-value">35</span>
<span class="header-name">Cookie:</span> <span class="header-value">sessionid=abc123xyz</span>

<span class="param">username=admin&password=test123</span>
                            </div>

                            <p><strong>Request Components:</strong></p>
                            <ul>
                                <li><strong>Request Line:</strong> Method (GET/POST/PUT/DELETE), Path, HTTP Version</li>
                                <li><strong>Headers:</strong> Metadata about the request (Host, User-Agent, Content-Type, Cookies, etc.)</li>
                                <li><strong>Body:</strong> Data sent with POST/PUT requests (form data, JSON, XML, etc.)</li>
                            </ul>

                            <h3>HTTP Response Format</h3>
                            <div class="code-block">
HTTP/1.1 <span class="param">200</span> <span class="method">OK</span>
<span class="header-name">Content-Type:</span> <span class="header-value">application/json</span>
<span class="header-name">Set-Cookie:</span> <span class="header-value">token=xyz789abc; HttpOnly; Secure</span>
<span class="header-name">Content-Length:</span> <span class="header-value">54</span>

<span class="url">{"status":"success","user":"admin","role":"user"}</span>
                            </div>

                            <p><strong>Response Components:</strong></p>
                            <ul>
                                <li><strong>Status Line:</strong> HTTP version, status code (200, 404, 500, etc.), status text</li>
                                <li><strong>Headers:</strong> Response metadata (Content-Type, Set-Cookie, Cache-Control, etc.)</li>
                                <li><strong>Body:</strong> The actual content (HTML, JSON, images, etc.)</li>
                            </ul>
                        </div>

                        <div class="learn-section">
                            <h2>Common Web Vulnerabilities to Test For</h2>

                            <h3>1. SQL Injection</h3>
                            <p>Injecting malicious SQL code into input fields to manipulate database queries.</p>
                            <div class="code-block">
<span class="comment"># Test payload in username field:</span>
admin' OR '1'='1' --
                            </div>

                            <h3>2. Cross-Site Scripting (XSS)</h3>
                            <p>Injecting malicious JavaScript that executes in other users' browsers.</p>
                            <div class="code-block">
<span class="comment"># Test payload in search field:</span>
&lt;script&gt;alert('XSS')&lt;/script&gt;
                            </div>

                            <h3>3. Authentication Bypass</h3>
                            <p>Manipulating parameters or cookies to access unauthorized accounts or elevated privileges.</p>
                            <div class="code-block">
<span class="comment"># Example: Changing user ID in request</span>
<span class="param">user_id=123</span>  →  <span class="param">user_id=1</span> (admin)
                            </div>

                            <h3>4. Insecure Direct Object References (IDOR)</h3>
                            <p>Accessing resources by manipulating predictable identifiers.</p>
                            <div class="code-block">
GET /api/document/<span class="param">456</span>  →  Try <span class="param">457, 458, 1, 2, 999</span>
                            </div>

                            <h3>5. Command Injection</h3>
                            <p>Injecting OS commands into application inputs that execute system commands.</p>
                            <div class="code-block">
<span class="comment"># Test payload in filename parameter:</span>
file.txt; ls -la
                            </div>

                            <h3>6. XML External Entity (XXE)</h3>
                            <p>Exploiting XML parsers to read files or perform SSRF attacks.</p>
                            <div class="code-block">
&lt;!DOCTYPE foo [&lt;!ENTITY xxe SYSTEM "file:///etc/passwd"&gt; ]&gt;
                            </div>

                            <div class="info-box warning">
                                <strong>Testing Methodology</strong>
                                <p>For each vulnerability type, use Burp to: 1) Identify input points, 2) Craft test payloads, 3) Send via Repeater, 4) Analyze responses for anomalies, 5) Confirm the vulnerability, 6) Assess impact.</p>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Legal and Ethical Considerations</h2>

                            <div class="info-box danger">
                                <strong>CRITICAL: AUTHORIZED TESTING ONLY</strong>
                                <p>Using Burp Suite or any security testing tool against systems you don't own or have explicit written permission to test is <strong>ILLEGAL</strong> and can result in criminal prosecution under laws like the Computer Fraud and Abuse Act (CFAA) in the US and similar laws worldwide.</p>
                            </div>

                            <h3>Legal Testing Scenarios</h3>
                            <ul>
                                <li><strong>Your Own Applications:</strong> Testing apps you developed or own</li>
                                <li><strong>Authorized Penetration Tests:</strong> With signed contracts and scope agreements</li>
                                <li><strong>Bug Bounty Programs:</strong> Following the program's rules and scope</li>
                                <li><strong>Authorized CTF/Lab Environments:</strong> HackTheBox, TryHackMe, DVWA, WebGoat, etc.</li>
                                <li><strong>Educational Labs:</strong> Like this training environment</li>
                            </ul>

                            <h3>Best Practices</h3>
                            <ul>
                                <li><strong>Get Written Permission:</strong> Always obtain signed authorization before testing</li>
                                <li><strong>Define Scope:</strong> Know exactly what systems, IP ranges, and attack types are allowed</li>
                                <li><strong>Respect Boundaries:</strong> Stay within the defined scope - don't test adjacent systems</li>
                                <li><strong>Avoid Damage:</strong> Don't perform denial-of-service attacks or destructive actions</li>
                                <li><strong>Report Responsibly:</strong> Disclose findings to the system owner privately and professionally</li>
                                <li><strong>Keep Evidence:</strong> Document your authorization in case of misunderstandings</li>
                            </ul>

                            <h3>Recommended Practice Environments</h3>
                            <ul>
                                <li><strong>DVWA:</strong> Damn Vulnerable Web Application (intentionally vulnerable app)</li>
                                <li><strong>WebGoat:</strong> OWASP's deliberately insecure application</li>
                                <li><strong>Juice Shop:</strong> Modern vulnerable web application</li>
                                <li><strong>PortSwigger Academy:</strong> Free labs from Burp Suite creators</li>
                                <li><strong>HackTheBox:</strong> Realistic vulnerable machines (paid/free)</li>
                                <li><strong>TryHackMe:</strong> Guided learning paths with vulnerable labs</li>
                            </ul>

                            <div class="info-box success">
                                <strong>Professional Ethics</strong>
                                <p>As security professionals, we have a responsibility to improve security, not exploit it for personal gain or malicious purposes. Always act ethically, respect privacy, and use your skills to make systems more secure.</p>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Next Steps</h2>
                            <p>Now that you understand the basics, it's time to get hands-on!</p>
                            <ol>
                                <li><strong>Explore the Proxy Lab:</strong> Practice intercepting and modifying simulated HTTP requests</li>
                                <li><strong>Complete the Challenges:</strong> Test your knowledge with 10 auto-graded exercises</li>
                                <li><strong>Reference Tab:</strong> Quick reference for HTTP methods, headers, and status codes</li>
                                <li><strong>Download Burp Suite:</strong> Install the Community Edition and practice on legal targets</li>
                                <li><strong>PortSwigger Academy:</strong> Free advanced training at portswigger.net/web-security</li>
                            </ol>

                            <div class="info-box success">
                                <strong>You're Ready!</strong>
                                <p>Head to the <strong>Proxy Lab</strong> tab to start intercepting requests, or jump straight to <strong>Challenges</strong> to test your skills!</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PROXY LAB TAB -->
                <div id="proxy-lab" class="tab-content">
                    <div class="proxy-lab">
                        <div class="toolbar">
                            <label>Intercept:</label>
                            <button class="intercept-toggle" id="interceptToggle" onclick="toggleIntercept()">
                                Intercept is off
                            </button>

                            <label style="margin-left: 20px;">Scenario:</label>
                            <select id="scenarioSelect" onchange="loadScenario()">
                                <option value="login">Login Request</option>
                                <option value="api">API Request</option>
                                <option value="sqli">SQL Injection Target</option>
                                <option value="xss">XSS Target</option>
                                <option value="idor">IDOR Vulnerability</option>
                            </select>

                            <div style="flex: 1;"></div>

                            <button class="action-btn forward-btn" id="forwardBtn" onclick="forwardRequest()" disabled>
                                Forward
                            </button>
                            <button class="action-btn drop-btn" id="dropBtn" onclick="dropRequest()" disabled>
                                Drop
                            </button>
                            <button class="action-btn modify-btn" onclick="sendToRepeater()">
                                Send to Repeater
                            </button>
                        </div>

                        <div class="proxy-display">
                            <div class="request-editor">
                                <div class="editor-header">
                                    Intercepted Request
                                </div>
                                <textarea class="request-textarea" id="requestEditor" placeholder="Enable intercept and select a scenario to see requests..."></textarea>
                            </div>

                            <div class="response-viewer">
                                <div class="editor-header">
                                    Response
                                </div>
                                <textarea class="request-textarea" id="responseViewer" readonly placeholder="Response will appear here after forwarding..."></textarea>
                            </div>
                        </div>

                        <div class="history-panel">
                            <div class="editor-header">
                                HTTP History
                            </div>
                            <div id="historyList"></div>
                        </div>
                    </div>
                </div>

                <!-- CHALLENGES TAB -->
                <div id="challenges" class="tab-content">
                    <div class="challenges-container" id="challengesList">
                        <!-- Challenges will be rendered here by JavaScript -->
                    </div>
                </div>

                <!-- REFERENCE TAB -->
                <div id="reference" class="tab-content">
                    <div class="reference-container">
                        <div class="ref-category">
                            <h3>HTTP Methods</h3>
                            <table class="ref-table">
                                <thead>
                                    <tr>
                                        <th>Method</th>
                                        <th>Purpose</th>
                                        <th>Security Notes</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>GET</td>
                                        <td>Retrieve data from server</td>
                                        <td>Should be idempotent and safe (no side effects). Parameters in URL are logged.</td>
                                    </tr>
                                    <tr>
                                        <td>POST</td>
                                        <td>Submit data to server</td>
                                        <td>Used for forms, file uploads. Body content not logged in URLs.</td>
                                    </tr>
                                    <tr>
                                        <td>PUT</td>
                                        <td>Update/replace resource</td>
                                        <td>Often restricted to authenticated users. Test for IDOR vulnerabilities.</td>
                                    </tr>
                                    <tr>
                                        <td>DELETE</td>
                                        <td>Remove resource</td>
                                        <td>Should require strong authorization. Test for privilege escalation.</td>
                                    </tr>
                                    <tr>
                                        <td>PATCH</td>
                                        <td>Partially update resource</td>
                                        <td>Similar to PUT but for partial updates. Check access controls.</td>
                                    </tr>
                                    <tr>
                                        <td>OPTIONS</td>
                                        <td>Query supported methods</td>
                                        <td>Can leak information about allowed operations. Check CORS headers.</td>
                                    </tr>
                                    <tr>
                                        <td>HEAD</td>
                                        <td>GET without response body</td>
                                        <td>Returns only headers. Useful for testing without full download.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="ref-category">
                            <h3>Common HTTP Headers</h3>
                            <div class="ref-grid">
                                <div class="ref-item">
                                    <div class="ref-item-title">Host</div>
                                    <div class="ref-item-desc">Target domain name. Required in HTTP/1.1. Test for host header injection.</div>
                                </div>
                                <div class="ref-item">
                                    <div class="ref-item-title">User-Agent</div>
                                    <div class="ref-item-desc">Client software identifier. Can be spoofed to bypass filters.</div>
                                </div>
                                <div class="ref-item">
                                    <div class="ref-item-title">Cookie</div>
                                    <div class="ref-item-desc">Session data. Test for session fixation, prediction, and hijacking.</div>
                                </div>
                                <div class="ref-item">
                                    <div class="ref-item-title">Authorization</div>
                                    <div class="ref-item-desc">Authentication credentials. Common schemes: Basic, Bearer, Digest.</div>
                                </div>
                                <div class="ref-item">
                                    <div class="ref-item-title">Content-Type</div>
                                    <div class="ref-item-desc">Body data format (application/json, multipart/form-data, etc.)</div>
                                </div>
                                <div class="ref-item">
                                    <div class="ref-item-title">Content-Length</div>
                                    <div class="ref-item-desc">Body size in bytes. Mismatch can cause request smuggling.</div>
                                </div>
                                <div class="ref-item">
                                    <div class="ref-item-title">Referer</div>
                                    <div class="ref-item-desc">Previous page URL. Can leak sensitive info. Used for CSRF protection.</div>
                                </div>
                                <div class="ref-item">
                                    <div class="ref-item-title">X-Forwarded-For</div>
                                    <div class="ref-item-desc">Original client IP (proxy header). Can be spoofed to bypass IP filters.</div>
                                </div>
                                <div class="ref-item">
                                    <div class="ref-item-title">Accept</div>
                                    <div class="ref-item-desc">Acceptable response formats. Modify to test content negotiation.</div>
                                </div>
                                <div class="ref-item">
                                    <div class="ref-item-title">Origin</div>
                                    <div class="ref-item-desc">Request origin domain. Important for CORS testing.</div>
                                </div>
                            </div>
                        </div>

                        <div class="ref-category">
                            <h3>HTTP Status Codes</h3>
                            <table class="ref-table">
                                <thead>
                                    <tr>
                                        <th>Code</th>
                                        <th>Meaning</th>
                                        <th>Security Implications</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>200 OK</td>
                                        <td>Request succeeded</td>
                                        <td>Normal response. Analyze body for sensitive data leakage.</td>
                                    </tr>
                                    <tr>
                                        <td>301/302 Redirect</td>
                                        <td>Resource moved</td>
                                        <td>Check for open redirects, unvalidated redirects to external sites.</td>
                                    </tr>
                                    <tr>
                                        <td>400 Bad Request</td>
                                        <td>Malformed request</td>
                                        <td>Input validation triggered. Error messages may leak info.</td>
                                    </tr>
                                    <tr>
                                        <td>401 Unauthorized</td>
                                        <td>Authentication required</td>
                                        <td>Test for authentication bypass, weak credentials.</td>
                                    </tr>
                                    <tr>
                                        <td>403 Forbidden</td>
                                        <td>Access denied</td>
                                        <td>Authorization failed. Test for privilege escalation.</td>
                                    </tr>
                                    <tr>
                                        <td>404 Not Found</td>
                                        <td>Resource doesn't exist</td>
                                        <td>Enumerate valid vs invalid resources. Custom 404s may leak paths.</td>
                                    </tr>
                                    <tr>
                                        <td>500 Internal Error</td>
                                        <td>Server error occurred</td>
                                        <td>Often reveals stack traces, database errors, or sensitive info.</td>
                                    </tr>
                                    <tr>
                                        <td>503 Unavailable</td>
                                        <td>Service temporarily down</td>
                                        <td>Potential DoS vulnerability or maintenance window.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="ref-category">
                            <h3>Burp Suite Keyboard Shortcuts</h3>
                            <div class="ref-grid">
                                <div class="ref-item">
                                    <div class="ref-item-title">Ctrl+R</div>
                                    <div class="ref-item-desc">Send request to Repeater</div>
                                </div>
                                <div class="ref-item">
                                    <div class="ref-item-title">Ctrl+I</div>
                                    <div class="ref-item-desc">Send request to Intruder</div>
                                </div>
                                <div class="ref-item">
                                    <div class="ref-item-title">Ctrl+Shift+B</div>
                                    <div class="ref-item-desc">Base64 encode selection</div>
                                </div>
                                <div class="ref-item">
                                    <div class="ref-item-title">Ctrl+Shift+U</div>
                                    <div class="ref-item-desc">URL encode selection</div>
                                </div>
                                <div class="ref-item">
                                    <div class="ref-item-title">Ctrl+F</div>
                                    <div class="ref-item-desc">Find in current view</div>
                                </div>
                                <div class="ref-item">
                                    <div class="ref-item-title">Space</div>
                                    <div class="ref-item-desc">Forward intercepted request</div>
                                </div>
                            </div>
                        </div>

                        <div class="ref-category">
                            <h3>Common Vulnerability Patterns</h3>
                            <table class="ref-table">
                                <thead>
                                    <tr>
                                        <th>Vulnerability</th>
                                        <th>What to Look For</th>
                                        <th>Test Payload</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>SQL Injection</td>
                                        <td>User input in database queries</td>
                                        <td>' OR '1'='1' -- , 1' UNION SELECT NULL--</td>
                                    </tr>
                                    <tr>
                                        <td>XSS</td>
                                        <td>Reflected/stored user input in HTML</td>
                                        <td>&lt;script&gt;alert(1)&lt;/script&gt;, &lt;img src=x onerror=alert(1)&gt;</td>
                                    </tr>
                                    <tr>
                                        <td>IDOR</td>
                                        <td>Numeric IDs in URLs/parameters</td>
                                        <td>Increment/decrement ID values, try ID=1 (admin)</td>
                                    </tr>
                                    <tr>
                                        <td>Authentication Bypass</td>
                                        <td>Login forms, session cookies</td>
                                        <td>admin:admin, SQL injection in username, cookie manipulation</td>
                                    </tr>
                                    <tr>
                                        <td>CSRF</td>
                                        <td>State-changing requests without tokens</td>
                                        <td>Remove CSRF token, use token from different session</td>
                                    </tr>
                                    <tr>
                                        <td>XXE</td>
                                        <td>XML input processing</td>
                                        <td>&lt;!DOCTYPE foo [&lt;!ENTITY xxe SYSTEM "file:///etc/passwd"&gt;]&gt;</td>
                                    </tr>
                                    <tr>
                                        <td>Command Injection</td>
                                        <td>System commands with user input</td>
                                        <td>; ls -la, | whoami, `id`, $(cat /etc/passwd)</td>
                                    </tr>
                                    <tr>
                                        <td>Path Traversal</td>
                                        <td>File paths in parameters</td>
                                        <td>../../../etc/passwd, ..\..\windows\system32\config\sam</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- SETTINGS TAB -->
                <div id="settings" class="tab-content">
                    <div class="settings-panel">
                        <div class="settings-section">
                            <h3>📤 Export Progress</h3>
                            <p style="color: #888; margin-bottom: 15px;">Save your challenge progress and settings to continue later.</p>
                            <div class="settings-row">
                                <label>Export your progress data</label>
                                <button class="settings-btn" onclick="exportProgress()">Export to File</button>
                            </div>
                        </div>

                        <div class="settings-section">
                            <h3>📥 Import Progress</h3>
                            <p style="color: #888; margin-bottom: 15px;">Load previously saved progress.</p>
                            <div class="settings-row">
                                <label>Import progress data</label>
                                <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importProgress(event)">
                                <button class="settings-btn secondary" onclick="document.getElementById('importFile').click()">Import from File</button>
                            </div>
                        </div>

                        <div class="settings-section">
                            <h3>🔄 Reset Progress</h3>
                            <p style="color: #888; margin-bottom: 15px;">Clear all challenge progress and start fresh.</p>
                            <div class="settings-row">
                                <label>This cannot be undone!</label>
                                <button class="settings-btn" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);" onclick="resetProgress()">Reset All Progress</button>
                            </div>
                        </div>

                        <div class="settings-section">
                            <h3>📊 Statistics</h3>
                            <div class="settings-row">
                                <label>Total Challenges Completed</label>
                                <span id="statsCompleted" style="color: #22c55e; font-weight: 600;">0</span>
                            </div>
                            <div class="settings-row">
                                <label>Total Points Earned</label>
                                <span id="statsPoints" style="color: #fbbf24; font-weight: 600;">0</span>
                            </div>
                            <div class="settings-row">
                                <label>Requests Intercepted</label>
                                <span id="statsRequests" style="color: #06b6d4; font-weight: 600;">0</span>
                            </div>
                            <div class="settings-row">
                                <label>Requests Modified</label>
                                <span id="statsModified" style="color: #a78bfa; font-weight: 600;">0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SIDEBAR -->
            <div class="sidebar" id="sidebar">
                <h3>📖 Learning Panel</h3>
                <div id="learningContent">
                    <h4>Welcome to Burp Suite Training!</h4>
                    <p>This interactive lab will teach you how to use Burp Suite to test web application security like a professional penetration tester.</p>

                    <div class="tip-box">
                        <strong>💡 Getting Started</strong>
                        <p>Start with the <strong>Learn</strong> tab for fundamentals, then practice in the <strong>Proxy Lab</strong>!</p>
                    </div>

                    <div class="progress-summary">
                        <h4 style="color: #06b6d4; margin-bottom: 10px;">Your Progress</h4>
                        <div class="progress-item">
                            <span>Challenges:</span>
                            <span class="progress-value" id="sidebarProgress">0/10</span>
                        </div>
                        <div class="progress-item">
                            <span>Points:</span>
                            <span class="progress-value" id="sidebarPoints">0/175</span>
                        </div>
                    </div>

                    <h4>Quick Actions</h4>
                    <p>Try these scenarios:</p>
                    <div class="quick-filters">
                        <button class="quick-filter-btn" onclick="switchTab('proxy-lab'); document.getElementById('scenarioSelect').value='login'; loadScenario();">Login Test</button>
                        <button class="quick-filter-btn" onclick="switchTab('proxy-lab'); document.getElementById('scenarioSelect').value='sqli'; loadScenario();">SQL Injection</button>
                        <button class="quick-filter-btn" onclick="switchTab('proxy-lab'); document.getElementById('scenarioSelect').value='xss'; loadScenario();">XSS Test</button>
                        <button class="quick-filter-btn" onclick="switchTab('proxy-lab'); document.getElementById('scenarioSelect').value='idor'; loadScenario();">IDOR Test</button>
                    </div>

                    <div class="tip-box" style="margin-top: 15px;">
                        <strong>⚠️ Remember</strong>
                        <p>Only test applications you own or have explicit written permission to test. Unauthorized testing is illegal!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== STATE MANAGEMENT ====================
        let interceptEnabled = false;
        let currentRequest = null;
        let requestHistory = [];
        let selectedHistoryIndex = null;
        let requestCount = 0;
        let modifiedCount = 0;

        // Challenge state
        let completedChallenges = new Set();
        let totalPoints = 0;

        // ==================== CHALLENGE DEFINITIONS ====================
        const challenges = [
            {
                id: 1,
                title: 'Identify HTTP Method',
                description: 'Look at the Login Request scenario in Proxy Lab. What HTTP method is used?',
                hint: 'The method is the first word in the request line (GET, POST, PUT, etc.)',
                points: 10,
                answer: 'POST',
                inputType: 'text'
            },
            {
                id: 2,
                title: 'Find Cookie Value',
                description: 'In the API Request scenario, what is the value of the sessionid cookie?',
                hint: 'Look in the Cookie header. The format is name=value',
                points: 15,
                answer: 'abc123xyz789',
                inputType: 'text'
            },
            {
                id: 3,
                title: 'Identify Content-Type',
                description: 'In the Login Request, what Content-Type is used for the request body?',
                hint: 'Look for the Content-Type header in the request',
                points: 15,
                answer: 'application/x-www-form-urlencoded',
                inputType: 'text'
            },
            {
                id: 4,
                title: 'SQL Injection Detection',
                description: 'In the SQL Injection Target scenario, which parameter is vulnerable to SQL injection?',
                hint: 'Look at the URL parameters. The vulnerable one is used in a database query.',
                points: 20,
                answer: 'product_id',
                inputType: 'text'
            },
            {
                id: 5,
                title: 'Decode Base64',
                description: 'The API Request has a Base64-encoded Authorization header value: "YWRtaW46c3VwZXJzZWNyZXQ=". What is the decoded value?',
                hint: 'Use Burp\'s Decoder or an online Base64 decoder. Format is usually username:password',
                points: 20,
                answer: 'admin:supersecret',
                inputType: 'text'
            },
            {
                id: 6,
                title: 'Find Hidden Parameter',
                description: 'The Login Request contains a hidden parameter in the body. What is its name? (not username or password)',
                hint: 'Look carefully at all parameters in the request body',
                points: 15,
                answer: 'csrf_token',
                inputType: 'text'
            },
            {
                id: 7,
                title: 'IDOR Vulnerability',
                description: 'In the IDOR scenario, changing the user_id parameter from 1523 to what value might access admin account?',
                hint: 'Administrators often have user_id = 1 or 0',
                points: 20,
                answer: '1',
                inputType: 'text'
            },
            {
                id: 8,
                title: 'XSS Target Parameter',
                description: 'In the XSS Target scenario, which parameter reflects user input in the response?',
                hint: 'Look at the URL parameters - one of them will be echoed back in the HTML response',
                points: 15,
                answer: 'search',
                inputType: 'text'
            },
            {
                id: 9,
                title: 'Identify Host Header',
                description: 'What is the value of the Host header in the Login Request scenario?',
                hint: 'The Host header specifies the target domain name',
                points: 15,
                answer: 'vulnerable-bank.com',
                inputType: 'text'
            },
            {
                id: 10,
                title: 'Authentication Bypass',
                description: 'In the SQL Injection scenario, what SQL payload in the username field would bypass authentication? (Use the classic OR attack)',
                hint: 'Think: username\' OR \'1\'=\'1\' -- (comment out the rest)',
                points: 30,
                answer: "admin' OR '1'='1' --",
                inputType: 'text'
            }
        ];

        // ==================== SCENARIO DEFINITIONS ====================
        const scenarios = {
            login: {
                request: `POST /api/login HTTP/1.1
Host: vulnerable-bank.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
Content-Type: application/x-www-form-urlencoded
Content-Length: 67
Cookie: session=temp_session_12345
Connection: keep-alive

username=testuser&password=testpass123&csrf_token=a8f3k2m9p1q4`,
                response: `HTTP/1.1 200 OK
Content-Type: application/json
Set-Cookie: sessionid=xyz789abc456def; HttpOnly; Secure
Content-Length: 98

{"status":"success","message":"Login successful","user":{"id":1523,"username":"testuser","role":"user"}}`
            },
            api: {
                request: `GET /api/user/profile?user_id=1523 HTTP/1.1
Host: api.vulnerable-app.com
Authorization: Basic YWRtaW46c3VwZXJzZWNyZXQ=
Accept: application/json
Cookie: sessionid=abc123xyz789
User-Agent: BurpSuite/2024.1
Connection: keep-alive`,
                response: `HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store
Content-Length: 156

{"user_id":1523,"username":"testuser","email":"test@example.com","role":"user","account_balance":1250.50,"ssn":"123-45-6789","api_key":"sk_live_abc123xyz"}`
            },
            sqli: {
                request: `GET /products/view?product_id=42&category=electronics HTTP/1.1
Host: vulnerable-shop.com
User-Agent: Mozilla/5.0
Cookie: cart_id=session_98765
Accept: text/html,application/xhtml+xml
Referer: https://vulnerable-shop.com/products
Connection: keep-alive`,
                response: `HTTP/1.1 200 OK
Content-Type: text/html
Content-Length: 2048

<!DOCTYPE html>
<html>
<head><title>Product Details</title></head>
<body>
<h1>Wireless Headphones</h1>
<p>Price: $99.99</p>
<!-- SQL Query: SELECT * FROM products WHERE id = 42 -->
</body>
</html>`
            },
            xss: {
                request: `GET /search?search=<script>alert('XSS')</script>&category=all HTTP/1.1
Host: vulnerable-forum.com
User-Agent: Mozilla/5.0
Cookie: session=user_session_11223
Accept: text/html
Referer: https://vulnerable-forum.com/
Connection: keep-alive`,
                response: `HTTP/1.1 200 OK
Content-Type: text/html
X-XSS-Protection: 0
Content-Length: 512

<!DOCTYPE html>
<html>
<body>
<h2>Search Results for: <script>alert('XSS')</script></h2>
<p>No results found.</p>
<!-- User input is reflected without sanitization! -->
</body>
</html>`
            },
            idor: {
                request: `GET /api/documents/download?doc_id=8472&user_id=1523 HTTP/1.1
Host: secure-docs.com
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9
Cookie: session=active_user_1523
Accept: application/pdf
User-Agent: Mozilla/5.0
Connection: keep-alive`,
                response: `HTTP/1.1 200 OK
Content-Type: application/pdf
Content-Disposition: attachment; filename="user_1523_document_8472.pdf"
Content-Length: 45678

[PDF Binary Data]
<!-- Changing user_id parameter might access other users' documents! -->`
            }
        };

        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', () => {
            loadProgress();
            renderChallenges();
            updateStats();
            updateSidebar();
        });

        // ==================== TAB SWITCHING ====================
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // ==================== PROXY LAB FUNCTIONS ====================
        function toggleIntercept() {
            interceptEnabled = !interceptEnabled;
            const toggle = document.getElementById('interceptToggle');

            if (interceptEnabled) {
                toggle.textContent = 'Intercept is on';
                toggle.classList.add('on');
                loadScenario();
            } else {
                toggle.textContent = 'Intercept is off';
                toggle.classList.remove('on');
                document.getElementById('requestEditor').value = '';
                document.getElementById('responseViewer').value = '';
                document.getElementById('forwardBtn').disabled = true;
                document.getElementById('dropBtn').disabled = true;
                currentRequest = null;
            }
        }

        function loadScenario() {
            if (!interceptEnabled) {
                toggleIntercept();
                return;
            }

            const scenarioName = document.getElementById('scenarioSelect').value;
            const scenario = scenarios[scenarioName];

            currentRequest = {
                request: scenario.request,
                response: scenario.response,
                scenario: scenarioName
            };

            document.getElementById('requestEditor').value = scenario.request;
            document.getElementById('responseViewer').value = '';
            document.getElementById('forwardBtn').disabled = false;
            document.getElementById('dropBtn').disabled = false;

            requestCount++;
            updateStats();
        }

        function forwardRequest() {
            if (!currentRequest) return;

            const modifiedRequest = document.getElementById('requestEditor').value;
            const wasModified = modifiedRequest !== currentRequest.request;

            if (wasModified) {
                modifiedCount++;
            }

            document.getElementById('responseViewer').value = currentRequest.response;

            addToHistory({
                method: extractMethod(modifiedRequest),
                url: extractURL(modifiedRequest),
                request: modifiedRequest,
                response: currentRequest.response,
                status: wasModified ? 'modified' : 'forwarded',
                timestamp: new Date().toLocaleTimeString()
            });

            updateStats();

            // Auto-load next scenario or disable intercept
            setTimeout(() => {
                document.getElementById('requestEditor').value = '';
                document.getElementById('responseViewer').value = '';
                currentRequest = null;
                document.getElementById('forwardBtn').disabled = true;
                document.getElementById('dropBtn').disabled = true;
            }, 1000);
        }

        function dropRequest() {
            if (!currentRequest) return;

            const request = document.getElementById('requestEditor').value;

            addToHistory({
                method: extractMethod(request),
                url: extractURL(request),
                request: request,
                response: '(Request dropped)',
                status: 'dropped',
                timestamp: new Date().toLocaleTimeString()
            });

            document.getElementById('requestEditor').value = '';
            document.getElementById('responseViewer').value = '';
            currentRequest = null;
            document.getElementById('forwardBtn').disabled = true;
            document.getElementById('dropBtn').disabled = true;
        }

        function sendToRepeater() {
            const request = document.getElementById('requestEditor').value;
            if (!request.trim()) {
                alert('No request to send. Enable intercept and select a scenario first.');
                return;
            }

            alert('Request sent to Repeater!\n\nIn real Burp Suite, this would open a new Repeater tab where you can modify and resend the request multiple times.\n\nFor this lab, you can continue editing in the current view.');
        }

        function extractMethod(request) {
            const match = request.match(/^(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS)/);
            return match ? match[1] : 'UNKNOWN';
        }

        function extractURL(request) {
            const match = request.match(/^(?:GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS)\s+(.+?)\s+HTTP/);
            return match ? match[1] : '/';
        }

        function addToHistory(item) {
            requestHistory.unshift(item);
            if (requestHistory.length > 20) requestHistory.pop();
            renderHistory();
        }

        function renderHistory() {
            const historyList = document.getElementById('historyList');

            if (requestHistory.length === 0) {
                historyList.innerHTML = '<div style="padding: 20px; text-align: center; color: #888;">No requests captured yet</div>';
                return;
            }

            historyList.innerHTML = requestHistory.map((item, index) => `
                <div class="history-item ${selectedHistoryIndex === index ? 'selected' : ''}" onclick="selectHistoryItem(${index})">
                    <span class="history-method">${item.method}</span>
                    <span class="history-url">${item.url}</span>
                    <span class="history-status status-${item.status}">${item.status}</span>
                    <span style="color: #666; font-size: 0.8em;">${item.timestamp}</span>
                </div>
            `).join('');
        }

        function selectHistoryItem(index) {
            selectedHistoryIndex = index;
            const item = requestHistory[index];

            document.getElementById('requestEditor').value = item.request;
            document.getElementById('responseViewer').value = item.response;

            renderHistory();
        }

        // ==================== CHALLENGES FUNCTIONS ====================
        function renderChallenges() {
            const container = document.getElementById('challengesList');

            container.innerHTML = challenges.map(challenge => {
                const isCompleted = completedChallenges.has(challenge.id);

                return `
                    <div class="challenge-card ${isCompleted ? 'completed' : ''}" id="challenge-${challenge.id}">
                        <div class="challenge-header">
                            <div class="challenge-title">Challenge ${challenge.id}: ${challenge.title}</div>
                            <div class="challenge-points">${challenge.points} pts</div>
                        </div>
                        <div class="challenge-desc">${challenge.description}</div>

                        ${!isCompleted ? `
                            <input type="text"
                                   class="challenge-input"
                                   id="answer-${challenge.id}"
                                   placeholder="Enter your answer..."
                                   onkeypress="if(event.key==='Enter') checkChallenge(${challenge.id})">

                            <div class="challenge-status">
                                <button class="submit-btn" onclick="checkChallenge(${challenge.id})">Submit Answer</button>
                                <button class="hint-btn" onclick="toggleHint(${challenge.id})">Show Hint</button>
                            </div>

                            <div class="hint-text" id="hint-${challenge.id}">
                                💡 ${challenge.hint}
                            </div>
                        ` : `
                            <div class="challenge-status">
                                <span class="status-badge status-complete">✓ Completed</span>
                            </div>
                        `}
                    </div>
                `;
            }).join('');
        }

        function toggleHint(challengeId) {
            const hint = document.getElementById(`hint-${challengeId}`);
            hint.classList.toggle('show');
        }

        function checkChallenge(challengeId) {
            const challenge = challenges.find(c => c.id === challengeId);
            const userAnswer = document.getElementById(`answer-${challengeId}`).value.trim();

            if (!userAnswer) {
                alert('Please enter an answer first!');
                return;
            }

            const isCorrect = userAnswer.toLowerCase() === challenge.answer.toLowerCase();

            if (isCorrect) {
                completedChallenges.add(challengeId);
                totalPoints += challenge.points;

                alert(`✓ Correct! You earned ${challenge.points} points!\n\n${getSuccessMessage(challengeId)}`);

                renderChallenges();
                updateStats();
                updateSidebar();
                saveProgress();
            } else {
                alert('✗ Incorrect. Try again!\n\nHint: ' + challenge.hint);
            }
        }

        function getSuccessMessage(challengeId) {
            const messages = {
                1: 'POST is used for submitting data like login forms.',
                2: 'Great! Session cookies are critical for authentication.',
                3: 'This content type is used for standard HTML forms.',
                4: 'Correct! Numeric IDs in URLs are common SQL injection targets.',
                5: 'Base64 encoding is NOT encryption - credentials should never be sent this way!',
                6: 'CSRF tokens help prevent Cross-Site Request Forgery attacks.',
                7: 'Exactly! IDOR vulnerabilities let you access other users\' data.',
                8: 'Reflected XSS occurs when user input is echoed in the response.',
                9: 'The Host header is mandatory in HTTP/1.1 and can be exploited.',
                10: 'Perfect! This is the classic SQL injection authentication bypass.'
            };
            return messages[challengeId] || 'Well done!';
        }

        // ==================== PROGRESS MANAGEMENT ====================
        function saveProgress() {
            const data = {
                completedChallenges: Array.from(completedChallenges),
                totalPoints: totalPoints,
                requestCount: requestCount,
                modifiedCount: modifiedCount,
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('burpTrainingProgress', JSON.stringify(data));
        }

        function loadProgress() {
            const saved = localStorage.getItem('burpTrainingProgress');
            if (saved) {
                const data = JSON.parse(saved);
                completedChallenges = new Set(data.completedChallenges);
                totalPoints = data.totalPoints || 0;
                requestCount = data.requestCount || 0;
                modifiedCount = data.modifiedCount || 0;
            }
        }

        function exportProgress() {
            const data = {
                completedChallenges: Array.from(completedChallenges),
                totalPoints: totalPoints,
                requestCount: requestCount,
                modifiedCount: modifiedCount,
                exportDate: new Date().toISOString(),
                version: '1.0'
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `burp-training-progress-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function importProgress(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = JSON.parse(e.target.result);

                    if (confirm('This will overwrite your current progress. Continue?')) {
                        completedChallenges = new Set(data.completedChallenges);
                        totalPoints = data.totalPoints || 0;
                        requestCount = data.requestCount || 0;
                        modifiedCount = data.modifiedCount || 0;

                        saveProgress();
                        renderChallenges();
                        updateStats();
                        updateSidebar();

                        alert('Progress imported successfully!');
                    }
                } catch (error) {
                    alert('Error importing file. Please make sure it\'s a valid progress file.');
                }
            };
            reader.readAsText(file);
        }

        function resetProgress() {
            if (confirm('Are you sure you want to reset ALL progress? This cannot be undone!')) {
                if (confirm('Really sure? All challenges and statistics will be cleared.')) {
                    completedChallenges.clear();
                    totalPoints = 0;
                    requestCount = 0;
                    modifiedCount = 0;
                    requestHistory = [];

                    localStorage.removeItem('burpTrainingProgress');

                    renderChallenges();
                    renderHistory();
                    updateStats();
                    updateSidebar();

                    alert('Progress reset successfully!');
                }
            }
        }

        function updateStats() {
            document.getElementById('statsCompleted').textContent = completedChallenges.size;
            document.getElementById('statsPoints').textContent = totalPoints;
            document.getElementById('statsRequests').textContent = requestCount;
            document.getElementById('statsModified').textContent = modifiedCount;
        }

        function updateSidebar() {
            document.getElementById('sidebarProgress').textContent = `${completedChallenges.size}/10`;
            document.getElementById('sidebarPoints').textContent = `${totalPoints}/175`;
        }
    </script>
</body>
</html>