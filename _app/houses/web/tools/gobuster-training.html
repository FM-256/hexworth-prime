<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gobuster Training Lab - Web House | Hexworth Prime</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a1628 0%, #0f2847 100%);
            min-height: 100vh;
            padding: 20px;
            color: #e0e0e0;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(10, 22, 40, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            border: 2px solid rgba(6, 182, 212, 0.3);
        }

        .header {
            background: linear-gradient(135deg, #0369a1 0%, #06b6d4 100%);
            padding: 30px;
            text-align: center;
            border-bottom: 3px solid #06b6d4;
        }

        .header h1 {
            color: #ffffff;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            color: #e0f2fe;
            font-size: 1.1em;
        }

        .back-link {
            display: inline-block;
            margin-top: 15px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .back-link:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 0;
            min-height: calc(100vh - 200px);
        }

        .workspace {
            display: flex;
            flex-direction: column;
            border-right: 2px solid rgba(6, 182, 212, 0.3);
        }

        .tab-container {
            display: flex;
            background: rgba(10, 22, 40, 0.9);
            border-bottom: 2px solid rgba(6, 182, 212, 0.3);
            padding: 10px 20px 0;
            gap: 5px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 20px;
            background: rgba(3, 105, 161, 0.3);
            color: #06b6d4;
            border: none;
            cursor: pointer;
            border-radius: 10px 10px 0 0;
            transition: all 0.3s ease;
            font-size: 0.95em;
            font-weight: 500;
            border: 2px solid transparent;
            border-bottom: none;
        }

        .tab:hover {
            background: rgba(6, 182, 212, 0.3);
            color: #e0e0e0;
        }

        .tab.active {
            background: rgba(3, 105, 161, 0.6);
            color: #ffffff;
            border-color: #06b6d4;
        }

        .tab-content {
            display: none;
            flex: 1;
            overflow: hidden;
            flex-direction: column;
        }

        .tab-content.active {
            display: flex;
        }

        /* Learn Tab Styles */
        .learn-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .learn-section {
            margin-bottom: 30px;
        }

        .learn-section h2 {
            color: #06b6d4;
            font-size: 1.8em;
            margin-bottom: 15px;
            border-bottom: 2px solid #0369a1;
            padding-bottom: 10px;
        }

        .learn-section h3 {
            color: #38bdf8;
            font-size: 1.3em;
            margin: 20px 0 10px;
        }

        .learn-section p {
            line-height: 1.8;
            margin-bottom: 15px;
            color: #d0d0d0;
        }

        .learn-section ul, .learn-section ol {
            margin-left: 25px;
            margin-bottom: 15px;
        }

        .learn-section li {
            line-height: 1.8;
            margin-bottom: 8px;
            color: #d0d0d0;
        }

        .info-box {
            background: rgba(6, 182, 212, 0.15);
            border-left: 4px solid #06b6d4;
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        .info-box.warning {
            background: rgba(251, 146, 60, 0.15);
            border-left-color: #fb923c;
        }

        .info-box.success {
            background: rgba(34, 197, 94, 0.15);
            border-left-color: #22c55e;
        }

        .info-box.danger {
            background: rgba(239, 68, 68, 0.15);
            border-left-color: #ef4444;
        }

        .info-box strong {
            color: #06b6d4;
            display: block;
            margin-bottom: 5px;
        }

        .info-box.warning strong {
            color: #fb923c;
        }

        .info-box.success strong {
            color: #22c55e;
        }

        .info-box.danger strong {
            color: #ef4444;
        }

        code {
            background: rgba(3, 105, 161, 0.3);
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #06b6d4;
        }

        .code-block {
            background: rgba(0, 0, 0, 0.6);
            padding: 15px 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
            border: 1px solid rgba(6, 182, 212, 0.3);
            font-size: 0.9em;
        }

        .code-block .command {
            color: #22c55e;
            font-weight: 600;
        }

        .code-block .url {
            color: #06b6d4;
        }

        .code-block .flag {
            color: #fbbf24;
        }

        .code-block .path {
            color: #a78bfa;
        }

        .code-block .status {
            color: #f472b6;
        }

        .code-block .comment {
            color: #888;
            font-style: italic;
        }

        /* Enumeration Lab Styles */
        .enum-lab {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .toolbar {
            background: rgba(0, 0, 0, 0.4);
            padding: 15px 20px;
            border-bottom: 2px solid rgba(6, 182, 212, 0.2);
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .toolbar label {
            color: #06b6d4;
            font-weight: 600;
        }

        .toolbar select {
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid rgba(6, 182, 212, 0.3);
            color: #e0e0e0;
            padding: 8px 15px;
            border-radius: 6px;
            font-size: 0.95em;
        }

        .toolbar select:focus {
            outline: none;
            border-color: #06b6d4;
        }

        .terminal-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: rgba(0, 0, 0, 0.6);
        }

        .terminal-header {
            background: rgba(3, 105, 161, 0.3);
            padding: 10px 20px;
            color: #06b6d4;
            font-weight: 600;
            border-bottom: 1px solid rgba(6, 182, 212, 0.2);
            font-family: 'Courier New', monospace;
        }

        .terminal-output {
            flex: 1;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-y: auto;
            line-height: 1.6;
        }

        .terminal-input-container {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            background: rgba(0, 0, 0, 0.8);
            border-top: 1px solid rgba(6, 182, 212, 0.2);
        }

        .terminal-prompt {
            color: #22c55e;
            font-family: 'Courier New', monospace;
            margin-right: 10px;
            font-weight: 600;
        }

        .terminal-input {
            flex: 1;
            background: transparent;
            border: none;
            color: #e0e0e0;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            outline: none;
        }

        .autocomplete-container {
            position: relative;
        }

        .autocomplete-suggestions {
            position: absolute;
            bottom: 100%;
            left: 0;
            right: 0;
            background: rgba(10, 22, 40, 0.98);
            border: 2px solid #06b6d4;
            border-radius: 6px 6px 0 0;
            max-height: 200px;
            overflow-y: auto;
            display: none;
            z-index: 1000;
        }

        .autocomplete-suggestions.show {
            display: block;
        }

        .autocomplete-item {
            padding: 8px 15px;
            cursor: pointer;
            color: #d0d0d0;
            border-bottom: 1px solid rgba(6, 182, 212, 0.1);
        }

        .autocomplete-item:hover,
        .autocomplete-item.selected {
            background: rgba(6, 182, 212, 0.3);
            color: #ffffff;
        }

        .output-line {
            margin-bottom: 5px;
        }

        .output-command {
            color: #06b6d4;
            font-weight: 600;
        }

        .output-found {
            color: #22c55e;
        }

        .output-error {
            color: #ef4444;
        }

        .output-info {
            color: #fbbf24;
        }

        .output-status-200 {
            color: #22c55e;
        }

        .output-status-301,
        .output-status-302 {
            color: #06b6d4;
        }

        .output-status-403 {
            color: #fbbf24;
        }

        .output-status-404 {
            color: #888;
        }

        .output-status-500 {
            color: #ef4444;
        }

        /* Challenges Tab */
        .challenges-container {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .challenge-card {
            background: rgba(3, 105, 161, 0.15);
            border: 2px solid rgba(6, 182, 212, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .challenge-card:hover {
            border-color: #06b6d4;
            transform: translateX(5px);
        }

        .challenge-card.completed {
            border-color: #22c55e;
            background: rgba(34, 197, 94, 0.1);
        }

        .challenge-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
        }

        .challenge-title {
            color: #06b6d4;
            font-size: 1.1em;
            font-weight: 600;
        }

        .challenge-card.completed .challenge-title {
            color: #22c55e;
        }

        .challenge-points {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .challenge-desc {
            color: #b0b0b0;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .challenge-input {
            width: 100%;
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid rgba(6, 182, 212, 0.3);
            color: #e0e0e0;
            padding: 10px 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            margin-bottom: 10px;
        }

        .challenge-input:focus {
            outline: none;
            border-color: #06b6d4;
        }

        .challenge-status {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-badge {
            padding: 5px 15px;
            border-radius: 5px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .status-pending {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
            border: 1px solid #fbbf24;
        }

        .status-complete {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
            border: 1px solid #22c55e;
        }

        .hint-btn {
            background: rgba(3, 105, 161, 0.3);
            border: none;
            color: #06b6d4;
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.3s ease;
        }

        .hint-btn:hover {
            background: rgba(3, 105, 161, 0.5);
        }

        .hint-text {
            display: none;
            margin-top: 10px;
            padding: 10px 15px;
            background: rgba(6, 182, 212, 0.1);
            border-left: 3px solid #06b6d4;
            color: #a0a0a0;
            font-size: 0.9em;
        }

        .hint-text.show {
            display: block;
        }

        .submit-btn {
            background: linear-gradient(135deg, #06b6d4 0%, #0369a1 100%);
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(6, 182, 212, 0.4);
        }

        /* Reference Tab */
        .reference-container {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .ref-category {
            margin-bottom: 25px;
        }

        .ref-category h3 {
            color: #06b6d4;
            font-size: 1.2em;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid rgba(6, 182, 212, 0.3);
        }

        .ref-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .ref-table th {
            background: rgba(3, 105, 161, 0.3);
            color: #06b6d4;
            padding: 10px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid rgba(6, 182, 212, 0.3);
        }

        .ref-table td {
            padding: 10px;
            border-bottom: 1px solid rgba(6, 182, 212, 0.1);
            color: #d0d0d0;
        }

        .ref-table td:first-child {
            color: #06b6d4;
            font-family: 'Courier New', monospace;
            font-weight: 600;
        }

        /* Settings Tab */
        .settings-panel {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .settings-section {
            background: rgba(3, 105, 161, 0.1);
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .settings-section h3 {
            color: #06b6d4;
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .settings-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(6, 182, 212, 0.1);
        }

        .settings-row:last-child {
            border-bottom: none;
        }

        .settings-row label {
            color: #d0d0d0;
            font-weight: 500;
        }

        .settings-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #06b6d4 0%, #0369a1 100%);
            color: white;
        }

        .settings-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(6, 182, 212, 0.4);
        }

        .settings-btn.secondary {
            background: rgba(3, 105, 161, 0.3);
            color: #06b6d4;
            border: 2px solid #06b6d4;
        }

        .settings-btn.secondary:hover {
            background: rgba(3, 105, 161, 0.5);
        }

        /* Sidebar */
        .sidebar {
            background: rgba(0, 0, 0, 0.4);
            padding: 20px;
            overflow-y: auto;
            border-left: 2px solid rgba(6, 182, 212, 0.3);
        }

        .sidebar h3 {
            color: #06b6d4;
            font-size: 1.3em;
            margin-bottom: 15px;
            text-align: center;
        }

        .sidebar h4 {
            color: #38bdf8;
            font-size: 1em;
            margin: 15px 0 10px;
        }

        .sidebar p {
            color: #b0b0b0;
            line-height: 1.6;
            margin-bottom: 10px;
            font-size: 0.9em;
        }

        .tip-box {
            background: rgba(6, 182, 212, 0.1);
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-radius: 8px;
            padding: 12px;
            margin: 15px 0;
        }

        .tip-box strong {
            color: #06b6d4;
            display: block;
            margin-bottom: 5px;
        }

        .quick-filters {
            display: grid;
            grid-template-columns: 1fr;
            gap: 8px;
            margin: 10px 0;
        }

        .quick-filter-btn {
            background: rgba(3, 105, 161, 0.3);
            border: 1px solid rgba(6, 182, 212, 0.3);
            color: #06b6d4;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.3s ease;
            font-family: 'Courier New', monospace;
        }

        .quick-filter-btn:hover {
            background: rgba(3, 105, 161, 0.5);
            border-color: #06b6d4;
        }

        .progress-summary {
            background: linear-gradient(135deg, rgba(3, 105, 161, 0.2), rgba(6, 182, 212, 0.1));
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .progress-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            color: #d0d0d0;
        }

        .progress-value {
            font-weight: 600;
            color: #06b6d4;
        }

        /* Scrollbar Styles */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(6, 182, 212, 0.5);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(6, 182, 212, 0.7);
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .sidebar {
                border-left: none;
                border-top: 2px solid rgba(6, 182, 212, 0.3);
                max-height: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Gobuster Training Lab</h1>
            <p>Master Directory & DNS Enumeration Like a Pro</p>
            <a href="../index.html" class="back-link">‚Üê Back to Web House</a>
        </div>

        <div class="main-content">
            <div class="workspace">
                <div class="tab-container">
                    <button class="tab active" onclick="switchTab('learn')">Learn</button>
                    <button class="tab" onclick="switchTab('enum-lab')">Enumeration Lab</button>
                    <button class="tab" onclick="switchTab('challenges')">Challenges</button>
                    <button class="tab" onclick="switchTab('reference')">Reference</button>
                    <button class="tab" onclick="switchTab('settings')">Settings</button>
                </div>

                <!-- LEARN TAB -->
                <div id="learn" class="tab-content active">
                    <div class="learn-content">
                        <div class="learn-section">
                            <h2>What is Gobuster?</h2>
                            <p>Gobuster is a fast, efficient directory/file and DNS brute-forcing tool written in Go. It's designed to help security professionals discover hidden content on web servers, enumerate subdomains, and identify potential attack vectors that aren't linked or easily discoverable through normal browsing.</p>

                            <p>Unlike web crawlers that follow links, Gobuster uses wordlists to systematically test for the existence of directories, files, and subdomains. This makes it invaluable for:</p>
                            <ul>
                                <li>Finding hidden admin panels, configuration files, and backup directories</li>
                                <li>Discovering API endpoints that aren't publicly documented</li>
                                <li>Enumerating subdomains to map an organization's attack surface</li>
                                <li>Identifying forgotten or unprotected resources on web servers</li>
                                <li>Reconnaissance during penetration testing engagements</li>
                            </ul>

                            <div class="info-box">
                                <strong>Why Gobuster?</strong>
                                <p>Written in Go for blazing-fast performance, Gobuster can make thousands of requests per second. It's simple, efficient, and doesn't have the bloat of older tools. No GUI, no Java runtime - just pure speed.</p>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Gobuster Modes</h2>

                            <h3>1. Directory/File Enumeration (dir mode)</h3>
                            <p>The most common mode - discovers hidden directories and files on web servers.</p>
                            <div class="code-block">
<span class="command">gobuster</span> <span class="flag">dir</span> <span class="flag">-u</span> <span class="url">http://target.com</span> <span class="flag">-w</span> <span class="path">/usr/share/wordlists/dirb/common.txt</span>
                            </div>
                            <ul>
                                <li>Tests every word in the wordlist against the target URL</li>
                                <li>Identifies valid paths based on HTTP status codes</li>
                                <li>Can specify file extensions to search for (.php, .html, .txt, etc.)</li>
                                <li>Supports custom headers, cookies, and authentication</li>
                            </ul>

                            <h3>2. DNS Subdomain Enumeration (dns mode)</h3>
                            <p>Discovers subdomains by brute-forcing DNS queries.</p>
                            <div class="code-block">
<span class="command">gobuster</span> <span class="flag">dns</span> <span class="flag">-d</span> <span class="url">example.com</span> <span class="flag">-w</span> <span class="path">/usr/share/wordlists/subdomains.txt</span>
                            </div>
                            <ul>
                                <li>Finds subdomains like dev.example.com, api.example.com, admin.example.com</li>
                                <li>Essential for mapping an organization's infrastructure</li>
                                <li>Can reveal staging servers, internal tools, and forgotten resources</li>
                                <li>Uses DNS resolution instead of HTTP requests</li>
                            </ul>

                            <h3>3. Virtual Host Enumeration (vhost mode)</h3>
                            <p>Discovers virtual hosts by testing Host headers on a single IP.</p>
                            <div class="code-block">
<span class="command">gobuster</span> <span class="flag">vhost</span> <span class="flag">-u</span> <span class="url">http://192.168.1.100</span> <span class="flag">-w</span> <span class="path">/usr/share/wordlists/vhosts.txt</span>
                            </div>
                            <ul>
                                <li>Useful when multiple sites are hosted on one IP</li>
                                <li>Tests different Host header values to find hidden sites</li>
                                <li>Can reveal internal applications not meant to be public</li>
                            </ul>

                            <h3>4. Fuzzing Mode (fuzz mode)</h3>
                            <p>Generic fuzzing - replace FUZZ keyword in URL with wordlist entries.</p>
                            <div class="code-block">
<span class="command">gobuster</span> <span class="flag">fuzz</span> <span class="flag">-u</span> <span class="url">http://target.com/?id=FUZZ</span> <span class="flag">-w</span> <span class="path">/usr/share/wordlists/numbers.txt</span>
                            </div>
                            <ul>
                                <li>Test parameters, IDs, or any part of a URL</li>
                                <li>More flexible than dir mode for custom fuzzing</li>
                                <li>Can fuzz headers, body content, or any request component</li>
                            </ul>

                            <div class="info-box success">
                                <strong>Pro Tip: Choose the Right Mode</strong>
                                <p>Use <code>dir</code> for initial web enumeration, <code>dns</code> for subdomain discovery before scanning, <code>vhost</code> when you find shared hosting, and <code>fuzz</code> for custom parameter testing.</p>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Essential Gobuster Options</h2>

                            <h3>Core Options</h3>
                            <div class="code-block">
<span class="flag">-u</span> <span class="url">URL</span>           <span class="comment"># Target URL (required for dir/vhost/fuzz)</span>
<span class="flag">-d</span> <span class="url">DOMAIN</span>        <span class="comment"># Target domain (required for dns)</span>
<span class="flag">-w</span> <span class="path">WORDLIST</span>      <span class="comment"># Path to wordlist file (required)</span>
<span class="flag">-t</span> <span class="status">THREADS</span>      <span class="comment"># Number of concurrent threads (default: 10)</span>
<span class="flag">-o</span> <span class="path">OUTPUT</span>        <span class="comment"># Write results to file</span>
                            </div>

                            <h3>Directory Mode Specific</h3>
                            <div class="code-block">
<span class="flag">-x</span> <span class="path">EXTENSIONS</span>   <span class="comment"># File extensions to search (.php,.html,.txt)</span>
<span class="flag">-s</span> <span class="status">STATUSCODES</span>  <span class="comment"># Positive status codes (200,301,302)</span>
<span class="flag">-b</span> <span class="status">STATUSCODES</span>  <span class="comment"># Negative status codes to exclude</span>
<span class="flag">-k</span>                <span class="comment"># Skip SSL certificate verification</span>
<span class="flag">-r</span>                <span class="comment"># Follow redirects</span>
<span class="flag">-c</span> <span class="path">COOKIE</span>        <span class="comment"># Specify cookie for the requests</span>
<span class="flag">-H</span> <span class="path">HEADER</span>        <span class="comment"># Add custom header (can use multiple times)</span>
<span class="flag">-a</span> <span class="path">USERAGENT</span>    <span class="comment"># Set custom User-Agent string</span>
<span class="flag">-P</span> <span class="path">PASSWORD</span>     <span class="comment"># Password for Basic Auth</span>
<span class="flag">-U</span> <span class="path">USERNAME</span>     <span class="comment"># Username for Basic Auth</span>
                            </div>

                            <h3>Performance Tuning</h3>
                            <div class="code-block">
<span class="flag">-t</span> <span class="status">50</span>            <span class="comment"># Increase threads for faster scanning</span>
<span class="flag">--delay</span> <span class="status">1s</span>       <span class="comment"># Delay between requests (avoid rate limiting)</span>
<span class="flag">--timeout</span> <span class="status">10s</span>     <span class="comment"># HTTP timeout (default: 10s)</span>
<span class="flag">-q</span>                <span class="comment"># Quiet mode (less output)</span>
<span class="flag">-v</span>                <span class="comment"># Verbose mode (more output)</span>
                            </div>

                            <div class="info-box warning">
                                <strong>Performance vs. Stealth</strong>
                                <p>Higher thread counts (-t) mean faster scans but more detectable traffic. Use delays and lower thread counts for stealthier enumeration on real engagements.</p>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Common Wordlists</h2>

                            <h3>Kali Linux Built-in Wordlists</h3>
                            <p>Kali Linux comes with several excellent wordlists for different purposes:</p>

                            <div class="code-block">
<span class="comment"># Directory/File wordlists</span>
<span class="path">/usr/share/wordlists/dirb/common.txt</span>           <span class="comment"># 4,614 entries - good starting point</span>
<span class="path">/usr/share/wordlists/dirb/big.txt</span>              <span class="comment"># 20,469 entries - more comprehensive</span>
<span class="path">/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</span>  <span class="comment"># 220,560 entries</span>

<span class="comment"># DNS/Subdomain wordlists</span>
<span class="path">/usr/share/wordlists/dnsmap.txt</span>                <span class="comment"># Common subdomains</span>
<span class="path">/usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt</span>

<span class="comment"># SecLists (must install separately)</span>
<span class="path">/usr/share/seclists/Discovery/Web-Content/common.txt</span>
<span class="path">/usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt</span>
                            </div>

                            <h3>Choosing the Right Wordlist</h3>
                            <ul>
                                <li><strong>Small (< 5,000 words):</strong> Quick scans, testing, initial reconnaissance</li>
                                <li><strong>Medium (5,000-50,000 words):</strong> Standard penetration testing engagements</li>
                                <li><strong>Large (> 50,000 words):</strong> Comprehensive audits, CTFs, thorough testing</li>
                                <li><strong>Custom wordlists:</strong> Target-specific (company names, technologies, known patterns)</li>
                            </ul>

                            <div class="info-box">
                                <strong>SecLists - Essential Collection</strong>
                                <p>Install SecLists for the most comprehensive wordlist collection: <code>sudo apt install seclists</code> or clone from <code>github.com/danielmiessler/SecLists</code></p>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Practical Examples</h2>

                            <h3>Basic Directory Enumeration</h3>
                            <div class="code-block">
<span class="command">gobuster</span> <span class="flag">dir</span> <span class="flag">-u</span> <span class="url">http://example.com</span> <span class="flag">-w</span> <span class="path">/usr/share/wordlists/dirb/common.txt</span>
                            </div>

                            <h3>Directory Scan with File Extensions</h3>
                            <div class="code-block">
<span class="command">gobuster</span> <span class="flag">dir</span> <span class="flag">-u</span> <span class="url">http://example.com</span> <span class="flag">-w</span> <span class="path">common.txt</span> <span class="flag">-x</span> <span class="path">php,html,txt,js</span>
                            </div>

                            <h3>Fast Scan with Custom Threads</h3>
                            <div class="code-block">
<span class="command">gobuster</span> <span class="flag">dir</span> <span class="flag">-u</span> <span class="url">http://example.com</span> <span class="flag">-w</span> <span class="path">common.txt</span> <span class="flag">-t</span> <span class="status">50</span> <span class="flag">-o</span> <span class="path">results.txt</span>
                            </div>

                            <h3>Scan with Authentication</h3>
                            <div class="code-block">
<span class="command">gobuster</span> <span class="flag">dir</span> <span class="flag">-u</span> <span class="url">http://example.com</span> <span class="flag">-w</span> <span class="path">common.txt</span> <span class="flag">-U</span> <span class="path">admin</span> <span class="flag">-P</span> <span class="path">password123</span>
                            </div>

                            <h3>Subdomain Enumeration</h3>
                            <div class="code-block">
<span class="command">gobuster</span> <span class="flag">dns</span> <span class="flag">-d</span> <span class="url">example.com</span> <span class="flag">-w</span> <span class="path">/usr/share/wordlists/subdomains.txt</span> <span class="flag">-t</span> <span class="status">50</span>
                            </div>

                            <h3>Virtual Host Discovery</h3>
                            <div class="code-block">
<span class="command">gobuster</span> <span class="flag">vhost</span> <span class="flag">-u</span> <span class="url">http://example.com</span> <span class="flag">-w</span> <span class="path">subdomains.txt</span> <span class="flag">-t</span> <span class="status">50</span>
                            </div>

                            <h3>API Endpoint Discovery</h3>
                            <div class="code-block">
<span class="command">gobuster</span> <span class="flag">dir</span> <span class="flag">-u</span> <span class="url">http://api.example.com</span> <span class="flag">-w</span> <span class="path">api-endpoints.txt</span> <span class="flag">-x</span> <span class="path">json</span>
                            </div>

                            <div class="info-box success">
                                <strong>Save Your Results</strong>
                                <p>Always use <code>-o filename.txt</code> to save scan results. You'll want to review them later, compare scans, or include in reports.</p>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Understanding HTTP Status Codes</h2>

                            <h3>Important Status Codes for Enumeration</h3>
                            <ul>
                                <li><strong>200 OK:</strong> Resource found and accessible - HIGH PRIORITY</li>
                                <li><strong>301 Moved Permanently:</strong> Resource redirected - follow the location</li>
                                <li><strong>302 Found:</strong> Temporary redirect - may indicate login required</li>
                                <li><strong>401 Unauthorized:</strong> Authentication required - but resource exists!</li>
                                <li><strong>403 Forbidden:</strong> Resource exists but access denied - try to bypass</li>
                                <li><strong>404 Not Found:</strong> Resource doesn't exist - ignore (default hidden)</li>
                                <li><strong>500 Internal Server Error:</strong> Server error - might reveal info in response</li>
                                <li><strong>503 Service Unavailable:</strong> Temporarily unavailable - try later</li>
                            </ul>

                            <div class="info-box">
                                <strong>403 is Your Friend</strong>
                                <p>A 403 Forbidden status means the resource EXISTS but you don't have permission. This is valuable intelligence - you found something protected!</p>
                            </div>

                            <h3>Customizing Status Code Detection</h3>
                            <div class="code-block">
<span class="comment"># Only show specific status codes</span>
<span class="command">gobuster</span> <span class="flag">dir</span> <span class="flag">-u</span> <span class="url">http://target.com</span> <span class="flag">-w</span> <span class="path">common.txt</span> <span class="flag">-s</span> <span class="status">"200,301,302,401,403"</span>

<span class="comment"># Exclude specific status codes</span>
<span class="command">gobuster</span> <span class="flag">dir</span> <span class="flag">-u</span> <span class="url">http://target.com</span> <span class="flag">-w</span> <span class="path">common.txt</span> <span class="flag">-b</span> <span class="status">"404,400"</span>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Gobuster vs. Other Tools</h2>

                            <h3>Gobuster vs. Dirb</h3>
                            <ul>
                                <li><strong>Speed:</strong> Gobuster is significantly faster (written in Go vs C)</li>
                                <li><strong>Threading:</strong> Gobuster has better multi-threading support</li>
                                <li><strong>Simplicity:</strong> Gobuster has cleaner, more intuitive syntax</li>
                                <li><strong>Maintenance:</strong> Gobuster is actively maintained; Dirb is legacy</li>
                                <li><strong>When to use Dirb:</strong> If you need recursive scanning with specific depth control</li>
                            </ul>

                            <h3>Gobuster vs. DirBuster</h3>
                            <ul>
                                <li><strong>Interface:</strong> Gobuster is CLI-only; DirBuster has a GUI</li>
                                <li><strong>Speed:</strong> Gobuster is faster and more efficient</li>
                                <li><strong>Maintenance:</strong> DirBuster is no longer actively developed</li>
                                <li><strong>When to use DirBuster:</strong> If you absolutely need a GUI or are teaching beginners</li>
                            </ul>

                            <h3>Gobuster vs. Feroxbuster</h3>
                            <ul>
                                <li><strong>Features:</strong> Feroxbuster has more bells and whistles (auto-recursive, filtering, etc.)</li>
                                <li><strong>Speed:</strong> Both are very fast (both written in modern languages - Go vs Rust)</li>
                                <li><strong>Simplicity:</strong> Gobuster is simpler and easier to learn</li>
                                <li><strong>When to use Feroxbuster:</strong> For advanced filtering, auto-recursion, or more complex scans</li>
                            </ul>

                            <h3>Gobuster vs. ffuf</h3>
                            <ul>
                                <li><strong>Purpose:</strong> ffuf is a general-purpose fuzzer; Gobuster is specialized</li>
                                <li><strong>Flexibility:</strong> ffuf can fuzz any part of a request; Gobuster is focused on dirs/DNS</li>
                                <li><strong>Ease of Use:</strong> Gobuster is simpler for basic enumeration</li>
                                <li><strong>When to use ffuf:</strong> For parameter fuzzing, complex matching, or advanced scenarios</li>
                            </ul>

                            <div class="info-box success">
                                <strong>The Professional's Choice</strong>
                                <p>Most modern penetration testers use Gobuster for directory/DNS enumeration due to its speed, simplicity, and reliability. Keep it in your core toolkit.</p>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Legal and Ethical Considerations</h2>

                            <div class="info-box danger">
                                <strong>CRITICAL: AUTHORIZED TESTING ONLY</strong>
                                <p>Using Gobuster or any enumeration tool against systems you don't own or have explicit written permission to test is <strong>ILLEGAL</strong> and can result in criminal prosecution under laws like the Computer Fraud and Abuse Act (CFAA) and similar laws worldwide.</p>
                            </div>

                            <h3>Legal Testing Scenarios</h3>
                            <ul>
                                <li><strong>Your Own Systems:</strong> Servers, websites, and applications you own</li>
                                <li><strong>Authorized Penetration Tests:</strong> With signed contracts and defined scope</li>
                                <li><strong>Bug Bounty Programs:</strong> Following the program's rules and scope exactly</li>
                                <li><strong>Capture The Flag (CTF):</strong> HackTheBox, TryHackMe, PentesterLab, etc.</li>
                                <li><strong>Educational Labs:</strong> DVWA, WebGoat, Juice Shop, and this training environment</li>
                            </ul>

                            <h3>Responsible Enumeration</h3>
                            <ul>
                                <li><strong>Respect Rate Limits:</strong> Use <code>--delay</code> to avoid DoS-like traffic</li>
                                <li><strong>Stay in Scope:</strong> Only test the URLs/domains explicitly authorized</li>
                                <li><strong>Reduce Thread Count:</strong> Lower threads on production systems to minimize impact</li>
                                <li><strong>Time Your Scans:</strong> Run intensive scans during low-traffic periods</li>
                                <li><strong>Document Everything:</strong> Keep your authorization and scope documents accessible</li>
                            </ul>

                            <h3>When Things Go Wrong</h3>
                            <ul>
                                <li>If you accidentally scan the wrong target, STOP IMMEDIATELY</li>
                                <li>Notify the system owner if you cause any issues</li>
                                <li>Never hide or destroy logs - be transparent</li>
                                <li>Review your scope documents before every scan</li>
                            </ul>

                            <div class="info-box warning">
                                <strong>Professional Ethics</strong>
                                <p>As security professionals, our goal is to improve security, not exploit it. Always operate with integrity, respect boundaries, and use your skills to make systems safer.</p>
                            </div>
                        </div>

                        <div class="learn-section">
                            <h2>Next Steps</h2>
                            <p>Ready to start practicing? Here's your learning path:</p>

                            <ol>
                                <li><strong>Explore the Enumeration Lab:</strong> Practice Gobuster commands in a safe simulated environment</li>
                                <li><strong>Complete the Challenges:</strong> 10 auto-graded exercises to test your knowledge</li>
                                <li><strong>Reference Tab:</strong> Quick reference for commands, options, and status codes</li>
                                <li><strong>Install Gobuster:</strong> <code>sudo apt install gobuster</code> on Kali Linux</li>
                                <li><strong>Practice on Legal Targets:</strong> TryHackMe, HackTheBox, or your own web server</li>
                            </ol>

                            <div class="info-box success">
                                <strong>You're Ready!</strong>
                                <p>Head to the <strong>Enumeration Lab</strong> tab to start practicing commands, or jump to <strong>Challenges</strong> to test your skills!</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ENUMERATION LAB TAB -->
                <div id="enum-lab" class="tab-content">
                    <div class="enum-lab">
                        <div class="toolbar">
                            <label>Target:</label>
                            <select id="targetSelect" onchange="loadTarget()">
                                <option value="corporate">Corporate Website (corp.example.com)</option>
                                <option value="ecommerce">E-Commerce Site (shop.vulnerable.com)</option>
                                <option value="api">API Server (api.techcorp.io)</option>
                                <option value="forum">Community Forum (forum.webdev.net)</option>
                                <option value="banking">Banking Portal (secure-bank.com)</option>
                                <option value="blog">Personal Blog (myblog.example.org)</option>
                            </select>
                        </div>

                        <div class="terminal-container">
                            <div class="terminal-header">
                                Terminal - Simulated Gobuster Environment
                            </div>
                            <div class="terminal-output" id="terminalOutput">
                                <div class="output-line output-info">================================================</div>
                                <div class="output-line output-info">  Gobuster Training Lab - Simulation Environment</div>
                                <div class="output-line output-info">================================================</div>
                                <div class="output-line">Type 'help' for available commands</div>
                                <div class="output-line">Press TAB for autocomplete suggestions</div>
                                <div class="output-line">Example: <span class="output-command">gobuster dir -u http://target.com -w /usr/share/wordlists/dirb/common.txt</span></div>
                                <div class="output-line" style="margin-top: 10px;"></div>
                            </div>
                            <div class="terminal-input-container autocomplete-container">
                                <span class="terminal-prompt">root@kali:~#</span>
                                <input type="text"
                                       class="terminal-input"
                                       id="terminalInput"
                                       placeholder="Type gobuster command..."
                                       autocomplete="off"
                                       onkeydown="handleKeyDown(event)"
                                       oninput="handleInput(event)">
                                <div class="autocomplete-suggestions" id="autocompleteSuggestions"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- CHALLENGES TAB -->
                <div id="challenges" class="tab-content">
                    <div class="challenges-container" id="challengesList">
                        <!-- Challenges will be rendered here by JavaScript -->
                    </div>
                </div>

                <!-- REFERENCE TAB -->
                <div id="reference" class="tab-content">
                    <div class="reference-container">
                        <div class="ref-category">
                            <h3>Gobuster Modes</h3>
                            <table class="ref-table">
                                <thead>
                                    <tr>
                                        <th>Mode</th>
                                        <th>Purpose</th>
                                        <th>Example</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>dir</td>
                                        <td>Directory/file brute-forcing</td>
                                        <td>gobuster dir -u http://target.com -w wordlist.txt</td>
                                    </tr>
                                    <tr>
                                        <td>dns</td>
                                        <td>Subdomain enumeration</td>
                                        <td>gobuster dns -d example.com -w subdomains.txt</td>
                                    </tr>
                                    <tr>
                                        <td>vhost</td>
                                        <td>Virtual host discovery</td>
                                        <td>gobuster vhost -u http://target.com -w vhosts.txt</td>
                                    </tr>
                                    <tr>
                                        <td>fuzz</td>
                                        <td>Generic fuzzing with FUZZ keyword</td>
                                        <td>gobuster fuzz -u http://target.com/FUZZ -w wordlist.txt</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="ref-category">
                            <h3>Essential Flags</h3>
                            <table class="ref-table">
                                <thead>
                                    <tr>
                                        <th>Flag</th>
                                        <th>Description</th>
                                        <th>Example</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>-u URL</td>
                                        <td>Target URL (dir/vhost/fuzz)</td>
                                        <td>-u http://example.com</td>
                                    </tr>
                                    <tr>
                                        <td>-d DOMAIN</td>
                                        <td>Target domain (dns)</td>
                                        <td>-d example.com</td>
                                    </tr>
                                    <tr>
                                        <td>-w WORDLIST</td>
                                        <td>Wordlist path</td>
                                        <td>-w /usr/share/wordlists/dirb/common.txt</td>
                                    </tr>
                                    <tr>
                                        <td>-t THREADS</td>
                                        <td>Number of threads</td>
                                        <td>-t 50</td>
                                    </tr>
                                    <tr>
                                        <td>-x EXTENSIONS</td>
                                        <td>File extensions (dir mode)</td>
                                        <td>-x php,html,txt,js</td>
                                    </tr>
                                    <tr>
                                        <td>-s CODES</td>
                                        <td>Positive status codes</td>
                                        <td>-s "200,204,301,302,307,401,403"</td>
                                    </tr>
                                    <tr>
                                        <td>-b CODES</td>
                                        <td>Negative status codes</td>
                                        <td>-b "404,400"</td>
                                    </tr>
                                    <tr>
                                        <td>-o OUTPUT</td>
                                        <td>Save output to file</td>
                                        <td>-o results.txt</td>
                                    </tr>
                                    <tr>
                                        <td>-k</td>
                                        <td>Skip SSL verification</td>
                                        <td>-k</td>
                                    </tr>
                                    <tr>
                                        <td>-r</td>
                                        <td>Follow redirects</td>
                                        <td>-r</td>
                                    </tr>
                                    <tr>
                                        <td>-c COOKIE</td>
                                        <td>Use cookie for requests</td>
                                        <td>-c "session=abc123"</td>
                                    </tr>
                                    <tr>
                                        <td>-H HEADER</td>
                                        <td>Add custom header</td>
                                        <td>-H "Authorization: Bearer token"</td>
                                    </tr>
                                    <tr>
                                        <td>-a AGENT</td>
                                        <td>Custom User-Agent</td>
                                        <td>-a "Mozilla/5.0"</td>
                                    </tr>
                                    <tr>
                                        <td>-U USERNAME</td>
                                        <td>Username for Basic Auth</td>
                                        <td>-U admin</td>
                                    </tr>
                                    <tr>
                                        <td>-P PASSWORD</td>
                                        <td>Password for Basic Auth</td>
                                        <td>-P password123</td>
                                    </tr>
                                    <tr>
                                        <td>--delay DURATION</td>
                                        <td>Delay between requests</td>
                                        <td>--delay 100ms</td>
                                    </tr>
                                    <tr>
                                        <td>--timeout DURATION</td>
                                        <td>HTTP timeout</td>
                                        <td>--timeout 10s</td>
                                    </tr>
                                    <tr>
                                        <td>-q</td>
                                        <td>Quiet mode</td>
                                        <td>-q</td>
                                    </tr>
                                    <tr>
                                        <td>-v</td>
                                        <td>Verbose mode</td>
                                        <td>-v</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="ref-category">
                            <h3>HTTP Status Codes</h3>
                            <table class="ref-table">
                                <thead>
                                    <tr>
                                        <th>Code</th>
                                        <th>Meaning</th>
                                        <th>Significance for Enumeration</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>200</td>
                                        <td>OK</td>
                                        <td>Resource found and accessible - investigate further</td>
                                    </tr>
                                    <tr>
                                        <td>201</td>
                                        <td>Created</td>
                                        <td>Resource was created - might indicate API endpoint</td>
                                    </tr>
                                    <tr>
                                        <td>204</td>
                                        <td>No Content</td>
                                        <td>Request succeeded but no content - valid endpoint</td>
                                    </tr>
                                    <tr>
                                        <td>301</td>
                                        <td>Moved Permanently</td>
                                        <td>Follow redirect to find new location</td>
                                    </tr>
                                    <tr>
                                        <td>302</td>
                                        <td>Found (Temporary Redirect)</td>
                                        <td>May indicate login required or conditional access</td>
                                    </tr>
                                    <tr>
                                        <td>307</td>
                                        <td>Temporary Redirect</td>
                                        <td>Similar to 302, preserves request method</td>
                                    </tr>
                                    <tr>
                                        <td>400</td>
                                        <td>Bad Request</td>
                                        <td>Malformed request - try different format</td>
                                    </tr>
                                    <tr>
                                        <td>401</td>
                                        <td>Unauthorized</td>
                                        <td>Authentication required - resource exists!</td>
                                    </tr>
                                    <tr>
                                        <td>403</td>
                                        <td>Forbidden</td>
                                        <td>Access denied - resource exists, try to bypass</td>
                                    </tr>
                                    <tr>
                                        <td>404</td>
                                        <td>Not Found</td>
                                        <td>Resource doesn't exist - typically filtered out</td>
                                    </tr>
                                    <tr>
                                        <td>405</td>
                                        <td>Method Not Allowed</td>
                                        <td>Wrong HTTP method - try GET/POST/PUT/DELETE</td>
                                    </tr>
                                    <tr>
                                        <td>500</td>
                                        <td>Internal Server Error</td>
                                        <td>Server error - may reveal info in response</td>
                                    </tr>
                                    <tr>
                                        <td>502</td>
                                        <td>Bad Gateway</td>
                                        <td>Proxy/gateway error - backend may be down</td>
                                    </tr>
                                    <tr>
                                        <td>503</td>
                                        <td>Service Unavailable</td>
                                        <td>Temporarily unavailable - try again later</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="ref-category">
                            <h3>Common Wordlists</h3>
                            <table class="ref-table">
                                <thead>
                                    <tr>
                                        <th>Wordlist</th>
                                        <th>Size</th>
                                        <th>Use Case</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>/usr/share/wordlists/dirb/common.txt</td>
                                        <td>4,614</td>
                                        <td>Quick initial scans, common directories</td>
                                    </tr>
                                    <tr>
                                        <td>/usr/share/wordlists/dirb/big.txt</td>
                                        <td>20,469</td>
                                        <td>More comprehensive web content</td>
                                    </tr>
                                    <tr>
                                        <td>/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</td>
                                        <td>220,560</td>
                                        <td>Thorough directory enumeration</td>
                                    </tr>
                                    <tr>
                                        <td>/usr/share/seclists/Discovery/Web-Content/common.txt</td>
                                        <td>4,713</td>
                                        <td>General web content discovery</td>
                                    </tr>
                                    <tr>
                                        <td>/usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt</td>
                                        <td>62,284</td>
                                        <td>Comprehensive directory scanning</td>
                                    </tr>
                                    <tr>
                                        <td>/usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt</td>
                                        <td>5,000</td>
                                        <td>Popular subdomain names</td>
                                    </tr>
                                    <tr>
                                        <td>/usr/share/wordlists/dnsmap.txt</td>
                                        <td>~1,000</td>
                                        <td>Common subdomain patterns</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="ref-category">
                            <h3>Quick Command Examples</h3>
                            <table class="ref-table">
                                <thead>
                                    <tr>
                                        <th>Scenario</th>
                                        <th>Command</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Basic directory scan</td>
                                        <td>gobuster dir -u http://target.com -w common.txt</td>
                                    </tr>
                                    <tr>
                                        <td>Scan with file extensions</td>
                                        <td>gobuster dir -u http://target.com -w common.txt -x php,html,txt</td>
                                    </tr>
                                    <tr>
                                        <td>Fast scan with 50 threads</td>
                                        <td>gobuster dir -u http://target.com -w common.txt -t 50</td>
                                    </tr>
                                    <tr>
                                        <td>Scan with output to file</td>
                                        <td>gobuster dir -u http://target.com -w common.txt -o results.txt</td>
                                    </tr>
                                    <tr>
                                        <td>Subdomain enumeration</td>
                                        <td>gobuster dns -d example.com -w subdomains.txt</td>
                                    </tr>
                                    <tr>
                                        <td>Virtual host discovery</td>
                                        <td>gobuster vhost -u http://target.com -w vhosts.txt</td>
                                    </tr>
                                    <tr>
                                        <td>Skip SSL verification</td>
                                        <td>gobuster dir -u https://target.com -w common.txt -k</td>
                                    </tr>
                                    <tr>
                                        <td>With authentication</td>
                                        <td>gobuster dir -u http://target.com -w common.txt -U admin -P pass123</td>
                                    </tr>
                                    <tr>
                                        <td>Custom User-Agent</td>
                                        <td>gobuster dir -u http://target.com -w common.txt -a "Mozilla/5.0"</td>
                                    </tr>
                                    <tr>
                                        <td>With cookie</td>
                                        <td>gobuster dir -u http://target.com -w common.txt -c "session=abc123"</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- SETTINGS TAB -->
                <div id="settings" class="tab-content">
                    <div class="settings-panel">
                        <div class="settings-section">
                            <h3>Export Progress</h3>
                            <p style="color: #888; margin-bottom: 15px;">Save your challenge progress and command history to continue later.</p>
                            <div class="settings-row">
                                <label>Export your progress data</label>
                                <button class="settings-btn" onclick="exportProgress()">Export to File</button>
                            </div>
                        </div>

                        <div class="settings-section">
                            <h3>Import Progress</h3>
                            <p style="color: #888; margin-bottom: 15px;">Load previously saved progress.</p>
                            <div class="settings-row">
                                <label>Import progress data</label>
                                <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importProgress(event)">
                                <button class="settings-btn secondary" onclick="document.getElementById('importFile').click()">Import from File</button>
                            </div>
                        </div>

                        <div class="settings-section">
                            <h3>Reset Progress</h3>
                            <p style="color: #888; margin-bottom: 15px;">Clear all challenge progress and command history.</p>
                            <div class="settings-row">
                                <label>This cannot be undone!</label>
                                <button class="settings-btn" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);" onclick="resetProgress()">Reset All Progress</button>
                            </div>
                        </div>

                        <div class="settings-section">
                            <h3>Statistics</h3>
                            <div class="settings-row">
                                <label>Total Challenges Completed</label>
                                <span id="statsCompleted" style="color: #22c55e; font-weight: 600;">0</span>
                            </div>
                            <div class="settings-row">
                                <label>Total Points Earned</label>
                                <span id="statsPoints" style="color: #fbbf24; font-weight: 600;">0</span>
                            </div>
                            <div class="settings-row">
                                <label>Commands Executed</label>
                                <span id="statsCommands" style="color: #06b6d4; font-weight: 600;">0</span>
                            </div>
                            <div class="settings-row">
                                <label>Directories Discovered</label>
                                <span id="statsDiscovered" style="color: #a78bfa; font-weight: 600;">0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SIDEBAR -->
            <div class="sidebar" id="sidebar">
                <h3>Learning Panel</h3>
                <div id="learningContent">
                    <h4>Welcome to Gobuster Training!</h4>
                    <p>This interactive lab will teach you how to use Gobuster for directory enumeration, DNS brute-forcing, and web reconnaissance.</p>

                    <div class="tip-box">
                        <strong>Getting Started</strong>
                        <p>Start with the <strong>Learn</strong> tab for fundamentals, then practice commands in the <strong>Enumeration Lab</strong>!</p>
                    </div>

                    <div class="progress-summary">
                        <h4 style="color: #06b6d4; margin-bottom: 10px;">Your Progress</h4>
                        <div class="progress-item">
                            <span>Challenges:</span>
                            <span class="progress-value" id="sidebarProgress">0/10</span>
                        </div>
                        <div class="progress-item">
                            <span>Points:</span>
                            <span class="progress-value" id="sidebarPoints">0/200</span>
                        </div>
                    </div>

                    <h4>Quick Targets</h4>
                    <p>Try these scenarios:</p>
                    <div class="quick-filters">
                        <button class="quick-filter-btn" onclick="switchTab('enum-lab'); document.getElementById('targetSelect').value='corporate'; loadTarget();">Corporate Site</button>
                        <button class="quick-filter-btn" onclick="switchTab('enum-lab'); document.getElementById('targetSelect').value='ecommerce'; loadTarget();">E-Commerce</button>
                        <button class="quick-filter-btn" onclick="switchTab('enum-lab'); document.getElementById('targetSelect').value='api'; loadTarget();">API Server</button>
                        <button class="quick-filter-btn" onclick="switchTab('enum-lab'); document.getElementById('targetSelect').value='banking'; loadTarget();">Banking Portal</button>
                    </div>

                    <div class="tip-box" style="margin-top: 15px;">
                        <strong>Remember</strong>
                        <p>Only test systems you own or have explicit written permission to test. Unauthorized enumeration is illegal!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== STATE MANAGEMENT ====================
        let commandHistory = [];
        let historyIndex = -1;
        let commandCount = 0;
        let directoriesDiscovered = 0;
        let currentTarget = 'corporate';
        let completedChallenges = new Set();
        let totalPoints = 0;
        let autocompleteIndex = -1;

        // ==================== CHALLENGE DEFINITIONS ====================
        const challenges = [
            {
                id: 1,
                title: 'Identify the Mode',
                description: 'What Gobuster mode is used for directory and file enumeration?',
                hint: 'It\'s a 3-letter mode that stands for "directory"',
                points: 10,
                answer: 'dir',
                inputType: 'text'
            },
            {
                id: 2,
                title: 'Basic Syntax',
                description: 'Write a basic Gobuster command to scan http://example.com with wordlist.txt',
                hint: 'Format: gobuster [mode] -u [url] -w [wordlist]',
                points: 15,
                answer: 'gobuster dir -u http://example.com -w wordlist.txt',
                inputType: 'text'
            },
            {
                id: 3,
                title: 'File Extensions',
                description: 'What flag adds file extensions like .php and .html to the search?',
                hint: 'It\'s a single letter that comes before "tensions"',
                points: 15,
                answer: '-x',
                inputType: 'text'
            },
            {
                id: 4,
                title: 'Threading',
                description: 'What flag controls the number of concurrent threads?',
                hint: 'Think "threads" - starts with t',
                points: 10,
                answer: '-t',
                inputType: 'text'
            },
            {
                id: 5,
                title: 'Status Code Analysis',
                description: 'A 403 status code means access is forbidden, but what does it tell us about the resource?',
                hint: 'If access is forbidden, the resource must...',
                points: 20,
                answer: 'exist',
                inputType: 'text'
            },
            {
                id: 6,
                title: 'DNS Mode',
                description: 'What Gobuster mode is used for subdomain enumeration?',
                hint: 'It\'s the same as the protocol used for domain name resolution',
                points: 15,
                answer: 'dns',
                inputType: 'text'
            },
            {
                id: 7,
                title: 'Output to File',
                description: 'What flag saves Gobuster results to a file?',
                hint: 'Stands for "output"',
                points: 10,
                answer: '-o',
                inputType: 'text'
            },
            {
                id: 8,
                title: 'Wordlist Path',
                description: 'What is the default Kali Linux path for the dirb common.txt wordlist?',
                hint: '/usr/share/wordlists/dirb/...',
                points: 20,
                answer: '/usr/share/wordlists/dirb/common.txt',
                inputType: 'text'
            },
            {
                id: 9,
                title: 'Advanced Command',
                description: 'Write a Gobuster command for http://test.com with common.txt, 50 threads, and php,html extensions',
                hint: 'Combine: gobuster dir -u [url] -w [wordlist] -t [threads] -x [extensions]',
                points: 30,
                answer: 'gobuster dir -u http://test.com -w common.txt -t 50 -x php,html',
                inputType: 'text'
            },
            {
                id: 10,
                title: 'Subdomain Enumeration',
                description: 'Write a Gobuster DNS command to enumerate subdomains of example.com with subdomains.txt',
                hint: 'Format: gobuster dns -d [domain] -w [wordlist]',
                points: 25,
                answer: 'gobuster dns -d example.com -w subdomains.txt',
                inputType: 'text'
            }
        ];

        // ==================== TARGET DEFINITIONS ====================
        const targets = {
            corporate: {
                name: 'Corporate Website',
                url: 'http://corp.example.com',
                description: 'Large corporate website with multiple departments',
                directories: {
                    '/admin': { status: 403, size: 312, time: 23 },
                    '/about': { status: 200, size: 4523, time: 45 },
                    '/contact': { status: 200, size: 2341, time: 38 },
                    '/careers': { status: 200, size: 6789, time: 52 },
                    '/login': { status: 200, size: 1234, time: 28 },
                    '/dashboard': { status: 401, size: 567, time: 31 },
                    '/uploads': { status: 403, size: 423, time: 19 },
                    '/backup': { status: 403, size: 234, time: 21 },
                    '/api': { status: 200, size: 8901, time: 67 },
                    '/assets': { status: 301, size: 178, time: 15 },
                    '/images': { status: 301, size: 178, time: 17 },
                    '/js': { status: 301, size: 178, time: 14 },
                    '/css': { status: 301, size: 178, time: 16 },
                    '/docs': { status: 200, size: 3456, time: 43 },
                    '/reports': { status: 403, size: 289, time: 26 }
                }
            },
            ecommerce: {
                name: 'E-Commerce Site',
                url: 'http://shop.vulnerable.com',
                description: 'Online shopping platform with product catalog',
                directories: {
                    '/products': { status: 200, size: 8234, time: 78 },
                    '/cart': { status: 200, size: 2345, time: 34 },
                    '/checkout': { status: 200, size: 4567, time: 56 },
                    '/admin': { status: 403, size: 312, time: 23 },
                    '/login': { status: 200, size: 1789, time: 29 },
                    '/register': { status: 200, size: 2123, time: 32 },
                    '/search': { status: 200, size: 3456, time: 45 },
                    '/api': { status: 200, size: 7890, time: 67 },
                    '/orders': { status: 401, size: 456, time: 28 },
                    '/uploads': { status: 403, size: 234, time: 19 },
                    '/images': { status: 301, size: 178, time: 15 },
                    '/static': { status: 301, size: 178, time: 16 },
                    '/reviews': { status: 200, size: 5678, time: 54 },
                    '/wishlist': { status: 200, size: 1234, time: 31 },
                    '/.git': { status: 403, size: 189, time: 18 }
                }
            },
            api: {
                name: 'API Server',
                url: 'http://api.techcorp.io',
                description: 'RESTful API server with multiple endpoints',
                directories: {
                    '/v1': { status: 200, size: 456, time: 34 },
                    '/v2': { status: 200, size: 567, time: 38 },
                    '/users': { status: 200, size: 3456, time: 45 },
                    '/auth': { status: 200, size: 1234, time: 28 },
                    '/login': { status: 200, size: 987, time: 25 },
                    '/register': { status: 200, size: 1123, time: 29 },
                    '/admin': { status: 403, size: 234, time: 21 },
                    '/docs': { status: 200, size: 8901, time: 78 },
                    '/swagger': { status: 200, size: 9876, time: 89 },
                    '/api-docs': { status: 200, size: 7654, time: 72 },
                    '/health': { status: 200, size: 123, time: 12 },
                    '/status': { status: 200, size: 234, time: 15 },
                    '/metrics': { status: 403, size: 189, time: 19 },
                    '/debug': { status: 403, size: 256, time: 22 },
                    '/.env': { status: 403, size: 145, time: 17 }
                }
            },
            forum: {
                name: 'Community Forum',
                url: 'http://forum.webdev.net',
                description: 'Discussion forum with user profiles and posts',
                directories: {
                    '/forum': { status: 200, size: 6789, time: 65 },
                    '/topics': { status: 200, size: 5678, time: 56 },
                    '/users': { status: 200, size: 4567, time: 48 },
                    '/profile': { status: 200, size: 3456, time: 38 },
                    '/login': { status: 200, size: 1234, time: 27 },
                    '/register': { status: 200, size: 1567, time: 31 },
                    '/admin': { status: 403, size: 312, time: 23 },
                    '/moderator': { status: 403, size: 278, time: 21 },
                    '/search': { status: 200, size: 2345, time: 35 },
                    '/messages': { status: 401, size: 456, time: 26 },
                    '/uploads': { status: 200, size: 789, time: 29 },
                    '/attachments': { status: 200, size: 890, time: 32 },
                    '/static': { status: 301, size: 178, time: 15 },
                    '/api': { status: 200, size: 4567, time: 47 },
                    '/backup': { status: 403, size: 234, time: 20 }
                }
            },
            banking: {
                name: 'Banking Portal',
                url: 'http://secure-bank.com',
                description: 'Secure banking application with account management',
                directories: {
                    '/login': { status: 200, size: 2345, time: 34 },
                    '/accounts': { status: 401, size: 456, time: 28 },
                    '/transfer': { status: 401, size: 567, time: 31 },
                    '/statements': { status: 401, size: 678, time: 33 },
                    '/admin': { status: 403, size: 312, time: 23 },
                    '/dashboard': { status: 401, size: 789, time: 35 },
                    '/api': { status: 401, size: 234, time: 26 },
                    '/help': { status: 200, size: 3456, time: 42 },
                    '/contact': { status: 200, size: 2345, time: 36 },
                    '/about': { status: 200, size: 4567, time: 48 },
                    '/security': { status: 200, size: 5678, time: 54 },
                    '/static': { status: 301, size: 178, time: 15 },
                    '/assets': { status: 301, size: 178, time: 16 },
                    '/backup': { status: 403, size: 234, time: 21 },
                    '/.git': { status: 403, size: 189, time: 18 }
                }
            },
            blog: {
                name: 'Personal Blog',
                url: 'http://myblog.example.org',
                description: 'Simple blog with posts and comments',
                directories: {
                    '/posts': { status: 200, size: 5678, time: 52 },
                    '/about': { status: 200, size: 2345, time: 34 },
                    '/contact': { status: 200, size: 1234, time: 28 },
                    '/admin': { status: 403, size: 312, time: 23 },
                    '/login': { status: 200, size: 1456, time: 29 },
                    '/wp-admin': { status: 301, size: 234, time: 25 },
                    '/wp-content': { status: 200, size: 789, time: 31 },
                    '/wp-includes': { status: 200, size: 890, time: 33 },
                    '/uploads': { status: 200, size: 678, time: 27 },
                    '/images': { status: 301, size: 178, time: 15 },
                    '/css': { status: 301, size: 178, time: 16 },
                    '/js': { status: 301, size: 178, time: 14 },
                    '/feed': { status: 200, size: 3456, time: 41 },
                    '/rss': { status: 200, size: 3234, time: 39 },
                    '/backup': { status: 403, size: 234, time: 20 }
                }
            }
        };

        // Autocomplete suggestions
        const autocompleteSuggestions = [
            'gobuster dir -u ',
            'gobuster dns -d ',
            'gobuster vhost -u ',
            'gobuster fuzz -u ',
            '-w /usr/share/wordlists/dirb/common.txt',
            '-w /usr/share/wordlists/dirb/big.txt',
            '-w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt',
            '-t 50',
            '-t 100',
            '-x php,html,txt',
            '-x php,html,txt,js,asp,aspx',
            '-o results.txt',
            '-k',
            '-r',
            '-v',
            '-q',
            'help',
            'clear'
        ];

        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', () => {
            loadProgress();
            renderChallenges();
            updateStats();
            updateSidebar();
            loadTarget();
        });

        // ==================== TAB SWITCHING ====================
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            document.querySelector(`[onclick="switchTab('${tabName}')"]`).classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // ==================== TARGET LOADING ====================
        function loadTarget() {
            const targetName = document.getElementById('targetSelect').value;
            currentTarget = targetName;
            const target = targets[targetName];

            appendOutput(`\n<span class="output-info">Target loaded: ${target.name}</span>`);
            appendOutput(`<span class="output-info">URL: ${target.url}</span>`);
            appendOutput(`<span class="output-info">Description: ${target.description}</span>`);
            appendOutput(`<span class="output-info">Type a Gobuster command to begin enumeration...</span>\n`);
        }

        // ==================== TERMINAL FUNCTIONS ====================
        function handleKeyDown(event) {
            const input = document.getElementById('terminalInput');
            const suggestions = document.getElementById('autocompleteSuggestions');

            if (event.key === 'Enter') {
                event.preventDefault();
                const command = input.value.trim();
                if (command) {
                    executeCommand(command);
                    commandHistory.unshift(command);
                    historyIndex = -1;
                    input.value = '';
                    suggestions.classList.remove('show');
                }
            } else if (event.key === 'ArrowUp') {
                event.preventDefault();
                if (commandHistory.length > 0) {
                    historyIndex = Math.min(historyIndex + 1, commandHistory.length - 1);
                    input.value = commandHistory[historyIndex];
                }
            } else if (event.key === 'ArrowDown') {
                event.preventDefault();
                if (historyIndex > 0) {
                    historyIndex--;
                    input.value = commandHistory[historyIndex];
                } else {
                    historyIndex = -1;
                    input.value = '';
                }
            } else if (event.key === 'Tab') {
                event.preventDefault();
                const currentSuggestions = Array.from(suggestions.children);
                if (currentSuggestions.length > 0) {
                    if (autocompleteIndex === -1) {
                        autocompleteIndex = 0;
                    } else {
                        currentSuggestions[autocompleteIndex].classList.remove('selected');
                        autocompleteIndex = (autocompleteIndex + 1) % currentSuggestions.length;
                    }
                    currentSuggestions[autocompleteIndex].classList.add('selected');
                    input.value = currentSuggestions[autocompleteIndex].textContent;
                }
            } else if (event.key === 'Escape') {
                suggestions.classList.remove('show');
                autocompleteIndex = -1;
            }
        }

        function handleInput(event) {
            const input = event.target.value;
            const suggestions = document.getElementById('autocompleteSuggestions');

            if (input.length < 2) {
                suggestions.classList.remove('show');
                return;
            }

            const matches = autocompleteSuggestions.filter(s =>
                s.toLowerCase().includes(input.toLowerCase())
            );

            if (matches.length > 0) {
                suggestions.innerHTML = matches.map(match =>
                    `<div class="autocomplete-item" onclick="selectAutocomplete('${match.replace(/'/g, "\\'")}')">${match}</div>`
                ).join('');
                suggestions.classList.add('show');
                autocompleteIndex = -1;
            } else {
                suggestions.classList.remove('show');
            }
        }

        function selectAutocomplete(text) {
            document.getElementById('terminalInput').value = text;
            document.getElementById('autocompleteSuggestions').classList.remove('show');
            document.getElementById('terminalInput').focus();
        }

        function appendOutput(html) {
            const output = document.getElementById('terminalOutput');
            output.innerHTML += `<div class="output-line">${html}</div>`;
            output.scrollTop = output.scrollHeight;
        }

        function executeCommand(command) {
            commandCount++;
            appendOutput(`<span class="output-command">${command}</span>`);

            if (command === 'help') {
                showHelp();
            } else if (command === 'clear') {
                document.getElementById('terminalOutput').innerHTML = '';
            } else if (command.startsWith('gobuster')) {
                executeGobuster(command);
            } else {
                appendOutput(`<span class="output-error">Command not found: ${command}</span>`);
                appendOutput(`<span class="output-info">Try 'help' for available commands</span>`);
            }

            updateStats();
            saveProgress();
        }

        function showHelp() {
            appendOutput(`<span class="output-info">========================================</span>`);
            appendOutput(`<span class="output-info">Available Commands:</span>`);
            appendOutput(`<span class="output-info">========================================</span>`);
            appendOutput(`<span class="output-found">gobuster dir -u [URL] -w [WORDLIST]</span> - Directory enumeration`);
            appendOutput(`<span class="output-found">gobuster dns -d [DOMAIN] -w [WORDLIST]</span> - DNS subdomain enumeration`);
            appendOutput(`<span class="output-found">gobuster vhost -u [URL] -w [WORDLIST]</span> - Virtual host enumeration`);
            appendOutput(`<span class="output-found">clear</span> - Clear terminal output`);
            appendOutput(`<span class="output-found">help</span> - Show this help message`);
            appendOutput(`<span class="output-info">========================================</span>`);
            appendOutput(`<span class="output-info">Example: gobuster dir -u http://target.com -w common.txt</span>`);
        }

        function executeGobuster(command) {
            // Parse command
            const parts = command.split(/\s+/);

            if (parts.length < 2) {
                appendOutput(`<span class="output-error">Error: Missing mode. Use: gobuster [dir|dns|vhost|fuzz]</span>`);
                return;
            }

            const mode = parts[1];

            if (!['dir', 'dns', 'vhost', 'fuzz'].includes(mode)) {
                appendOutput(`<span class="output-error">Error: Invalid mode '${mode}'. Valid modes: dir, dns, vhost, fuzz</span>`);
                return;
            }

            // Check for required flags
            const hasUrl = command.includes('-u ');
            const hasDomain = command.includes('-d ');
            const hasWordlist = command.includes('-w ');

            if (mode === 'dir' || mode === 'vhost' || mode === 'fuzz') {
                if (!hasUrl) {
                    appendOutput(`<span class="output-error">Error: -u flag (URL) is required for ${mode} mode</span>`);
                    return;
                }
            } else if (mode === 'dns') {
                if (!hasDomain) {
                    appendOutput(`<span class="output-error">Error: -d flag (domain) is required for dns mode</span>`);
                    return;
                }
            }

            if (!hasWordlist) {
                appendOutput(`<span class="output-error">Error: -w flag (wordlist) is required</span>`);
                return;
            }

            // Simulate gobuster output
            if (mode === 'dir') {
                simulateDirectoryScan(command);
            } else if (mode === 'dns') {
                simulateDNSScan(command);
            } else if (mode === 'vhost') {
                simulateVhostScan(command);
            } else if (mode === 'fuzz') {
                simulateFuzzScan(command);
            }
        }

        function simulateDirectoryScan(command) {
            const target = targets[currentTarget];

            appendOutput(`<span class="output-info">===============================================================</span>`);
            appendOutput(`<span class="output-info">Gobuster v3.6</span>`);
            appendOutput(`<span class="output-info">by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)</span>`);
            appendOutput(`<span class="output-info">===============================================================</span>`);
            appendOutput(`<span class="output-info">[+] Url:                     ${target.url}</span>`);
            appendOutput(`<span class="output-info">[+] Method:                  GET</span>`);
            appendOutput(`<span class="output-info">[+] Threads:                 ${command.includes('-t ') ? command.match(/-t\s+(\d+)/)[1] : '10'}</span>`);
            appendOutput(`<span class="output-info">[+] Wordlist:                ${command.match(/-w\s+([^\s]+)/)[1]}</span>`);
            appendOutput(`<span class="output-info">[+] Negative Status codes:   404</span>`);
            appendOutput(`<span class="output-info">[+] User Agent:              gobuster/3.6</span>`);
            appendOutput(`<span class="output-info">[+] Timeout:                 10s</span>`);
            appendOutput(`<span class="output-info">===============================================================</span>`);
            appendOutput(`<span class="output-info">Starting gobuster in directory enumeration mode</span>`);
            appendOutput(`<span class="output-info">===============================================================</span>`);

            // Simulate progress
            let count = 0;
            for (const [path, info] of Object.entries(target.directories)) {
                const statusClass = `output-status-${info.status}`;
                const statusText = info.status === 200 ? 'Found' :
                                 info.status === 301 || info.status === 302 ? 'Redirect' :
                                 info.status === 401 ? 'Unauthorized' :
                                 info.status === 403 ? 'Forbidden' : 'Status';

                appendOutput(`<span class="${statusClass}">${path}</span> (Status: <span class="${statusClass}">${info.status}</span>) [Size: ${info.size}] [Time: ${info.time}ms]`);
                count++;
                directoriesDiscovered++;
            }

            appendOutput(`<span class="output-info">===============================================================</span>`);
            appendOutput(`<span class="output-info">Finished</span>`);
            appendOutput(`<span class="output-info">===============================================================</span>`);
            appendOutput(`<span class="output-found">Found ${count} results!</span>\n`);

            updateStats();
        }

        function simulateDNSScan(command) {
            const subdomains = ['www', 'mail', 'ftp', 'admin', 'dev', 'staging', 'api', 'test', 'portal', 'vpn'];
            const domain = command.match(/-d\s+([^\s]+)/)[1];

            appendOutput(`<span class="output-info">===============================================================</span>`);
            appendOutput(`<span class="output-info">Gobuster v3.6</span>`);
            appendOutput(`<span class="output-info">by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)</span>`);
            appendOutput(`<span class="output-info">===============================================================</span>`);
            appendOutput(`<span class="output-info">[+] Domain:                  ${domain}</span>`);
            appendOutput(`<span class="output-info">[+] Threads:                 ${command.includes('-t ') ? command.match(/-t\s+(\d+)/)[1] : '10'}</span>`);
            appendOutput(`<span class="output-info">[+] Wordlist:                ${command.match(/-w\s+([^\s]+)/)[1]}</span>`);
            appendOutput(`<span class="output-info">===============================================================</span>`);
            appendOutput(`<span class="output-info">Starting gobuster in DNS enumeration mode</span>`);
            appendOutput(`<span class="output-info">===============================================================</span>`);

            let count = 0;
            subdomains.forEach(sub => {
                const ip = `${Math.floor(Math.random() * 256)}.${Math.floor(Math.random() * 256)}.${Math.floor(Math.random() * 256)}.${Math.floor(Math.random() * 256)}`;
                appendOutput(`<span class="output-found">Found: ${sub}.${domain}</span> (IP: ${ip})`);
                count++;
                directoriesDiscovered++;
            });

            appendOutput(`<span class="output-info">===============================================================</span>`);
            appendOutput(`<span class="output-info">Finished</span>`);
            appendOutput(`<span class="output-info">===============================================================</span>`);
            appendOutput(`<span class="output-found">Found ${count} subdomains!</span>\n`);

            updateStats();
        }

        function simulateVhostScan(command) {
            const vhosts = ['admin', 'internal', 'staging', 'dev', 'test'];
            const url = command.match(/-u\s+([^\s]+)/)[1];

            appendOutput(`<span class="output-info">===============================================================</span>`);
            appendOutput(`<span class="output-info">Gobuster v3.6</span>`);
            appendOutput(`<span class="output-info">===============================================================</span>`);
            appendOutput(`<span class="output-info">[+] Url:                     ${url}</span>`);
            appendOutput(`<span class="output-info">[+] Method:                  GET</span>`);
            appendOutput(`<span class="output-info">[+] Threads:                 ${command.includes('-t ') ? command.match(/-t\s+(\d+)/)[1] : '10'}</span>`);
            appendOutput(`<span class="output-info">[+] Wordlist:                ${command.match(/-w\s+([^\s]+)/)[1]}</span>`);
            appendOutput(`<span class="output-info">===============================================================</span>`);
            appendOutput(`<span class="output-info">Starting gobuster in vhost enumeration mode</span>`);
            appendOutput(`<span class="output-info">===============================================================</span>`);

            let count = 0;
            vhosts.forEach(vhost => {
                const status = [200, 301, 403][Math.floor(Math.random() * 3)];
                const statusClass = `output-status-${status}`;
                appendOutput(`<span class="output-found">Found: ${vhost}.${url.replace(/https?:\/\//, '')}</span> (Status: <span class="${statusClass}">${status}</span>)`);
                count++;
                directoriesDiscovered++;
            });

            appendOutput(`<span class="output-info">===============================================================</span>`);
            appendOutput(`<span class="output-info">Finished</span>`);
            appendOutput(`<span class="output-info">===============================================================</span>`);
            appendOutput(`<span class="output-found">Found ${count} virtual hosts!</span>\n`);

            updateStats();
        }

        function simulateFuzzScan(command) {
            appendOutput(`<span class="output-info">===============================================================</span>`);
            appendOutput(`<span class="output-info">Gobuster v3.6 - Fuzz Mode</span>`);
            appendOutput(`<span class="output-info">===============================================================</span>`);
            appendOutput(`<span class="output-info">[+] Starting fuzzing operation...</span>`);

            for (let i = 1; i <= 5; i++) {
                const status = [200, 403, 404][Math.floor(Math.random() * 3)];
                const statusClass = `output-status-${status}`;
                appendOutput(`<span class="${statusClass}">FUZZ value: test${i}</span> (Status: <span class="${statusClass}">${status}</span>)`);
                directoriesDiscovered++;
            }

            appendOutput(`<span class="output-info">===============================================================</span>`);
            appendOutput(`<span class="output-info">Finished fuzzing</span>`);
            appendOutput(`<span class="output-info">===============================================================</span>\n`);

            updateStats();
        }

        // ==================== CHALLENGES FUNCTIONS ====================
        function renderChallenges() {
            const container = document.getElementById('challengesList');

            container.innerHTML = challenges.map(challenge => {
                const isCompleted = completedChallenges.has(challenge.id);

                return `
                    <div class="challenge-card ${isCompleted ? 'completed' : ''}" id="challenge-${challenge.id}">
                        <div class="challenge-header">
                            <div class="challenge-title">Challenge ${challenge.id}: ${challenge.title}</div>
                            <div class="challenge-points">${challenge.points} pts</div>
                        </div>
                        <div class="challenge-desc">${challenge.description}</div>

                        ${!isCompleted ? `
                            <input type="text"
                                   class="challenge-input"
                                   id="answer-${challenge.id}"
                                   placeholder="Enter your answer..."
                                   onkeypress="if(event.key==='Enter') checkChallenge(${challenge.id})">

                            <div class="challenge-status">
                                <button class="submit-btn" onclick="checkChallenge(${challenge.id})">Submit Answer</button>
                                <button class="hint-btn" onclick="toggleHint(${challenge.id})">Show Hint</button>
                            </div>

                            <div class="hint-text" id="hint-${challenge.id}">
                                üí° ${challenge.hint}
                            </div>
                        ` : `
                            <div class="challenge-status">
                                <span class="status-badge status-complete">‚úì Completed</span>
                            </div>
                        `}
                    </div>
                `;
            }).join('');
        }

        function toggleHint(challengeId) {
            const hint = document.getElementById(`hint-${challengeId}`);
            hint.classList.toggle('show');
        }

        function checkChallenge(challengeId) {
            const challenge = challenges.find(c => c.id === challengeId);
            const userAnswer = document.getElementById(`answer-${challengeId}`).value.trim();

            if (!userAnswer) {
                alert('Please enter an answer first!');
                return;
            }

            // Normalize answers for comparison
            const normalizedUserAnswer = userAnswer.toLowerCase().replace(/\s+/g, ' ');
            const normalizedCorrectAnswer = challenge.answer.toLowerCase().replace(/\s+/g, ' ');

            const isCorrect = normalizedUserAnswer === normalizedCorrectAnswer;

            if (isCorrect) {
                completedChallenges.add(challengeId);
                totalPoints += challenge.points;

                alert(`‚úì Correct! You earned ${challenge.points} points!\n\n${getSuccessMessage(challengeId)}`);

                renderChallenges();
                updateStats();
                updateSidebar();
                saveProgress();
            } else {
                alert('‚úó Incorrect. Try again!\n\nHint: ' + challenge.hint);
            }
        }

        function getSuccessMessage(challengeId) {
            const messages = {
                1: 'The "dir" mode is the most commonly used mode for directory enumeration.',
                2: 'Great! This is the basic syntax for directory enumeration.',
                3: 'The -x flag allows you to search for specific file extensions.',
                4: 'Correct! The -t flag controls concurrent threads for faster scanning.',
                5: 'Exactly! A 403 means the resource exists but access is denied.',
                6: 'Perfect! DNS mode is essential for subdomain discovery.',
                7: 'Correct! Always save your results for later analysis.',
                8: 'Well done! This is the default location for dirb wordlists on Kali.',
                9: 'Excellent! You combined multiple flags for an advanced scan.',
                10: 'Perfect! You mastered DNS subdomain enumeration syntax.'
            };
            return messages[challengeId] || 'Well done!';
        }

        // ==================== PROGRESS MANAGEMENT ====================
        function saveProgress() {
            const data = {
                completedChallenges: Array.from(completedChallenges),
                totalPoints: totalPoints,
                commandCount: commandCount,
                directoriesDiscovered: directoriesDiscovered,
                commandHistory: commandHistory.slice(0, 50),
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('gobusterTrainingProgress', JSON.stringify(data));
        }

        function loadProgress() {
            const saved = localStorage.getItem('gobusterTrainingProgress');
            if (saved) {
                const data = JSON.parse(saved);
                completedChallenges = new Set(data.completedChallenges);
                totalPoints = data.totalPoints || 0;
                commandCount = data.commandCount || 0;
                directoriesDiscovered = data.directoriesDiscovered || 0;
                commandHistory = data.commandHistory || [];
            }
        }

        function exportProgress() {
            const data = {
                completedChallenges: Array.from(completedChallenges),
                totalPoints: totalPoints,
                commandCount: commandCount,
                directoriesDiscovered: directoriesDiscovered,
                commandHistory: commandHistory,
                exportDate: new Date().toISOString(),
                version: '1.0'
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `gobuster-training-progress-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function importProgress(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = JSON.parse(e.target.result);

                    if (confirm('This will overwrite your current progress. Continue?')) {
                        completedChallenges = new Set(data.completedChallenges);
                        totalPoints = data.totalPoints || 0;
                        commandCount = data.commandCount || 0;
                        directoriesDiscovered = data.directoriesDiscovered || 0;
                        commandHistory = data.commandHistory || [];

                        saveProgress();
                        renderChallenges();
                        updateStats();
                        updateSidebar();

                        alert('Progress imported successfully!');
                    }
                } catch (error) {
                    alert('Error importing file. Please make sure it\'s a valid progress file.');
                }
            };
            reader.readAsText(file);
        }

        function resetProgress() {
            if (confirm('Are you sure you want to reset ALL progress? This cannot be undone!')) {
                if (confirm('Really sure? All challenges and command history will be cleared.')) {
                    completedChallenges.clear();
                    totalPoints = 0;
                    commandCount = 0;
                    directoriesDiscovered = 0;
                    commandHistory = [];

                    localStorage.removeItem('gobusterTrainingProgress');

                    renderChallenges();
                    updateStats();
                    updateSidebar();
                    document.getElementById('terminalOutput').innerHTML = '';

                    alert('Progress reset successfully!');
                }
            }
        }

        function updateStats() {
            document.getElementById('statsCompleted').textContent = completedChallenges.size;
            document.getElementById('statsPoints').textContent = totalPoints;
            document.getElementById('statsCommands').textContent = commandCount;
            document.getElementById('statsDiscovered').textContent = directoriesDiscovered;
        }

        function updateSidebar() {
            document.getElementById('sidebarProgress').textContent = `${completedChallenges.size}/10`;
            document.getElementById('sidebarPoints').textContent = `${totalPoints}/200`;
        }
    </script>
<script src="../../../components/FluxCapacitor.js"></script>
</body>
</html>
