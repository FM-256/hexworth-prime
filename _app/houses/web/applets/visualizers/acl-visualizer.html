<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Access Control -->
    <script src="../../../../components/AccessGuard.js"></script>
    <script>
        AccessGuard.require('sorted');
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACL Visualizer - Interactive Learning Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #e0e0e0;
        }

        /* Header */
        .header {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header h1 {
            font-size: 1.5em;
            color: #fff;
        }

        .header h1 span {
            color: #f97316;
        }

        .back-btn {
            background: rgba(249, 115, 22, 0.2);
            color: #f97316;
            border: 1px solid #f97316;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            text-decoration: none;
            font-size: 0.9em;
            transition: all 0.3s;
        }

        .back-btn:hover {
            background: #f97316;
            color: #fff;
        }

        /* Tabs */
        .tab-container {
            display: flex;
            background: rgba(0, 0, 0, 0.2);
            padding: 0 20px;
            overflow-x: auto;
        }

        .tab {
            padding: 15px 25px;
            cursor: pointer;
            color: #888;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            font-weight: 500;
            white-space: nowrap;
        }

        .tab:hover {
            color: #bbb;
            background: rgba(255, 255, 255, 0.05);
        }

        .tab.active {
            color: #f97316;
            border-bottom-color: #f97316;
            background: rgba(249, 115, 22, 0.1);
        }

        /* Main Content */
        .main-content {
            padding: 20px;
            height: calc(100vh - 120px);
            overflow-y: auto;
        }

        .tab-content {
            display: none;
            height: 100%;
        }

        .tab-content.active {
            display: block;
        }

        /* ==================== TAB 1: What are ACLs? ==================== */
        .info-tab {
            max-width: 1000px;
            margin: 0 auto;
        }

        .info-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 4px solid #f97316;
        }

        .info-section h2 {
            color: #fff;
            margin-bottom: 15px;
            font-size: 1.4em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-section p {
            line-height: 1.8;
            color: #c0c0c0;
            font-size: 1.1em;
        }

        .info-section .highlight {
            color: #f97316;
            font-weight: 600;
        }

        .info-section .permit {
            color: #22c55e;
            font-weight: 600;
        }

        .info-section .deny {
            color: #ef4444;
            font-weight: 600;
        }

        .info-section .analogy {
            background: rgba(249, 115, 22, 0.15);
            padding: 15px 20px;
            border-radius: 8px;
            margin: 15px 0;
            font-style: italic;
            border-left: 3px solid #f97316;
        }

        /* The Problem Box */
        .problem-box {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(185, 28, 28, 0.2));
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            border: 2px solid rgba(239, 68, 68, 0.5);
        }

        .problem-box h3 {
            color: #ef4444;
            font-size: 1.3em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Solution Box */
        .solution-box {
            background: linear-gradient(135deg, rgba(249, 115, 22, 0.2), rgba(234, 88, 12, 0.2));
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            border: 2px solid rgba(249, 115, 22, 0.5);
        }

        .solution-box h3 {
            color: #f97316;
            font-size: 1.3em;
            margin-bottom: 15px;
        }

        /* ACL Demo */
        .acl-demo {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .acl-demo svg {
            max-width: 100%;
            height: auto;
        }

        .demo-btn {
            background: #f97316;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            margin: 15px 5px;
            transition: all 0.3s;
        }

        .demo-btn:hover {
            background: #ea580c;
            transform: translateY(-2px);
        }

        .demo-btn.secondary {
            background: rgba(249, 115, 22, 0.2);
            border: 2px solid #f97316;
        }

        .demo-btn.secondary:hover {
            background: #f97316;
        }

        /* Key Points */
        .key-points {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .key-point {
            background: rgba(249, 115, 22, 0.1);
            border: 1px solid rgba(249, 115, 22, 0.3);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .key-point h4 {
            color: #f97316;
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        .key-point p {
            font-size: 0.95em;
            color: #aaa;
        }

        /* ACL Processing Flow */
        .processing-flow {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
        }

        .flow-step {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255, 255, 255, 0.05);
            padding: 15px 20px;
            border-radius: 8px;
            border-left: 4px solid #f97316;
        }

        .flow-step .step-num {
            background: #f97316;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .flow-step .step-text {
            flex: 1;
        }

        .implicit-deny {
            background: rgba(239, 68, 68, 0.15) !important;
            border-left-color: #ef4444 !important;
        }

        .implicit-deny .step-num {
            background: #ef4444 !important;
        }

        /* ==================== TAB 2: Standard vs Extended ==================== */
        .comparison-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        @media (max-width: 900px) {
            .comparison-grid {
                grid-template-columns: 1fr;
            }
        }

        .comparison-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 25px;
            border: 2px solid transparent;
            transition: all 0.3s;
        }

        .comparison-card.standard {
            border-color: rgba(34, 197, 94, 0.5);
        }

        .comparison-card.extended {
            border-color: rgba(168, 85, 247, 0.5);
        }

        .comparison-card h3 {
            font-size: 1.4em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .comparison-card.standard h3 {
            color: #22c55e;
        }

        .comparison-card.extended h3 {
            color: #a855f7;
        }

        .acl-range {
            background: rgba(0, 0, 0, 0.3);
            padding: 12px 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            margin: 10px 0;
        }

        .syntax-example {
            background: #1a1a2e;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            overflow-x: auto;
        }

        .syntax-example .keyword {
            color: #f97316;
        }

        .syntax-example .action-permit {
            color: #22c55e;
        }

        .syntax-example .action-deny {
            color: #ef4444;
        }

        .syntax-example .address {
            color: #06b6d4;
        }

        .syntax-example .wildcard {
            color: #eab308;
        }

        .syntax-example .protocol {
            color: #a855f7;
        }

        .syntax-example .port {
            color: #ec4899;
        }

        .feature-list {
            list-style: none;
            margin: 15px 0;
        }

        .feature-list li {
            padding: 8px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .feature-list li::before {
            content: "✓";
            color: #22c55e;
            font-weight: bold;
        }

        .feature-list li.negative::before {
            content: "✗";
            color: #ef4444;
        }

        /* Interactive Builder */
        .acl-builder {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 25px;
            margin: 30px 0;
        }

        .acl-builder h3 {
            color: #fff;
            margin-bottom: 20px;
            font-size: 1.3em;
        }

        .builder-row {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            margin-bottom: 15px;
        }

        .builder-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .builder-group label {
            font-size: 0.85em;
            color: #888;
        }

        .builder-group select,
        .builder-group input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 10px 15px;
            border-radius: 6px;
            font-size: 1em;
            min-width: 150px;
        }

        .builder-group select:focus,
        .builder-group input:focus {
            outline: none;
            border-color: #f97316;
        }

        .builder-group select option {
            background: #1a1a2e;
        }

        .builder-output {
            background: #1a1a2e;
            border-radius: 8px;
            padding: 15px 20px;
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            margin-top: 20px;
            border-left: 4px solid #f97316;
        }

        /* ==================== TAB 3: Wildcard Calculator ==================== */
        .calculator-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .calculator-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .calculator-section h2 {
            color: #fff;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .input-row {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: flex-end;
            margin-bottom: 20px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .input-group label {
            font-size: 0.9em;
            color: #888;
        }

        .input-group input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 12px 15px;
            border-radius: 6px;
            font-size: 1em;
            width: 180px;
            font-family: 'Courier New', monospace;
        }

        .input-group input:focus {
            outline: none;
            border-color: #f97316;
        }

        .calc-btn {
            background: #f97316;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .calc-btn:hover {
            background: #ea580c;
        }

        /* Binary Visualization */
        .binary-viz {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .binary-row {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 10px 0;
            flex-wrap: wrap;
        }

        .binary-label {
            width: 130px;
            font-weight: 500;
            color: #aaa;
            flex-shrink: 0;
        }

        .binary-bits {
            display: flex;
            gap: 2px;
        }

        .binary-octet {
            display: flex;
            gap: 1px;
            margin-right: 8px;
        }

        .binary-bit {
            width: 24px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            font-weight: bold;
            border-radius: 3px;
        }

        .bit-match {
            background: #22c55e;
            color: white;
        }

        .bit-wildcard {
            background: #eab308;
            color: #1a1a2e;
        }

        .decimal-result {
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            color: #fff;
            margin-left: auto;
        }

        /* Quick Reference */
        .quick-ref {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }

        .quick-ref-item {
            background: rgba(249, 115, 22, 0.1);
            border: 1px solid rgba(249, 115, 22, 0.3);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quick-ref-item:hover {
            background: rgba(249, 115, 22, 0.2);
            transform: translateY(-2px);
        }

        .quick-ref-item .mask {
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            color: #f97316;
            margin-bottom: 5px;
        }

        .quick-ref-item .desc {
            font-size: 0.85em;
            color: #888;
        }

        /* Result Display */
        .result-display {
            background: rgba(34, 197, 94, 0.1);
            border: 2px solid rgba(34, 197, 94, 0.5);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .result-display h4 {
            color: #22c55e;
            margin-bottom: 15px;
        }

        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .result-item {
            background: rgba(0, 0, 0, 0.2);
            padding: 12px;
            border-radius: 6px;
        }

        .result-item .label {
            font-size: 0.85em;
            color: #888;
            margin-bottom: 5px;
        }

        .result-item .value {
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            color: #fff;
        }

        /* ==================== TAB 4: Packet Simulator ==================== */
        .simulator-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .simulator-layout {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
        }

        @media (max-width: 900px) {
            .simulator-layout {
                grid-template-columns: 1fr;
            }
        }

        /* ACL Rules Panel */
        .acl-panel {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
        }

        .acl-panel h3 {
            color: #fff;
            margin-bottom: 15px;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .acl-rule {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            border-left: 4px solid #666;
            transition: all 0.3s;
        }

        .acl-rule.permit {
            border-left-color: #22c55e;
        }

        .acl-rule.deny {
            border-left-color: #ef4444;
        }

        .acl-rule.active {
            background: rgba(249, 115, 22, 0.3);
            border-left-color: #f97316;
            box-shadow: 0 0 15px rgba(249, 115, 22, 0.3);
        }

        .acl-rule.matched {
            animation: ruleMatch 0.5s ease;
        }

        @keyframes ruleMatch {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.03); }
        }

        .acl-rule .rule-num {
            color: #888;
            font-size: 0.8em;
        }

        .acl-rule .rule-action {
            font-weight: bold;
        }

        .acl-rule .rule-action.permit {
            color: #22c55e;
        }

        .acl-rule .rule-action.deny {
            color: #ef4444;
        }

        .implicit-deny-rule {
            background: rgba(239, 68, 68, 0.2);
            border: 1px dashed #ef4444;
            color: #ef4444;
            font-style: italic;
        }

        /* Simulation Panel */
        .sim-panel {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
        }

        .sim-panel h3 {
            color: #fff;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        /* Packet Input */
        .packet-input {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .packet-field {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .packet-field label {
            font-size: 0.85em;
            color: #888;
        }

        .packet-field input,
        .packet-field select {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 10px;
            border-radius: 6px;
            font-size: 0.95em;
        }

        .packet-field input:focus,
        .packet-field select:focus {
            outline: none;
            border-color: #f97316;
        }

        .packet-field select option {
            background: #1a1a2e;
        }

        /* Simulation Controls */
        .sim-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .sim-btn {
            background: #f97316;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .sim-btn:hover {
            background: #ea580c;
        }

        .sim-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .sim-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Animation Canvas */
        .animation-canvas {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            height: 200px;
            position: relative;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .packet-visual {
            position: absolute;
            width: 60px;
            height: 40px;
            background: #06b6d4;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.8em;
            font-weight: bold;
            transition: all 0.5s ease;
            box-shadow: 0 4px 15px rgba(6, 182, 212, 0.4);
        }

        .packet-visual.denied {
            background: #ef4444;
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
        }

        .packet-visual.permitted {
            background: #22c55e;
            box-shadow: 0 4px 15px rgba(34, 197, 94, 0.4);
        }

        .router-visual {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 100px;
            height: 70px;
            background: linear-gradient(135deg, #374151 0%, #1f2937 100%);
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 0.9em;
            font-weight: bold;
            border: 2px solid #4b5563;
        }

        .router-visual .acl-label {
            font-size: 0.7em;
            color: #f97316;
            margin-top: 3px;
        }

        .source-zone, .dest-zone {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            width: 80px;
        }

        .source-zone {
            left: 20px;
            border: 2px dashed #06b6d4;
        }

        .dest-zone {
            right: 20px;
            border: 2px dashed #22c55e;
        }

        /* Result Display */
        .sim-result {
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            transition: all 0.3s;
        }

        .sim-result.permit {
            background: rgba(34, 197, 94, 0.2);
            border: 2px solid #22c55e;
            color: #22c55e;
        }

        .sim-result.deny {
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid #ef4444;
            color: #ef4444;
        }

        .sim-result.waiting {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid #666;
            color: #888;
        }

        .sim-result .detail {
            font-size: 0.8em;
            font-weight: normal;
            margin-top: 8px;
            color: #aaa;
        }

        /* Scenario Presets */
        .scenario-presets {
            margin-top: 20px;
        }

        .scenario-presets h4 {
            color: #888;
            font-size: 0.95em;
            margin-bottom: 10px;
        }

        .preset-btns {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .preset-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #ccc;
            padding: 8px 15px;
            border-radius: 6px;
            font-size: 0.85em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .preset-btn:hover {
            background: rgba(249, 115, 22, 0.2);
            border-color: #f97316;
            color: #f97316;
        }

        /* ACL Editor */
        .acl-editor {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .acl-editor h4 {
            color: #888;
            font-size: 0.95em;
            margin-bottom: 10px;
        }

        .acl-select {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 10px;
            border-radius: 6px;
            width: 100%;
            font-size: 0.95em;
        }

        .acl-select option {
            background: #1a1a2e;
        }

        /* Hidden by default */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <h1>ACL <span>Visualizer</span></h1>
        <a href="../../../../index.html" class="back-btn">Back to Catalog</a>
    </div>

    <!-- Tabs -->
    <div class="tab-container">
        <div class="tab active" data-tab="what">What are ACLs?</div>
        <div class="tab" data-tab="types">Standard vs Extended</div>
        <div class="tab" data-tab="wildcard">Wildcard Calculator</div>
        <div class="tab" data-tab="simulator">Packet Simulator</div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- ==================== TAB 1: What are ACLs? ==================== -->
        <div id="what" class="tab-content active">
            <div class="info-tab">
                <div class="info-section">
                    <h2>What is an Access Control List?</h2>
                    <p>
                        An <span class="highlight">Access Control List (ACL)</span> is a set of rules that a router
                        uses to filter network traffic. Think of it as a <span class="highlight">security guard</span>
                        standing at the door, checking each packet against a list of approved or denied criteria.
                    </p>
                    <div class="analogy">
                        Think of ACLs like a nightclub bouncer with a guest list. Each person (packet) trying to
                        enter is checked against the list. If they match an entry, the bouncer either lets them in
                        (<span class="permit">PERMIT</span>) or turns them away (<span class="deny">DENY</span>).
                        If they're not on the list at all? <span class="deny">Denied by default!</span>
                    </div>
                </div>

                <div class="problem-box">
                    <h3>The Problem: Open Networks</h3>
                    <p>
                        Without ACLs, <span class="deny">all traffic flows freely</span> through your network.
                        Any device can talk to any other device. This creates serious security risks:
                    </p>
                    <ul style="margin-left: 20px; margin-top: 10px; color: #c0c0c0;">
                        <li>Hackers can access internal servers</li>
                        <li>Malware can spread across the network</li>
                        <li>Sensitive data can be exfiltrated</li>
                        <li>No segmentation between departments</li>
                    </ul>
                </div>

                <div class="solution-box">
                    <h3>The Solution: ACLs as Traffic Filters</h3>
                    <p>
                        ACLs let you control <span class="highlight">WHO</span> can talk to <span class="highlight">WHOM</span>,
                        using <span class="highlight">WHAT protocols</span>, on <span class="highlight">WHICH ports</span>.
                    </p>
                </div>

                <!-- Interactive Demo -->
                <div class="acl-demo">
                    <svg id="aclDemoSvg" viewBox="0 0 700 250" width="100%" height="250">
                        <!-- Source Network -->
                        <rect x="30" y="80" width="120" height="90" rx="10" fill="#1e3a5f" stroke="#06b6d4" stroke-width="2"/>
                        <text x="90" y="115" text-anchor="middle" fill="#fff" font-size="12" font-weight="bold">Source</text>
                        <text x="90" y="135" text-anchor="middle" fill="#06b6d4" font-size="11">192.168.1.0/24</text>
                        <rect x="55" y="145" width="25" height="18" rx="3" fill="#0891b2"/>
                        <rect x="85" y="145" width="25" height="18" rx="3" fill="#0891b2"/>

                        <!-- Router with ACL -->
                        <rect x="280" y="70" width="140" height="110" rx="10" fill="#374151" stroke="#f97316" stroke-width="3"/>
                        <text x="350" y="105" text-anchor="middle" fill="#fff" font-size="14" font-weight="bold">Router</text>
                        <rect x="300" y="115" width="100" height="25" rx="5" fill="#f97316"/>
                        <text x="350" y="133" text-anchor="middle" fill="#fff" font-size="11" font-weight="bold">ACL 100</text>
                        <text x="350" y="160" text-anchor="middle" fill="#888" font-size="10">Gi0/0 Inbound</text>

                        <!-- Destination Network -->
                        <rect x="550" y="80" width="120" height="90" rx="10" fill="#1e3a5f" stroke="#22c55e" stroke-width="2"/>
                        <text x="610" y="115" text-anchor="middle" fill="#fff" font-size="12" font-weight="bold">Server</text>
                        <text x="610" y="135" text-anchor="middle" fill="#22c55e" font-size="11">10.0.0.100</text>
                        <rect x="585" y="145" width="50" height="18" rx="3" fill="#16a34a"/>

                        <!-- Connection Lines -->
                        <line x1="150" y1="125" x2="280" y2="125" stroke="#4b5563" stroke-width="3"/>
                        <line x1="420" y1="125" x2="550" y2="125" stroke="#4b5563" stroke-width="3"/>

                        <!-- Packets -->
                        <g id="permitPacket" class="packet-group" style="opacity: 0;">
                            <rect x="160" y="95" width="50" height="30" rx="5" fill="#22c55e"/>
                            <text x="185" y="115" text-anchor="middle" fill="#fff" font-size="10" font-weight="bold">HTTP</text>
                        </g>
                        <g id="denyPacket" class="packet-group" style="opacity: 0;">
                            <rect x="160" y="130" width="50" height="30" rx="5" fill="#ef4444"/>
                            <text x="185" y="150" text-anchor="middle" fill="#fff" font-size="10" font-weight="bold">Telnet</text>
                        </g>

                        <!-- Legend -->
                        <rect x="200" y="210" width="15" height="15" rx="3" fill="#22c55e"/>
                        <text x="220" y="222" fill="#aaa" font-size="11">Permitted (HTTP:80)</text>
                        <rect x="380" y="210" width="15" height="15" rx="3" fill="#ef4444"/>
                        <text x="400" y="222" fill="#aaa" font-size="11">Denied (Telnet:23)</text>
                    </svg>
                    <div>
                        <button class="demo-btn" onclick="runAclDemo()">Run Demo</button>
                        <button class="demo-btn secondary" onclick="resetAclDemo()">Reset</button>
                    </div>
                </div>

                <div class="info-section">
                    <h2>How ACLs Process Traffic</h2>
                    <p>ACLs evaluate packets <span class="highlight">top-to-bottom</span>, rule by rule. The FIRST match wins!</p>

                    <div class="processing-flow">
                        <div class="flow-step">
                            <div class="step-num">1</div>
                            <div class="step-text">Packet arrives at router interface</div>
                        </div>
                        <div class="flow-step">
                            <div class="step-num">2</div>
                            <div class="step-text">Router checks packet against <strong>first ACL rule</strong></div>
                        </div>
                        <div class="flow-step">
                            <div class="step-num">3</div>
                            <div class="step-text">If match: <span class="permit">PERMIT</span> or <span class="deny">DENY</span> action is taken. <strong>Stop processing.</strong></div>
                        </div>
                        <div class="flow-step">
                            <div class="step-num">4</div>
                            <div class="step-text">If no match: Move to <strong>next rule</strong> and repeat</div>
                        </div>
                        <div class="flow-step implicit-deny">
                            <div class="step-num">!</div>
                            <div class="step-text"><strong>Implicit Deny:</strong> If NO rules match, packet is <span class="deny">DENIED</span> by default</div>
                        </div>
                    </div>
                </div>

                <div class="info-section">
                    <h2>Key ACL Concepts</h2>
                    <div class="key-points">
                        <div class="key-point">
                            <h4>Inbound vs Outbound</h4>
                            <p>ACLs can filter traffic entering (in) or leaving (out) an interface</p>
                        </div>
                        <div class="key-point">
                            <h4>One ACL Per Direction</h4>
                            <p>Each interface can have ONE inbound and ONE outbound ACL</p>
                        </div>
                        <div class="key-point">
                            <h4>Order Matters</h4>
                            <p>Most specific rules first, general rules last</p>
                        </div>
                        <div class="key-point">
                            <h4>Implicit Deny All</h4>
                            <p>Every ACL ends with an invisible "deny any" rule</p>
                        </div>
                    </div>
                </div>

                <div class="info-section">
                    <h2>Where to Apply ACLs</h2>
                    <div class="analogy">
                        <strong>Standard ACLs:</strong> Apply <span class="highlight">close to the destination</span>
                        (they only check source IP, so you want to block as late as possible to avoid accidentally blocking legitimate traffic)
                        <br><br>
                        <strong>Extended ACLs:</strong> Apply <span class="highlight">close to the source</span>
                        (they check source, destination, protocol, and ports - block unwanted traffic as early as possible)
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== TAB 2: Standard vs Extended ==================== -->
        <div id="types" class="tab-content">
            <div class="comparison-container">
                <h2 style="color: #fff; margin-bottom: 20px; text-align: center;">Standard vs Extended ACLs</h2>

                <div class="comparison-grid">
                    <!-- Standard ACL Card -->
                    <div class="comparison-card standard">
                        <h3>Standard ACLs</h3>
                        <div class="acl-range">
                            <strong>Numbered:</strong> 1-99, 1300-1999
                        </div>
                        <p style="margin: 15px 0; color: #aaa;">
                            Filters traffic based on <strong style="color: #22c55e;">source IP address only</strong>.
                            Simple but limited.
                        </p>

                        <h4 style="color: #888; margin: 15px 0 10px;">Syntax:</h4>
                        <div class="syntax-example">
                            <span class="keyword">access-list</span> <span class="address">10</span> <span class="action-permit">permit</span> <span class="address">192.168.1.0</span> <span class="wildcard">0.0.0.255</span>
                        </div>

                        <ul class="feature-list">
                            <li>Checks source IP only</li>
                            <li>Less router CPU usage</li>
                            <li>Apply close to destination</li>
                            <li class="negative">Cannot filter by protocol</li>
                            <li class="negative">Cannot filter by port</li>
                            <li class="negative">Cannot filter by destination</li>
                        </ul>

                        <h4 style="color: #888; margin: 15px 0 10px;">Example Use Case:</h4>
                        <p style="color: #aaa; font-size: 0.95em;">
                            Block all traffic from a specific subnet (e.g., guest network can't reach server VLAN)
                        </p>
                    </div>

                    <!-- Extended ACL Card -->
                    <div class="comparison-card extended">
                        <h3>Extended ACLs</h3>
                        <div class="acl-range">
                            <strong>Numbered:</strong> 100-199, 2000-2699
                        </div>
                        <p style="margin: 15px 0; color: #aaa;">
                            Filters traffic based on <strong style="color: #a855f7;">source, destination, protocol, and ports</strong>.
                            Precise and flexible.
                        </p>

                        <h4 style="color: #888; margin: 15px 0 10px;">Syntax:</h4>
                        <div class="syntax-example">
                            <span class="keyword">access-list</span> <span class="address">100</span> <span class="action-permit">permit</span> <span class="protocol">tcp</span> <span class="address">192.168.1.0</span> <span class="wildcard">0.0.0.255</span> <span class="address">10.0.0.100</span> <span class="wildcard">0.0.0.0</span> <span class="port">eq 80</span>
                        </div>

                        <ul class="feature-list">
                            <li>Checks source AND destination</li>
                            <li>Filters by protocol (TCP, UDP, ICMP)</li>
                            <li>Filters by port number</li>
                            <li>Apply close to source</li>
                            <li>Supports operators (eq, gt, lt, range)</li>
                            <li class="negative">More CPU intensive</li>
                        </ul>

                        <h4 style="color: #888; margin: 15px 0 10px;">Example Use Case:</h4>
                        <p style="color: #aaa; font-size: 0.95em;">
                            Allow HTTP/HTTPS to web server, deny Telnet, permit SSH from admin subnet only
                        </p>
                    </div>
                </div>

                <!-- Named ACLs Section -->
                <div class="info-section" style="margin-top: 30px;">
                    <h2>Named ACLs (Modern Best Practice)</h2>
                    <p>
                        Instead of numbers, use <span class="highlight">descriptive names</span>.
                        Named ACLs are easier to manage and edit.
                    </p>

                    <div class="syntax-example" style="margin: 20px 0;">
                        <span class="keyword">ip access-list extended</span> <span class="address">BLOCK-TELNET</span><br>
                        &nbsp;&nbsp;<span class="action-deny">deny</span> <span class="protocol">tcp</span> <span class="address">any</span> <span class="address">any</span> <span class="port">eq 23</span><br>
                        &nbsp;&nbsp;<span class="action-permit">permit</span> <span class="protocol">ip</span> <span class="address">any</span> <span class="address">any</span>
                    </div>

                    <div class="key-points" style="grid-template-columns: repeat(3, 1fr);">
                        <div class="key-point">
                            <h4>Editable</h4>
                            <p>Insert/delete rules by sequence number</p>
                        </div>
                        <div class="key-point">
                            <h4>Self-Documenting</h4>
                            <p>Names describe the ACL's purpose</p>
                        </div>
                        <div class="key-point">
                            <h4>No Number Limits</h4>
                            <p>Not restricted to number ranges</p>
                        </div>
                    </div>
                </div>

                <!-- Interactive ACL Builder -->
                <div class="acl-builder">
                    <h3>Interactive ACL Builder</h3>
                    <p style="color: #888; margin-bottom: 20px;">Build an ACL statement and see the command generated in real-time.</p>

                    <div class="builder-row">
                        <div class="builder-group">
                            <label>ACL Type</label>
                            <select id="builderType" onchange="updateBuilder()">
                                <option value="standard">Standard (1-99)</option>
                                <option value="extended" selected>Extended (100-199)</option>
                            </select>
                        </div>
                        <div class="builder-group">
                            <label>ACL Number/Name</label>
                            <input type="text" id="builderNum" value="100" onchange="updateBuilder()">
                        </div>
                        <div class="builder-group">
                            <label>Action</label>
                            <select id="builderAction" onchange="updateBuilder()">
                                <option value="permit">permit</option>
                                <option value="deny">deny</option>
                            </select>
                        </div>
                    </div>

                    <div class="builder-row" id="extendedFields">
                        <div class="builder-group">
                            <label>Protocol</label>
                            <select id="builderProtocol" onchange="updateBuilder()">
                                <option value="ip">ip (all)</option>
                                <option value="tcp" selected>tcp</option>
                                <option value="udp">udp</option>
                                <option value="icmp">icmp</option>
                            </select>
                        </div>
                    </div>

                    <div class="builder-row">
                        <div class="builder-group">
                            <label>Source IP</label>
                            <input type="text" id="builderSrcIP" value="192.168.1.0" placeholder="IP or 'any'" onchange="updateBuilder()">
                        </div>
                        <div class="builder-group">
                            <label>Source Wildcard</label>
                            <input type="text" id="builderSrcWild" value="0.0.0.255" placeholder="0.0.0.255" onchange="updateBuilder()">
                        </div>
                    </div>

                    <div class="builder-row" id="destFields">
                        <div class="builder-group">
                            <label>Destination IP</label>
                            <input type="text" id="builderDstIP" value="10.0.0.100" placeholder="IP or 'any'" onchange="updateBuilder()">
                        </div>
                        <div class="builder-group">
                            <label>Destination Wildcard</label>
                            <input type="text" id="builderDstWild" value="0.0.0.0" placeholder="0.0.0.0" onchange="updateBuilder()">
                        </div>
                        <div class="builder-group" id="portField">
                            <label>Port</label>
                            <select id="builderPort" onchange="updateBuilder()">
                                <option value="">any</option>
                                <option value="eq 22">eq 22 (SSH)</option>
                                <option value="eq 23">eq 23 (Telnet)</option>
                                <option value="eq 80" selected>eq 80 (HTTP)</option>
                                <option value="eq 443">eq 443 (HTTPS)</option>
                                <option value="eq 53">eq 53 (DNS)</option>
                                <option value="range 1024 65535">range 1024 65535</option>
                            </select>
                        </div>
                    </div>

                    <div class="builder-output" id="builderOutput">
                        access-list 100 permit tcp 192.168.1.0 0.0.0.255 10.0.0.100 0.0.0.0 eq 80
                    </div>
                </div>

                <!-- Comparison Table -->
                <div class="info-section">
                    <h2>Quick Comparison</h2>
                    <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
                        <thead>
                            <tr style="background: rgba(249, 115, 22, 0.2);">
                                <th style="padding: 12px; text-align: left; border-bottom: 2px solid #f97316;">Feature</th>
                                <th style="padding: 12px; text-align: center; border-bottom: 2px solid #22c55e; color: #22c55e;">Standard</th>
                                <th style="padding: 12px; text-align: center; border-bottom: 2px solid #a855f7; color: #a855f7;">Extended</th>
                            </tr>
                        </thead>
                        <tbody style="color: #ccc;">
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 10px;">Number Range</td>
                                <td style="padding: 10px; text-align: center; font-family: monospace;">1-99, 1300-1999</td>
                                <td style="padding: 10px; text-align: center; font-family: monospace;">100-199, 2000-2699</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 10px;">Source IP</td>
                                <td style="padding: 10px; text-align: center; color: #22c55e;">&#10003;</td>
                                <td style="padding: 10px; text-align: center; color: #22c55e;">&#10003;</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 10px;">Destination IP</td>
                                <td style="padding: 10px; text-align: center; color: #ef4444;">&#10007;</td>
                                <td style="padding: 10px; text-align: center; color: #22c55e;">&#10003;</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 10px;">Protocol (TCP/UDP/ICMP)</td>
                                <td style="padding: 10px; text-align: center; color: #ef4444;">&#10007;</td>
                                <td style="padding: 10px; text-align: center; color: #22c55e;">&#10003;</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 10px;">Port Numbers</td>
                                <td style="padding: 10px; text-align: center; color: #ef4444;">&#10007;</td>
                                <td style="padding: 10px; text-align: center; color: #22c55e;">&#10003;</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 10px;">CPU Usage</td>
                                <td style="padding: 10px; text-align: center;">Low</td>
                                <td style="padding: 10px; text-align: center;">Higher</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">Placement</td>
                                <td style="padding: 10px; text-align: center;">Near Destination</td>
                                <td style="padding: 10px; text-align: center;">Near Source</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ==================== TAB 3: Wildcard Calculator ==================== -->
        <div id="wildcard" class="tab-content">
            <div class="calculator-container">
                <div class="info-section">
                    <h2>Understanding Wildcard Masks</h2>
                    <p>
                        A <span class="highlight">wildcard mask</span> tells the router which bits of an IP address
                        must match (0) and which bits can be ignored (1). It's the <span class="highlight">inverse</span>
                        of a subnet mask!
                    </p>
                    <div class="analogy">
                        Think of a wildcard mask like a template:
                        <strong style="color: #22c55e;">0 = "must match exactly"</strong>,
                        <strong style="color: #eab308;">1 = "don't care, any value OK"</strong>
                    </div>
                </div>

                <div class="calculator-section">
                    <h2>Subnet to Wildcard Converter</h2>
                    <div class="input-row">
                        <div class="input-group">
                            <label>Subnet Mask</label>
                            <input type="text" id="subnetInput" value="255.255.255.0" placeholder="255.255.255.0">
                        </div>
                        <button class="calc-btn" onclick="convertSubnetToWildcard()">Convert to Wildcard</button>
                    </div>

                    <div class="binary-viz" id="subnetViz">
                        <div class="binary-row">
                            <span class="binary-label">Subnet Mask:</span>
                            <div class="binary-bits" id="subnetBits"></div>
                            <span class="decimal-result" id="subnetDecimal">255.255.255.0</span>
                        </div>
                        <div class="binary-row">
                            <span class="binary-label">Wildcard Mask:</span>
                            <div class="binary-bits" id="wildcardBits"></div>
                            <span class="decimal-result" id="wildcardDecimal">0.0.0.255</span>
                        </div>
                    </div>

                    <div class="result-display" id="conversionResult" style="display: none;">
                        <h4>Conversion Result</h4>
                        <div class="result-grid">
                            <div class="result-item">
                                <div class="label">Subnet Mask</div>
                                <div class="value" id="resultSubnet">-</div>
                            </div>
                            <div class="result-item">
                                <div class="label">Wildcard Mask</div>
                                <div class="value" id="resultWildcard">-</div>
                            </div>
                            <div class="result-item">
                                <div class="label">CIDR Notation</div>
                                <div class="value" id="resultCidr">-</div>
                            </div>
                            <div class="result-item">
                                <div class="label">Hosts Matched</div>
                                <div class="value" id="resultHosts">-</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="calculator-section">
                    <h2>Common Wildcard Masks (Quick Reference)</h2>
                    <p style="color: #888; margin-bottom: 15px;">Click any mask to see its binary representation</p>

                    <div class="quick-ref">
                        <div class="quick-ref-item" onclick="showQuickRef('0.0.0.0', '/32 - Single Host')">
                            <div class="mask">0.0.0.0</div>
                            <div class="desc">/32 - Single Host</div>
                        </div>
                        <div class="quick-ref-item" onclick="showQuickRef('0.0.0.255', '/24 - Class C')">
                            <div class="mask">0.0.0.255</div>
                            <div class="desc">/24 - 256 Hosts</div>
                        </div>
                        <div class="quick-ref-item" onclick="showQuickRef('0.0.0.127', '/25 - Half C')">
                            <div class="mask">0.0.0.127</div>
                            <div class="desc">/25 - 128 Hosts</div>
                        </div>
                        <div class="quick-ref-item" onclick="showQuickRef('0.0.0.63', '/26 - Quarter C')">
                            <div class="mask">0.0.0.63</div>
                            <div class="desc">/26 - 64 Hosts</div>
                        </div>
                        <div class="quick-ref-item" onclick="showQuickRef('0.0.0.31', '/27')">
                            <div class="mask">0.0.0.31</div>
                            <div class="desc">/27 - 32 Hosts</div>
                        </div>
                        <div class="quick-ref-item" onclick="showQuickRef('0.0.0.15', '/28')">
                            <div class="mask">0.0.0.15</div>
                            <div class="desc">/28 - 16 Hosts</div>
                        </div>
                        <div class="quick-ref-item" onclick="showQuickRef('0.0.255.255', '/16 - Class B')">
                            <div class="mask">0.0.255.255</div>
                            <div class="desc">/16 - 65,536 Hosts</div>
                        </div>
                        <div class="quick-ref-item" onclick="showQuickRef('0.255.255.255', '/8 - Class A')">
                            <div class="mask">0.255.255.255</div>
                            <div class="desc">/8 - 16M+ Hosts</div>
                        </div>
                    </div>
                </div>

                <div class="calculator-section">
                    <h2>IP Range Calculator</h2>
                    <p style="color: #888; margin-bottom: 15px;">Enter an IP and wildcard to see the range of addresses matched</p>

                    <div class="input-row">
                        <div class="input-group">
                            <label>IP Address</label>
                            <input type="text" id="rangeIP" value="192.168.1.0" placeholder="192.168.1.0">
                        </div>
                        <div class="input-group">
                            <label>Wildcard Mask</label>
                            <input type="text" id="rangeWildcard" value="0.0.0.255" placeholder="0.0.0.255">
                        </div>
                        <button class="calc-btn" onclick="calculateRange()">Calculate Range</button>
                    </div>

                    <div class="result-display" id="rangeResult" style="display: none;">
                        <h4>Address Range Matched</h4>
                        <div class="result-grid">
                            <div class="result-item">
                                <div class="label">First Address</div>
                                <div class="value" id="rangeFirst">-</div>
                            </div>
                            <div class="result-item">
                                <div class="label">Last Address</div>
                                <div class="value" id="rangeLast">-</div>
                            </div>
                            <div class="result-item">
                                <div class="label">Total Addresses</div>
                                <div class="value" id="rangeTotal">-</div>
                            </div>
                            <div class="result-item">
                                <div class="label">ACL Statement</div>
                                <div class="value" id="rangeAcl">-</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="info-section">
                    <h2>Special Wildcards</h2>
                    <div class="key-points" style="grid-template-columns: repeat(2, 1fr);">
                        <div class="key-point">
                            <h4 style="font-family: monospace;">host 192.168.1.1</h4>
                            <p>Shortcut for <code>192.168.1.1 0.0.0.0</code><br>Matches exactly ONE host</p>
                        </div>
                        <div class="key-point">
                            <h4 style="font-family: monospace;">any</h4>
                            <p>Shortcut for <code>0.0.0.0 255.255.255.255</code><br>Matches ALL addresses</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== TAB 4: Packet Simulator ==================== -->
        <div id="simulator" class="tab-content">
            <div class="simulator-container">
                <h2 style="color: #fff; margin-bottom: 20px; text-align: center;">ACL Packet Simulator</h2>
                <p style="color: #888; text-align: center; margin-bottom: 20px;">Watch how packets are evaluated against ACL rules in real-time</p>

                <div class="simulator-layout">
                    <!-- ACL Rules Panel -->
                    <div class="acl-panel">
                        <h3>ACL Rules</h3>
                        <div id="aclRulesList">
                            <!-- Rules will be generated by JS -->
                        </div>

                        <div class="acl-editor">
                            <h4>Select ACL Scenario</h4>
                            <select class="acl-select" id="aclScenarioSelect" onchange="loadAclScenario()">
                                <option value="webserver">Web Server Protection</option>
                                <option value="admin">Admin Access Control</option>
                                <option value="dmz">DMZ Filtering</option>
                                <option value="simple">Simple Block/Allow</option>
                            </select>
                        </div>
                    </div>

                    <!-- Simulation Panel -->
                    <div class="sim-panel">
                        <h3>Packet Configuration</h3>

                        <div class="packet-input">
                            <div class="packet-field">
                                <label>Source IP</label>
                                <input type="text" id="simSrcIP" value="192.168.1.100" placeholder="192.168.1.100">
                            </div>
                            <div class="packet-field">
                                <label>Destination IP</label>
                                <input type="text" id="simDstIP" value="10.0.0.50" placeholder="10.0.0.50">
                            </div>
                            <div class="packet-field">
                                <label>Protocol</label>
                                <select id="simProtocol" onchange="updatePortOptions()">
                                    <option value="tcp">TCP</option>
                                    <option value="udp">UDP</option>
                                    <option value="icmp">ICMP</option>
                                </select>
                            </div>
                            <div class="packet-field" id="srcPortField">
                                <label>Source Port</label>
                                <input type="text" id="simSrcPort" value="49152" placeholder="49152">
                            </div>
                            <div class="packet-field" id="dstPortField">
                                <label>Dest Port</label>
                                <select id="simDstPort">
                                    <option value="80">80 (HTTP)</option>
                                    <option value="443">443 (HTTPS)</option>
                                    <option value="22">22 (SSH)</option>
                                    <option value="23">23 (Telnet)</option>
                                    <option value="53">53 (DNS)</option>
                                    <option value="3389">3389 (RDP)</option>
                                </select>
                            </div>
                        </div>

                        <div class="sim-controls">
                            <button class="sim-btn" onclick="runSimulation()">
                                &#9654; Simulate Packet
                            </button>
                            <button class="sim-btn secondary" onclick="resetSimulation()">
                                &#8634; Reset
                            </button>
                        </div>

                        <!-- Animation Canvas -->
                        <div class="animation-canvas" id="animationCanvas">
                            <div class="source-zone">
                                <div style="font-size: 0.8em; color: #06b6d4;">Source</div>
                                <div style="font-size: 0.7em; color: #888;" id="animSrcLabel">192.168.1.x</div>
                            </div>
                            <div class="router-visual">
                                <span>Router</span>
                                <span class="acl-label">ACL 100</span>
                            </div>
                            <div class="dest-zone">
                                <div style="font-size: 0.8em; color: #22c55e;">Dest</div>
                                <div style="font-size: 0.7em; color: #888;" id="animDstLabel">10.0.0.x</div>
                            </div>
                            <div class="packet-visual" id="packetVisual" style="left: 30px; top: 80px; opacity: 0;">
                                PKT
                            </div>
                        </div>

                        <!-- Result Display -->
                        <div class="sim-result waiting" id="simResult">
                            Configure a packet and click "Simulate" to see the result
                            <div class="detail">The packet will be evaluated against each ACL rule in order</div>
                        </div>

                        <!-- Quick Test Presets -->
                        <div class="scenario-presets">
                            <h4>Quick Test Packets</h4>
                            <div class="preset-btns">
                                <button class="preset-btn" onclick="loadPreset('httpAllowed')">HTTP from LAN</button>
                                <button class="preset-btn" onclick="loadPreset('telnetBlocked')">Telnet Attempt</button>
                                <button class="preset-btn" onclick="loadPreset('sshAdmin')">SSH from Admin</button>
                                <button class="preset-btn" onclick="loadPreset('icmpPing')">ICMP Ping</button>
                                <button class="preset-btn" onclick="loadPreset('unknownSrc')">Unknown Source</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== Tab Navigation ====================
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                tab.classList.add('active');
                document.getElementById(tab.dataset.tab).classList.add('active');
            });
        });

        // ==================== TAB 1: Demo Animation ====================
        let demoRunning = false;

        function runAclDemo() {
            if (demoRunning) return;
            demoRunning = true;

            const permitPacket = document.getElementById('permitPacket');
            const denyPacket = document.getElementById('denyPacket');

            // Reset
            permitPacket.style.opacity = '0';
            permitPacket.style.transform = 'translateX(0)';
            denyPacket.style.opacity = '0';
            denyPacket.style.transform = 'translateX(0)';

            // Animate permit packet (HTTP)
            setTimeout(() => {
                permitPacket.style.transition = 'all 0.5s ease';
                permitPacket.style.opacity = '1';
            }, 100);

            setTimeout(() => {
                permitPacket.style.transition = 'all 1.5s ease';
                permitPacket.style.transform = 'translateX(380px)';
            }, 700);

            // Animate deny packet (Telnet)
            setTimeout(() => {
                denyPacket.style.transition = 'all 0.5s ease';
                denyPacket.style.opacity = '1';
            }, 2000);

            setTimeout(() => {
                denyPacket.style.transition = 'all 1s ease';
                denyPacket.style.transform = 'translateX(140px)';
            }, 2600);

            setTimeout(() => {
                denyPacket.style.transition = 'all 0.3s ease';
                denyPacket.style.opacity = '0';
                denyPacket.style.transform = 'translateX(140px) scale(0.5)';
            }, 3700);

            setTimeout(() => {
                demoRunning = false;
            }, 4500);
        }

        function resetAclDemo() {
            const permitPacket = document.getElementById('permitPacket');
            const denyPacket = document.getElementById('denyPacket');
            permitPacket.style.transition = 'none';
            denyPacket.style.transition = 'none';
            permitPacket.style.opacity = '0';
            permitPacket.style.transform = 'translateX(0)';
            denyPacket.style.opacity = '0';
            denyPacket.style.transform = 'translateX(0)';
            demoRunning = false;
        }

        // ==================== TAB 2: ACL Builder ====================
        function updateBuilder() {
            const type = document.getElementById('builderType').value;
            const num = document.getElementById('builderNum').value;
            const action = document.getElementById('builderAction').value;
            const protocol = document.getElementById('builderProtocol').value;
            const srcIP = document.getElementById('builderSrcIP').value || 'any';
            const srcWild = document.getElementById('builderSrcWild').value;
            const dstIP = document.getElementById('builderDstIP').value || 'any';
            const dstWild = document.getElementById('builderDstWild').value;
            const port = document.getElementById('builderPort').value;

            // Show/hide extended fields
            const extendedFields = document.getElementById('extendedFields');
            const destFields = document.getElementById('destFields');
            const portField = document.getElementById('portField');

            if (type === 'standard') {
                extendedFields.style.display = 'none';
                destFields.style.display = 'none';
            } else {
                extendedFields.style.display = 'flex';
                destFields.style.display = 'flex';
                portField.style.display = (protocol === 'tcp' || protocol === 'udp') ? 'flex' : 'none';
            }

            // Build command
            let cmd = `access-list ${num} ${action}`;

            if (type === 'standard') {
                // Standard ACL: just source
                if (srcIP.toLowerCase() === 'any') {
                    cmd += ' any';
                } else {
                    cmd += ` ${srcIP}`;
                    if (srcWild && srcWild !== '0.0.0.0') {
                        cmd += ` ${srcWild}`;
                    }
                }
            } else {
                // Extended ACL: protocol, source, dest, port
                cmd += ` ${protocol}`;

                // Source
                if (srcIP.toLowerCase() === 'any') {
                    cmd += ' any';
                } else if (srcWild === '0.0.0.0') {
                    cmd += ` host ${srcIP}`;
                } else {
                    cmd += ` ${srcIP} ${srcWild}`;
                }

                // Destination
                if (dstIP.toLowerCase() === 'any') {
                    cmd += ' any';
                } else if (dstWild === '0.0.0.0') {
                    cmd += ` host ${dstIP}`;
                } else {
                    cmd += ` ${dstIP} ${dstWild}`;
                }

                // Port (only for TCP/UDP)
                if ((protocol === 'tcp' || protocol === 'udp') && port) {
                    cmd += ` ${port}`;
                }
            }

            document.getElementById('builderOutput').textContent = cmd;
        }

        // Initialize builder
        updateBuilder();

        // ==================== TAB 3: Wildcard Calculator ====================
        function ipToArray(ip) {
            return ip.split('.').map(Number);
        }

        function arrayToIp(arr) {
            return arr.join('.');
        }

        function octetToBinary(octet) {
            return octet.toString(2).padStart(8, '0');
        }

        function subnetToWildcard(subnet) {
            const octets = ipToArray(subnet);
            return octets.map(o => 255 - o);
        }

        function wildcardToSubnet(wildcard) {
            const octets = ipToArray(wildcard);
            return octets.map(o => 255 - o);
        }

        function countBits(mask) {
            const octets = ipToArray(mask);
            let bits = 0;
            for (let o of octets) {
                let binary = octetToBinary(o);
                bits += (binary.match(/1/g) || []).length;
            }
            return bits;
        }

        function convertSubnetToWildcard() {
            const subnetInput = document.getElementById('subnetInput').value.trim();

            // Validate input
            const octets = subnetInput.split('.');
            if (octets.length !== 4 || octets.some(o => isNaN(o) || o < 0 || o > 255)) {
                alert('Please enter a valid subnet mask (e.g., 255.255.255.0)');
                return;
            }

            const subnetArray = ipToArray(subnetInput);
            const wildcardArray = subnetToWildcard(subnetInput);
            const wildcardMask = arrayToIp(wildcardArray);

            // Update binary visualization
            updateBinaryViz(subnetArray, wildcardArray);

            // Calculate additional info
            const cidr = countBits(subnetInput);
            let hosts = 1;
            for (let o of wildcardArray) {
                hosts *= (o + 1);
            }

            // Show results
            document.getElementById('conversionResult').style.display = 'block';
            document.getElementById('resultSubnet').textContent = subnetInput;
            document.getElementById('resultWildcard').textContent = wildcardMask;
            document.getElementById('resultCidr').textContent = `/${cidr}`;
            document.getElementById('resultHosts').textContent = hosts.toLocaleString();
        }

        function updateBinaryViz(subnetArray, wildcardArray) {
            const subnetBitsDiv = document.getElementById('subnetBits');
            const wildcardBitsDiv = document.getElementById('wildcardBits');

            subnetBitsDiv.innerHTML = '';
            wildcardBitsDiv.innerHTML = '';

            for (let i = 0; i < 4; i++) {
                const subnetBinary = octetToBinary(subnetArray[i]);
                const wildcardBinary = octetToBinary(wildcardArray[i]);

                const subnetOctet = document.createElement('div');
                subnetOctet.className = 'binary-octet';
                const wildcardOctet = document.createElement('div');
                wildcardOctet.className = 'binary-octet';

                for (let j = 0; j < 8; j++) {
                    const subnetBit = document.createElement('div');
                    subnetBit.className = `binary-bit ${subnetBinary[j] === '1' ? 'bit-match' : 'bit-wildcard'}`;
                    subnetBit.textContent = subnetBinary[j];
                    subnetOctet.appendChild(subnetBit);

                    const wildcardBit = document.createElement('div');
                    wildcardBit.className = `binary-bit ${wildcardBinary[j] === '0' ? 'bit-match' : 'bit-wildcard'}`;
                    wildcardBit.textContent = wildcardBinary[j];
                    wildcardOctet.appendChild(wildcardBit);
                }

                subnetBitsDiv.appendChild(subnetOctet);
                wildcardBitsDiv.appendChild(wildcardOctet);
            }

            document.getElementById('subnetDecimal').textContent = arrayToIp(subnetArray);
            document.getElementById('wildcardDecimal').textContent = arrayToIp(wildcardArray);
        }

        function showQuickRef(wildcard, desc) {
            const wildcardArray = ipToArray(wildcard);
            const subnetArray = wildcardToSubnet(wildcard);

            document.getElementById('subnetInput').value = arrayToIp(subnetArray);
            updateBinaryViz(subnetArray, wildcardArray);

            // Calculate hosts
            let hosts = 1;
            for (let o of wildcardArray) {
                hosts *= (o + 1);
            }

            document.getElementById('conversionResult').style.display = 'block';
            document.getElementById('resultSubnet').textContent = arrayToIp(subnetArray);
            document.getElementById('resultWildcard').textContent = wildcard;
            document.getElementById('resultCidr').textContent = desc.split(' ')[0];
            document.getElementById('resultHosts').textContent = hosts.toLocaleString();
        }

        function calculateRange() {
            const ip = document.getElementById('rangeIP').value.trim();
            const wildcard = document.getElementById('rangeWildcard').value.trim();

            // Validate
            const ipOctets = ip.split('.');
            const wcOctets = wildcard.split('.');
            if (ipOctets.length !== 4 || wcOctets.length !== 4) {
                alert('Please enter valid IP and wildcard addresses');
                return;
            }

            const ipArray = ipToArray(ip);
            const wcArray = ipToArray(wildcard);

            // Calculate range
            const firstArray = ipArray.map((o, i) => o & (255 - wcArray[i]));
            const lastArray = firstArray.map((o, i) => o | wcArray[i]);

            // Count addresses
            let total = 1;
            for (let o of wcArray) {
                total *= (o + 1);
            }

            document.getElementById('rangeResult').style.display = 'block';
            document.getElementById('rangeFirst').textContent = arrayToIp(firstArray);
            document.getElementById('rangeLast').textContent = arrayToIp(lastArray);
            document.getElementById('rangeTotal').textContent = total.toLocaleString();
            document.getElementById('rangeAcl').textContent = `${arrayToIp(firstArray)} ${wildcard}`;
        }

        // Initialize wildcard viz
        convertSubnetToWildcard();

        // ==================== TAB 4: Packet Simulator ====================
        const aclScenarios = {
            webserver: {
                name: 'Web Server Protection',
                rules: [
                    { num: 10, action: 'permit', protocol: 'tcp', srcIP: 'any', srcWild: '', dstIP: '10.0.0.0', dstWild: '0.0.0.255', port: 80 },
                    { num: 20, action: 'permit', protocol: 'tcp', srcIP: 'any', srcWild: '', dstIP: '10.0.0.0', dstWild: '0.0.0.255', port: 443 },
                    { num: 30, action: 'permit', protocol: 'tcp', srcIP: '192.168.100.0', srcWild: '0.0.0.255', dstIP: '10.0.0.0', dstWild: '0.0.0.255', port: 22 },
                    { num: 40, action: 'deny', protocol: 'tcp', srcIP: 'any', srcWild: '', dstIP: 'any', dstWild: '', port: 23 },
                    { num: 50, action: 'permit', protocol: 'icmp', srcIP: '192.168.0.0', srcWild: '0.0.255.255', dstIP: 'any', dstWild: '' }
                ]
            },
            admin: {
                name: 'Admin Access Control',
                rules: [
                    { num: 10, action: 'permit', protocol: 'tcp', srcIP: '10.10.10.0', srcWild: '0.0.0.255', dstIP: 'any', dstWild: '', port: 22 },
                    { num: 20, action: 'permit', protocol: 'tcp', srcIP: '10.10.10.0', srcWild: '0.0.0.255', dstIP: 'any', dstWild: '', port: 3389 },
                    { num: 30, action: 'deny', protocol: 'tcp', srcIP: 'any', srcWild: '', dstIP: 'any', dstWild: '', port: 22 },
                    { num: 40, action: 'deny', protocol: 'tcp', srcIP: 'any', srcWild: '', dstIP: 'any', dstWild: '', port: 3389 },
                    { num: 50, action: 'permit', protocol: 'ip', srcIP: 'any', srcWild: '', dstIP: 'any', dstWild: '' }
                ]
            },
            dmz: {
                name: 'DMZ Filtering',
                rules: [
                    { num: 10, action: 'permit', protocol: 'tcp', srcIP: 'any', srcWild: '', dstIP: '172.16.0.0', dstWild: '0.0.0.255', port: 80 },
                    { num: 20, action: 'permit', protocol: 'tcp', srcIP: 'any', srcWild: '', dstIP: '172.16.0.0', dstWild: '0.0.0.255', port: 443 },
                    { num: 30, action: 'permit', protocol: 'udp', srcIP: 'any', srcWild: '', dstIP: '172.16.0.0', dstWild: '0.0.0.255', port: 53 },
                    { num: 40, action: 'deny', protocol: 'ip', srcIP: 'any', srcWild: '', dstIP: '172.16.0.0', dstWild: '0.0.0.255' }
                ]
            },
            simple: {
                name: 'Simple Block/Allow',
                rules: [
                    { num: 10, action: 'deny', protocol: 'ip', srcIP: '192.168.99.0', srcWild: '0.0.0.255', dstIP: 'any', dstWild: '' },
                    { num: 20, action: 'permit', protocol: 'ip', srcIP: '192.168.0.0', srcWild: '0.0.255.255', dstIP: 'any', dstWild: '' }
                ]
            }
        };

        let currentScenario = 'webserver';

        function loadAclScenario() {
            currentScenario = document.getElementById('aclScenarioSelect').value;
            renderAclRules();
            resetSimulation();
        }

        function renderAclRules() {
            const scenario = aclScenarios[currentScenario];
            const container = document.getElementById('aclRulesList');
            container.innerHTML = '';

            scenario.rules.forEach(rule => {
                const div = document.createElement('div');
                div.className = `acl-rule ${rule.action}`;
                div.id = `rule-${rule.num}`;

                let ruleText = `<span class="rule-num">${rule.num}</span> `;
                ruleText += `<span class="rule-action ${rule.action}">${rule.action}</span> `;
                ruleText += `<span style="color: #a855f7;">${rule.protocol}</span> `;

                // Source
                if (rule.srcIP === 'any') {
                    ruleText += 'any ';
                } else {
                    ruleText += `${rule.srcIP} `;
                    if (rule.srcWild) ruleText += `${rule.srcWild} `;
                }

                // Destination
                if (rule.dstIP === 'any') {
                    ruleText += 'any';
                } else {
                    ruleText += `${rule.dstIP}`;
                    if (rule.dstWild) ruleText += ` ${rule.dstWild}`;
                }

                // Port
                if (rule.port) {
                    ruleText += ` <span style="color: #ec4899;">eq ${rule.port}</span>`;
                }

                div.innerHTML = ruleText;
                container.appendChild(div);
            });

            // Add implicit deny
            const implicitDeny = document.createElement('div');
            implicitDeny.className = 'acl-rule implicit-deny-rule';
            implicitDeny.id = 'rule-implicit';
            implicitDeny.innerHTML = '<span class="rule-num">--</span> <span class="rule-action deny">deny</span> ip any any (implicit)';
            container.appendChild(implicitDeny);
        }

        function updatePortOptions() {
            const protocol = document.getElementById('simProtocol').value;
            const srcPortField = document.getElementById('srcPortField');
            const dstPortField = document.getElementById('dstPortField');

            if (protocol === 'icmp') {
                srcPortField.style.display = 'none';
                dstPortField.style.display = 'none';
            } else {
                srcPortField.style.display = 'flex';
                dstPortField.style.display = 'flex';
            }
        }

        function ipMatchesRule(ip, ruleIP, ruleWild) {
            if (ruleIP === 'any') return true;

            const ipOctets = ipToArray(ip);
            const ruleOctets = ipToArray(ruleIP);
            const wildOctets = ruleWild ? ipToArray(ruleWild) : [0, 0, 0, 0];

            for (let i = 0; i < 4; i++) {
                const masked = ipOctets[i] & (255 - wildOctets[i]);
                const ruleMasked = ruleOctets[i] & (255 - wildOctets[i]);
                if (masked !== ruleMasked) return false;
            }
            return true;
        }

        function evaluatePacket(srcIP, dstIP, protocol, dstPort) {
            const scenario = aclScenarios[currentScenario];

            for (let rule of scenario.rules) {
                // Check protocol
                if (rule.protocol !== 'ip' && rule.protocol !== protocol.toLowerCase()) {
                    continue;
                }

                // Check source IP
                if (!ipMatchesRule(srcIP, rule.srcIP, rule.srcWild)) {
                    continue;
                }

                // Check destination IP
                if (!ipMatchesRule(dstIP, rule.dstIP, rule.dstWild)) {
                    continue;
                }

                // Check port (if applicable)
                if (rule.port && protocol !== 'icmp') {
                    if (parseInt(dstPort) !== rule.port) {
                        continue;
                    }
                }

                // Match found!
                return { matched: true, rule: rule, action: rule.action };
            }

            // No match - implicit deny
            return { matched: false, rule: null, action: 'deny' };
        }

        async function runSimulation() {
            const srcIP = document.getElementById('simSrcIP').value.trim();
            const dstIP = document.getElementById('simDstIP').value.trim();
            const protocol = document.getElementById('simProtocol').value;
            const dstPort = document.getElementById('simDstPort').value;

            // Update animation labels
            document.getElementById('animSrcLabel').textContent = srcIP.split('.').slice(0, 3).join('.') + '.x';
            document.getElementById('animDstLabel').textContent = dstIP.split('.').slice(0, 3).join('.') + '.x';

            // Reset all rule highlights
            document.querySelectorAll('.acl-rule').forEach(r => {
                r.classList.remove('active', 'matched');
            });

            // Get packet visual
            const packet = document.getElementById('packetVisual');
            packet.className = 'packet-visual';
            packet.style.transition = 'none';
            packet.style.left = '30px';
            packet.style.opacity = '0';

            // Set packet label
            if (protocol === 'icmp') {
                packet.textContent = 'ICMP';
            } else {
                packet.textContent = dstPort;
            }

            // Start animation
            await sleep(100);
            packet.style.transition = 'all 0.5s ease';
            packet.style.opacity = '1';

            await sleep(600);

            // Move to router (evaluation starts)
            packet.style.transition = 'all 1s ease';
            packet.style.left = 'calc(50% - 30px)';

            await sleep(500);

            // Evaluate rules one by one
            const scenario = aclScenarios[currentScenario];
            let result = { matched: false, rule: null, action: 'deny' };
            let matchedRuleNum = 'implicit';

            for (let rule of scenario.rules) {
                const ruleElement = document.getElementById(`rule-${rule.num}`);
                ruleElement.classList.add('active');

                await sleep(400);

                // Check if this rule matches
                let matches = true;

                // Protocol check
                if (rule.protocol !== 'ip' && rule.protocol !== protocol.toLowerCase()) {
                    matches = false;
                }

                // Source IP check
                if (matches && !ipMatchesRule(srcIP, rule.srcIP, rule.srcWild)) {
                    matches = false;
                }

                // Destination IP check
                if (matches && !ipMatchesRule(dstIP, rule.dstIP, rule.dstWild)) {
                    matches = false;
                }

                // Port check
                if (matches && rule.port && protocol !== 'icmp') {
                    if (parseInt(dstPort) !== rule.port) {
                        matches = false;
                    }
                }

                if (matches) {
                    ruleElement.classList.add('matched');
                    result = { matched: true, rule: rule, action: rule.action };
                    matchedRuleNum = rule.num;
                    break;
                } else {
                    ruleElement.classList.remove('active');
                }
            }

            // If no match, highlight implicit deny
            if (!result.matched) {
                const implicitRule = document.getElementById('rule-implicit');
                implicitRule.classList.add('active', 'matched');
            }

            await sleep(500);

            // Complete animation based on result
            if (result.action === 'permit') {
                packet.classList.add('permitted');
                packet.style.left = 'calc(100% - 100px)';

                await sleep(1000);

                document.getElementById('simResult').className = 'sim-result permit';
                document.getElementById('simResult').innerHTML = `
                    PACKET PERMITTED
                    <div class="detail">Matched rule ${matchedRuleNum}: ${result.rule ? result.rule.action + ' ' + result.rule.protocol : 'N/A'}</div>
                `;
            } else {
                packet.classList.add('denied');

                await sleep(300);
                packet.style.opacity = '0';
                packet.style.transform = 'scale(0.3)';

                await sleep(500);

                document.getElementById('simResult').className = 'sim-result deny';
                if (result.matched) {
                    document.getElementById('simResult').innerHTML = `
                        PACKET DENIED
                        <div class="detail">Matched rule ${matchedRuleNum}: ${result.rule.action} ${result.rule.protocol}</div>
                    `;
                } else {
                    document.getElementById('simResult').innerHTML = `
                        PACKET DENIED
                        <div class="detail">No matching rule - Implicit deny at end of ACL</div>
                    `;
                }
            }
        }

        function resetSimulation() {
            const packet = document.getElementById('packetVisual');
            packet.className = 'packet-visual';
            packet.style.transition = 'none';
            packet.style.left = '30px';
            packet.style.opacity = '0';
            packet.style.transform = 'scale(1)';

            document.querySelectorAll('.acl-rule').forEach(r => {
                r.classList.remove('active', 'matched');
            });

            document.getElementById('simResult').className = 'sim-result waiting';
            document.getElementById('simResult').innerHTML = `
                Configure a packet and click "Simulate" to see the result
                <div class="detail">The packet will be evaluated against each ACL rule in order</div>
            `;
        }

        function loadPreset(preset) {
            const presets = {
                httpAllowed: { srcIP: '192.168.1.100', dstIP: '10.0.0.50', protocol: 'tcp', dstPort: '80' },
                telnetBlocked: { srcIP: '192.168.1.100', dstIP: '10.0.0.50', protocol: 'tcp', dstPort: '23' },
                sshAdmin: { srcIP: '192.168.100.50', dstIP: '10.0.0.50', protocol: 'tcp', dstPort: '22' },
                icmpPing: { srcIP: '192.168.1.100', dstIP: '10.0.0.50', protocol: 'icmp', dstPort: '' },
                unknownSrc: { srcIP: '172.16.99.99', dstIP: '10.0.0.50', protocol: 'tcp', dstPort: '80' }
            };

            const p = presets[preset];
            document.getElementById('simSrcIP').value = p.srcIP;
            document.getElementById('simDstIP').value = p.dstIP;
            document.getElementById('simProtocol').value = p.protocol;
            if (p.dstPort) {
                document.getElementById('simDstPort').value = p.dstPort;
            }
            updatePortOptions();
            resetSimulation();
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // Initialize
        renderAclRules();
        updatePortOptions();
    </script>
<script src="../../../../components/FluxCapacitor.js"></script>
</body>
</html>
