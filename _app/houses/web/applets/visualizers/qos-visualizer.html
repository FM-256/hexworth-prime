<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QoS Visualizer - Interactive Learning Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            color: white;
            padding: 30px 0;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .back-link {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            text-decoration: none;
            font-size: 1.1em;
            opacity: 0.8;
            transition: opacity 0.3s;
        }

        .back-link:hover {
            opacity: 1;
        }

        .tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 15px 30px;
            background: rgba(255,255,255,0.1);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1em;
            transition: all 0.3s;
        }

        .tab-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        .tab-btn.active {
            background: white;
            color: #7c3aed;
            border-color: white;
        }

        .tab-content {
            display: none;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .tab-content.active {
            display: block;
        }

        h2 {
            color: #7c3aed;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        h3 {
            color: #6d28d9;
            margin: 25px 0 15px;
            font-size: 1.4em;
        }

        .dscp-explorer {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 20px 0;
        }

        .dscp-list {
            max-height: 600px;
            overflow-y: auto;
        }

        .dscp-item {
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .dscp-item:hover {
            transform: translateX(5px);
            border-color: #7c3aed;
        }

        .dscp-item.ef {
            background: linear-gradient(135deg, #fecaca, #fee2e2);
        }

        .dscp-item.af4 {
            background: linear-gradient(135deg, #fed7aa, #ffedd5);
        }

        .dscp-item.af3 {
            background: linear-gradient(135deg, #fde68a, #fef3c7);
        }

        .dscp-item.af2 {
            background: linear-gradient(135deg, #a7f3d0, #d1fae5);
        }

        .dscp-item.af1 {
            background: linear-gradient(135deg, #bfdbfe, #dbeafe);
        }

        .dscp-item.cs, .dscp-item.default {
            background: linear-gradient(135deg, #e5e7eb, #f3f4f6);
        }

        .dscp-detail {
            background: #f8fafc;
            padding: 30px;
            border-radius: 15px;
            border: 3px solid #7c3aed;
        }

        .detail-header {
            font-size: 2em;
            color: #7c3aed;
            margin-bottom: 20px;
            text-align: center;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            margin: 10px 0;
            background: white;
            border-radius: 8px;
        }

        .detail-label {
            font-weight: bold;
            color: #6d28d9;
        }

        .queue-simulator {
            margin: 30px 0;
        }

        .queue-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            font-weight: bold;
        }

        .btn-primary {
            background: #7c3aed;
            color: white;
        }

        .btn-primary:hover {
            background: #6d28d9;
        }

        .btn-secondary {
            background: #e5e7eb;
            color: #374151;
        }

        .btn-secondary:hover {
            background: #d1d5db;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .queue-display {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .queue-container {
            border: 3px solid #7c3aed;
            border-radius: 15px;
            padding: 20px;
            min-width: 200px;
            background: #faf5ff;
        }

        .queue-label {
            font-weight: bold;
            color: #7c3aed;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.1em;
        }

        .queue-packets {
            display: flex;
            flex-direction: column;
            gap: 8px;
            min-height: 300px;
        }

        .packet-box {
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            color: white;
            font-weight: bold;
            animation: packetAppear 0.3s ease-out;
        }

        @keyframes packetAppear {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .packet-voice {
            background: #ef4444;
        }

        .packet-video {
            background: #f59e0b;
        }

        .packet-data {
            background: #3b82f6;
        }

        .packet-bulk {
            background: #6b7280;
        }

        .stats-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #7c3aed, #a855f7);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-top: 5px;
        }

        .shaper-visual {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }

        .shaper-box {
            padding: 30px;
            border-radius: 15px;
            border: 3px solid;
        }

        .shaper-box.policing {
            border-color: #ef4444;
            background: #fef2f2;
        }

        .shaper-box.shaping {
            border-color: #10b981;
            background: #f0fdf4;
        }

        .token-bucket {
            width: 200px;
            height: 200px;
            margin: 20px auto;
            position: relative;
        }

        .bucket {
            width: 100%;
            height: 100%;
            border: 4px solid #374151;
            border-radius: 0 0 20px 20px;
            background: linear-gradient(to top, #3b82f6 0%, #3b82f6 50%, #f3f4f6 50%);
            position: relative;
            overflow: hidden;
        }

        .bucket-fill {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, #7c3aed, #a855f7);
            transition: height 0.5s ease;
        }

        .bucket-label {
            position: absolute;
            bottom: -30px;
            left: 0;
            right: 0;
            text-align: center;
            font-weight: bold;
            color: #374151;
        }

        .traffic-slider {
            margin: 20px 0;
        }

        .traffic-slider input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #d1d5db;
            outline: none;
        }

        .traffic-slider input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #7c3aed;
            cursor: pointer;
        }

        .quiz-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .quiz-question {
            background: #f8fafc;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
        }

        .quiz-question h4 {
            color: #7c3aed;
            margin-bottom: 20px;
            font-size: 1.2em;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quiz-option {
            padding: 15px 20px;
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quiz-option:hover {
            border-color: #7c3aed;
            background: #faf5ff;
        }

        .quiz-option.selected {
            border-color: #7c3aed;
            background: #ede9fe;
        }

        .quiz-option.correct {
            border-color: #10b981;
            background: #d1fae5;
        }

        .quiz-option.incorrect {
            border-color: #ef4444;
            background: #fee2e2;
        }

        .quiz-feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 10px;
            display: none;
        }

        .quiz-feedback.show {
            display: block;
        }

        .quiz-feedback.correct {
            background: #d1fae5;
            color: #065f46;
        }

        .quiz-feedback.incorrect {
            background: #fee2e2;
            color: #991b1b;
        }

        .quiz-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
        }

        .score-display {
            font-size: 1.2em;
            color: #7c3aed;
            font-weight: bold;
        }

        .info-box {
            background: #ede9fe;
            border-left: 4px solid #a855f7;
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 0 10px 10px 0;
        }

        .warning-box {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 0 10px 10px 0;
        }

        select, input[type="number"] {
            padding: 10px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1em;
            background: white;
        }

        @media (max-width: 900px) {
            .dscp-explorer, .shaper-visual {
                grid-template-columns: 1fr;
            }

            .queue-display {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <a href="../../index.html" class="back-link">‚Üê Back to Catalog</a>

    <div class="container">
        <header>
            <h1>üéØ QoS Visualizer</h1>
            <p>Interactive Quality of Service Learning Tool</p>
        </header>

        <div class="tabs">
            <button class="tab-btn active" data-tab="dscp">DSCP/CoS Mapper</button>
            <button class="tab-btn" data-tab="queue">Queue Simulator</button>
            <button class="tab-btn" data-tab="shaper">Traffic Shaper</button>
            <button class="tab-btn" data-tab="quiz">Quiz</button>
        </div>

        <!-- Tab 1: DSCP/CoS Mapper -->
        <div id="dscp" class="tab-content active">
            <h2>DSCP & CoS Value Explorer</h2>
            <p>Click on any DSCP value to see detailed information and CoS mapping:</p>

            <div class="dscp-explorer">
                <div class="dscp-list" id="dscp-list">
                    <!-- Populated by JavaScript -->
                </div>

                <div class="dscp-detail" id="dscp-detail">
                    <div class="detail-header">Select a DSCP value</div>
                    <p style="text-align: center; color: #6b7280;">Click any DSCP value on the left to see detailed information</p>
                </div>
            </div>

            <div class="info-box">
                <strong>DSCP Quick Reference:</strong> EF (46) for voice, AF4x for video, AF3x for critical data, AF2x for transactional data, AF1x for bulk data, DF/CS0 (0) for best effort.
            </div>
        </div>

        <!-- Tab 2: Queue Simulator -->
        <div id="queue" class="tab-content">
            <h2>Queuing Mechanism Simulator</h2>
            <p>See how different queuing mechanisms handle packet prioritization:</p>

            <div class="queue-controls">
                <label>
                    Queuing Method:
                    <select id="queue-method" onchange="updateQueueDisplay()">
                        <option value="fifo">FIFO (First In, First Out)</option>
                        <option value="pq">Priority Queuing (PQ)</option>
                        <option value="llq" selected>Low Latency Queuing (LLQ)</option>
                    </select>
                </label>
                <button class="btn btn-primary" onclick="addRandomPacket()">Add Random Packet</button>
                <button class="btn btn-secondary" onclick="processPacket()">Process Next Packet</button>
                <button class="btn btn-danger" onclick="clearQueues()">Clear All Queues</button>
            </div>

            <div class="queue-display" id="queue-display">
                <!-- Populated by JavaScript -->
            </div>

            <div class="stats-panel">
                <div class="stat-card">
                    <div class="stat-value" id="stat-voice">0</div>
                    <div class="stat-label">Voice Packets Processed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="stat-video">0</div>
                    <div class="stat-label">Video Packets Processed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="stat-data">0</div>
                    <div class="stat-label">Data Packets Processed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="stat-bulk">0</div>
                    <div class="stat-label">Bulk Packets Processed</div>
                </div>
            </div>

            <div class="info-box">
                <strong>How it works:</strong> Click "Add Random Packet" to generate traffic, then click "Process Next Packet" to see which packet gets transmitted first based on the selected queuing method.
            </div>
        </div>

        <!-- Tab 3: Traffic Shaper -->
        <div id="shaper" class="tab-content">
            <h2>Policing vs Shaping - Token Bucket Demo</h2>
            <p>Visualize the difference between policing and shaping with the token bucket algorithm:</p>

            <div class="traffic-slider">
                <label><strong>Traffic Rate:</strong> <span id="traffic-rate">500</span> Kbps</label>
                <input type="range" min="0" max="2000" value="500" step="100" oninput="updateTraffic(this.value)">
            </div>

            <div class="traffic-slider">
                <label><strong>Configured Rate (CIR):</strong> <span id="cir-rate">1000</span> Kbps</label>
                <input type="range" min="500" max="2000" value="1000" step="100" oninput="updateCIR(this.value)">
            </div>

            <div class="shaper-visual">
                <div class="shaper-box policing">
                    <h3 style="color: #dc2626; text-align: center;">üö® Policing</h3>
                    <div class="token-bucket">
                        <div class="bucket">
                            <div class="bucket-fill" id="police-fill"></div>
                        </div>
                        <div class="bucket-label">Token Bucket</div>
                    </div>
                    <div style="text-align: center; margin-top: 20px;">
                        <div style="font-weight: bold; font-size: 1.2em; color: #dc2626;">Action: <span id="police-action">FORWARD</span></div>
                        <div style="margin-top: 10px;" id="police-dropped">Packets Dropped: 0</div>
                    </div>
                    <div class="info-box" style="margin-top: 20px;">
                        <strong>Policing:</strong> Excess traffic is immediately dropped. No buffering occurs.
                    </div>
                </div>

                <div class="shaper-box shaping">
                    <h3 style="color: #059669; text-align: center;">üìä Shaping</h3>
                    <div class="token-bucket">
                        <div class="bucket">
                            <div class="bucket-fill" id="shape-fill"></div>
                        </div>
                        <div class="bucket-label">Token Bucket</div>
                    </div>
                    <div style="text-align: center; margin-top: 20px;">
                        <div style="font-weight: bold; font-size: 1.2em; color: #059669;">Action: <span id="shape-action">FORWARD</span></div>
                        <div style="margin-top: 10px;" id="shape-buffered">Packets Buffered: 0</div>
                    </div>
                    <div class="info-box" style="margin-top: 20px;">
                        <strong>Shaping:</strong> Excess traffic is buffered and delayed. Smoother traffic flow.
                    </div>
                </div>
            </div>

            <div class="warning-box">
                <strong>Key Difference:</strong> Policing drops excess traffic (can cause TCP retransmissions), while shaping buffers it (increases delay but reduces loss).
            </div>
        </div>

        <!-- Tab 4: Quiz -->
        <div id="quiz" class="tab-content">
            <h2>QoS Knowledge Check</h2>
            <div class="quiz-container">
                <div id="quiz-area">
                    <!-- Quiz populated by JavaScript -->
                </div>
                <div class="quiz-controls">
                    <div class="score-display" id="score-display">Score: 0/0</div>
                    <div>
                        <button class="btn btn-secondary" onclick="resetQuiz()">Restart Quiz</button>
                        <button class="btn btn-primary" id="next-btn" onclick="nextQuestion()">Check Answer</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab functionality
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                btn.classList.add('active');
                document.getElementById(btn.dataset.tab).classList.add('active');
            });
        });

        // DSCP/CoS Mapper
        const dscpValues = [
            { name: 'EF', decimal: 46, binary: '101110', phb: 'Expedited Forwarding', use: 'Voice (VoIP)', cos: 5, class: 'ef', priority: 'Highest' },
            { name: 'CS5', decimal: 40, binary: '101000', phb: 'Class Selector 5', use: 'Video Signaling', cos: 5, class: 'cs', priority: 'High' },
            { name: 'AF41', decimal: 34, binary: '100010', phb: 'Assured Forwarding 41', use: 'Video (Low Drop)', cos: 4, class: 'af4', priority: 'High' },
            { name: 'AF42', decimal: 36, binary: '100100', phb: 'Assured Forwarding 42', use: 'Video (Med Drop)', cos: 4, class: 'af4', priority: 'High' },
            { name: 'AF43', decimal: 38, binary: '100110', phb: 'Assured Forwarding 43', use: 'Video (High Drop)', cos: 4, class: 'af4', priority: 'High' },
            { name: 'CS4', decimal: 32, binary: '100000', phb: 'Class Selector 4', use: 'Video', cos: 4, class: 'cs', priority: 'High' },
            { name: 'AF31', decimal: 26, binary: '011010', phb: 'Assured Forwarding 31', use: 'Critical Data (Low Drop)', cos: 3, class: 'af3', priority: 'Medium-High' },
            { name: 'AF32', decimal: 28, binary: '011100', phb: 'Assured Forwarding 32', use: 'Critical Data (Med Drop)', cos: 3, class: 'af3', priority: 'Medium-High' },
            { name: 'AF33', decimal: 30, binary: '011110', phb: 'Assured Forwarding 33', use: 'Critical Data (High Drop)', cos: 3, class: 'af3', priority: 'Medium-High' },
            { name: 'CS3', decimal: 24, binary: '011000', phb: 'Class Selector 3', use: 'Signaling', cos: 3, class: 'cs', priority: 'Medium-High' },
            { name: 'AF21', decimal: 18, binary: '010010', phb: 'Assured Forwarding 21', use: 'Transactional Data (Low Drop)', cos: 2, class: 'af2', priority: 'Medium' },
            { name: 'AF22', decimal: 20, binary: '010100', phb: 'Assured Forwarding 22', use: 'Transactional Data (Med Drop)', cos: 2, class: 'af2', priority: 'Medium' },
            { name: 'AF23', decimal: 22, binary: '010110', phb: 'Assured Forwarding 23', use: 'Transactional Data (High Drop)', cos: 2, class: 'af2', priority: 'Medium' },
            { name: 'CS2', decimal: 16, binary: '010000', phb: 'Class Selector 2', use: 'High Priority Data', cos: 2, class: 'cs', priority: 'Medium' },
            { name: 'AF11', decimal: 10, binary: '001010', phb: 'Assured Forwarding 11', use: 'Bulk Data (Low Drop)', cos: 1, class: 'af1', priority: 'Low' },
            { name: 'AF12', decimal: 12, binary: '001100', phb: 'Assured Forwarding 12', use: 'Bulk Data (Med Drop)', cos: 1, class: 'af1', priority: 'Low' },
            { name: 'AF13', decimal: 14, binary: '001110', phb: 'Assured Forwarding 13', use: 'Bulk Data (High Drop)', cos: 1, class: 'af1', priority: 'Low' },
            { name: 'CS1', decimal: 8, binary: '001000', phb: 'Class Selector 1', use: 'Scavenger', cos: 1, class: 'cs', priority: 'Low' },
            { name: 'DF (CS0)', decimal: 0, binary: '000000', phb: 'Default Forwarding', use: 'Best Effort', cos: 0, class: 'default', priority: 'Best Effort' }
        ];

        function renderDSCPList() {
            const list = document.getElementById('dscp-list');
            list.innerHTML = dscpValues.map(dscp => `
                <div class="dscp-item ${dscp.class}" onclick="showDSCPDetail(${dscp.decimal})">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong style="font-size: 1.2em;">${dscp.name}</strong>
                            <div style="font-size: 0.9em; opacity: 0.8;">DSCP ${dscp.decimal}</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 0.9em;">${dscp.use}</div>
                            <div style="font-size: 0.8em; opacity: 0.7;">CoS ${dscp.cos}</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function showDSCPDetail(decimal) {
            const dscp = dscpValues.find(d => d.decimal === decimal);
            const detail = document.getElementById('dscp-detail');
            detail.innerHTML = `
                <div class="detail-header">${dscp.name}</div>
                <div class="detail-row">
                    <span class="detail-label">DSCP Decimal:</span>
                    <span>${dscp.decimal}</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">DSCP Binary:</span>
                    <span>${dscp.binary}</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">PHB (Per-Hop Behavior):</span>
                    <span>${dscp.phb}</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Typical Use:</span>
                    <span>${dscp.use}</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">CoS Mapping:</span>
                    <span>${dscp.cos}</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Priority Level:</span>
                    <span>${dscp.priority}</span>
                </div>
                <div style="margin-top: 20px; padding: 15px; background: #ede9fe; border-radius: 8px;">
                    <strong>Configuration Example:</strong>
                    <pre style="margin-top: 10px; font-family: monospace; background: #1e293b; color: #a855f7; padding: 10px; border-radius: 5px; overflow-x: auto;">set ip dscp ${dscp.name.toLowerCase()}
! or
set ip dscp ${dscp.decimal}</pre>
                </div>
            `;
        }

        // Queue Simulator
        let queues = {
            fifo: [],
            priority: [],
            video: [],
            data: [],
            bulk: []
        };

        let stats = {
            voice: 0,
            video: 0,
            data: 0,
            bulk: 0
        };

        function updateQueueDisplay() {
            const method = document.getElementById('queue-method').value;
            const display = document.getElementById('queue-display');

            if (method === 'fifo') {
                display.innerHTML = `
                    <div class="queue-container">
                        <div class="queue-label">FIFO Queue (All Traffic)</div>
                        <div class="queue-packets" id="fifo-queue"></div>
                    </div>
                `;
            } else if (method === 'pq') {
                display.innerHTML = `
                    <div class="queue-container" style="border-color: #ef4444;">
                        <div class="queue-label">High Priority</div>
                        <div class="queue-packets" id="priority-queue"></div>
                    </div>
                    <div class="queue-container" style="border-color: #f59e0b;">
                        <div class="queue-label">Medium Priority</div>
                        <div class="queue-packets" id="video-queue"></div>
                    </div>
                    <div class="queue-container" style="border-color: #3b82f6;">
                        <div class="queue-label">Normal Priority</div>
                        <div class="queue-packets" id="data-queue"></div>
                    </div>
                    <div class="queue-container" style="border-color: #6b7280;">
                        <div class="queue-label">Low Priority</div>
                        <div class="queue-packets" id="bulk-queue"></div>
                    </div>
                `;
            } else if (method === 'llq') {
                display.innerHTML = `
                    <div class="queue-container" style="border-color: #ef4444; background: #fef2f2;">
                        <div class="queue-label">üé§ Priority Queue (Voice)</div>
                        <div class="queue-packets" id="priority-queue"></div>
                        <div style="text-align: center; margin-top: 10px; font-size: 0.9em; color: #dc2626;">Serviced FIRST</div>
                    </div>
                    <div class="queue-container" style="border-color: #f59e0b;">
                        <div class="queue-label">üìπ Video Queue</div>
                        <div class="queue-packets" id="video-queue"></div>
                    </div>
                    <div class="queue-container" style="border-color: #3b82f6;">
                        <div class="queue-label">üíº Data Queue</div>
                        <div class="queue-packets" id="data-queue"></div>
                    </div>
                    <div class="queue-container" style="border-color: #6b7280;">
                        <div class="queue-label">üì¶ Bulk Queue</div>
                        <div class="queue-packets" id="bulk-queue"></div>
                    </div>
                `;
            }

            renderQueues();
        }

        function addRandomPacket() {
            const types = ['voice', 'video', 'data', 'bulk'];
            const type = types[Math.floor(Math.random() * types.length)];
            const method = document.getElementById('queue-method').value;

            if (method === 'fifo') {
                queues.fifo.push(type);
            } else {
                if (type === 'voice') queues.priority.push(type);
                else if (type === 'video') queues.video.push(type);
                else if (type === 'data') queues.data.push(type);
                else queues.bulk.push(type);
            }

            renderQueues();
        }

        function processPacket() {
            const method = document.getElementById('queue-method').value;
            let processed = null;

            if (method === 'fifo') {
                if (queues.fifo.length > 0) {
                    processed = queues.fifo.shift();
                }
            } else {
                // Priority queuing logic
                if (queues.priority.length > 0) {
                    processed = queues.priority.shift();
                } else if (queues.video.length > 0) {
                    processed = queues.video.shift();
                } else if (queues.data.length > 0) {
                    processed = queues.data.shift();
                } else if (queues.bulk.length > 0) {
                    processed = queues.bulk.shift();
                }
            }

            if (processed) {
                stats[processed]++;
                updateStats();
            }

            renderQueues();
        }

        function clearQueues() {
            queues = {
                fifo: [],
                priority: [],
                video: [],
                data: [],
                bulk: []
            };
            renderQueues();
        }

        function renderQueues() {
            const method = document.getElementById('queue-method').value;

            if (method === 'fifo') {
                const container = document.getElementById('fifo-queue');
                if (container) {
                    container.innerHTML = queues.fifo.map(type =>
                        `<div class="packet-box packet-${type}">${type.toUpperCase()}</div>`
                    ).join('');
                }
            } else {
                ['priority', 'video', 'data', 'bulk'].forEach(q => {
                    const container = document.getElementById(`${q}-queue`);
                    if (container) {
                        const queueName = q === 'priority' ? 'priority' : q;
                        container.innerHTML = queues[queueName].map(type =>
                            `<div class="packet-box packet-${type}">${type.toUpperCase()}</div>`
                        ).join('');
                    }
                });
            }
        }

        function updateStats() {
            document.getElementById('stat-voice').textContent = stats.voice;
            document.getElementById('stat-video').textContent = stats.video;
            document.getElementById('stat-data').textContent = stats.data;
            document.getElementById('stat-bulk').textContent = stats.bulk;
        }

        // Traffic Shaper
        let trafficRate = 500;
        let cirRate = 1000;
        let policeDropped = 0;
        let shapeBuffered = 0;

        function updateTraffic(value) {
            trafficRate = parseInt(value);
            document.getElementById('traffic-rate').textContent = value;
            updateShaper();
        }

        function updateCIR(value) {
            cirRate = parseInt(value);
            document.getElementById('cir-rate').textContent = value;
            updateShaper();
        }

        function updateShaper() {
            const policeFill = document.getElementById('police-fill');
            const shapeFill = document.getElementById('shape-fill');
            const policeAction = document.getElementById('police-action');
            const shapeAction = document.getElementById('shape-action');

            // Calculate token bucket fill level (0-100%)
            const fillPercent = Math.min(100, (cirRate / 2000) * 100);
            policeFill.style.height = fillPercent + '%';
            shapeFill.style.height = fillPercent + '%';

            // Determine actions
            if (trafficRate <= cirRate) {
                policeAction.textContent = 'FORWARD';
                policeAction.style.color = '#10b981';
                shapeAction.textContent = 'FORWARD';
                shapeAction.style.color = '#10b981';
            } else {
                policeAction.textContent = 'DROP EXCESS';
                policeAction.style.color = '#ef4444';
                policeDropped += Math.floor((trafficRate - cirRate) / 100);

                shapeAction.textContent = 'BUFFER EXCESS';
                shapeAction.style.color = '#f59e0b';
                shapeBuffered += Math.floor((trafficRate - cirRate) / 100);
            }

            document.getElementById('police-dropped').textContent = `Packets Dropped: ${policeDropped}`;
            document.getElementById('shape-buffered').textContent = `Packets Buffered: ${shapeBuffered}`;
        }

        // Quiz
        const quizQuestions = [
            {
                question: "What DSCP value is used for voice traffic?",
                options: ["DSCP 0", "DSCP 26", "DSCP 34", "DSCP 46"],
                correct: 3,
                explanation: "DSCP 46 (EF - Expedited Forwarding) is the standard value for voice traffic, providing the lowest latency and highest priority."
            },
            {
                question: "What is the maximum acceptable one-way latency for VoIP calls?",
                options: ["50ms", "100ms", "150ms", "200ms"],
                correct: 2,
                explanation: "Voice requires <150ms one-way latency for acceptable quality. Above this, users notice delays in conversation."
            },
            {
                question: "What does AF stand for in DSCP terminology?",
                options: ["Automatic Forwarding", "Assured Forwarding", "Advanced Flow", "Application Filter"],
                correct: 1,
                explanation: "AF stands for Assured Forwarding. It provides 4 classes with 3 drop precedence levels each (AF11-AF43)."
            },
            {
                question: "How many bits is the CoS field?",
                options: ["3 bits (0-7)", "6 bits (0-63)", "8 bits (0-255)", "4 bits (0-15)"],
                correct: 0,
                explanation: "CoS is a 3-bit field in the 802.1Q VLAN tag, allowing values 0-7. It only exists on trunk links."
            },
            {
                question: "What is the main difference between policing and shaping?",
                options: ["Policing is Layer 2, shaping is Layer 3", "Policing drops excess, shaping buffers it", "Policing is faster", "Shaping uses more CPU"],
                correct: 1,
                explanation: "Policing drops or remarks excess traffic immediately, while shaping buffers excess traffic and delays it to smooth the flow."
            },
            {
                question: "Which queuing method is recommended for voice and data together?",
                options: ["FIFO", "WFQ", "PQ", "LLQ"],
                correct: 3,
                explanation: "LLQ (Low Latency Queuing) combines a strict priority queue for voice with class-based queuing for data, preventing starvation."
            },
            {
                question: "What does WRED stand for?",
                options: ["Weighted Random Early Detection", "Wide Range Error Detection", "Wireless Router Edge Detection", "Wait Retry Error Drop"],
                correct: 0,
                explanation: "WRED (Weighted Random Early Detection) prevents TCP global synchronization by randomly dropping packets before queues fill."
            },
            {
                question: "Where should the QoS trust boundary typically be set?",
                options: ["Core switches", "Distribution layer", "Access switches", "End-user PCs"],
                correct: 2,
                explanation: "The trust boundary should be at the access switch. Trust IP phones but remark/classify traffic from PCs at this point."
            },
            {
                question: "What is the DSCP value for AF31?",
                options: ["18", "26", "34", "46"],
                correct: 1,
                explanation: "AF31 = DSCP 26. It's commonly used for critical data applications with low drop probability."
            },
            {
                question: "What is the maximum acceptable jitter for voice traffic?",
                options: ["10ms", "20ms", "30ms", "50ms"],
                correct: 2,
                explanation: "Voice traffic requires jitter (variation in delay) to be less than 30ms for good quality. Higher jitter causes choppy audio."
            }
        ];

        let currentQuestion = 0;
        let score = 0;
        let answered = false;

        function renderQuiz() {
            const area = document.getElementById('quiz-area');
            const q = quizQuestions[currentQuestion];

            area.innerHTML = `
                <div class="quiz-question">
                    <h4>Question ${currentQuestion + 1} of ${quizQuestions.length}</h4>
                    <p style="font-size: 1.1em; margin-bottom: 20px;">${q.question}</p>
                    <div class="quiz-options">
                        ${q.options.map((opt, i) => `
                            <div class="quiz-option" onclick="selectAnswer(${i})" data-index="${i}">
                                ${opt}
                            </div>
                        `).join('')}
                    </div>
                    <div class="quiz-feedback" id="quiz-feedback"></div>
                </div>
            `;

            document.getElementById('next-btn').textContent = 'Check Answer';
            answered = false;
            updateScore();
        }

        function selectAnswer(index) {
            if (answered) return;

            document.querySelectorAll('.quiz-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            document.querySelector(`.quiz-option[data-index="${index}"]`).classList.add('selected');
        }

        function nextQuestion() {
            if (!answered) {
                const selected = document.querySelector('.quiz-option.selected');
                if (!selected) {
                    alert('Please select an answer!');
                    return;
                }

                const selectedIndex = parseInt(selected.dataset.index);
                const q = quizQuestions[currentQuestion];
                const feedback = document.getElementById('quiz-feedback');

                document.querySelectorAll('.quiz-option').forEach((opt, i) => {
                    if (i === q.correct) {
                        opt.classList.add('correct');
                    } else if (i === selectedIndex && selectedIndex !== q.correct) {
                        opt.classList.add('incorrect');
                    }
                });

                if (selectedIndex === q.correct) {
                    score++;
                    feedback.className = 'quiz-feedback show correct';
                    feedback.innerHTML = `‚úÖ Correct! ${q.explanation}`;
                } else {
                    feedback.className = 'quiz-feedback show incorrect';
                    feedback.innerHTML = `‚ùå Incorrect. ${q.explanation}`;
                }

                answered = true;
                updateScore();

                if (currentQuestion < quizQuestions.length - 1) {
                    document.getElementById('next-btn').textContent = 'Next Question ‚Üí';
                } else {
                    document.getElementById('next-btn').textContent = 'See Results';
                }
            } else {
                currentQuestion++;
                if (currentQuestion < quizQuestions.length) {
                    renderQuiz();
                } else {
                    showResults();
                }
            }
        }

        function updateScore() {
            document.getElementById('score-display').textContent = `Score: ${score}/${answered ? currentQuestion + 1 : currentQuestion}`;
        }

        function showResults() {
            const area = document.getElementById('quiz-area');
            const percentage = Math.round((score / quizQuestions.length) * 100);
            let message, color;

            if (percentage >= 90) {
                message = "üèÜ Excellent! You're a QoS expert!";
                color = "#10b981";
            } else if (percentage >= 70) {
                message = "üëç Good job! You understand QoS well.";
                color = "#3b82f6";
            } else if (percentage >= 50) {
                message = "üìö Not bad, but review DSCP values and queuing methods.";
                color = "#f59e0b";
            } else {
                message = "üìñ Keep studying! Review QoS fundamentals.";
                color = "#ef4444";
            }

            area.innerHTML = `
                <div style="text-align: center; padding: 40px;">
                    <div style="font-size: 4em; margin-bottom: 20px;">üéØ</div>
                    <h3 style="font-size: 2em; color: ${color};">You scored ${score}/${quizQuestions.length} (${percentage}%)</h3>
                    <p style="font-size: 1.3em; margin: 20px 0;">${message}</p>
                </div>
            `;

            document.getElementById('next-btn').style.display = 'none';
        }

        function resetQuiz() {
            currentQuestion = 0;
            score = 0;
            answered = false;
            document.getElementById('next-btn').style.display = 'inline-block';
            renderQuiz();
        }

        // Initialize
        renderDSCPList();
        updateQueueDisplay();
        updateShaper();
        renderQuiz();

        // Start shaper animation
        setInterval(() => {
            if (trafficRate > cirRate) {
                updateShaper();
            }
        }, 1000);
    </script>
</body>
</html>
