<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOC Simulator - Eye House - Hexworth Prime</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0a1e 0%, #1a0b2e 100%);
            color: #e0e0e0;
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #c084fc 0%, #06b6d4 100%);
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(192, 132, 252, 0.3);
        }

        h1 {
            font-size: 2.5em;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 1.2em;
            color: #f0f0f0;
            margin-top: 10px;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .panel {
            background: rgba(30, 20, 50, 0.6);
            border-radius: 12px;
            padding: 25px;
            border: 2px solid rgba(192, 132, 252, 0.3);
            backdrop-filter: blur(10px);
        }

        .panel h2 {
            color: #c084fc;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 2px solid #06b6d4;
            padding-bottom: 10px;
        }

        .alert-queue {
            max-height: 500px;
            overflow-y: auto;
        }

        .alert-card {
            background: linear-gradient(135deg, rgba(192, 132, 252, 0.1) 0%, rgba(6, 182, 212, 0.1) 100%);
            border: 2px solid rgba(192, 132, 252, 0.4);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .alert-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(192, 132, 252, 0.3);
            border-color: #c084fc;
        }

        .alert-card.selected {
            border-color: #06b6d4;
            background: linear-gradient(135deg, rgba(6, 182, 212, 0.2) 0%, rgba(192, 132, 252, 0.2) 100%);
        }

        .alert-card.triaged {
            opacity: 0.5;
            border-color: #22c55e;
        }

        .alert-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .alert-id {
            font-family: 'Courier New', monospace;
            color: #06b6d4;
            font-weight: bold;
        }

        .severity-badge {
            padding: 5px 12px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.85em;
        }

        .severity-critical { background: #ef4444; color: white; }
        .severity-high { background: #f97316; color: white; }
        .severity-medium { background: #fbbf24; color: #1a0b2e; }
        .severity-low { background: #22c55e; color: white; }

        .alert-title {
            font-size: 1.1em;
            font-weight: bold;
            color: #c084fc;
            margin-bottom: 8px;
        }

        .alert-details {
            font-size: 0.95em;
            color: #b0b0b0;
        }

        .alert-time {
            font-size: 0.85em;
            color: #06b6d4;
            margin-top: 8px;
        }

        .investigation-panel {
            background: rgba(20, 15, 35, 0.8);
            border: 2px solid #06b6d4;
            border-radius: 12px;
            padding: 25px;
            min-height: 400px;
        }

        .no-selection {
            text-align: center;
            color: #666;
            padding: 50px;
            font-size: 1.1em;
        }

        .investigation-details h3 {
            color: #06b6d4;
            margin: 20px 0 10px 0;
        }

        .info-grid {
            display: grid;
            grid-template-columns: 150px 1fr;
            gap: 10px;
            margin: 15px 0;
            font-size: 0.95em;
        }

        .info-label {
            color: #c084fc;
            font-weight: bold;
        }

        .info-value {
            color: #e0e0e0;
            font-family: 'Courier New', monospace;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 120px;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn-tp {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }

        .btn-fp {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            color: white;
        }

        .btn-btp {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: #1a0b2e;
        }

        .btn-escalate {
            background: linear-gradient(135deg, #c084fc 0%, #a855f7 100%);
            color: white;
        }

        .metrics-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .metric-box {
            background: linear-gradient(135deg, rgba(192, 132, 252, 0.15) 0%, rgba(6, 182, 212, 0.15) 100%);
            border: 2px solid rgba(192, 132, 252, 0.4);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }

        .metric-value {
            font-size: 2.5em;
            color: #06b6d4;
            font-weight: bold;
        }

        .metric-label {
            color: #c084fc;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .handoff-panel {
            background: rgba(20, 15, 35, 0.8);
            border: 2px solid #c084fc;
            border-radius: 12px;
            padding: 25px;
        }

        .handoff-note {
            background: rgba(192, 132, 252, 0.1);
            border-left: 4px solid #06b6d4;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .runbook-panel {
            max-height: 500px;
            overflow-y: auto;
        }

        .runbook-item {
            background: rgba(6, 182, 212, 0.1);
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .runbook-item:hover {
            border-color: #06b6d4;
            background: rgba(6, 182, 212, 0.2);
        }

        .runbook-title {
            color: #06b6d4;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .runbook-content {
            display: none;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(6, 182, 212, 0.3);
            color: #b0b0b0;
            font-size: 0.9em;
        }

        .runbook-item.expanded .runbook-content {
            display: block;
        }

        .tab-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab-btn {
            padding: 10px 20px;
            background: rgba(192, 132, 252, 0.2);
            border: 2px solid rgba(192, 132, 252, 0.4);
            border-radius: 8px;
            color: #c084fc;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab-btn:hover {
            background: rgba(192, 132, 252, 0.3);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #c084fc 0%, #a855f7 100%);
            color: white;
            border-color: #c084fc;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .timeline-event {
            background: rgba(192, 132, 252, 0.1);
            border-left: 3px solid #06b6d4;
            padding: 12px;
            margin: 10px 0 10px 20px;
            border-radius: 5px;
        }

        .timeline-time {
            color: #06b6d4;
            font-weight: bold;
            font-size: 0.85em;
        }

        .timeline-action {
            color: #e0e0e0;
            margin-top: 5px;
        }

        .log-viewer {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #c084fc;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            max-height: 300px;
            overflow-y: auto;
            color: #22c55e;
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(34, 197, 94, 0.4);
            z-index: 1000;
            animation: slideInRight 0.3s ease-out;
            display: none;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @media (max-width: 1024px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

        .progress-bar {
            background: rgba(192, 132, 252, 0.2);
            border-radius: 10px;
            height: 30px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(135deg, #c084fc 0%, #06b6d4 100%);
            height: 100%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .scrollbar-custom::-webkit-scrollbar {
            width: 8px;
        }

        .scrollbar-custom::-webkit-scrollbar-track {
            background: rgba(192, 132, 252, 0.1);
            border-radius: 10px;
        }

        .scrollbar-custom::-webkit-scrollbar-thumb {
            background: #c084fc;
            border-radius: 10px;
        }

        .scrollbar-custom::-webkit-scrollbar-thumb:hover {
            background: #a855f7;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div style="font-size: 3em; margin-bottom: 10px;">üëÅÔ∏è‚Äçüó®Ô∏è</div>
            <h1>SOC Simulator</h1>
            <p class="subtitle">Practice Real-World Security Operations Center Workflows</p>
            <p class="subtitle">Eye House - Detection & Visibility</p>
        </header>

        <div class="tab-nav">
            <button class="tab-btn active" onclick="switchTab('simulator')">üö® Alert Triage</button>
            <button class="tab-btn" onclick="switchTab('metrics')">üìä Metrics Dashboard</button>
            <button class="tab-btn" onclick="switchTab('handoff')">üîÑ Shift Handoff</button>
            <button class="tab-btn" onclick="switchTab('runbooks')">üìñ Runbooks</button>
        </div>

        <!-- Tab 1: Alert Triage Simulator -->
        <div id="tab-simulator" class="tab-content active">
            <div class="main-grid">
                <div class="panel">
                    <h2>üì• Alert Queue</h2>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressBar" style="width: 0%">0 / 10 Triaged</div>
                    </div>
                    <div class="alert-queue scrollbar-custom" id="alertQueue">
                        <!-- Alerts will be populated by JavaScript -->
                    </div>
                    <div class="btn-group" style="margin-top: 15px;">
                        <button class="btn btn-escalate" onclick="loadNewAlerts()">üîÑ Load New Alerts</button>
                    </div>
                </div>

                <div class="panel">
                    <h2>üîç Alert Investigation</h2>
                    <div class="investigation-panel" id="investigationPanel">
                        <div class="no-selection">
                            üëÜ Select an alert from the queue to begin investigation
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab 2: Metrics Dashboard -->
        <div id="tab-metrics" class="tab-content">
            <div class="panel">
                <h2>üìä SOC Performance Metrics</h2>
                <div class="metrics-panel" id="metricsPanel">
                    <!-- Metrics will be populated by JavaScript -->
                </div>
                <div style="margin-top: 30px;">
                    <h3 style="color: #c084fc;">Alert Triage Timeline</h3>
                    <div id="timeline" style="margin-top: 20px;">
                        <p style="color: #666; text-align: center; padding: 30px;">Triage alerts to build your timeline...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab 3: Shift Handoff -->
        <div id="tab-handoff" class="tab-content">
            <div class="panel">
                <h2>üîÑ Shift Handoff Report Generator</h2>
                <div class="handoff-panel">
                    <h3 style="color: #06b6d4; margin-bottom: 15px;">Current Shift Summary</h3>
                    <div id="handoffContent">
                        <p style="color: #666; text-align: center; padding: 30px;">Triage alerts to generate handoff notes...</p>
                    </div>
                    <div class="btn-group" style="margin-top: 20px;">
                        <button class="btn btn-escalate" onclick="generateHandoff()">üìù Generate Handoff Report</button>
                        <button class="btn btn-fp" onclick="copyHandoff()">üìã Copy to Clipboard</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab 4: Runbooks -->
        <div id="tab-runbooks" class="tab-content">
            <div class="panel">
                <h2>üìñ SOC Runbook Library</h2>
                <p style="margin-bottom: 20px; color: #b0b0b0;">Click on a runbook to view step-by-step investigation procedures.</p>
                <div class="runbook-panel scrollbar-custom" id="runbookPanel">
                    <!-- Runbooks will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <div class="toast" id="toast"></div>
    </div>

    <script>
        // Alert database
        const alertDatabase = [
            {
                id: 'ALT-2025-001',
                severity: 'high',
                title: 'Multiple Failed Login Attempts Detected',
                source: 'SIEM - Windows Security Logs',
                description: 'User account "admin" experienced 47 failed login attempts from IP 185.220.101.45 in 5 minutes.',
                details: {
                    user: 'admin',
                    sourceIP: '185.220.101.45',
                    targetSystem: 'DC01-PROD (10.0.1.10)',
                    timeframe: '2025-12-21 14:23:00 - 14:28:00 UTC',
                    attempts: '47 failed, 0 successful',
                    geolocation: 'Russia (Moscow)'
                },
                logs: `2025-12-21 14:23:15 [FAILED] Login attempt from 185.220.101.45 - User: admin
2025-12-21 14:23:22 [FAILED] Login attempt from 185.220.101.45 - User: admin
2025-12-21 14:23:28 [FAILED] Login attempt from 185.220.101.45 - User: admin
[... 44 more similar entries ...]
2025-12-21 14:28:03 [FAILED] Login attempt from 185.220.101.45 - User: admin`,
                context: 'Known TOR exit node IP address. No successful logins observed. Account lockout policy triggered after 5 attempts.',
                correctAnswer: 'tp',
                explanation: {
                    tp: 'Correct! This is a brute force attack attempt against a privileged account from a TOR exit node. While unsuccessful due to account lockout, this is a True Positive requiring escalation for IP blocking and monitoring.',
                    fp: 'Incorrect. 47 failed login attempts from a TOR exit node targeting an admin account is clearly malicious activity, not a false positive.',
                    btp: 'Incorrect. This is not authorized activity. Legitimate admins would not repeatedly fail login attempts from foreign IPs.'
                }
            },
            {
                id: 'ALT-2025-002',
                severity: 'critical',
                title: 'EDR: Ransomware Behavior Detected',
                source: 'CrowdStrike Falcon - Behavioral Detection',
                description: 'Process "svchost.exe" (PID 4728) is rapidly encrypting files with .locked extension on FIN-WS-089.',
                details: {
                    user: 'jsmith (Finance Department)',
                    hostname: 'FIN-WS-089 (10.20.30.89)',
                    process: 'C:\\Windows\\Temp\\svchost.exe (PID 4728)',
                    behavior: 'Mass file encryption, shadow copy deletion, ransom note creation',
                    filesAffected: '1,247 files encrypted in 3 minutes',
                    networkActivity: 'Outbound HTTPS to 45.142.212.61:443'
                },
                logs: `2025-12-21 15:42:12 [PROCESS] svchost.exe started from C:\\Windows\\Temp
2025-12-21 15:42:18 [FILE] C:\\Users\\jsmith\\Documents\\report.xlsx ‚Üí report.xlsx.locked
2025-12-21 15:42:19 [FILE] C:\\Users\\jsmith\\Documents\\budget.xlsx ‚Üí budget.xlsx.locked
2025-12-21 15:42:20 [COMMAND] vssadmin delete shadows /all /quiet
2025-12-21 15:42:25 [NETWORK] HTTPS connection to 45.142.212.61:443 (C2)
2025-12-21 15:44:30 [FILE] README_DECRYPT.txt created`,
                context: 'Legitimate svchost.exe resides in C:\\Windows\\System32, not \\Temp. VirusTotal: 68/70 detect as RansomEXX variant.',
                correctAnswer: 'tp',
                explanation: {
                    tp: 'CORRECT! This is active ransomware requiring IMMEDIATE escalation and containment. Isolate the host NOW, disable user account, block C2 IP, notify incident commander.',
                    fp: 'CRITICAL ERROR! This is confirmed ransomware. Calling this a FP would allow the attack to continue and spread. Always escalate suspected ransomware.',
                    btp: 'CRITICAL ERROR! Ransomware is never authorized activity. This classification would delay critical response.'
                }
            },
            {
                id: 'ALT-2025-003',
                severity: 'medium',
                title: 'Unusual PowerShell Execution',
                source: 'EDR - Command Line Monitoring',
                description: 'PowerShell executed with encoded command on HR-WS-042 by user mchen.',
                details: {
                    user: 'mchen (HR Department - System Administrator)',
                    hostname: 'HR-WS-042 (10.20.15.42)',
                    command: 'powershell.exe -EncodedCommand JABjAG8AbQBwAHUAdABlAHIAUwB5AHMAdABlAG0A...',
                    decodedCommand: 'Get-ComputerInfo | Export-Csv C:\\Temp\\system-inventory.csv',
                    parentProcess: 'explorer.exe (user-initiated)',
                    networkActivity: 'No outbound connections'
                },
                logs: `2025-12-21 10:15:33 [PROCESS] powershell.exe -EncodedCommand JABjAG8AbQBwAHUAdABlAHIAUwB5AHMAdABlAG0A...
2025-12-21 10:15:34 [DECODE] Get-ComputerInfo | Export-Csv C:\\Temp\\system-inventory.csv
2025-12-21 10:15:41 [FILE] C:\\Temp\\system-inventory.csv created (124 KB)
2025-12-21 10:15:42 [PROCESS] powershell.exe terminated normally`,
                context: 'User mchen has IT admin privileges. Ticket #IT-5521 shows approved task to inventory HR systems today.',
                correctAnswer: 'btp',
                explanation: {
                    tp: 'Incorrect. While encoded PowerShell is suspicious, investigation shows this is authorized IT activity documented in a change ticket.',
                    fp: 'Close! This is technically true (PowerShell WAS executed), but since it\'s authorized admin work, BTP is more accurate.',
                    btp: 'Correct! The activity is suspicious and correctly flagged, but it\'s authorized IT administration per ticket #IT-5521. Document the justification and close.'
                }
            },
            {
                id: 'ALT-2025-004',
                severity: 'low',
                title: 'Web Application Firewall - SQL Injection Attempt',
                source: 'ModSecurity WAF - Rule 942100',
                description: 'SQL injection pattern detected in HTTP POST request to /api/users endpoint.',
                details: {
                    sourceIP: '192.168.100.15',
                    targetURL: 'https://app.company.com/api/users',
                    payload: "username=admin' OR '1'='1-- &password=test",
                    userAgent: 'Acunetix Web Vulnerability Scanner',
                    action: 'Request blocked by WAF',
                    user: 'Mapped to security@company.com (Security Team)'
                },
                logs: `2025-12-21 11:30:15 [WAF] SQL Injection detected from 192.168.100.15
2025-12-21 11:30:15 [BLOCK] Request blocked - Rule 942100 (SQL Injection)
2025-12-21 11:30:15 [PAYLOAD] username=admin' OR '1'='1-- &password=test
2025-12-21 11:30:15 [UA] Acunetix Web Vulnerability Scanner
2025-12-21 11:30:15 [ACTION] HTTP 403 Forbidden returned`,
                context: 'Source IP is from Security Team network. Calendar shows scheduled vulnerability scan today. User agent confirms Acunetix scanner.',
                correctAnswer: 'btp',
                explanation: {
                    tp: 'Incorrect. This is an authorized security scan by your own team, not a real attack.',
                    fp: 'Incorrect. The WAF correctly detected SQL injection syntax - it\'s not a false positive. It\'s a BTP (authorized security testing).',
                    btp: 'Correct! This is an authorized vulnerability scan by the Security Team. The detection is accurate (true positive) but the activity is benign (authorized). Whitelist the scanner IP if this causes repeated alerts.'
                }
            },
            {
                id: 'ALT-2025-005',
                severity: 'medium',
                title: 'Impossible Travel - User Login from Multiple Countries',
                source: 'Azure AD - Conditional Access',
                description: 'User lmartinez logged in from USA and China within 30 minutes.',
                details: {
                    user: 'lmartinez (Sales Department)',
                    firstLogin: 'New York, USA (40.7128¬∞N, 74.0060¬∞W) - 2025-12-21 08:15 UTC',
                    secondLogin: 'Beijing, China (39.9042¬∞N, 116.4074¬∞E) - 2025-12-21 08:42 UTC',
                    timeElapsed: '27 minutes',
                    physicalDistance: '11,000 km',
                    devices: 'Windows 10 laptop (USA), Android phone (China)',
                    ipAddresses: '198.51.100.42 (USA), 202.108.22.5 (China)'
                },
                logs: `2025-12-21 08:15:22 [LOGIN] User: lmartinez | IP: 198.51.100.42 | Location: New York, USA | Device: WIN10-LAPTOP
2025-12-21 08:42:18 [LOGIN] User: lmartinez | IP: 202.108.22.5 | Location: Beijing, China | Device: Android-SM-G991U
2025-12-21 08:42:19 [ALERT] Impossible travel detected - 11,000 km in 27 minutes`,
                context: 'User contacted - confirms travel to China for business meetings. VPN used on laptop (USA IP), actual location is Beijing.',
                correctAnswer: 'btp',
                explanation: {
                    tp: 'Incorrect. While this looks like credential compromise, the user confirms international travel and the VPN explains the USA IP.',
                    fp: 'Incorrect. The alert correctly identified geographically impossible travel - the detection is accurate, even if the activity is legitimate.',
                    btp: 'Correct! The impossible travel detection is accurate, but the user is legitimately traveling. The USA login was via VPN (maintaining corporate access) while physically in China. Document and consider VPN detection tuning.'
                }
            },
            {
                id: 'ALT-2025-006',
                severity: 'low',
                title: 'Antivirus Detection - PUA (Potentially Unwanted Application)',
                source: 'Windows Defender - Real-time Protection',
                description: 'PUA:Win32/DriverUpdate detected and quarantined on MKT-WS-015.',
                details: {
                    user: 'rjohnson (Marketing Department)',
                    hostname: 'MKT-WS-015',
                    fileName: 'DriverUpdateTool.exe',
                    filePath: 'C:\\Users\\rjohnson\\Downloads\\DriverUpdateTool.exe',
                    detectionType: 'Potentially Unwanted Application',
                    action: 'Quarantined automatically',
                    virusTotalScore: '8/70 (low detection)'
                },
                logs: `2025-12-21 13:22:10 [DOWNLOAD] DriverUpdateTool.exe from driver-update[.]net
2025-12-21 13:22:15 [SCAN] Windows Defender real-time scan triggered
2025-12-21 13:22:16 [DETECT] PUA:Win32/DriverUpdate - Low severity
2025-12-21 13:22:16 [QUARANTINE] File quarantined automatically
2025-12-21 13:22:17 [NOTIFY] User notification displayed`,
                context: 'PUA = Potentially Unwanted Application (adware, bundleware). Not malware, but not recommended. User reports slow computer and downloaded "driver update tool".',
                correctAnswer: 'fp',
                explanation: {
                    tp: 'Incorrect. PUAs are not true malware. While annoying, this is a legitimate (if deceptive) software product, not a security threat.',
                    fp: 'Correct! This is a classic false positive. The software is a PUA (potentially unwanted) but not malicious. User education needed about downloading software. Close as FP, educate user on using official IT channels.',
                    btp: 'Incorrect. This isn\'t authorized activity - user downloaded questionable software. However, it\'s also not a real threat, so FP is the better classification.'
                }
            },
            {
                id: 'ALT-2025-007',
                severity: 'high',
                title: 'Data Exfiltration - Large File Upload',
                source: 'DLP - Network Monitoring',
                description: 'User tchen uploaded 4.2 GB to personal Dropbox account.',
                details: {
                    user: 'tchen (Engineering - Senior Developer)',
                    destination: 'dropbox.com (personal account - tchen.personal@gmail.com)',
                    dataVolume: '4.2 GB over 15 minutes',
                    fileTypes: 'Mixed: .zip, .docx, .xlsx, .pdf',
                    sourceDirectory: 'C:\\Projects\\ClientData\\',
                    classification: 'Data tagged as CONFIDENTIAL',
                    time: '2025-12-21 17:45 - 18:00 UTC (after business hours)'
                },
                logs: `2025-12-21 17:45:12 [HTTPS] Connection to dropbox.com from 10.30.50.22
2025-12-21 17:45:22 [UPLOAD] File: project-backup-2025.zip (2.1 GB)
2025-12-21 17:52:33 [UPLOAD] File: client-contracts.zip (1.8 GB)
2025-12-21 17:58:41 [UPLOAD] File: technical-specs.zip (300 MB)
2025-12-21 18:00:05 [ALERT] DLP threshold exceeded - 4.2 GB to personal cloud storage`,
                context: 'User tchen submitted resignation yesterday. Exit interview scheduled for next week. No approved exemptions for personal cloud storage.',
                correctAnswer: 'tp',
                explanation: {
                    tp: 'CORRECT! This is likely data theft by a departing employee. Immediately escalate to IR and Legal. Disable account, preserve evidence, block Dropbox uploads, notify management. Time-sensitive!',
                    fp: 'CRITICAL ERROR! Large uploads to personal cloud by a resigning employee is a major red flag for data theft. Never dismiss exfiltration alerts as FP without thorough investigation.',
                    btp: 'Incorrect. This is not authorized. Personal Dropbox is against policy, especially for confidential data. The timing (resignation + after hours) is highly suspicious.'
                }
            },
            {
                id: 'ALT-2025-008',
                severity: 'medium',
                title: 'Suspicious Process - Mimikatz Detected',
                source: 'EDR - YARA Rule Match',
                description: 'Process matching Mimikatz credential dumping tool detected on IT-SVR-031.',
                details: {
                    hostname: 'IT-SVR-031 (Patch Management Server)',
                    process: 'security-audit.exe (PID 3344)',
                    user: 'SYSTEM (running as service)',
                    filePath: 'C:\\Tools\\SecurityAudit\\security-audit.exe',
                    yaraMatch: 'Mimikatz signature detected (95% confidence)',
                    parentProcess: 'services.exe (legitimate Windows service)',
                    commandLine: 'security-audit.exe --scan --export c:\\reports\\credentials-audit.txt'
                },
                logs: `2025-12-21 09:15:00 [SERVICE] security-audit.exe started by SYSTEM
2025-12-21 09:15:02 [YARA] Mimikatz signature match - 95% confidence
2025-12-21 09:15:03 [MEMORY] LSASS process memory access detected
2025-12-21 09:15:05 [FILE] credentials-audit.txt created (2.4 MB)
2025-12-21 09:17:22 [PROCESS] security-audit.exe terminated`,
                context: 'IT Security uses Mimikatz-based tools for authorized credential auditing. Ticket #SEC-1823: Monthly credential strength audit scheduled today. Tool is signed by IT Security team.',
                correctAnswer: 'btp',
                explanation: {
                    tp: 'Incorrect. While Mimikatz is a hacking tool, it\'s also used by security teams for legitimate auditing. The scheduled task and IT approval make this authorized.',
                    fp: 'Incorrect. Mimikatz WAS detected - the signature match is accurate. It\'s not a false alarm, but it IS authorized (BTP).',
                    btp: 'Correct! Mimikatz was correctly detected, but it\'s being used by IT Security for authorized credential strength auditing per ticket SEC-1823. This is a Benign True Positive. Document and close.'
                }
            },
            {
                id: 'ALT-2025-009',
                severity: 'critical',
                title: 'Command & Control Communication Detected',
                source: 'Network IDS - Snort Rule 2024567',
                description: 'Regular beaconing to known Cobalt Strike C2 server from EXEC-WS-001.',
                details: {
                    hostname: 'EXEC-WS-001 (CEO Workstation)',
                    user: 'ceo@company.com',
                    destinationIP: '192.0.2.15 (known C2 server)',
                    beaconInterval: 'Every 60 seconds',
                    protocol: 'HTTPS (encrypted)',
                    duration: 'Active for 6 hours',
                    threatIntel: 'IP listed in Threat Feed - Cobalt Strike C2 (APT29)',
                    processResponsible: 'chrome.exe (PID 8821)'
                },
                logs: `2025-12-21 06:00:15 [HTTPS] 10.10.1.5 ‚Üí 192.0.2.15:443 (60 bytes)
2025-12-21 06:01:15 [HTTPS] 10.10.1.5 ‚Üí 192.0.2.15:443 (60 bytes)
2025-12-21 06:02:15 [HTTPS] 10.10.1.5 ‚Üí 192.0.2.15:443 (60 bytes)
[Pattern repeats every 60 seconds for 6 hours...]
2025-12-21 12:00:15 [ALERT] C2 beaconing pattern detected - Cobalt Strike signature`,
                context: 'CEO workstation. No legitimate reason to contact this IP. VirusTotal: IP flagged by 45 threat intel sources. Consistent 60-second beaconing is characteristic of C2.',
                correctAnswer: 'tp',
                explanation: {
                    tp: 'CORRECT! This is an active C2 beacon indicating the CEO\'s workstation is compromised. IMMEDIATE ESCALATION TO INCIDENT COMMANDER. Isolate host, disable CEO account, notify CISO, preserve evidence, check for lateral movement. This is a critical incident!',
                    fp: 'CRITICAL ERROR! Regular beaconing to a known C2 IP is never a false positive. This is an active breach of the CEO\'s system requiring immediate response.',
                    btp: 'CRITICAL ERROR! C2 communication is never authorized. This classification would delay response to a critical breach.'
                }
            },
            {
                id: 'ALT-2025-010',
                severity: 'low',
                title: 'USB Device Inserted - Unauthorized Media',
                source: 'DLP - Device Control',
                description: 'USB flash drive inserted into DEV-WS-077 without approval.',
                details: {
                    user: 'akim (Development Team)',
                    hostname: 'DEV-WS-077',
                    deviceType: 'USB Mass Storage Device',
                    vendor: 'SanDisk',
                    serialNumber: '4C531001331122115172',
                    action: 'Read-only access granted (copy prevented)',
                    time: '2025-12-21 14:22 UTC',
                    filesAccessed: 'None (user only browsed folders)'
                },
                logs: `2025-12-21 14:22:10 [USB] Device insertion detected - SanDisk USB 3.0 (16GB)
2025-12-21 14:22:11 [POLICY] Device not in approved list
2025-12-21 14:22:11 [ACTION] Read-only access granted per policy
2025-12-21 14:22:12 [BLOCK] Copy operation blocked - Policy violation
2025-12-21 14:22:45 [USB] Device safely removed`,
                context: 'User contacted - brought USB from home to copy code to work on over weekend. Reminded of policy. No files copied due to DLP block.',
                correctAnswer: 'btp',
                explanation: {
                    tp: 'Incorrect. While this is a policy violation, no actual security incident occurred. DLP prevented any data transfer. This is not a malicious attack.',
                    fp: 'Incorrect. An unauthorized USB device WAS inserted - the detection is accurate. The DLP system is working correctly.',
                    btp: 'Correct! The USB device was correctly detected as unauthorized (true detection), but no malicious intent or data loss occurred (benign). User education on policy. Document incident. Close as BTP.'
                }
            }
        ];

        // Runbook database
        const runbooks = [
            {
                title: 'Brute Force Attack Investigation',
                category: 'Authentication',
                steps: `1. VERIFY ALERT (2 min)
   ‚ñ° Check source IP in threat intelligence (VirusTotal, AbuseIPDB)
   ‚ñ° Verify number of failed attempts and timeframe
   ‚ñ° Identify target account(s)

2. DETERMINE SUCCESS (5 min)
   ‚ñ° Check if any login attempts succeeded
   ‚ñ° Review subsequent logins for targeted accounts
   ‚ñ° If successful, ESCALATE IMMEDIATELY to Tier 2

3. CONTAINMENT (3 min)
   ‚ñ° Block source IP at firewall (if not auto-blocked)
   ‚ñ° Verify account lockout policy triggered
   ‚ñ° If targeted account is privileged, consider disabling

4. CONTEXT GATHERING (5 min)
   ‚ñ° Check if attack is targeted or spray (multiple accounts)
   ‚ñ° Review historical attacks from this IP
   ‚ñ° Identify if other IPs are involved (distributed attack)

5. CLASSIFICATION & ACTION
   - If no successful logins: TP (attempted attack) - Document and close
   - If successful login: TP - ESCALATE for credential reset and forensics
   - If authorized pentesting: BTP - Verify and whitelist`
            },
            {
                title: 'Malware Detection Response',
                category: 'Endpoint Security',
                steps: `1. INITIAL ASSESSMENT (3 min)
   ‚ñ° Verify file hash in VirusTotal (>30 detections = confirmed malware)
   ‚ñ° Check EDR: Was file executed or just quarantined?
   ‚ñ° Identify affected user and system criticality

2. EXECUTION CHECK (5 min)
   ‚ñ° Review EDR process tree for malware execution
   ‚ñ° Check for C2 communication (network logs, EDR telemetry)
   ‚ñ° Look for persistence mechanisms (registry, scheduled tasks)
   ‚ñ° Identify child processes spawned by malware

3. CONTAINMENT (if executed)
   ‚ñ° Isolate host via EDR immediately
   ‚ñ° Disable user account in Active Directory
   ‚ñ° Block C2 IPs/domains at firewall
   ‚ñ° Notify IR team via Slack/escalation

4. SCOPE DETERMINATION (7 min)
   ‚ñ° Search SIEM for same file hash on other systems
   ‚ñ° Check email gateway for similar phishing emails
   ‚ñ° Review user's recent file shares and accessed systems

5. CLASSIFICATION
   - Quarantined before execution: TP - Document, educate user, close
   - Executed with C2: TP - ESCALATE to Tier 2 for forensics
   - Known IT tool: BTP - Verify authorization, whitelist
   - Low VT score (<10): FP - Submit to vendor, document`
            },
            {
                title: 'Phishing Email Investigation',
                category: 'Email Security',
                steps: `1. EMAIL ANALYSIS (5 min)
   ‚ñ° Review sender address (typosquatting? spoofed domain?)
   ‚ñ° Analyze email headers (SPF, DKIM, DMARC results)
   ‚ñ° Examine links (use URL scanner, don't click!)
   ‚ñ° Check attachments (file type, hash in VT)
   ‚ñ° Assess social engineering tactics

2. DETERMINE SCOPE (5 min)
   ‚ñ° Check email gateway: How many recipients?
   ‚ñ° Were emails delivered or quarantined?
   ‚ñ° Did any users click links or open attachments?
   ‚ñ° Review proxy logs for connections to malicious URLs

3. USER IMPACT (5 min)
   ‚ñ° Contact users who received email
   ‚ñ° Ask: Did you click? Did you enter credentials?
   ‚ñ° Check for credential submission on phishing site
   ‚ñ° If credentials entered: ESCALATE for password reset

4. CONTAINMENT (3 min)
   ‚ñ° Delete emails from all mailboxes (if possible)
   ‚ñ° Block sender domain/IP at email gateway
   ‚ñ° Add malicious URLs to web proxy blocklist
   ‚ñ° Create detection rule for similar campaigns

5. CLASSIFICATION
   - Blocked by gateway: TP - Document, update filters
   - Delivered but not clicked: TP - User education, close
   - Credentials compromised: TP - ESCALATE immediately
   - Legitimate email flagged: FP - Whitelist sender`
            },
            {
                title: 'Data Exfiltration Alert',
                category: 'Data Loss Prevention',
                steps: `1. VERIFY ALERT (3 min)
   ‚ñ° Confirm data volume and destination
   ‚ñ° Identify user and their role/department
   ‚ñ° Check data classification (confidential? public?)
   ‚ñ° Review destination (personal cloud? competitor?)

2. USER CONTEXT (5 min)
   ‚ñ° Is user currently employed or departing?
   ‚ñ° Check HR system for resignation/termination
   ‚ñ° Review recent behavior changes
   ‚ñ° Check for other suspicious activity (printing, downloads)

3. AUTHORIZATION CHECK (5 min)
   ‚ñ° Review DLP exceptions and approved transfers
   ‚ñ° Check ticketing system for approved data transfer
   ‚ñ° Contact user's manager for verification
   ‚ñ° Review user's project assignments

4. IMMEDIATE ACTION (if suspicious)
   ‚ñ° Disable user account immediately
   ‚ñ° Block destination at firewall/proxy
   ‚ñ° Preserve evidence (logs, network captures)
   ‚ñ° ESCALATE to Legal and HR immediately

5. CLASSIFICATION
   - Departing employee + large upload: TP - CRITICAL escalation
   - Approved business transfer: BTP - Document approval
   - Backup to approved cloud: BTP - Verify policy
   - Personal email of non-sensitive data: Policy violation
   - False detection (test data): FP - Tune DLP rule`
            },
            {
                title: 'Impossible Travel Investigation',
                category: 'Identity & Access',
                steps: `1. LOGIN VERIFICATION (3 min)
   ‚ñ° Confirm two login locations and timestamps
   ‚ñ° Calculate physical distance and time elapsed
   ‚ñ° Check devices used (same? different?)
   ‚ñ° Review IP addresses and geolocation

2. VPN CHECK (5 min)
   ‚ñ° Determine if either login used VPN
   ‚ñ° Corporate VPN can show office location vs. actual
   ‚ñ° Check VPN logs for user at relevant time
   ‚ñ° Personal VPN may explain anomalous location

3. USER CONTACT (5 min)
   ‚ñ° Contact user via phone/Slack (NOT email - may be compromised)
   ‚ñ° Ask: Are you traveling? Did you login from both locations?
   ‚ñ° Verify recent password changes or suspicious activity
   ‚ñ° Ask about any unusual MFA prompts

4. ACCOUNT REVIEW (7 min)
   ‚ñ° Check for other unusual logins (time, location, device)
   ‚ñ° Review recent account activity (email sends, file access)
   ‚ñ° Check for password changes or MFA modifications
   ‚ñ° Look for suspicious activity after the alert

5. CLASSIFICATION & ACTION
   - User confirms compromise: TP - Reset password, MFA, session tokens
   - Legitimate travel + VPN: BTP - Document explanation
   - User unaware of second login: TP - ESCALATE for IR
   - Shared account (policy violation): BTP - Educate, enforce MFA
   - Geolocation database error: FP - Document, report to vendor`
            },
            {
                title: 'Lateral Movement Detection',
                category: 'Network Security',
                steps: `1. VERIFY MOVEMENT (3 min)
   ‚ñ° Identify source and destination systems
   ‚ñ° Determine method (RDP, SMB, WMI, PsExec?)
   ‚ñ° Check user account used for movement
   ‚ñ° Review timeline of lateral movement

2. AUTHORIZATION CHECK (5 min)
   ‚ñ° Is source user an IT admin with legitimate access?
   ‚ñ° Check change tickets for authorized maintenance
   ‚ñ° Review user's typical access patterns
   ‚ñ° Verify destination system is within user's scope

3. ACCOUNT ANALYSIS (5 min)
   ‚ñ° Check if account is compromised (recent password reset?)
   ‚ñ° Review account privilege level (should it have admin access?)
   ‚ñ° Look for unusual authentication (pass-the-hash, golden ticket)
   ‚ñ° Check for other activity by this account

4. SCOPE DETERMINATION (7 min)
   ‚ñ° Identify all systems accessed by this account recently
   ‚ñ° Map attack path from initial compromise
   ‚ñ° Check for persistence mechanisms on compromised hosts
   ‚ñ° Look for data access or exfiltration

5. CONTAINMENT (if malicious)
   ‚ñ° Disable compromised account immediately
   ‚ñ° Isolate affected systems via EDR
   ‚ñ° Reset passwords for all accounts on affected systems
   ‚ñ° ESCALATE to Tier 3 for threat hunting

6. CLASSIFICATION
   - IT admin doing authorized work: BTP - Document ticket
   - Unusual movement by standard user: TP - ESCALATE
   - Compromised account spreading: TP - CRITICAL escalation`
            }
        ];

        // State management
        let alerts = [];
        let selectedAlert = null;
        let triagedAlerts = [];
        let metrics = {
            totalAlerts: 0,
            triaged: 0,
            truePositives: 0,
            falsePositives: 0,
            benignTruePositives: 0,
            escalated: 0,
            startTime: Date.now(),
            triageTimes: []
        };

        // Initialize
        function init() {
            loadNewAlerts();
            loadRunbooks();
            updateMetrics();
        }

        // Load alerts
        function loadNewAlerts() {
            alerts = [...alertDatabase];
            metrics.totalAlerts = alerts.length;
            renderAlertQueue();
            updateProgress();
        }

        // Render alert queue
        function renderAlertQueue() {
            const queue = document.getElementById('alertQueue');
            queue.innerHTML = '';

            alerts.forEach((alert, index) => {
                const card = document.createElement('div');
                card.className = 'alert-card';
                if (alert.triaged) card.classList.add('triaged');
                if (selectedAlert === alert) card.classList.add('selected');

                card.innerHTML = `
                    <div class="alert-header">
                        <span class="alert-id">${alert.id}</span>
                        <span class="severity-badge severity-${alert.severity}">${alert.severity.toUpperCase()}</span>
                    </div>
                    <div class="alert-title">${alert.title}</div>
                    <div class="alert-details">${alert.source}</div>
                    <div class="alert-time">‚è∞ ${new Date().toLocaleTimeString()}</div>
                `;

                card.onclick = () => selectAlert(alert);
                queue.appendChild(card);
            });
        }

        // Select alert for investigation
        function selectAlert(alert) {
            if (alert.triaged) {
                showToast('This alert has already been triaged!', 'warning');
                return;
            }

            selectedAlert = alert;
            selectedAlert.investigationStartTime = Date.now();
            renderAlertQueue();
            renderInvestigationPanel(alert);
        }

        // Render investigation panel
        function renderInvestigationPanel(alert) {
            const panel = document.getElementById('investigationPanel');

            panel.innerHTML = `
                <div class="investigation-details">
                    <h3>Alert Details</h3>
                    <div class="alert-header">
                        <span class="alert-id">${alert.id}</span>
                        <span class="severity-badge severity-${alert.severity}">${alert.severity.toUpperCase()}</span>
                    </div>
                    <div class="alert-title" style="margin: 15px 0;">${alert.title}</div>
                    <p style="color: #b0b0b0; margin-bottom: 20px;">${alert.description}</p>

                    <h3>Investigation Data</h3>
                    <div class="info-grid">
                        ${Object.entries(alert.details).map(([key, value]) => `
                            <div class="info-label">${key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase())}:</div>
                            <div class="info-value">${value}</div>
                        `).join('')}
                    </div>

                    <h3>Raw Logs</h3>
                    <div class="log-viewer scrollbar-custom">${alert.logs}</div>

                    <h3>Additional Context</h3>
                    <p style="color: #b0b0b0; background: rgba(192, 132, 252, 0.1); padding: 15px; border-radius: 8px; margin-top: 10px;">
                        ${alert.context}
                    </p>

                    <h3>Triage Decision</h3>
                    <p style="color: #fbbf24; margin-bottom: 15px;">How would you classify this alert?</p>

                    <div class="btn-group">
                        <button class="btn btn-tp" onclick="triageAlert('tp')">
                            ‚ö†Ô∏è True Positive<br>
                            <small style="font-weight: normal; opacity: 0.8;">Real threat</small>
                        </button>
                        <button class="btn btn-fp" onclick="triageAlert('fp')">
                            ‚úÖ False Positive<br>
                            <small style="font-weight: normal; opacity: 0.8;">Benign activity</small>
                        </button>
                        <button class="btn btn-btp" onclick="triageAlert('btp')">
                            ‚ö° Benign TP<br>
                            <small style="font-weight: normal; opacity: 0.8;">Authorized</small>
                        </button>
                    </div>

                    <div class="btn-group" style="margin-top: 10px;">
                        <button class="btn btn-escalate" onclick="escalateAlert()">
                            üìà Escalate to Tier 2
                        </button>
                    </div>
                </div>
            `;
        }

        // Triage alert
        function triageAlert(decision) {
            if (!selectedAlert) return;

            const triageTime = Date.now() - selectedAlert.investigationStartTime;
            metrics.triageTimes.push(triageTime);

            const isCorrect = decision === selectedAlert.correctAnswer;
            const explanation = selectedAlert.explanation[decision];

            // Update metrics
            metrics.triaged++;
            if (decision === 'tp') metrics.truePositives++;
            if (decision === 'fp') metrics.falsePositives++;
            if (decision === 'btp') metrics.benignTruePositives++;

            // Mark alert as triaged
            selectedAlert.triaged = true;
            selectedAlert.triageDecision = decision;
            selectedAlert.triageTime = triageTime;
            triagedAlerts.push({
                alert: selectedAlert,
                decision,
                isCorrect,
                time: new Date(),
                triageTime
            });

            // Show feedback
            const feedbackColor = isCorrect ? '#22c55e' : '#ef4444';
            const feedbackIcon = isCorrect ? '‚úÖ' : '‚ùå';

            const panel = document.getElementById('investigationPanel');
            panel.innerHTML = `
                <div style="text-align: center; padding: 30px;">
                    <div style="font-size: 4em; margin-bottom: 20px;">${feedbackIcon}</div>
                    <h2 style="color: ${feedbackColor}; margin-bottom: 20px;">
                        ${isCorrect ? 'Correct!' : 'Incorrect'}
                    </h2>
                    <div style="background: rgba(192, 132, 252, 0.1); padding: 20px; border-radius: 10px; text-align: left; margin-bottom: 20px;">
                        <strong style="color: #c084fc;">Explanation:</strong>
                        <p style="color: #e0e0e0; margin-top: 10px; line-height: 1.6;">${explanation}</p>
                    </div>
                    <div style="background: rgba(6, 182, 212, 0.1); padding: 15px; border-radius: 8px; text-align: left; margin-bottom: 20px;">
                        <strong style="color: #06b6d4;">Triage Time:</strong> ${(triageTime / 1000).toFixed(1)} seconds
                        <br>
                        <strong style="color: #06b6d4;">Correct Answer:</strong> ${selectedAlert.correctAnswer.toUpperCase()}
                    </div>
                    <button class="btn btn-escalate" onclick="clearSelection()" style="width: 200px;">
                        Continue to Next Alert ‚Üí
                    </button>
                </div>
            `;

            renderAlertQueue();
            updateProgress();
            updateMetrics();
            showToast(isCorrect ? 'Correct triage decision!' : 'Incorrect - review explanation', isCorrect ? 'success' : 'error');
        }

        // Escalate alert
        function escalateAlert() {
            if (!selectedAlert) return;

            metrics.escalated++;
            selectedAlert.triaged = true;
            selectedAlert.escalated = true;

            triagedAlerts.push({
                alert: selectedAlert,
                decision: 'escalated',
                isCorrect: true,
                time: new Date()
            });

            showToast('Alert escalated to Tier 2!', 'success');
            clearSelection();
            updateProgress();
            updateMetrics();
        }

        // Clear selection
        function clearSelection() {
            selectedAlert = null;
            document.getElementById('investigationPanel').innerHTML = `
                <div class="no-selection">
                    üëÜ Select an alert from the queue to begin investigation
                </div>
            `;
            renderAlertQueue();
        }

        // Update progress bar
        function updateProgress() {
            const percent = (metrics.triaged / metrics.totalAlerts) * 100;
            const bar = document.getElementById('progressBar');
            bar.style.width = percent + '%';
            bar.textContent = `${metrics.triaged} / ${metrics.totalAlerts} Triaged`;
        }

        // Update metrics dashboard
        function updateMetrics() {
            const avgTriageTime = metrics.triageTimes.length > 0
                ? metrics.triageTimes.reduce((a, b) => a + b, 0) / metrics.triageTimes.length / 1000
                : 0;

            const accuracy = metrics.triaged > 0
                ? ((triagedAlerts.filter(t => t.isCorrect).length / metrics.triaged) * 100)
                : 0;

            const tpRate = metrics.triaged > 0
                ? ((metrics.truePositives / metrics.triaged) * 100)
                : 0;

            const fpRate = metrics.triaged > 0
                ? ((metrics.falsePositives / metrics.triaged) * 100)
                : 0;

            document.getElementById('metricsPanel').innerHTML = `
                <div class="metric-box">
                    <div class="metric-value">${metrics.triaged}</div>
                    <div class="metric-label">Alerts Triaged</div>
                </div>
                <div class="metric-box">
                    <div class="metric-value">${accuracy.toFixed(1)}%</div>
                    <div class="metric-label">Triage Accuracy</div>
                </div>
                <div class="metric-box">
                    <div class="metric-value">${avgTriageTime.toFixed(1)}s</div>
                    <div class="metric-label">Avg Triage Time (MTTD)</div>
                </div>
                <div class="metric-box">
                    <div class="metric-value">${metrics.truePositives}</div>
                    <div class="metric-label">True Positives</div>
                </div>
                <div class="metric-box">
                    <div class="metric-value">${metrics.falsePositives}</div>
                    <div class="metric-label">False Positives</div>
                </div>
                <div class="metric-box">
                    <div class="metric-value">${metrics.benignTruePositives}</div>
                    <div class="metric-label">Benign True Positives</div>
                </div>
                <div class="metric-box">
                    <div class="metric-value">${metrics.escalated}</div>
                    <div class="metric-label">Escalations</div>
                </div>
                <div class="metric-box">
                    <div class="metric-value">${tpRate.toFixed(1)}%</div>
                    <div class="metric-label">True Positive Rate</div>
                </div>
                <div class="metric-box">
                    <div class="metric-value">${fpRate.toFixed(1)}%</div>
                    <div class="metric-label">False Positive Rate</div>
                </div>
            `;

            // Update timeline
            const timeline = document.getElementById('timeline');
            if (triagedAlerts.length === 0) {
                timeline.innerHTML = '<p style="color: #666; text-align: center; padding: 30px;">Triage alerts to build your timeline...</p>';
            } else {
                timeline.innerHTML = triagedAlerts.map(t => `
                    <div class="timeline-event">
                        <div class="timeline-time">${t.time.toLocaleTimeString()}</div>
                        <div class="timeline-action">
                            <strong style="color: #c084fc;">${t.alert.id}:</strong> ${t.alert.title}
                            <br>
                            <strong>Decision:</strong> ${t.decision.toUpperCase()}
                            ${t.isCorrect ? '‚úÖ' : '‚ùå'}
                            ${t.triageTime ? `<strong> | Time:</strong> ${(t.triageTime / 1000).toFixed(1)}s` : ''}
                        </div>
                    </div>
                `).join('');
            }
        }

        // Generate handoff report
        function generateHandoff() {
            if (triagedAlerts.length === 0) {
                showToast('Triage some alerts first to generate a handoff report!', 'warning');
                return;
            }

            const ongoingIncidents = triagedAlerts.filter(t => t.decision === 'tp' || t.decision === 'escalated');
            const resolvedAlerts = triagedAlerts.filter(t => t.decision === 'fp' || t.decision === 'btp');

            const report = `
SOC SHIFT HANDOFF REPORT
Shift: ${new Date().toLocaleDateString()} - ${new Date().toLocaleTimeString()}
Analyst: [Your Name]

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

ONGOING INCIDENTS (Action Required): ${ongoingIncidents.length}

${ongoingIncidents.map(t => `
[${t.alert.id}] ${t.alert.severity.toUpperCase()} - ${t.alert.title}
  Status: ${t.decision === 'escalated' ? 'Escalated to Tier 2' : 'Under Investigation'}
  Summary: ${t.alert.description}
  Next Steps: ${t.decision === 'escalated' ? 'Awaiting Tier 2 analysis' : 'Continue investigation'}
  Urgency: ${t.alert.severity.toUpperCase()}
`).join('\n')}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

ALERT QUEUE STATUS:

Total Pending: ${alerts.filter(a => !a.triaged).length} alerts
Alerts Triaged This Shift: ${metrics.triaged}

Breakdown:
  - True Positives: ${metrics.truePositives}
  - False Positives: ${metrics.falsePositives}
  - Benign True Positives: ${metrics.benignTruePositives}
  - Escalated: ${metrics.escalated}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

METRICS (This Shift):

Alerts Triaged: ${metrics.triaged}
Avg Triage Time: ${(metrics.triageTimes.reduce((a, b) => a + b, 0) / metrics.triageTimes.length / 1000).toFixed(1)}s
True Positive Rate: ${((metrics.truePositives / metrics.triaged) * 100).toFixed(1)}%
False Positive Rate: ${((metrics.falsePositives / metrics.triaged) * 100).toFixed(1)}%

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

ENVIRONMENTAL NOTES:

- No scheduled maintenance windows
- All security tools operational
- Monitor ongoing incidents listed above

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Questions? Contact: [your-email@company.com]
            `.trim();

            document.getElementById('handoffContent').innerHTML = `<div class="handoff-note">${report}</div>`;
            showToast('Handoff report generated!', 'success');
        }

        // Copy handoff to clipboard
        function copyHandoff() {
            const content = document.getElementById('handoffContent').textContent;
            navigator.clipboard.writeText(content).then(() => {
                showToast('Handoff report copied to clipboard!', 'success');
            });
        }

        // Load runbooks
        function loadRunbooks() {
            const panel = document.getElementById('runbookPanel');
            panel.innerHTML = runbooks.map((rb, idx) => `
                <div class="runbook-item" onclick="toggleRunbook(${idx})">
                    <div class="runbook-title">üìñ ${rb.title}</div>
                    <div style="color: #06b6d4; font-size: 0.85em; margin-top: 5px;">Category: ${rb.category}</div>
                    <div class="runbook-content">
                        <pre style="white-space: pre-wrap; font-family: 'Courier New', monospace; line-height: 1.6;">${rb.steps}</pre>
                    </div>
                </div>
            `).join('');
        }

        // Toggle runbook expansion
        function toggleRunbook(index) {
            const items = document.querySelectorAll('.runbook-item');
            items[index].classList.toggle('expanded');
        }

        // Switch tabs
        function switchTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

            event.target.classList.add('active');
            document.getElementById('tab-' + tabName).classList.add('active');

            if (tabName === 'metrics') {
                updateMetrics();
            }
        }

        // Show toast notification
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.style.display = 'block';

            if (type === 'error') {
                toast.style.background = 'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)';
            } else if (type === 'warning') {
                toast.style.background = 'linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)';
            } else {
                toast.style.background = 'linear-gradient(135deg, #22c55e 0%, #16a34a 100%)';
            }

            setTimeout(() => {
                toast.style.display = 'none';
            }, 3000);
        }

        // Initialize on load
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>