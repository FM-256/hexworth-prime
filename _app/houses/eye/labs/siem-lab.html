<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIEM Hands-On Lab - Eye House</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a0b2e 100%);
            color: #e0e0e0;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #c084fc 0%, #06b6d4 100%);
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(192, 132, 252, 0.3);
        }

        header h1 {
            font-size: 2.5em;
            color: #0f0f23;
            margin-bottom: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: rgba(30, 30, 60, 0.8);
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
            border: 2px solid #c084fc;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #c084fc, #06b6d4);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #0f0f23;
        }

        .exercise-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .exercise-card {
            background: rgba(30, 30, 60, 0.6);
            border: 2px solid #c084fc;
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .exercise-card:hover {
            transform: translateY(-5px);
            border-color: #06b6d4;
            box-shadow: 0 8px 25px rgba(6, 182, 212, 0.4);
        }

        .exercise-card.completed {
            border-color: #22c55e;
            background: rgba(34, 197, 94, 0.1);
        }

        .exercise-card.active {
            border-color: #06b6d4;
            background: rgba(6, 182, 212, 0.2);
        }

        .exercise-number {
            display: inline-block;
            background: linear-gradient(135deg, #c084fc, #a78bfa);
            color: #0f0f23;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            text-align: center;
            line-height: 40px;
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .exercise-card.completed .exercise-number {
            background: linear-gradient(135deg, #22c55e, #16a34a);
        }

        .exercise-content {
            display: none;
            background: rgba(30, 30, 60, 0.6);
            border: 2px solid #c084fc;
            border-radius: 15px;
            padding: 40px;
            margin: 30px 0;
            backdrop-filter: blur(10px);
        }

        .exercise-content.active {
            display: block;
            animation: slideIn 0.4s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h2 {
            color: #c084fc;
            font-size: 2em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #06b6d4;
        }

        h3 {
            color: #06b6d4;
            font-size: 1.5em;
            margin: 25px 0 15px 0;
        }

        .siem-interface {
            background: #0f0f23;
            border: 2px solid #c084fc;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .search-bar {
            width: 100%;
            background: #1a1a2e;
            border: 2px solid #06b6d4;
            color: #06b6d4;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            margin: 10px 0;
        }

        .search-bar:focus {
            outline: none;
            border-color: #c084fc;
            box-shadow: 0 0 15px rgba(192, 132, 252, 0.3);
        }

        .log-viewer {
            background: #000;
            border: 2px solid #06b6d4;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            max-height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
        }

        .log-entry {
            padding: 8px;
            margin: 5px 0;
            border-left: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .log-entry:hover {
            background: rgba(6, 182, 212, 0.1);
            border-left-color: #06b6d4;
        }

        .log-entry.suspicious {
            border-left-color: #fb923c;
            background: rgba(251, 146, 60, 0.1);
        }

        .log-entry.malicious {
            border-left-color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }

        .timestamp {
            color: #666;
        }

        .ip-address {
            color: #06b6d4;
            font-weight: bold;
        }

        .event-type {
            color: #c084fc;
        }

        .failed {
            color: #ef4444;
        }

        .success {
            color: #22c55e;
        }

        .btn {
            background: linear-gradient(135deg, #c084fc 0%, #06b6d4 100%);
            color: #0f0f23;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(192, 132, 252, 0.5);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: rgba(6, 182, 212, 0.3);
            border: 2px solid #06b6d4;
            color: #06b6d4;
        }

        .hint-box {
            background: rgba(6, 182, 212, 0.1);
            border-left: 5px solid #06b6d4;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            display: none;
        }

        .hint-box.visible {
            display: block;
            animation: slideIn 0.3s ease;
        }

        .success-msg {
            background: rgba(34, 197, 94, 0.2);
            border: 2px solid #22c55e;
            color: #86efac;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: bold;
            display: none;
        }

        .success-msg.visible {
            display: block;
            animation: slideIn 0.3s ease;
        }

        .error-msg {
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid #ef4444;
            color: #fca5a5;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: bold;
        }

        .answer-input {
            width: 100%;
            background: #1a1a2e;
            border: 2px solid #c084fc;
            color: #e0e0e0;
            padding: 15px;
            border-radius: 8px;
            font-size: 1em;
            margin: 10px 0;
        }

        .answer-input:focus {
            outline: none;
            border-color: #06b6d4;
            box-shadow: 0 0 15px rgba(6, 182, 212, 0.3);
        }

        .task-checklist {
            background: rgba(30, 30, 60, 0.5);
            border: 2px solid #c084fc;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .task-item {
            padding: 12px;
            margin: 10px 0;
            border-left: 4px solid #666;
            transition: all 0.3s ease;
        }

        .task-item.completed {
            border-left-color: #22c55e;
            background: rgba(34, 197, 94, 0.1);
            text-decoration: line-through;
            color: #86efac;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: rgba(30, 30, 60, 0.5);
            border: 2px solid #c084fc;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }

        .stat-value {
            font-size: 2.5em;
            color: #06b6d4;
            font-weight: bold;
            margin: 10px 0;
        }

        .stat-label {
            color: #c084fc;
            font-size: 0.9em;
        }

        .query-result {
            background: #0f0f23;
            border: 2px solid #06b6d4;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            color: #22d3ee;
        }

        .alert-rule-preview {
            background: rgba(6, 182, 212, 0.1);
            border: 2px solid #06b6d4;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }

        .dashboard-preview {
            background: #1a1a2e;
            border: 2px solid #c084fc;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            min-height: 300px;
        }

        .chart-bar {
            background: linear-gradient(135deg, #c084fc 0%, #06b6d4 100%);
            margin: 8px 0;
            border-radius: 5px;
            transition: width 0.5s ease;
            height: 35px;
            display: flex;
            align-items: center;
            padding-left: 15px;
            color: #0f0f23;
            font-weight: bold;
        }

        .incident-timeline {
            position: relative;
            padding: 20px 0;
            margin: 20px 0;
        }

        .timeline-item {
            background: rgba(30, 30, 60, 0.5);
            border-left: 4px solid #c084fc;
            padding: 15px;
            margin: 15px 0 15px 30px;
            border-radius: 5px;
            position: relative;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -10px;
            top: 20px;
            width: 16px;
            height: 16px;
            background: #c084fc;
            border-radius: 50%;
            border: 3px solid #0f0f23;
        }

        .timeline-item.critical::before {
            background: #ef4444;
        }

        .severity-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 5px;
            font-size: 0.85em;
            font-weight: bold;
            margin: 0 5px;
        }

        .severity-low {
            background: rgba(34, 197, 94, 0.3);
            color: #86efac;
        }

        .severity-medium {
            background: rgba(251, 146, 60, 0.3);
            color: #fdba74;
        }

        .severity-high {
            background: rgba(239, 68, 68, 0.3);
            color: #fca5a5;
        }

        .severity-critical {
            background: rgba(239, 68, 68, 0.5);
            color: #fff;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }

            .exercise-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ðŸ§ª SIEM Hands-On Lab</h1>
            <p>Practical Exercises in Security Information and Event Management</p>

            <div class="progress-bar">
                <div class="progress-fill" id="overallProgress" style="width: 0%;">0%</div>
            </div>
        </header>

        <div class="exercise-list">
            <div class="exercise-card" onclick="loadExercise(1)">
                <div class="exercise-number">1</div>
                <h3 style="color: #c084fc; margin: 10px 0;">Parse Log Formats</h3>
                <p>Learn to identify and parse different log formats</p>
            </div>

            <div class="exercise-card" onclick="loadExercise(2)">
                <div class="exercise-number">2</div>
                <h3 style="color: #c084fc; margin: 10px 0;">Write SPL Queries</h3>
                <p>Master basic Splunk search language</p>
            </div>

            <div class="exercise-card" onclick="loadExercise(3)">
                <div class="exercise-number">3</div>
                <h3 style="color: #c084fc; margin: 10px 0;">Create Alert Rules</h3>
                <p>Build correlation rules for threat detection</p>
            </div>

            <div class="exercise-card" onclick="loadExercise(4)">
                <div class="exercise-number">4</div>
                <h3 style="color: #c084fc; margin: 10px 0;">Build a Dashboard</h3>
                <p>Create security monitoring visualizations</p>
            </div>

            <div class="exercise-card" onclick="loadExercise(5)">
                <div class="exercise-number">5</div>
                <h3 style="color: #c084fc; margin: 10px 0;">Investigate Incident</h3>
                <p>Conduct forensic investigation using logs</p>
            </div>

            <div class="exercise-card" onclick="loadExercise(6)">
                <div class="exercise-number">6</div>
                <h3 style="color: #c084fc; margin: 10px 0;">Correlate Events</h3>
                <p>Connect related events from multiple sources</p>
            </div>

            <div class="exercise-card" onclick="loadExercise(7)">
                <div class="exercise-number">7</div>
                <h3 style="color: #c084fc; margin: 10px 0;">Tune Alerts</h3>
                <p>Reduce false positives in alert rules</p>
            </div>
        </div>

        <!-- Exercise 1: Parse Log Formats -->
        <div id="exercise1" class="exercise-content">
            <h2>Exercise 1: Parse Log Formats</h2>
            <p>Understanding log formats is fundamental to SIEM work. In this exercise, you'll identify different log formats and extract key fields.</p>

            <h3>Scenario</h3>
            <p>You've been given several raw log entries from different systems. Identify the format and extract the critical security information.</p>

            <div class="siem-interface">
                <h3 style="color: #c084fc;">Log Sample 1</h3>
                <div class="log-viewer">
                    <div class="log-entry">192.168.1.50 - - [21/Dec/2025:10:15:32 +0000] "GET /admin/config.php HTTP/1.1" 401 345 "https://evil.com" "Mozilla/5.0"</div>
                </div>

                <label style="color: #c084fc; font-weight: bold; display: block; margin: 15px 0 10px 0;">What log format is this?</label>
                <select class="answer-input" id="ex1q1">
                    <option value="">-- Select Format --</option>
                    <option value="apache">Apache Combined Log Format</option>
                    <option value="syslog">Syslog</option>
                    <option value="windows">Windows Event Log</option>
                    <option value="json">JSON</option>
                </select>

                <label style="color: #c084fc; font-weight: bold; display: block; margin: 15px 0 10px 0;">What is the source IP address?</label>
                <input type="text" class="answer-input" id="ex1q2" placeholder="Enter IP address">

                <label style="color: #c084fc; font-weight: bold; display: block; margin: 15px 0 10px 0;">What HTTP status code was returned?</label>
                <input type="text" class="answer-input" id="ex1q3" placeholder="Enter status code">

                <label style="color: #c084fc; font-weight: bold; display: block; margin: 15px 0 10px 0;">Is this activity suspicious? Why?</label>
                <select class="answer-input" id="ex1q4">
                    <option value="">-- Select Answer --</option>
                    <option value="yes">Yes - Unauthorized access attempt to admin panel with 401 response</option>
                    <option value="no">No - Normal user activity</option>
                </select>

                <button class="btn" onclick="checkExercise1()">Check Answers</button>
                <button class="btn btn-secondary" onclick="showHint(1)">Show Hint</button>

                <div class="hint-box" id="hint1">
                    <strong>ðŸ’¡ Hint:</strong> Apache Combined Log Format follows this pattern:<br>
                    <code>IP - - [timestamp] "method URI protocol" status bytes "referrer" "user-agent"</code><br>
                    Look for attempts to access administrative paths with failed authentication.
                </div>

                <div class="success-msg" id="success1"></div>
            </div>

            <div class="siem-interface" id="ex1part2" style="display: none;">
                <h3 style="color: #c084fc;">Log Sample 2 - Advanced</h3>
                <div class="log-viewer">
                    <div class="log-entry">Dec 21 10:15:32 webserver sshd[12345]: Failed password for root from 203.0.113.50 port 44321 ssh2</div>
                    <div class="log-entry">Dec 21 10:15:35 webserver sshd[12346]: Failed password for root from 203.0.113.50 port 44322 ssh2</div>
                    <div class="log-entry">Dec 21 10:15:38 webserver sshd[12347]: Failed password for root from 203.0.113.50 port 44323 ssh2</div>
                    <div class="log-entry">Dec 21 10:15:41 webserver sshd[12348]: Accepted password for root from 203.0.113.50 port 44324 ssh2</div>
                </div>

                <label style="color: #c084fc; font-weight: bold; display: block; margin: 15px 0 10px 0;">What attack pattern is shown here?</label>
                <select class="answer-input" id="ex1q5">
                    <option value="">-- Select Attack Type --</option>
                    <option value="brute">SSH Brute Force Attack</option>
                    <option value="sql">SQL Injection</option>
                    <option value="xss">Cross-Site Scripting</option>
                    <option value="dos">Denial of Service</option>
                </select>

                <button class="btn" onclick="completeExercise(1)">Complete Exercise 1</button>
            </div>
        </div>

        <!-- Exercise 2: Write SPL Queries -->
        <div id="exercise2" class="exercise-content">
            <h2>Exercise 2: Write SPL Queries</h2>
            <p>Learn to construct effective Splunk searches to find security events.</p>

            <h3>Scenario</h3>
            <p>You need to write queries to investigate potential security incidents in your Windows environment.</p>

            <div class="siem-interface">
                <h3 style="color: #c084fc;">Task 1: Find Failed Login Attempts</h3>
                <p>Write a query to find all failed Windows login attempts (EventCode 4625) in the last 24 hours.</p>

                <input type="text" class="search-bar" id="query1" placeholder="Enter SPL query...">

                <button class="btn" onclick="runQuery(1)">Run Query</button>
                <button class="btn btn-secondary" onclick="showHint(2)">Show Hint</button>

                <div class="hint-box" id="hint2">
                    <strong>ðŸ’¡ Hint:</strong> Basic SPL structure: <code>index=&lt;indexname&gt; EventCode=&lt;code&gt; earliest=-24h</code>
                </div>

                <div class="query-result" id="queryResult1" style="display: none;"></div>
            </div>

            <div class="siem-interface" style="margin-top: 30px;">
                <h3 style="color: #c084fc;">Task 2: Count Events by Source IP</h3>
                <p>Extend your query to count failed logins grouped by source IP address.</p>

                <input type="text" class="search-bar" id="query2" placeholder="Enter SPL query with stats...">

                <button class="btn" onclick="runQuery(2)">Run Query</button>
                <button class="btn btn-secondary" onclick="showHint(3)">Show Hint</button>

                <div class="hint-box" id="hint3">
                    <strong>ðŸ’¡ Hint:</strong> Use the pipe operator and stats command: <code>| stats count by src_ip | sort -count</code>
                </div>

                <div class="query-result" id="queryResult2" style="display: none;"></div>
            </div>

            <div class="siem-interface" style="margin-top: 30px;">
                <h3 style="color: #c084fc;">Task 3: Filter High-Volume Attackers</h3>
                <p>Show only IPs with more than 10 failed login attempts.</p>

                <input type="text" class="search-bar" id="query3" placeholder="Enter SPL query with where clause...">

                <button class="btn" onclick="runQuery(3)">Run Query</button>
                <button class="btn btn-secondary" onclick="showHint(4)">Show Hint</button>

                <div class="hint-box" id="hint4">
                    <strong>ðŸ’¡ Hint:</strong> Add a where clause: <code>| where count > 10</code>
                </div>

                <div class="query-result" id="queryResult3" style="display: none;"></div>

                <button class="btn" onclick="completeExercise(2)" style="margin-top: 20px;" id="completeEx2" disabled>Complete Exercise 2</button>
            </div>
        </div>

        <!-- Exercise 3: Create Alert Rules -->
        <div id="exercise3" class="exercise-content">
            <h2>Exercise 3: Create Alert Rules</h2>
            <p>Design correlation rules that detect security threats in real-time.</p>

            <h3>Scenario</h3>
            <p>Your organization needs an alert for brute force attacks. Create a rule that triggers when there are excessive failed login attempts.</p>

            <div class="task-checklist">
                <h3 style="color: #c084fc;">Alert Rule Requirements</h3>
                <div class="task-item" id="task3-1">Define the search query</div>
                <div class="task-item" id="task3-2">Set appropriate threshold</div>
                <div class="task-item" id="task3-3">Configure time window</div>
                <div class="task-item" id="task3-4">Assign severity level</div>
                <div class="task-item" id="task3-5">Test the rule</div>
            </div>

            <div class="siem-interface">
                <h3 style="color: #c084fc;">Alert Configuration</h3>

                <label style="color: #c084fc; font-weight: bold; display: block; margin: 15px 0 10px 0;">Alert Name:</label>
                <input type="text" class="answer-input" id="alertName" placeholder="e.g., Brute Force Detection - Failed Logins">

                <label style="color: #c084fc; font-weight: bold; display: block; margin: 15px 0 10px 0;">Search Query:</label>
                <textarea class="search-bar" id="alertQuery" rows="3" placeholder="Enter the SPL query for this alert..."></textarea>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                    <div>
                        <label style="color: #c084fc; font-weight: bold; display: block; margin: 10px 0;">Threshold (number of events):</label>
                        <input type="number" class="answer-input" id="alertThreshold" value="5" min="1">
                    </div>
                    <div>
                        <label style="color: #c084fc; font-weight: bold; display: block; margin: 10px 0;">Time Window:</label>
                        <select class="answer-input" id="alertWindow">
                            <option value="5m">5 minutes</option>
                            <option value="15m">15 minutes</option>
                            <option value="1h">1 hour</option>
                            <option value="24h">24 hours</option>
                        </select>
                    </div>
                </div>

                <label style="color: #c084fc; font-weight: bold; display: block; margin: 15px 0 10px 0;">Severity:</label>
                <select class="answer-input" id="alertSeverity">
                    <option value="low">Low</option>
                    <option value="medium">Medium</option>
                    <option value="high">High</option>
                    <option value="critical">Critical</option>
                </select>

                <button class="btn" onclick="createAlert()">Create Alert Rule</button>
                <button class="btn btn-secondary" onclick="testAlert()">Test Alert</button>

                <div class="alert-rule-preview" id="alertPreview" style="display: none;"></div>

                <button class="btn" onclick="completeExercise(3)" style="margin-top: 20px;" id="completeEx3" disabled>Complete Exercise 3</button>
            </div>
        </div>

        <!-- Exercise 4: Build a Dashboard -->
        <div id="exercise4" class="exercise-content">
            <h2>Exercise 4: Build a Dashboard</h2>
            <p>Create a security monitoring dashboard with key metrics and visualizations.</p>

            <h3>Scenario</h3>
            <p>Build a dashboard for the SOC team to monitor authentication activity across the network.</p>

            <div class="siem-interface">
                <h3 style="color: #c084fc;">Dashboard Widgets</h3>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Failed Logins (24h)</div>
                        <div class="stat-value" id="stat1">0</div>
                        <button class="btn btn-secondary" onclick="addWidget('failed_logins')">Add Widget</button>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Successful Logins (24h)</div>
                        <div class="stat-value" id="stat2">0</div>
                        <button class="btn btn-secondary" onclick="addWidget('success_logins')">Add Widget</button>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Unique Source IPs</div>
                        <div class="stat-value" id="stat3">0</div>
                        <button class="btn btn-secondary" onclick="addWidget('unique_ips')">Add Widget</button>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Active Alerts</div>
                        <div class="stat-value" id="stat4">0</div>
                        <button class="btn btn-secondary" onclick="addWidget('alerts')">Add Widget</button>
                    </div>
                </div>

                <div class="dashboard-preview" id="dashboardArea">
                    <h3 style="color: #06b6d4; text-align: center; padding: 50px; color: #666;">
                        Add widgets above to build your dashboard
                    </h3>
                </div>

                <button class="btn" onclick="completeExercise(4)" id="completeEx4" disabled>Complete Exercise 4</button>
            </div>
        </div>

        <!-- Exercise 5: Investigate Incident -->
        <div id="exercise5" class="exercise-content">
            <h2>Exercise 5: Investigate Security Incident</h2>
            <p>Use SIEM to reconstruct a security incident timeline and determine the attack scope.</p>

            <h3>Scenario</h3>
            <p>An alert triggered for suspicious activity on server WEB-01. Investigate the incident using the available logs.</p>

            <div class="siem-interface">
                <h3 style="color: #c084fc;">Investigation Console</h3>

                <div class="log-viewer" style="max-height: 500px;">
                    <div class="log-entry">
                        <span class="timestamp">2025-12-21 10:10:15</span> |
                        <span class="ip-address">192.168.1.100</span> |
                        <span class="event-type">User Login</span> |
                        <span class="success">SUCCESS</span> |
                        User: jsmith
                    </div>
                    <div class="log-entry suspicious">
                        <span class="timestamp">2025-12-21 10:15:32</span> |
                        <span class="ip-address">203.0.113.50</span> |
                        <span class="event-type">Failed Login</span> |
                        <span class="failed">FAILED</span> |
                        User: admin | Attempts: 5
                    </div>
                    <div class="log-entry suspicious">
                        <span class="timestamp">2025-12-21 10:16:45</span> |
                        <span class="ip-address">203.0.113.50</span> |
                        <span class="event-type">Failed Login</span> |
                        <span class="failed">FAILED</span> |
                        User: root | Attempts: 8
                    </div>
                    <div class="log-entry malicious">
                        <span class="timestamp">2025-12-21 10:18:22</span> |
                        <span class="ip-address">203.0.113.50</span> |
                        <span class="event-type">Successful Login</span> |
                        <span class="success">SUCCESS</span> |
                        User: admin | Source: SSH
                    </div>
                    <div class="log-entry malicious">
                        <span class="timestamp">2025-12-21 10:19:05</span> |
                        <span class="ip-address">203.0.113.50</span> |
                        <span class="event-type">Privilege Escalation</span> |
                        <span class="failed">ALERT</span> |
                        User: admin -> root
                    </div>
                    <div class="log-entry malicious">
                        <span class="timestamp">2025-12-21 10:20:33</span> |
                        <span class="ip-address">203.0.113.50</span> |
                        <span class="event-type">File Access</span> |
                        <span class="failed">ALERT</span> |
                        File: /etc/shadow
                    </div>
                    <div class="log-entry malicious">
                        <span class="timestamp">2025-12-21 10:22:11</span> |
                        <span class="ip-address">203.0.113.50</span> |
                        <span class="event-type">Outbound Connection</span> |
                        <span class="failed">ALERT</span> |
                        Destination: 198.51.100.25:4444 | Bytes: 1.2MB
                    </div>
                    <div class="log-entry">
                        <span class="timestamp">2025-12-21 10:25:00</span> |
                        <span class="ip-address">192.168.1.100</span> |
                        <span class="event-type">User Logout</span> |
                        <span class="success">INFO</span> |
                        User: jsmith
                    </div>
                </div>

                <h3 style="margin-top: 30px;">Investigation Questions</h3>

                <label style="color: #c084fc; font-weight: bold; display: block; margin: 15px 0 10px 0;">1. What is the attacker's IP address?</label>
                <input type="text" class="answer-input" id="inv1" placeholder="Enter IP address">

                <label style="color: #c084fc; font-weight: bold; display: block; margin: 15px 0 10px 0;">2. What attack technique was used initially?</label>
                <select class="answer-input" id="inv2">
                    <option value="">-- Select Attack Technique --</option>
                    <option value="brute">Brute Force / Password Guessing</option>
                    <option value="sql">SQL Injection</option>
                    <option value="phishing">Phishing</option>
                    <option value="malware">Malware Infection</option>
                </select>

                <label style="color: #c084fc; font-weight: bold; display: block; margin: 15px 0 10px 0;">3. At what time did the attacker gain access?</label>
                <input type="text" class="answer-input" id="inv3" placeholder="Enter timestamp">

                <label style="color: #c084fc; font-weight: bold; display: block; margin: 15px 0 10px 0;">4. What did the attacker do after gaining access? (Select all that apply)</label>
                <div style="margin: 10px 0;">
                    <label style="display: block; margin: 8px 0;"><input type="checkbox" id="inv4a" style="margin-right: 10px;"> Escalated privileges to root</label>
                    <label style="display: block; margin: 8px 0;"><input type="checkbox" id="inv4b" style="margin-right: 10px;"> Accessed sensitive files (/etc/shadow)</label>
                    <label style="display: block; margin: 8px 0;"><input type="checkbox" id="inv4c" style="margin-right: 10px;"> Exfiltrated data to external IP</label>
                    <label style="display: block; margin: 8px 0;"><input type="checkbox" id="inv4d" style="margin-right: 10px;"> Installed backdoor</label>
                </div>

                <label style="color: #c084fc; font-weight: bold; display: block; margin: 15px 0 10px 0;">5. What is your recommended severity rating?</label>
                <select class="answer-input" id="inv5">
                    <option value="">-- Select Severity --</option>
                    <option value="low">Low</option>
                    <option value="medium">Medium</option>
                    <option value="high">High</option>
                    <option value="critical">Critical</option>
                </select>

                <button class="btn" onclick="checkInvestigation()">Submit Investigation</button>
                <button class="btn btn-secondary" onclick="showHint(5)">Show Hint</button>

                <div class="hint-box" id="hint5">
                    <strong>ðŸ’¡ Hint:</strong> Look for the pattern: failed attempts â†’ successful login â†’ privilege escalation â†’ data access â†’ exfiltration.
                    This is a classic post-exploitation sequence.
                </div>

                <div class="success-msg" id="success5"></div>
            </div>
        </div>

        <!-- Exercise 6: Correlate Events -->
        <div id="exercise6" class="exercise-content">
            <h2>Exercise 6: Correlate Events Across Sources</h2>
            <p>Connect related events from multiple log sources to identify coordinated attacks.</p>

            <h3>Scenario</h3>
            <p>Multiple security tools have generated alerts. Determine if they're related to a single attack campaign.</p>

            <div class="siem-interface">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px;">
                    <div>
                        <h3 style="color: #c084fc;">Firewall Logs</h3>
                        <div class="log-viewer" style="max-height: 200px;">
                            <div class="log-entry">10:00:00 | DENY | 203.0.113.50 â†’ 192.168.1.100:445 (SMB)</div>
                            <div class="log-entry">10:00:15 | DENY | 203.0.113.50 â†’ 192.168.1.100:135 (RPC)</div>
                            <div class="log-entry">10:00:30 | ALLOW | 203.0.113.50 â†’ 192.168.1.100:80 (HTTP)</div>
                        </div>
                    </div>

                    <div>
                        <h3 style="color: #c084fc;">IDS Alerts</h3>
                        <div class="log-viewer" style="max-height: 200px;">
                            <div class="log-entry">10:00:45 | SQL Injection attempt detected | 203.0.113.50</div>
                            <div class="log-entry">10:01:20 | Web shell upload detected | 192.168.1.100</div>
                        </div>
                    </div>

                    <div>
                        <h3 style="color: #c084fc;">Web Server Logs</h3>
                        <div class="log-viewer" style="max-height: 200px;">
                            <div class="log-entry">10:00:30 | GET /login.php | 200 | 203.0.113.50</div>
                            <div class="log-entry">10:00:45 | POST /login.php | 200 | 203.0.113.50</div>
                            <div class="log-entry">10:01:20 | POST /upload.php | 200 | 203.0.113.50</div>
                        </div>
                    </div>

                    <div>
                        <h3 style="color: #c084fc;">Endpoint Logs</h3>
                        <div class="log-viewer" style="max-height: 200px;">
                            <div class="log-entry">10:02:00 | New process: cmd.exe | Parent: w3wp.exe</div>
                            <div class="log-entry">10:02:15 | Outbound connection | 198.51.100.25:4444</div>
                        </div>
                    </div>
                </div>

                <h3 style="margin-top: 30px;">Correlation Analysis</h3>

                <label style="color: #c084fc; font-weight: bold; display: block; margin: 15px 0 10px 0;">Build the attack timeline in correct order:</label>
                <div id="timeline-builder" style="margin: 20px 0;">
                    <div style="background: rgba(30,30,60,0.5); padding: 15px; border-radius: 8px; margin: 10px 0;">
                        <p style="margin-bottom: 10px;">Drag events into the correct chronological order:</p>
                        <select class="answer-input" id="corr1">
                            <option value="">Step 1: Initial Action</option>
                            <option value="port_scan">Port scanning (blocked by firewall)</option>
                            <option value="web_access">HTTP access to web server</option>
                            <option value="sql">SQL injection attempt</option>
                            <option value="shell">Web shell upload</option>
                        </select>
                        <select class="answer-input" id="corr2">
                            <option value="">Step 2: Next Action</option>
                            <option value="port_scan">Port scanning (blocked by firewall)</option>
                            <option value="web_access">HTTP access to web server</option>
                            <option value="sql">SQL injection attempt</option>
                            <option value="shell">Web shell upload</option>
                        </select>
                        <select class="answer-input" id="corr3">
                            <option value="">Step 3: Next Action</option>
                            <option value="port_scan">Port scanning (blocked by firewall)</option>
                            <option value="web_access">HTTP access to web server</option>
                            <option value="sql">SQL injection attempt</option>
                            <option value="shell">Web shell upload</option>
                        </select>
                        <select class="answer-input" id="corr4">
                            <option value="">Step 4: Final Action</option>
                            <option value="port_scan">Port scanning (blocked by firewall)</option>
                            <option value="web_access">HTTP access to web server</option>
                            <option value="sql">SQL injection attempt</option>
                            <option value="shell">Web shell upload</option>
                            <option value="c2">Command & Control connection</option>
                        </select>
                    </div>
                </div>

                <label style="color: #c084fc; font-weight: bold; display: block; margin: 15px 0 10px 0;">What type of attack is this?</label>
                <select class="answer-input" id="corr5">
                    <option value="">-- Select Attack Type --</option>
                    <option value="web_compromise">Web Application Compromise leading to RCE</option>
                    <option value="ddos">Distributed Denial of Service</option>
                    <option value="ransomware">Ransomware Attack</option>
                    <option value="phishing">Phishing Campaign</option>
                </select>

                <button class="btn" onclick="checkCorrelation()">Check Correlation</button>

                <div class="success-msg" id="success6"></div>
            </div>
        </div>

        <!-- Exercise 7: Tune Alerts -->
        <div id="exercise7" class="exercise-content">
            <h2>Exercise 7: Alert Tuning</h2>
            <p>Reduce false positives while maintaining detection effectiveness.</p>

            <h3>Scenario</h3>
            <p>Your "Failed Login" alert is triggering 50+ times per day, overwhelming the SOC. Most are false positives. Tune the rule to reduce noise.</p>

            <div class="siem-interface">
                <h3 style="color: #c084fc;">Current Alert Rule (Noisy)</h3>
                <div class="alert-rule-preview">
                    <strong>Alert:</strong> Failed Login Detection<br>
                    <strong>Query:</strong> <code>index=windows EventCode=4625</code><br>
                    <strong>Trigger:</strong> Any failed login event<br>
                    <strong>Result:</strong> <span style="color: #ef4444;">50 alerts/day | 90% false positive rate</span>
                </div>

                <h3 style="color: #c084fc; margin-top: 30px;">Tuning Options</h3>
                <p>Select improvements to reduce false positives:</p>

                <div style="margin: 20px 0;">
                    <label style="display: block; margin: 12px 0;">
                        <input type="checkbox" id="tune1" style="margin-right: 10px;">
                        Add threshold: Only alert when count > 5 attempts
                    </label>
                    <label style="display: block; margin: 12px 0;">
                        <input type="checkbox" id="tune2" style="margin-right: 10px;">
                        Add time window: Count events within 5-minute window
                    </label>
                    <label style="display: block; margin: 12px 0;">
                        <input type="checkbox" id="tune3" style="margin-right: 10px;">
                        Exclude known systems: Filter out test servers (192.168.100.*)
                    </label>
                    <label style="display: block; margin: 12px 0;">
                        <input type="checkbox" id="tune4" style="margin-right: 10px;">
                        Group by source IP: Alert per unique attacking IP
                    </label>
                    <label style="display: block; margin: 12px 0;">
                        <input type="checkbox" id="tune5" style="margin-right: 10px;">
                        Add successful login correlation: Alert only if followed by success
                    </label>
                </div>

                <h3 style="color: #c084fc;">Write Improved Query</h3>
                <textarea class="search-bar" id="tunedQuery" rows="4" placeholder="Enter your tuned SPL query..."></textarea>

                <button class="btn" onclick="testTunedAlert()">Test Tuned Alert</button>

                <div class="alert-rule-preview" id="tuneResult" style="display: none; margin-top: 20px;"></div>

                <button class="btn" onclick="completeExercise(7)" id="completeEx7" disabled>Complete Exercise 7</button>
            </div>
        </div>
    </div>

    <script>
        const completedExercises = new Set();
        let widgetCount = 0;

        function loadExercise(num) {
            // Hide all exercises
            document.querySelectorAll('.exercise-content').forEach(ex => ex.classList.remove('active'));
            document.querySelectorAll('.exercise-card').forEach(card => card.classList.remove('active'));

            // Show selected exercise
            document.getElementById(`exercise${num}`).classList.add('active');
            document.querySelectorAll('.exercise-card')[num - 1].classList.add('active');

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function showHint(num) {
            document.getElementById(`hint${num}`).classList.add('visible');
        }

        function updateProgress() {
            const total = 7;
            const completed = completedExercises.size;
            const percentage = Math.round((completed / total) * 100);

            const progressBar = document.getElementById('overallProgress');
            progressBar.style.width = percentage + '%';
            progressBar.textContent = percentage + '%';
        }

        function completeExercise(num) {
            completedExercises.add(num);
            document.querySelectorAll('.exercise-card')[num - 1].classList.add('completed');
            updateProgress();

            // Show success message
            alert(`âœ“ Exercise ${num} completed! Progress: ${completedExercises.size}/7`);

            // If all complete, trigger achievement
            if (completedExercises.size === 7) {
                if (typeof AchievementManager !== 'undefined') {
                    AchievementManager.unlock('siem_analyst');
                }
                alert('ðŸŽ‰ Congratulations! All SIEM exercises completed!');
            }
        }

        // Exercise 1: Parse Logs
        function checkExercise1() {
            const q1 = document.getElementById('ex1q1').value;
            const q2 = document.getElementById('ex1q2').value;
            const q3 = document.getElementById('ex1q3').value;
            const q4 = document.getElementById('ex1q4').value;

            if (q1 === 'apache' && q2 === '192.168.1.50' && q3 === '401' && q4 === 'yes') {
                document.getElementById('success1').innerHTML = 'âœ“ Correct! This is an Apache log showing unauthorized access attempt.';
                document.getElementById('success1').classList.add('visible');
                document.getElementById('ex1part2').style.display = 'block';

                // Mark first task complete
                setTimeout(() => {
                    const q5 = document.getElementById('ex1q5').value;
                    if (q5 === 'brute') {
                        // Will be checked in completeExercise
                    }
                }, 500);
            } else {
                alert('Some answers are incorrect. Review the log format and try again.');
            }
        }

        // Exercise 2: SPL Queries
        function runQuery(num) {
            const queries = {
                1: document.getElementById('query1').value,
                2: document.getElementById('query2').value,
                3: document.getElementById('query3').value
            };

            const results = {
                1: `Query executed successfully\n\n5 events found\n\nEventCode=4625 (Failed Login)\nTimestamp range: Last 24 hours`,
                2: `Query executed successfully\n\nsrc_ip           count\n203.0.113.50    15\n198.51.100.25   8\n192.168.1.45    3`,
                3: `Query executed successfully\n\nsrc_ip           count\n203.0.113.50    15\n\nHigh-volume attackers identified: 1`
            };

            const resultDiv = document.getElementById(`queryResult${num}`);
            resultDiv.textContent = results[num];
            resultDiv.style.display = 'block';

            // Check if query contains expected elements
            const query = queries[num].toLowerCase();
            const validations = {
                1: query.includes('eventcode=4625') && query.includes('earliest'),
                2: query.includes('stats') && query.includes('count'),
                3: query.includes('where') && query.includes('count')
            };

            if (validations[num]) {
                if (num === 3) {
                    document.getElementById('completeEx2').disabled = false;
                }
            }
        }

        // Exercise 3: Alert Rules
        function createAlert() {
            const name = document.getElementById('alertName').value;
            const query = document.getElementById('alertQuery').value;
            const threshold = document.getElementById('alertThreshold').value;
            const window = document.getElementById('alertWindow').value;
            const severity = document.getElementById('alertSeverity').value;

            if (!name || !query) {
                alert('Please fill in all required fields');
                return;
            }

            const preview = document.getElementById('alertPreview');
            preview.innerHTML = `
                <h3 style="color: #06b6d4;">${name}</h3>
                <p><strong>Query:</strong> <code>${query}</code></p>
                <p><strong>Threshold:</strong> ${threshold} events in ${window}</p>
                <p><strong>Severity:</strong> <span class="severity-${severity}">${severity.toUpperCase()}</span></p>
                <p style="color: #22c55e; margin-top: 15px;">âœ“ Alert rule configured successfully</p>
            `;
            preview.style.display = 'block';

            // Mark tasks complete
            ['task3-1', 'task3-2', 'task3-3', 'task3-4'].forEach(id => {
                document.getElementById(id).classList.add('completed');
            });
        }

        function testAlert() {
            document.getElementById('task3-5').classList.add('completed');
            document.getElementById('completeEx3').disabled = false;
            alert('Alert test successful! Rule triggered 2 times in test environment.');
        }

        // Exercise 4: Dashboard
        function addWidget(type) {
            widgetCount++;

            const dashboardArea = document.getElementById('dashboardArea');
            if (widgetCount === 1) {
                dashboardArea.innerHTML = '';
            }

            const values = {
                failed_logins: 127,
                success_logins: 1543,
                unique_ips: 45,
                alerts: 8
            };

            // Update stat cards
            ['stat1', 'stat2', 'stat3', 'stat4'].forEach((id, idx) => {
                const val = Object.values(values)[idx];
                document.getElementById(id).textContent = val;
            });

            // Add chart to dashboard
            const widget = document.createElement('div');
            widget.style.marginBottom = '30px';
            widget.innerHTML = `
                <h3 style="color: #06b6d4;">Top Failed Login Sources</h3>
                <div class="chart-bar" style="width: 75%;">203.0.113.50: 15 attempts</div>
                <div class="chart-bar" style="width: 50%;">198.51.100.25: 10 attempts</div>
                <div class="chart-bar" style="width: 25%;">192.168.1.45: 5 attempts</div>
            `;
            dashboardArea.appendChild(widget);

            if (widgetCount >= 2) {
                document.getElementById('completeEx4').disabled = false;
            }
        }

        // Exercise 5: Investigation
        function checkInvestigation() {
            const inv1 = document.getElementById('inv1').value;
            const inv2 = document.getElementById('inv2').value;
            const inv3 = document.getElementById('inv3').value;
            const inv4a = document.getElementById('inv4a').checked;
            const inv4b = document.getElementById('inv4b').checked;
            const inv4c = document.getElementById('inv4c').checked;
            const inv5 = document.getElementById('inv5').value;

            if (inv1 === '203.0.113.50' && inv2 === 'brute' && inv4a && inv4b && inv4c && inv5 === 'critical') {
                document.getElementById('success5').innerHTML = `
                    âœ“ Investigation Complete!<br><br>
                    <strong>Summary:</strong> Successful brute force attack leading to privilege escalation and data exfiltration.<br>
                    <strong>Recommended Actions:</strong> Block 203.0.113.50, reset admin password, review /etc/shadow access, investigate data sent to 198.51.100.25
                `;
                document.getElementById('success5').classList.add('visible');

                setTimeout(() => {
                    completeExercise(5);
                }, 1000);
            } else {
                alert('Review your answers. Check the timeline and severity assessment.');
            }
        }

        // Exercise 6: Correlation
        function checkCorrelation() {
            const corr1 = document.getElementById('corr1').value;
            const corr2 = document.getElementById('corr2').value;
            const corr3 = document.getElementById('corr3').value;
            const corr4 = document.getElementById('corr4').value;
            const corr5 = document.getElementById('corr5').value;

            if (corr1 === 'port_scan' && corr2 === 'web_access' && corr3 === 'sql' && corr4 === 'shell' && corr5 === 'web_compromise') {
                document.getElementById('success6').innerHTML = `
                    âœ“ Correlation Correct!<br><br>
                    <strong>Attack Chain:</strong> Port scan â†’ HTTP access â†’ SQL injection â†’ Web shell upload â†’ Command execution â†’ C2 connection<br>
                    <strong>Classification:</strong> Web application compromise leading to remote code execution
                `;
                document.getElementById('success6').classList.add('visible');

                setTimeout(() => {
                    completeExercise(6);
                }, 1000);
            } else {
                alert('Timeline order is incorrect. Think about the logical attack progression.');
            }
        }

        // Exercise 7: Alert Tuning
        function testTunedAlert() {
            const tune1 = document.getElementById('tune1').checked;
            const tune2 = document.getElementById('tune2').checked;
            const tune3 = document.getElementById('tune3').checked;
            const tune4 = document.getElementById('tune4').checked;
            const query = document.getElementById('tunedQuery').value;

            const tuneResult = document.getElementById('tuneResult');

            if (tune1 && tune2 && tune4 && query.length > 20) {
                tuneResult.innerHTML = `
                    <strong>Tuned Alert Results:</strong><br>
                    <strong>Query:</strong> <code>${query}</code><br>
                    <strong>Before:</strong> 50 alerts/day | 90% false positive rate<br>
                    <strong>After:</strong> <span style="color: #22c55e;">3 alerts/day | 15% false positive rate</span><br><br>
                    âœ“ Alert tuning successful! False positives reduced by 94%.
                `;
                tuneResult.style.display = 'block';
                document.getElementById('completeEx7').disabled = false;
            } else {
                tuneResult.innerHTML = `
                    <strong style="color: #ef4444;">Alert still too noisy</strong><br>
                    Consider adding threshold, time window, and grouping by IP.
                `;
                tuneResult.style.display = 'block';
            }
        }
    </script>
</body>
</html>
