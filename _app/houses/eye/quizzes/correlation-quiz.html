<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Log Correlation Quiz - Eye House - Hexworth Prime</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #0f0f23 0%, #1a0a2e 100%);
      color: #e0e0e0;
      line-height: 1.6;
      padding: 20px;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
    }

    header {
      text-align: center;
      padding: 30px 20px;
      background: linear-gradient(135deg, rgba(192, 132, 252, 0.1) 0%, rgba(6, 182, 212, 0.1) 100%);
      border-radius: 15px;
      margin-bottom: 30px;
      border: 2px solid rgba(192, 132, 252, 0.3);
    }

    h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
      background: linear-gradient(135deg, #c084fc 0%, #06b6d4 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subtitle {
      font-size: 1.1em;
      color: #06b6d4;
    }

    .progress-bar {
      background: rgba(15, 15, 35, 0.8);
      height: 30px;
      border-radius: 15px;
      overflow: hidden;
      margin: 20px 0;
      border: 2px solid rgba(192, 132, 252, 0.3);
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #c084fc 0%, #06b6d4 100%);
      transition: width 0.5s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 600;
      font-size: 0.9em;
    }

    .quiz-info {
      background: rgba(6, 182, 212, 0.1);
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 30px;
      border-left: 5px solid #06b6d4;
    }

    .question-card {
      background: rgba(30, 30, 60, 0.6);
      padding: 30px;
      border-radius: 15px;
      margin-bottom: 30px;
      border: 2px solid rgba(192, 132, 252, 0.3);
      display: none;
    }

    .question-card.active {
      display: block;
      animation: slideIn 0.5s ease;
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .question-number {
      display: inline-block;
      background: linear-gradient(135deg, #c084fc 0%, #06b6d4 100%);
      color: #0f0f23;
      padding: 8px 16px;
      border-radius: 20px;
      font-weight: bold;
      margin-bottom: 15px;
    }

    .question-text {
      font-size: 1.2em;
      color: #c084fc;
      margin-bottom: 20px;
      line-height: 1.8;
    }

    .code-block {
      background: rgba(0, 0, 0, 0.4);
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
      border: 1px solid rgba(192, 132, 252, 0.3);
      font-family: 'Courier New', monospace;
      color: #06b6d4;
      overflow-x: auto;
    }

    .options {
      margin: 20px 0;
    }

    .option {
      background: rgba(15, 15, 35, 0.6);
      padding: 15px 20px;
      margin: 10px 0;
      border-radius: 10px;
      border: 2px solid rgba(192, 132, 252, 0.3);
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .option:hover {
      background: rgba(192, 132, 252, 0.1);
      border-color: #c084fc;
      transform: translateX(5px);
    }

    .option.selected {
      background: rgba(6, 182, 212, 0.2);
      border-color: #06b6d4;
    }

    .option.correct {
      background: rgba(74, 222, 128, 0.2);
      border-color: #4ade80;
    }

    .option.incorrect {
      background: rgba(244, 114, 182, 0.2);
      border-color: #f472b6;
    }

    .option-letter {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 35px;
      height: 35px;
      background: rgba(192, 132, 252, 0.3);
      border-radius: 50%;
      font-weight: bold;
      color: #c084fc;
      flex-shrink: 0;
    }

    .option.selected .option-letter {
      background: #06b6d4;
      color: #0f0f23;
    }

    .option.correct .option-letter {
      background: #4ade80;
      color: #0f0f23;
    }

    .option.incorrect .option-letter {
      background: #f472b6;
      color: #0f0f23;
    }

    .explanation {
      display: none;
      background: rgba(6, 182, 212, 0.1);
      padding: 20px;
      border-radius: 10px;
      margin-top: 20px;
      border-left: 5px solid #06b6d4;
    }

    .explanation.show {
      display: block;
      animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .explanation h4 {
      color: #06b6d4;
      margin-bottom: 10px;
    }

    .controls {
      display: flex;
      justify-content: space-between;
      margin-top: 30px;
      gap: 15px;
      flex-wrap: wrap;
    }

    button {
      background: linear-gradient(135deg, rgba(192, 132, 252, 0.3) 0%, rgba(6, 182, 212, 0.3) 100%);
      color: #c084fc;
      border: 2px solid #c084fc;
      padding: 12px 25px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1em;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    button:hover:not(:disabled) {
      background: linear-gradient(135deg, rgba(192, 132, 252, 0.5) 0%, rgba(6, 182, 212, 0.5) 100%);
      transform: translateY(-2px);
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    button.primary {
      background: linear-gradient(135deg, #c084fc 0%, #06b6d4 100%);
      color: #0f0f23;
    }

    .results-screen {
      display: none;
      background: rgba(30, 30, 60, 0.6);
      padding: 40px;
      border-radius: 15px;
      border: 2px solid rgba(192, 132, 252, 0.3);
      text-align: center;
    }

    .results-screen.show {
      display: block;
      animation: slideIn 0.5s ease;
    }

    .score-display {
      font-size: 4em;
      font-weight: bold;
      background: linear-gradient(135deg, #c084fc 0%, #06b6d4 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin: 20px 0;
    }

    .score-breakdown {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin: 30px 0;
    }

    .score-card {
      background: linear-gradient(135deg, rgba(192, 132, 252, 0.1) 0%, rgba(6, 182, 212, 0.1) 100%);
      padding: 20px;
      border-radius: 10px;
      border: 2px solid rgba(192, 132, 252, 0.3);
    }

    .score-value {
      font-size: 2em;
      font-weight: bold;
      color: #c084fc;
    }

    .score-label {
      color: #06b6d4;
      margin-top: 5px;
    }

    .performance-message {
      background: rgba(192, 132, 252, 0.1);
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
      border-left: 5px solid #c084fc;
    }

    .review-list {
      text-align: left;
      margin: 20px 0;
    }

    .review-item {
      background: rgba(15, 15, 35, 0.6);
      padding: 15px;
      margin: 10px 0;
      border-radius: 8px;
      border-left: 4px solid;
    }

    .review-item.correct {
      border-left-color: #4ade80;
    }

    .review-item.incorrect {
      border-left-color: #f472b6;
    }

    @media (max-width: 768px) {
      .controls {
        flex-direction: column;
      }

      button {
        width: 100%;
      }

      .score-breakdown {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üìù Log Correlation Quiz</h1>
      <p class="subtitle">Test Your Security Event Correlation Knowledge</p>
      <div class="progress-bar">
        <div class="progress-fill" id="progressBar">Question 0 of 10</div>
      </div>
    </header>

    <div class="quiz-info" id="quizInfo">
      <h3 style="color: #06b6d4; margin-bottom: 10px;">Quiz Information</h3>
      <ul>
        <li>10 questions covering log correlation concepts and techniques</li>
        <li>Topics: Correlation rules, time windows, multi-source analysis, MITRE ATT&CK, and more</li>
        <li>Passing score: 70% (7 out of 10)</li>
        <li>Review detailed explanations after each question</li>
      </ul>
      <button class="primary" onclick="startQuiz()" style="margin-top: 20px;">Start Quiz</button>
    </div>

    <!-- Question 1 -->
    <div class="question-card" id="q1">
      <span class="question-number">Question 1 of 10</span>
      <div class="question-text">
        What is the primary purpose of log correlation in security analysis?
      </div>

      <div class="options">
        <div class="option" onclick="selectOption(1, 'A')">
          <span class="option-letter">A</span>
          <span>To reduce the total number of logs stored in the SIEM</span>
        </div>
        <div class="option" onclick="selectOption(1, 'B')">
          <span class="option-letter">B</span>
          <span>To link related events from multiple sources to detect patterns and attacks</span>
        </div>
        <div class="option" onclick="selectOption(1, 'C')">
          <span class="option-letter">C</span>
          <span>To automatically delete duplicate log entries</span>
        </div>
        <div class="option" onclick="selectOption(1, 'D')">
          <span class="option-letter">D</span>
          <span>To convert all logs to the same format</span>
        </div>
      </div>

      <div class="explanation" id="exp1">
        <h4>‚úì Correct Answer: B</h4>
        <p><strong>Explanation:</strong> Log correlation is the process of analyzing and linking related events from multiple log sources to identify patterns, detect security incidents, and reconstruct attack timelines. Single events often lack context, but when correlated with related events, they reveal the complete picture of an attack.</p>
        <p><strong>Why other options are incorrect:</strong></p>
        <ul>
          <li><strong>A:</strong> Correlation analyzes logs but doesn't primarily reduce storage</li>
          <li><strong>C:</strong> Deduplication is different from correlation</li>
          <li><strong>D:</strong> Format normalization is a prerequisite, not the main purpose</li>
        </ul>
      </div>

      <div class="controls">
        <button onclick="prevQuestion()" disabled>‚Üê Previous</button>
        <button class="primary" onclick="checkAnswer(1, 'B')">Check Answer</button>
        <button onclick="nextQuestion()" id="next1" disabled>Next ‚Üí</button>
      </div>
    </div>

    <!-- Question 2 -->
    <div class="question-card" id="q2">
      <span class="question-number">Question 2 of 10</span>
      <div class="question-text">
        Which correlation rule syntax would best detect a successful brute force attack?
      </div>

      <div class="code-block" style="margin-bottom: 20px;">
Review the options below and select the most effective rule structure.
      </div>

      <div class="options">
        <div class="option" onclick="selectOption(2, 'A')">
          <span class="option-letter">A</span>
          <span>IF (failed_login) THEN alert</span>
        </div>
        <div class="option" onclick="selectOption(2, 'B')">
          <span class="option-letter">B</span>
          <span>IF COUNT(failed_login) > 5 WHERE source_ip = SAME<br>FOLLOWED BY successful_login WHERE source_ip = SAME<br>WITHIN 10 minutes</span>
        </div>
        <div class="option" onclick="selectOption(2, 'C')">
          <span class="option-letter">C</span>
          <span>IF successful_login THEN check for failed_logins</span>
        </div>
        <div class="option" onclick="selectOption(2, 'D')">
          <span class="option-letter">D</span>
          <span>IF COUNT(any_login) > 100 THEN alert</span>
        </div>
      </div>

      <div class="explanation" id="exp2">
        <h4>‚úì Correct Answer: B</h4>
        <p><strong>Explanation:</strong> A successful brute force detection requires:</p>
        <ul>
          <li><strong>COUNT threshold:</strong> Multiple failed attempts (>5)</li>
          <li><strong>Same source:</strong> All from the same IP address</li>
          <li><strong>Sequential logic:</strong> Failures FOLLOWED BY success</li>
          <li><strong>Time window:</strong> Within a reasonable timeframe (10 minutes)</li>
        </ul>
        <p>This rule captures the complete attack pattern: many failures leading to eventual success, which is the signature of a successful brute force attack.</p>
        <p><strong>Why other options fail:</strong></p>
        <ul>
          <li><strong>A:</strong> Too simple - single failed login isn't brute force</li>
          <li><strong>C:</strong> Wrong order - should check failures before success</li>
          <li><strong>D:</strong> Too broad - doesn't distinguish attack from normal activity</li>
        </ul>
      </div>

      <div class="controls">
        <button onclick="prevQuestion()">‚Üê Previous</button>
        <button class="primary" onclick="checkAnswer(2, 'B')">Check Answer</button>
        <button onclick="nextQuestion()" id="next2" disabled>Next ‚Üí</button>
      </div>
    </div>

    <!-- Question 3 -->
    <div class="question-card" id="q3">
      <span class="question-number">Question 3 of 10</span>
      <div class="question-text">
        You're investigating lateral movement. Which log sources should you correlate to track an attacker's movement across systems?
      </div>

      <div class="options">
        <div class="option" onclick="selectOption(3, 'A')">
          <span class="option-letter">A</span>
          <span>Only authentication logs</span>
        </div>
        <div class="option" onclick="selectOption(3, 'B')">
          <span class="option-letter">B</span>
          <span>Only network firewall logs</span>
        </div>
        <div class="option" onclick="selectOption(3, 'C')">
          <span class="option-letter">C</span>
          <span>Authentication logs, network logs, endpoint EDR logs, and process execution logs</span>
        </div>
        <div class="option" onclick="selectOption(3, 'D')">
          <span class="option-letter">D</span>
          <span>Only email gateway logs</span>
        </div>
      </div>

      <div class="explanation" id="exp3">
        <h4>‚úì Correct Answer: C</h4>
        <p><strong>Explanation:</strong> Detecting lateral movement requires multi-source correlation:</p>
        <ul>
          <li><strong>Authentication logs:</strong> Show login attempts and successes on different systems</li>
          <li><strong>Network logs:</strong> Reveal connections between systems (SMB, RDP, SSH)</li>
          <li><strong>Endpoint EDR logs:</strong> Show process execution and post-compromise activities</li>
          <li><strong>Process execution logs:</strong> Identify tools used for lateral movement (PsExec, WMI, PowerShell remoting)</li>
        </ul>
        <p><strong>Example lateral movement chain:</strong></p>
        <div class="code-block">
1. EDR: Credential dumping on Host A
2. Network: SMB connection from Host A to Host B
3. Auth: Login to Host B using stolen credentials
4. Process: Malicious process execution on Host B
        </div>
        <p>Without correlating all these sources, you'd miss the complete attack picture.</p>
      </div>

      <div class="controls">
        <button onclick="prevQuestion()">‚Üê Previous</button>
        <button class="primary" onclick="checkAnswer(3, 'C')">Check Answer</button>
        <button onclick="nextQuestion()" id="next3" disabled>Next ‚Üí</button>
      </div>
    </div>

    <!-- Question 4 -->
    <div class="question-card" id="q4">
      <span class="question-number">Question 4 of 10</span>
      <div class="question-text">
        What is the most appropriate correlation time window for detecting a rapid brute force attack?
      </div>

      <div class="options">
        <div class="option" onclick="selectOption(4, 'A')">
          <span class="option-letter">A</span>
          <span>1 second</span>
        </div>
        <div class="option" onclick="selectOption(4, 'B')">
          <span class="option-letter">B</span>
          <span>5-10 minutes</span>
        </div>
        <div class="option" onclick="selectOption(4, 'C')">
          <span class="option-letter">C</span>
          <span>24 hours</span>
        </div>
        <div class="option" onclick="selectOption(4, 'D')">
          <span class="option-letter">D</span>
          <span>7 days</span>
        </div>
      </div>

      <div class="explanation" id="exp4">
        <h4>‚úì Correct Answer: B</h4>
        <p><strong>Explanation:</strong> Time window selection depends on the attack type:</p>
        <ul>
          <li><strong>Brute force attacks</strong> typically occur rapidly, with multiple attempts in minutes</li>
          <li><strong>5-10 minutes</strong> is optimal because:
            <ul>
              <li>Catches fast automated attacks (seconds to minutes)</li>
              <li>Catches slower manual attempts (up to 10 minutes)</li>
              <li>Avoids false positives from legitimate user behavior over hours/days</li>
            </ul>
          </li>
        </ul>
        <p><strong>Window size trade-offs:</strong></p>
        <div class="code-block">
Too short (1 sec):  Misses attacks, very low detection
Optimal (5-10 min): Catches brute force, minimal false positives
Too long (24 hours): Excessive false positives from normal failures
Way too long (7 days): Meaningless correlation
        </div>
        <p><strong>Note:</strong> Different attacks need different windows. APT campaigns might require days/weeks, while DDoS detection needs seconds.</p>
      </div>

      <div class="controls">
        <button onclick="prevQuestion()">‚Üê Previous</button>
        <button class="primary" onclick="checkAnswer(4, 'B')">Check Answer</button>
        <button onclick="nextQuestion()" id="next4" disabled>Next ‚Üí</button>
      </div>
    </div>

    <!-- Question 5 -->
    <div class="question-card" id="q5">
      <span class="question-number">Question 5 of 10</span>
      <div class="question-text">
        In MITRE ATT&CK kill chain mapping, which tactic comes immediately after "Initial Access"?
      </div>

      <div class="options">
        <div class="option" onclick="selectOption(5, 'A')">
          <span class="option-letter">A</span>
          <span>Impact</span>
        </div>
        <div class="option" onclick="selectOption(5, 'B')">
          <span class="option-letter">B</span>
          <span>Execution</span>
        </div>
        <div class="option" onclick="selectOption(5, 'C')">
          <span class="option-letter">C</span>
          <span>Lateral Movement</span>
        </div>
        <div class="option" onclick="selectOption(5, 'D')">
          <span class="option-letter">D</span>
          <span>Exfiltration</span>
        </div>
      </div>

      <div class="explanation" id="exp5">
        <h4>‚úì Correct Answer: B</h4>
        <p><strong>Explanation:</strong> The MITRE ATT&CK framework follows this typical attack progression:</p>
        <div class="code-block">
1. Reconnaissance (gather info)
2. Initial Access (get foothold) ‚Üê Start
3. Execution (run malicious code) ‚Üê Next step
4. Persistence (maintain access)
5. Privilege Escalation (gain higher permissions)
6. Defense Evasion (avoid detection)
7. Credential Access (steal credentials)
8. Discovery (explore environment)
9. Lateral Movement (spread through network)
10. Collection (gather data)
11. Command & Control (communicate with attacker)
12. Exfiltration (steal data)
13. Impact (damage/disrupt)
        </div>
        <p><strong>After Initial Access, Execution is next because:</strong></p>
        <ul>
          <li>The attacker has gained entry but needs to run code</li>
          <li>Execution enables all subsequent tactics</li>
          <li>Example: Phishing email (Initial Access) ‚Üí User runs malicious attachment (Execution)</li>
        </ul>
      </div>

      <div class="controls">
        <button onclick="prevQuestion()">‚Üê Previous</button>
        <button class="primary" onclick="checkAnswer(5, 'B')">Check Answer</button>
        <button onclick="nextQuestion()" id="next5" disabled>Next ‚Üí</button>
      </div>
    </div>

    <!-- Question 6 -->
    <div class="question-card" id="q6">
      <span class="question-number">Question 6 of 10</span>
      <div class="question-text">
        You notice a user's data transfer volume is 295 standard deviations above their baseline. What does this indicate?
      </div>

      <div class="options">
        <div class="option" onclick="selectOption(6, 'A')">
          <span class="option-letter">A</span>
          <span>Normal activity - users' behavior varies</span>
        </div>
        <div class="option" onclick="selectOption(6, 'B')">
          <span class="option-letter">B</span>
          <span>Statistically impossible for legitimate activity - investigate immediately</span>
        </div>
        <div class="option" onclick="selectOption(6, 'C')">
          <span class="option-letter">C</span>
          <span>The user is probably downloading a large software update</span>
        </div>
        <div class="option" onclick="selectOption(6, 'D')">
          <span class="option-letter">D</span>
          <span>Your baseline calculation is incorrect</span>
        </div>
      </div>

      <div class="explanation" id="exp6">
        <h4>‚úì Correct Answer: B</h4>
        <p><strong>Explanation:</strong> Statistical significance of standard deviations:</p>
        <ul>
          <li><strong>1œÉ (1 std dev):</strong> ~68% of normal data falls within this range</li>
          <li><strong>2œÉ (2 std dev):</strong> ~95% of normal data</li>
          <li><strong>3œÉ (3 std dev):</strong> ~99.7% of normal data - anything beyond is unusual</li>
          <li><strong>6œÉ (6 std dev):</strong> Extremely rare (1 in 506 million events)</li>
          <li><strong>295œÉ:</strong> <strong>Statistically impossible for legitimate activity</strong></li>
        </ul>
        <p><strong>Real-world example from the presentation:</strong></p>
        <div class="code-block">
User: charlie@company.com
Baseline: 35 MB/day (¬±8 MB std dev)
Today: 2,400 MB
Calculation: (2400 - 35) / 8 = 295 standard deviations

Conclusion: Data exfiltration attack in progress
        </div>
        <p><strong>Investigation revealed:</strong> Bulk download of customer database at 3:15 AM, immediately before resignation submission.</p>
        <p>This is a classic insider threat scenario that baseline correlation detected.</p>
      </div>

      <div class="controls">
        <button onclick="prevQuestion()">‚Üê Previous</button>
        <button class="primary" onclick="checkAnswer(6, 'B')">Check Answer</button>
        <button onclick="nextQuestion()" id="next6" disabled>Next ‚Üí</button>
      </div>
    </div>

    <!-- Question 7 -->
    <div class="question-card" id="q7">
      <span class="question-number">Question 7 of 10</span>
      <div class="question-text">
        What is the main challenge when correlating logs from systems in different time zones?
      </div>

      <div class="options">
        <div class="option" onclick="selectOption(7, 'A')">
          <span class="option-letter">A</span>
          <span>Different log formats</span>
        </div>
        <div class="option" onclick="selectOption(7, 'B')">
          <span class="option-letter">B</span>
          <span>Events appear out of chronological order without time normalization</span>
        </div>
        <div class="option" onclick="selectOption(7, 'C')">
          <span class="option-letter">C</span>
          <span>Different languages in log messages</span>
        </div>
        <div class="option" onclick="selectOption(7, 'D')">
          <span class="option-letter">D</span>
          <span>Incompatible log storage systems</span>
        </div>
      </div>

      <div class="explanation" id="exp7">
        <h4>‚úì Correct Answer: B</h4>
        <p><strong>Explanation:</strong> Time zone differences break chronological correlation:</p>
        <p><strong>Example scenario:</strong></p>
        <div class="code-block">
Log 1: [New York EST] 10:15:22 - Failed login
Log 2: [London GMT]   15:18:10 - Successful login
Log 3: [Tokyo JST]    00:22:45 - Data exfiltration

Without normalization, it's unclear which happened first!

Converting to UTC:
Log 1: 15:15:22 UTC (10:15:22 + 5 hours)
Log 2: 15:18:10 UTC (no change from GMT)
Log 3: 15:22:45 UTC (00:22:45 - 9 hours + 24 hours)

Correct order: NY ‚Üí London ‚Üí Tokyo
Attack duration: 7 minutes 23 seconds
        </div>
        <p><strong>Best practices:</strong></p>
        <ul>
          <li>Always normalize to UTC before correlation</li>
          <li>Ensure all systems use NTP for time synchronization</li>
          <li>Store original timezone information for reporting</li>
          <li>Account for clock drift (systems may have slight time differences)</li>
        </ul>
      </div>

      <div class="controls">
        <button onclick="prevQuestion()">‚Üê Previous</button>
        <button class="primary" onclick="checkAnswer(7, 'B')">Check Answer</button>
        <button onclick="nextQuestion()" id="next7" disabled>Next ‚Üí</button>
      </div>
    </div>

    <!-- Question 8 -->
    <div class="question-card" id="q8">
      <span class="question-number">Question 8 of 10</span>
      <div class="question-text">
        Which correlation technique would be most effective for tracking an insider threat where an employee is stealing data before leaving the company?
      </div>

      <div class="options">
        <div class="option" onclick="selectOption(8, 'A')">
          <span class="option-letter">A</span>
          <span>IP-based correlation only</span>
        </div>
        <div class="option" onclick="selectOption(8, 'B')">
          <span class="option-letter">B</span>
          <span>User-based correlation with baseline deviation detection</span>
        </div>
        <div class="option" onclick="selectOption(8, 'C')">
          <span class="option-letter">C</span>
          <span>Time-based correlation only</span>
        </div>
        <div class="option" onclick="selectOption(8, 'D')">
          <span class="option-letter">D</span>
          <span>Session-based correlation only</span>
        </div>
      </div>

      <div class="explanation" id="exp8">
        <h4>‚úì Correct Answer: B</h4>
        <p><strong>Explanation:</strong> Insider threats require user-centric analysis:</p>
        <p><strong>Why user-based correlation with baseline deviation:</strong></p>
        <ul>
          <li>Insiders use legitimate credentials from legitimate IPs</li>
          <li>The suspicious activity is <em>deviation from normal behavior</em></li>
          <li>Need to track all user activities across systems</li>
          <li>Compare current behavior against historical baseline</li>
        </ul>
        <p><strong>Example insider threat correlation rule:</strong></p>
        <div class="code-block">
IF (
  hr_status = "termination_pending" OR "resignation_submitted"
  AND
  (
    file_downloads > user_baseline * 2 OR
    email_forwarding to external_domain OR
    usb_device connected OR
    cloud_uploads to personal_account OR
    accessed_resources NOT IN user_baseline_resources
  )
  WITHIN 30 days of termination_date
)
THEN alert = "Potential insider data theft"
        </div>
        <p><strong>Real scenario indicators:</strong></p>
        <ul>
          <li>300% increase in file downloads</li>
          <li>Accessing files never accessed before</li>
          <li>Creating email forwarding rules to personal email</li>
          <li>Connecting USB devices (policy violation)</li>
          <li>Off-hours activity</li>
        </ul>
      </div>

      <div class="controls">
        <button onclick="prevQuestion()">‚Üê Previous</button>
        <button class="primary" onclick="checkAnswer(8, 'B')">Check Answer</button>
        <button onclick="nextQuestion()" id="next8" disabled>Next ‚Üí</button>
      </div>
    </div>

    <!-- Question 9 -->
    <div class="question-card" id="q9">
      <span class="question-number">Question 9 of 10</span>
      <div class="question-text">
        When building a timeline for incident response, what is the most critical first step?
      </div>

      <div class="options">
        <div class="option" onclick="selectOption(9, 'A')">
          <span class="option-letter">A</span>
          <span>Immediately block all suspicious IPs</span>
        </div>
        <div class="option" onclick="selectOption(9, 'B')">
          <span class="option-letter">B</span>
          <span>Normalize all timestamps to a common timezone (UTC)</span>
        </div>
        <div class="option" onclick="selectOption(9, 'C')">
          <span class="option-letter">C</span>
          <span>Delete duplicate log entries</span>
        </div>
        <div class="option" onclick="selectOption(9, 'D')">
          <span class="option-letter">D</span>
          <span>Focus only on the most recent logs</span>
        </div>
      </div>

      <div class="explanation" id="exp9">
        <h4>‚úì Correct Answer: B</h4>
        <p><strong>Explanation:</strong> Timeline reconstruction process:</p>
        <ol>
          <li><strong>Time Normalization (CRITICAL FIRST STEP):</strong> Convert all timestamps to UTC</li>
          <li><strong>Event Collection:</strong> Gather relevant logs from timeframe</li>
          <li><strong>Event Sequencing:</strong> Sort chronologically</li>
          <li><strong>Gap Analysis:</strong> Identify missing events</li>
          <li><strong>Narrative Construction:</strong> Build attack story</li>
        </ol>
        <p><strong>Why time normalization must be first:</strong></p>
        <div class="code-block">
Without normalization:
Server A (EST): 10:32:15 - Malware executed
Server B (PST): 10:28:42 - C2 connection
Firewall (UTC): 15:35:01 - Outbound connection

This makes no sense! Which happened first?

After normalization (UTC):
15:32:15 - Server A: Malware executed
15:28:42 - Server B: C2 connection (wait, this is earlier!)
15:35:01 - Firewall: Outbound connection

Correct order now reveals attack flow!
        </div>
        <p><strong>Common timestamp formats to normalize:</strong></p>
        <ul>
          <li>Unix epoch (1710507135)</li>
          <li>ISO 8601 (2024-03-15T14:35:48Z)</li>
          <li>Local time with timezone (Mar 15 10:35:48 EST)</li>
          <li>Custom application formats</li>
        </ul>
      </div>

      <div class="controls">
        <button onclick="prevQuestion()">‚Üê Previous</button>
        <button class="primary" onclick="checkAnswer(9, 'B')">Check Answer</button>
        <button onclick="nextQuestion()" id="next9" disabled>Next ‚Üí</button>
      </div>
    </div>

    <!-- Question 10 -->
    <div class="question-card" id="q10">
      <span class="question-number">Question 10 of 10</span>
      <div class="question-text">
        A correlation rule generates too many false positives. What is the BEST way to reduce false positives while maintaining detection capability?
      </div>

      <div class="options">
        <div class="option" onclick="selectOption(10, 'A')">
          <span class="option-letter">A</span>
          <span>Disable the correlation rule completely</span>
        </div>
        <div class="option" onclick="selectOption(10, 'B')">
          <span class="option-letter">B</span>
          <span>Add more specific conditions and context (whitelist trusted IPs, increase thresholds, add AND conditions)</span>
        </div>
        <div class="option" onclick="selectOption(10, 'C')">
          <span class="option-letter">C</span>
          <span>Increase the alert threshold to maximum value</span>
        </div>
        <div class="option" onclick="selectOption(10, 'D')">
          <span class="option-letter">D</span>
          <span>Ignore all alerts from this rule</span>
        </div>
      </div>

      <div class="explanation" id="exp10">
        <h4>‚úì Correct Answer: B</h4>
        <p><strong>Explanation:</strong> Effective rule tuning requires balance:</p>
        <p><strong>Strategies to reduce false positives:</strong></p>
        <ol>
          <li><strong>Add whitelists:</strong> Exclude known-good IPs, users, or systems
            <div class="code-block">
WHERE source_ip NOT IN trusted_ip_ranges
AND user NOT IN admin_team
            </div>
          </li>
          <li><strong>Increase thresholds:</strong> Require more evidence
            <div class="code-block">
COUNT(failed_login) >= 10  (was 5)
            </div>
          </li>
          <li><strong>Add more conditions (AND logic):</strong> Require multiple indicators
            <div class="code-block">
IF (
  failed_login > threshold AND
  source_ip NOT IN trusted_ips AND
  time NOT IN business_hours AND
  user_role = "privileged"
)
            </div>
          </li>
          <li><strong>Incorporate context:</strong> Add threat intel, GeoIP, asset criticality
            <div class="code-block">
AND source_ip_reputation = "malicious"
AND destination_asset_criticality = "high"
            </div>
          </li>
          <li><strong>Adjust time windows:</strong> Make more specific to attack pattern</li>
        </ol>
        <p><strong>Bad approaches to avoid:</strong></p>
        <ul>
          <li>‚ùå Disabling rules creates blind spots</li>
          <li>‚ùå Setting thresholds too high misses real attacks</li>
          <li>‚ùå Ignoring alerts defeats the purpose of monitoring</li>
        </ul>
        <p><strong>Best practice:</strong> Test tuning changes against historical data to ensure you still detect known attacks.</p>
      </div>

      <div class="controls">
        <button onclick="prevQuestion()">‚Üê Previous</button>
        <button class="primary" onclick="checkAnswer(10, 'B')">Check Answer</button>
        <button onclick="showResults()" id="next10" disabled>View Results ‚Üí</button>
      </div>
    </div>

    <!-- Results Screen -->
    <div class="results-screen" id="results">
      <h2 style="color: #c084fc; margin-bottom: 20px;">Quiz Complete!</h2>
      <div class="score-display" id="scoreDisplay">0%</div>

      <div class="score-breakdown">
        <div class="score-card">
          <div class="score-value" id="correctCount">0</div>
          <div class="score-label">Correct</div>
        </div>
        <div class="score-card">
          <div class="score-value" id="incorrectCount">0</div>
          <div class="score-label">Incorrect</div>
        </div>
        <div class="score-card">
          <div class="score-value" id="percentageScore">0%</div>
          <div class="score-label">Score</div>
        </div>
      </div>

      <div class="performance-message" id="performanceMsg"></div>

      <div class="review-list" id="reviewList"></div>

      <div class="controls" style="justify-content: center; margin-top: 30px;">
        <button class="primary" onclick="restartQuiz()">Retake Quiz</button>
        <button onclick="window.location.href='../presentations/log-correlation.html'">Review Material</button>
      </div>
    </div>
  </div>

  <script>
    const correctAnswers = {
      1: 'B', 2: 'B', 3: 'C', 4: 'B', 5: 'B',
      6: 'B', 7: 'B', 8: 'B', 9: 'B', 10: 'B'
    };

    let currentQuestion = 0;
    let userAnswers = {};
    let answeredQuestions = new Set();

    function startQuiz() {
      document.getElementById('quizInfo').style.display = 'none';
      currentQuestion = 1;
      showQuestion(1);
      updateProgress();
    }

    function showQuestion(num) {
      document.querySelectorAll('.question-card').forEach(q => q.classList.remove('active'));
      document.getElementById(`q${num}`).classList.add('active');
      currentQuestion = num;
      updateProgress();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function selectOption(questionNum, option) {
      if (answeredQuestions.has(questionNum)) return;

      const options = document.querySelectorAll(`#q${questionNum} .option`);
      options.forEach(opt => opt.classList.remove('selected'));

      event.currentTarget.classList.add('selected');
      userAnswers[questionNum] = option;
    }

    function checkAnswer(questionNum, correctAnswer) {
      if (answeredQuestions.has(questionNum)) return;

      const userAnswer = userAnswers[questionNum];
      if (!userAnswer) {
        alert('Please select an answer before checking.');
        return;
      }

      answeredQuestions.add(questionNum);

      const options = document.querySelectorAll(`#q${questionNum} .option`);
      options.forEach(opt => {
        const letter = opt.querySelector('.option-letter').textContent;
        if (letter === correctAnswer) {
          opt.classList.add('correct');
        } else if (letter === userAnswer && userAnswer !== correctAnswer) {
          opt.classList.add('incorrect');
        }
        opt.style.pointerEvents = 'none';
      });

      document.getElementById(`exp${questionNum}`).classList.add('show');
      document.getElementById(`next${questionNum}`).disabled = false;

      updateProgress();
    }

    function nextQuestion() {
      if (currentQuestion < 10) {
        showQuestion(currentQuestion + 1);
      }
    }

    function prevQuestion() {
      if (currentQuestion > 1) {
        showQuestion(currentQuestion - 1);
      }
    }

    function updateProgress() {
      const progressBar = document.getElementById('progressBar');
      progressBar.textContent = `Question ${currentQuestion} of 10`;
      const percentage = (answeredQuestions.size / 10) * 100;
      progressBar.style.width = percentage + '%';
    }

    function showResults() {
      let correct = 0;
      let incorrect = 0;

      for (let i = 1; i <= 10; i++) {
        if (userAnswers[i] === correctAnswers[i]) {
          correct++;
        } else {
          incorrect++;
        }
      }

      const percentage = Math.round((correct / 10) * 100);

      document.getElementById('correctCount').textContent = correct;
      document.getElementById('incorrectCount').textContent = incorrect;
      document.getElementById('scoreDisplay').textContent = percentage + '%';
      document.getElementById('percentageScore').textContent = percentage + '%';

      const performanceMsg = document.getElementById('performanceMsg');
      if (percentage >= 90) {
        performanceMsg.innerHTML = '<h3 style="color: #4ade80;">üéâ Excellent! Expert Level</h3><p>You have mastered log correlation concepts. Ready for advanced SOC analysis!</p>';
        performanceMsg.style.borderLeftColor = '#4ade80';
      } else if (percentage >= 70) {
        performanceMsg.innerHTML = '<h3 style="color: #06b6d4;">‚úì Good Job! Passing Score</h3><p>You understand the core concepts. Review missed questions to strengthen your knowledge.</p>';
        performanceMsg.style.borderLeftColor = '#06b6d4';
      } else {
        performanceMsg.innerHTML = '<h3 style="color: #f472b6;">üìö Keep Learning</h3><p>Review the presentation material and try again. Focus on correlation techniques and MITRE ATT&CK mapping.</p>';
        performanceMsg.style.borderLeftColor = '#f472b6';
      }

      const reviewList = document.getElementById('reviewList');
      reviewList.innerHTML = '<h3 style="color: #c084fc; margin-bottom: 15px;">Answer Review:</h3>';

      for (let i = 1; i <= 10; i++) {
        const isCorrect = userAnswers[i] === correctAnswers[i];
        const reviewItem = document.createElement('div');
        reviewItem.className = `review-item ${isCorrect ? 'correct' : 'incorrect'}`;
        reviewItem.innerHTML = `
          <strong>Question ${i}:</strong> ${isCorrect ? '‚úì Correct' : '‚úó Incorrect'}<br>
          Your answer: ${userAnswers[i] || 'Not answered'} | Correct answer: ${correctAnswers[i]}
        `;
        reviewList.appendChild(reviewItem);
      }

      document.querySelectorAll('.question-card').forEach(q => q.classList.remove('active'));
      document.getElementById('results').classList.add('show');

      if (typeof ModuleProgress !== 'undefined') {
        ModuleProgress.completeQuiz('eye', 'eye-log-correlation-quiz', percentage);
      }

      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function restartQuiz() {
      currentQuestion = 0;
      userAnswers = {};
      answeredQuestions = new Set();

      document.querySelectorAll('.option').forEach(opt => {
        opt.classList.remove('selected', 'correct', 'incorrect');
        opt.style.pointerEvents = 'auto';
      });

      document.querySelectorAll('.explanation').forEach(exp => exp.classList.remove('show'));

      document.querySelectorAll('[id^="next"]').forEach(btn => btn.disabled = true);

      document.getElementById('results').classList.remove('show');
      document.getElementById('quizInfo').style.display = 'block';

      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
  </script>
<script src="../../../components/FluxCapacitor.js"></script>
</body>
</html>