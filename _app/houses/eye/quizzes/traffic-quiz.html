<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Network Traffic Analysis Quiz - Eye House | Hexworth Prime</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #0f0a1e 0%, #1a0b2e 100%);
      color: #e0e0e0;
      line-height: 1.6;
      padding: 20px;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
    }

    header {
      background: linear-gradient(135deg, #c084fc 0%, #06b6d4 100%);
      padding: 30px;
      text-align: center;
      border-radius: 10px;
      box-shadow: 0 4px 20px rgba(192, 132, 252, 0.3);
      margin-bottom: 30px;
    }

    h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
      color: white;
    }

    .subtitle {
      font-size: 1.2em;
      color: #f0f0f0;
    }

    .info-box {
      background: rgba(6, 182, 212, 0.1);
      border: 2px solid #06b6d4;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 30px;
    }

    .info-box h3 {
      color: #06b6d4;
      margin-bottom: 10px;
    }

    .progress-section {
      background: rgba(255, 255, 255, 0.05);
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 30px;
      border: 2px solid rgba(192, 132, 252, 0.3);
    }

    .progress-text {
      text-align: center;
      color: #c084fc;
      font-size: 1.2em;
      font-weight: 600;
    }

    .question-card {
      background: rgba(255, 255, 255, 0.05);
      border: 2px solid rgba(192, 132, 252, 0.3);
      border-radius: 10px;
      padding: 30px;
      margin-bottom: 25px;
      transition: all 0.3s ease;
    }

    .question-card.answered-correct {
      border-color: #00ff7f;
      background: rgba(0, 255, 127, 0.05);
    }

    .question-card.answered-incorrect {
      border-color: #ff4444;
      background: rgba(255, 68, 68, 0.05);
    }

    .question-number {
      color: #c084fc;
      font-size: 1.1em;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .question-text {
      font-size: 1.3em;
      color: #e0e0e0;
      margin-bottom: 20px;
      line-height: 1.5;
    }

    .code-snippet {
      background: rgba(0, 0, 0, 0.6);
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
      font-family: 'Courier New', monospace;
      border-left: 4px solid #06b6d4;
      overflow-x: auto;
      color: #06b6d4;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .option {
      background: rgba(0, 0, 0, 0.4);
      border: 2px solid rgba(192, 132, 252, 0.3);
      border-radius: 8px;
      padding: 15px 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .option:hover {
      border-color: #c084fc;
      background: rgba(192, 132, 252, 0.1);
      transform: translateX(5px);
    }

    .option.selected {
      border-color: #06b6d4;
      background: rgba(6, 182, 212, 0.2);
    }

    .option.correct {
      border-color: #00ff7f;
      background: rgba(0, 255, 127, 0.2);
    }

    .option.incorrect {
      border-color: #ff4444;
      background: rgba(255, 68, 68, 0.2);
    }

    .option-letter {
      background: linear-gradient(135deg, #c084fc 0%, #06b6d4 100%);
      color: white;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      flex-shrink: 0;
    }

    .option.correct .option-letter {
      background: #00ff7f;
      color: #0f0a1e;
    }

    .option.incorrect .option-letter {
      background: #ff4444;
      color: white;
    }

    .explanation {
      background: rgba(192, 132, 252, 0.1);
      border-left: 4px solid #c084fc;
      border-radius: 8px;
      padding: 20px;
      margin-top: 20px;
      display: none;
    }

    .explanation.visible {
      display: block;
    }

    .explanation h4 {
      color: #c084fc;
      margin-bottom: 10px;
      font-size: 1.2em;
    }

    .explanation ul {
      margin: 10px 0 10px 20px;
    }

    .explanation li {
      margin: 8px 0;
    }

    button {
      background: linear-gradient(135deg, #c084fc 0%, #06b6d4 100%);
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1em;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(192, 132, 252, 0.3);
      margin-top: 15px;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(192, 132, 252, 0.5);
    }

    button:disabled {
      background: rgba(128, 128, 128, 0.3);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .submit-btn {
      background: linear-gradient(135deg, #00ff7f 0%, #00cc66 100%);
      font-size: 1.2em;
      padding: 15px 40px;
      display: block;
      margin: 30px auto;
    }

    .results-panel {
      background: rgba(255, 255, 255, 0.05);
      border: 2px solid rgba(192, 132, 252, 0.3);
      border-radius: 10px;
      padding: 40px;
      margin: 30px 0;
      text-align: center;
      display: none;
    }

    .results-panel.visible {
      display: block;
    }

    .score-display {
      font-size: 4em;
      font-weight: bold;
      background: linear-gradient(135deg, #c084fc 0%, #06b6d4 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin: 20px 0;
    }

    .score-message {
      font-size: 1.5em;
      margin: 20px 0;
    }

    .pass {
      color: #00ff7f;
    }

    .fail {
      color: #ff4444;
    }

    .score-breakdown {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin: 30px 0;
    }

    .stat-box {
      background: rgba(0, 0, 0, 0.4);
      padding: 20px;
      border-radius: 8px;
      border: 2px solid #c084fc;
    }

    .stat-value {
      font-size: 2.5em;
      color: #c084fc;
      font-weight: bold;
    }

    .stat-label {
      color: #888;
      margin-top: 5px;
    }

    @media (max-width: 768px) {
      h1 {
        font-size: 2em;
      }

      .question-text {
        font-size: 1.1em;
      }

      .score-display {
        font-size: 3em;
      }
    }

    ::-webkit-scrollbar {
      width: 10px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.3);
      border-radius: 5px;
    }

    ::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, #c084fc 0%, #06b6d4 100%);
      border-radius: 5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Network Traffic Analysis Quiz</h1>
      <div class="subtitle">Test Your Packet Analysis Knowledge</div>
    </header>

    <div class="info-box">
      <h3>Quiz Instructions</h3>
      <p>
        This quiz covers network traffic analysis concepts including Wireshark filtering, protocol analysis, threat detection, and forensic investigation. You need <strong>70% (7/10)</strong> to pass.
      </p>
      <p style="margin-top: 10px;">
        Select the best answer for each question. Detailed explanations will be provided after submission.
      </p>
    </div>

    <div class="progress-section">
      <div class="progress-text" id="progressText">Questions Answered: 0 / 10</div>
    </div>

    <!-- Question 1 -->
    <div class="question-card" id="q1">
      <div class="question-number">Question 1</div>
      <div class="question-text">
        Which Wireshark display filter would show only HTTP POST requests containing the string "password"?
      </div>
      <div class="code-snippet">
Select the correct filter syntax:
      </div>
      <div class="options">
        <div class="option" onclick="selectAnswer(1, 'A')">
          <div class="option-letter">A</div>
          <div>http.request.method == POST && http contains "password"</div>
        </div>
        <div class="option" onclick="selectAnswer(1, 'B')">
          <div class="option-letter">B</div>
          <div>http.method == "POST" and contains "password"</div>
        </div>
        <div class="option" onclick="selectAnswer(1, 'C')">
          <div class="option-letter">C</div>
          <div>tcp.port == 80 && data contains "password"</div>
        </div>
        <div class="option" onclick="selectAnswer(1, 'D')">
          <div class="option-letter">D</div>
          <div>http.post && string == "password"</div>
        </div>
      </div>
      <div class="explanation" id="exp1">
        <h4>Explanation</h4>
        <p><strong>Correct Answer: A</strong></p>
        <p>
          The proper Wireshark filter syntax is: <code>http.request.method == POST && http contains "password"</code>
        </p>
        <ul>
          <li><code>http.request.method == POST</code> filters for POST requests (note: no quotes around POST)</li>
          <li><code>http contains "password"</code> searches the HTTP payload for the string</li>
          <li><code>&&</code> is the logical AND operator in Wireshark display filters</li>
        </ul>
        <p><strong>Why others are wrong:</strong></p>
        <ul>
          <li><strong>B:</strong> Incorrect syntax - uses "and" instead of "&&" and wrong contains syntax</li>
          <li><strong>C:</strong> Too broad - captures all port 80 traffic, not specifically HTTP POST</li>
          <li><strong>D:</strong> Invalid syntax - "http.post" and "string ==" don't exist</li>
        </ul>
      </div>
    </div>

    <!-- Question 2 -->
    <div class="question-card" id="q2">
      <div class="question-number">Question 2</div>
      <div class="question-text">
        You observe the following TCP flags in sequential packets from the same source: SYN, SYN, SYN, SYN to different destination ports. What type of scan is this?
      </div>
      <div class="options">
        <div class="option" onclick="selectAnswer(2, 'A')">
          <div class="option-letter">A</div>
          <div>TCP Connect scan (full three-way handshake)</div>
        </div>
        <div class="option" onclick="selectAnswer(2, 'B')">
          <div class="option-letter">B</div>
          <div>TCP SYN scan (half-open scan)</div>
        </div>
        <div class="option" onclick="selectAnswer(2, 'C')">
          <div class="option-letter">C</div>
          <div>TCP FIN scan (stealth scan)</div>
        </div>
        <div class="option" onclick="selectAnswer(2, 'D')">
          <div class="option-letter">D</div>
          <div>TCP NULL scan (no flags set)</div>
        </div>
      </div>
      <div class="explanation" id="exp2">
        <h4>Explanation</h4>
        <p><strong>Correct Answer: B</strong></p>
        <p>
          Multiple SYN packets to different ports indicates a <strong>TCP SYN scan (half-open scan)</strong>.
        </p>
        <ul>
          <li>SYN scans send only SYN packets to probe ports</li>
          <li>If port is open: target responds with SYN-ACK, scanner sends RST (doesn't complete handshake)</li>
          <li>If port is closed: target responds with RST</li>
          <li>This is the most common scanning technique (default in Nmap)</li>
        </ul>
        <p><strong>Why others are wrong:</strong></p>
        <ul>
          <li><strong>A:</strong> Connect scan would show SYN → SYN-ACK → ACK (complete handshake)</li>
          <li><strong>C:</strong> FIN scan sends FIN flag, not SYN</li>
          <li><strong>D:</strong> NULL scan has no flags set at all</li>
        </ul>
      </div>
    </div>

    <!-- Question 3 -->
    <div class="question-card" id="q3">
      <div class="question-number">Question 3</div>
      <div class="question-text">
        A DNS query for "aG93ZHlwYXJ0bmVy.c2VjcmV0ZGF0YQ.exfil.evil.com" is detected. What attack technique does this likely represent?
      </div>
      <div class="options">
        <div class="option" onclick="selectAnswer(3, 'A')">
          <div class="option-letter">A</div>
          <div>DNS cache poisoning</div>
        </div>
        <div class="option" onclick="selectAnswer(3, 'B')">
          <div class="option-letter">B</div>
          <div>DNS amplification DDoS</div>
        </div>
        <div class="option" onclick="selectAnswer(3, 'C')">
          <div class="option-letter">C</div>
          <div>DNS tunneling / data exfiltration</div>
        </div>
        <div class="option" onclick="selectAnswer(3, 'D')">
          <div class="option-letter">D</div>
          <div>DNS hijacking</div>
        </div>
      </div>
      <div class="explanation" id="exp3">
        <h4>Explanation</h4>
        <p><strong>Correct Answer: C</strong></p>
        <p>
          This is <strong>DNS tunneling</strong> - using DNS queries to exfiltrate data.
        </p>
        <ul>
          <li>The subdomain contains base64-encoded data (aG93ZHlwYXJ0bmVy = "howdypartner" decoded)</li>
          <li>Attackers encode data in subdomain labels to bypass firewalls</li>
          <li>Long, random-looking subdomains are a key indicator</li>
          <li>DNS is often allowed outbound, making it attractive for exfiltration</li>
        </ul>
        <p><strong>Detection indicators:</strong></p>
        <ul>
          <li>Query length > 50 characters</li>
          <li>High entropy/randomness in subdomains</li>
          <li>Unusual DNS record types (TXT, NULL)</li>
          <li>High volume of queries to same base domain</li>
        </ul>
      </div>
    </div>

    <!-- Question 4 -->
    <div class="question-card" id="q4">
      <div class="question-number">Question 4</div>
      <div class="question-text">
        What is the primary advantage of NetFlow over full packet capture (PCAP) for long-term network monitoring?
      </div>
      <div class="options">
        <div class="option" onclick="selectAnswer(4, 'A')">
          <div class="option-letter">A</div>
          <div>NetFlow provides complete payload inspection</div>
        </div>
        <div class="option" onclick="selectAnswer(4, 'B')">
          <div class="option-letter">B</div>
          <div>NetFlow is significantly smaller (1-2% of PCAP size), enabling longer retention</div>
        </div>
        <div class="option" onclick="selectAnswer(4, 'C')">
          <div class="option-letter">C</div>
          <div>NetFlow can decrypt TLS traffic</div>
        </div>
        <div class="option" onclick="selectAnswer(4, 'D')">
          <div class="option-letter">D</div>
          <div>NetFlow captures more detailed protocol information than PCAP</div>
        </div>
      </div>
      <div class="explanation" id="exp4">
        <h4>Explanation</h4>
        <p><strong>Correct Answer: B</strong></p>
        <p>
          NetFlow's primary advantage is <strong>storage efficiency</strong> - it's only 1-2% the size of full packet capture.
        </p>
        <ul>
          <li><strong>NetFlow:</strong> Captures metadata (IPs, ports, byte/packet counts, timestamps)</li>
          <li><strong>PCAP:</strong> Captures everything (headers + payloads)</li>
          <li>1 Gbps link = ~450 GB/hour of PCAP vs ~4.5 GB/hour of NetFlow</li>
          <li>Enables 30-90 day retention vs 7-14 days for PCAP</li>
        </ul>
        <p><strong>Tradeoff:</strong> NetFlow lacks payload data, so you can't extract files or see application-layer details. Modern SOCs use both: NetFlow for long-term visibility, PCAP for deep investigation.</p>
      </div>
    </div>

    <!-- Question 5 -->
    <div class="question-card" id="q5">
      <div class="question-number">Question 5</div>
      <div class="question-text">
        You observe connections from 192.168.1.50 to the following IPs on port 445 within 30 seconds: .51, .52, .53, .54, .55 (all in sequential order). What threat activity does this indicate?
      </div>
      <div class="options">
        <div class="option" onclick="selectAnswer(5, 'A')">
          <div class="option-letter">A</div>
          <div>Normal file sharing activity</div>
        </div>
        <div class="option" onclick="selectAnswer(5, 'B')">
          <div class="option-letter">B</div>
          <div>SMB lateral movement / worm propagation</div>
        </div>
        <div class="option" onclick="selectAnswer(5, 'C')">
          <div class="option-letter">C</div>
          <div>DNS resolution</div>
        </div>
        <div class="option" onclick="selectAnswer(5, 'D')">
          <div class="option-letter">D</div>
          <div>DHCP address assignment</div>
        </div>
      </div>
      <div class="explanation" id="exp5">
        <h4>Explanation</h4>
        <p><strong>Correct Answer: B</strong></p>
        <p>
          This pattern indicates <strong>SMB lateral movement</strong> or worm propagation.
        </p>
        <ul>
          <li><strong>Port 445:</strong> SMB (Server Message Block) - Windows file sharing protocol</li>
          <li><strong>Sequential IPs:</strong> Scanning/connecting to multiple hosts in order</li>
          <li><strong>Rapid timing:</strong> 5 hosts in 30 seconds is automated, not manual</li>
        </ul>
        <p><strong>Attack context:</strong></p>
        <ul>
          <li>Attacker compromises 192.168.1.50</li>
          <li>Uses stolen credentials or exploits (EternalBlue, etc.) to spread</li>
          <li>Connects to admin shares (C$, ADMIN$, IPC$) on other systems</li>
          <li>Drops malware and executes it (PsExec, WMI, remote services)</li>
        </ul>
        <p>This is how ransomware like WannaCry and NotPetya spread across networks.</p>
      </div>
    </div>

    <!-- Question 6 -->
    <div class="question-card" id="q6">
      <div class="question-number">Question 6</div>
      <div class="question-text">
        What is a JA3 fingerprint used for in network traffic analysis?
      </div>
      <div class="options">
        <div class="option" onclick="selectAnswer(6, 'A')">
          <div class="option-letter">A</div>
          <div>Identifying users based on their browsing patterns</div>
        </div>
        <div class="option" onclick="selectAnswer(6, 'B')">
          <div class="option-letter">B</div>
          <div>Fingerprinting TLS clients to identify applications/malware despite encryption</div>
        </div>
        <div class="option" onclick="selectAnswer(6, 'C')">
          <div class="option-letter">C</div>
          <div>Decrypting HTTPS traffic</div>
        </div>
        <div class="option" onclick="selectAnswer(6, 'D')">
          <div class="option-letter">D</div>
          <div>Measuring network latency</div>
        </div>
      </div>
      <div class="explanation" id="exp6">
        <h4>Explanation</h4>
        <p><strong>Correct Answer: B</strong></p>
        <p>
          JA3 creates a <strong>fingerprint of TLS/SSL client behavior</strong> to identify applications even when traffic is encrypted.
        </p>
        <ul>
          <li><strong>How it works:</strong> Hashes TLS client hello parameters (version, ciphers, extensions, curves)</li>
          <li><strong>Result:</strong> Unique MD5 hash identifies the client application</li>
          <li>Different apps (Chrome, malware, Metasploit) have different TLS fingerprints</li>
          <li>Visible in cleartext during TLS handshake (before encryption)</li>
        </ul>
        <p><strong>Security uses:</strong></p>
        <ul>
          <li>Detect known malware families by their JA3 signatures</li>
          <li>Identify unauthorized applications (Tor, proxies, hacking tools)</li>
          <li>Hunt for anomalous TLS clients in your environment</li>
        </ul>
        <p><strong>JA3S</strong> is the server-side equivalent, fingerprinting TLS servers.</p>
      </div>
    </div>

    <!-- Question 7 -->
    <div class="question-card" id="q7">
      <div class="question-number">Question 7</div>
      <div class="question-text">
        A workstation generates HTTP requests with the User-Agent "python-requests/2.28.0" to multiple external IPs. What does this likely indicate?
      </div>
      <div class="options">
        <div class="option" onclick="selectAnswer(7, 'A')">
          <div class="option-letter">A</div>
          <div>Normal web browsing activity</div>
        </div>
        <div class="option" onclick="selectAnswer(7, 'B')">
          <div class="option-letter">B</div>
          <div>Automated script/malware activity (Python-based tool or C2)</div>
        </div>
        <div class="option" onclick="selectAnswer(7, 'C')">
          <div class="option-letter">C</div>
          <div>Mobile device synchronization</div>
        </div>
        <div class="option" onclick="selectAnswer(7, 'D')">
          <div class="option-letter">D</div>
          <div>Printer configuration</div>
        </div>
      </div>
      <div class="explanation" id="exp7">
        <h4>Explanation</h4>
        <p><strong>Correct Answer: B</strong></p>
        <p>
          The "python-requests/2.28.0" User-Agent indicates <strong>automated Python script activity</strong>, likely malicious.
        </p>
        <ul>
          <li><strong>python-requests:</strong> Python HTTP library used by scripts, not browsers</li>
          <li>Normal users browse with Chrome, Firefox, Edge, Safari user-agents</li>
          <li>Workstations shouldn't run automated Python scripts unless it's a developer machine</li>
        </ul>
        <p><strong>Possible scenarios:</strong></p>
        <ul>
          <li>Malware beacon using Python requests library</li>
          <li>Data exfiltration script</li>
          <li>Reconnaissance/scanning tool</li>
          <li>Compromised system running attacker's Python payload</li>
        </ul>
        <p><strong>Investigation steps:</strong> Check process list, identify Python execution, review script source, correlate with endpoint logs.</p>
      </div>
    </div>

    <!-- Question 8 -->
    <div class="question-card" id="q8">
      <div class="question-number">Question 8</div>
      <div class="question-text">
        In Wireshark, you want to follow a TCP stream to reconstruct an HTTP conversation. What is the correct method?
      </div>
      <div class="options">
        <div class="option" onclick="selectAnswer(8, 'A')">
          <div class="option-letter">A</div>
          <div>Statistics → Protocol Hierarchy</div>
        </div>
        <div class="option" onclick="selectAnswer(8, 'B')">
          <div class="option-letter">B</div>
          <div>Right-click packet → Follow → TCP Stream</div>
        </div>
        <div class="option" onclick="selectAnswer(8, 'C')">
          <div class="option-letter">C</div>
          <div>File → Export Objects → HTTP</div>
        </div>
        <div class="option" onclick="selectAnswer(8, 'D')">
          <div class="option-letter">D</div>
          <div>Edit → Find Packet</div>
        </div>
      </div>
      <div class="explanation" id="exp8">
        <h4>Explanation</h4>
        <p><strong>Correct Answer: B</strong></p>
        <p>
          To reconstruct a TCP conversation: <strong>Right-click any packet in the stream → Follow → TCP Stream</strong>
        </p>
        <ul>
          <li>Wireshark reassembles all packets in that TCP conversation</li>
          <li>Shows client and server data in a readable format</li>
          <li>Color-codes client (red) vs server (blue) data</li>
          <li>Essential for reading cleartext protocols (HTTP, FTP, Telnet, SMTP)</li>
        </ul>
        <p><strong>Other "Follow" options:</strong></p>
        <ul>
          <li>Follow → UDP Stream (for UDP protocols like DNS data transfers)</li>
          <li>Follow → TLS Stream (shows encrypted TLS data)</li>
          <li>Follow → HTTP Stream (specifically for HTTP)</li>
        </ul>
        <p><strong>Why others are wrong:</strong> A shows protocol stats, C exports files, D finds specific packets by criteria.</p>
      </div>
    </div>

    <!-- Question 9 -->
    <div class="question-card" id="q9">
      <div class="question-number">Question 9</div>
      <div class="question-text">
        You detect regular traffic from 10.0.5.25 to 198.51.100.77:8443 every 60 seconds with consistent 128-byte payload sizes. What type of malicious activity does this pattern suggest?
      </div>
      <div class="options">
        <div class="option" onclick="selectAnswer(9, 'A')">
          <div class="option-letter">A</div>
          <div>DDoS attack</div>
        </div>
        <div class="option" onclick="selectAnswer(9, 'B')">
          <div class="option-letter">B</div>
          <div>C2 beaconing</div>
        </div>
        <div class="option" onclick="selectAnswer(9, 'C')">
          <div class="option-letter">C</div>
          <div>SQL injection</div>
        </div>
        <div class="option" onclick="selectAnswer(9, 'D')">
          <div class="option-letter">D</div>
          <div>ARP spoofing</div>
        </div>
      </div>
      <div class="explanation" id="exp9">
        <h4>Explanation</h4>
        <p><strong>Correct Answer: B</strong></p>
        <p>
          Regular intervals + consistent payload size = classic <strong>C2 beaconing</strong> pattern.
        </p>
        <ul>
          <li><strong>Beaconing:</strong> Malware checks in with command server at regular intervals</li>
          <li><strong>60-second interval:</strong> Extremely consistent timing (not human behavior)</li>
          <li><strong>128 bytes:</strong> Fixed size suggests automated heartbeat/status update</li>
          <li><strong>Port 8443:</strong> Non-standard HTTPS port (often used by malware to evade detection)</li>
        </ul>
        <p><strong>Detection technique:</strong></p>
        <ul>
          <li>Plot connection times on timeline - beacons show regular spikes</li>
          <li>Calculate connection intervals - beacons have low variance</li>
          <li>Tools: Rita, Freq.py, Wireshark I/O graphs</li>
        </ul>
        <p><strong>Response:</strong> Isolate 10.0.5.25, block 198.51.100.77, investigate for malware.</p>
      </div>
    </div>

    <!-- Question 10 -->
    <div class="question-card" id="q10">
      <div class="question-number">Question 10</div>
      <div class="question-text">
        Which of the following is the MOST reliable Indicator of Compromise (IOC) for long-term threat detection?
      </div>
      <div class="options">
        <div class="option" onclick="selectAnswer(10, 'A')">
          <div class="option-letter">A</div>
          <div>IP address (e.g., 203.0.113.45)</div>
        </div>
        <div class="option" onclick="selectAnswer(10, 'B')">
          <div class="option-letter">B</div>
          <div>File hash (e.g., MD5: d41d8cd98f00b204e9800998ecf8427e)</div>
        </div>
        <div class="option" onclick="selectAnswer(10, 'C')">
          <div class="option-letter">C</div>
          <div>Network behavioral pattern (e.g., beaconing every 60 seconds)</div>
        </div>
        <div class="option" onclick="selectAnswer(10, 'D')">
          <div class="option-letter">D</div>
          <div>Domain name (e.g., malware.evil.com)</div>
        </div>
      </div>
      <div class="explanation" id="exp10">
        <h4>Explanation</h4>
        <p><strong>Correct Answer: C</strong></p>
        <p>
          <strong>Behavioral patterns</strong> are the most reliable long-term IOCs because they're hardest for attackers to change.
        </p>
        <p><strong>IOC Pyramid (from least to most reliable):</strong></p>
        <ul>
          <li><strong>IP addresses (worst):</strong> Attackers change IPs instantly via proxies, VPNs, cloud services</li>
          <li><strong>Domain names:</strong> Easily rotated via DGA, domain fronting, fast flux</li>
          <li><strong>File hashes:</strong> Single byte change = new hash (polymorphic malware)</li>
          <li><strong>Behavioral patterns (best):</strong> Beaconing intervals, protocol abuse, lateral movement techniques are inherent to how malware operates</li>
        </ul>
        <p><strong>Example:</strong> Blocking IP 1.2.3.4 fails when attacker switches to 5.6.7.8. Detecting "regular 60-second beacons" catches the malware regardless of IP changes.</p>
        <p><strong>Best practice:</strong> Use multiple IOC types in layers, with emphasis on behavioral analytics and TTPs (Tactics, Techniques, Procedures).</p>
      </div>
    </div>

    <button class="submit-btn" id="submitBtn" onclick="submitQuiz()">Submit Quiz</button>

    <div class="results-panel" id="resultsPanel">
      <h2>Quiz Results</h2>
      <div class="score-display" id="scoreDisplay">0%</div>
      <div class="score-message" id="scoreMessage"></div>

      <div class="score-breakdown">
        <div class="stat-box">
          <div class="stat-value" id="correctCount">0</div>
          <div class="stat-label">Correct Answers</div>
        </div>
        <div class="stat-box">
          <div class="stat-value" id="incorrectCount">0</div>
          <div class="stat-label">Incorrect Answers</div>
        </div>
        <div class="stat-box">
          <div class="stat-value" id="percentageScore">0%</div>
          <div class="stat-label">Final Score</div>
        </div>
      </div>

      <button onclick="reviewAnswers()" style="margin: 10px;">Review Answers</button>
      <button onclick="location.reload()" style="margin: 10px;">Retake Quiz</button>
    </div>
  </div>

  <script>
    const totalQuestions = 10;
    let answers = {};
    let submitted = false;

    // Correct answers
    const correctAnswers = {
      1: 'A',
      2: 'B',
      3: 'C',
      4: 'B',
      5: 'B',
      6: 'B',
      7: 'B',
      8: 'B',
      9: 'B',
      10: 'C'
    };

    function selectAnswer(questionNum, option) {
      if (submitted) return;

      // Store answer
      answers[questionNum] = option;

      // Update UI - remove previous selection
      const questionCard = document.getElementById(`q${questionNum}`);
      questionCard.querySelectorAll('.option').forEach(opt => {
        opt.classList.remove('selected');
      });

      // Add selection to clicked option
      event.currentTarget.classList.add('selected');

      // Update progress
      updateProgress();
    }

    function updateProgress() {
      const answeredCount = Object.keys(answers).length;
      document.getElementById('progressText').textContent = `Questions Answered: ${answeredCount} / ${totalQuestions}`;
    }

    function submitQuiz() {
      if (Object.keys(answers).length < totalQuestions) {
        alert(`Please answer all questions before submitting. You have answered ${Object.keys(answers).length} out of ${totalQuestions}.`);
        return;
      }

      submitted = true;

      // Calculate score
      let correctCount = 0;
      for (let q = 1; q <= totalQuestions; q++) {
        if (answers[q] === correctAnswers[q]) {
          correctCount++;
        }
      }

      const percentage = Math.round((correctCount / totalQuestions) * 100);
      const passed = percentage >= 70;

      // Mark answers
      for (let q = 1; q <= totalQuestions; q++) {
        const questionCard = document.getElementById(`q${q}`);
        const userAnswer = answers[q];
        const correct = correctAnswers[q];

        // Mark all options
        questionCard.querySelectorAll('.option').forEach(option => {
          const letter = option.querySelector('.option-letter').textContent;

          if (letter === correct) {
            option.classList.add('correct');
          }

          if (letter === userAnswer && letter !== correct) {
            option.classList.add('incorrect');
          }
        });

        // Update question card color
        if (userAnswer === correct) {
          questionCard.classList.add('answered-correct');
        } else {
          questionCard.classList.add('answered-incorrect');
        }

        // Show explanation
        document.getElementById(`exp${q}`).classList.add('visible');
      }

      // Display results
      document.getElementById('scoreDisplay').textContent = percentage + '%';
      document.getElementById('correctCount').textContent = correctCount;
      document.getElementById('incorrectCount').textContent = totalQuestions - correctCount;
      document.getElementById('percentageScore').textContent = percentage + '%';

      const messageEl = document.getElementById('scoreMessage');
      if (passed) {
        messageEl.innerHTML = `<span class="pass">✓ Congratulations! You passed!</span>`;
        messageEl.innerHTML += `<br><p style="margin-top: 10px;">You've demonstrated strong understanding of network traffic analysis concepts. You're ready for SOC analyst work!</p>`;

        // Complete quiz via AchievementManager if available
        if (typeof ModuleProgress !== 'undefined') {
          ModuleProgress.completeQuiz('eye', 'eye-network-traffic-quiz', percentage);
        }
      } else {
        messageEl.innerHTML = `<span class="fail">✗ Not quite there yet</span>`;
        messageEl.innerHTML += `<br><p style="margin-top: 10px;">Review the explanations below and try again. You need 70% to pass.</p>`;
      }

      document.getElementById('resultsPanel').classList.add('visible');
      document.getElementById('submitBtn').style.display = 'none';

      // Scroll to results
      document.getElementById('resultsPanel').scrollIntoView({ behavior: 'smooth' });
    }

    function reviewAnswers() {
      // Scroll to first question
      document.getElementById('q1').scrollIntoView({ behavior: 'smooth' });
    }
  </script>
</body>
</html>