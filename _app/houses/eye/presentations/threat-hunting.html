<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Threat Hunting - Eye House</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a0b2e 100%);
            color: #e0e0e0;
            overflow-x: hidden;
        }

        .presentation-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, #c084fc 0%, #06b6d4 100%);
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(192, 132, 252, 0.3);
        }

        header h1 {
            font-size: 3em;
            color: #0f0f23;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.3em;
            color: #1a0b2e;
            font-weight: 500;
        }

        .slide {
            background: rgba(30, 30, 60, 0.6);
            border: 2px solid #c084fc;
            border-radius: 15px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .slide h2 {
            color: #c084fc;
            font-size: 2.2em;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #06b6d4;
        }

        .slide h3 {
            color: #06b6d4;
            font-size: 1.6em;
            margin: 25px 0 15px 0;
        }

        .slide h4 {
            color: #a78bfa;
            font-size: 1.3em;
            margin: 20px 0 10px 0;
        }

        .slide p {
            line-height: 1.8;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .slide ul, .slide ol {
            margin-left: 30px;
            margin-bottom: 20px;
        }

        .slide li {
            margin-bottom: 12px;
            line-height: 1.7;
            font-size: 1.05em;
        }

        .highlight {
            background: linear-gradient(90deg, rgba(192, 132, 252, 0.3), rgba(6, 182, 212, 0.3));
            padding: 20px;
            border-left: 5px solid #c084fc;
            border-radius: 8px;
            margin: 20px 0;
        }

        .code-block {
            background: #1a1a2e;
            border: 1px solid #c084fc;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            color: #06b6d4;
            font-size: 0.95em;
            line-height: 1.6;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 25px 0;
        }

        .comparison-card {
            background: rgba(26, 26, 46, 0.8);
            border: 2px solid #c084fc;
            border-radius: 10px;
            padding: 25px;
        }

        .comparison-card h4 {
            color: #06b6d4;
            margin-bottom: 15px;
            font-size: 1.4em;
            text-align: center;
        }

        .comparison-card ul {
            margin-left: 20px;
        }

        .hunting-loop {
            background: #1a1a2e;
            border: 2px solid #c084fc;
            border-radius: 10px;
            padding: 30px;
            margin: 25px 0;
            text-align: center;
        }

        .loop-step {
            display: inline-block;
            background: linear-gradient(135deg, #c084fc 0%, #a78bfa 100%);
            color: #0f0f23;
            padding: 15px 25px;
            border-radius: 10px;
            font-weight: bold;
            margin: 10px;
            min-width: 150px;
            position: relative;
        }

        .loop-arrow {
            display: inline-block;
            color: #06b6d4;
            font-size: 1.5em;
            margin: 0 10px;
        }

        .technique-box {
            background: rgba(6, 182, 212, 0.1);
            border: 2px solid #06b6d4;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .technique-box h4 {
            color: #06b6d4;
            margin-bottom: 10px;
        }

        .attack-matrix {
            background: #1a1a2e;
            border: 2px solid #c084fc;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
        }

        .tactic-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .tactic-card {
            background: linear-gradient(135deg, rgba(192, 132, 252, 0.2), rgba(167, 139, 250, 0.2));
            border: 1px solid #a78bfa;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .tactic-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(192, 132, 252, 0.4);
        }

        .tactic-card h5 {
            color: #c084fc;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .tactic-card p {
            font-size: 0.9em;
            color: #d0d0d0;
        }

        .tool-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .tool-card {
            background: rgba(26, 26, 46, 0.8);
            border: 2px solid #06b6d4;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .tool-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(6, 182, 212, 0.4);
        }

        .tool-card h4 {
            color: #06b6d4;
            margin-bottom: 15px;
        }

        .warning-box {
            background: rgba(239, 68, 68, 0.1);
            border-left: 5px solid #ef4444;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .warning-box strong {
            color: #ef4444;
            display: block;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .success-box {
            background: rgba(34, 197, 94, 0.1);
            border-left: 5px solid #22c55e;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .success-box strong {
            color: #22c55e;
            display: block;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .info-box {
            background: rgba(6, 182, 212, 0.1);
            border-left: 5px solid #06b6d4;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .info-box strong {
            color: #06b6d4;
            display: block;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .complete-button {
            display: block;
            width: 100%;
            max-width: 400px;
            margin: 40px auto;
            padding: 20px 40px;
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(34, 197, 94, 0.3);
        }

        .complete-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(34, 197, 94, 0.5);
        }

        .complete-button:active {
            transform: translateY(-1px);
        }

        .back-link {
            display: inline-block;
            margin: 20px 0;
            padding: 12px 30px;
            background: rgba(192, 132, 252, 0.2);
            border: 2px solid #c084fc;
            border-radius: 8px;
            color: #c084fc;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .back-link:hover {
            background: rgba(192, 132, 252, 0.3);
            transform: translateX(-5px);
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 2em;
            }

            .slide {
                padding: 25px;
            }

            .comparison-grid {
                grid-template-columns: 1fr;
            }

            .loop-step {
                display: block;
                margin: 10px auto;
            }

            .loop-arrow {
                display: block;
                transform: rotate(90deg);
            }
        }
    </style>
</head>
<body>
    <div class="presentation-container">
        <a href="../index.html" class="back-link">← Back to Eye House</a>

        <header>
            <h1>Threat Hunting</h1>
            <p>Proactive Security: Finding Threats Before They Find You</p>
        </header>

        <!-- Slide 1: Introduction -->
        <div class="slide">
            <h2>What is Threat Hunting?</h2>
            <p>Threat hunting is the <strong>proactive</strong> process of searching through networks, endpoints, and datasets to detect and isolate advanced threats that evade existing automated security solutions.</p>

            <div class="highlight">
                <strong>Key Concept:</strong> Threat hunting assumes that adversaries are already inside your network. Instead of waiting for alerts, hunters actively search for signs of compromise.
            </div>

            <h3>Proactive vs. Reactive Security</h3>

            <div class="comparison-grid">
                <div class="comparison-card">
                    <h4>Reactive Security (Traditional)</h4>
                    <ul>
                        <li>Wait for alerts from SIEM/IDS</li>
                        <li>Respond to triggered rules</li>
                        <li>Known signatures and patterns</li>
                        <li>Automated detection systems</li>
                        <li>Incident response after detection</li>
                    </ul>
                </div>

                <div class="comparison-card">
                    <h4>Proactive Security (Hunting)</h4>
                    <ul>
                        <li>Actively search for threats</li>
                        <li>Hypothesis-driven investigation</li>
                        <li>Unknown and emerging threats</li>
                        <li>Human-driven analysis</li>
                        <li>Find threats before major damage</li>
                    </ul>
                </div>
            </div>

            <div class="info-box">
                <strong>Why Hunt?</strong>
                <p>The average time to detect a breach is <strong>207 days</strong> (IBM 2023). Automated systems miss sophisticated attacks. Threat hunting reduces dwell time and finds what automation misses.</p>
            </div>
        </div>

        <!-- Slide 2: Hunt vs Detect -->
        <div class="slide">
            <h2>Hunt vs. Detect: The Mindset Shift</h2>

            <p>Detection and hunting serve different but complementary purposes in a security program.</p>

            <h3>Detection (Automated Defense)</h3>
            <ul>
                <li><strong>Purpose:</strong> Scale security monitoring across entire environment</li>
                <li><strong>Approach:</strong> Rule-based, signature-based, anomaly detection</li>
                <li><strong>Coverage:</strong> Known threats, defined patterns, established baselines</li>
                <li><strong>Strengths:</strong> 24/7 monitoring, consistent, scalable, low false negatives</li>
                <li><strong>Weaknesses:</strong> Misses novel attacks, can have high false positives, limited context</li>
            </ul>

            <h3>Hunting (Proactive Investigation)</h3>
            <ul>
                <li><strong>Purpose:</strong> Find sophisticated threats that evade detection</li>
                <li><strong>Approach:</strong> Hypothesis-driven, creative, contextual analysis</li>
                <li><strong>Coverage:</strong> Unknown threats, zero-days, living-off-the-land techniques</li>
                <li><strong>Strengths:</strong> Finds novel threats, deep analysis, contextual understanding</li>
                <li><strong>Weaknesses:</strong> Resource-intensive, requires skilled analysts, not continuous</li>
            </ul>

            <div class="highlight">
                <strong>The Relationship:</strong> Hunting feeds detection. Successful hunts become automated detection rules, continuously improving your security posture. Detection provides the foundation and telemetry that hunting relies upon.
            </div>

            <div class="success-box">
                <strong>Mindset Shift for Hunters:</strong>
                <p>Think like an attacker. Question assumptions. Ask "what if?" instead of "has this triggered an alert?" Embrace uncertainty and follow the data wherever it leads.</p>
            </div>
        </div>

        <!-- Slide 3: Hypothesis-Driven Hunting -->
        <div class="slide">
            <h2>Hypothesis-Driven Hunting</h2>

            <p>Hypothesis-driven hunting starts with a testable theory about how adversaries might be operating in your environment.</p>

            <h3>The Hypothesis Framework</h3>
            <p>A good hunting hypothesis follows this structure:</p>

            <div class="code-block">
IF [adversary behavior or technique]
AND [environmental condition or opportunity]
THEN [observable indicator or artifact]
WHERE [specific data source or location]</div>

            <h3>Examples of Hunting Hypotheses</h3>

            <div class="technique-box">
                <h4>Hypothesis 1: Credential Dumping</h4>
                <p><strong>IF</strong> an attacker has gained initial access to a workstation<br>
                <strong>AND</strong> they want to escalate privileges or move laterally<br>
                <strong>THEN</strong> they may attempt to dump credentials from LSASS memory<br>
                <strong>WHERE</strong> we would see unusual process access to lsass.exe in EDR telemetry</p>
            </div>

            <div class="technique-box">
                <h4>Hypothesis 2: DNS Tunneling for C2</h4>
                <p><strong>IF</strong> an attacker has established persistence<br>
                <strong>AND</strong> standard HTTP/HTTPS channels are monitored<br>
                <strong>THEN</strong> they may use DNS queries for command and control<br>
                <strong>WHERE</strong> we would see abnormally high DNS query volumes or unusual subdomain patterns</p>
            </div>

            <div class="technique-box">
                <h4>Hypothesis 3: Scheduled Task Persistence</h4>
                <p><strong>IF</strong> an attacker wants to maintain access<br>
                <strong>AND</strong> they have local administrative privileges<br>
                <strong>THEN</strong> they may create a scheduled task for persistence<br>
                <strong>WHERE</strong> we would see schtasks.exe execution or Task Scheduler event logs</p>
            </div>

            <h3>Sources for Hypotheses</h3>
            <ul>
                <li><strong>Threat Intelligence:</strong> APT reports, IOCs, campaign analysis</li>
                <li><strong>Industry News:</strong> Recent breaches, new attack techniques</li>
                <li><strong>MITRE ATT&CK:</strong> Adversary tactics and techniques</li>
                <li><strong>Past Incidents:</strong> Your organization's history</li>
                <li><strong>Vulnerability Reports:</strong> New CVEs, exploit releases</li>
                <li><strong>Peer Sharing:</strong> ISACs, security communities</li>
            </ul>

            <div class="info-box">
                <strong>Best Practice:</strong> Document your hypotheses before hunting. This creates a clear investigation plan, helps focus your effort, and provides a record for future reference and operationalization.
            </div>
        </div>

        <!-- Slide 4: Data-Driven Hunting -->
        <div class="slide">
            <h2>Data-Driven Hunting</h2>

            <p>Data-driven hunting uses statistical analysis and anomaly detection to identify unusual patterns without a predefined hypothesis. This approach lets the data reveal potential threats.</p>

            <h3>Core Techniques</h3>

            <h4>1. Anomaly Detection</h4>
            <p>Identify deviations from established baselines:</p>
            <ul>
                <li><strong>Volume anomalies:</strong> Unusual amounts of data transfer, login attempts, DNS queries</li>
                <li><strong>Timing anomalies:</strong> Activity during unusual hours, periodic beaconing</li>
                <li><strong>Behavior anomalies:</strong> User/system acting outside normal patterns</li>
                <li><strong>Geographic anomalies:</strong> Access from unexpected locations</li>
            </ul>

            <h4>2. Stack Counting (Frequency Analysis)</h4>
            <p>Count occurrences and find outliers. Most systems do similar things; outliers deserve investigation.</p>

            <div class="code-block">
# Example: Find rare process names
processes | stats count by process_name | sort count | head 20

# Example: Find unusual parent-child relationships
processes | stats count by parent_process, child_process | rare

# Example: Uncommon network connections
network | stats count by dest_ip, dest_port | where count &lt; 5</div>

            <div class="success-box">
                <strong>The Power of Stack Counting:</strong>
                <p>In an environment with 10,000 systems, if 9,998 are running similar processes and 2 are different, those 2 deserve investigation. Malware and attacker tools often stand out as statistical outliers.</p>
            </div>

            <h4>3. Long-Tail Analysis</h4>
            <p>Focus on the "long tail" of rare events. The majority of activity is normal and repetitive; threats hide in rare, one-off events.</p>

            <div class="technique-box">
                <h4>Long-Tail Example: Process Execution</h4>
                <p>In a large environment:</p>
                <ul>
                    <li><strong>Short head:</strong> Top 100 processes account for 95% of all executions (normal)</li>
                    <li><strong>Long tail:</strong> Bottom 5% contains thousands of unique processes (investigate here)</li>
                </ul>
                <p>Attackers often use custom tools, renamed utilities, or legitimate-but-rare binaries that appear in the long tail.</p>
            </div>

            <h4>4. Clustering and Grouping</h4>
            <p>Group similar entities to find outliers:</p>
            <ul>
                <li>User behavior clustering (peer group analysis)</li>
                <li>System behavior clustering (find the odd one out)</li>
                <li>Network communication clustering (unusual connections)</li>
            </ul>

            <div class="warning-box">
                <strong>Challenge: Noise vs. Signal</strong>
                <p>Data-driven hunting generates many potential leads. Not every anomaly is malicious. Skilled hunters develop intuition for which outliers deserve deeper investigation. Context is critical.</p>
            </div>
        </div>

        <!-- Slide 5: Intel-Driven Hunting -->
        <div class="slide">
            <h2>Intelligence-Driven Hunting</h2>

            <p>Intelligence-driven hunting leverages threat intelligence to search for specific adversary behaviors, indicators, or campaigns in your environment.</p>

            <h3>Types of Threat Intelligence</h3>

            <h4>1. Indicators of Compromise (IOCs)</h4>
            <p>Specific artifacts that indicate malicious activity:</p>
            <ul>
                <li><strong>File hashes:</strong> MD5, SHA1, SHA256 of malware samples</li>
                <li><strong>IP addresses:</strong> C2 servers, malicious infrastructure</li>
                <li><strong>Domain names:</strong> Phishing domains, C2 domains</li>
                <li><strong>URLs:</strong> Malicious links, exploit delivery</li>
                <li><strong>Email addresses:</strong> Phishing senders</li>
                <li><strong>Registry keys:</strong> Persistence mechanisms</li>
                <li><strong>Mutex names:</strong> Malware identification</li>
            </ul>

            <div class="warning-box">
                <strong>IOC Limitations:</strong>
                <p>IOCs are easily changed by attackers. A single character change in a file produces a different hash. Focus on IOCs for rapid triage, but don't rely on them exclusively. TTPs provide more durable intelligence.</p>
            </div>

            <h4>2. Tactics, Techniques, and Procedures (TTPs)</h4>
            <p>How adversaries operate—harder to change than IOCs:</p>
            <ul>
                <li><strong>Tactics:</strong> The "why" (initial access, persistence, exfiltration)</li>
                <li><strong>Techniques:</strong> The "how" (spearphishing, scheduled tasks, DNS tunneling)</li>
                <li><strong>Procedures:</strong> The specific implementation details</li>
            </ul>

            <div class="success-box">
                <strong>TTP-Based Hunting:</strong>
                <p>Hunt for behaviors, not signatures. If threat intel indicates an APT group uses WMI for lateral movement, hunt for WMI activity in your environment—regardless of specific IOCs.</p>
            </div>

            <h4>3. Threat Reports and Campaign Analysis</h4>
            <p>Detailed reports on adversary groups and campaigns:</p>
            <ul>
                <li>APT group profiles and targeting patterns</li>
                <li>Industry-specific threat campaigns</li>
                <li>Attack timelines and kill chain analysis</li>
                <li>Malware family analysis</li>
            </ul>

            <h3>Intel Sources for Hunters</h3>

            <div class="tool-grid">
                <div class="tool-card">
                    <h4>MITRE ATT&CK</h4>
                    <p>Comprehensive knowledge base of adversary tactics and techniques. Essential framework for TTP-based hunting.</p>
                </div>

                <div class="tool-card">
                    <h4>Open-Source Feeds</h4>
                    <p>AlienVault OTX, Abuse.ch, VirusTotal, URLhaus, threat researcher blogs and Twitter feeds.</p>
                </div>

                <div class="tool-card">
                    <h4>Commercial Intel</h4>
                    <p>Recorded Future, Mandiant, CrowdStrike Intelligence, vendor-specific threat intelligence platforms.</p>
                </div>

                <div class="tool-card">
                    <h4>ISACs and Sharing Groups</h4>
                    <p>Industry-specific Information Sharing and Analysis Centers, government partnerships, peer networks.</p>
                </div>
            </div>

            <h3>Intel-Driven Hunt Process</h3>
            <ol>
                <li><strong>Consume:</strong> Review latest threat intelligence reports</li>
                <li><strong>Contextualize:</strong> Determine relevance to your environment</li>
                <li><strong>Extract:</strong> Pull out actionable IOCs and TTPs</li>
                <li><strong>Hunt:</strong> Search for indicators in historical and current data</li>
                <li><strong>Correlate:</strong> Connect findings to broader attack patterns</li>
                <li><strong>Operationalize:</strong> Create detections for ongoing monitoring</li>
            </ol>
        </div>

        <!-- Slide 6: The Hunting Loop -->
        <div class="slide">
            <h2>The Hunting Loop</h2>

            <p>Threat hunting is an iterative process. Each hunt informs the next, continuously improving your security posture.</p>

            <div class="hunting-loop">
                <div class="loop-step">1. Hypothesis</div>
                <div class="loop-arrow">→</div>
                <div class="loop-step">2. Data Collection</div>
                <div class="loop-arrow">→</div>
                <div class="loop-step">3. Analysis</div>
                <div class="loop-arrow">→</div>
                <div class="loop-step">4. Findings</div>
                <div class="loop-arrow">→</div>
                <div class="loop-step">5. Improve</div>
                <div class="loop-arrow">↻</div>
            </div>

            <h3>Phase 1: Hypothesis Formation</h3>
            <ul>
                <li>Develop testable theory about adversary activity</li>
                <li>Based on intel, past incidents, or data observations</li>
                <li>Define what success looks like</li>
                <li>Identify required data sources</li>
            </ul>

            <h3>Phase 2: Data Collection</h3>
            <ul>
                <li>Gather relevant telemetry from identified sources</li>
                <li>Query SIEM, EDR, network logs, cloud logs</li>
                <li>Ensure data quality and completeness</li>
                <li>Apply initial filters to reduce noise</li>
            </ul>

            <h3>Phase 3: Analysis</h3>
            <ul>
                <li>Apply hunting techniques (stack counting, anomaly detection)</li>
                <li>Look for patterns, outliers, suspicious correlations</li>
                <li>Pivot on interesting findings</li>
                <li>Build timeline of events</li>
                <li>Contextualize with business knowledge</li>
            </ul>

            <h3>Phase 4: Findings and Response</h3>
            <ul>
                <li><strong>True Positive (Threat Found):</strong> Initiate incident response, contain threat, investigate scope</li>
                <li><strong>False Positive (Benign):</strong> Document why it appeared suspicious, add to exclusions if appropriate</li>
                <li><strong>Inconclusive:</strong> Insufficient data or unclear results—note for future investigation</li>
            </ul>

            <h3>Phase 5: Continuous Improvement</h3>
            <ul>
                <li><strong>Operationalize findings:</strong> Create detection rules for ongoing monitoring</li>
                <li><strong>Document hunt:</strong> Record methodology, queries, results for knowledge sharing</li>
                <li><strong>Update playbooks:</strong> Incorporate learnings into SOC procedures</li>
                <li><strong>Identify gaps:</strong> Note missing telemetry or blind spots</li>
                <li><strong>Generate new hypotheses:</strong> What else should we look for?</li>
            </ul>

            <div class="highlight">
                <strong>The Virtuous Cycle:</strong> Each completed hunt strengthens your defenses. Findings become detections. Gaps get filled. Hunters become more skilled. The organization becomes harder to compromise.
            </div>
        </div>

        <!-- Slide 7: MITRE ATT&CK for Hunters -->
        <div class="slide">
            <h2>MITRE ATT&CK for Threat Hunters</h2>

            <p>The MITRE ATT&CK framework is the hunter's roadmap to adversary behavior. It organizes real-world attack techniques into tactics (the "why") and techniques (the "how").</p>

            <h3>The ATT&CK Matrix Structure</h3>

            <div class="attack-matrix">
                <h4>14 Tactics (Enterprise Matrix)</h4>
                <div class="tactic-grid">
                    <div class="tactic-card">
                        <h5>Initial Access</h5>
                        <p>How attackers get in</p>
                    </div>
                    <div class="tactic-card">
                        <h5>Execution</h5>
                        <p>Running malicious code</p>
                    </div>
                    <div class="tactic-card">
                        <h5>Persistence</h5>
                        <p>Maintaining access</p>
                    </div>
                    <div class="tactic-card">
                        <h5>Privilege Escalation</h5>
                        <p>Gaining higher permissions</p>
                    </div>
                    <div class="tactic-card">
                        <h5>Defense Evasion</h5>
                        <p>Avoiding detection</p>
                    </div>
                    <div class="tactic-card">
                        <h5>Credential Access</h5>
                        <p>Stealing credentials</p>
                    </div>
                    <div class="tactic-card">
                        <h5>Discovery</h5>
                        <p>Learning the environment</p>
                    </div>
                    <div class="tactic-card">
                        <h5>Lateral Movement</h5>
                        <p>Moving through network</p>
                    </div>
                    <div class="tactic-card">
                        <h5>Collection</h5>
                        <p>Gathering target data</p>
                    </div>
                    <div class="tactic-card">
                        <h5>Command & Control</h5>
                        <p>C2 communications</p>
                    </div>
                    <div class="tactic-card">
                        <h5>Exfiltration</h5>
                        <p>Stealing data</p>
                    </div>
                    <div class="tactic-card">
                        <h5>Impact</h5>
                        <p>Destruction/disruption</p>
                    </div>
                </div>
            </div>

            <h3>Using ATT&CK for Hunting</h3>

            <h4>1. Technique-Based Hunt Planning</h4>
            <p>Select a technique and hunt for all its variations in your environment.</p>

            <div class="technique-box">
                <h4>Example: T1053 - Scheduled Task/Job</h4>
                <p><strong>Hunt objectives:</strong></p>
                <ul>
                    <li>Find all scheduled task creations in last 30 days</li>
                    <li>Identify tasks created by non-admin tools</li>
                    <li>Look for tasks with unusual execution patterns</li>
                    <li>Check tasks pointing to temporary directories</li>
                </ul>
                <p><strong>Data sources:</strong> Sysmon Event ID 1, Windows Event ID 4698, EDR process creation logs</p>
            </div>

            <h4>2. Tactic-Focused Hunting Campaigns</h4>
            <p>Hunt across all techniques within a tactic (e.g., hunt everything related to Persistence).</p>

            <h4>3. APT Group Mapping</h4>
            <p>ATT&CK includes known APT group behaviors. Hunt for techniques used by groups targeting your industry.</p>

            <div class="code-block">
Example: APT29 (Cozy Bear) commonly uses:
- T1566.001: Spearphishing Attachment
- T1053.005: Scheduled Task
- T1027: Obfuscated Files or Information
- T1071.001: Web Protocols for C2

Hunt for these techniques if APT29 targets your sector.</div>

            <h4>4. Detection Gap Analysis</h4>
            <p>Map your existing detections to ATT&CK. Gaps are hunting priorities.</p>

            <div class="info-box">
                <strong>ATT&CK Navigator:</strong>
                <p>Use MITRE's ATT&CK Navigator tool to visualize coverage, plan hunts, and track which techniques you've investigated. Color-code the matrix to show coverage gaps.</p>
            </div>

            <h3>Key ATT&CK Resources for Hunters</h3>
            <ul>
                <li><strong>Technique Pages:</strong> Each technique includes detection recommendations and data sources</li>
                <li><strong>Data Sources:</strong> What telemetry is needed to hunt this technique</li>
                <li><strong>Mitigations:</strong> How to prevent or limit the technique</li>
                <li><strong>Procedure Examples:</strong> Real-world examples from APT groups</li>
            </ul>
        </div>

        <!-- Slide 8: Common Hunting Techniques -->
        <div class="slide">
            <h2>Common Hunting Techniques</h2>

            <h3>1. Stack Counting</h3>
            <p>The most fundamental hunting technique: count occurrences and investigate outliers.</p>

            <div class="technique-box">
                <h4>What to Stack Count</h4>
                <ul>
                    <li><strong>Process names:</strong> Find rare or misspelled executables</li>
                    <li><strong>Process paths:</strong> Identify execution from unusual directories</li>
                    <li><strong>Parent-child relationships:</strong> Detect abnormal process spawning</li>
                    <li><strong>Network connections:</strong> Find rare destinations or ports</li>
                    <li><strong>User agents:</strong> Identify non-standard tools</li>
                    <li><strong>Commands executed:</strong> Spot suspicious command-line arguments</li>
                    <li><strong>Registry modifications:</strong> Find rare registry changes</li>
                    <li><strong>DLL loads:</strong> Detect unusual library loading</li>
                </ul>
            </div>

            <div class="code-block">
# Splunk example: Stack count process names, show rarest first
index=edr sourcetype=process
| stats count by process_name
| sort count
| head 50

# Example: Find rare parent-child combinations
index=edr sourcetype=process
| stats count by parent_process_name, process_name
| where count &lt; 10</div>

            <div class="success-box">
                <strong>Why This Works:</strong>
                <p>In large environments, legitimate processes occur frequently. Malware, attacker tools, and exploitation artifacts are rare. Stack counting surfaces these needles in the haystack.</p>
            </div>

            <h3>2. Frequency Analysis (Outlier Detection)</h3>
            <p>Identify statistical outliers in behavior patterns.</p>

            <div class="technique-box">
                <h4>Frequency Analysis Applications</h4>
                <ul>
                    <li><strong>Login frequency:</strong> User logging in 100x more than peers</li>
                    <li><strong>Data transfer volume:</strong> Workstation sending gigabytes externally</li>
                    <li><strong>DNS query volume:</strong> System making 10,000 queries/hour</li>
                    <li><strong>Failed authentication attempts:</strong> Account with excessive failures</li>
                    <li><strong>Execution frequency:</strong> Process running far more or less than baseline</li>
                </ul>
            </div>

            <div class="code-block">
# Example: Find users with abnormally high login counts
index=windows EventCode=4624
| stats count by user
| eventstats avg(count) as avg_count, stdev(count) as stdev_count
| eval threshold=avg_count+(2*stdev_count)
| where count > threshold</div>

            <h3>3. Long-Tail Analysis</h3>
            <p>Focus on the rare, one-off events where threats hide.</p>

            <div class="technique-box">
                <h4>Long-Tail Hunting Strategy</h4>
                <ol>
                    <li>Aggregate data by key field (process, domain, user)</li>
                    <li>Sort by frequency (ascending)</li>
                    <li>Focus on bottom 5-10% (rare events)</li>
                    <li>Investigate items with count = 1 or &lt; 5</li>
                    <li>Look for patterns in the rare items</li>
                </ol>
            </div>

            <div class="code-block">
# Example: Find rare domains accessed
index=proxy
| stats count by dest_domain
| sort count
| where count &lt; 5

# Investigate: Are these typosquatting? DGA domains? Legitimate but obscure?</div>

            <h3>4. Beaconing Detection</h3>
            <p>Identify command-and-control beaconing by finding periodic network activity.</p>

            <div class="technique-box">
                <h4>Beaconing Characteristics</h4>
                <ul>
                    <li><strong>Periodic timing:</strong> Connections every X seconds/minutes</li>
                    <li><strong>Consistent size:</strong> Similar packet or request sizes</li>
                    <li><strong>Regular intervals:</strong> Mathematical precision in timing</li>
                    <li><strong>Persistent destination:</strong> Same IP/domain repeatedly</li>
                </ul>
            </div>

            <div class="code-block">
# Conceptual approach: Calculate time deltas between connections
# Group by source and destination
# Look for consistent intervals (stddev of deltas is low)
# Flag: Average delta is 30s, 60s, 300s, 600s (common beacon intervals)</div>

            <div class="warning-box">
                <strong>Legitimate Beacons:</strong>
                <p>Not all beaconing is malicious. Software updates, heartbeats, monitoring agents also beacon. Baseline your environment to distinguish malicious from benign periodic activity.</p>
            </div>

            <h3>5. Clustering and Peer Group Analysis</h3>
            <p>Group similar entities and find the outlier in each group.</p>

            <div class="technique-box">
                <h4>Example: User Clustering</h4>
                <p>Group users by department, role, or behavior profile. If 99 accountants access similar systems and 1 accountant accesses development servers, investigate that outlier.</p>
            </div>

            <h3>6. Time-Based Analysis</h3>
            <p>Hunt based on temporal patterns:</p>
            <ul>
                <li><strong>After-hours activity:</strong> Logins at 3 AM</li>
                <li><strong>Weekend activity:</strong> File access on Sundays in a 9-5 org</li>
                <li><strong>Rapid succession:</strong> Password spray across many accounts in minutes</li>
                <li><strong>Dormant accounts:</strong> Inactive for months, suddenly active</li>
            </ul>
        </div>

        <!-- Slide 9: Hunting Tools -->
        <div class="slide">
            <h2>Threat Hunting Tools</h2>

            <p>Effective hunting requires the right tools for data collection, analysis, and visualization.</p>

            <h3>Data Collection and Query Platforms</h3>

            <div class="tool-grid">
                <div class="tool-card">
                    <h4>SIEM Platforms</h4>
                    <ul>
                        <li><strong>Splunk:</strong> Powerful search (SPL), visualizations, statistical functions</li>
                        <li><strong>Elastic (ELK):</strong> Fast queries (KQL), scalable, Kibana dashboards</li>
                        <li><strong>Microsoft Sentinel:</strong> Cloud-native, KQL queries, Azure integration</li>
                    </ul>
                </div>

                <div class="tool-card">
                    <h4>EDR Solutions</h4>
                    <ul>
                        <li><strong>CrowdStrike Falcon:</strong> Process telemetry, memory forensics, threat graph</li>
                        <li><strong>Microsoft Defender:</strong> Advanced hunting with KQL</li>
                        <li><strong>Carbon Black:</strong> Process tree visualization, live response</li>
                    </ul>
                </div>

                <div class="tool-card">
                    <h4>Network Analysis</h4>
                    <ul>
                        <li><strong>Zeek (Bro):</strong> Network protocol analysis, scripting</li>
                        <li><strong>Wireshark:</strong> Packet capture and deep inspection</li>
                        <li><strong>NetworkMiner:</strong> Artifact extraction from PCAP</li>
                    </ul>
                </div>

                <div class="tool-card">
                    <h4>Open-Source SIEM</h4>
                    <ul>
                        <li><strong>Wazuh:</strong> Log collection, detection, EDR capabilities</li>
                        <li><strong>Graylog:</strong> Log aggregation, search, alerting</li>
                        <li><strong>OpenSearch:</strong> Fork of Elasticsearch, similar capabilities</li>
                    </ul>
                </div>
            </div>

            <h3>Analysis and Investigation Tools</h3>

            <div class="tool-grid">
                <div class="tool-card">
                    <h4>Jupyter Notebooks</h4>
                    <p>Interactive analysis environment for threat hunting. Combine code (Python), queries, visualizations, and documentation in one place. Excellent for reproducible hunts.</p>
                </div>

                <div class="tool-card">
                    <h4>HELK (Hunting ELK)</h4>
                    <p>Pre-configured ELK stack optimized for threat hunting with Jupyter integration, pre-built analytics, and hunting-focused data models.</p>
                </div>

                <div class="tool-card">
                    <h4>Velociraptor</h4>
                    <p>Endpoint visibility and collection tool. Hunt across thousands of endpoints with VQL (Velociraptor Query Language). Artifact collection and analysis.</p>
                </div>

                <div class="tool-card">
                    <h4>OSQuery</h4>
                    <p>SQL-powered endpoint visibility. Query endpoints like databases. Cross-platform support. Integrate with fleet managers for at-scale hunting.</p>
                </div>
            </div>

            <h3>Threat Intelligence Integration</h3>

            <div class="tool-grid">
                <div class="tool-card">
                    <h4>MISP</h4>
                    <p>Malware Information Sharing Platform. Store, share, and correlate threat intelligence. IOC management and automated enrichment.</p>
                </div>

                <div class="tool-card">
                    <h4>OpenCTI</h4>
                    <p>Open-source threat intelligence platform. Knowledge graph of threats, TTPs, and observables. STIX 2.0 compliant.</p>
                </div>

                <div class="tool-card">
                    <h4>TheHive</h4>
                    <p>Security incident response platform. Case management for hunting findings. Integration with MISP and other intel sources.</p>
                </div>
            </div>

            <h3>Scripting and Automation</h3>
            <ul>
                <li><strong>Python:</strong> Data analysis (pandas), visualization (matplotlib), automation</li>
                <li><strong>PowerShell:</strong> Windows environment hunting, Active Directory queries, remote execution</li>
                <li><strong>Bash:</strong> Linux/Unix hunting, log parsing, automation</li>
            </ul>

            <div class="info-box">
                <strong>Tool Selection Tip:</strong>
                <p>The best hunting tool is the one you know deeply. Master your SIEM's query language, learn its statistical functions, and understand its data model. Tool proficiency multiplies hunting effectiveness.</p>
            </div>
        </div>

        <!-- Slide 10: Documenting and Operationalizing Hunts -->
        <div class="slide">
            <h2>Documenting and Operationalizing Hunts</h2>

            <p>A hunt's value extends beyond the immediate findings. Proper documentation and operationalization multiply the impact of each hunting mission.</p>

            <h3>Hunt Documentation Best Practices</h3>

            <div class="technique-box">
                <h4>Essential Hunt Documentation Elements</h4>
                <ol>
                    <li><strong>Hunt Title and ID:</strong> Unique identifier and descriptive name</li>
                    <li><strong>Date and Hunter:</strong> When performed, who performed it</li>
                    <li><strong>Hypothesis:</strong> What you were looking for and why</li>
                    <li><strong>Data Sources:</strong> Where you looked (SIEM, EDR, network logs)</li>
                    <li><strong>Queries and Methods:</strong> Exact searches performed (reproducibility)</li>
                    <li><strong>Findings:</strong> What you discovered (threats, false positives, benign)</li>
                    <li><strong>Analysis:</strong> Your interpretation and conclusions</li>
                    <li><strong>Recommendations:</strong> Follow-up actions, detections to create</li>
                    <li><strong>Lessons Learned:</strong> Gaps discovered, methodology improvements</li>
                </ol>
            </div>

            <div class="code-block">
Example Hunt Template:

HUNT-2024-045: Scheduled Task Persistence Hunting

Date: 2024-03-15
Hunter: J. Analyst
Hypothesis: Attackers may use scheduled tasks for persistence
           after initial compromise.

Data Sources:
- Windows Event Logs (Event ID 4698)
- Sysmon logs (Event ID 1, process creation)
- EDR telemetry (task creation events)

Query:
index=windows EventCode=4698
| search TaskName!="*Microsoft*" TaskName!="*Google*"
| stats count by ComputerName, TaskName, Command
| where count < 5

Findings:
- 3 suspicious scheduled tasks discovered
- 2 confirmed malicious (credential harvesting)
- 1 false positive (legitimate admin tool)

Actions Taken:
- Created SIEM alert for similar task creation patterns
- Updated EDR blocking rules
- Notified IR team for containment

Recommendations:
- Baseline all legitimate scheduled tasks
- Enable scheduled task auditing on all endpoints
- Create monthly recurring hunt for this TTP</div>

            <h3>Operationalizing Hunt Findings</h3>

            <p>The ultimate goal: convert successful hunts into automated detections and improved security posture.</p>

            <h4>From Hunt to Detection</h4>

            <div class="technique-box">
                <h4>The Operationalization Process</h4>
                <ol>
                    <li><strong>Refine the Hunt Query:</strong> Optimize for performance and accuracy, reduce false positives</li>
                    <li><strong>Create Detection Logic:</strong> Convert hunting query into real-time detection rule</li>
                    <li><strong>Define Alert Severity:</strong> How critical is this finding?</li>
                    <li><strong>Establish Response Playbook:</strong> What should SOC do when this triggers?</li>
                    <li><strong>Test in Monitoring Mode:</strong> Run detection without alerting, validate accuracy</li>
                    <li><strong>Deploy to Production:</strong> Enable alerting once validated</li>
                    <li><strong>Tune Over Time:</strong> Refine based on false positive rate</li>
                </ol>
            </div>

            <div class="success-box">
                <strong>The Hunting Flywheel:</strong>
                <p>Hunt → Find Threats → Create Detections → Free Up Hunting Time → Hunt More Advanced Threats → Improve Detections → Repeat</p>
                <p>Each hunting cycle raises the bar. Automated detections handle known threats, allowing hunters to focus on novel, sophisticated attacks.</p>
            </div>

            <h3>Knowledge Sharing</h3>

            <ul>
                <li><strong>Hunt Library:</strong> Maintain a searchable repository of completed hunts</li>
                <li><strong>Playbooks:</strong> Document repeatable hunt procedures</li>
                <li><strong>Team Collaboration:</strong> Share findings, techniques, and lessons learned</li>
                <li><strong>Training:</strong> Use hunt results to train SOC analysts on new threats</li>
                <li><strong>External Sharing:</strong> Consider sharing anonymized hunts with security community</li>
            </ul>

            <h3>Measuring Hunt Effectiveness</h3>

            <div class="technique-box">
                <h4>Key Metrics for Hunting Programs</h4>
                <ul>
                    <li><strong>Hunt Frequency:</strong> Number of hunts per month/quarter</li>
                    <li><strong>Coverage:</strong> Percentage of ATT&CK techniques hunted</li>
                    <li><strong>True Positive Rate:</strong> Percentage of hunts finding actual threats</li>
                    <li><strong>Dwell Time Reduction:</strong> Time from compromise to detection (hunting should reduce this)</li>
                    <li><strong>Detections Created:</strong> Number of new detection rules from hunts</li>
                    <li><strong>Gaps Identified:</strong> Blind spots discovered and addressed</li>
                    <li><strong>Mean Time to Hunt (MTTH):</strong> How quickly can you investigate a hypothesis?</li>
                </ul>
            </div>

            <div class="warning-box">
                <strong>Avoid Vanity Metrics:</strong>
                <p>Don't measure success solely by "threats found." A hunt finding nothing malicious is still valuable if it validates your defenses, refines detection logic, or identifies telemetry gaps.</p>
            </div>

            <h3>Continuous Improvement</h3>

            <p>After each hunt, ask:</p>
            <ul>
                <li>What data would have made this hunt easier?</li>
                <li>What new questions did this hunt generate?</li>
                <li>How can we automate parts of this hunt?</li>
                <li>What did we learn about our environment?</li>
                <li>Are there related TTPs we should investigate next?</li>
            </ul>

            <div class="highlight">
                <strong>The Hunter's Mindset:</strong> Every hunt is both an investigation and a learning opportunity. The goal isn't just to find threats today—it's to build a hunting program that becomes increasingly effective over time, making your organization a harder target for adversaries.
            </div>
        </div>

        <!-- Slide 11: Summary -->
        <div class="slide">
            <h2>Summary: The Threat Hunter's Mission</h2>

            <div class="highlight">
                <strong>Threat hunting is proactive cybersecurity's highest expression.</strong> Hunters assume adversaries are present and actively search for evidence of compromise before automated systems detect it.
            </div>

            <h3>Key Takeaways</h3>

            <div class="technique-box">
                <h4>The Three Hunting Approaches</h4>
                <ul>
                    <li><strong>Hypothesis-Driven:</strong> Start with a theory about adversary behavior</li>
                    <li><strong>Data-Driven:</strong> Let statistical anomalies guide investigation</li>
                    <li><strong>Intelligence-Driven:</strong> Hunt based on external threat intelligence</li>
                </ul>
                <p>Master all three—use them individually or in combination based on the situation.</p>
            </div>

            <div class="technique-box">
                <h4>The Hunting Loop</h4>
                <p>Hypothesis → Data → Analysis → Findings → Improve → Repeat</p>
                <p>Each iteration strengthens defenses and hunter capabilities.</p>
            </div>

            <div class="technique-box">
                <h4>Core Hunting Techniques</h4>
                <ul>
                    <li><strong>Stack Counting:</strong> Find outliers by frequency</li>
                    <li><strong>Long-Tail Analysis:</strong> Focus on rare events</li>
                    <li><strong>Beaconing Detection:</strong> Identify periodic C2 activity</li>
                    <li><strong>Clustering:</strong> Group and find the odd one out</li>
                    <li><strong>Time-Based Analysis:</strong> Detect temporal anomalies</li>
                </ul>
            </div>

            <div class="technique-box">
                <h4>MITRE ATT&CK Framework</h4>
                <p>The hunter's essential reference. Map hunts to tactics and techniques. Use it to plan campaigns, identify gaps, and understand adversary behavior.</p>
            </div>

            <div class="technique-box">
                <h4>From Hunt to Detection</h4>
                <p>Operationalize findings. Convert manual hunts into automated detections. Document methodology. Share knowledge. Continuously improve.</p>
            </div>

            <h3>The Hunter's Mindset</h3>

            <div class="success-box">
                <strong>Think Like an Attacker, Act Like a Detective</strong>
                <ul>
                    <li>Be curious—question everything, especially "normal"</li>
                    <li>Be methodical—document, measure, iterate</li>
                    <li>Be creative—adversaries don't follow playbooks, neither should you</li>
                    <li>Be persistent—most hunts find nothing, that's valuable too</li>
                    <li>Be collaborative—share findings, learn from peers</li>
                </ul>
            </div>

            <h3>Next Steps in Your Hunting Journey</h3>

            <ol>
                <li><strong>Practice:</strong> Use the Threat Hunting Lab to apply these concepts</li>
                <li><strong>Build Your Toolkit:</strong> Master your SIEM, EDR, and analysis tools</li>
                <li><strong>Study ATT&CK:</strong> Deep dive into techniques relevant to your environment</li>
                <li><strong>Start Small:</strong> Begin with simple stack counting hunts</li>
                <li><strong>Document Everything:</strong> Build your hunt library from day one</li>
                <li><strong>Join the Community:</strong> Follow threat researchers, read hunt reports, share your findings</li>
            </ol>

            <div class="highlight">
                <strong>"Hunters don't wait for alerts. They actively search for threats, improve defenses, and raise the cost of attack. In the eternal cat-and-mouse game of cybersecurity, hunters shift the advantage to defenders."</strong>
            </div>
        </div>

        <!-- Completion Button -->
        <button class="complete-button" onclick="completeModule()">
            Complete Threat Hunting Presentation
        </button>

        <a href="../index.html" class="back-link">← Back to Eye House</a>
    </div>

    <script src="../../../components/AchievementManager.js"></script>
    <script src="../../../components/ModuleProgress.js"></script>
    <script>
        function completeModule() {
            ModuleProgress.complete('eye', 'eye-threat-hunting', {
                silent: false,
                returnToDashboard: true
            });
        }

        // Add smooth scrolling for better presentation experience
        document.addEventListener('DOMContentLoaded', function() {
            // Animate slides on scroll
            const slides = document.querySelectorAll('.slide');

            const slideObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.animation = 'slideIn 0.5s ease-out';
                    }
                });
            }, { threshold: 0.1 });

            slides.forEach(slide => {
                slideObserver.observe(slide);
            });

            // Add interactive hover effects to tactic cards
            const tacticCards = document.querySelectorAll('.tactic-card');
            tacticCards.forEach(card => {
                card.addEventListener('click', function() {
                    this.style.animation = 'pulse 0.5s ease-out';
                    setTimeout(() => {
                        this.style.animation = '';
                    }, 500);
                });
            });
        });
    </script>
<script src="../../../components/FluxCapacitor.js"></script>
</body>
</html>
