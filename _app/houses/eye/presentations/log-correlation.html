<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Log Correlation - Eye House - Hexworth Prime</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #0f0f23 0%, #1a0a2e 100%);
      color: #e0e0e0;
      line-height: 1.6;
      overflow-x: hidden;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }

    header {
      text-align: center;
      padding: 40px 20px;
      background: linear-gradient(135deg, rgba(192, 132, 252, 0.1) 0%, rgba(6, 182, 212, 0.1) 100%);
      border-radius: 20px;
      margin-bottom: 40px;
      border: 2px solid rgba(192, 132, 252, 0.3);
      position: relative;
      overflow: hidden;
    }

    header::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(192, 132, 252, 0.1) 0%, transparent 70%);
      animation: pulse 4s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 0.5; }
      50% { transform: scale(1.1); opacity: 0.8; }
    }

    h1 {
      font-size: 3em;
      margin-bottom: 10px;
      background: linear-gradient(135deg, #c084fc 0%, #06b6d4 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      position: relative;
      z-index: 1;
    }

    .subtitle {
      font-size: 1.3em;
      color: #06b6d4;
      position: relative;
      z-index: 1;
    }

    .house-badge {
      display: inline-block;
      background: rgba(192, 132, 252, 0.2);
      color: #c084fc;
      padding: 8px 20px;
      border-radius: 20px;
      margin-top: 15px;
      border: 1px solid #c084fc;
      font-weight: 600;
      position: relative;
      z-index: 1;
    }

    .nav-buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-bottom: 40px;
      flex-wrap: wrap;
    }

    .nav-btn {
      background: linear-gradient(135deg, rgba(192, 132, 252, 0.2) 0%, rgba(6, 182, 212, 0.2) 100%);
      color: #c084fc;
      border: 2px solid #c084fc;
      padding: 12px 30px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1em;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .nav-btn:hover {
      background: linear-gradient(135deg, rgba(192, 132, 252, 0.3) 0%, rgba(6, 182, 212, 0.3) 100%);
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(192, 132, 252, 0.4);
    }

    .nav-btn.active {
      background: linear-gradient(135deg, #c084fc 0%, #06b6d4 100%);
      color: #0f0f23;
    }

    .slide {
      display: none;
      background: rgba(30, 30, 60, 0.6);
      padding: 40px;
      border-radius: 15px;
      margin-bottom: 30px;
      border: 2px solid rgba(192, 132, 252, 0.3);
      backdrop-filter: blur(10px);
      animation: slideIn 0.5s ease-out;
    }

    .slide.active {
      display: block;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    h2 {
      color: #c084fc;
      font-size: 2.2em;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 3px solid rgba(192, 132, 252, 0.3);
    }

    h3 {
      color: #06b6d4;
      font-size: 1.6em;
      margin: 30px 0 15px 0;
    }

    .concept-box {
      background: rgba(192, 132, 252, 0.1);
      padding: 25px;
      border-radius: 12px;
      margin: 20px 0;
      border-left: 5px solid #c084fc;
    }

    .highlight-box {
      background: rgba(6, 182, 212, 0.1);
      padding: 25px;
      border-radius: 12px;
      margin: 20px 0;
      border-left: 5px solid #06b6d4;
    }

    .warning-box {
      background: rgba(244, 114, 182, 0.1);
      padding: 25px;
      border-radius: 12px;
      margin: 20px 0;
      border-left: 5px solid #f472b6;
    }

    ul, ol {
      margin: 15px 0 15px 30px;
    }

    li {
      margin: 10px 0;
      color: #d0d0d0;
    }

    .code-block {
      background: rgba(15, 15, 35, 0.8);
      padding: 20px;
      border-radius: 8px;
      margin: 20px 0;
      border: 1px solid rgba(192, 132, 252, 0.3);
      overflow-x: auto;
      font-family: 'Courier New', monospace;
      color: #06b6d4;
    }

    .correlation-visual {
      background: rgba(15, 15, 35, 0.6);
      padding: 30px;
      border-radius: 12px;
      margin: 25px 0;
      border: 2px solid rgba(192, 132, 252, 0.3);
    }

    .timeline-viz {
      display: flex;
      align-items: center;
      gap: 15px;
      margin: 15px 0;
      padding: 15px;
      background: rgba(192, 132, 252, 0.05);
      border-radius: 8px;
    }

    .event-box {
      background: linear-gradient(135deg, rgba(192, 132, 252, 0.2) 0%, rgba(6, 182, 212, 0.2) 100%);
      padding: 15px;
      border-radius: 8px;
      border: 2px solid #c084fc;
      flex: 1;
      min-width: 200px;
    }

    .arrow {
      color: #06b6d4;
      font-size: 2em;
      font-weight: bold;
    }

    .log-source-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin: 25px 0;
    }

    .source-card {
      background: rgba(192, 132, 252, 0.1);
      padding: 20px;
      border-radius: 10px;
      border: 2px solid #c084fc;
      transition: all 0.3s ease;
    }

    .source-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(192, 132, 252, 0.3);
      border-color: #06b6d4;
    }

    .source-card h4 {
      color: #c084fc;
      margin-bottom: 10px;
      font-size: 1.2em;
    }

    .killchain-viz {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin: 25px 0;
    }

    .killchain-phase {
      background: linear-gradient(90deg, rgba(192, 132, 252, 0.2) 0%, rgba(6, 182, 212, 0.2) 100%);
      padding: 20px;
      border-radius: 8px;
      border-left: 5px solid #c084fc;
      position: relative;
    }

    .killchain-phase::after {
      content: '‚Üì';
      position: absolute;
      bottom: -25px;
      left: 50%;
      transform: translateX(-50%);
      color: #06b6d4;
      font-size: 1.5em;
    }

    .killchain-phase:last-child::after {
      display: none;
    }

    .correlation-rule {
      background: rgba(15, 15, 35, 0.8);
      padding: 20px;
      border-radius: 8px;
      margin: 15px 0;
      border: 2px solid #06b6d4;
      font-family: 'Courier New', monospace;
    }

    .rule-operator {
      color: #f472b6;
      font-weight: bold;
    }

    .rule-field {
      color: #c084fc;
    }

    .rule-value {
      color: #06b6d4;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 25px 0;
      background: rgba(15, 15, 35, 0.6);
      border-radius: 8px;
      overflow: hidden;
    }

    th {
      background: rgba(192, 132, 252, 0.3);
      color: #c084fc;
      padding: 15px;
      text-align: left;
      font-weight: 600;
    }

    td {
      padding: 12px 15px;
      border-bottom: 1px solid rgba(192, 132, 252, 0.1);
    }

    tr:hover {
      background: rgba(192, 132, 252, 0.05);
    }

    .progress-tracker {
      background: rgba(6, 182, 212, 0.1);
      padding: 20px;
      border-radius: 12px;
      margin: 30px 0;
      border: 2px solid #06b6d4;
      text-align: center;
    }

    .progress-bar {
      width: 100%;
      height: 30px;
      background: rgba(15, 15, 35, 0.8);
      border-radius: 15px;
      overflow: hidden;
      margin: 15px 0;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #c084fc 0%, #06b6d4 100%);
      border-radius: 15px;
      transition: width 0.5s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 600;
    }

    .complete-btn {
      background: linear-gradient(135deg, #c084fc 0%, #06b6d4 100%);
      color: #0f0f23;
      border: none;
      padding: 15px 40px;
      border-radius: 10px;
      font-size: 1.1em;
      font-weight: 600;
      cursor: pointer;
      margin-top: 20px;
      transition: all 0.3s ease;
    }

    .complete-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(192, 132, 252, 0.5);
    }

    .complete-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .interactive-demo {
      background: rgba(15, 15, 35, 0.8);
      padding: 30px;
      border-radius: 12px;
      margin: 25px 0;
      border: 2px solid rgba(192, 132, 252, 0.3);
    }

    .demo-controls {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .demo-btn {
      background: rgba(192, 132, 252, 0.2);
      color: #c084fc;
      border: 2px solid #c084fc;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .demo-btn:hover {
      background: rgba(192, 132, 252, 0.3);
      transform: translateY(-2px);
    }

    .demo-btn.active {
      background: #c084fc;
      color: #0f0f23;
    }

    .demo-output {
      background: rgba(0, 0, 0, 0.4);
      padding: 20px;
      border-radius: 8px;
      min-height: 200px;
      font-family: 'Courier New', monospace;
      color: #06b6d4;
      white-space: pre-wrap;
    }

    .scenario-card {
      background: rgba(192, 132, 252, 0.05);
      padding: 25px;
      border-radius: 12px;
      margin: 20px 0;
      border: 2px solid rgba(192, 132, 252, 0.3);
    }

    .scenario-card h4 {
      color: #c084fc;
      font-size: 1.3em;
      margin-bottom: 15px;
    }

    .nav-footer {
      display: flex;
      justify-content: space-between;
      margin-top: 40px;
    }

    .nav-footer button {
      background: rgba(192, 132, 252, 0.2);
      color: #c084fc;
      border: 2px solid #c084fc;
      padding: 12px 30px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1em;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .nav-footer button:hover:not(:disabled) {
      background: rgba(192, 132, 252, 0.3);
      transform: translateY(-2px);
    }

    .nav-footer button:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }

    @media (max-width: 768px) {
      h1 { font-size: 2em; }
      h2 { font-size: 1.6em; }
      .log-source-grid { grid-template-columns: 1fr; }
      .timeline-viz { flex-direction: column; }
      .arrow { transform: rotate(90deg); }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Log Correlation Analysis</h1>
      <p class="subtitle">Connecting the Dots: Multi-Source Security Event Analysis</p>
      <div class="house-badge">Eye House - SOC Analyst Training</div>
    </header>

    <div class="nav-buttons" id="slideNav"></div>

    <!-- Slide 1: Introduction -->
    <div class="slide active" data-slide="1">
      <h2>What is Log Correlation?</h2>

      <div class="concept-box">
        <h3>Definition</h3>
        <p><strong>Log Correlation</strong> is the process of analyzing and linking related events from multiple log sources to identify patterns, detect security incidents, and reconstruct attack timelines.</p>
      </div>

      <p>Individual log entries are like puzzle pieces - they only tell part of the story. Log correlation assembles these pieces to reveal the complete picture of what's happening in your environment.</p>

      <h3>Single Event vs. Correlated Events</h3>

      <div class="correlation-visual">
        <h4 style="color: #c084fc; margin-bottom: 20px;">Single Event View (Limited Context)</h4>
        <div class="event-box">
          <strong>Firewall Log:</strong><br>
          10:32:15 - DENY 203.0.113.42 ‚Üí 192.168.1.100:22
        </div>
        <p style="margin-top: 15px; color: #f472b6;">‚ö†Ô∏è Question: Is this normal scanning or part of an attack?</p>
      </div>

      <div class="correlation-visual">
        <h4 style="color: #06b6d4; margin-bottom: 20px;">Correlated Event View (Full Context)</h4>
        <div class="timeline-viz">
          <div class="event-box">
            <strong>10:32:15 - Firewall</strong><br>
            DENY 203.0.113.42 ‚Üí :22
          </div>
          <div class="arrow">‚Üí</div>
          <div class="event-box">
            <strong>10:32:47 - IDS</strong><br>
            SSH brute force detected
          </div>
          <div class="arrow">‚Üí</div>
          <div class="event-box">
            <strong>10:35:22 - Auth Log</strong><br>
            Failed login (admin) from 203.0.113.42
          </div>
        </div>
        <p style="margin-top: 15px; color: #4ade80;">‚úì Answer: Active SSH brute force attack in progress!</p>
      </div>

      <div class="highlight-box">
        <h3>Why Correlation Matters</h3>
        <ul>
          <li><strong>Context Enhancement:</strong> Single events gain meaning when viewed alongside related events</li>
          <li><strong>Attack Detection:</strong> Multi-stage attacks are invisible in individual logs</li>
          <li><strong>False Positive Reduction:</strong> Correlation helps distinguish real threats from noise</li>
          <li><strong>Incident Response:</strong> Reveals attack scope, timeline, and impact</li>
          <li><strong>Compliance:</strong> Demonstrates due diligence in monitoring and investigation</li>
        </ul>
      </div>

      <div class="scenario-card">
        <h4>Real-World Example: Lateral Movement Detection</h4>
        <p><strong>Scenario:</strong> An attacker compromises one workstation and moves to a server.</p>

        <table>
          <tr>
            <th>Time</th>
            <th>Source</th>
            <th>Event</th>
            <th>By Itself</th>
          </tr>
          <tr>
            <td>14:22:10</td>
            <td>Endpoint EDR</td>
            <td>Credential dumping detected on WS-042</td>
            <td>Single compromised workstation</td>
          </tr>
          <tr>
            <td>14:23:35</td>
            <td>Network Logs</td>
            <td>SMB connection: WS-042 ‚Üí SRV-DB-01</td>
            <td>Normal file sharing?</td>
          </tr>
          <tr>
            <td>14:24:12</td>
            <td>Auth Logs</td>
            <td>Login to SRV-DB-01 from WS-042 (user: admin)</td>
            <td>Legitimate admin access?</td>
          </tr>
          <tr>
            <td>14:25:45</td>
            <td>Database Logs</td>
            <td>Unusual query: SELECT * FROM users</td>
            <td>Developer testing?</td>
          </tr>
        </table>

        <p style="margin-top: 20px; padding: 15px; background: rgba(244, 114, 182, 0.2); border-radius: 8px; border-left: 5px solid #f472b6;">
          <strong>Correlated Analysis:</strong> Credential theft ‚Üí Lateral movement ‚Üí Privilege escalation ‚Üí Data exfiltration. This is a <strong>critical multi-stage attack</strong> that would be missed without correlation!
        </p>
      </div>
    </div>

    <!-- Slide 2: Correlation Techniques -->
    <div class="slide" data-slide="2">
      <h2>Correlation Techniques</h2>

      <div class="log-source-grid">
        <div class="source-card">
          <h4>‚è∞ Time-Based Correlation</h4>
          <p>Link events occurring within a specific time window</p>
          <div class="code-block" style="margin-top: 15px; font-size: 0.9em;">
WITHIN 5 minutes:
  Event A ‚Üí Event B</div>
          <p style="margin-top: 10px;"><strong>Use Case:</strong> Detect rapid-fire attacks or automated exploit chains</p>
        </div>

        <div class="source-card">
          <h4>üåê IP-Based Correlation</h4>
          <p>Track all activities from a specific IP address</p>
          <div class="code-block" style="margin-top: 15px; font-size: 0.9em;">
SOURCE_IP = 203.0.113.42
  Across all systems</div>
          <p style="margin-top: 10px;"><strong>Use Case:</strong> Trace attacker movements across your infrastructure</p>
        </div>

        <div class="source-card">
          <h4>üë§ User-Based Correlation</h4>
          <p>Monitor all actions by a specific user account</p>
          <div class="code-block" style="margin-top: 15px; font-size: 0.9em;">
USERNAME = "jsmith"
  All systems, all logs</div>
          <p style="margin-top: 10px;"><strong>Use Case:</strong> Insider threat investigation or compromised credential tracking</p>
        </div>

        <div class="source-card">
          <h4>üîó Session-Based Correlation</h4>
          <p>Group events within a single session or transaction</p>
          <div class="code-block" style="margin-top: 15px; font-size: 0.9em;">
SESSION_ID = "a3f2c891"
  Login ‚Üí Actions ‚Üí Logout</div>
          <p style="margin-top: 10px;"><strong>Use Case:</strong> Understand complete user session behavior</p>
        </div>
      </div>

      <h3>Advanced Correlation Patterns</h3>

      <div class="concept-box">
        <h4 style="color: #c084fc;">Composite Correlation (Multi-Field)</h4>
        <p>Combine multiple correlation keys for precise tracking:</p>
        <div class="correlation-rule">
(<span class="rule-field">SOURCE_IP</span> <span class="rule-operator">AND</span> <span class="rule-field">USERNAME</span> <span class="rule-operator">AND</span> <span class="rule-field">DESTINATION</span>)
<span class="rule-operator">WITHIN</span> <span class="rule-value">15 minutes</span>

Example: Track user "admin" from 10.1.2.5 accessing database servers
        </div>
      </div>

      <div class="concept-box">
        <h4 style="color: #c084fc;">Behavioral Correlation</h4>
        <p>Correlate based on patterns rather than exact matches:</p>
        <div class="correlation-rule">
<span class="rule-field">Failed_Logins</span> &gt; <span class="rule-value">5</span>
<span class="rule-operator">FOLLOWED BY</span>
<span class="rule-field">Successful_Login</span>
<span class="rule-operator">FROM SAME</span> <span class="rule-field">SOURCE_IP</span>
<span class="rule-operator">WITHIN</span> <span class="rule-value">10 minutes</span>

Result: Successful brute force attack detected
        </div>
      </div>

      <div class="interactive-demo">
        <h3 style="color: #06b6d4; margin-bottom: 20px;">Interactive: Correlation Technique Selector</h3>
        <div class="demo-controls">
          <button class="demo-btn" onclick="showCorrelationExample('time')">Time-Based</button>
          <button class="demo-btn" onclick="showCorrelationExample('ip')">IP-Based</button>
          <button class="demo-btn" onclick="showCorrelationExample('user')">User-Based</button>
          <button class="demo-btn" onclick="showCorrelationExample('session')">Session-Based</button>
        </div>
        <div class="demo-output" id="correlationDemo">Click a technique above to see an example correlation...</div>
      </div>
    </div>

    <!-- Slide 3: Correlation Rules and Logic -->
    <div class="slide" data-slide="3">
      <h2>Correlation Rules and Logic</h2>

      <div class="concept-box">
        <h3>Correlation Rule Structure</h3>
        <p>Correlation rules define the logic for linking events. Think of them as "IF-THEN" statements for security events.</p>
      </div>

      <h3>Core Logical Operators</h3>

      <div class="highlight-box">
        <h4 style="color: #06b6d4;">1. AND (All conditions must be true)</h4>
        <div class="correlation-rule">
<span class="rule-operator">IF</span> (
  <span class="rule-field">event.type</span> = <span class="rule-value">"login_failure"</span> <span class="rule-operator">AND</span>
  <span class="rule-field">event.username</span> = <span class="rule-value">"admin"</span> <span class="rule-operator">AND</span>
  <span class="rule-field">event.source_ip</span> <span class="rule-operator">NOT IN</span> <span class="rule-value">trusted_ips</span>
)
<span class="rule-operator">THEN</span> alert = <span class="rule-value">"Suspicious admin login attempt"</span>
        </div>
        <p style="margin-top: 15px;"><strong>Use Case:</strong> All conditions must match for high-confidence detection</p>
      </div>

      <div class="highlight-box">
        <h4 style="color: #06b6d4;">2. OR (Any condition can be true)</h4>
        <div class="correlation-rule">
<span class="rule-operator">IF</span> (
  <span class="rule-field">event.type</span> = <span class="rule-value">"malware_detected"</span> <span class="rule-operator">OR</span>
  <span class="rule-field">event.type</span> = <span class="rule-value">"ransomware_activity"</span> <span class="rule-operator">OR</span>
  <span class="rule-field">event.type</span> = <span class="rule-value">"crypto_miner"</span>
)
<span class="rule-operator">THEN</span> severity = <span class="rule-value">"CRITICAL"</span>
        </div>
        <p style="margin-top: 15px;"><strong>Use Case:</strong> Cast a wider net for related threat indicators</p>
      </div>

      <h3>Temporal Operators (Time-Based Logic)</h3>

      <div class="correlation-visual">
        <h4 style="color: #c084fc; margin-bottom: 20px;">FOLLOWED BY (Sequence Matters)</h4>
        <div class="correlation-rule">
Event_A <span class="rule-operator">FOLLOWED BY</span> Event_B
<span class="rule-operator">WITHIN</span> <span class="rule-value">X seconds/minutes</span>

Example:
<span class="rule-field">port_scan</span> <span class="rule-operator">FOLLOWED BY</span> <span class="rule-field">exploit_attempt</span>
<span class="rule-operator">WITHIN</span> <span class="rule-value">5 minutes</span>
        </div>
        <p style="margin-top: 15px; color: #4ade80;">‚úì Port scan at 10:00, exploit at 10:03 - MATCH</p>
        <p style="color: #f472b6;">‚úó Exploit at 10:00, port scan at 10:03 - NO MATCH (wrong order)</p>
      </div>

      <div class="correlation-visual">
        <h4 style="color: #c084fc; margin-bottom: 20px;">WITHIN (Time Window)</h4>
        <div class="correlation-rule">
<span class="rule-operator">COUNT</span> (<span class="rule-field">failed_login</span>) &gt; <span class="rule-value">10</span>
<span class="rule-operator">WITHIN</span> <span class="rule-value">60 seconds</span>
<span class="rule-operator">WHERE</span> <span class="rule-field">source_ip</span> = <span class="rule-value">SAME</span>

Result: Brute force attack detected
        </div>
      </div>

      <h3>Advanced Correlation Rules</h3>

      <div class="scenario-card">
        <h4>Complex Multi-Stage Attack Detection</h4>
        <div class="correlation-rule">
<span class="rule-operator">RULE:</span> Detect Lateral Movement

<span class="rule-operator">IF</span> (
  Stage_1: <span class="rule-field">credential_access</span> detected on <span class="rule-field">host_A</span>
  <span class="rule-operator">FOLLOWED BY</span>
  Stage_2: <span class="rule-field">network_connection</span> from <span class="rule-field">host_A</span> to <span class="rule-field">host_B</span>
           <span class="rule-operator">WHERE</span> protocol = <span class="rule-value">"SMB"</span> or <span class="rule-value">"RDP"</span>
  <span class="rule-operator">FOLLOWED BY</span>
  Stage_3: <span class="rule-field">successful_login</span> on <span class="rule-field">host_B</span>
           <span class="rule-operator">WHERE</span> username <span class="rule-operator">IN</span> credentials_from_Stage_1
  <span class="rule-operator">ALL WITHIN</span> <span class="rule-value">30 minutes</span>
)
<span class="rule-operator">THEN</span>
  alert = <span class="rule-value">"CRITICAL: Lateral Movement Detected"</span>
  confidence = <span class="rule-value">"HIGH"</span>
        </div>
      </div>

      <div class="scenario-card">
        <h4>Baseline Deviation Rule</h4>
        <div class="correlation-rule">
<span class="rule-operator">RULE:</span> Unusual Access Pattern

<span class="rule-operator">IF</span> (
  <span class="rule-field">user_login_time</span> <span class="rule-operator">NOT IN</span> user_baseline_hours
  <span class="rule-operator">AND</span>
  <span class="rule-field">login_location</span> <span class="rule-operator">!=</span> user_typical_location
  <span class="rule-operator">AND</span>
  <span class="rule-field">accessed_resources</span> <span class="rule-operator">NOT IN</span> user_normal_access
)
<span class="rule-operator">THEN</span>
  alert = <span class="rule-value">"Anomalous User Behavior"</span>
  action = <span class="rule-value">"REQUIRE_MFA"</span>
        </div>
      </div>

      <table>
        <tr>
          <th>Operator</th>
          <th>Purpose</th>
          <th>Example Use Case</th>
        </tr>
        <tr>
          <td><strong>AND</strong></td>
          <td>All conditions required</td>
          <td>High-precision detection (fewer false positives)</td>
        </tr>
        <tr>
          <td><strong>OR</strong></td>
          <td>Any condition sufficient</td>
          <td>Broad threat hunting (cast wider net)</td>
        </tr>
        <tr>
          <td><strong>FOLLOWED BY</strong></td>
          <td>Sequential events</td>
          <td>Attack chain detection</td>
        </tr>
        <tr>
          <td><strong>WITHIN</strong></td>
          <td>Time constraint</td>
          <td>Rapid-fire attacks, session analysis</td>
        </tr>
        <tr>
          <td><strong>COUNT</strong></td>
          <td>Threshold detection</td>
          <td>Brute force, DDoS, scanning</td>
        </tr>
        <tr>
          <td><strong>NOT IN</strong></td>
          <td>Exclusion logic</td>
          <td>Baseline deviation, whitelist violations</td>
        </tr>
      </table>

      <div class="warning-box">
        <h3>‚ö†Ô∏è Rule Tuning Considerations</h3>
        <ul>
          <li><strong>Time Windows:</strong> Too short = missed correlations; Too long = false positives</li>
          <li><strong>Thresholds:</strong> Start conservative (fewer false positives), then adjust based on environment</li>
          <li><strong>Field Matching:</strong> Exact matches vs. fuzzy matching (case sensitivity, wildcards)</li>
          <li><strong>Performance:</strong> Complex rules with many conditions can impact SIEM performance</li>
          <li><strong>False Positives:</strong> Always test rules against historical data before deploying to production</li>
        </ul>
      </div>
    </div>

    <!-- Slide 4: Multi-Source Analysis -->
    <div class="slide" data-slide="4">
      <h2>Multi-Source Log Analysis</h2>

      <div class="concept-box">
        <h3>Why Multiple Log Sources?</h3>
        <p>No single log source provides complete visibility. Combining logs from different systems creates a comprehensive security picture.</p>
      </div>

      <h3>Primary Log Sources for Correlation</h3>

      <div class="log-source-grid">
        <div class="source-card">
          <h4>üî• Firewall Logs</h4>
          <p><strong>What they show:</strong></p>
          <ul style="font-size: 0.95em;">
            <li>Network connections (allowed/denied)</li>
            <li>Source/destination IPs and ports</li>
            <li>Protocol information</li>
            <li>Traffic volume</li>
          </ul>
          <p style="margin-top: 10px;"><strong>Correlation value:</strong> Network-level context for all other events</p>
        </div>

        <div class="source-card">
          <h4>üõ°Ô∏è IDS/IPS Logs</h4>
          <p><strong>What they show:</strong></p>
          <ul style="font-size: 0.95em;">
            <li>Signature-based attack detection</li>
            <li>Anomaly identification</li>
            <li>Exploit attempts</li>
            <li>Protocol violations</li>
          </ul>
          <p style="margin-top: 10px;"><strong>Correlation value:</strong> Intent and attack methodology</p>
        </div>

        <div class="source-card">
          <h4>üíª Endpoint/EDR Logs</h4>
          <p><strong>What they show:</strong></p>
          <ul style="font-size: 0.95em;">
            <li>Process execution</li>
            <li>File system changes</li>
            <li>Registry modifications</li>
            <li>Memory injection</li>
          </ul>
          <p style="margin-top: 10px;"><strong>Correlation value:</strong> Host-level attack details and impact</p>
        </div>

        <div class="source-card">
          <h4>üîê Authentication Logs</h4>
          <p><strong>What they show:</strong></p>
          <ul style="font-size: 0.95em;">
            <li>Login successes/failures</li>
            <li>Account lockouts</li>
            <li>Privilege escalation</li>
            <li>MFA events</li>
          </ul>
          <p style="margin-top: 10px;"><strong>Correlation value:</strong> Identity and access context</p>
        </div>

        <div class="source-card">
          <h4>üåê Web Server Logs</h4>
          <p><strong>What they show:</strong></p>
          <ul style="font-size: 0.95em;">
            <li>HTTP requests/responses</li>
            <li>Status codes</li>
            <li>User agents</li>
            <li>SQL injection attempts</li>
          </ul>
          <p style="margin-top: 10px;"><strong>Correlation value:</strong> Application-layer attack vectors</p>
        </div>

        <div class="source-card">
          <h4>üìß Email Gateway Logs</h4>
          <p><strong>What they show:</strong></p>
          <ul style="font-size: 0.95em;">
            <li>Phishing attempts</li>
            <li>Malicious attachments</li>
            <li>Spoofed senders</li>
            <li>Data exfiltration</li>
          </ul>
          <p style="margin-top: 10px;"><strong>Correlation value:</strong> Initial access vectors</p>
        </div>

        <div class="source-card">
          <h4>‚òÅÔ∏è Cloud/SaaS Logs</h4>
          <p><strong>What they show:</strong></p>
          <ul style="font-size: 0.95em;">
            <li>API calls</li>
            <li>Configuration changes</li>
            <li>Data access</li>
            <li>Permission modifications</li>
          </ul>
          <p style="margin-top: 10px;"><strong>Correlation value:</strong> Cloud infrastructure visibility</p>
        </div>

        <div class="source-card">
          <h4>üìä Database Logs</h4>
          <p><strong>What they show:</strong></p>
          <ul style="font-size: 0.95em;">
            <li>Query execution</li>
            <li>Schema changes</li>
            <li>Access patterns</li>
            <li>Data modifications</li>
          </ul>
          <p style="margin-top: 10px;"><strong>Correlation value:</strong> Data access and exfiltration</p>
        </div>
      </div>

      <h3>Multi-Source Correlation Example: Complete Attack Chain</h3>

      <div class="scenario-card">
        <h4>Scenario: Phishing ‚Üí Credential Compromise ‚Üí Data Exfiltration</h4>

        <table>
          <tr>
            <th>Time</th>
            <th>Log Source</th>
            <th>Event</th>
            <th>Attack Stage</th>
          </tr>
          <tr>
            <td>09:15:33</td>
            <td>Email Gateway</td>
            <td>Phishing email delivered to user@company.com</td>
            <td>Initial Access</td>
          </tr>
          <tr>
            <td>09:47:12</td>
            <td>Web Proxy</td>
            <td>User clicks link to malicious site (phish-site.com)</td>
            <td>User Interaction</td>
          </tr>
          <tr>
            <td>09:47:45</td>
            <td>Web Server</td>
            <td>POST to phish-site.com/harvest with credentials</td>
            <td>Credential Theft</td>
          </tr>
          <tr>
            <td>10:12:20</td>
            <td>Firewall</td>
            <td>New connection from Russia (93.184.216.34) to VPN</td>
            <td>External Access Attempt</td>
          </tr>
          <tr>
            <td>10:13:05</td>
            <td>VPN Logs</td>
            <td>Successful VPN login: user@company.com from 93.184.216.34</td>
            <td>Unauthorized Access</td>
          </tr>
          <tr>
            <td>10:15:30</td>
            <td>File Server</td>
            <td>Bulk file access by user@company.com (2.3GB in 5 min)</td>
            <td>Collection</td>
          </tr>
          <tr>
            <td>10:22:18</td>
            <td>Firewall</td>
            <td>Outbound connection to cloud storage (mega.nz)</td>
            <td>Exfiltration</td>
          </tr>
          <tr>
            <td>10:24:55</td>
            <td>DLP System</td>
            <td>Large file transfer detected: 2.3GB to external site</td>
            <td>Exfiltration Confirmed</td>
          </tr>
        </table>

        <div style="margin-top: 25px; padding: 20px; background: rgba(244, 114, 182, 0.2); border-radius: 8px; border-left: 5px solid #f472b6;">
          <h4 style="color: #f472b6;">üö® Correlation Analysis:</h4>
          <p><strong>Attack Pattern:</strong> Phishing-driven data breach</p>
          <p><strong>Time Span:</strong> 1 hour 9 minutes from initial phishing to exfiltration</p>
          <p><strong>Key Correlation:</strong> Same user account appears across 6 different log sources in suspicious sequence</p>
          <p><strong>Red Flags:</strong></p>
          <ul>
            <li>Geographic anomaly (VPN from Russia for US-based user)</li>
            <li>Timing anomaly (off-hours activity)</li>
            <li>Volume anomaly (2.3GB accessed in 5 minutes)</li>
            <li>Behavioral anomaly (never accessed these files before)</li>
          </ul>
        </div>
      </div>

      <div class="highlight-box">
        <h3>Multi-Source Correlation Best Practices</h3>
        <ul>
          <li><strong>Time Synchronization:</strong> Ensure all log sources use NTP - time drift breaks correlation</li>
          <li><strong>Common Fields:</strong> Normalize IP addresses, usernames, hostnames across sources</li>
          <li><strong>Log Completeness:</strong> Missing logs = blind spots in correlation</li>
          <li><strong>Retention Alignment:</strong> Keep all correlated sources for the same duration</li>
          <li><strong>Enrichment:</strong> Add context (GeoIP, asset ownership, user roles) to enhance correlation</li>
        </ul>
      </div>
    </div>

    <!-- Slide 5: Timeline Reconstruction -->
    <div class="slide" data-slide="5">
      <h2>Timeline Reconstruction</h2>

      <div class="concept-box">
        <h3>What is Timeline Reconstruction?</h3>
        <p><strong>Timeline Reconstruction</strong> is the process of building a chronological narrative of events from correlated logs to understand exactly what happened during a security incident.</p>
      </div>

      <h3>Why Build Timelines?</h3>
      <ul>
        <li><strong>Incident Response:</strong> Understand attack sequence and scope</li>
        <li><strong>Root Cause Analysis:</strong> Identify how the breach started</li>
        <li><strong>Legal/Compliance:</strong> Provide detailed incident documentation</li>
        <li><strong>Lessons Learned:</strong> Identify detection gaps and improve defenses</li>
      </ul>

      <h3>Timeline Reconstruction Process</h3>

      <div class="correlation-visual">
        <div class="killchain-phase">
          <h4 style="color: #c084fc;">Step 1: Event Collection</h4>
          <p>Gather all potentially relevant logs from the timeframe</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.9em;">
Time Range: 2024-03-15 08:00:00 to 2024-03-15 14:00:00
Sources: Firewall, IDS, Auth, Endpoint, Email, Web Proxy
Filter: Events related to compromised_user or attacker_ip
          </div>
        </div>

        <div class="killchain-phase">
          <h4 style="color: #c084fc;">Step 2: Time Normalization</h4>
          <p>Convert all timestamps to a common timezone and format</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.9em;">
Original: Mar 15 08:32:15 (local)
Original: 2024-03-15T13:32:15Z (UTC)
Original: 1710507135 (Unix epoch)

Normalized: 2024-03-15 08:32:15 EST
          </div>
        </div>

        <div class="killchain-phase">
          <h4 style="color: #c084fc;">Step 3: Event Sequencing</h4>
          <p>Sort events chronologically and identify causal relationships</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.9em;">
08:32:15 ‚Üí Email delivered
08:45:22 ‚Üí Link clicked
08:46:01 ‚Üí Malicious payload downloaded
08:46:15 ‚Üí Payload executed
          </div>
        </div>

        <div class="killchain-phase">
          <h4 style="color: #c084fc;">Step 4: Gap Analysis</h4>
          <p>Identify missing events or time gaps</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.9em;">
08:46:15 ‚Üí Payload executed
[30 minute gap - endpoint logging disabled?]
09:16:42 ‚Üí C2 connection established
          </div>
        </div>

        <div class="killchain-phase">
          <h4 style="color: #c084fc;">Step 5: Narrative Construction</h4>
          <p>Build human-readable attack story with technical details</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.9em;">
INCIDENT TIMELINE:
08:32 - Attacker sends phishing email
08:45 - User clicks malicious link
08:46 - Malware installed, logging disabled
09:16 - C2 channel established
          </div>
        </div>
      </div>

      <h3>Detailed Timeline Example</h3>

      <div class="scenario-card">
        <h4>Ransomware Attack Timeline Reconstruction</h4>

        <table>
          <tr>
            <th>Timestamp (EST)</th>
            <th>Source</th>
            <th>Event Details</th>
            <th>Significance</th>
          </tr>
          <tr style="background: rgba(192, 132, 252, 0.1);">
            <td><strong>Day 1</strong></td>
            <td colspan="3" style="color: #c084fc;"><strong>INITIAL COMPROMISE</strong></td>
          </tr>
          <tr>
            <td>14:23:17</td>
            <td>Email Gateway</td>
            <td>Email with invoice.zip attachment received</td>
            <td>Initial vector</td>
          </tr>
          <tr>
            <td>14:31:05</td>
            <td>Endpoint</td>
            <td>invoice.zip extracted to C:\Users\jsmith\Downloads</td>
            <td>User interaction</td>
          </tr>
          <tr>
            <td>14:31:22</td>
            <td>Endpoint</td>
            <td>invoice.exe executed by jsmith</td>
            <td>Malware execution</td>
          </tr>
          <tr>
            <td>14:31:25</td>
            <td>EDR</td>
            <td>Suspicious PowerShell: Download from 185.220.101.42</td>
            <td>Stage 2 download</td>
          </tr>
          <tr style="background: rgba(192, 132, 252, 0.1);">
            <td><strong>Day 1-7</strong></td>
            <td colspan="3" style="color: #c084fc;"><strong>PERSISTENCE & RECONNAISSANCE</strong></td>
          </tr>
          <tr>
            <td>14:32:01</td>
            <td>Endpoint</td>
            <td>Registry key added: HKLM\...\Run\WindowsUpdate</td>
            <td>Persistence established</td>
          </tr>
          <tr>
            <td>14:35:12</td>
            <td>Network</td>
            <td>Connection to 185.220.101.42:443 (C2 server)</td>
            <td>C2 communication</td>
          </tr>
          <tr>
            <td>15:12:33</td>
            <td>EDR</td>
            <td>Network enumeration: net view, nltest /dclist</td>
            <td>Environment mapping</td>
          </tr>
          <tr>
            <td>Day 2-7</td>
            <td>Network</td>
            <td>Periodic C2 beacons every 4 hours</td>
            <td>Awaiting commands</td>
          </tr>
          <tr style="background: rgba(192, 132, 252, 0.1);">
            <td><strong>Day 8</strong></td>
            <td colspan="3" style="color: #c084fc;"><strong>LATERAL MOVEMENT</strong></td>
          </tr>
          <tr>
            <td>02:15:44</td>
            <td>Auth Logs</td>
            <td>Admin account login from WS-JSMITH</td>
            <td>Privilege escalation</td>
          </tr>
          <tr>
            <td>02:18:20</td>
            <td>Network</td>
            <td>SMB connections from WS-JSMITH to 15 servers</td>
            <td>Lateral movement</td>
          </tr>
          <tr>
            <td>02:22:55</td>
            <td>File Server</td>
            <td>New file: \\FileServer\Share\update.exe</td>
            <td>Malware staging</td>
          </tr>
          <tr style="background: rgba(244, 114, 182, 0.1);">
            <td><strong>Day 8</strong></td>
            <td colspan="3" style="color: #f472b6;"><strong>ENCRYPTION EVENT</strong></td>
          </tr>
          <tr>
            <td>03:00:00</td>
            <td>Multiple</td>
            <td>update.exe executed on 47 systems simultaneously</td>
            <td>Coordinated attack</td>
          </tr>
          <tr>
            <td>03:00:15</td>
            <td>EDR</td>
            <td>Mass file modification detected (ransomware behavior)</td>
            <td>Encryption begins</td>
          </tr>
          <tr>
            <td>03:45:22</td>
            <td>File Server</td>
            <td>READ_ME.txt created in all directories</td>
            <td>Ransom note delivered</td>
          </tr>
        </table>

        <div style="margin-top: 25px; padding: 20px; background: rgba(192, 132, 252, 0.1); border-radius: 8px; border-left: 5px solid #c084fc;">
          <h4 style="color: #c084fc;">Timeline Analysis Summary:</h4>
          <ul>
            <li><strong>Dwell Time:</strong> 7 days 13 hours from initial compromise to encryption</li>
            <li><strong>Initial Access:</strong> Phishing email with malicious attachment</li>
            <li><strong>Detection Opportunities Missed:</strong>
              <ul>
                <li>Suspicious PowerShell execution (Day 1, 14:31:25)</li>
                <li>Unexpected admin login at 2 AM (Day 8, 02:15:44)</li>
                <li>Mass SMB connections (Day 8, 02:18:20)</li>
              </ul>
            </li>
            <li><strong>Critical Gap:</strong> 7-day period with minimal detectable activity (patient attacker)</li>
          </ul>
        </div>
      </div>

      <div class="warning-box">
        <h3>‚ö†Ô∏è Timeline Reconstruction Challenges</h3>
        <ul>
          <li><strong>Time Synchronization:</strong> Different systems may have clock drift (use NTP)</li>
          <li><strong>Log Gaps:</strong> Missing logs create blind spots in the timeline</li>
          <li><strong>Event Volume:</strong> Thousands of events need filtering to find relevant ones</li>
          <li><strong>Attribution:</strong> Determining which events are actually related to the incident</li>
          <li><strong>Time Zones:</strong> Logs from different geographic locations need normalization</li>
          <li><strong>Log Retention:</strong> Older events may no longer be available</li>
        </ul>
      </div>
    </div>

    <!-- Slide 6: Kill Chain Mapping -->
    <div class="slide" data-slide="6">
      <h2>Kill Chain Mapping & MITRE ATT&CK Correlation</h2>

      <div class="concept-box">
        <h3>What is Kill Chain Mapping?</h3>
        <p><strong>Kill Chain Mapping</strong> is the process of correlating security events to specific stages of an attack framework (like MITRE ATT&CK) to understand attacker tactics and techniques.</p>
      </div>

      <h3>MITRE ATT&CK Framework Overview</h3>

      <div class="killchain-viz">
        <div class="killchain-phase">
          <h4 style="color: #c084fc;">1. Reconnaissance</h4>
          <p><strong>Tactic:</strong> Gather information about the target</p>
          <p><strong>Example Logs:</strong> DNS queries, WHOIS lookups, port scans from external IPs</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
Firewall: Multiple port probes from 203.0.113.42
DNS: Excessive queries for company-domain.com subdomains
Web: Automated scanning detected (User-Agent: Nmap)
          </div>
        </div>

        <div class="killchain-phase">
          <h4 style="color: #c084fc;">2. Initial Access</h4>
          <p><strong>Tactic:</strong> Get a foothold in the environment</p>
          <p><strong>Example Logs:</strong> Phishing emails, exploited vulnerabilities, brute force successes</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
Email Gateway: Phishing email delivered
Web Server: Exploit attempt on /vulnerable-endpoint
Auth: Successful login after 50 failed attempts
          </div>
        </div>

        <div class="killchain-phase">
          <h4 style="color: #c084fc;">3. Execution</h4>
          <p><strong>Tactic:</strong> Run malicious code</p>
          <p><strong>Example Logs:</strong> Process creation, script execution, command-line activity</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
EDR: powershell.exe -enc [base64_payload]
Endpoint: cmd.exe spawned by WINWORD.EXE
Process: wscript.exe executing malicious.vbs
          </div>
        </div>

        <div class="killchain-phase">
          <h4 style="color: #c084fc;">4. Persistence</h4>
          <p><strong>Tactic:</strong> Maintain foothold across reboots</p>
          <p><strong>Example Logs:</strong> Registry changes, scheduled tasks, service creation</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
Registry: New key HKLM\...\Run\WindowsUpdate
Task Scheduler: Task created: "SystemMaintenance"
Service: New service installed: "WindowsUpdateService"
          </div>
        </div>

        <div class="killchain-phase">
          <h4 style="color: #c084fc;">5. Privilege Escalation</h4>
          <p><strong>Tactic:</strong> Gain higher-level permissions</p>
          <p><strong>Example Logs:</strong> UAC bypass, token manipulation, exploit usage</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
EDR: Mimikatz detected (credential dumping)
Auth: User added to Domain Admins group
Process: SeDebugPrivilege enabled for malicious.exe
          </div>
        </div>

        <div class="killchain-phase">
          <h4 style="color: #c084fc;">6. Defense Evasion</h4>
          <p><strong>Tactic:</strong> Avoid detection</p>
          <p><strong>Example Logs:</strong> Logging disabled, AV disabled, obfuscation</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
Security Log: Audit logging disabled
AV: Windows Defender real-time protection disabled
File: Executable hidden with system/hidden attributes
          </div>
        </div>

        <div class="killchain-phase">
          <h4 style="color: #c084fc;">7. Credential Access</h4>
          <p><strong>Tactic:</strong> Steal account credentials</p>
          <p><strong>Example Logs:</strong> LSASS access, password dumps, keylogging</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
EDR: LSASS memory dump detected
File: Access to SAM/SYSTEM registry hives
Network: NTLM hash relay attack detected
          </div>
        </div>

        <div class="killchain-phase">
          <h4 style="color: #c084fc;">8. Discovery</h4>
          <p><strong>Tactic:</strong> Learn about the environment</p>
          <p><strong>Example Logs:</strong> Network enumeration, account discovery, system info gathering</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
Process: net view, net user /domain
PowerShell: Get-ADUser, Get-ADComputer cmdlets
Network: LDAP queries for domain enumeration
          </div>
        </div>

        <div class="killchain-phase">
          <h4 style="color: #c084fc;">9. Lateral Movement</h4>
          <p><strong>Tactic:</strong> Move through the network</p>
          <p><strong>Example Logs:</strong> Remote desktop, SMB connections, PsExec usage</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
Auth: RDP login from internal workstation
Network: SMB connections to multiple servers
Process: psexec.exe \\remotehost -s cmd.exe
          </div>
        </div>

        <div class="killchain-phase">
          <h4 style="color: #c084fc;">10. Collection</h4>
          <p><strong>Tactic:</strong> Gather data of interest</p>
          <p><strong>Example Logs:</strong> File access, clipboard capture, screen capture</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
File: Bulk access to \\FileServer\Finance\*
Process: Archive created: sensitive_data.zip
Application: Unusual database queries
          </div>
        </div>

        <div class="killchain-phase">
          <h4 style="color: #c084fc;">11. Command and Control (C2)</h4>
          <p><strong>Tactic:</strong> Communicate with compromised systems</p>
          <p><strong>Example Logs:</strong> Beaconing traffic, unusual protocols, encrypted channels</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
Firewall: Periodic HTTPS to suspicious-domain.com
IDS: Cobalt Strike beacon detected
DNS: DGA (Domain Generation Algorithm) activity
          </div>
        </div>

        <div class="killchain-phase" style="border-left-color: #f472b6;">
          <h4 style="color: #f472b6;">12. Exfiltration</h4>
          <p><strong>Tactic:</strong> Steal data from the network</p>
          <p><strong>Example Logs:</strong> Large outbound transfers, cloud uploads, DNS tunneling</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
DLP: 5GB transfer to external cloud storage
Firewall: Outbound connection to Mega.nz
DNS: Excessive DNS queries (possible tunneling)
          </div>
        </div>

        <div class="killchain-phase" style="border-left-color: #f472b6;">
          <h4 style="color: #f472b6;">13. Impact</h4>
          <p><strong>Tactic:</strong> Disrupt, destroy, or manipulate systems/data</p>
          <p><strong>Example Logs:</strong> Ransomware encryption, data deletion, service disruption</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
EDR: Mass file encryption detected
System: Multiple services stopped
Event Log: Security logs cleared
          </div>
        </div>
      </div>

      <h3>Practical Kill Chain Mapping Example</h3>

      <div class="scenario-card">
        <h4>Mapping a Real Attack to MITRE ATT&CK</h4>

        <table>
          <tr>
            <th>ATT&CK Tactic</th>
            <th>Technique ID</th>
            <th>Log Evidence</th>
            <th>Timestamp</th>
          </tr>
          <tr>
            <td><strong>Initial Access</strong></td>
            <td>T1566.001 (Phishing: Spearphishing Attachment)</td>
            <td>Email Gateway: malicious.docm delivered</td>
            <td>10:15:22</td>
          </tr>
          <tr>
            <td><strong>Execution</strong></td>
            <td>T1204.002 (User Execution: Malicious File)</td>
            <td>Endpoint: WINWORD.EXE executed malicious.docm</td>
            <td>10:22:18</td>
          </tr>
          <tr>
            <td><strong>Execution</strong></td>
            <td>T1059.001 (PowerShell)</td>
            <td>EDR: powershell.exe -WindowStyle Hidden -enc [payload]</td>
            <td>10:22:25</td>
          </tr>
          <tr>
            <td><strong>Persistence</strong></td>
            <td>T1547.001 (Boot/Logon: Registry Run Keys)</td>
            <td>Registry: HKCU\...\Run\OneDriveUpdate = C:\malware.exe</td>
            <td>10:22:41</td>
          </tr>
          <tr>
            <td><strong>Defense Evasion</strong></td>
            <td>T1562.001 (Impair Defenses: Disable AV)</td>
            <td>Security: Windows Defender disabled via GPO</td>
            <td>10:23:05</td>
          </tr>
          <tr>
            <td><strong>Credential Access</strong></td>
            <td>T1003.001 (LSASS Memory)</td>
            <td>EDR: Mimikatz signature detected, LSASS dump</td>
            <td>10:25:33</td>
          </tr>
          <tr>
            <td><strong>Discovery</strong></td>
            <td>T1087.002 (Account Discovery: Domain)</td>
            <td>Process: net user /domain, net group "Domain Admins" /domain</td>
            <td>10:27:15</td>
          </tr>
          <tr>
            <td><strong>Lateral Movement</strong></td>
            <td>T1021.002 (SMB/Windows Admin Shares)</td>
            <td>Network: SMB connections to \\DC01\C$ and \\SRV-SQL\ADMIN$</td>
            <td>10:32:44</td>
          </tr>
          <tr>
            <td><strong>Collection</strong></td>
            <td>T1560.001 (Archive via Utility)</td>
            <td>Process: 7z.exe a -p -r data.7z \\FileServer\HR\*</td>
            <td>11:15:22</td>
          </tr>
          <tr>
            <td><strong>C2</strong></td>
            <td>T1071.001 (Web Protocols)</td>
            <td>Firewall: HTTPS beacons to evil-c2.com every 60 seconds</td>
            <td>10:23:00+</td>
          </tr>
          <tr>
            <td><strong>Exfiltration</strong></td>
            <td>T1041 (Exfiltration Over C2)</td>
            <td>DLP: 1.2GB uploaded to evil-c2.com</td>
            <td>11:42:18</td>
          </tr>
        </table>

        <div style="margin-top: 25px; padding: 20px; background: rgba(6, 182, 212, 0.1); border-radius: 8px; border-left: 5px solid #06b6d4;">
          <h4 style="color: #06b6d4;">Kill Chain Analysis Benefits:</h4>
          <ul>
            <li><strong>Pattern Recognition:</strong> Identify common attacker TTPs (Tactics, Techniques, Procedures)</li>
            <li><strong>Defense Prioritization:</strong> Focus on breaking the most critical kill chain stages</li>
            <li><strong>Threat Intelligence:</strong> Map to known threat actor behaviors</li>
            <li><strong>Detection Gaps:</strong> Identify stages where you have no visibility</li>
            <li><strong>Communication:</strong> Explain technical incidents to non-technical stakeholders</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Slide 7: Baseline vs Anomaly Correlation -->
    <div class="slide" data-slide="7">
      <h2>Baseline vs Anomaly Correlation</h2>

      <div class="concept-box">
        <h3>Understanding Baselines</h3>
        <p>A <strong>baseline</strong> is the normal, expected behavior of a system, user, or network. <strong>Anomaly correlation</strong> identifies deviations from this baseline that may indicate security issues.</p>
      </div>

      <h3>Types of Baselines</h3>

      <div class="log-source-grid">
        <div class="source-card">
          <h4>User Behavior Baseline</h4>
          <p><strong>Normal patterns:</strong></p>
          <ul style="font-size: 0.9em;">
            <li>Login times: Mon-Fri, 8 AM - 6 PM</li>
            <li>Login locations: Office IP range</li>
            <li>Accessed resources: Email, CRM, file shares</li>
            <li>Data volume: ~50MB/day</li>
          </ul>
          <p style="margin-top: 10px; color: #f472b6;"><strong>Anomaly:</strong> Login at 3 AM from Russia</p>
        </div>

        <div class="source-card">
          <h4>Network Traffic Baseline</h4>
          <p><strong>Normal patterns:</strong></p>
          <ul style="font-size: 0.9em;">
            <li>Peak hours: 9 AM - 5 PM</li>
            <li>Average bandwidth: 100 Mbps</li>
            <li>Common protocols: HTTP/S, DNS, SMTP</li>
            <li>Destinations: Known business sites</li>
          </ul>
          <p style="margin-top: 10px; color: #f472b6;"><strong>Anomaly:</strong> 10GB upload at midnight to unknown IP</p>
        </div>

        <div class="source-card">
          <h4>System Activity Baseline</h4>
          <p><strong>Normal patterns:</strong></p>
          <ul style="font-size: 0.9em;">
            <li>CPU usage: 20-40%</li>
            <li>Running processes: Known applications</li>
            <li>File changes: Software updates only</li>
            <li>Registry: Stable configuration</li>
          </ul>
          <p style="margin-top: 10px; color: #f472b6;"><strong>Anomaly:</strong> New process mining cryptocurrency</p>
        </div>

        <div class="source-card">
          <h4>Application Access Baseline</h4>
          <p><strong>Normal patterns:</strong></p>
          <ul style="font-size: 0.9em;">
            <li>Database queries: 50-100/hour</li>
            <li>Query types: SELECT from specific tables</li>
            <li>Access times: Business hours</li>
            <li>Users: Specific application accounts</li>
          </ul>
          <p style="margin-top: 10px; color: #f472b6;"><strong>Anomaly:</strong> SELECT * FROM all_tables at 2 AM</p>
        </div>
      </div>

      <h3>Baseline Correlation Examples</h3>

      <div class="scenario-card">
        <h4>Example 1: Anomalous Login Pattern</h4>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
          <div style="background: rgba(74, 222, 128, 0.1); padding: 20px; border-radius: 8px; border-left: 5px solid #4ade80;">
            <h4 style="color: #4ade80;">Normal Baseline (30 days)</h4>
            <table style="font-size: 0.9em;">
              <tr><td><strong>Login Times:</strong></td><td>8:15 AM - 5:45 PM</td></tr>
              <tr><td><strong>Login Days:</strong></td><td>Mon-Fri</td></tr>
              <tr><td><strong>Source IPs:</strong></td><td>10.10.50.0/24 (Office)</td></tr>
              <tr><td><strong>Avg Sessions:</strong></td><td>1 per day</td></tr>
              <tr><td><strong>Failed Logins:</strong></td><td>0-1 per week</td></tr>
            </table>
          </div>

          <div style="background: rgba(244, 114, 182, 0.1); padding: 20px; border-radius: 8px; border-left: 5px solid #f472b6;">
            <h4 style="color: #f472b6;">Anomalous Activity (Today)</h4>
            <table style="font-size: 0.9em;">
              <tr><td><strong>Login Time:</strong></td><td>2:37 AM (Sunday)</td></tr>
              <tr><td><strong>Source IP:</strong></td><td>185.220.101.42 (Russia)</td></tr>
              <tr><td><strong>Failed Attempts:</strong></td><td>47 in 3 minutes</td></tr>
              <tr><td><strong>Then:</strong></td><td>Successful login</td></tr>
              <tr><td><strong>Action:</strong></td><td>Downloaded 500MB data</td></tr>
            </table>
          </div>
        </div>

        <div class="correlation-rule">
<span class="rule-operator">CORRELATION RULE:</span> Baseline Deviation Alert

<span class="rule-operator">IF</span> (
  <span class="rule-field">login_hour</span> <span class="rule-operator">NOT IN</span> user_baseline_hours <span class="rule-operator">AND</span>
  <span class="rule-field">source_ip</span> <span class="rule-operator">NOT IN</span> user_baseline_ips <span class="rule-operator">AND</span>
  <span class="rule-field">failed_attempts</span> &gt; user_baseline_avg_failures * <span class="rule-value">10</span>
)
<span class="rule-operator">THEN</span>
  severity = <span class="rule-value">"CRITICAL"</span>
  alert = <span class="rule-value">"Account compromise suspected"</span>
  action = <span class="rule-value">"DISABLE_ACCOUNT, NOTIFY_SOC"</span>
        </div>
      </div>

      <div class="scenario-card">
        <h4>Example 2: Data Exfiltration Detection via Volume Baseline</h4>

        <table>
          <tr>
            <th>User</th>
            <th>30-Day Avg (MB/day)</th>
            <th>Std Deviation</th>
            <th>Today's Volume</th>
            <th>Deviation Factor</th>
          </tr>
          <tr>
            <td>alice@company.com</td>
            <td>45 MB</td>
            <td>¬±12 MB</td>
            <td>52 MB</td>
            <td>0.6œÉ (Normal)</td>
          </tr>
          <tr>
            <td>bob@company.com</td>
            <td>120 MB</td>
            <td>¬±25 MB</td>
            <td>105 MB</td>
            <td>-0.6œÉ (Normal)</td>
          </tr>
          <tr style="background: rgba(244, 114, 182, 0.2);">
            <td>charlie@company.com</td>
            <td>35 MB</td>
            <td>¬±8 MB</td>
            <td>2,400 MB</td>
            <td>295œÉ (CRITICAL!)</td>
          </tr>
        </table>

        <p style="margin-top: 20px; padding: 15px; background: rgba(244, 114, 182, 0.2); border-radius: 8px;">
          <strong>Correlation Analysis:</strong> Charlie's data transfer is 295 standard deviations above normal - statistically impossible for legitimate activity. Further investigation reveals bulk download of customer database at 3:15 AM, immediately before resignation submission.
        </p>
      </div>

      <h3>Building Effective Baselines</h3>

      <div class="highlight-box">
        <h4>Best Practices for Baseline Creation</h4>
        <ul>
          <li><strong>Sufficient Data:</strong> Collect at least 30 days of normal activity (90+ days ideal)</li>
          <li><strong>Clean Data:</strong> Exclude known incidents from baseline calculation</li>
          <li><strong>Multiple Dimensions:</strong> Time of day, day of week, volume, source, destination</li>
          <li><strong>User Segmentation:</strong> Different baselines for developers vs. accountants vs. executives</li>
          <li><strong>Regular Updates:</strong> Recalculate baselines monthly to adapt to legitimate changes</li>
          <li><strong>Seasonal Adjustment:</strong> Account for end-of-quarter spikes, holiday patterns, etc.</li>
          <li><strong>Statistical Methods:</strong> Use mean + standard deviation, percentiles (95th, 99th)</li>
        </ul>
      </div>

      <div class="correlation-visual">
        <h4 style="color: #c084fc; margin-bottom: 20px;">Multi-Dimensional Baseline Example</h4>
        <div class="code-block">
<span class="rule-field">User:</span> jsmith@company.com
<span class="rule-field">Role:</span> Finance Manager

<span class="rule-operator">BASELINE PROFILE:</span>
  <span class="rule-field">Work Hours:</span> Mon-Fri 7:30 AM - 6:00 PM EST
  <span class="rule-field">Login Locations:</span>
    - Office (10.10.50.0/24): 90% of logins
    - VPN (remote): 10% of logins (usually evenings)
  <span class="rule-field">Typical Resources:</span>
    - Email: 200-300 emails/day
    - Financial DB: 50-80 queries/day
    - File shares: \\FinanceShare (20-30 files/day)
  <span class="rule-field">Data Volume:</span>
    - Download: 150 MB/day (¬±40 MB)
    - Upload: 50 MB/day (¬±15 MB)
  <span class="rule-field">Applications:</span>
    - Excel, SAP, Outlook, Chrome
  <span class="rule-field">Never Accessed:</span>
    - Developer tools, administrative consoles, HR systems

<span class="rule-operator">ANOMALY TRIGGERS:</span>
  - Login outside work hours (except known VPN pattern)
  - Login from non-US IP
  - Access to never-accessed resources
  - Data volume &gt; 3 standard deviations
  - Use of unapproved applications
  - Multiple failed login attempts (baseline: 0-1/month)
        </div>
      </div>

      <div class="warning-box">
        <h3>‚ö†Ô∏è Baseline Pitfalls to Avoid</h3>
        <ul>
          <li><strong>Stale Baselines:</strong> Not updating baselines leads to false positives as legitimate behavior changes</li>
          <li><strong>Insufficient Data:</strong> Baselines from only 7 days may not capture weekly/monthly patterns</li>
          <li><strong>Including Anomalies:</strong> If your baseline period includes attacks, you normalize malicious behavior</li>
          <li><strong>Overfitting:</strong> Baselines that are too narrow generate excessive false positives</li>
          <li><strong>Ignoring Context:</strong> End-of-quarter financial processing looks like an anomaly but is expected</li>
          <li><strong>One-Size-Fits-All:</strong> Using the same baseline for all users ignores role-based behavior differences</li>
        </ul>
      </div>
    </div>

    <!-- Slide 8: Common Correlation Scenarios -->
    <div class="slide" data-slide="8">
      <h2>Common Correlation Scenarios</h2>

      <div class="scenario-card">
        <h4>Scenario 1: Brute Force ‚Üí Successful Login ‚Üí Lateral Movement</h4>

        <div class="timeline-viz" style="flex-direction: column; align-items: stretch;">
          <div class="event-box">
            <strong>Phase 1: Brute Force Attack (10:15 - 10:32)</strong><br>
            Auth Logs: 247 failed SSH login attempts for "admin" from 203.0.113.42
          </div>
          <div class="arrow" style="transform: rotate(90deg);">‚Üì</div>
          <div class="event-box">
            <strong>Phase 2: Successful Compromise (10:32:44)</strong><br>
            Auth Logs: Successful SSH login for "admin" from 203.0.113.42
          </div>
          <div class="arrow" style="transform: rotate(90deg);">‚Üì</div>
          <div class="event-box">
            <strong>Phase 3: Lateral Movement (10:35 - 10:52)</strong><br>
            Network Logs: SSH connections from compromised host to 12 internal servers<br>
            Auth Logs: Same "admin" credential used on multiple systems
          </div>
        </div>

        <div class="correlation-rule">
<span class="rule-operator">CORRELATION RULE:</span>

<span class="rule-operator">IF</span> (
  <span class="rule-operator">COUNT</span>(<span class="rule-field">failed_login</span>) &gt; <span class="rule-value">50</span> <span class="rule-operator">WITHIN</span> <span class="rule-value">30 minutes</span>
  <span class="rule-operator">WHERE</span> <span class="rule-field">source_ip</span> = <span class="rule-value">SAME</span> <span class="rule-operator">AND</span> <span class="rule-field">username</span> = <span class="rule-value">SAME</span>

  <span class="rule-operator">FOLLOWED BY</span>

  <span class="rule-field">successful_login</span>
  <span class="rule-operator">WHERE</span> <span class="rule-field">source_ip</span> = <span class="rule-value">SAME</span> <span class="rule-operator">AND</span> <span class="rule-field">username</span> = <span class="rule-value">SAME</span>
  <span class="rule-operator">WITHIN</span> <span class="rule-value">5 minutes</span> of last failed attempt

  <span class="rule-operator">FOLLOWED BY</span>

  <span class="rule-operator">COUNT</span>(<span class="rule-field">internal_connections</span>) &gt; <span class="rule-value">5</span>
  <span class="rule-operator">WHERE</span> <span class="rule-field">source_host</span> = compromised_system
  <span class="rule-operator">WITHIN</span> <span class="rule-value">30 minutes</span>
)
<span class="rule-operator">THEN</span>
  alert = <span class="rule-value">"CRITICAL: Successful brute force with lateral movement"</span>
  mitre_tactic = <span class="rule-value">"T1110 (Brute Force), T1021 (Lateral Movement)"</span>
        </div>
      </div>

      <div class="scenario-card">
        <h4>Scenario 2: Malware Execution ‚Üí C2 Communication ‚Üí Data Exfiltration</h4>

        <table>
          <tr>
            <th>Time</th>
            <th>Source</th>
            <th>Event</th>
            <th>Indicator</th>
          </tr>
          <tr>
            <td>14:22:15</td>
            <td>Email</td>
            <td>Attachment "invoice.exe" delivered</td>
            <td>Suspicious file extension</td>
          </tr>
          <tr>
            <td>14:35:44</td>
            <td>Endpoint</td>
            <td>invoice.exe executed from Downloads folder</td>
            <td>Execution from temp location</td>
          </tr>
          <tr>
            <td>14:35:48</td>
            <td>Firewall</td>
            <td>Outbound connection to 185.220.101.42:443</td>
            <td>New external connection</td>
          </tr>
          <tr>
            <td>14:35:50</td>
            <td>IDS</td>
            <td>Cobalt Strike beacon detected</td>
            <td>Known C2 framework</td>
          </tr>
          <tr>
            <td>14:36+</td>
            <td>Network</td>
            <td>Periodic HTTPS beacons every 60 seconds</td>
            <td>C2 heartbeat pattern</td>
          </tr>
          <tr>
            <td>15:22:33</td>
            <td>File Access</td>
            <td>Bulk file access: 1,247 files in 8 minutes</td>
            <td>Abnormal access pattern</td>
          </tr>
          <tr>
            <td>15:31:10</td>
            <td>DLP</td>
            <td>3.2GB upload to 185.220.101.42</td>
            <td>Large outbound transfer</td>
          </tr>
        </table>

        <p style="margin-top: 20px; padding: 15px; background: rgba(192, 132, 252, 0.1); border-radius: 8px;">
          <strong>Correlation Insight:</strong> The execution event, C2 communication, and exfiltration are all linked by the same process (invoice.exe) and destination IP. Without correlation, these might appear as separate, lower-severity events.
        </p>
      </div>

      <div class="scenario-card">
        <h4>Scenario 3: Privileged Account Abuse</h4>

        <div class="correlation-visual">
          <h4 style="color: #c084fc;">Normal Admin Activity vs. Compromised Admin</h4>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
            <div>
              <h5 style="color: #4ade80;">Legitimate Admin (baseline)</h5>
              <ul style="font-size: 0.9em;">
                <li>Login: Business hours only</li>
                <li>Actions: Planned changes with tickets</li>
                <li>Systems: Manages specific servers</li>
                <li>Duration: Focused sessions (30-60 min)</li>
                <li>MFA: Always required and used</li>
              </ul>
            </div>
            <div>
              <h5 style="color: #f472b6;">Compromised Admin (anomaly)</h5>
              <ul style="font-size: 0.9em;">
                <li>Login: 3:15 AM (unusual)</li>
                <li>Actions: No change tickets</li>
                <li>Systems: Accessed unusual systems (DB, DC)</li>
                <li>Duration: 6+ hour session</li>
                <li>MFA: Bypassed (stolen session token)</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="correlation-rule">
<span class="rule-operator">PRIVILEGED ACCOUNT CORRELATION:</span>

<span class="rule-operator">IF</span> (
  <span class="rule-field">account_type</span> = <span class="rule-value">"administrator"</span> <span class="rule-operator">AND</span>
  (
    <span class="rule-field">login_time</span> <span class="rule-operator">NOT IN</span> admin_normal_hours <span class="rule-operator">OR</span>
    <span class="rule-field">source_ip</span> <span class="rule-operator">NOT IN</span> admin_approved_ips <span class="rule-operator">OR</span>
    <span class="rule-field">accessed_systems</span> <span class="rule-operator">NOT IN</span> admin_responsibility_scope <span class="rule-operator">OR</span>
    <span class="rule-field">session_duration</span> &gt; <span class="rule-value">4 hours</span> <span class="rule-operator">OR</span>
    <span class="rule-field">mfa_status</span> = <span class="rule-value">"bypassed"</span>
  )
  <span class="rule-operator">AND</span>
  <span class="rule-field">change_ticket</span> = <span class="rule-value">NULL</span>
)
<span class="rule-operator">THEN</span>
  alert = <span class="rule-value">"Suspicious privileged account activity"</span>
  action = <span class="rule-value">"REQUIRE_ADDITIONAL_AUTH, NOTIFY_SECURITY"</span>
        </div>
      </div>

      <div class="scenario-card">
        <h4>Scenario 4: Insider Threat - Pre-Departure Data Theft</h4>

        <div class="timeline-viz" style="flex-direction: column; align-items: stretch;">
          <div class="event-box">
            <strong>Week 1: Behavioral Changes</strong><br>
            - HR System: Resignation submitted<br>
            - File Access: 300% increase in document downloads<br>
            - Email: Forwarding rules created to personal email
          </div>
          <div class="arrow" style="transform: rotate(90deg);">‚Üì</div>
          <div class="event-box">
            <strong>Week 2: Data Collection</strong><br>
            - File Server: Accessed competitor-sensitive files (never accessed before)<br>
            - Cloud: Uploaded 15GB to personal Dropbox<br>
            - USB: External drive connected (policy violation)
          </div>
          <div class="arrow" style="transform: rotate(90deg);">‚Üì</div>
          <div class="event-box">
            <strong>Last Day: Final Exfiltration</strong><br>
            - Print: Printed 200 pages of confidential documents<br>
            - Email: Sent large attachments to personal email<br>
            - File Access: Copied entire project folder to USB
          </div>
        </div>

        <div class="correlation-rule">
<span class="rule-operator">INSIDER THREAT CORRELATION:</span>

<span class="rule-operator">IF</span> (
  <span class="rule-field">hr_status</span> = <span class="rule-value">"termination_pending"</span> or <span class="rule-value">"resignation_submitted"</span>
  <span class="rule-operator">AND</span>
  (
    <span class="rule-field">file_downloads</span> &gt; user_baseline * <span class="rule-value">2</span> <span class="rule-operator">OR</span>
    <span class="rule-field">email_forwarding</span> to external_domain <span class="rule-operator">OR</span>
    <span class="rule-field">usb_device</span> connected <span class="rule-operator">OR</span>
    <span class="rule-field">cloud_uploads</span> to personal_account <span class="rule-operator">OR</span>
    <span class="rule-field">accessed_resources</span> <span class="rule-operator">NOT IN</span> user_baseline_resources
  )
  <span class="rule-operator">WITHIN</span> <span class="rule-value">30 days</span> of termination_date
)
<span class="rule-operator">THEN</span>
  alert = <span class="rule-value">"CRITICAL: Potential insider data theft"</span>
  action = <span class="rule-value">"DISABLE_EXTERNAL_ACCESS, NOTIFY_LEGAL, MONITOR_CLOSELY"</span>
        </div>
      </div>

      <div class="scenario-card">
        <h4>Scenario 5: Web Application Attack Chain</h4>

        <table>
          <tr>
            <th>Phase</th>
            <th>Log Source</th>
            <th>Event</th>
            <th>Attack Technique</th>
          </tr>
          <tr>
            <td>Reconnaissance</td>
            <td>Web Server</td>
            <td>Multiple 404 errors, directory enumeration</td>
            <td>Discovery</td>
          </tr>
          <tr>
            <td>Scanning</td>
            <td>IDS</td>
            <td>Nikto/SQLMap user agent detected</td>
            <td>Automated scanning</td>
          </tr>
          <tr>
            <td>Exploitation</td>
            <td>Web Server</td>
            <td>SQL injection in login form: ' OR '1'='1</td>
            <td>SQLi authentication bypass</td>
          </tr>
          <tr>
            <td>Access</td>
            <td>Application</td>
            <td>Admin dashboard accessed without authentication</td>
            <td>Unauthorized access</td>
          </tr>
          <tr>
            <td>Actions</td>
            <td>Database</td>
            <td>UNION SELECT on users table</td>
            <td>Data enumeration</td>
          </tr>
          <tr>
            <td>Escalation</td>
            <td>Database</td>
            <td>INTO OUTFILE /var/www/html/shell.php</td>
            <td>Web shell upload</td>
          </tr>
          <tr>
            <td>Persistence</td>
            <td>Web Server</td>
            <td>POST to shell.php with system commands</td>
            <td>Remote code execution</td>
          </tr>
        </table>

        <div class="correlation-rule">
<span class="rule-operator">WEB ATTACK CHAIN CORRELATION:</span>

<span class="rule-operator">IF</span> (
  <span class="rule-operator">COUNT</span>(<span class="rule-field">404_errors</span>) &gt; <span class="rule-value">100</span> <span class="rule-operator">FROM SAME</span> <span class="rule-field">source_ip</span>
  <span class="rule-operator">WITHIN</span> <span class="rule-value">10 minutes</span>

  <span class="rule-operator">FOLLOWED BY</span>

  <span class="rule-field">sqli_pattern</span> detected <span class="rule-operator">IN</span> web_logs
  <span class="rule-operator">FROM SAME</span> <span class="rule-field">source_ip</span>

  <span class="rule-operator">FOLLOWED BY</span>

  (<span class="rule-field">admin_access</span> <span class="rule-operator">WITHOUT</span> auth_log_entry <span class="rule-operator">OR</span>
   <span class="rule-field">unusual_database_query</span> <span class="rule-operator">OR</span>
   <span class="rule-field">file_write</span> to web_directory)

  <span class="rule-operator">ALL WITHIN</span> <span class="rule-value">60 minutes</span>
)
<span class="rule-operator">THEN</span>
  alert = <span class="rule-value">"CRITICAL: Web application compromise in progress"</span>
  action = <span class="rule-value">"BLOCK_SOURCE_IP, ISOLATE_WEB_SERVER, INCIDENT_RESPONSE"</span>
        </div>
      </div>
    </div>

    <!-- Slide 9: Correlation Challenges -->
    <div class="slide" data-slide="9">
      <h2>Correlation Challenges and Solutions</h2>

      <div class="log-source-grid">
        <div class="source-card">
          <h4>Challenge 1: Time Synchronization</h4>
          <p><strong>Problem:</strong> Logs from different sources have different timestamps due to clock drift.</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
Firewall: 10:32:15
Server: 10:28:42 (4 min behind)
Workstation: 10:35:01 (3 min ahead)

Result: Events appear out of order!
          </div>
          <p style="margin-top: 10px;"><strong>Solution:</strong></p>
          <ul style="font-size: 0.9em;">
            <li>Implement NTP on all devices</li>
            <li>Use SIEM normalization to account for known drift</li>
            <li>Add time tolerance to correlation windows</li>
          </ul>
        </div>

        <div class="source-card">
          <h4>Challenge 2: Log Volume Overload</h4>
          <p><strong>Problem:</strong> Enterprise environments generate millions of events per second.</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
Daily log volume: 50TB
Events per second: 500,000
Correlation processing: Can't keep up!
          </div>
          <p style="margin-top: 10px;"><strong>Solution:</strong></p>
          <ul style="font-size: 0.9em;">
            <li>Pre-filter low-value events</li>
            <li>Use tiered correlation (quick rules first)</li>
            <li>Index and optimize SIEM performance</li>
            <li>Correlate on aggregated data, not every event</li>
          </ul>
        </div>

        <div class="source-card">
          <h4>Challenge 3: Missing Log Data</h4>
          <p><strong>Problem:</strong> Logs are incomplete or unavailable.</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
Scenario: Attack detected on Server A
Problem: Server A logging disabled
         by attacker at 10:15
Gap: All activity from 10:15-12:00 missing
          </div>
          <p style="margin-top: 10px;"><strong>Solution:</strong></p>
          <ul style="font-size: 0.9em;">
            <li>Implement log forwarding (real-time to SIEM)</li>
            <li>Protect logging infrastructure</li>
            <li>Alert on logging failures</li>
            <li>Use network flow data as backup</li>
          </ul>
        </div>

        <div class="source-card">
          <h4>Challenge 4: Field Normalization</h4>
          <p><strong>Problem:</strong> Different log formats use different field names for the same data.</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
Firewall: src_ip=192.168.1.100
IDS: source_address=192.168.1.100
Auth: client_ip=192.168.1.100

Can't correlate without normalization!
          </div>
          <p style="margin-top: 10px;"><strong>Solution:</strong></p>
          <ul style="font-size: 0.9em;">
            <li>Use SIEM parsing and normalization</li>
            <li>Map all sources to common schema (ECS, OCSF)</li>
            <li>Create field aliases</li>
          </ul>
        </div>

        <div class="source-card">
          <h4>Challenge 5: False Positives</h4>
          <p><strong>Problem:</strong> Correlation rules trigger on legitimate activity.</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
Alert: "Brute force detected"
Reality: User forgot password,
         tried 6 times legitimately
          </div>
          <p style="margin-top: 10px;"><strong>Solution:</strong></p>
          <ul style="font-size: 0.9em;">
            <li>Tune thresholds based on environment</li>
            <li>Add whitelist exceptions (known IPs, users)</li>
            <li>Require multiple indicators (not just one)</li>
            <li>Incorporate context (time, location, behavior)</li>
          </ul>
        </div>

        <div class="source-card">
          <h4>Challenge 6: Context Deficiency</h4>
          <p><strong>Problem:</strong> Logs lack context needed for accurate correlation.</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
Log: Connection to 93.184.216.34
Question: Is this IP malicious?
Missing: Threat intel, GeoIP, reputation
          </div>
          <p style="margin-top: 10px;"><strong>Solution:</strong></p>
          <ul style="font-size: 0.9em;">
            <li>Enrich logs with threat intelligence</li>
            <li>Add GeoIP, WHOIS, DNS data</li>
            <li>Include asset context (criticality, owner)</li>
            <li>Add user context (role, department)</li>
          </ul>
        </div>

        <div class="source-card">
          <h4>Challenge 7: Time Window Selection</h4>
          <p><strong>Problem:</strong> Choosing the right correlation time window.</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
Too short (30 sec): Miss slow attacks
Too long (24 hours): Too many false positives
          </div>
          <p style="margin-top: 10px;"><strong>Solution:</strong></p>
          <ul style="font-size: 0.9em;">
            <li>Use attack-specific windows (brute force: 5 min; APT: days)</li>
            <li>Dynamic windows based on baseline</li>
            <li>Test against historical incidents</li>
          </ul>
        </div>

        <div class="source-card">
          <h4>Challenge 8: Multi-Stage Attacks</h4>
          <p><strong>Problem:</strong> Long-duration attacks with weeks between stages.</p>
          <div class="code-block" style="margin-top: 10px; font-size: 0.85em;">
Day 1: Initial compromise
Day 15: Credential theft
Day 30: Lateral movement
Day 45: Exfiltration

Correlation window: 45 days?!
          </div>
          <p style="margin-top: 10px;"><strong>Solution:</strong></p>
          <ul style="font-size: 0.9em;">
            <li>Use stateful correlation (track over time)</li>
            <li>Create "case files" linking related events</li>
            <li>Tag known compromised assets</li>
            <li>Monitor known IOCs long-term</li>
          </ul>
        </div>
      </div>

      <div class="highlight-box">
        <h3>Best Practices for Overcoming Correlation Challenges</h3>
        <ol>
          <li><strong>Start Simple:</strong> Begin with high-value, simple correlation rules before complex multi-stage detection</li>
          <li><strong>Iterative Tuning:</strong> Continuously refine rules based on false positive feedback</li>
          <li><strong>Document Baselines:</strong> Maintain documented baselines for normal activity in your environment</li>
          <li><strong>Prioritize Quality:</strong> Better to correlate fewer high-quality logs than all noisy logs</li>
          <li><strong>Test Before Deploying:</strong> Run new correlation rules against historical data first</li>
          <li><strong>Use Threat Intelligence:</strong> Integrate external IOC feeds to add context</li>
          <li><strong>Monitor Correlation Health:</strong> Alert when correlation sources go offline or lag</li>
          <li><strong>Regular Review:</strong> Monthly review of correlation rules to remove outdated ones</li>
        </ol>
      </div>

      <div class="warning-box">
        <h3>‚ö†Ô∏è Common Mistakes in Log Correlation</h3>
        <ul>
          <li><strong>Over-Correlation:</strong> Creating rules so complex they never trigger or are too slow</li>
          <li><strong>Under-Correlation:</strong> Not correlating enough sources, missing attack context</li>
          <li><strong>Ignoring False Positives:</strong> Alert fatigue leads to ignoring real threats</li>
          <li><strong>Static Rules:</strong> Not adapting rules as environment and threats evolve</li>
          <li><strong>No Prioritization:</strong> Treating all alerts equally instead of risk-based triage</li>
          <li><strong>Insufficient Testing:</strong> Deploying untested rules that generate noise</li>
          <li><strong>Correlation Without Context:</strong> Not enriching events with threat intel, asset data, etc.</li>
        </ul>
      </div>
    </div>

    <!-- Slide 10: Summary and Completion -->
    <div class="slide" data-slide="10">
      <h2>Log Correlation Mastery: Summary</h2>

      <div class="concept-box">
        <h3>Key Takeaways</h3>
        <p>You've learned the essential skills for correlating security events across multiple log sources to detect sophisticated attacks.</p>
      </div>

      <div class="log-source-grid" style="grid-template-columns: 1fr 1fr;">
        <div class="source-card">
          <h4>Core Concepts Mastered</h4>
          <ul style="font-size: 0.95em;">
            <li>‚úì Log correlation fundamentals</li>
            <li>‚úì Time, IP, user, and session-based correlation</li>
            <li>‚úì Correlation rule logic (AND, OR, FOLLOWED BY, WITHIN)</li>
            <li>‚úì Multi-source analysis techniques</li>
            <li>‚úì Timeline reconstruction</li>
            <li>‚úì MITRE ATT&CK kill chain mapping</li>
            <li>‚úì Baseline vs. anomaly detection</li>
            <li>‚úì Common attack scenarios</li>
            <li>‚úì Correlation challenges and solutions</li>
          </ul>
        </div>

        <div class="source-card">
          <h4>Practical Skills Gained</h4>
          <ul style="font-size: 0.95em;">
            <li>‚úì Writing effective correlation rules</li>
            <li>‚úì Building attack timelines from logs</li>
            <li>‚úì Identifying multi-stage attacks</li>
            <li>‚úì Detecting lateral movement</li>
            <li>‚úì Recognizing baseline deviations</li>
            <li>‚úì Correlating across log sources</li>
            <li>‚úì Reducing false positives</li>
            <li>‚úì Mapping events to attack frameworks</li>
            <li>‚úì Investigating security incidents</li>
          </ul>
        </div>
      </div>

      <h3>Real-World Application</h3>

      <div class="scenario-card">
        <h4>How SOC Analysts Use Log Correlation Daily</h4>
        <table>
          <tr>
            <th>Task</th>
            <th>Correlation Technique</th>
            <th>Impact</th>
          </tr>
          <tr>
            <td>Alert Triage</td>
            <td>Correlate alert with related events for context</td>
            <td>Faster incident qualification</td>
          </tr>
          <tr>
            <td>Incident Investigation</td>
            <td>Build timeline from multiple log sources</td>
            <td>Complete attack understanding</td>
          </tr>
          <tr>
            <td>Threat Hunting</td>
            <td>Look for anomaly patterns across systems</td>
            <td>Proactive threat detection</td>
          </tr>
          <tr>
            <td>Compromise Assessment</td>
            <td>Track attacker movements via IOC correlation</td>
            <td>Determine breach scope</td>
          </tr>
          <tr>
            <td>Tuning Detection</td>
            <td>Analyze false positives, refine rules</td>
            <td>Improved signal-to-noise ratio</td>
          </tr>
        </table>
      </div>

      <div class="highlight-box">
        <h3>CySA+ Exam Alignment</h3>
        <p>This module covers key CySA+ (Cybersecurity Analyst) exam objectives:</p>
        <ul>
          <li><strong>Domain 1:</strong> Threat and Vulnerability Management - Analyzing threat intelligence and IOCs</li>
          <li><strong>Domain 2:</strong> Software and Systems Security - Log analysis and correlation</li>
          <li><strong>Domain 3:</strong> Security Operations and Monitoring - SIEM correlation rules, incident detection</li>
          <li><strong>Domain 4:</strong> Incident Response - Timeline reconstruction, root cause analysis</li>
        </ul>
      </div>

      <div class="correlation-visual">
        <h4 style="color: #c084fc; margin-bottom: 20px;">Your Correlation Journey</h4>
        <div class="killchain-phase">
          <h4 style="color: #06b6d4;">Next Steps: Continue Learning</h4>
          <ul>
            <li><strong>Practice:</strong> Complete the Log Correlation Lab to apply these concepts hands-on</li>
            <li><strong>Test:</strong> Take the correlation quiz to verify your knowledge</li>
            <li><strong>Experiment:</strong> Use the Correlation Engine tool to visualize event relationships</li>
            <li><strong>Study:</strong> Review MITRE ATT&CK framework for real-world TTPs</li>
            <li><strong>Build:</strong> Create correlation rules for your own environment</li>
          </ul>
        </div>
      </div>

      <div class="progress-tracker">
        <h3 style="color: #06b6d4;">Module Completion</h3>
        <p>You've completed the Log Correlation presentation!</p>
        <div class="progress-bar">
          <div class="progress-fill" style="width: 100%;">100% Complete</div>
        </div>
        <button class="complete-btn" onclick="completeModule()">Mark Module Complete</button>
        <p style="margin-top: 20px; font-size: 0.95em;">Completing this module will award you Eye House points and unlock the next challenge.</p>
      </div>

      <div class="warning-box">
        <h3>Continue Your Eye House Journey</h3>
        <p><strong>Recommended Next Steps:</strong></p>
        <ol>
          <li><strong>Correlation Lab:</strong> Apply correlation techniques in simulated scenarios</li>
          <li><strong>Correlation Quiz:</strong> Test your knowledge with 10 challenging questions</li>
          <li><strong>Correlation Engine Tool:</strong> Experiment with interactive correlation visualizations</li>
          <li><strong>Advanced Topics:</strong> Explore behavioral analytics, machine learning correlation, UEBA</li>
        </ol>
      </div>
    </div>

    <div class="nav-footer">
      <button onclick="previousSlide()" id="prevBtn">‚Üê Previous</button>
      <button onclick="nextSlide()" id="nextBtn">Next ‚Üí</button>
    </div>
  </div>

  <script>
    let currentSlide = 1;
    const totalSlides = 10;

    function showSlide(n) {
      const slides = document.querySelectorAll('.slide');
      const navButtons = document.querySelectorAll('.nav-btn');

      if (n > totalSlides) currentSlide = totalSlides;
      if (n < 1) currentSlide = 1;

      slides.forEach(slide => slide.classList.remove('active'));
      navButtons.forEach(btn => btn.classList.remove('active'));

      slides[currentSlide - 1].classList.add('active');
      navButtons[currentSlide - 1].classList.add('active');

      document.getElementById('prevBtn').disabled = currentSlide === 1;
      document.getElementById('nextBtn').disabled = currentSlide === totalSlides;

      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function nextSlide() {
      currentSlide++;
      showSlide(currentSlide);
    }

    function previousSlide() {
      currentSlide--;
      showSlide(currentSlide);
    }

    function goToSlide(n) {
      currentSlide = n;
      showSlide(currentSlide);
    }

    function createNavButtons() {
      const navContainer = document.getElementById('slideNav');
      const slideTopics = [
        'Introduction',
        'Techniques',
        'Rules & Logic',
        'Multi-Source',
        'Timeline',
        'Kill Chain',
        'Baselines',
        'Scenarios',
        'Challenges',
        'Summary'
      ];

      slideTopics.forEach((topic, index) => {
        const btn = document.createElement('button');
        btn.className = 'nav-btn';
        if (index === 0) btn.classList.add('active');
        btn.textContent = `${index + 1}. ${topic}`;
        btn.onclick = () => goToSlide(index + 1);
        navContainer.appendChild(btn);
      });
    }

    function showCorrelationExample(type) {
      const output = document.getElementById('correlationDemo');
      const buttons = document.querySelectorAll('#correlationDemo').parentElement.querySelectorAll('.demo-btn');
      buttons.forEach(b => b.classList.remove('active'));
      event.target.classList.add('active');

      const examples = {
        time: `TIME-BASED CORRELATION EXAMPLE:

SCENARIO: Rapid attack sequence detection

RULE:
  Event A: Port scan detected
  FOLLOWED BY
  Event B: Exploit attempt
  WITHIN 5 minutes

LOGS:
  10:15:22 - IDS: Port scan from 203.0.113.42 (ports 1-1024)
  10:18:45 - IDS: SMB exploit attempt from 203.0.113.42

RESULT: ‚úì MATCHED (3 min 23 sec apart)
  Alert: "Scan-to-exploit attack chain detected"
  Severity: HIGH
  Action: Block source IP, investigate target system`,

        ip: `IP-BASED CORRELATION EXAMPLE:

SCENARIO: Track all activity from suspicious IP

PIVOT: source_ip = 203.0.113.42

CORRELATED EVENTS:
  08:32:15 - Firewall: Connection attempt (blocked)
  08:35:22 - IDS: Port scan detected
  08:42:10 - Web Server: SQL injection attempt
  09:15:44 - Auth: Failed SSH login (attempt 1)
  09:15:47 - Auth: Failed SSH login (attempt 2)
  ... [45 more failed attempts]
  09:22:18 - Auth: Successful SSH login
  09:25:30 - Network: Internal scan from compromised host

ANALYSIS: IP shows clear attack progression
  Initial recon ‚Üí Exploitation ‚Üí Compromise ‚Üí Lateral movement`,

        user: `USER-BASED CORRELATION EXAMPLE:

SCENARIO: Track compromised user account

PIVOT: username = "jsmith@company.com"

NORMAL BASELINE:
  Login hours: Mon-Fri 8AM-6PM EST
  Login location: Office (10.10.50.0/24)
  Accessed: Email, CRM, file shares

CORRELATED ANOMALIES TODAY:
  02:15:44 - VPN: Login from Russia (93.184.216.34)
  02:18:20 - File Server: 500 files accessed in 3 minutes
  02:22:15 - Email: Forwarding rule to external address
  02:28:50 - Cloud: 2.3GB uploaded to Mega.nz

RESULT: ‚úì ACCOUNT COMPROMISE DETECTED
  Action: Disable account, reset password, investigate`,

        session: `SESSION-BASED CORRELATION EXAMPLE:

SCENARIO: Track complete user session activity

SESSION_ID: a3f2c891-7b4e-4d2f-9c1a-5e8f6d3b2a1c

SESSION TIMELINE:
  14:22:10 - Login: user=admin, source=10.10.50.45
  14:22:15 - Access: /admin/dashboard
  14:25:33 - Access: /admin/users (viewed user list)
  14:27:18 - Action: Created new admin user "backup_admin"
  14:28:45 - Access: /admin/settings
  14:29:12 - Action: Disabled audit logging
  14:30:55 - Access: /database/export
  14:35:22 - Action: Exported customer database (1.2GB)
  14:38:10 - Logout

ANALYSIS: Suspicious admin session
  - Created backdoor account
  - Disabled logging (defense evasion)
  - Exfiltrated data

RESULT: ‚úì MALICIOUS ADMIN ACTIVITY DETECTED`
      };

      output.textContent = examples[type];
    }

    async function completeModule() {
      const btn = event.target;
      btn.disabled = true;
      btn.textContent = 'Completing...';

      try {
        if (typeof ModuleProgress !== 'undefined') {
          await ModuleProgress.complete('eye', 'eye-log-correlation');
          btn.textContent = '‚úì Module Complete!';
          btn.style.background = 'linear-gradient(135deg, #4ade80 0%, #06b6d4 100%)';

          setTimeout(() => {
            alert('üéâ Congratulations! You\'ve completed Log Correlation.\n\nYou\'ve earned Eye House points!\n\nNext: Try the Correlation Lab and Quiz.');
          }, 500);
        } else {
          btn.textContent = '‚úì Marked Complete';
          btn.style.background = 'linear-gradient(135deg, #4ade80 0%, #06b6d4 100%)';
        }
      } catch (error) {
        console.error('Error completing module:', error);
        btn.textContent = 'Complete Module';
        btn.disabled = false;
        alert('Error completing module. Please try again.');
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      createNavButtons();
      showSlide(1);
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft') previousSlide();
      if (e.key === 'ArrowRight') nextSlide();
    });
  </script>
<script src="../../../components/FluxCapacitor.js"></script>
</body>
</html>