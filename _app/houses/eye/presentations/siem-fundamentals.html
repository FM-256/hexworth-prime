<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIEM Fundamentals - Eye House</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a0b2e 100%);
            color: #e0e0e0;
            overflow-x: hidden;
        }

        .presentation-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, #c084fc 0%, #06b6d4 100%);
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(192, 132, 252, 0.3);
        }

        header h1 {
            font-size: 3em;
            color: #0f0f23;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.3em;
            color: #1a0b2e;
            font-weight: 500;
        }

        .slide {
            background: rgba(30, 30, 60, 0.6);
            border: 2px solid #c084fc;
            border-radius: 15px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .slide h2 {
            color: #c084fc;
            font-size: 2.2em;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #06b6d4;
        }

        .slide h3 {
            color: #06b6d4;
            font-size: 1.6em;
            margin: 25px 0 15px 0;
        }

        .slide h4 {
            color: #a78bfa;
            font-size: 1.3em;
            margin: 20px 0 10px 0;
        }

        .slide p {
            line-height: 1.8;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .slide ul, .slide ol {
            margin-left: 30px;
            margin-bottom: 20px;
        }

        .slide li {
            margin-bottom: 12px;
            line-height: 1.7;
            font-size: 1.05em;
        }

        .highlight {
            background: linear-gradient(90deg, rgba(192, 132, 252, 0.3), rgba(6, 182, 212, 0.3));
            padding: 20px;
            border-left: 5px solid #c084fc;
            border-radius: 8px;
            margin: 20px 0;
        }

        .code-block {
            background: #1a1a2e;
            border: 1px solid #c084fc;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            color: #06b6d4;
        }

        .architecture-diagram {
            background: #1a1a2e;
            border: 2px solid #c084fc;
            border-radius: 10px;
            padding: 30px;
            margin: 25px 0;
            text-align: center;
        }

        .flow-container {
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .flow-box {
            background: linear-gradient(135deg, #c084fc 0%, #a78bfa 100%);
            color: #0f0f23;
            padding: 20px 30px;
            border-radius: 10px;
            font-weight: bold;
            margin: 10px;
            min-width: 150px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(192, 132, 252, 0.4);
            transition: transform 0.3s ease;
        }

        .flow-box:hover {
            transform: translateY(-5px);
        }

        .flow-arrow {
            color: #06b6d4;
            font-size: 2em;
            margin: 0 10px;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
        }

        .comparison-table th {
            background: linear-gradient(135deg, #c084fc 0%, #a78bfa 100%);
            color: #0f0f23;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }

        .comparison-table td {
            background: rgba(30, 30, 60, 0.6);
            border: 1px solid #c084fc;
            padding: 12px;
            color: #e0e0e0;
        }

        .comparison-table tr:hover td {
            background: rgba(192, 132, 252, 0.2);
        }

        .use-case-card {
            background: linear-gradient(135deg, rgba(192, 132, 252, 0.2), rgba(6, 182, 212, 0.2));
            border: 2px solid #06b6d4;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .use-case-card:hover {
            transform: translateX(10px);
            box-shadow: 0 6px 25px rgba(6, 182, 212, 0.4);
        }

        .use-case-card h4 {
            color: #06b6d4;
            margin-bottom: 10px;
        }

        .info-box {
            background: rgba(6, 182, 212, 0.15);
            border-left: 5px solid #06b6d4;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .warning-box {
            background: rgba(251, 146, 60, 0.15);
            border-left: 5px solid #fb923c;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .grid-item {
            background: rgba(30, 30, 60, 0.5);
            border: 2px solid #c084fc;
            border-radius: 10px;
            padding: 20px;
            transition: transform 0.3s ease;
        }

        .grid-item:hover {
            transform: scale(1.05);
            border-color: #06b6d4;
        }

        .log-example {
            background: #0f0f23;
            border: 1px solid #06b6d4;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 0.95em;
            color: #22d3ee;
            overflow-x: auto;
        }

        .complete-btn {
            background: linear-gradient(135deg, #c084fc 0%, #06b6d4 100%);
            color: #0f0f23;
            border: none;
            padding: 15px 40px;
            font-size: 1.2em;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            margin: 30px auto;
            display: block;
            box-shadow: 0 6px 20px rgba(192, 132, 252, 0.4);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .complete-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(192, 132, 252, 0.6);
        }

        .complete-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .progress-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(30, 30, 60, 0.9);
            border: 2px solid #c084fc;
            border-radius: 10px;
            padding: 15px 25px;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .progress-bar {
            width: 200px;
            height: 10px;
            background: #1a1a2e;
            border-radius: 5px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #c084fc, #06b6d4);
            transition: width 0.5s ease;
            width: 0%;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 2em;
            }

            .slide {
                padding: 20px;
            }

            .flow-container {
                flex-direction: column;
            }

            .flow-arrow {
                transform: rotate(90deg);
            }
        }

        .badge {
            display: inline-block;
            background: #c084fc;
            color: #0f0f23;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            margin: 5px;
        }

        .splunk-color {
            color: #00b388;
        }

        .elk-color {
            color: #f04e98;
        }

        .qradar-color {
            color: #78be20;
        }

        .sentinel-color {
            color: #00a4ef;
        }
    </style>
</head>
<body>
    <div class="progress-indicator">
        <div style="color: #c084fc; font-weight: bold;">Reading Progress</div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        <div id="progressText" style="color: #06b6d4; margin-top: 5px; font-size: 0.9em;">0%</div>
    </div>

    <div class="presentation-container">
        <header>
            <h1>üîç SIEM Fundamentals</h1>
            <p>Security Information and Event Management for SOC Analysts</p>
            <div style="margin-top: 15px;">
                <span class="badge">Eye House</span>
                <span class="badge">SOC Analyst</span>
                <span class="badge">CySA+</span>
            </div>
        </header>

        <!-- Slide 1: Introduction -->
        <div class="slide" data-slide="1">
            <h2>What is SIEM?</h2>

            <p><strong>SIEM (Security Information and Event Management)</strong> is a comprehensive security solution that provides real-time analysis of security alerts generated by applications and network hardware.</p>

            <h3>Core Definition</h3>
            <div class="highlight">
                <p><strong>SIEM = SIM + SEM</strong></p>
                <ul>
                    <li><strong>SIM (Security Information Management):</strong> Long-term storage and analysis of log data</li>
                    <li><strong>SEM (Security Event Management):</strong> Real-time monitoring and correlation of events</li>
                </ul>
            </div>

            <h3>Key Capabilities</h3>
            <div class="grid-2">
                <div class="grid-item">
                    <h4>üìä Data Aggregation</h4>
                    <p>Collect logs from multiple sources across the entire infrastructure</p>
                </div>
                <div class="grid-item">
                    <h4>üîó Correlation</h4>
                    <p>Connect related events to identify security patterns and threats</p>
                </div>
                <div class="grid-item">
                    <h4>üö® Alerting</h4>
                    <p>Generate notifications when suspicious activity is detected</p>
                </div>
                <div class="grid-item">
                    <h4>üìà Dashboards</h4>
                    <p>Visualize security posture and trends in real-time</p>
                </div>
                <div class="grid-item">
                    <h4>üîç Search & Investigation</h4>
                    <p>Query historical data for forensic analysis and hunting</p>
                </div>
                <div class="grid-item">
                    <h4>üìã Compliance Reporting</h4>
                    <p>Generate reports for regulatory requirements (PCI-DSS, HIPAA, SOX)</p>
                </div>
            </div>
        </div>

        <!-- Slide 2: Why SIEM Matters -->
        <div class="slide" data-slide="2">
            <h2>Why SIEM Matters</h2>

            <h3>1. Centralized Visibility</h3>
            <p>Modern organizations have hundreds or thousands of devices generating millions of log entries daily. SIEM provides a single pane of glass to monitor all security-relevant events.</p>

            <div class="info-box">
                <strong>Real-World Impact:</strong> Without SIEM, an attacker could compromise a workstation, escalate privileges, move laterally, and exfiltrate data across weeks or months. Each action might be logged separately on different systems, making the attack invisible until it's too late.
            </div>

            <h3>2. Threat Detection</h3>
            <div class="use-case-card">
                <h4>Early Warning System</h4>
                <p>SIEM correlation engines can detect attack patterns that individual systems would miss:</p>
                <ul>
                    <li>Multiple failed logins followed by success (brute force)</li>
                    <li>Unusual data transfers at odd hours (exfiltration)</li>
                    <li>Privilege escalation attempts across multiple systems</li>
                    <li>Communication with known malicious IPs</li>
                </ul>
            </div>

            <h3>3. Compliance Requirements</h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Regulation</th>
                        <th>SIEM Requirements</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>PCI-DSS</strong></td>
                        <td>Req 10: Track and monitor all access to network resources and cardholder data</td>
                    </tr>
                    <tr>
                        <td><strong>HIPAA</strong></td>
                        <td>¬ß164.312: Implement hardware, software, and procedural mechanisms that record and examine activity</td>
                    </tr>
                    <tr>
                        <td><strong>SOX</strong></td>
                        <td>Section 404: Monitor access to financial systems and detect unauthorized changes</td>
                    </tr>
                    <tr>
                        <td><strong>GDPR</strong></td>
                        <td>Article 32: Monitor, test, and assess security measures regularly</td>
                    </tr>
                </tbody>
            </table>

            <h3>4. Incident Response</h3>
            <p>When a security incident occurs, SIEM provides:</p>
            <ul>
                <li><strong>Timeline reconstruction:</strong> What happened, when, and in what order</li>
                <li><strong>Scope assessment:</strong> How many systems were affected</li>
                <li><strong>Attribution data:</strong> Source IPs, user accounts, affected assets</li>
                <li><strong>Evidence preservation:</strong> Tamper-proof log storage for legal proceedings</li>
            </ul>

            <h3>5. Operational Efficiency</h3>
            <div class="highlight">
                <p><strong>Before SIEM:</strong> SOC analysts manually check multiple consoles, correlate events mentally, and risk missing critical alerts buried in noise.</p>
                <p><strong>With SIEM:</strong> Automated correlation, prioritized alerts, unified interface, and playbook-driven response workflows.</p>
            </div>
        </div>

        <!-- Slide 3: SIEM Architecture -->
        <div class="slide" data-slide="3">
            <h2>SIEM Architecture</h2>

            <div class="architecture-diagram">
                <h3 style="color: #c084fc; margin-bottom: 20px;">Data Flow Pipeline</h3>
                <div class="flow-container">
                    <div class="flow-box">Data Sources</div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-box">Collectors</div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-box">Parsers</div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-box">Storage</div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-box">Correlation</div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-box">Alerts</div>
                </div>
            </div>

            <h3>Component Breakdown</h3>

            <h4>1. Data Sources (Log Generators)</h4>
            <p>Any device, application, or system that generates security-relevant events:</p>
            <ul>
                <li>Network devices (firewalls, switches, routers)</li>
                <li>Security tools (IDS/IPS, antivirus, DLP)</li>
                <li>Servers (Windows, Linux, databases)</li>
                <li>Applications (web servers, custom apps)</li>
                <li>Cloud services (AWS CloudTrail, Azure AD, O365)</li>
            </ul>

            <h4>2. Collectors (Forwarders/Agents)</h4>
            <p>Software components that gather logs from sources and send them to the SIEM:</p>
            <div class="grid-2">
                <div class="grid-item">
                    <h4>Agent-Based</h4>
                    <p>Installed on endpoints to monitor local logs</p>
                    <ul>
                        <li>Splunk Universal Forwarder</li>
                        <li>Elastic Beats</li>
                        <li>Wazuh Agent</li>
                    </ul>
                </div>
                <div class="grid-item">
                    <h4>Agentless</h4>
                    <p>Pull logs via protocols like syslog, WMI, APIs</p>
                    <ul>
                        <li>Syslog receivers</li>
                        <li>API polling</li>
                        <li>WMI/WinRM queries</li>
                    </ul>
                </div>
            </div>

            <h4>3. Parsers (Normalization Layer)</h4>
            <p>Convert raw logs into structured, searchable fields:</p>
            <div class="log-example">
# Raw Apache Log:<br>
192.168.1.50 - - [21/Dec/2025:10:15:32 +0000] "GET /admin HTTP/1.1" 401 345<br><br>
# Parsed Fields:<br>
source_ip: 192.168.1.50<br>
timestamp: 2025-12-21T10:15:32Z<br>
http_method: GET<br>
uri: /admin<br>
status_code: 401<br>
bytes: 345
            </div>

            <h4>4. Storage Layer</h4>
            <ul>
                <li><strong>Hot storage:</strong> Fast SSD/NVMe for recent data (last 7-30 days)</li>
                <li><strong>Warm storage:</strong> Standard drives for medium-term retention (31-90 days)</li>
                <li><strong>Cold storage:</strong> Archived to cheaper storage for compliance (1+ years)</li>
            </ul>

            <h4>5. Correlation Engine</h4>
            <p>The "brain" of the SIEM that applies rules to detect patterns:</p>
            <div class="code-block">
# Example Correlation Rule: Brute Force Detection<br>
IF (failed_login_count > 5) <br>
   AND (time_window = 5 minutes)<br>
   AND (same_source_ip)<br>
THEN generate_alert("Possible Brute Force Attack")
            </div>

            <h4>6. Alerting & Response</h4>
            <p>When correlation rules trigger:</p>
            <ul>
                <li>Generate alert tickets in incident management system</li>
                <li>Send notifications (email, SMS, Slack)</li>
                <li>Trigger automated response actions (block IP, disable account)</li>
                <li>Enrich alerts with threat intelligence</li>
            </ul>
        </div>

        <!-- Slide 4: Log Sources -->
        <div class="slide" data-slide="4">
            <h2>Critical Log Sources</h2>

            <h3>1. Firewall Logs</h3>
            <div class="use-case-card">
                <h4>What They Capture</h4>
                <ul>
                    <li>Allowed and denied connections</li>
                    <li>Source/destination IPs and ports</li>
                    <li>Protocol information (TCP, UDP, ICMP)</li>
                    <li>Bytes transferred</li>
                </ul>
                <h4>Security Value</h4>
                <p>Detect port scans, unauthorized access attempts, data exfiltration, C2 traffic</p>
            </div>

            <h3>2. IDS/IPS Logs</h3>
            <div class="use-case-card">
                <h4>What They Capture</h4>
                <ul>
                    <li>Signature-based detections (Snort rules)</li>
                    <li>Anomalous network behavior</li>
                    <li>Exploit attempts</li>
                    <li>Malware communication patterns</li>
                </ul>
                <h4>Security Value</h4>
                <p>High-fidelity alerts for known attack patterns and zero-day indicators</p>
            </div>

            <h3>3. Windows Event Logs</h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Event ID</th>
                        <th>Description</th>
                        <th>Security Significance</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>4624</strong></td>
                        <td>Successful logon</td>
                        <td>Track user access, detect after-hours logins</td>
                    </tr>
                    <tr>
                        <td><strong>4625</strong></td>
                        <td>Failed logon</td>
                        <td>Brute force detection, credential attacks</td>
                    </tr>
                    <tr>
                        <td><strong>4672</strong></td>
                        <td>Admin privileges assigned</td>
                        <td>Privilege escalation monitoring</td>
                    </tr>
                    <tr>
                        <td><strong>4688</strong></td>
                        <td>Process creation</td>
                        <td>Detect malicious executables, living-off-the-land attacks</td>
                    </tr>
                    <tr>
                        <td><strong>4720</strong></td>
                        <td>User account created</td>
                        <td>Unauthorized account creation by attackers</td>
                    </tr>
                    <tr>
                        <td><strong>4776</strong></td>
                        <td>Domain controller credential validation</td>
                        <td>Password spray attacks, lateral movement</td>
                    </tr>
                </tbody>
            </table>

            <h3>4. Linux Syslog</h3>
            <div class="log-example">
# /var/log/auth.log - SSH authentication attempts<br>
Dec 21 10:32:15 webserver sshd[12345]: Failed password for admin from 203.0.113.50 port 44321 ssh2<br><br>
# /var/log/secure - sudo commands<br>
Dec 21 10:35:42 webserver sudo: analyst : TTY=pts/1 ; PWD=/home/analyst ; USER=root ; COMMAND=/bin/cat /etc/shadow
            </div>
            <p><strong>Key files to monitor:</strong> auth.log, secure, messages, syslog, cron, kern.log</p>

            <h3>5. Application Logs</h3>
            <div class="grid-2">
                <div class="grid-item">
                    <h4>Web Servers (Apache/Nginx)</h4>
                    <ul>
                        <li>Access logs: HTTP requests, status codes</li>
                        <li>Error logs: Application errors, exceptions</li>
                        <li>Detect: SQL injection, XSS, brute force on /admin</li>
                    </ul>
                </div>
                <div class="grid-item">
                    <h4>Database Logs</h4>
                    <ul>
                        <li>Query logs: SELECT, INSERT, UPDATE, DELETE</li>
                        <li>Authentication logs: DB logins</li>
                        <li>Detect: Unauthorized queries, data exfiltration</li>
                    </ul>
                </div>
                <div class="grid-item">
                    <h4>Cloud Services</h4>
                    <ul>
                        <li>AWS CloudTrail: API calls, resource changes</li>
                        <li>Azure AD: Authentication, conditional access</li>
                        <li>O365: Email, SharePoint, Teams activity</li>
                    </ul>
                </div>
                <div class="grid-item">
                    <h4>Endpoint Security</h4>
                    <ul>
                        <li>Antivirus: Malware detections, quarantines</li>
                        <li>EDR: Process execution, file modifications</li>
                        <li>DLP: Data transfer attempts</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 5: Log Normalization -->
        <div class="slide" data-slide="5">
            <h2>Log Normalization & Parsing</h2>

            <h3>The Challenge</h3>
            <p>Every vendor formats logs differently. Without normalization, you can't correlate events across sources.</p>

            <h3>Common Log Formats</h3>

            <h4>1. Syslog (RFC 5424)</h4>
            <div class="log-example">
&lt;34&gt;1 2025-12-21T10:15:32.123Z firewall.example.com iptables - - - Dropped connection from 203.0.113.50 to 192.168.1.100:22
            </div>
            <p><strong>Components:</strong> Priority, version, timestamp, hostname, app-name, message</p>

            <h4>2. CEF (Common Event Format)</h4>
            <div class="log-example">
CEF:0|Cisco|ASA|9.8|106023|Deny tcp src outside:203.0.113.50/52145 dst inside:192.168.1.100/22|High|src=203.0.113.50 dst=192.168.1.100 spt=52145 dpt=22
            </div>
            <p><strong>Structure:</strong> Version | Vendor | Product | Version | Signature | Name | Severity | Extensions</p>

            <h4>3. JSON (JavaScript Object Notation)</h4>
            <div class="log-example">
{<br>
  "timestamp": "2025-12-21T10:15:32Z",<br>
  "source_ip": "203.0.113.50",<br>
  "dest_ip": "192.168.1.100",<br>
  "dest_port": 22,<br>
  "action": "DENY",<br>
  "protocol": "TCP",<br>
  "severity": "high"<br>
}
            </div>
            <p><strong>Advantage:</strong> Already structured, easy to parse, widely adopted in modern systems</p>

            <h4>4. Windows Event XML</h4>
            <div class="log-example">
&lt;Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event"&gt;<br>
  &lt;System&gt;<br>
    &lt;EventID&gt;4625&lt;/EventID&gt;<br>
    &lt;TimeCreated SystemTime="2025-12-21T10:15:32.123Z"/&gt;<br>
  &lt;/System&gt;<br>
  &lt;EventData&gt;<br>
    &lt;Data Name="TargetUserName"&gt;Administrator&lt;/Data&gt;<br>
    &lt;Data Name="IpAddress"&gt;203.0.113.50&lt;/Data&gt;<br>
  &lt;/EventData&gt;<br>
&lt;/Event&gt;
            </div>

            <h3>Normalization Process</h3>
            <div class="architecture-diagram">
                <h4 style="color: #c084fc;">Field Mapping Example</h4>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Source System</th>
                            <th>Original Field</th>
                            <th>Normalized Field</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Cisco ASA</td>
                            <td>src</td>
                            <td>source_ip</td>
                        </tr>
                        <tr>
                            <td>Windows Event</td>
                            <td>IpAddress</td>
                            <td>source_ip</td>
                        </tr>
                        <tr>
                            <td>Apache</td>
                            <td>%h (first field)</td>
                            <td>source_ip</td>
                        </tr>
                        <tr>
                            <td>iptables</td>
                            <td>SRC=</td>
                            <td>source_ip</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="info-box">
                <strong>Why This Matters:</strong> After normalization, you can write a single correlation rule like "alert if source_ip has 5+ failed logins" that works across ALL log sources, regardless of their original format.
            </div>
        </div>

        <!-- Slide 6: Splunk Overview -->
        <div class="slide" data-slide="6">
            <h2 class="splunk-color">Splunk SIEM Platform</h2>

            <h3>Architecture Components</h3>
            <div class="grid-2">
                <div class="grid-item">
                    <h4>Universal Forwarder</h4>
                    <p>Lightweight agent that collects and forwards logs to indexers</p>
                </div>
                <div class="grid-item">
                    <h4>Indexer</h4>
                    <p>Stores and indexes data for fast searching</p>
                </div>
                <div class="grid-item">
                    <h4>Search Head</h4>
                    <p>User interface for searching, creating alerts, and dashboards</p>
                </div>
                <div class="grid-item">
                    <h4>Deployment Server</h4>
                    <p>Centrally manages forwarder configurations</p>
                </div>
            </div>

            <h3>Key Concepts</h3>
            <h4>Indexes</h4>
            <p>Logical data repositories. Common indexes:</p>
            <ul>
                <li><strong>main:</strong> Default index for all data</li>
                <li><strong>security:</strong> Security-specific events</li>
                <li><strong>windows:</strong> Windows Event Logs</li>
                <li><strong>firewall:</strong> Network device logs</li>
            </ul>

            <h4>Sourcetypes</h4>
            <p>Identifies log format for proper parsing:</p>
            <div class="log-example">
sourcetype=access_combined (Apache)<br>
sourcetype=WinEventLog:Security (Windows)<br>
sourcetype=cisco:asa (Cisco Firewall)<br>
sourcetype=linux_secure (Linux auth logs)
            </div>

            <h3>SPL (Search Processing Language) Basics</h3>

            <h4>Basic Search</h4>
            <div class="code-block">
# Search for failed logins in last 24 hours<br>
index=windows EventCode=4625 earliest=-24h
            </div>

            <h4>Filtering & Field Extraction</h4>
            <div class="code-block">
# Find all HTTP 404 errors from a specific IP<br>
index=web sourcetype=access_combined status=404 clientip="203.0.113.50"
            </div>

            <h4>Statistical Commands</h4>
            <div class="code-block">
# Count failed logins by user<br>
index=windows EventCode=4625 <br>
| stats count by Account_Name <br>
| sort -count<br><br>
# Calculate average response time by server<br>
index=web<br>
| stats avg(response_time) as avg_response by server<br>
| where avg_response > 500
            </div>

            <h4>Time-Based Analysis</h4>
            <div class="code-block">
# Show login attempts over time (1 hour buckets)<br>
index=windows EventCode=4624 OR EventCode=4625<br>
| timechart span=1h count by EventCode
            </div>

            <h4>Correlation & Subsearches</h4>
            <div class="code-block">
# Find IPs that had failed logins followed by successful login<br>
index=windows EventCode=4624 <br>
  [search index=windows EventCode=4625 | stats count by src_ip | where count>5 | fields src_ip]
            </div>

            <h3>Splunk Apps for Security</h3>
            <ul>
                <li><strong>Splunk Enterprise Security (ES):</strong> Premium SIEM with correlation, incident review, risk-based alerting</li>
                <li><strong>Splunk SOAR:</strong> Security orchestration and automated response</li>
                <li><strong>Threat Intelligence Framework:</strong> Integrate threat feeds (STIX/TAXII)</li>
            </ul>
        </div>

        <!-- Slide 7: ELK Stack -->
        <div class="slide" data-slide="7">
            <h2 class="elk-color">ELK Stack (Elastic Stack)</h2>

            <h3>Components</h3>
            <div class="architecture-diagram">
                <div class="flow-container">
                    <div class="flow-box">Beats<br>(Data Shippers)</div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-box">Logstash<br>(Processing)</div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-box">Elasticsearch<br>(Storage/Search)</div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-box">Kibana<br>(Visualization)</div>
                </div>
            </div>

            <h3>Elasticsearch</h3>
            <p>Distributed search and analytics engine built on Apache Lucene</p>
            <ul>
                <li><strong>Indexes:</strong> Similar to databases, store related documents</li>
                <li><strong>Documents:</strong> JSON objects representing log events</li>
                <li><strong>Sharding:</strong> Horizontal scaling across multiple nodes</li>
                <li><strong>Replication:</strong> High availability and fault tolerance</li>
            </ul>

            <h4>Query Example (Query DSL)</h4>
            <div class="code-block">
GET /windows-logs-*/_search<br>
{<br>
  "query": {<br>
    "bool": {<br>
      "must": [<br>
        { "match": { "event.code": "4625" }},<br>
        { "range": { "@timestamp": { "gte": "now-1h" }}}<br>
      ]<br>
    }<br>
  },<br>
  "aggs": {<br>
    "top_users": {<br>
      "terms": { "field": "user.name.keyword", "size": 10 }<br>
    }<br>
  }<br>
}
            </div>

            <h3>Logstash</h3>
            <p>Server-side data processing pipeline that ingests, transforms, and sends data</p>

            <h4>Pipeline Configuration</h4>
            <div class="code-block">
input {<br>
  beats {<br>
    port => 5044<br>
  }<br>
}<br><br>
filter {<br>
  if [source] == "/var/log/auth.log" {<br>
    grok {<br>
      match => { "message" => "%{SYSLOGTIMESTAMP:timestamp} %{SYSLOGHOST:hostname} %{DATA:program}(?:\[%{POSINT:pid}\])?: %{GREEDYDATA:message}" }<br>
    }<br>
    date {<br>
      match => [ "timestamp", "MMM dd HH:mm:ss" ]<br>
    }<br>
  }<br>
}<br><br>
output {<br>
  elasticsearch {<br>
    hosts => ["localhost:9200"]<br>
    index => "linux-auth-%{+YYYY.MM.dd}"<br>
  }<br>
}
            </div>

            <h3>Beats</h3>
            <p>Lightweight data shippers for specific data types:</p>
            <div class="grid-2">
                <div class="grid-item">
                    <h4>Filebeat</h4>
                    <p>Ships log files (syslog, Apache, Nginx, etc.)</p>
                </div>
                <div class="grid-item">
                    <h4>Winlogbeat</h4>
                    <p>Ships Windows Event Logs</p>
                </div>
                <div class="grid-item">
                    <h4>Packetbeat</h4>
                    <p>Network packet analyzer</p>
                </div>
                <div class="grid-item">
                    <h4>Auditbeat</h4>
                    <p>Audit framework data (Linux auditd)</p>
                </div>
            </div>

            <h3>Kibana</h3>
            <p>Visualization and exploration tool for Elasticsearch data</p>
            <ul>
                <li><strong>Discover:</strong> Ad-hoc searching and filtering</li>
                <li><strong>Visualize:</strong> Create charts, graphs, maps</li>
                <li><strong>Dashboard:</strong> Combine visualizations into operational views</li>
                <li><strong>Canvas:</strong> Create pixel-perfect presentations</li>
                <li><strong>Alerts:</strong> Define threshold-based or anomaly-based alerts</li>
            </ul>

            <div class="info-box">
                <strong>Security App (Elastic SIEM):</strong> Free built-in SIEM capabilities including detection rules, timeline investigation, case management, and ML-based anomaly detection.
            </div>
        </div>

        <!-- Slide 8: Other SIEM Platforms -->
        <div class="slide" data-slide="8">
            <h2>Other SIEM Platforms</h2>

            <h3 class="qradar-color">IBM QRadar</h3>
            <div class="use-case-card">
                <h4>Key Features</h4>
                <ul>
                    <li><strong>Flow-based analysis:</strong> NetFlow/IPFIX correlation with logs</li>
                    <li><strong>Offense management:</strong> Automated incident aggregation</li>
                    <li><strong>Custom rules engine (AQL):</strong> Advanced Query Language for correlation</li>
                    <li><strong>Integrated vulnerability data:</strong> QRadar Vulnerability Manager</li>
                </ul>
                <h4>Typical Deployment</h4>
                <p>Enterprise environments, especially IBM shops, financial services, government</p>
            </div>

            <h3 class="sentinel-color">Microsoft Sentinel</h3>
            <div class="use-case-card">
                <h4>Key Features</h4>
                <ul>
                    <li><strong>Cloud-native:</strong> No infrastructure to manage, scales automatically</li>
                    <li><strong>Azure integration:</strong> Native Azure AD, O365, Azure resource monitoring</li>
                    <li><strong>KQL (Kusto Query Language):</strong> Powerful query language similar to SPL</li>
                    <li><strong>SOAR built-in:</strong> Logic Apps for automated response workflows</li>
                    <li><strong>Content hub:</strong> Pre-built detection rules, workbooks, playbooks</li>
                </ul>
                <h4>KQL Example</h4>
                <div class="code-block">
SigninLogs<br>
| where TimeGenerated > ago(1h)<br>
| where ResultType != "0"<br>
| summarize FailedAttempts=count() by UserPrincipalName, IPAddress<br>
| where FailedAttempts > 5<br>
| order by FailedAttempts desc
                </div>
            </div>

            <h3>Google Chronicle</h3>
            <div class="use-case-card">
                <h4>Key Features</h4>
                <ul>
                    <li><strong>Unlimited retention:</strong> Store petabytes of data for years</li>
                    <li><strong>Speed:</strong> Search across months of data in seconds (Google infrastructure)</li>
                    <li><strong>Threat intelligence:</strong> VirusTotal integration, Google threat data</li>
                    <li><strong>UDM (Unified Data Model):</strong> Automatic log normalization</li>
                </ul>
                <h4>Typical Deployment</h4>
                <p>Large enterprises with massive log volumes, Google Cloud customers</p>
            </div>

            <h3>Wazuh (Open Source)</h3>
            <div class="use-case-card">
                <h4>Key Features</h4>
                <ul>
                    <li><strong>Free & open source:</strong> Based on OSSEC</li>
                    <li><strong>Host-based intrusion detection:</strong> File integrity monitoring, rootkit detection</li>
                    <li><strong>Log analysis:</strong> Built-in decoders for common formats</li>
                    <li><strong>Compliance mapping:</strong> PCI-DSS, HIPAA, GDPR dashboards</li>
                    <li><strong>Integrates with ELK:</strong> Can send alerts to Elasticsearch</li>
                </ul>
                <h4>Best For</h4>
                <p>Small to medium businesses, budget-conscious organizations, compliance-focused environments</p>
            </div>

            <h3>SIEM Comparison Matrix</h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>SIEM</th>
                        <th>Strength</th>
                        <th>Learning Curve</th>
                        <th>Cost</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Splunk</strong></td>
                        <td>Most powerful search, extensive app ecosystem</td>
                        <td>Medium</td>
                        <td>High (license by daily GB)</td>
                    </tr>
                    <tr>
                        <td><strong>ELK Stack</strong></td>
                        <td>Flexibility, customization, modern architecture</td>
                        <td>High (complex setup)</td>
                        <td>Free (basic) to Medium</td>
                    </tr>
                    <tr>
                        <td><strong>QRadar</strong></td>
                        <td>Flow analysis, offense management</td>
                        <td>High</td>
                        <td>High</td>
                    </tr>
                    <tr>
                        <td><strong>Sentinel</strong></td>
                        <td>Cloud-native, Azure/M365 integration</td>
                        <td>Medium</td>
                        <td>Pay-per-GB ingestion</td>
                    </tr>
                    <tr>
                        <td><strong>Chronicle</strong></td>
                        <td>Unlimited retention, search speed</td>
                        <td>Medium</td>
                        <td>High (enterprise only)</td>
                    </tr>
                    <tr>
                        <td><strong>Wazuh</strong></td>
                        <td>Open source, host-based detection</td>
                        <td>Medium</td>
                        <td>Free</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Slide 9: SIEM Use Cases -->
        <div class="slide" data-slide="9">
            <h2>Real-World SIEM Use Cases</h2>

            <h3>1. Brute Force Attack Detection</h3>
            <div class="use-case-card">
                <h4>Scenario</h4>
                <p>Attacker attempts to guess passwords through repeated login attempts</p>

                <h4>SIEM Detection Logic</h4>
                <div class="code-block">
# Splunk SPL<br>
index=windows EventCode=4625<br>
| stats count by src_ip, Account_Name<br>
| where count > 5<br>
| eval severity="high"
                </div>

                <h4>Correlation Enhancements</h4>
                <ul>
                    <li>Alert if followed by successful login (EventCode=4624) from same IP</li>
                    <li>Check if source IP is on threat intelligence blocklist</li>
                    <li>Correlate with failed VPN attempts from same user</li>
                    <li>Track if attack spreads to multiple accounts (password spray)</li>
                </ul>

                <h4>Response Actions</h4>
                <ul>
                    <li>Automatic firewall block of source IP</li>
                    <li>Force password reset for targeted account</li>
                    <li>Enable MFA requirement</li>
                    <li>Create incident ticket for SOC investigation</li>
                </ul>
            </div>

            <h3>2. Lateral Movement Detection</h3>
            <div class="use-case-card">
                <h4>Scenario</h4>
                <p>Attacker compromises one system and moves to others using stolen credentials</p>

                <h4>Indicators to Monitor</h4>
                <ul>
                    <li>User logs in from multiple systems in short timeframe</li>
                    <li>Administrative shares accessed (C$, ADMIN$)</li>
                    <li>PsExec or remote WMI execution</li>
                    <li>Kerberos ticket anomalies (pass-the-ticket)</li>
                </ul>

                <h4>SIEM Detection Logic</h4>
                <div class="code-block">
# Detect account accessing 10+ systems in 1 hour<br>
index=windows EventCode=4624<br>
| stats dc(ComputerName) as unique_systems by Account_Name<br>
| where unique_systems > 10
                </div>
            </div>

            <h3>3. Data Exfiltration</h3>
            <div class="use-case-card">
                <h4>Scenario</h4>
                <p>Attacker attempts to steal sensitive data</p>

                <h4>Detection Patterns</h4>
                <ul>
                    <li>Large file uploads to cloud services (OneDrive, Dropbox, WeTransfer)</li>
                    <li>Database queries returning unusually large result sets</li>
                    <li>Outbound traffic to suspicious destinations at unusual hours</li>
                    <li>DLP alerts for sensitive data leaving the network</li>
                </ul>

                <h4>Multi-Source Correlation</h4>
                <div class="code-block">
# Correlate proxy logs + DLP + firewall<br>
(index=proxy url="*dropbox.com*" bytes_out>100000000)<br>
AND (index=dlp action="alert" classification="PII")<br>
AND (index=firewall action="allow" dest_port=443)
                </div>
            </div>

            <h3>4. Insider Threat Detection</h3>
            <div class="use-case-card">
                <h4>Behavioral Indicators</h4>
                <ul>
                    <li>Access to resources outside normal job function</li>
                    <li>After-hours database queries</li>
                    <li>Mass file downloads before resignation</li>
                    <li>Attempts to disable logging or security tools</li>
                    <li>USB device usage in restricted areas</li>
                </ul>

                <h4>UEBA (User and Entity Behavior Analytics)</h4>
                <p>Machine learning models establish baseline behavior, then alert on deviations:</p>
                <ul>
                    <li>User normally accesses 10 files/day, suddenly downloads 1000</li>
                    <li>HR employee accessing financial database (unusual)</li>
                    <li>Login from geographic location far from normal</li>
                </ul>
            </div>

            <h3>5. Malware C2 Communication</h3>
            <div class="use-case-card">
                <h4>Detection Methods</h4>
                <ul>
                    <li><strong>DNS:</strong> Queries to newly registered domains, DGA patterns</li>
                    <li><strong>Firewall:</strong> Beaconing (regular intervals), connections to known bad IPs</li>
                    <li><strong>Proxy:</strong> User-agent anomalies, unusual TLS certificates</li>
                    <li><strong>EDR:</strong> Process making network connections it shouldn't</li>
                </ul>

                <h4>Advanced Detection: Beaconing</h4>
                <div class="code-block">
# Detect periodic connections (potential C2 beaconing)<br>
index=firewall<br>
| stats count, dc(dest_ip) as unique_destinations by src_ip, _time span=1m<br>
| where count > 5 AND unique_destinations = 1<br>
| stats count by src_ip<br>
| where count > 60
                </div>
            </div>
        </div>

        <!-- Slide 10: SIEM Deployment Considerations -->
        <div class="slide" data-slide="10">
            <h2>SIEM Deployment Considerations</h2>

            <h3>On-Premises vs Cloud</h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Factor</th>
                        <th>On-Premises</th>
                        <th>Cloud-Based</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Control</strong></td>
                        <td>Full control over hardware, data location</td>
                        <td>Provider manages infrastructure</td>
                    </tr>
                    <tr>
                        <td><strong>Scalability</strong></td>
                        <td>Requires hardware procurement (slow)</td>
                        <td>Scale instantly (elastic)</td>
                    </tr>
                    <tr>
                        <td><strong>Capital Costs</strong></td>
                        <td>High upfront (servers, storage, licenses)</td>
                        <td>Low upfront, pay-as-you-go</td>
                    </tr>
                    <tr>
                        <td><strong>Maintenance</strong></td>
                        <td>Your team handles patches, upgrades</td>
                        <td>Provider handles updates</td>
                    </tr>
                    <tr>
                        <td><strong>Data Residency</strong></td>
                        <td>Stays in your datacenter (compliance)</td>
                        <td>May cross borders (check regulations)</td>
                    </tr>
                    <tr>
                        <td><strong>Disaster Recovery</strong></td>
                        <td>You design and test DR plan</td>
                        <td>Built-in redundancy (usually)</td>
                    </tr>
                </tbody>
            </table>

            <h3>Sizing Your SIEM</h3>

            <h4>Calculate Daily Log Volume</h4>
            <div class="highlight">
                <p><strong>Formula:</strong> (Number of devices) √ó (Average logs per device per day) √ó (Average bytes per log)</p>

                <h4>Example Calculation:</h4>
                <ul>
                    <li>1000 Windows endpoints √ó 5000 events/day √ó 500 bytes = 2.5 GB/day</li>
                    <li>50 servers √ó 50,000 events/day √ó 500 bytes = 1.25 GB/day</li>
                    <li>10 firewalls √ó 1,000,000 events/day √ó 300 bytes = 3 GB/day</li>
                    <li><strong>Total: 6.75 GB/day</strong></li>
                </ul>

                <p><strong>Storage needed for 90-day retention:</strong> 6.75 GB √ó 90 = 607.5 GB (plus 30% overhead = ~800 GB)</p>
            </div>

            <h4>Performance Metrics</h4>
            <ul>
                <li><strong>Ingestion rate:</strong> Events per second (EPS) the SIEM can handle</li>
                <li><strong>Search performance:</strong> Time to query 24 hours of data</li>
                <li><strong>Concurrent users:</strong> How many analysts can use the system simultaneously</li>
                <li><strong>Alert latency:</strong> Time between event occurrence and alert generation</li>
            </ul>

            <h3>Architecture Best Practices</h3>

            <h4>1. Network Segmentation</h4>
            <div class="info-box">
                <p>Place SIEM in a dedicated management network, not in the same segment as production systems. This prevents attackers from compromising the SIEM to hide their tracks.</p>
            </div>

            <h4>2. High Availability</h4>
            <ul>
                <li>Clustered indexers/search heads (no single point of failure)</li>
                <li>Redundant forwarders with failover</li>
                <li>Replicated storage across multiple nodes</li>
                <li>Load balancers for even distribution</li>
            </ul>

            <h4>3. Log Source Prioritization</h4>
            <div class="warning-box">
                <p><strong>Don't try to ingest everything on day one!</strong> Start with high-value sources:</p>
                <ol>
                    <li>Domain controllers (authentication)</li>
                    <li>Perimeter firewalls (external threats)</li>
                    <li>VPN concentrators (remote access)</li>
                    <li>IDS/IPS (known attacks)</li>
                    <li>Critical servers (crown jewels)</li>
                </ol>
                <p>Then expand to workstations, applications, cloud services over time.</p>
            </div>

            <h4>4. Retention Policy</h4>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Data Type</th>
                        <th>Hot Storage</th>
                        <th>Warm Storage</th>
                        <th>Cold/Archive</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Security logs</strong></td>
                        <td>30 days</td>
                        <td>60 days</td>
                        <td>1+ year (compliance)</td>
                    </tr>
                    <tr>
                        <td><strong>Firewall logs</strong></td>
                        <td>14 days</td>
                        <td>30 days</td>
                        <td>90 days</td>
                    </tr>
                    <tr>
                        <td><strong>Application logs</strong></td>
                        <td>7 days</td>
                        <td>30 days</td>
                        <td>60 days</td>
                    </tr>
                </tbody>
            </table>

            <h3>Common Deployment Pitfalls</h3>

            <div class="use-case-card">
                <h4>‚ùå Alert Fatigue</h4>
                <p><strong>Problem:</strong> Creating 100 alert rules on day one, most triggering false positives</p>
                <p><strong>Solution:</strong> Start with 5-10 high-confidence rules, tune over weeks, gradually add more</p>
            </div>

            <div class="use-case-card">
                <h4>‚ùå Log Everything Approach</h4>
                <p><strong>Problem:</strong> Ingesting verbose debug logs, drowning out security signals</p>
                <p><strong>Solution:</strong> Filter at the source, only send security-relevant events (failed logins, not successful)</p>
            </div>

            <div class="use-case-card">
                <h4>‚ùå No Time Synchronization</h4>
                <p><strong>Problem:</strong> Systems with incorrect timestamps make correlation impossible</p>
                <p><strong>Solution:</strong> Enforce NTP across all log sources, monitor for time drift</p>
            </div>

            <div class="use-case-card">
                <h4>‚ùå Insufficient Bandwidth</h4>
                <p><strong>Problem:</strong> Network congestion causes log delays or drops</p>
                <p><strong>Solution:</strong> Calculate bandwidth needs (6.75 GB/day = ~0.78 Mbps sustained), add 50% buffer</p>
            </div>

            <h3>Success Metrics</h3>
            <p>After 90 days of SIEM operation, you should measure:</p>
            <ul>
                <li><strong>Log source coverage:</strong> % of critical systems sending logs</li>
                <li><strong>Alert quality:</strong> True positive rate (goal: >50%)</li>
                <li><strong>MTTD (Mean Time to Detect):</strong> How fast threats are identified</li>
                <li><strong>MTTR (Mean Time to Respond):</strong> How fast incidents are resolved</li>
                <li><strong>Compliance readiness:</strong> Ability to generate audit reports on demand</li>
            </ul>
        </div>

        <!-- Completion Section -->
        <div class="slide">
            <h2>Module Complete!</h2>

            <div class="highlight">
                <h3>What You've Learned</h3>
                <ul>
                    <li>‚úì SIEM fundamentals and why it's critical for security operations</li>
                    <li>‚úì SIEM architecture from data collection to alerting</li>
                    <li>‚úì Key log sources and what they reveal about threats</li>
                    <li>‚úì Log normalization and parsing techniques</li>
                    <li>‚úì Splunk SPL and ELK Stack query languages</li>
                    <li>‚úì Major SIEM platforms: Splunk, ELK, QRadar, Sentinel, Chronicle, Wazuh</li>
                    <li>‚úì Real-world use cases: brute force, lateral movement, exfiltration</li>
                    <li>‚úì Deployment considerations and best practices</li>
                </ul>
            </div>

            <h3>Next Steps</h3>
            <div class="grid-2">
                <div class="grid-item">
                    <h4>üõ†Ô∏è SIEM Simulator</h4>
                    <p>Practice with the interactive SIEM simulation tool</p>
                </div>
                <div class="grid-item">
                    <h4>üß™ Hands-On Lab</h4>
                    <p>Complete real-world SIEM exercises</p>
                </div>
                <div class="grid-item">
                    <h4>üìù Quiz</h4>
                    <p>Test your knowledge with the SIEM quiz</p>
                </div>
                <div class="grid-item">
                    <h4>üéì Certification Prep</h4>
                    <p>These concepts map to CySA+ objectives</p>
                </div>
            </div>

            <button class="complete-btn" onclick="completeModule()">Mark Module as Complete</button>
            <div id="completionMessage" style="text-align: center; margin-top: 20px; color: #06b6d4; font-weight: bold;"></div>
        </div>
    </div>

    <script>
        // Progress tracking
        function updateProgress() {
            const slides = document.querySelectorAll('.slide');
            const windowHeight = window.innerHeight;
            const documentHeight = document.documentElement.scrollHeight;
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

            const scrollPercent = (scrollTop / (documentHeight - windowHeight)) * 100;

            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');

            progressFill.style.width = Math.min(scrollPercent, 100) + '%';
            progressText.textContent = Math.round(scrollPercent) + '%';
        }

        window.addEventListener('scroll', updateProgress);
        window.addEventListener('resize', updateProgress);

        // Module completion
        function completeModule() {
            const btn = event.target;
            btn.disabled = true;
            btn.textContent = 'Completing...';

            // Simulate progress completion
            setTimeout(() => {
                if (typeof ModuleProgress !== 'undefined') {
                    ModuleProgress.complete('eye', 'eye-siem-fundamentals');
                }

                btn.textContent = '‚úì Module Completed!';
                btn.style.background = 'linear-gradient(135deg, #06b6d4 0%, #22c55e 100%)';

                document.getElementById('completionMessage').innerHTML = `
                    <div style="background: rgba(6, 182, 212, 0.2); padding: 20px; border-radius: 10px; border: 2px solid #06b6d4;">
                        <h3 style="color: #06b6d4; margin-bottom: 10px;">üéâ Congratulations!</h3>
                        <p>SIEM Fundamentals module completed successfully.</p>
                        <p style="margin-top: 10px;">Continue to the SIEM Simulator tool to practice your skills!</p>
                    </div>
                `;

                // Trigger achievement if AchievementManager exists
                if (typeof AchievementManager !== 'undefined') {
                    AchievementManager.unlock('siem_master');
                }
            }, 1000);
        }

        // Smooth scroll behavior for better UX
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

        // Initialize progress on load
        updateProgress();

        // Add hover effect to code blocks for better interactivity
        document.querySelectorAll('.code-block').forEach(block => {
            block.addEventListener('click', function() {
                // Select all text in code block for easy copying
                const range = document.createRange();
                range.selectNodeContents(this);
                const selection = window.getSelection();
                selection.removeAllRanges();
                selection.addRange(range);
            });
        });
    </script>
<script src="../../../components/FluxCapacitor.js"></script>
</body>
</html>
