<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cryptography Quiz - Shield House</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #0f0f1a 0%, #1a1a2e 50%, #16213e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 800px; margin: 0 auto; }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: linear-gradient(135deg, rgba(248, 113, 113, 0.1), rgba(248, 113, 113, 0.05));
            border-radius: 16px;
            border: 1px solid rgba(248, 113, 113, 0.3);
        }
        .header h1 { font-size: 2rem; color: #f87171; margin-bottom: 10px; }
        .header p { color: #a0a0a0; }
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: #888;
            text-decoration: none;
            margin-bottom: 20px;
        }
        .back-link:hover { color: #f87171; }
        .question-card {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
            padding: 25px;
        }
        .question-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        .question-number {
            background: #f87171;
            color: #000;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
        }
        .question-category {
            background: rgba(248, 113, 113, 0.2);
            color: #f87171;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            text-transform: uppercase;
        }
        .question-text { font-size: 1.1rem; margin-bottom: 20px; line-height: 1.6; }
        .options { display: flex; flex-direction: column; gap: 10px; }
        .option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.02);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .option:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(248, 113, 113, 0.3);
        }
        .option.selected {
            background: rgba(248, 113, 113, 0.1);
            border-color: #f87171;
        }
        .option.correct {
            background: rgba(74, 222, 128, 0.15);
            border-color: #4ade80;
        }
        .option.incorrect {
            background: rgba(248, 113, 113, 0.15);
            border-color: #f87171;
        }
        .option input { display: none; }
        .option-marker {
            width: 24px;
            height: 24px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.8rem;
            flex-shrink: 0;
        }
        .option.selected .option-marker {
            background: #f87171;
            border-color: #f87171;
            color: #000;
        }
        .option.correct .option-marker {
            background: #4ade80;
            border-color: #4ade80;
            color: #000;
        }
        .explanation {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: rgba(59, 130, 246, 0.1);
            border-left: 4px solid #3b82f6;
            border-radius: 0 8px 8px 0;
        }
        .explanation.show { display: block; }
        .explanation h4 { color: #60a5fa; margin-bottom: 8px; }
        .submit-section { text-align: center; margin-top: 30px; }
        .submit-btn {
            background: linear-gradient(135deg, #f87171, #fb923c);
            color: #000;
            border: none;
            padding: 15px 40px;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(248, 113, 113, 0.4);
        }
        .submit-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .results {
            display: none;
            text-align: center;
            padding: 40px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 30px;
        }
        .results.show { display: block; animation: fadeIn 0.5s ease; }
        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 2.5rem;
            font-weight: bold;
        }
        .score-circle.pass {
            background: linear-gradient(135deg, rgba(74, 222, 128, 0.2), rgba(34, 197, 94, 0.1));
            border: 3px solid #4ade80;
            color: #4ade80;
        }
        .score-circle.fail {
            background: linear-gradient(135deg, rgba(248, 113, 113, 0.2), rgba(239, 68, 68, 0.1));
            border: 3px solid #f87171;
            color: #f87171;
        }
        .score-label { font-size: 0.9rem; margin-top: 5px; }
        .results h2 { margin-bottom: 15px; }
        .results p { color: #888; margin-bottom: 20px; }
        .results-actions { display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; }
        .results-actions a, .results-actions button {
            display: inline-block;
            padding: 12px 25px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            cursor: pointer;
            border: none;
            font-size: 1rem;
        }
        .btn-primary { background: #f87171; color: #000; }
        .btn-secondary { background: rgba(255, 255, 255, 0.1); color: #fff; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .progress-indicator { display: flex; justify-content: center; gap: 8px; margin-bottom: 20px; }
        .progress-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
        }
        .progress-dot.answered { background: #f87171; }
        .progress-dot.correct { background: #4ade80; }
        .progress-dot.incorrect { background: #ef4444; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">‚Üê Back to Shield House</a>

        <div class="header">
            <h1>üîê Cryptography Quiz</h1>
            <p>15 questions on encryption, hashing, key exchange, signatures, and PKI</p>
            <p style="margin-top: 10px; color: #f87171;">Passing score: 70% (11/15)</p>
        </div>

        <div class="progress-indicator" id="progressDots"></div>
        <div id="quizContainer"></div>

        <div class="submit-section">
            <button class="submit-btn" id="submitBtn" onclick="submitQuiz()">Submit Quiz</button>
        </div>

        <div class="results" id="results">
            <div class="score-circle" id="scoreCircle">
                <span id="scorePercent">0%</span>
                <span class="score-label" id="scoreLabel">0/15</span>
            </div>
            <h2 id="resultTitle">Quiz Complete!</h2>
            <p id="resultMessage"></p>
            <div class="results-actions">
                <button class="btn-secondary" onclick="retryQuiz()">Try Again</button>
                <a href="../labs/cryptography-lab.html" class="btn-secondary">üìö Review Lab</a>
                <a href="../index.html" class="btn-primary">üõ°Ô∏è Back to Shield</a>
            </div>
        </div>
    </div>

    <script>
        const questions = [
            {
                question: "Which encryption type uses a single shared key for both encryption and decryption?",
                options: ["Asymmetric encryption", "Symmetric encryption", "Hashing", "Digital signatures"],
                correct: 1,
                category: "Encryption Basics",
                explanation: "Symmetric encryption uses the same key for both encryption and decryption. Examples include AES and 3DES. It's fast but has the key distribution problem."
            },
            {
                question: "Why is AES-256 key length shorter than RSA-2048 for equivalent security?",
                options: [
                    "AES is less secure",
                    "RSA doesn't actually encrypt data",
                    "Symmetric algorithms are more efficient per bit of key",
                    "The numbers are measured in different units"
                ],
                correct: 2,
                category: "Encryption Basics",
                explanation: "Symmetric algorithms provide more security per bit of key length. A 256-bit AES key provides equivalent security to approximately a 15,360-bit RSA key. This is why we use larger key sizes for asymmetric cryptography."
            },
            {
                question: "What property ensures that a small change to hash input produces a completely different output?",
                options: ["Collision resistance", "Pre-image resistance", "Avalanche effect", "Determinism"],
                correct: 2,
                category: "Hashing",
                explanation: "The avalanche effect means that even a single bit change in the input causes approximately half of the output bits to change. This prevents attackers from making small adjustments to find collisions."
            },
            {
                question: "Which hash algorithm is considered broken and should NOT be used for security purposes?",
                options: ["SHA-256", "SHA-3", "MD5", "BLAKE2"],
                correct: 2,
                category: "Hashing",
                explanation: "MD5 is cryptographically broken with known collision attacks. It should never be used for security-critical applications like certificate signing or password hashing. SHA-256 or SHA-3 are recommended."
            },
            {
                question: "In Diffie-Hellman key exchange, what can an eavesdropper see on the network?",
                options: [
                    "The shared secret",
                    "Both private keys",
                    "Public values (g, p, A, B) but not the shared secret",
                    "Nothing - all traffic is encrypted"
                ],
                correct: 2,
                category: "Key Exchange",
                explanation: "Eve can see the public values g, p, and the exchanged public values A and B. However, computing the shared secret from these values requires solving the discrete logarithm problem, which is computationally infeasible with proper parameters."
            },
            {
                question: "What attack is basic Diffie-Hellman vulnerable to?",
                options: ["Brute force attack", "Man-in-the-middle attack", "Birthday attack", "Padding oracle attack"],
                correct: 1,
                category: "Key Exchange",
                explanation: "Basic DH doesn't authenticate the parties. An attacker in the middle can perform separate key exchanges with each party, intercepting all communication. This is why TLS uses authenticated DH variants with certificates."
            },
            {
                question: "When creating a digital signature, which key is used to sign the message?",
                options: ["Sender's public key", "Sender's private key", "Receiver's public key", "Receiver's private key"],
                correct: 1,
                category: "Digital Signatures",
                explanation: "Digital signatures are created using the sender's private key. Anyone can verify the signature using the sender's public key. This proves authenticity (only the private key holder could create it) and non-repudiation."
            },
            {
                question: "What does a digital signature provide that encryption alone does not?",
                options: ["Confidentiality", "Non-repudiation and authentication", "Key exchange", "Compression"],
                correct: 1,
                category: "Digital Signatures",
                explanation: "Digital signatures provide authentication (proving who sent the message) and non-repudiation (the sender cannot deny having sent it). Encryption only provides confidentiality."
            },
            {
                question: "What is the purpose of a Certificate Authority (CA)?",
                options: [
                    "Generate encryption keys for websites",
                    "Vouch for the identity of public key owners",
                    "Store user passwords securely",
                    "Provide VPN services"
                ],
                correct: 1,
                category: "PKI",
                explanation: "CAs are trusted third parties that verify identities and issue certificates binding public keys to their owners. This solves the key distribution problem - you can trust a public key if a CA has vouched for it."
            },
            {
                question: "In a certificate chain, what signs an intermediate CA's certificate?",
                options: ["The end-entity certificate", "The intermediate CA itself", "The root CA", "The web browser"],
                correct: 2,
                category: "PKI",
                explanation: "In PKI, the root CA (trust anchor) signs intermediate CA certificates. Intermediate CAs then sign end-entity certificates. This chain of trust ultimately leads back to a root CA pre-installed in browsers/operating systems."
            },
            {
                question: "Why is ECB (Electronic Codebook) mode considered insecure?",
                options: [
                    "It uses weak encryption algorithms",
                    "Identical plaintext blocks produce identical ciphertext blocks, revealing patterns",
                    "It requires very long keys",
                    "It cannot encrypt files larger than one block"
                ],
                correct: 1,
                category: "Block Cipher Modes",
                explanation: "ECB encrypts each block independently with the same key. This means identical plaintext blocks produce identical ciphertext, revealing patterns in the data (the famous 'ECB penguin' demonstration)."
            },
            {
                question: "What additional security feature does GCM (Galois/Counter Mode) provide compared to CBC?",
                options: [
                    "Faster encryption speed",
                    "Smaller ciphertext size",
                    "Built-in authentication/integrity verification",
                    "Better key derivation"
                ],
                correct: 2,
                category: "Block Cipher Modes",
                explanation: "GCM is an authenticated encryption mode that provides both confidentiality AND integrity/authentication. It detects if ciphertext has been tampered with, which CBC alone cannot do."
            },
            {
                question: "Why should passwords be hashed with a salt rather than encrypted?",
                options: [
                    "Hashing is faster than encryption",
                    "Encryption keys could be stolen and passwords recovered; hashing is one-way",
                    "Salting is only used with encryption",
                    "Hashing produces shorter outputs"
                ],
                correct: 1,
                category: "Applied Crypto",
                explanation: "Password hashing is one-way - you can verify passwords but can't recover them. If encryption keys were stolen, all passwords could be decrypted. Salting adds uniqueness so identical passwords don't produce identical hashes."
            },
            {
                question: "In TLS, why do we use asymmetric crypto first, then switch to symmetric?",
                options: [
                    "Symmetric algorithms are more secure",
                    "To safely exchange a symmetric key, then use it for fast bulk encryption",
                    "Asymmetric algorithms can't encrypt data",
                    "TLS only uses symmetric encryption"
                ],
                correct: 1,
                category: "Applied Crypto",
                explanation: "Asymmetric crypto solves the key exchange problem but is slow (~1000x slower than symmetric). We use it to securely establish a shared symmetric key, then switch to fast symmetric encryption for the session data."
            },
            {
                question: "What mechanism allows browsers to check if a certificate has been revoked before it expires?",
                options: [
                    "DNS lookup",
                    "Certificate Revocation List (CRL) or OCSP",
                    "SSL inspection",
                    "Two-factor authentication"
                ],
                correct: 1,
                category: "PKI",
                explanation: "CRL (Certificate Revocation List) is a list of revoked certificates published by the CA. OCSP (Online Certificate Status Protocol) allows real-time checking. These detect compromised certificates before their natural expiration."
            }
        ];

        let userAnswers = new Array(questions.length).fill(null);
        let submitted = false;

        function initQuiz() {
            const container = document.getElementById('quizContainer');
            const progressDots = document.getElementById('progressDots');

            progressDots.innerHTML = questions.map((_, i) =>
                `<div class="progress-dot" id="dot${i}"></div>`
            ).join('');

            container.innerHTML = questions.map((q, i) => `
                <div class="question-card" id="question${i}">
                    <div class="question-header">
                        <div class="question-number">${i + 1}</div>
                        <span class="question-category">${q.category}</span>
                    </div>
                    <div class="question-text">${q.question}</div>
                    <div class="options">
                        ${q.options.map((opt, j) => `
                            <label class="option" id="opt${i}-${j}" onclick="selectOption(${i}, ${j})">
                                <input type="radio" name="q${i}" value="${j}">
                                <span class="option-marker">${String.fromCharCode(65 + j)}</span>
                                <span>${opt}</span>
                            </label>
                        `).join('')}
                    </div>
                    <div class="explanation" id="exp${i}">
                        <h4>üí° Explanation</h4>
                        <p>${q.explanation}</p>
                    </div>
                </div>
            `).join('');
        }

        function selectOption(questionIndex, optionIndex) {
            if (submitted) return;
            document.querySelectorAll(`[id^="opt${questionIndex}-"]`).forEach(opt => opt.classList.remove('selected'));
            document.getElementById(`opt${questionIndex}-${optionIndex}`).classList.add('selected');
            userAnswers[questionIndex] = optionIndex;
            document.getElementById(`dot${questionIndex}`).classList.add('answered');
        }

        function submitQuiz() {
            const unanswered = userAnswers.filter(a => a === null).length;
            if (unanswered > 0) {
                alert(`Please answer all questions. ${unanswered} question(s) remaining.`);
                return;
            }

            submitted = true;
            document.getElementById('submitBtn').disabled = true;

            let correct = 0;
            questions.forEach((q, i) => {
                const userAnswer = userAnswers[i];
                const isCorrect = userAnswer === q.correct;
                if (isCorrect) {
                    correct++;
                    document.getElementById(`opt${i}-${userAnswer}`).classList.add('correct');
                    document.getElementById(`dot${i}`).classList.add('correct');
                } else {
                    document.getElementById(`opt${i}-${userAnswer}`).classList.add('incorrect');
                    document.getElementById(`opt${i}-${q.correct}`).classList.add('correct');
                    document.getElementById(`dot${i}`).classList.add('incorrect');
                }
                document.getElementById(`exp${i}`).classList.add('show');
            });

            const percent = Math.round((correct / questions.length) * 100);
            const passed = percent >= 70;

            document.getElementById('scorePercent').textContent = percent + '%';
            document.getElementById('scoreLabel').textContent = `${correct}/${questions.length}`;
            document.getElementById('scoreCircle').classList.add(passed ? 'pass' : 'fail');
            document.getElementById('resultTitle').textContent = passed ? 'üéâ Congratulations!' : 'üìö Keep Learning!';
            document.getElementById('resultMessage').textContent = passed
                ? 'You have demonstrated solid understanding of cryptography concepts.'
                : 'Review the lab materials and focus on the explanations for missed questions.';
            document.getElementById('results').classList.add('show');
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });

            const results = JSON.parse(localStorage.getItem('shield_quiz_results') || '{}');
            results['cryptography'] = { score: correct, total: questions.length, percent, passed, date: new Date().toISOString() };
            localStorage.setItem('shield_quiz_results', JSON.stringify(results));
        }

        function retryQuiz() {
            userAnswers = new Array(questions.length).fill(null);
            submitted = false;
            document.getElementById('submitBtn').disabled = false;
            document.getElementById('results').classList.remove('show');
            document.getElementById('scoreCircle').classList.remove('pass', 'fail');
            document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected', 'correct', 'incorrect'));
            document.querySelectorAll('.progress-dot').forEach(dot => dot.classList.remove('answered', 'correct', 'incorrect'));
            document.querySelectorAll('.explanation').forEach(exp => exp.classList.remove('show'));
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        document.addEventListener('DOMContentLoaded', initQuiz);
    </script>
</body>
</html>
