<!DOCTYPE html>
<html>
  <head><br>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Z91PVQTWCZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Z91PVQTWCZ');
</script>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="chrome=1,IE=edge" />
	<title>oscommandinjection</title><br>
	<meta name="keyword" content="attack, web, injection, headers, code, vulnerability, operating system, attack" />
		<meta name="description" content="Learn how attackers can exploit vulnerable web application by creating scripts that execute commands. " />
	<style>
		html {
			height:100%;
		}
		body {
			background-color:#FFF;
			margin:0;
			height:100%;
		}
	
/* Hexworth Academy - House of Shield Branding */
.hexworth-wrapper {
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #0a0a0a 0%, #1a0a0a 50%, #0a0a0a 100%);
    min-height: 100vh;
    padding: 0;
    margin: 0;
}
.hexworth-header {
    background: linear-gradient(135deg, #1a0a0a 0%, #8b0000 50%, #dc143c 100%);
    padding: 12px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    box-shadow: 0 4px 20px rgba(220, 20, 60, 0.3);
}
.hexworth-logo {
    display: flex;
    align-items: center;
    gap: 12px;
    color: white;
    text-decoration: none;
}
.hexworth-logo-icon { font-size: 28px; }
.hexworth-logo-text { font-size: 18px; font-weight: 600; letter-spacing: 1px; }
.hexworth-badge {
    background: linear-gradient(135deg, #1a1a1a, #333333);
    color: #dc143c;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    border: 1px solid #dc143c;
}
.hexworth-content { display: flex; justify-content: center; padding: 20px; }
.hexworth-footer {
    background: rgba(26, 10, 10, 0.8);
    color: rgba(255,255,255,0.7);
    text-align: center;
    padding: 12px;
    font-size: 12px;
}
.hexworth-footer a { color: #dc143c; text-decoration: none; }
.hexworth-footer a:hover { color: #ff6b6b; }

	</style>
	<!-- copy these lines to your document head: -->

	<meta name="viewport" content="user-scalable=yes, width=700" />
	<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:600&subset=latin' rel='stylesheet' type='text/css'>
	<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro&subset=latin' rel='stylesheet' type='text/css'>

	<!-- end copy -->
  </head>
  <body>
<div class="hexworth-wrapper">
    <header class="hexworth-header">
        <a href="../../../catalog.html?theme=academy" class="hexworth-logo">
            <span class="hexworth-logo-icon">üè∞</span>
            <span class="hexworth-logo-text">Hexworth Academy</span>
        </a>
        <span class="hexworth-badge">üõ°Ô∏è House of Shield</span>
    </header>
    <div class="hexworth-content">

<!-- copy these lines to your document: -->

	<div id="oscommandinjection_hype_container" class="HYPE_document" style="margin:auto;position:relative;width:700px;height:550px;overflow:hidden;">
		<script type="text/javascript" charset="utf-8" src="oscommandinjection.hyperesources/oscommandinjection_hype_generated_script.js"></script>
	</div>

	<!-- end copy -->
	


	<!-- text content for search engines: -->

	<div style="display:none" aria-hidden=true>

		<div>OS Command Injection</div>
		<div>1/13</div>
		<div></div>
		<div>This material was developed with funding from the
National Science Foundation under Grant # DUE 1601612
</div>
		<div>Next</div>
		<div>Restart</div>
		<div>Back</div>
		<div>2/13</div>
		<div>When we go to a movie theater to see a movie, we drive to the cinema and we request the movie we want to see by purchasing a ticket to that particular movie. We then exchange the ticket we have purchased for access to the movie theater in which the movie we have chosen will play from the projector. When the projector starts the movie is delivered to the screen and you are able to watch it</div>
		<div>When we open our computer to visit a website, we type the website address into the address bar of our web browser to launch a request for the website we have choosen. The request for the webpage is sent through the internet to the web server and the web server replies to us with the entire code for all of the content of the webpage. These are downloaded to your computer and displayed through your web browser and you are able to see the webpage. Many websites and web applications include opportunities for users to insert user supplied data such as cookies, forms, and HTTP headers.</div>
		<div>3/13</div>
		<div>Close¬†</div>
		<div>5/13</div>
		<div>Attackers can exploit vulnerable web applications by creating scripts that execute commands on a web application server operating system. Attackers that have created these scripts then need to deliver the script to web application user‚Äôs browsers. To do this they embed or hide the script in user cookies, form data, HTML headers, or the web application code itself which is downloaded automatically and executed through your browser when you visit the web application. These type of attacks are called operating system (OS) command injection attacks.</div>
		<div>Operating System (OS) Command Injection Attacks

attack in which the goal is execution of commands on the webserver operating system via a vulnerable web application or website. Command injection attacks are possible when an application passes unsafe user supplied data (forms, cookies, HTTP headers etc.) to a system shell.</div>
		<div>But what if all of a sudden the movie changed without you doing anything because someone else is controlling the movie projector through your ticket purchase?</div>
		<div>4/13</div>
		<div>Attackers can develop scripts that run these commands as if they are coming from the user‚Äôs browser. The script creates and sends the same commands to the target website in the same manner as if the user had submitted them themselves. As such the web application can detect that the commands came from the user but cannot detect that the request was created and sent by a malicious script running in the user‚Äôs browser.</div>
		<div>8/13</div>
		<div>http://www.</div>
		<div>‚Äú;‚Äù</div>
		<div>‚Äú&‚Äù</div>
		<div>‚Äú&&‚Äù</div>
		<div>Attackers wishing to use OS command injection attacks must begin by identifying a critical vulnerability in a web application. Vulnerable pages are pages that appear to execute system commands like ping, nslookup, tracert, or CGI scripts. To determine if a web application is vulnerable, an attacker can test it by inserting commands into the user supplied data inputs to see how the application responds. Usually this begins by trying various symbols that are interpreted by operating system command line as a separator between commands. Other commands symbols that are used by the operating system shells are useful to try as well.</div>
		<div>9/13</div>
		<div>submit</div>
		<div>Next, once an attacker discovers a vulnerable web application, they are able to insert malicious code into the OS and gain any functionality the underlying application offers. The attackers can unleash the attack even without direct access to the OS. To do this, the attacker alters dynamically generated content on a web page using HTML code through an input mechanism such as a form field or cookies.</div>
		<div>10/13</div>
		<div>Finally, once the code is inserted into the affected web page, browsers interpret the code. This allows the attackers to execute specific commands across user's computers and allows the attacker to carry out any action that the application itself can carry out, including reading or modifying all of its data and performing privileged actions.</div>
		<div>11/13</div>
		<div>12/13</div>
		<div>Vulnerable web application code allows unsafe user supplied data from forms, cookies, HTTP headers, etc. into the command line of the operating system. For example vulnerable web application code may allow the user to input additional operating system commands. In this situation the website IP address is pinged but the operating command line separator ‚Äú&&‚Äù is used to execute a second operating system command requesting directory information on the web server.</div>
		<div>Pinging 127.0.0.1 with 32 bytes of data:
Reply from 127.0.0.1: bytes=32 time<1ns TTL=128
Reply from 127.0.0.1: bytes=32 time<1ns TTL=128
Reply from 127.0.0.1: bytes=32 time<1ns TTL=128
Reply from 127.0.0.1: bytes=32 time<1ns TTL=128

Ping statistics for 127.0.0.1:
¬† ¬† Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),
Approximate round trip times in milli-seconds:
¬† ¬† Minimum = 0ns, Maximum = 0ns, Average = 0ns
Volume in drive C has no label.
Volume Serial Number is 9021-8008

Directory of C:\xanpp\htdocs\dvwa\vulnerabilities\exec
12/222016 ¬† 01:33 AM
¬† ¬† ¬† ¬† 12/22/2016 ¬†‚Äò ¬†01:33AM
¬† ¬† ¬† ¬† ¬† ¬† ¬† 12/22/2016 ¬†'' ¬†01:33AM
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†help
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†12/22/2016 ¬† ¬†01:33AM ¬† ¬† ¬† ¬† ¬† ¬† ¬†1,830 index.php

</div>
		<div>192.168.0.102</div>
		<div>127.0.0.1 && dir
</div>
		<div>Enter an IP address:</div>
		<div>1</div>
		<div>Arguments

a value that is passed between programs, subroutines or functions. Arguments are independent items, or variables, that contain data or codes.</div>
		<div>Escape values added to OS commands</div>
		<div>2</div>
		<div>So how do we prevent a website from being vulnerable to OS command injection when building websites or web applications?

Click each item below for more information.
</div>
		<div>Separate data and commands and perform input validation</div>
		<div>13/13</div>
		<div>The primary defense is to avoid calling OS commands directly. Built-in library functions are a very good alternative to OS Commands, and they cannot be manipulated to perform tasks other than those it is intended to do.¬†
For example use ‚Äúmkdir()‚Äù instead of system(‚Äúmkdir /dir_name‚Äù).
</div>
		<div>If it is considered unavoidable the call to a system command incorporated with user-supplied, use structured mechanisms that automatically enforce the separation between data and command and perform input validation. When it comes to the commands used, these must be validated against a whitelist of allowed commands. Regarding arguments used for these commands, they should be validated using ‚Äúwhitelist‚Äù input validation and whitelist of good characters allowed and the maximum length of the string.

For example, ensure that characters like & | ¬†; $ > < ` \¬†! and white-spaces are not part of the expression.</div>
		<div>Prevent calling OS commands directly</div>
		<div>3</div>
		<div>A secondary defense is to avoid values that can be added to OS commands in each type of OS.

For examples, escapeshellarg() or escapeshellcmd() in PHP.</div>
		<div>pwn

is a hacker slang term derived from the verb own, meaning to appropriate or to conquer.</div>
		<div>7/13</div>
		<div>Multiple commands can be run by using various symbols that are interpreted by operating system command line as a separator between commands. There are many of these but some examples are ‚Äú;‚Äù, ‚Äú&‚Äù, ‚Äú&&‚Äù, ‚Äú|‚Äù, and ‚Äú||‚Äù. The most efficient way to run multiple commands however is to automate them via scripting. When it comes to operating system (OS) command injection attacks, commands are embedded in a script which execute through the users browser and run on and attack the web server hosting the website or web application. The intent of these attacks is to steal information from, delete information from, compromise, or pwn the webserver.</div>
		<div>Operating system commands via the command line interface; which is a means of interacting with a computer where the user issues commands to the program. Commands can be used to determine operating system type and version, access directories, create new directories, view the contents of the file, delete a file deleting directories, copy directories, change file permissions, and do many other things.</div>
		<div>6/13</div>
		<div>Commands

are instructions to a computer program to perform a specific task. Most commonly a command is either a directive to some kind of command-line interface.¬†</div>

	</div>

	<!-- end text content: -->

    </div>
    <footer class="hexworth-footer">
        <p>Educational content powered by <a href="https://www.myemates.com" target="_blank">myEMATES</a> |
        NSF Grant #DUE 1601612 |
        <a href="../../../catalog.html">‚Üê Back to Catalog</a></p>
    </footer>
</div>
</body>
</html>
