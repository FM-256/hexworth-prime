<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Encryption Lab ‚Äî ASCII ‚Üî Binary ‚Üî Hex Applet</title>
  <style>
    :root{
      --bg:#f6f8fb; --panel:#ffffff; --text:#0f172a; --muted:#5b6b88; --accent:#2563eb; --accent-2:#0ea5e9; --ok:#16a34a; --warn:#eab308; --err:#ef4444; --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --border: #e2e8f0; --shadow: 0 6px 22px rgba(15,23,42,.08);
    }
    .dark{ --bg:#0b1220; --panel:#0f172a; --text:#e5e7eb; --muted:#93a2bf; --accent:#60a5fa; --accent-2:#67e8f9; --border:#1f2a44; --shadow: 0 6px 22px rgba(0,0,0,.45); }
    html,body{height:100%}
    body{margin:0; background:var(--bg); color:var(--text); font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";}
    .container{max-width:1100px; margin:32px auto; padding:0 20px}
    .card{background:var(--panel); border:1px solid var(--border); border-radius:16px; box-shadow:var(--shadow); padding:20px}
    h1{font-size:28px; margin:0 0 8px; letter-spacing:.2px}
    h2{font-size:20px; margin:18px 0 10px}
    p.muted{color:var(--muted); margin:6px 0 18px}
    .row{display:grid; gap:16px}
    @media(min-width:900px){ .row.cols-2{grid-template-columns:1fr 1fr} .row.cols-3{grid-template-columns:1fr 1fr 1fr} }
    .input, textarea{width:100%; box-sizing:border-box; background:linear-gradient(#fff,#fff) padding-box, linear-gradient(135deg,var(--border),transparent) border-box; border:1px solid var(--border); color:var(--text); border-radius:12px; padding:12px 14px; outline:none;}
    textarea{min-height:86px; resize:vertical}
    .btn{display:inline-flex; align-items:center; gap:8px; background:var(--accent); color:#fff; border:none; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:600}
    .btn.ghost{background:transparent; color:var(--accent); border:1px solid var(--accent)}
    .btn.small{padding:6px 10px; font-weight:600; border-radius:8px}
    .bar{display:flex; flex-wrap:wrap; gap:8px; align-items:center}
    .muted-badge{display:inline-block; font-size:12px; color:var(--muted)}
    .output{font-family:var(--mono); background:linear-gradient(#0b122003,#0b122003); border:1px dashed var(--border); padding:12px; border-radius:10px; line-height:1.6; word-break:break-word; white-space:pre-wrap}
    .tag{font-family:var(--mono); font-size:12px; background:#e2e8f0; color:#0f172a; padding:2px 6px; border-radius:6px}
    .dark .tag{background:#1f2a44; color:#cbd5e1}
    .grid{display:grid; gap:8px;}
    .keytable{width:100%; border-collapse:collapse; font-family:var(--mono); font-size:14px}
    .keytable th,.keytable td{border:1px solid var(--border); padding:8px; text-align:center}
    .keytable th{background:rgba(99,102,241,.1)}
    .hint{font-size:13px; color:var(--muted)}
    .switch{display:inline-flex; align-items:center; gap:8px; cursor:pointer; user-select:none}
    .switch input{display:none}
    .switch .pill{width:44px; height:24px; background:var(--border); border-radius:999px; position:relative; transition:.2s}
    .switch .dot{width:18px; height:18px; background:#fff; border-radius:50%; position:absolute; top:3px; left:3px; transition:.2s}
    .dark .switch .dot{background:#0b1220}
    .switch input:checked + .pill{background:var(--accent)}
    .switch input:checked + .pill .dot{left:23px}
    .pill-note{font-family:var(--mono); font-size:12px; color:var(--muted)}
    .accordion{border:1px solid var(--border); border-radius:12px; overflow:hidden}
    .acc-item + .acc-item{border-top:1px solid var(--border)}
    .acc-head{background:linear-gradient(180deg, rgba(2,6,23,.02), transparent); cursor:pointer; padding:12px 14px; display:flex; align-items:center; justify-content:space-between}
    .acc-body{padding:12px 14px; display:none}
    .acc-item.open .acc-body{display:block}
    .help{color:var(--accent-2); text-decoration:underline dotted; cursor:help}
    .copy{margin-left:auto}
    .small{font-size:12px}
    .kbd{font-family:var(--mono); background:#1118270f; padding:2px 6px; border-radius:6px}
    .flex{display:flex; gap:10px; align-items:center}
    .right{margin-left:auto}
    .divider{height:1px; background:var(--border); margin:14px 0}
    .caps{letter-spacing:.08em; text-transform:uppercase; font-size:12px; color:var(--muted)}
    .step{padding:8px 10px; border-radius:10px; background:linear-gradient(180deg, rgba(2,6,23,.03), transparent); border:1px solid var(--border); font-family:var(--mono)}
  </style>
</head>
<body>
<div class="hexworth-wrapper" style="font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #0a0a0a 0%, #1a0a0a 50%, #0a0a0a 100%); min-height: 100vh; margin: 0; padding: 0;">
    <header style="background: linear-gradient(135deg, #1a0a0a 0%, #8b0000 50%, #dc143c 100%); padding: 12px 20px; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 4px 20px rgba(220, 20, 60, 0.3);">
        <a href="../../../catalog.html?theme=academy" style="display: flex; align-items: center; gap: 12px; color: white; text-decoration: none;">
            <span style="font-size: 28px;">üè∞</span>
            <span style="font-size: 18px; font-weight: 600; letter-spacing: 1px;">Hexworth Academy</span>
        </a>
        <span style="background: linear-gradient(135deg, #1a1a1a, #333333); color: #dc143c; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; border: 1px solid #dc143c;">üõ°Ô∏è House of Shield</span>
    </header>
    <div style="display: flex; justify-content: center; padding: 20px;">

  <div class="container">
    <div class="bar" style="margin-bottom:14px">
      <h1 style="margin-right:auto">Encryption Lab ‚Äî ASCII ‚Üî Binary ‚Üî Hex</h1>
      <label class="switch" title="Toggle dark mode">
        <input id="darkToggle" type="checkbox" />
        <span class="pill"><span class="dot"></span></span>
        <span class="pill-note">Dark</span>
      </label>
    </div>

    <!-- Input & Live Conversion -->
    <div class="card">
      <h2>1) Input & Live Conversion</h2>
      <p class="muted">Type text to see how computers represent it at the byte level. Hover the <span class="help" title="Hex numbers often use the 0x prefix to indicate base 16. Example: 0x41 is decimal 65.">0x</span> badges for tips.</p>

      <div class="row cols-2">
        <div>
          <label class="caps">Plaintext</label>
          <textarea id="txt" placeholder="Type here ‚Äî e.g., Hello, World!"></textarea>
          <div class="bar" style="margin-top:8px">
            <button class="btn" id="convertBtn">Convert</button>
            <button class="btn ghost" id="clearBtn">Reset</button>
            <span class="hint">Tip: Click <span class="kbd">Convert</span> or press <span class="kbd">Enter</span> inside the field.</span>
          </div>
        </div>
        <div class="grid">
          <div>
            <div class="bar"><span class="caps">ASCII (decimal)</span><button class="btn small ghost copy" data-copy="asciiOut">Copy</button></div>
            <div id="asciiOut" class="output" aria-live="polite"></div>
          </div>
          <div>
            <div class="bar"><span class="caps">Binary (8-bit)</span><button class="btn small ghost copy" data-copy="binOut">Copy</button></div>
            <div id="binOut" class="output" aria-live="polite"></div>
          </div>
          <div>
            <div class="bar"><span class="caps">Hexadecimal <span class="tag" title="Hex literal prefix (base 16)">0x</span></span><button class="btn small ghost copy" data-copy="hexOut">Copy</button></div>
            <div id="hexOut" class="output" aria-live="polite"></div>
          </div>
        </div>
      </div>

      <div class="divider"></div>

      <!-- How Hex Works -->
      <h2>2) How Hex Works <span class="hint">Each 4 bits (nibble) = 1 hex digit</span></h2>
      <div class="accordion" id="hexAccordion">
        <div class="acc-item open">
          <div class="acc-head"><strong>Live nibble grouping</strong><span>‚ñæ</span></div>
          <div class="acc-body">
            <p class="small">For each character, we split the 8-bit binary into two nibbles and map them to hex.</p>
            <div id="nibbleOut" class="output"></div>
          </div>
        </div>
        <div class="acc-item">
          <div class="acc-head"><strong>Hex Key Table</strong> <span>‚ñæ</span></div>
          <div class="acc-body">
            <table class="keytable" aria-label="Hex key table">
              <thead>
                <tr><th>Decimal</th><th>Binary (4-bit)</th><th>Hex</th></tr>
              </thead>
              <tbody id="hexKeyBody"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <br/>

    <!-- XOR Section -->
    <div class="card">
      <h2>3) XOR Encryption (Interactive)</h2>
      <p class="muted">XOR is reversible: <code class="tag">C = P XOR K</code> and <code class="tag">P = C XOR K</code>. Try a one-character key first.</p>
      <div class="row cols-2">
        <div>
          <label class="caps">XOR Key <span class="hint">single char or byte (e.g., P)</span></label>
          <input class="input" id="xorKey" placeholder="Enter key, e.g., P" />
          <div class="bar" style="margin-top:8px">
            <button class="btn" id="xorBtn">Encrypt / Decrypt</button>
            <button class="btn ghost" id="xorClear">Clear</button>
          </div>
          <p class="hint">Same operation decrypts it because XOR is its own inverse.</p>
        </div>
        <div class="grid">
          <div>
            <div class="caps">Plaintext (Hex)</div>
            <div id="ptHex" class="output"></div>
          </div>
          <div>
            <div class="caps">Key (Hex)</div>
            <div id="keyHex" class="output"></div>
          </div>
          <div>
            <div class="caps">Ciphertext (Hex)</div>
            <div id="ctHex" class="output"></div>
          </div>
        </div>
      </div>

      <div class="divider"></div>

      <div class="accordion" id="xorAccordion">
        <div class="acc-item open">
          <div class="acc-head"><strong>Show byte‚Äëby‚Äëbyte steps</strong><span>‚ñæ</span></div>
          <div class="acc-body">
            <div id="xorSteps" class="grid"></div>
          </div>
        </div>
      </div>
    </div>

    <br/>

    <!-- Notes -->
    <div class="card">
      <h2>4) Notes & Tips</h2>
      <ul class="hint">
        <li><span class="help" title="ASCII uses one byte per character (0‚Äì127 typical). Unicode/UTF‚Äë8 can use multiple bytes.">ASCII vs Unicode</span>: this app focuses on plain ASCII for clarity.</li>
        <li>Odd results? Check for spaces or emojis ‚Äî they are multi‚Äëbyte.</li>
        <li>Uppercase and lowercase differ by one bit in ASCII (the 0x20 bit).</li>
        <li>Two hex digits = one byte. Example: <code class="tag">0x41</code> = decimal 65 = <code class="tag">01000001</code>.</li>
      </ul>
    </div>
  </div>

  <script>
    // --- Dark mode toggle
    const darkToggle = document.getElementById('darkToggle');
    const storedTheme = localStorage.getItem('applet-theme');
    if(storedTheme==='dark'){ document.documentElement.classList.add('dark'); darkToggle.checked=true }
    darkToggle.addEventListener('change', ()=>{
      document.documentElement.classList.toggle('dark', darkToggle.checked);
      localStorage.setItem('applet-theme', darkToggle.checked ? 'dark' : 'light');
    });

    // --- Elements
    const txt = document.getElementById('txt');
    const asciiOut = document.getElementById('asciiOut');
    const binOut = document.getElementById('binOut');
    const hexOut = document.getElementById('hexOut');
    const nibbleOut = document.getElementById('nibbleOut');

    const ptHex = document.getElementById('ptHex');
    const keyHex = document.getElementById('keyHex');
    const ctHex = document.getElementById('ctHex');
    const xorKey = document.getElementById('xorKey');
    const xorSteps = document.getElementById('xorSteps');

    // --- Buttons
    const convertBtn = document.getElementById('convertBtn');
    const clearBtn = document.getElementById('clearBtn');
    const xorBtn = document.getElementById('xorBtn');
    const xorClear = document.getElementById('xorClear');

    // Utility: copy
    document.querySelectorAll('.copy').forEach(btn=>{
      btn.addEventListener('click', async ()=>{
        const id = btn.getAttribute('data-copy');
        const text = document.getElementById(id).textContent.trim();
        if(!text) return;
        try{ await navigator.clipboard.writeText(text); btn.textContent='Copied'; setTimeout(()=>btn.textContent='Copy',1200);}catch(e){ alert('Copy failed'); }
      });
    });

    // Accordion toggle
    document.querySelectorAll('.acc-head').forEach(h=>{
      h.addEventListener('click', ()=> h.parentElement.classList.toggle('open'))
    })

    // Build hex key table
    const hexKeyBody = document.getElementById('hexKeyBody');
    const pad4 = n => n.toString(2).padStart(4,'0');
    for(let i=0;i<16;i++){
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${i}</td><td>${pad4(i)}</td><td>0x${i.toString(16).toUpperCase()}</td>`;
      hexKeyBody.appendChild(tr);
    }

    // Core conversions
    function toAsciiCodes(s){
      const arr=[]; for(const ch of s){ arr.push(ch.codePointAt(0)); } return arr;
    }
    const toBin = n => n.toString(2).padStart(8,'0');
    const toHex = n => '0x'+n.toString(16).toUpperCase().padStart(2,'0');

    function renderConversions(){
      const s = txt.value || '';
      // Only handle simple ASCII (0-127) clearly; show notice for others
      const codes = toAsciiCodes(s);
      asciiOut.textContent = codes.join(' ');
      binOut.textContent = codes.map(toBin).join(' ');
      hexOut.textContent = codes.map(toHex).join(' ');

      // Nibble grouping visual
      let lines = [];
      codes.forEach((c, idx)=>{
        const bin = toBin(c);
        const left = bin.slice(0,4), right = bin.slice(4);
        const hx = c.toString(16).toUpperCase().padStart(2,'0');
        const ch = s[idx] === ' ' ? '‚ê†' : s[idx];
        lines.push(
`Char: ${ch}   ASCII: ${c}
${left} ${right}  ‚Üí  0x${hx[0]} 0x${hx[1]} (== 0x${hx})\n`);
      });
      nibbleOut.textContent = lines.join('\n');

      // Update plaintext hex for XOR view
      ptHex.textContent = codes.map(n=>toHex(n)).join(' ');
      keyHex.textContent = '';
      ctHex.textContent = '';
      xorSteps.innerHTML = '';
    }

    function doXor(){
      const s = txt.value || '';
      const key = xorKey.value || '';
      if(!key){ alert('Enter an XOR key (try a single letter like P)'); return; }
      const keyCodes = toAsciiCodes(key);
      const sCodes = toAsciiCodes(s);
      // Render key hex repeated
      keyHex.textContent = sCodes.map((_,i)=> toHex(keyCodes[i % keyCodes.length]) ).join(' ');
      // Cipher
      const ct = sCodes.map((c,i)=> c ^ keyCodes[i % keyCodes.length]);
      ctHex.textContent = ct.map(n=>toHex(n)).join(' ');

      // Steps
      xorSteps.innerHTML = '';
      sCodes.forEach((p,i)=>{
        const k = keyCodes[i % keyCodes.length];
        const c = p ^ k;
        const step = document.createElement('div');
        step.className = 'step';
        step.innerHTML = `#${i+1}  P=${toHex(p)} (${toBin(p)})  XOR  K=${toHex(k)} (${toBin(k)})  ‚Üí  C=${toHex(c)} (${toBin(c)})`;
        xorSteps.appendChild(step);
      });
    }

    // Events
    convertBtn.addEventListener('click', renderConversions);
    clearBtn.addEventListener('click', ()=>{ txt.value=''; renderConversions(); });
    xorBtn.addEventListener('click', doXor);
    xorClear.addEventListener('click', ()=>{ xorKey.value=''; keyHex.textContent=''; ctHex.textContent=''; xorSteps.innerHTML=''; });

    // Enter key inside textarea triggers convert
    txt.addEventListener('keydown', (e)=>{
      if(e.key==='Enter' && (e.metaKey || e.ctrlKey)) { e.preventDefault(); renderConversions(); }
    });

    // First render (empty)
    renderConversions();
  </script>
    </div>
    <footer style="background: rgba(26, 10, 10, 0.8); color: rgba(255,255,255,0.7); text-align: center; padding: 12px; font-size: 12px;">
        <p>Educational content | <a href="../../../catalog.html" style="color: #dc143c; text-decoration: none;">‚Üê Back to Catalog</a></p>
    </footer>
</div>
</body>
</html>