<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Hashing & Steganography ‚Äî Interactive Presentation</title>
<style>
  :root { --bg:#f4f6fa; --text:#222; --card:#ffffff; --muted:#334155; --accent:#1e3a8a; --header:#1e3a8a; --headerText:#ffffff; }
  *{box-sizing:border-box}
  body{font-family:Arial,Helvetica,sans-serif;margin:0;background:var(--bg);color:var(--text);transition:background .6s,color .6s}
  .container{max-width:1200px;margin:auto;padding:20px}
  section{padding:40px;max-width:1000px;margin:40px auto;background:var(--card);border-radius:16px;box-shadow:0 0 10px rgba(0,0,0,.08);transition:background .6s,color .6s,opacity .6s ease,transform .6s ease;opacity:0;transform:translateY(18px)}
  section.active{opacity:1;transform:translateY(0)}
  h1,h2{text-align:center;color:var(--accent);transition:color .6s}
  p,li{color:var(--muted);line-height:1.7}
  .controls,.nav-controls{position:fixed;z-index:1000;display:flex;gap:10px}
  .controls{top:10px;right:10px}
  .nav-controls{bottom:10px;right:10px;align-items:center}
  button{padding:10px 16px;border:0;border-radius:10px;cursor:pointer;font-size:14px;color:#fff;transition:transform .2s}
  button:hover{transform:scale(1.05)}
  #randomize{background:#2563eb}
  #reset{background:#ef4444}
  #nextBtn{background:#16a34a}
  #prevBtn{background:#a16207}
  #progressBar{position:fixed;bottom:0;left:0;height:6px;background:var(--accent);transition:width .4s ease;z-index:2000;width:33.333%}
  .interactive{background:#f0f9ff;padding:15px;border-radius:10px;border:1px solid #d1d5db;margin-top:15px}
  textarea,input{width:100%;padding:8px;margin-top:8px;border-radius:8px;border:1px solid #d1d5db}
  pre{white-space:pre-wrap;word-break:break-all}
  .sr-only{position:absolute;left:-9999px}
</style>
</head>
<body>
<div class="hexworth-wrapper" style="font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #0a0a0a 0%, #1a0a0a 50%, #0a0a0a 100%); min-height: 100vh; margin: 0; padding: 0;">
    <header style="background: linear-gradient(135deg, #1a0a0a 0%, #8b0000 50%, #dc143c 100%); padding: 12px 20px; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 4px 20px rgba(220, 20, 60, 0.3);">
        <a href="../../../catalog.html?theme=academy" style="display: flex; align-items: center; gap: 12px; color: white; text-decoration: none;">
            <span style="font-size: 28px;">üè∞</span>
            <span style="font-size: 18px; font-weight: 600; letter-spacing: 1px;">Hexworth Academy</span>
        </a>
        <span style="background: linear-gradient(135deg, #1a1a1a, #333333); color: #dc143c; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; border: 1px solid #dc143c;">üõ°Ô∏è House of Shield</span>
    </header>
    <div style="display: flex; justify-content: center; padding: 20px;">

<div class="controls">
  <button id="randomize">üé® Randomize Colors</button>
  <button id="reset">üîÅ Reset</button>
</div>
<div class="nav-controls">
  <button id="prevBtn">‚¨Ö Prev</button>
  <div id="progressText" style="color:var(--accent);font-weight:bold">1 / 3</div>
  <button id="nextBtn">Next ‚û°</button>
</div>
<div id="progressBar" role="progressbar" aria-valuemin="1" aria-valuemax="3" aria-valuenow="1"></div>
<div class="container">
  <section id="slide1" class="active">
    <h1>üîê Hashing & Steganography</h1>
    <p style="text-align:center;font-size:1.2em;color:var(--muted)">Understanding Digital Fingerprints and Hidden Messages</p>
  </section>
  <section id="slide2">
    <h2>Interactive: Try Hashing</h2>
    <div class="interactive">
      <label for="hashInput">Enter Text to Hash</label>
      <textarea id="hashInput" rows="3" placeholder="Type something..."></textarea>
      <button id="hashBtn" style="margin-top:10px;background:#2563eb;">Compute SHA-256</button>
      <div id="hashStatus" class="sr-only" aria-live="polite"></div>
      <pre id="hashResult" style="background:#e2e8f0;padding:10px;border-radius:8px;margin-top:10px;"></pre>
    </div>
  </section>
  <section id="slide3">
    <h2>Interactive: Steganography (Demo)</h2>
    <div class="interactive">
      <label for="stegoImage">Choose a PNG image</label>
      <input type="file" id="stegoImage" accept="image/png" />
      <label for="secretMsg">Secret Message</label>
      <input type="text" id="secretMsg" placeholder="Type a hidden message" />
      <button id="encodeBtn" style="margin-top:10px;background:#2563eb;">Hide Message</button>
      <button id="decodeBtn" style="margin-top:10px;background:#16a34a;">Reveal Message</button>
      <pre id="stegoOutput" style="background:#e2e8f0;padding:10px;border-radius:8px;margin-top:10px;"></pre>
    </div>
  </section>
</div>
<script>
/************ Slide system with progress ************/
let currentSlide = 1; const totalSlides = 3;
const slides = [document.getElementById('slide1'), document.getElementById('slide2'), document.getElementById('slide3')];
const progressBar = document.getElementById('progressBar');
const progressText = document.getElementById('progressText');
function showSlide(n){
  slides.forEach((s,i)=>{ s.classList.remove('active'); s.style.display = (i+1===n)?'block':'none'; });
  requestAnimationFrame(()=> slides[n-1].classList.add('active'));
  progressBar.style.width = ((n/totalSlides)*100)+'%';
  progressBar.setAttribute('aria-valuenow', String(n));
  progressText.textContent = `${n} / ${totalSlides}`;
}
showSlide(currentSlide);

document.getElementById('nextBtn').addEventListener('click',()=>{ currentSlide = currentSlide<totalSlides? currentSlide+1 : 1; showSlide(currentSlide); });

document.getElementById('prevBtn').addEventListener('click',()=>{ currentSlide = currentSlide>1? currentSlide-1 : totalSlides; showSlide(currentSlide); });

document.addEventListener('keydown',e=>{ if(e.key==='ArrowRight') document.getElementById('nextBtn').click(); if(e.key==='ArrowLeft') document.getElementById('prevBtn').click(); });

/************ Theme randomizer ************/
const themes=[
  {bg:'#0f172a',text:'#e2e8f0',card:'#111827',accent:'#38bdf8'},
  {bg:'#1e1b4b',text:'#fafafa',card:'#111827',accent:'#a78bfa'},
  {bg:'#0f766e',text:'#ecfdf5',card:'#064e3b',accent:'#14b8a6'}
];
const defaultTheme={bg:'#f4f6fa',text:'#222',card:'#ffffff',accent:'#1e3a8a'};
function applyTheme(t){
  document.documentElement.style.setProperty('--bg', t.bg);
  document.documentElement.style.setProperty('--text', t.text);
  document.documentElement.style.setProperty('--card', t.card);
  document.documentElement.style.setProperty('--accent', t.accent);
}
document.getElementById('randomize').addEventListener('click',()=>applyTheme(themes[Math.floor(Math.random()*themes.length)]));
document.getElementById('reset').addEventListener('click',()=>applyTheme(defaultTheme));

/************ Hashing demo with robust fallback ************/
const statusEl = document.getElementById('hashStatus');
const supportsSubtle = typeof window.crypto !== 'undefined' && crypto.subtle && (window.isSecureContext || location.protocol === 'https:' || location.hostname === 'localhost');

async function hashWithSubtle(text){
  const bytes = new TextEncoder().encode(text);
  const buf = await crypto.subtle.digest('SHA-256', bytes);
  return [...new Uint8Array(buf)].map(b=>b.toString(16).padStart(2,'0')).join('');
}

// Minimal SHA-256 fallback (UTF-8 input ‚Üí hex output)
function sha256Fallback(str){
  function rightRotate(n,x){ return (x>>>n) | (x<<(32-n)); }
  function toBytes(s){ return new TextEncoder().encode(s); }
  const bytes = toBytes(str);
  const l = bytes.length;
  const withOne = new Uint8Array(((l+9+63)>>6)<<6); // pad to 64-byte blocks
  withOne.set(bytes,0); withOne[l] = 0x80;
  const bitLen = l*8; // 64-bit length (we limit to 32-bit high zero)
  withOne[withOne.length-4] = (bitLen>>>24)&255;
  withOne[withOne.length-3] = (bitLen>>>16)&255;
  withOne[withOne.length-2] = (bitLen>>>8)&255;
  withOne[withOne.length-1] = (bitLen)&255;
  const H = new Uint32Array([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]);
  const K = new Uint32Array([
    0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,
    0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,
    0xe49b69c1,0xefbe4786,0x0fc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,
    0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x06ca6351,0x14292967,
    0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,
    0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,
    0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,
    0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2
  ]);
  const W = new Uint32Array(64);
  for(let i=0;i<withOne.length;i+=64){
    for(let t=0;t<16;t++){
      const j = i + t*4; W[t] = (withOne[j]<<24) | (withOne[j+1]<<16) | (withOne[j+2]<<8) | (withOne[j+3]);
    }
    for(let t=16;t<64;t++){
      const s0 = rightRotate(7,W[t-15]) ^ rightRotate(18,W[t-15]) ^ (W[t-15]>>>3);
      const s1 = rightRotate(17,W[t-2]) ^ rightRotate(19,W[t-2]) ^ (W[t-2]>>>10);
      W[t] = (W[t-16] + s0 + W[t-7] + s1) >>> 0;
    }
    let a=H[0],b=H[1],c=H[2],d=H[3],e=H[4],f=H[5],g=H[6],h=H[7];
    for(let t=0;t<64;t++){
      const S1 = rightRotate(6,e) ^ rightRotate(11,e) ^ rightRotate(25,e);
      const ch = (e & f) ^ ((~e) & g);
      const temp1 = (h + S1 + ch + K[t] + W[t]) >>> 0;
      const S0 = rightRotate(2,a) ^ rightRotate(13,a) ^ rightRotate(22,a);
      const maj = (a & b) ^ (a & c) ^ (b & c);
      const temp2 = (S0 + maj) >>> 0;
      h = g; g = f; f = e; e = (d + temp1) >>> 0; d = c; c = b; b = a; a = (temp1 + temp2) >>> 0;
    }
    H[0] = (H[0] + a) >>> 0; H[1] = (H[1] + b) >>> 0; H[2] = (H[2] + c) >>> 0; H[3] = (H[3] + d) >>> 0;
    H[4] = (H[4] + e) >>> 0; H[5] = (H[5] + f) >>> 0; H[6] = (H[6] + g) >>> 0; H[7] = (H[7] + h) >>> 0;
  }
  const hex = Array.from(H).map(x=>('00000000'+x.toString(16)).slice(-8)).join('');
  return hex;
}

async function hashText(text){
  try{
    if(supportsSubtle){ return await hashWithSubtle(text); }
    statusEl.textContent = 'Secure WebCrypto not available ‚Äî using built‚Äëin JS fallback.';
    return sha256Fallback(text);
  }catch(err){ statusEl.textContent = 'Hash error: '+err.message; return ''; }
}

document.getElementById('hashBtn').addEventListener('click', async ()=>{
  const input = document.getElementById('hashInput').value || '';
  const result = await hashText(input);
  document.getElementById('hashResult').textContent = result || '(no result)';
});

/************ Steganography demo: robust Base64 for UTF‚Äë8 ************/
function bytesToB64(bytes){
  let bin=''; bytes.forEach(b=> bin += String.fromCharCode(b));
  return btoa(bin);
}
function b64ToBytes(b64){
  const bin = atob(b64); const out = new Uint8Array(bin.length); for(let i=0;i<bin.length;i++) out[i]=bin.charCodeAt(i); return out;
}
const imgInput = document.getElementById('stegoImage');
const secretMsg = document.getElementById('secretMsg');
const output = document.getElementById('stegoOutput');
let stegoData = null;

document.getElementById('encodeBtn').addEventListener('click',()=>{
  const file = imgInput.files && imgInput.files[0];
  if(!file){ alert('Please upload a PNG image first.'); return; }
  const reader = new FileReader();
  reader.onload = ()=>{
    const msgBytes = new TextEncoder().encode(secretMsg.value || '');
    const payload = bytesToB64(msgBytes);
    stegoData = reader.result + '|HIDDEN|' + payload; // simulation (not true LSB)
    output.textContent = '‚úÖ Message hidden (simulated). You can now click "Reveal".';
  };
  reader.readAsDataURL(file);
});

document.getElementById('decodeBtn').addEventListener('click',()=>{
  if(!stegoData){ alert('No stego data to decode!'); return; }
  const parts = stegoData.split('|HIDDEN|');
  if(parts.length<2){ output.textContent = 'No hidden message found.'; return; }
  try{
    const bytes = b64ToBytes(parts[1]);
    const text = new TextDecoder().decode(bytes);
    output.textContent = 'üí¨ Hidden message: ' + text;
  }catch(err){ output.textContent = 'Decode error: ' + err.message; }
});
</script>
    </div>
    <footer style="background: rgba(26, 10, 10, 0.8); color: rgba(255,255,255,0.7); text-align: center; padding: 12px; font-size: 12px;">
        <p>Educational content | <a href="../../../catalog.html" style="color: #dc143c; text-decoration: none;">‚Üê Back to Catalog</a></p>
    </footer>
</div>
</body>
</html>
