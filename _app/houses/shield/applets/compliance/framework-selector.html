<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Framework Selector | Shield House</title>
    <style>
        :root {
            --shield-primary: #f87171;
            --shield-secondary: #fca5a5;
            --shield-accent: #dc2626;
            --bg-dark: #0f0f0f;
            --bg-card: #1a1a1a;
            --bg-elevated: #242424;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --border-color: #333;
            --success: #22c55e;
            --warning: #eab308;
            --info: #3b82f6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border-color);
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--shield-primary), var(--shield-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        /* Tab Navigation */
        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .tab-btn {
            padding: 0.75rem 1.5rem;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .tab-btn:hover {
            background: var(--bg-elevated);
            color: var(--text-primary);
        }

        .tab-btn.active {
            background: var(--shield-primary);
            color: white;
            border-color: var(--shield-primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Framework Cards */
        .framework-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .framework-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .framework-card:hover {
            transform: translateY(-4px);
            border-color: var(--shield-primary);
            box-shadow: 0 8px 24px rgba(248, 113, 113, 0.15);
        }

        .framework-card.selected {
            border-color: var(--shield-primary);
            background: rgba(248, 113, 113, 0.1);
        }

        .framework-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .framework-icon {
            font-size: 2.5rem;
        }

        .framework-title {
            flex: 1;
        }

        .framework-title h3 {
            color: var(--shield-primary);
            margin-bottom: 0.25rem;
        }

        .framework-title .org {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .framework-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .tag {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .tag.industry {
            background: rgba(59, 130, 246, 0.2);
            color: #60a5fa;
        }

        .tag.compliance {
            background: rgba(34, 197, 94, 0.2);
            color: #4ade80;
        }

        .tag.voluntary {
            background: rgba(168, 85, 247, 0.2);
            color: #c084fc;
        }

        .tag.mandatory {
            background: rgba(239, 68, 68, 0.2);
            color: #f87171;
        }

        .framework-desc {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .key-aspects {
            background: var(--bg-elevated);
            border-radius: 8px;
            padding: 1rem;
        }

        .key-aspects h4 {
            font-size: 0.85rem;
            color: var(--shield-secondary);
            margin-bottom: 0.5rem;
        }

        .key-aspects ul {
            list-style: none;
            font-size: 0.85rem;
        }

        .key-aspects li {
            padding: 0.25rem 0;
            padding-left: 1.25rem;
            position: relative;
        }

        .key-aspects li::before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: var(--success);
        }

        /* Wizard Section */
        .wizard-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .wizard-progress {
            display: flex;
            justify-content: center;
            margin-bottom: 2rem;
            gap: 0.5rem;
        }

        .progress-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--border-color);
            transition: all 0.3s ease;
        }

        .progress-dot.active {
            background: var(--shield-primary);
            transform: scale(1.2);
        }

        .progress-dot.completed {
            background: var(--success);
        }

        .wizard-question {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            display: none;
        }

        .wizard-question.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .wizard-question h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .wizard-question p {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .option-btn {
            padding: 1rem;
            background: var(--bg-elevated);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .option-btn:hover {
            border-color: var(--shield-primary);
            background: rgba(248, 113, 113, 0.1);
        }

        .option-btn.selected {
            border-color: var(--shield-primary);
            background: rgba(248, 113, 113, 0.2);
        }

        /* Comparison Table */
        .comparison-container {
            overflow-x: auto;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 900px;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 1rem;
            text-align: left;
            border: 1px solid var(--border-color);
        }

        .comparison-table th {
            background: var(--bg-card);
            color: var(--shield-primary);
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        .comparison-table td {
            background: var(--bg-elevated);
            vertical-align: top;
        }

        .comparison-table tr:hover td {
            background: rgba(248, 113, 113, 0.05);
        }

        .comparison-table .feature-name {
            font-weight: 500;
            color: var(--text-primary);
        }

        .check-yes {
            color: var(--success);
        }

        .check-partial {
            color: var(--warning);
        }

        .check-no {
            color: var(--text-secondary);
        }

        /* Results Section */
        .results-section {
            display: none;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 2rem;
        }

        .results-section.active {
            display: block;
        }

        .results-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .results-header h3 {
            font-size: 1.75rem;
            color: var(--shield-primary);
            margin-bottom: 0.5rem;
        }

        .recommendation-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .recommendation-card {
            background: var(--bg-elevated);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            position: relative;
        }

        .recommendation-card.primary {
            border-color: var(--shield-primary);
        }

        .recommendation-badge {
            position: absolute;
            top: -10px;
            left: 1rem;
            background: var(--shield-primary);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .match-score {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .score-bar {
            flex: 1;
            height: 8px;
            background: var(--bg-card);
            border-radius: 4px;
            overflow: hidden;
        }

        .score-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--shield-primary), var(--success));
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .score-text {
            font-weight: 600;
            color: var(--shield-primary);
        }

        /* Navigation Buttons */
        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        .nav-btn {
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .nav-btn.primary {
            background: var(--shield-primary);
            color: white;
        }

        .nav-btn.primary:hover {
            background: var(--shield-accent);
        }

        .nav-btn.secondary {
            background: var(--bg-elevated);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .nav-btn.secondary:hover {
            border-color: var(--shield-primary);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Back Link */
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-secondary);
            text-decoration: none;
            margin-bottom: 1rem;
            transition: color 0.3s ease;
        }

        .back-link:hover {
            color: var(--shield-primary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            h1 {
                font-size: 1.75rem;
            }

            .framework-grid {
                grid-template-columns: 1fr;
            }

            .tabs {
                flex-direction: column;
            }

            .tab-btn {
                width: 100%;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="../../index.html" class="back-link">‚Üê Back to Shield House</a>

        <header>
            <h1>üõ°Ô∏è Security Framework Selector</h1>
            <p class="subtitle">Compare frameworks, find the right fit, and understand CISSP Domain 2 governance requirements</p>
        </header>

        <!-- Tab Navigation -->
        <div class="tabs">
            <button class="tab-btn active" data-tab="explore">üìö Explore Frameworks</button>
            <button class="tab-btn" data-tab="wizard">üß≠ Framework Wizard</button>
            <button class="tab-btn" data-tab="compare">üìä Side-by-Side Compare</button>
        </div>

        <!-- Explore Tab -->
        <div id="explore" class="tab-content active">
            <div class="framework-grid" id="frameworkGrid"></div>
        </div>

        <!-- Wizard Tab -->
        <div id="wizard" class="tab-content">
            <div class="wizard-container">
                <div class="wizard-progress" id="wizardProgress"></div>
                <div id="wizardQuestions"></div>
                <div class="results-section" id="resultsSection">
                    <div class="results-header">
                        <h3>üìã Your Framework Recommendations</h3>
                        <p>Based on your answers, here are the best matches:</p>
                    </div>
                    <div class="recommendation-cards" id="recommendationCards"></div>
                    <div class="nav-buttons">
                        <button class="nav-btn secondary" onclick="restartWizard()">Start Over</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Compare Tab -->
        <div id="compare" class="tab-content">
            <p style="text-align: center; color: var(--text-secondary); margin-bottom: 1rem;">
                Select 2-4 frameworks from the Explore tab to compare them side by side
            </p>
            <div class="comparison-container">
                <table class="comparison-table" id="comparisonTable">
                    <thead id="comparisonHead"></thead>
                    <tbody id="comparisonBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Framework Data
        const frameworks = [
            {
                id: 'nist-csf',
                name: 'NIST Cybersecurity Framework',
                shortName: 'NIST CSF',
                org: 'National Institute of Standards and Technology',
                icon: 'üèõÔ∏è',
                tags: ['voluntary', 'industry'],
                description: 'A voluntary framework providing guidelines for managing cybersecurity risk. Widely adopted across industries.',
                keyAspects: [
                    'Five core functions: Identify, Protect, Detect, Respond, Recover',
                    'Flexible and scalable for any organization size',
                    'Risk-based approach with implementation tiers',
                    'Maps to other standards (ISO, COBIT)'
                ],
                industries: ['All', 'Critical Infrastructure'],
                mandatory: false,
                riskFocus: 'high',
                certifiable: false,
                complexity: 'medium',
                features: {
                    riskManagement: 'full',
                    compliance: 'partial',
                    cloudSupport: 'yes',
                    incidentResponse: 'yes',
                    supplyChain: 'yes',
                    continuousMonitoring: 'yes'
                }
            },
            {
                id: 'nist-800-53',
                name: 'NIST SP 800-53',
                shortName: 'NIST 800-53',
                org: 'National Institute of Standards and Technology',
                icon: 'üìã',
                tags: ['mandatory', 'compliance'],
                description: 'Comprehensive security and privacy controls for federal systems. Required for FISMA compliance.',
                keyAspects: [
                    'Extensive control catalog (1000+ controls)',
                    'Part of NIST Risk Management Framework (RMF)',
                    'Control families covering all security domains',
                    'Tailoring guidance for specific needs'
                ],
                industries: ['Government', 'Federal Contractors'],
                mandatory: true,
                riskFocus: 'high',
                certifiable: false,
                complexity: 'high',
                features: {
                    riskManagement: 'full',
                    compliance: 'full',
                    cloudSupport: 'yes',
                    incidentResponse: 'yes',
                    supplyChain: 'yes',
                    continuousMonitoring: 'yes'
                }
            },
            {
                id: 'iso-27001',
                name: 'ISO/IEC 27001',
                shortName: 'ISO 27001',
                org: 'International Organization for Standardization',
                icon: 'üåç',
                tags: ['voluntary', 'compliance'],
                description: 'International standard for Information Security Management Systems (ISMS). Globally recognized certification.',
                keyAspects: [
                    'Establishes ISMS requirements',
                    'Risk-based approach to security',
                    'Leadership and continuous improvement focus',
                    'Third-party certification available'
                ],
                industries: ['All', 'International'],
                mandatory: false,
                riskFocus: 'high',
                certifiable: true,
                complexity: 'medium',
                features: {
                    riskManagement: 'full',
                    compliance: 'full',
                    cloudSupport: 'yes',
                    incidentResponse: 'yes',
                    supplyChain: 'partial',
                    continuousMonitoring: 'yes'
                }
            },
            {
                id: 'cobit',
                name: 'COBIT',
                shortName: 'COBIT',
                org: 'ISACA',
                icon: '‚öôÔ∏è',
                tags: ['voluntary', 'industry'],
                description: 'IT governance and management framework. Bridges business goals with IT operations.',
                keyAspects: [
                    'Five principles for enterprise governance',
                    'Seven enablers for implementation',
                    '37 governance and management processes',
                    'Separates governance from management'
                ],
                industries: ['All', 'IT-Heavy'],
                mandatory: false,
                riskFocus: 'medium',
                certifiable: true,
                complexity: 'high',
                features: {
                    riskManagement: 'partial',
                    compliance: 'full',
                    cloudSupport: 'partial',
                    incidentResponse: 'partial',
                    supplyChain: 'partial',
                    continuousMonitoring: 'yes'
                }
            },
            {
                id: 'hitrust',
                name: 'HITRUST CSF',
                shortName: 'HITRUST',
                org: 'Health Information Trust Alliance',
                icon: 'üè•',
                tags: ['mandatory', 'industry'],
                description: 'Comprehensive security framework for healthcare. Harmonizes HIPAA, NIST, ISO requirements.',
                keyAspects: [
                    'Healthcare-specific controls',
                    'Unifies multiple regulatory requirements',
                    'Scalable based on organization size',
                    'Third-party certification available'
                ],
                industries: ['Healthcare', 'Health Tech'],
                mandatory: true,
                riskFocus: 'high',
                certifiable: true,
                complexity: 'high',
                features: {
                    riskManagement: 'full',
                    compliance: 'full',
                    cloudSupport: 'yes',
                    incidentResponse: 'yes',
                    supplyChain: 'yes',
                    continuousMonitoring: 'yes'
                }
            },
            {
                id: 'cis',
                name: 'CIS Critical Security Controls',
                shortName: 'CIS Controls',
                org: 'Center for Internet Security',
                icon: 'üéØ',
                tags: ['voluntary', 'industry'],
                description: 'Prioritized, actionable security controls. Defense-in-depth best practices.',
                keyAspects: [
                    'Offense-informs-defense approach',
                    '18 prioritized control categories',
                    'Implementation groups by maturity',
                    'Measurable and feasible controls'
                ],
                industries: ['All'],
                mandatory: false,
                riskFocus: 'high',
                certifiable: false,
                complexity: 'low',
                features: {
                    riskManagement: 'partial',
                    compliance: 'partial',
                    cloudSupport: 'yes',
                    incidentResponse: 'yes',
                    supplyChain: 'partial',
                    continuousMonitoring: 'yes'
                }
            },
            {
                id: 'pci-dss',
                name: 'PCI DSS',
                shortName: 'PCI DSS',
                org: 'PCI Security Standards Council',
                icon: 'üí≥',
                tags: ['mandatory', 'compliance'],
                description: 'Required for organizations handling payment card data. 12 core requirements.',
                keyAspects: [
                    'Mandatory for card payment processing',
                    '12 high-level requirements',
                    'Quarterly vulnerability scanning',
                    'Annual compliance validation'
                ],
                industries: ['Retail', 'E-commerce', 'Finance'],
                mandatory: true,
                riskFocus: 'high',
                certifiable: true,
                complexity: 'medium',
                features: {
                    riskManagement: 'partial',
                    compliance: 'full',
                    cloudSupport: 'yes',
                    incidentResponse: 'yes',
                    supplyChain: 'partial',
                    continuousMonitoring: 'yes'
                }
            },
            {
                id: 'fedramp',
                name: 'FedRAMP',
                shortName: 'FedRAMP',
                org: 'U.S. Federal Government',
                icon: '‚òÅÔ∏è',
                tags: ['mandatory', 'compliance'],
                description: 'Cloud security authorization for federal agencies. Based on NIST 800-53.',
                keyAspects: [
                    'Standardized cloud security assessment',
                    'Three impact levels (Low, Moderate, High)',
                    'Third-party assessment required (3PAO)',
                    'Continuous monitoring mandatory'
                ],
                industries: ['Cloud Providers', 'Federal'],
                mandatory: true,
                riskFocus: 'high',
                certifiable: true,
                complexity: 'high',
                features: {
                    riskManagement: 'full',
                    compliance: 'full',
                    cloudSupport: 'full',
                    incidentResponse: 'yes',
                    supplyChain: 'yes',
                    continuousMonitoring: 'full'
                }
            },
            {
                id: 'sabsa',
                name: 'SABSA',
                shortName: 'SABSA',
                org: 'SABSA Institute',
                icon: 'üèóÔ∏è',
                tags: ['voluntary', 'industry'],
                description: 'Enterprise security architecture methodology. Business-driven design approach.',
                keyAspects: [
                    'Six-layer architecture model',
                    'Business requirements first approach',
                    'Attribute profiling methodology',
                    'End-to-end lifecycle management'
                ],
                industries: ['Enterprise', 'Large Organizations'],
                mandatory: false,
                riskFocus: 'medium',
                certifiable: true,
                complexity: 'high',
                features: {
                    riskManagement: 'full',
                    compliance: 'partial',
                    cloudSupport: 'partial',
                    incidentResponse: 'partial',
                    supplyChain: 'partial',
                    continuousMonitoring: 'partial'
                }
            }
        ];

        // Wizard Questions
        const wizardQuestions = [
            {
                id: 'industry',
                question: 'What industry is your organization in?',
                description: 'Different industries have specific compliance requirements',
                options: [
                    { label: 'Healthcare', value: 'healthcare', frameworks: ['hitrust', 'nist-csf', 'iso-27001'] },
                    { label: 'Government/Federal', value: 'government', frameworks: ['nist-800-53', 'fedramp', 'nist-csf'] },
                    { label: 'Finance/Banking', value: 'finance', frameworks: ['pci-dss', 'iso-27001', 'cobit'] },
                    { label: 'Retail/E-commerce', value: 'retail', frameworks: ['pci-dss', 'cis', 'nist-csf'] },
                    { label: 'Technology/SaaS', value: 'tech', frameworks: ['soc2', 'iso-27001', 'nist-csf'] },
                    { label: 'General/Other', value: 'general', frameworks: ['nist-csf', 'cis', 'iso-27001'] }
                ]
            },
            {
                id: 'size',
                question: 'How large is your organization?',
                description: 'Framework complexity should match organizational resources',
                options: [
                    { label: 'Small (< 100 employees)', value: 'small', frameworks: ['cis', 'nist-csf'] },
                    { label: 'Medium (100-1000)', value: 'medium', frameworks: ['iso-27001', 'nist-csf', 'cis'] },
                    { label: 'Large (1000+)', value: 'large', frameworks: ['iso-27001', 'cobit', 'sabsa'] },
                    { label: 'Enterprise (10,000+)', value: 'enterprise', frameworks: ['sabsa', 'cobit', 'nist-800-53'] }
                ]
            },
            {
                id: 'requirement',
                question: 'Is certification/compliance required?',
                description: 'Some frameworks offer formal certification',
                options: [
                    { label: 'Yes, we need certification', value: 'required', frameworks: ['iso-27001', 'hitrust', 'pci-dss', 'fedramp'] },
                    { label: 'Preferred but not required', value: 'preferred', frameworks: ['iso-27001', 'nist-csf', 'cis'] },
                    { label: 'No, just best practices', value: 'voluntary', frameworks: ['nist-csf', 'cis', 'sabsa'] }
                ]
            },
            {
                id: 'focus',
                question: 'What is your primary focus?',
                description: 'Different frameworks emphasize different areas',
                options: [
                    { label: 'Overall risk management', value: 'risk', frameworks: ['nist-csf', 'iso-27001', 'nist-800-53'] },
                    { label: 'IT governance & processes', value: 'governance', frameworks: ['cobit', 'sabsa', 'iso-27001'] },
                    { label: 'Practical security controls', value: 'controls', frameworks: ['cis', 'nist-800-53', 'pci-dss'] },
                    { label: 'Cloud security', value: 'cloud', frameworks: ['fedramp', 'nist-csf', 'iso-27001'] }
                ]
            },
            {
                id: 'maturity',
                question: 'What is your current security maturity?',
                description: 'Choose a framework that matches your starting point',
                options: [
                    { label: 'Just starting out', value: 'initial', frameworks: ['cis', 'nist-csf'] },
                    { label: 'Some controls in place', value: 'developing', frameworks: ['nist-csf', 'iso-27001'] },
                    { label: 'Established program', value: 'mature', frameworks: ['iso-27001', 'cobit', 'nist-800-53'] },
                    { label: 'Advanced/optimizing', value: 'advanced', frameworks: ['sabsa', 'cobit', 'nist-800-53'] }
                ]
            }
        ];

        // State
        let selectedFrameworks = [];
        let wizardAnswers = {};
        let currentQuestion = 0;

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            renderFrameworkGrid();
            renderWizard();
            setupTabs();
        });

        // Tab Navigation
        function setupTabs() {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const tabId = btn.dataset.tab;

                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

                    btn.classList.add('active');
                    document.getElementById(tabId).classList.add('active');

                    if (tabId === 'compare') {
                        renderComparisonTable();
                    }
                });
            });
        }

        // Framework Grid
        function renderFrameworkGrid() {
            const grid = document.getElementById('frameworkGrid');
            grid.innerHTML = frameworks.map(fw => `
                <div class="framework-card ${selectedFrameworks.includes(fw.id) ? 'selected' : ''}"
                     onclick="toggleFrameworkSelection('${fw.id}')">
                    <div class="framework-header">
                        <span class="framework-icon">${fw.icon}</span>
                        <div class="framework-title">
                            <h3>${fw.shortName}</h3>
                            <span class="org">${fw.org}</span>
                        </div>
                    </div>
                    <div class="framework-tags">
                        ${fw.tags.map(tag => `<span class="tag ${tag}">${tag}</span>`).join('')}
                    </div>
                    <p class="framework-desc">${fw.description}</p>
                    <div class="key-aspects">
                        <h4>Key Aspects</h4>
                        <ul>
                            ${fw.keyAspects.map(aspect => `<li>${aspect}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            `).join('');
        }

        function toggleFrameworkSelection(id) {
            if (selectedFrameworks.includes(id)) {
                selectedFrameworks = selectedFrameworks.filter(f => f !== id);
            } else if (selectedFrameworks.length < 4) {
                selectedFrameworks.push(id);
            }
            renderFrameworkGrid();
        }

        // Wizard
        function renderWizard() {
            const progressDiv = document.getElementById('wizardProgress');
            const questionsDiv = document.getElementById('wizardQuestions');

            // Progress dots
            progressDiv.innerHTML = wizardQuestions.map((_, i) => `
                <div class="progress-dot ${i === currentQuestion ? 'active' : ''} ${i < currentQuestion ? 'completed' : ''}"></div>
            `).join('');

            // Questions
            questionsDiv.innerHTML = wizardQuestions.map((q, i) => `
                <div class="wizard-question ${i === currentQuestion ? 'active' : ''}" data-question="${i}">
                    <h3>${q.question}</h3>
                    <p>${q.description}</p>
                    <div class="options-grid">
                        ${q.options.map(opt => `
                            <button class="option-btn ${wizardAnswers[q.id] === opt.value ? 'selected' : ''}"
                                    onclick="selectOption('${q.id}', '${opt.value}', ${JSON.stringify(opt.frameworks).replace(/"/g, "'")})">
                                ${opt.label}
                            </button>
                        `).join('')}
                    </div>
                    <div class="nav-buttons">
                        ${i > 0 ? '<button class="nav-btn secondary" onclick="prevQuestion()">‚Üê Previous</button>' : ''}
                        <button class="nav-btn primary" onclick="nextQuestion()" ${!wizardAnswers[q.id] ? 'disabled' : ''}>
                            ${i === wizardQuestions.length - 1 ? 'See Results' : 'Next ‚Üí'}
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function selectOption(questionId, value, frameworkIds) {
            wizardAnswers[questionId] = value;
            wizardAnswers[questionId + '_frameworks'] = frameworkIds;
            renderWizard();
        }

        function nextQuestion() {
            if (currentQuestion < wizardQuestions.length - 1) {
                currentQuestion++;
                renderWizard();
            } else {
                showResults();
            }
        }

        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                renderWizard();
            }
        }

        function showResults() {
            // Calculate framework scores
            const scores = {};
            frameworks.forEach(fw => scores[fw.id] = 0);

            Object.keys(wizardAnswers).forEach(key => {
                if (key.endsWith('_frameworks')) {
                    const fws = wizardAnswers[key];
                    if (Array.isArray(fws)) {
                        fws.forEach((fwId, index) => {
                            if (scores[fwId] !== undefined) {
                                scores[fwId] += (fws.length - index);
                            }
                        });
                    }
                }
            });

            // Sort and get top 3
            const sorted = Object.entries(scores)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 3);

            const maxScore = sorted[0][1];

            const resultsDiv = document.getElementById('recommendationCards');
            resultsDiv.innerHTML = sorted.map(([id, score], index) => {
                const fw = frameworks.find(f => f.id === id);
                const percentage = Math.round((score / maxScore) * 100);
                return `
                    <div class="recommendation-card ${index === 0 ? 'primary' : ''}">
                        ${index === 0 ? '<span class="recommendation-badge">Best Match</span>' : ''}
                        <div class="framework-header">
                            <span class="framework-icon">${fw.icon}</span>
                            <div class="framework-title">
                                <h3>${fw.shortName}</h3>
                                <span class="org">${fw.org}</span>
                            </div>
                        </div>
                        <div class="match-score">
                            <div class="score-bar">
                                <div class="score-fill" style="width: ${percentage}%"></div>
                            </div>
                            <span class="score-text">${percentage}%</span>
                        </div>
                        <p class="framework-desc">${fw.description}</p>
                        <div class="framework-tags">
                            ${fw.tags.map(tag => `<span class="tag ${tag}">${tag}</span>`).join('')}
                        </div>
                    </div>
                `;
            }).join('');

            document.querySelectorAll('.wizard-question').forEach(q => q.classList.remove('active'));
            document.getElementById('resultsSection').classList.add('active');
        }

        function restartWizard() {
            currentQuestion = 0;
            wizardAnswers = {};
            document.getElementById('resultsSection').classList.remove('active');
            renderWizard();
        }

        // Comparison Table
        function renderComparisonTable() {
            if (selectedFrameworks.length < 2) {
                document.getElementById('comparisonHead').innerHTML = '';
                document.getElementById('comparisonBody').innerHTML = `
                    <tr><td colspan="5" style="text-align: center; padding: 2rem;">
                        Select at least 2 frameworks from the Explore tab to compare
                    </td></tr>
                `;
                return;
            }

            const selected = frameworks.filter(f => selectedFrameworks.includes(f.id));

            // Header
            document.getElementById('comparisonHead').innerHTML = `
                <tr>
                    <th>Feature</th>
                    ${selected.map(fw => `<th>${fw.icon} ${fw.shortName}</th>`).join('')}
                </tr>
            `;

            // Body
            const features = [
                { name: 'Organization', key: 'org' },
                { name: 'Mandatory', key: 'mandatory', format: v => v ? '‚úì Required' : '‚óã Voluntary' },
                { name: 'Certifiable', key: 'certifiable', format: v => v ? '‚úì Yes' : '‚óã No' },
                { name: 'Complexity', key: 'complexity', format: v => v.charAt(0).toUpperCase() + v.slice(1) },
                { name: 'Risk Management', key: 'features.riskManagement', format: formatFeature },
                { name: 'Compliance Support', key: 'features.compliance', format: formatFeature },
                { name: 'Cloud Support', key: 'features.cloudSupport', format: formatFeature },
                { name: 'Incident Response', key: 'features.incidentResponse', format: formatFeature },
                { name: 'Supply Chain', key: 'features.supplyChain', format: formatFeature },
                { name: 'Continuous Monitoring', key: 'features.continuousMonitoring', format: formatFeature },
                { name: 'Industries', key: 'industries', format: v => v.join(', ') }
            ];

            document.getElementById('comparisonBody').innerHTML = features.map(feat => `
                <tr>
                    <td class="feature-name">${feat.name}</td>
                    ${selected.map(fw => {
                        let value = feat.key.includes('.')
                            ? feat.key.split('.').reduce((o, k) => o[k], fw)
                            : fw[feat.key];
                        return `<td>${feat.format ? feat.format(value) : value}</td>`;
                    }).join('')}
                </tr>
            `).join('');
        }

        function formatFeature(value) {
            switch(value) {
                case 'full': return '<span class="check-yes">‚úì Full</span>';
                case 'yes': return '<span class="check-yes">‚úì Yes</span>';
                case 'partial': return '<span class="check-partial">‚óê Partial</span>';
                case 'no': return '<span class="check-no">‚úó No</span>';
                default: return value;
            }
        }

        // Save progress
        window.addEventListener('beforeunload', () => {
            localStorage.setItem('framework_selector_selected', JSON.stringify(selectedFrameworks));
        });

        // Load progress
        const saved = localStorage.getItem('framework_selector_selected');
        if (saved) {
            try {
                selectedFrameworks = JSON.parse(saved);
            } catch(e) {}
        }
    </script>
</body>
</html>
