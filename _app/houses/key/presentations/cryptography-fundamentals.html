<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cryptography Fundamentals - Key House - Hexworth Prime</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary: #f59e0b;
      --secondary: #fbbf24;
      --bg-dark: #0a0a0f;
      --bg-elevated: #1a1a24;
      --bg-card: #252530;
      --text-primary: #f5f5f7;
      --text-secondary: #a0a0b0;
      --success: #10b981;
      --danger: #ef4444;
      --border: #3a3a48;
      --glow: rgba(245, 158, 11, 0.3);
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg-dark);
      color: var(--text-primary);
      line-height: 1.6;
      overflow-x: hidden;
    }

    /* Header Styles */
    .header {
      background: linear-gradient(135deg, var(--bg-elevated) 0%, var(--bg-dark) 100%);
      border-bottom: 2px solid var(--primary);
      padding: 1.5rem 2rem;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 4px 20px rgba(245, 158, 11, 0.2);
    }

    .header-content {
      max-width: 1400px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .house-badge {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--primary);
    }

    .key-icon {
      font-size: 2rem;
      animation: keyRotate 3s ease-in-out infinite;
    }

    @keyframes keyRotate {
      0%, 100% { transform: rotate(0deg); }
      50% { transform: rotate(15deg); }
    }

    .progress-container {
      flex: 1;
      min-width: 200px;
      max-width: 400px;
    }

    .progress-label {
      display: flex;
      justify-content: space-between;
      font-size: 0.875rem;
      margin-bottom: 0.5rem;
      color: var(--text-secondary);
    }

    .progress-bar-bg {
      background: var(--bg-card);
      border-radius: 10px;
      height: 10px;
      overflow: hidden;
      border: 1px solid var(--border);
    }

    .progress-bar-fill {
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      height: 100%;
      width: 0%;
      transition: width 0.5s ease;
      box-shadow: 0 0 10px var(--glow);
    }

    .nav-buttons {
      display: flex;
      gap: 0.75rem;
    }

    .btn {
      padding: 0.625rem 1.25rem;
      border: 2px solid var(--primary);
      background: transparent;
      color: var(--primary);
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.95rem;
      font-weight: 600;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
    }

    .btn:hover {
      background: var(--primary);
      color: var(--bg-dark);
      box-shadow: 0 0 20px var(--glow);
      transform: translateY(-2px);
    }

    .btn-secondary {
      border-color: var(--border);
      color: var(--text-secondary);
    }

    .btn-secondary:hover {
      background: var(--bg-elevated);
      border-color: var(--text-secondary);
      color: var(--text-primary);
    }

    /* Main Content */
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 2rem;
    }

    .hero {
      text-align: center;
      padding: 3rem 2rem;
      background: linear-gradient(135deg, var(--bg-elevated) 0%, transparent 100%);
      border-radius: 16px;
      margin-bottom: 3rem;
      border: 1px solid var(--border);
    }

    .hero h1 {
      font-size: 3rem;
      margin-bottom: 1rem;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .hero p {
      font-size: 1.25rem;
      color: var(--text-secondary);
      max-width: 800px;
      margin: 0 auto;
    }

    /* Section Styles */
    .section {
      background: var(--bg-elevated);
      border-radius: 16px;
      padding: 2.5rem;
      margin-bottom: 2rem;
      border: 1px solid var(--border);
      transition: all 0.3s ease;
    }

    .section:hover {
      border-color: var(--primary);
      box-shadow: 0 4px 20px rgba(245, 158, 11, 0.1);
    }

    .section h2 {
      font-size: 2rem;
      margin-bottom: 1.5rem;
      color: var(--primary);
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .section h3 {
      font-size: 1.5rem;
      margin: 2rem 0 1rem;
      color: var(--secondary);
    }

    /* Interactive Cipher Playground */
    .cipher-playground {
      background: var(--bg-card);
      border-radius: 12px;
      padding: 2rem;
      margin: 2rem 0;
      border: 2px solid var(--border);
    }

    .cipher-controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .control-group {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .control-group label {
      font-weight: 600;
      color: var(--secondary);
      font-size: 0.95rem;
    }

    .control-group select,
    .control-group input[type="number"] {
      padding: 0.75rem;
      background: var(--bg-elevated);
      border: 2px solid var(--border);
      border-radius: 8px;
      color: var(--text-primary);
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .control-group select:focus,
    .control-group input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 10px var(--glow);
    }

    .text-area-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .text-area-wrapper {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .text-area-wrapper label {
      font-weight: 600;
      color: var(--secondary);
    }

    textarea {
      padding: 1rem;
      background: var(--bg-elevated);
      border: 2px solid var(--border);
      border-radius: 8px;
      color: var(--text-primary);
      font-size: 1rem;
      font-family: 'Courier New', monospace;
      resize: vertical;
      min-height: 120px;
      transition: all 0.3s ease;
    }

    textarea:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 10px var(--glow);
    }

    .cipher-actions {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .btn-action {
      padding: 0.875rem 2rem;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: var(--bg-dark);
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 700;
      transition: all 0.3s ease;
    }

    .btn-action:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 25px var(--glow);
    }

    .btn-action:active {
      transform: translateY(-1px);
    }

    /* Encryption Animation */
    .encryption-visual {
      background: var(--bg-elevated);
      border-radius: 12px;
      padding: 2rem;
      margin: 2rem 0;
      border: 2px solid var(--border);
      min-height: 200px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 1.5rem;
    }

    .encryption-stages {
      display: flex;
      align-items: center;
      gap: 1rem;
      flex-wrap: wrap;
      justify-content: center;
    }

    .stage {
      padding: 1rem 1.5rem;
      background: var(--bg-card);
      border-radius: 8px;
      border: 2px solid var(--border);
      font-weight: 600;
      transition: all 0.5s ease;
      opacity: 0.5;
    }

    .stage.active {
      opacity: 1;
      border-color: var(--primary);
      box-shadow: 0 0 20px var(--glow);
      transform: scale(1.1);
    }

    .arrow {
      font-size: 1.5rem;
      color: var(--text-secondary);
      transition: color 0.5s ease;
    }

    .arrow.active {
      color: var(--primary);
    }

    /* Algorithm Comparison Cards */
    .algo-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
      margin: 2rem 0;
    }

    .algo-card {
      background: var(--bg-card);
      border-radius: 12px;
      padding: 1.5rem;
      border: 2px solid var(--border);
      transition: all 0.3s ease;
    }

    .algo-card:hover {
      border-color: var(--primary);
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(245, 158, 11, 0.2);
    }

    .algo-card h4 {
      color: var(--primary);
      font-size: 1.25rem;
      margin-bottom: 1rem;
    }

    .algo-specs {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      margin-bottom: 1rem;
    }

    .spec-row {
      display: flex;
      justify-content: space-between;
      padding: 0.5rem;
      background: var(--bg-elevated);
      border-radius: 6px;
    }

    .spec-label {
      color: var(--text-secondary);
      font-size: 0.9rem;
    }

    .spec-value {
      color: var(--text-primary);
      font-weight: 600;
    }

    .strength-indicator {
      height: 8px;
      background: var(--bg-elevated);
      border-radius: 4px;
      overflow: hidden;
      margin-top: 1rem;
    }

    .strength-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--danger), var(--primary), var(--success));
      transition: width 0.5s ease;
    }

    /* Key Exchange Animation */
    .key-exchange {
      background: var(--bg-card);
      border-radius: 12px;
      padding: 2rem;
      margin: 2rem 0;
      border: 2px solid var(--border);
    }

    .exchange-visual {
      display: flex;
      align-items: center;
      justify-content: space-around;
      margin: 2rem 0;
      min-height: 200px;
      flex-wrap: wrap;
      gap: 2rem;
    }

    .entity {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }

    .entity-icon {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      box-shadow: 0 4px 20px var(--glow);
    }

    .entity-name {
      font-weight: 600;
      color: var(--secondary);
    }

    .key-display {
      background: var(--bg-elevated);
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 0.9rem;
      border: 1px solid var(--border);
      min-width: 150px;
      text-align: center;
    }

    .exchange-arrow {
      font-size: 3rem;
      color: var(--text-secondary);
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 0.5; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.2); }
    }

    /* Hash Collision Demo */
    .hash-demo {
      background: var(--bg-card);
      border-radius: 12px;
      padding: 2rem;
      margin: 2rem 0;
      border: 2px solid var(--border);
    }

    .hash-input-group {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .hash-result {
      background: var(--bg-elevated);
      padding: 1.5rem;
      border-radius: 8px;
      margin-top: 1rem;
      border: 2px solid var(--border);
    }

    .hash-output {
      font-family: 'Courier New', monospace;
      font-size: 0.95rem;
      word-break: break-all;
      color: var(--secondary);
      margin-top: 0.5rem;
    }

    .collision-alert {
      background: var(--danger);
      color: white;
      padding: 1rem;
      border-radius: 8px;
      margin-top: 1rem;
      font-weight: 600;
      display: none;
      animation: shake 0.5s ease;
    }

    .collision-alert.show {
      display: block;
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }

    /* PKI Certificate Chain */
    .pki-chain {
      background: var(--bg-card);
      border-radius: 12px;
      padding: 2rem;
      margin: 2rem 0;
      border: 2px solid var(--border);
    }

    .chain-visual {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      margin: 2rem 0;
    }

    .cert-level {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .cert-box {
      flex: 1;
      background: var(--bg-elevated);
      padding: 1.5rem;
      border-radius: 8px;
      border: 2px solid var(--border);
      transition: all 0.3s ease;
    }

    .cert-box:hover {
      border-color: var(--primary);
      transform: translateX(10px);
    }

    .cert-title {
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 0.5rem;
    }

    .cert-info {
      font-size: 0.9rem;
      color: var(--text-secondary);
    }

    .chain-connector {
      width: 2px;
      height: 30px;
      background: linear-gradient(180deg, var(--primary), var(--secondary));
      margin-left: 2rem;
    }

    /* Timeline */
    .timeline {
      position: relative;
      padding: 2rem 0;
      margin: 2rem 0;
    }

    .timeline::before {
      content: '';
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      width: 4px;
      height: 100%;
      background: linear-gradient(180deg, var(--primary), var(--secondary));
    }

    .timeline-item {
      display: flex;
      align-items: center;
      margin-bottom: 3rem;
      position: relative;
    }

    .timeline-item:nth-child(odd) {
      flex-direction: row;
    }

    .timeline-item:nth-child(even) {
      flex-direction: row-reverse;
    }

    .timeline-content {
      flex: 1;
      background: var(--bg-card);
      padding: 1.5rem;
      border-radius: 12px;
      border: 2px solid var(--border);
      margin: 0 2rem;
      transition: all 0.3s ease;
    }

    .timeline-content:hover {
      border-color: var(--primary);
      transform: scale(1.05);
    }

    .timeline-year {
      font-weight: 700;
      color: var(--primary);
      font-size: 1.25rem;
      margin-bottom: 0.5rem;
    }

    .timeline-dot {
      width: 20px;
      height: 20px;
      background: var(--primary);
      border-radius: 50%;
      border: 4px solid var(--bg-dark);
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      box-shadow: 0 0 15px var(--glow);
      z-index: 10;
    }

    /* Info Boxes */
    .info-box {
      background: var(--bg-card);
      border-left: 4px solid var(--primary);
      padding: 1.5rem;
      margin: 1.5rem 0;
      border-radius: 8px;
    }

    .info-box.warning {
      border-left-color: var(--danger);
    }

    .info-box.success {
      border-left-color: var(--success);
    }

    .info-box-title {
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .info-box.warning .info-box-title {
      color: var(--danger);
    }

    .info-box.success .info-box-title {
      color: var(--success);
    }

    /* Code Blocks */
    .code-block {
      background: var(--bg-card);
      border: 2px solid var(--border);
      border-radius: 8px;
      padding: 1.5rem;
      margin: 1.5rem 0;
      overflow-x: auto;
    }

    .code-block code {
      font-family: 'Courier New', monospace;
      font-size: 0.95rem;
      color: var(--secondary);
      line-height: 1.8;
    }

    /* Quiz Styles */
    .quiz-container {
      background: var(--bg-elevated);
      border-radius: 16px;
      padding: 2.5rem;
      margin-top: 3rem;
      border: 2px solid var(--primary);
    }

    .quiz-header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .quiz-header h2 {
      justify-content: center;
      font-size: 2.25rem;
    }

    .quiz-progress {
      display: flex;
      justify-content: space-between;
      margin-bottom: 2rem;
      padding: 1rem;
      background: var(--bg-card);
      border-radius: 8px;
    }

    .question-card {
      background: var(--bg-card);
      border-radius: 12px;
      padding: 2rem;
      margin-bottom: 2rem;
      border: 2px solid var(--border);
    }

    .question-text {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 1.5rem;
      color: var(--text-primary);
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .option {
      background: var(--bg-elevated);
      padding: 1.25rem;
      border-radius: 8px;
      border: 2px solid var(--border);
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .option:hover {
      border-color: var(--primary);
      transform: translateX(10px);
    }

    .option.selected {
      border-color: var(--primary);
      background: rgba(245, 158, 11, 0.1);
    }

    .option.correct {
      border-color: var(--success);
      background: rgba(16, 185, 129, 0.1);
    }

    .option.incorrect {
      border-color: var(--danger);
      background: rgba(239, 68, 68, 0.1);
    }

    .option-letter {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--bg-card);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: var(--primary);
      flex-shrink: 0;
    }

    .quiz-actions {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin-top: 2rem;
    }

    .quiz-result {
      background: var(--bg-card);
      border-radius: 12px;
      padding: 3rem;
      text-align: center;
      display: none;
    }

    .quiz-result.show {
      display: block;
    }

    .result-score {
      font-size: 4rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin: 1rem 0;
    }

    .result-message {
      font-size: 1.5rem;
      color: var(--text-secondary);
      margin-bottom: 2rem;
    }

    .xp-reward {
      display: inline-block;
      padding: 1rem 2rem;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: var(--bg-dark);
      border-radius: 12px;
      font-size: 1.5rem;
      font-weight: 700;
      margin-top: 1rem;
      box-shadow: 0 4px 20px var(--glow);
      animation: bounce 1s ease infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .container {
        padding: 1rem;
      }

      .hero h1 {
        font-size: 2rem;
      }

      .section {
        padding: 1.5rem;
      }

      .text-area-container {
        grid-template-columns: 1fr;
      }

      .timeline::before {
        left: 20px;
      }

      .timeline-item {
        flex-direction: row !important;
      }

      .timeline-dot {
        left: 20px;
      }

      .timeline-content {
        margin-left: 60px;
        margin-right: 0;
      }

      .exchange-visual {
        flex-direction: column;
      }

      .nav-buttons {
        width: 100%;
        justify-content: center;
      }
    }

    /* Utility Classes */
    .text-center { text-align: center; }
    .mt-1 { margin-top: 1rem; }
    .mt-2 { margin-top: 2rem; }
    .mb-1 { margin-bottom: 1rem; }
    .mb-2 { margin-bottom: 2rem; }

    ul, ol {
      margin-left: 2rem;
      margin-top: 1rem;
    }

    li {
      margin: 0.5rem 0;
      color: var(--text-secondary);
    }

    strong {
      color: var(--primary);
    }

    .highlight {
      color: var(--secondary);
      font-weight: 600;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <div class="house-badge">
        <span class="key-icon">üîë</span>
        <span>Key House - Cryptography Fundamentals</span>
      </div>
      <div class="progress-container">
        <div class="progress-label">
          <span>Module Progress</span>
          <span id="progressText">0%</span>
        </div>
        <div class="progress-bar-bg">
          <div class="progress-bar-fill" id="progressBar"></div>
        </div>
      </div>
      <div class="nav-buttons">
        <button class="btn btn-secondary" onclick="window.history.back()">‚Üê Back</button>
        <button class="btn" onclick="scrollToQuiz()">Take Quiz ‚Üí</button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="container">
    <!-- Hero Section -->
    <section class="hero">
      <h1>üîê Cryptography Fundamentals</h1>
      <p>Master the art and science of protecting information through encryption, hashing, and digital signatures. From ancient ciphers to modern PKI systems.</p>
    </section>

    <!-- Section 1: Purpose of Cryptography -->
    <section class="section" data-section="1">
      <h2>üéØ Purpose of Cryptography</h2>
      <p>Cryptography is the foundation of information security, protecting data through mathematical algorithms and ensuring secure communications in an untrusted environment.</p>

      <div class="algo-grid">
        <div class="algo-card">
          <h4>üîí Confidentiality</h4>
          <p>Ensures that information is accessible only to authorized parties. Encryption transforms plaintext into ciphertext, making data unreadable without the proper key.</p>
          <div class="info-box success mt-1">
            <div class="info-box-title">‚úì Example</div>
            AES encryption protects sensitive files, HTTPS secures web traffic
          </div>
        </div>

        <div class="algo-card">
          <h4>‚úÖ Integrity</h4>
          <p>Guarantees that data has not been altered during transmission or storage. Hash functions create unique fingerprints that detect any modifications.</p>
          <div class="info-box success mt-1">
            <div class="info-box-title">‚úì Example</div>
            SHA-256 checksums verify file integrity, HMAC validates message authenticity
          </div>
        </div>

        <div class="algo-card">
          <h4>üë§ Authentication</h4>
          <p>Verifies the identity of users, systems, or data sources. Digital signatures and certificates prove that data originates from the claimed source.</p>
          <div class="info-box success mt-1">
            <div class="info-box-title">‚úì Example</div>
            Digital certificates authenticate websites, SSH keys verify server identity
          </div>
        </div>

        <div class="algo-card">
          <h4>üìù Non-Repudiation</h4>
          <p>Prevents denial of actions or transactions. Digital signatures create proof that cannot be disputed, ensuring accountability.</p>
          <div class="info-box success mt-1">
            <div class="info-box-title">‚úì Example</div>
            Email signatures prove sender identity, blockchain transactions are immutable
          </div>
        </div>
      </div>

      <div class="info-box">
        <div class="info-box-title">üîë Key Principle: CIA Triad + Non-Repudiation</div>
        Modern cryptography provides all four security pillars. Without cryptography, digital trust and secure communications would be impossible.
      </div>
    </section>

    <!-- Section 2: Symmetric vs Asymmetric -->
    <section class="section" data-section="2">
      <h2>‚öñÔ∏è Symmetric vs Asymmetric Cryptography</h2>

      <div class="key-exchange">
        <h3>Symmetric Encryption (Secret Key)</h3>
        <p>Uses the <strong>same key</strong> for both encryption and decryption. Fast and efficient, but requires secure key distribution.</p>

        <div class="exchange-visual">
          <div class="entity">
            <div class="entity-icon">üë§</div>
            <div class="entity-name">Alice</div>
            <div class="key-display" id="symmetricKey1">üîë Key: K123</div>
          </div>
          <div class="exchange-arrow">‚ü∑</div>
          <div class="entity">
            <div class="entity-icon">üë§</div>
            <div class="entity-name">Bob</div>
            <div class="key-display" id="symmetricKey2">üîë Key: K123</div>
          </div>
        </div>

        <div class="info-box">
          <div class="info-box-title">‚ö° Advantages</div>
          Very fast, ideal for large data volumes, low computational overhead
        </div>
        <div class="info-box warning">
          <div class="info-box-title">‚ö†Ô∏è Challenges</div>
          Key distribution problem: How do Alice and Bob securely share the key?
        </div>
      </div>

      <div class="key-exchange mt-2">
        <h3>Asymmetric Encryption (Public Key)</h3>
        <p>Uses <strong>two different keys</strong>: public key for encryption, private key for decryption. Solves key distribution but slower than symmetric.</p>

        <div class="exchange-visual">
          <div class="entity">
            <div class="entity-icon">üë§</div>
            <div class="entity-name">Alice</div>
            <div class="key-display">üîì Public: PubA</div>
            <div class="key-display">üîí Private: PrvA</div>
          </div>
          <div class="exchange-arrow">‚Üí</div>
          <div class="entity">
            <div class="entity-icon">üë§</div>
            <div class="entity-name">Bob</div>
            <div class="key-display">üîì Public: PubB</div>
            <div class="key-display">üîí Private: PrvB</div>
          </div>
        </div>

        <div class="info-box">
          <div class="info-box-title">‚ö° Advantages</div>
          No key distribution problem, enables digital signatures, supports non-repudiation
        </div>
        <div class="info-box warning">
          <div class="info-box-title">‚ö†Ô∏è Challenges</div>
          Much slower than symmetric, computationally intensive for large data
        </div>
      </div>

      <div class="info-box success mt-2">
        <div class="info-box-title">üéØ Real-World Solution: Hybrid Cryptography</div>
        Modern systems use BOTH: asymmetric encryption to securely exchange a symmetric key, then symmetric encryption for the actual data transfer. Examples: TLS/SSL, PGP, SSH.
      </div>
    </section>

    <!-- Section 3: Classical Ciphers -->
    <section class="section" data-section="3">
      <h2>üìú Classical Ciphers</h2>

      <h3>Substitution Ciphers</h3>
      <p>Replace each letter with another letter, symbol, or number according to a fixed system.</p>

      <div class="cipher-playground">
        <h4>Caesar Cipher Demo (Shift Cipher)</h4>
        <p>Each letter is shifted by a fixed number of positions in the alphabet.</p>

        <div class="cipher-controls">
          <div class="control-group">
            <label for="caesarShift">Shift Value (1-25)</label>
            <input type="number" id="caesarShift" min="1" max="25" value="3">
          </div>
        </div>

        <div class="text-area-container">
          <div class="text-area-wrapper">
            <label>Plaintext</label>
            <textarea id="caesarPlaintext" placeholder="Enter your message...">HELLO WORLD</textarea>
          </div>
          <div class="text-area-wrapper">
            <label>Ciphertext</label>
            <textarea id="caesarCiphertext" readonly placeholder="Encrypted message will appear here..."></textarea>
          </div>
        </div>

        <div class="cipher-actions">
          <button class="btn-action" onclick="caesarEncrypt()">üîí Encrypt</button>
          <button class="btn-action" onclick="caesarDecrypt()">üîì Decrypt</button>
        </div>
      </div>

      <div class="info-box warning mt-2">
        <div class="info-box-title">‚ö†Ô∏è Security Note</div>
        Classical ciphers are easily broken by frequency analysis and brute force. Only 25 possible keys for Caesar cipher! Never use for real security.
      </div>

      <h3 class="mt-2">Transposition Ciphers</h3>
      <p>Rearrange the positions of letters without changing them. The Rail Fence cipher writes text in a zigzag pattern.</p>

      <div class="cipher-playground">
        <h4>Rail Fence Cipher Demo</h4>
        <p>Text is written diagonally across multiple "rails" and read row by row.</p>

        <div class="cipher-controls">
          <div class="control-group">
            <label for="railCount">Number of Rails (2-5)</label>
            <input type="number" id="railCount" min="2" max="5" value="3">
          </div>
        </div>

        <div class="text-area-container">
          <div class="text-area-wrapper">
            <label>Plaintext</label>
            <textarea id="railPlaintext" placeholder="Enter your message...">WEAREDISCOVEREDFLEEATONCE</textarea>
          </div>
          <div class="text-area-wrapper">
            <label>Ciphertext</label>
            <textarea id="railCiphertext" readonly placeholder="Encrypted message will appear here..."></textarea>
          </div>
        </div>

        <div class="cipher-actions">
          <button class="btn-action" onclick="railFenceEncrypt()">üîí Encrypt</button>
          <button class="btn-action" onclick="railFenceDecrypt()">üîì Decrypt</button>
        </div>

        <div id="railVisualization" class="code-block mt-2" style="display: none;">
          <code id="railPattern"></code>
        </div>
      </div>
    </section>

    <!-- Section 4: Block vs Stream Ciphers -->
    <section class="section" data-section="4">
      <h2>üîÑ Block vs Stream Ciphers</h2>

      <div class="encryption-visual">
        <h3>Encryption Process Comparison</h3>
        <div id="encryptionStages" class="encryption-stages">
          <div class="stage" data-stage="0">Input Data</div>
          <span class="arrow">‚Üí</span>
          <div class="stage" data-stage="1">Processing</div>
          <span class="arrow">‚Üí</span>
          <div class="stage" data-stage="2">Output</div>
        </div>
        <button class="btn-action mt-2" onclick="animateEncryption()">‚ñ∂Ô∏è Animate Process</button>
      </div>

      <div class="algo-grid mt-2">
        <div class="algo-card">
          <h4>üì¶ Block Ciphers</h4>
          <p>Encrypt data in fixed-size blocks (typically 128 bits). Each block is processed independently using the same key.</p>
          <div class="algo-specs">
            <div class="spec-row">
              <span class="spec-label">Block Size</span>
              <span class="spec-value">64-256 bits</span>
            </div>
            <div class="spec-row">
              <span class="spec-label">Speed</span>
              <span class="spec-value">Fast for bulk data</span>
            </div>
            <div class="spec-row">
              <span class="spec-label">Use Case</span>
              <span class="spec-value">Files, databases</span>
            </div>
          </div>
          <div class="info-box success mt-1">
            <div class="info-box-title">Examples</div>
            <strong>AES</strong> (Advanced Encryption Standard) - 128/192/256-bit keys<br>
            <strong>Blowfish</strong> - Variable key length up to 448 bits<br>
            <strong>3DES</strong> - Triple DES, 168-bit effective key
          </div>
        </div>

        <div class="algo-card">
          <h4>üåä Stream Ciphers</h4>
          <p>Encrypt data one bit or byte at a time using a continuously changing keystream. Ideal for real-time communications.</p>
          <div class="algo-specs">
            <div class="spec-row">
              <span class="spec-label">Block Size</span>
              <span class="spec-value">1 bit/byte</span>
            </div>
            <div class="spec-row">
              <span class="spec-label">Speed</span>
              <span class="spec-value">Fast, low latency</span>
            </div>
            <div class="spec-row">
              <span class="spec-label">Use Case</span>
              <span class="spec-value">Streaming, VoIP</span>
            </div>
          </div>
          <div class="info-box success mt-1">
            <div class="info-box-title">Examples</div>
            <strong>RC4</strong> - Widely used (now deprecated due to vulnerabilities)<br>
            <strong>ChaCha20</strong> - Modern alternative to RC4<br>
            <strong>Salsa20</strong> - High-speed stream cipher
          </div>
        </div>
      </div>

      <div class="info-box warning mt-2">
        <div class="info-box-title">‚ö†Ô∏è Security Alert: RC4 Deprecated</div>
        RC4 was once the most widely used stream cipher (WEP, early TLS) but is now considered insecure due to biases in its keystream. Always use modern alternatives like ChaCha20.
      </div>
    </section>

    <!-- Section 5: Key Sizes -->
    <section class="section" data-section="5">
      <h2>üî¢ Key Sizes and Strength</h2>

      <p>Key size directly impacts security: larger keys exponentially increase the difficulty of brute-force attacks.</p>

      <div class="algo-grid">
        <div class="algo-card">
          <h4>64-bit Keys</h4>
          <div class="spec-row">
            <span class="spec-label">Possible Keys</span>
            <span class="spec-value">2<sup>64</sup> ‚âà 18 quintillion</span>
          </div>
          <div class="spec-row">
            <span class="spec-label">Security Level</span>
            <span class="spec-value" style="color: var(--danger);">WEAK</span>
          </div>
          <div class="strength-indicator">
            <div class="strength-fill" style="width: 20%;"></div>
          </div>
          <p class="mt-1" style="font-size: 0.9rem; color: var(--text-secondary);">DES (obsolete), some legacy systems. Breakable with modern hardware in hours to days.</p>
        </div>

        <div class="algo-card">
          <h4>128-bit Keys</h4>
          <div class="spec-row">
            <span class="spec-label">Possible Keys</span>
            <span class="spec-value">2<sup>128</sup> ‚âà 3.4√ó10<sup>38</sup></span>
          </div>
          <div class="spec-row">
            <span class="spec-label">Security Level</span>
            <span class="spec-value" style="color: var(--success);">STRONG</span>
          </div>
          <div class="strength-indicator">
            <div class="strength-fill" style="width: 70%;"></div>
          </div>
          <p class="mt-1" style="font-size: 0.9rem; color: var(--text-secondary);">AES-128, most modern applications. Secure against all practical attacks. Estimated centuries to brute force.</p>
        </div>

        <div class="algo-card">
          <h4>256-bit Keys</h4>
          <div class="spec-row">
            <span class="spec-label">Possible Keys</span>
            <span class="spec-value">2<sup>256</sup> ‚âà 1.1√ó10<sup>77</sup></span>
          </div>
          <div class="spec-row">
            <span class="spec-label">Security Level</span>
            <span class="spec-value" style="color: var(--success);">MAXIMUM</span>
          </div>
          <div class="strength-indicator">
            <div class="strength-fill" style="width: 100%;"></div>
          </div>
          <p class="mt-1" style="font-size: 0.9rem; color: var(--text-secondary);">AES-256, top secret data, future-proof against quantum computers. Virtually unbreakable with current and foreseeable technology.</p>
        </div>
      </div>

      <div class="info-box mt-2">
        <div class="info-box-title">üßÆ The Power of Exponential Growth</div>
        Each additional bit DOUBLES the number of possible keys. A 256-bit key has 2<sup>128</sup> times more combinations than a 128-bit key - that's more than the number of atoms in the observable universe!
      </div>

      <div class="code-block mt-2">
        <code>
<strong>Key Size Comparison:</strong>

64-bit:  18,446,744,073,709,551,616 combinations
         (Breakable with dedicated hardware)

128-bit: 340,282,366,920,938,463,463,374,607,431,768,211,456 combinations
         (Secure for decades)

256-bit: 115,792,089,237,316,195,423,570,985,008,687,907,853,269,984,665,640,564,039,457,584,007,913,129,639,936 combinations
         (Secure beyond comprehension)
        </code>
      </div>
    </section>

    <!-- Section 6: Hashing -->
    <section class="section" data-section="6">
      <h2>#Ô∏è‚É£ Cryptographic Hashing</h2>

      <p>Hash functions are one-way mathematical algorithms that transform input data of any size into a fixed-length output (digest). Critical for integrity verification, password storage, and digital signatures.</p>

      <h3>Hash Properties</h3>
      <div class="algo-grid">
        <div class="algo-card">
          <h4>Deterministic</h4>
          <p>Same input always produces the same output</p>
        </div>
        <div class="algo-card">
          <h4>Fast Computation</h4>
          <p>Quick to generate hash from any input</p>
        </div>
        <div class="algo-card">
          <h4>One-Way Function</h4>
          <p>Impossible to reverse hash back to input</p>
        </div>
        <div class="algo-card">
          <h4>Collision Resistant</h4>
          <p>Extremely difficult to find two inputs with same hash</p>
        </div>
        <div class="algo-card">
          <h4>Avalanche Effect</h4>
          <p>Tiny input change causes massive output change</p>
        </div>
        <div class="algo-card">
          <h4>Fixed Output Size</h4>
          <p>Output length constant regardless of input</p>
        </div>
      </div>

      <div class="hash-demo mt-2">
        <h3>Interactive Hash Demonstration</h3>
        <p>See how different hash algorithms process the same input. Notice how a single character change completely transforms the output.</p>

        <div class="control-group mb-2">
          <label for="hashAlgorithm">Select Hash Algorithm</label>
          <select id="hashAlgorithm">
            <option value="md5">MD5 (128-bit) - Insecure, Legacy Only</option>
            <option value="sha1">SHA-1 (160-bit) - Deprecated</option>
            <option value="sha256" selected>SHA-256 (256-bit) - Recommended</option>
            <option value="sha512">SHA-512 (512-bit) - High Security</option>
          </select>
        </div>

        <div class="hash-input-group">
          <div class="control-group">
            <label for="hashInput1">Input 1</label>
            <textarea id="hashInput1" placeholder="Enter text to hash..." style="min-height: 80px;">Hello World</textarea>
          </div>
          <div class="control-group">
            <label for="hashInput2">Input 2</label>
            <textarea id="hashInput2" placeholder="Enter text to hash..." style="min-height: 80px;">Hello World!</textarea>
          </div>
        </div>

        <div class="cipher-actions">
          <button class="btn-action" onclick="generateHashes()">Generate Hashes</button>
          <button class="btn-action" onclick="testCollision()">Test for Collision</button>
        </div>

        <div id="hashResults" style="display: none;">
          <div class="hash-result">
            <strong>Hash 1:</strong>
            <div class="hash-output" id="hashOutput1"></div>
          </div>
          <div class="hash-result">
            <strong>Hash 2:</strong>
            <div class="hash-output" id="hashOutput2"></div>
          </div>
        </div>

        <div id="collisionAlert" class="collision-alert">
          ‚ö†Ô∏è COLLISION DETECTED! Both inputs produced the same hash. This should be extremely rare for secure algorithms.
        </div>
      </div>

      <h3 class="mt-2">Common Hash Algorithms</h3>
      <div class="algo-grid">
        <div class="algo-card">
          <h4>MD5</h4>
          <div class="algo-specs">
            <div class="spec-row">
              <span class="spec-label">Output Size</span>
              <span class="spec-value">128 bits</span>
            </div>
            <div class="spec-row">
              <span class="spec-label">Status</span>
              <span class="spec-value" style="color: var(--danger);">BROKEN</span>
            </div>
          </div>
          <div class="strength-indicator">
            <div class="strength-fill" style="width: 10%; background: var(--danger);"></div>
          </div>
          <p class="mt-1" style="font-size: 0.85rem;">Cryptographically broken since 2004. Collisions can be generated in seconds. Use only for non-security checksums.</p>
        </div>

        <div class="algo-card">
          <h4>SHA-1</h4>
          <div class="algo-specs">
            <div class="spec-row">
              <span class="spec-label">Output Size</span>
              <span class="spec-value">160 bits</span>
            </div>
            <div class="spec-row">
              <span class="spec-label">Status</span>
              <span class="spec-value" style="color: var(--danger);">DEPRECATED</span>
            </div>
          </div>
          <div class="strength-indicator">
            <div class="strength-fill" style="width: 30%; background: var(--danger);"></div>
          </div>
          <p class="mt-1" style="font-size: 0.85rem;">Deprecated by NIST in 2011. Google demonstrated collision in 2017 (SHAttered attack). Migrate to SHA-2 or SHA-3.</p>
        </div>

        <div class="algo-card">
          <h4>SHA-256</h4>
          <div class="algo-specs">
            <div class="spec-row">
              <span class="spec-label">Output Size</span>
              <span class="spec-value">256 bits</span>
            </div>
            <div class="spec-row">
              <span class="spec-label">Status</span>
              <span class="spec-value" style="color: var(--success);">SECURE</span>
            </div>
          </div>
          <div class="strength-indicator">
            <div class="strength-fill" style="width: 85%;"></div>
          </div>
          <p class="mt-1" style="font-size: 0.85rem;">Part of SHA-2 family. Widely used in TLS, cryptocurrencies (Bitcoin), code signing. No known vulnerabilities.</p>
        </div>

        <div class="algo-card">
          <h4>SHA-3</h4>
          <div class="algo-specs">
            <div class="spec-row">
              <span class="spec-label">Output Size</span>
              <span class="spec-value">Variable</span>
            </div>
            <div class="spec-row">
              <span class="spec-label">Status</span>
              <span class="spec-value" style="color: var(--success);">NEXT-GEN</span>
            </div>
          </div>
          <div class="strength-indicator">
            <div class="strength-fill" style="width: 100%;"></div>
          </div>
          <p class="mt-1" style="font-size: 0.85rem;">Latest NIST standard (2015). Based on Keccak algorithm. Different internal structure from SHA-2, provides diversity.</p>
        </div>
      </div>

      <div class="info-box warning mt-2">
        <div class="info-box-title">‚ö†Ô∏è Password Storage Best Practice</div>
        <strong>Never store passwords as plain hashes!</strong> Use specialized password hashing functions like <strong>bcrypt</strong>, <strong>scrypt</strong>, or <strong>Argon2</strong> that include salting and key stretching to resist rainbow table and brute-force attacks.
      </div>
    </section>

    <!-- Section 7: Digital Signatures -->
    <section class="section" data-section="7">
      <h2>‚úçÔ∏è Digital Signatures</h2>

      <p>Digital signatures combine hashing and asymmetric cryptography to provide authentication, integrity, and non-repudiation. The mathematical equivalent of a handwritten signature, but far more secure.</p>

      <div class="key-exchange">
        <h3>How Digital Signatures Work</h3>

        <div class="encryption-visual">
          <h4>Signing Process (Sender)</h4>
          <div class="encryption-stages">
            <div class="stage active">Document</div>
            <span class="arrow active">‚Üí</span>
            <div class="stage active">Hash</div>
            <span class="arrow active">‚Üí</span>
            <div class="stage active">Encrypt with Private Key</div>
            <span class="arrow active">‚Üí</span>
            <div class="stage active">Digital Signature</div>
          </div>
        </div>

        <div class="encryption-visual mt-2">
          <h4>Verification Process (Receiver)</h4>
          <div class="encryption-stages">
            <div class="stage active">Received Document</div>
            <span class="arrow active">‚Üí</span>
            <div class="stage active">Hash</div>
            <span class="arrow active">‚Üí</span>
            <div class="stage active">Decrypt Signature with Public Key</div>
            <span class="arrow active">‚Üí</span>
            <div class="stage active">Compare Hashes</div>
          </div>
        </div>

        <div class="code-block mt-2">
          <code>
<strong>Digital Signature Process:</strong>

1. SENDER CREATES SIGNATURE:
   - Calculate hash of document: Hash(Document) = H1
   - Encrypt hash with sender's private key: Encrypt(H1, PrivateKey) = Signature
   - Send document + signature to receiver

2. RECEIVER VERIFIES SIGNATURE:
   - Calculate hash of received document: Hash(Document) = H2
   - Decrypt signature with sender's public key: Decrypt(Signature, PublicKey) = H1
   - Compare: H1 == H2 ?
     ‚úì Match = Authentic, unmodified, from claimed sender
     ‚úó Mismatch = Document altered or signature forged
          </code>
        </div>
      </div>

      <div class="algo-grid mt-2">
        <div class="algo-card">
          <h4>üîí Authentication</h4>
          <p>Only the holder of the private key could have created the signature. Proves the signer's identity.</p>
          <div class="info-box success mt-1">
            <div class="info-box-title">Guarantees</div>
            Message definitely came from the claimed sender
          </div>
        </div>

        <div class="algo-card">
          <h4>‚úÖ Integrity</h4>
          <p>Any change to the document invalidates the signature. Even a single bit change produces a completely different hash.</p>
          <div class="info-box success mt-1">
            <div class="info-box-title">Guarantees</div>
            Document has not been tampered with since signing
          </div>
        </div>

        <div class="algo-card">
          <h4>üìù Non-Repudiation</h4>
          <p>Signer cannot deny creating the signature (only they have the private key). Legally binding in many jurisdictions.</p>
          <div class="info-box success mt-1">
            <div class="info-box-title">Guarantees</div>
            Signer cannot later deny sending the message
          </div>
        </div>

        <div class="algo-card">
          <h4>‚è±Ô∏è Timestamping</h4>
          <p>Digital signatures can include trusted timestamps, proving when a document was signed.</p>
          <div class="info-box success mt-1">
            <div class="info-box-title">Guarantees</div>
            Document existed and was signed at specific time
          </div>
        </div>
      </div>

      <div class="info-box mt-2">
        <div class="info-box-title">üîë Common Signature Algorithms</div>
        <strong>RSA</strong> - Most widely used, based on integer factorization<br>
        <strong>DSA</strong> - Digital Signature Algorithm, U.S. Federal standard<br>
        <strong>ECDSA</strong> - Elliptic Curve DSA, smaller keys with equivalent security<br>
        <strong>EdDSA</strong> - Modern variant using Curve25519, very fast and secure
      </div>

      <div class="info-box warning mt-2">
        <div class="info-box-title">‚ö†Ô∏è Critical: Protect Your Private Key!</div>
        If an attacker obtains your private key, they can forge your signature on any document. Use hardware security modules (HSMs) or secure key storage for high-value signatures.
      </div>
    </section>

    <!-- Section 8: PKI -->
    <section class="section" data-section="8">
      <h2>üèõÔ∏è Public Key Infrastructure (PKI)</h2>

      <p>PKI is the framework of policies, processes, and technologies that enable secure public key cryptography at scale. It solves the trust problem: How do you know a public key actually belongs to who it claims to?</p>

      <div class="pki-chain">
        <h3>Certificate Chain of Trust</h3>
        <p>Certificates form a hierarchical chain from end-user certificates up to trusted root CAs.</p>

        <div class="chain-visual">
          <div class="cert-level">
            <div class="cert-box">
              <div class="cert-title">üåê Root Certificate Authority (CA)</div>
              <div class="cert-info">Self-signed, pre-installed in browsers/OS. Examples: DigiCert, Let's Encrypt Root CA</div>
              <div class="cert-info mt-1"><strong>Trust Level:</strong> Absolute (carefully audited)</div>
            </div>
          </div>

          <div class="chain-connector"></div>

          <div class="cert-level">
            <div class="cert-box">
              <div class="cert-title">üîó Intermediate CA</div>
              <div class="cert-info">Signed by root CA. Used to issue end-entity certificates. Provides isolation and security.</div>
              <div class="cert-info mt-1"><strong>Trust Level:</strong> Inherited from root CA</div>
            </div>
          </div>

          <div class="chain-connector"></div>

          <div class="cert-level">
            <div class="cert-box">
              <div class="cert-title">üìÑ End-Entity Certificate</div>
              <div class="cert-info">Your website/server certificate. Contains public key, domain name, validity period.</div>
              <div class="cert-info mt-1"><strong>Trust Level:</strong> Validated through entire chain</div>
            </div>
          </div>
        </div>

        <div class="code-block mt-2">
          <code>
<strong>Certificate Verification Process:</strong>

1. Browser receives website certificate for "example.com"
2. Extracts issuer: "Let's Encrypt Intermediate CA"
3. Finds intermediate CA certificate
4. Verifies website cert signature using intermediate CA public key ‚úì
5. Extracts intermediate CA issuer: "Let's Encrypt Root CA"
6. Finds root CA in browser's trust store
7. Verifies intermediate cert signature using root CA public key ‚úì
8. Root CA is trusted ‚Üí entire chain is trusted ‚úì
9. Establish secure TLS connection
          </code>
        </div>
      </div>

      <h3 class="mt-2">PKI Components</h3>
      <div class="algo-grid">
        <div class="algo-card">
          <h4>Certificate Authority (CA)</h4>
          <p>Trusted entity that issues digital certificates after verifying identity. Examples: DigiCert, Let's Encrypt, Comodo.</p>
        </div>

        <div class="algo-card">
          <h4>Registration Authority (RA)</h4>
          <p>Verifies certificate requests on behalf of the CA. Handles identity verification and certificate lifecycle.</p>
        </div>

        <div class="algo-card">
          <h4>Certificate Repository</h4>
          <p>Public database where certificates and Certificate Revocation Lists (CRLs) are published and accessible.</p>
        </div>

        <div class="algo-card">
          <h4>Validation Authority (VA)</h4>
          <p>Provides real-time certificate validation services. OCSP (Online Certificate Status Protocol) servers.</p>
        </div>
      </div>

      <h3 class="mt-2">X.509 Certificate Contents</h3>
      <div class="code-block">
        <code>
<strong>Standard Digital Certificate Structure:</strong>

Version: 3
Serial Number: 4f:3a:1d:7e:9c...
Signature Algorithm: SHA256-RSA
Issuer: CN=Let's Encrypt Authority X3, O=Let's Encrypt
Validity:
  Not Before: 2025-01-15 00:00:00 UTC
  Not After:  2025-04-15 23:59:59 UTC
Subject: CN=example.com
Subject Public Key Info:
  Algorithm: RSA 2048-bit
  Public Key: 30:82:01:0a:02:82...
Extensions:
  Subject Alternative Names: example.com, www.example.com
  Key Usage: Digital Signature, Key Encipherment
  Extended Key Usage: TLS Web Server Authentication
Signature: 8a:f1:3c:d5:7b...
        </code>
      </div>

      <div class="info-box mt-2">
        <div class="info-box-title">üîÑ Certificate Revocation</div>
        Certificates can be revoked before expiry (compromised key, change of details). Two main mechanisms:<br>
        <strong>CRL (Certificate Revocation List):</strong> Periodically published list of revoked certificates<br>
        <strong>OCSP (Online Certificate Status Protocol):</strong> Real-time certificate status checking
      </div>

      <div class="info-box warning mt-2">
        <div class="info-box-title">‚ö†Ô∏è CA Compromise = Catastrophic Failure</div>
        If a CA's private key is compromised, attackers can forge certificates for any domain. This has happened: DigiNotar (2011), Comodo (2011). Browser vendors revoked trust immediately.
      </div>
    </section>

    <!-- Section 9: Cryptographic Tools -->
    <section class="section" data-section="9">
      <h2>üõ†Ô∏è Cryptographic Tools</h2>

      <p>Essential tools for implementing, testing, and analyzing cryptographic systems. Every security professional should be familiar with these utilities.</p>

      <div class="algo-grid">
        <div class="algo-card">
          <h4>üîê GPG (GNU Privacy Guard)</h4>
          <p>Open-source implementation of PGP (Pretty Good Privacy). Encrypt/decrypt files and emails, create digital signatures.</p>
          <div class="code-block mt-1">
            <code>
# Generate key pair
gpg --gen-key

# Encrypt file
gpg -e -r recipient@email.com file.txt

# Decrypt file
gpg -d file.txt.gpg

# Sign file
gpg --sign document.pdf

# Verify signature
gpg --verify document.pdf.sig
            </code>
          </div>
          <div class="info-box success mt-1">
            <div class="info-box-title">Use Cases</div>
            Secure email, file encryption, software package signing, key management
          </div>
        </div>

        <div class="algo-card">
          <h4>üîß OpenSSL</h4>
          <p>Swiss Army knife of cryptography. Generate keys, create certificates, encrypt data, test TLS connections.</p>
          <div class="code-block mt-1">
            <code>
# Generate RSA private key
openssl genrsa -out key.pem 2048

# Create certificate request
openssl req -new -key key.pem -out csr.pem

# Self-sign certificate
openssl x509 -req -in csr.pem -signkey key.pem -out cert.pem

# Encrypt file with AES-256
openssl enc -aes-256-cbc -in file.txt -out file.enc

# Test TLS connection
openssl s_client -connect example.com:443

# View certificate details
openssl x509 -in cert.pem -text -noout
            </code>
          </div>
          <div class="info-box success mt-1">
            <div class="info-box-title">Use Cases</div>
            Certificate generation, TLS testing, encryption/decryption, PKI management
          </div>
        </div>

        <div class="algo-card">
          <h4>üí• Hashcat</h4>
          <p>World's fastest password cracker. Supports 300+ hash algorithms. GPU-accelerated, highly optimized.</p>
          <div class="code-block mt-1">
            <code>
# Crack MD5 hashes with wordlist
hashcat -m 0 -a 0 hashes.txt wordlist.txt

# Brute force attack on SHA-256
hashcat -m 1400 -a 3 hash.txt ?a?a?a?a?a?a

# Crack WPA/WPA2 handshake
hashcat -m 2500 -a 0 capture.hccapx wordlist.txt

# Rule-based attack
hashcat -m 1000 -a 0 hashes.txt wordlist.txt -r rules.txt

Attack modes:
  0 = Dictionary
  1 = Combinator
  3 = Brute-force
  6 = Hybrid wordlist + mask
            </code>
          </div>
          <div class="info-box warning mt-1">
            <div class="info-box-title">‚ö†Ô∏è Ethical Use Only</div>
            Password auditing your own systems, penetration testing with authorization, security research
          </div>
        </div>

        <div class="algo-card">
          <h4>üîç John the Ripper</h4>
          <p>Another powerful password cracker. Excellent for detecting weak passwords in password audits.</p>
          <div class="code-block mt-1">
            <code>
# Crack password file
john passwords.txt

# Use specific wordlist
john --wordlist=rockyou.txt hashes.txt

# Show cracked passwords
john --show passwords.txt

# Crack with rules
john --wordlist=dict.txt --rules hashes.txt

# Benchmark hash types
john --test
            </code>
          </div>
          <div class="info-box success mt-1">
            <div class="info-box-title">Use Cases</div>
            Password policy auditing, penetration testing, security assessments
          </div>
        </div>
      </div>

      <div class="info-box mt-2">
        <div class="info-box-title">üéØ Additional Crypto Tools</div>
        <strong>VeraCrypt:</strong> Full-disk encryption, encrypted containers<br>
        <strong>KeePass:</strong> Encrypted password manager<br>
        <strong>Wireshark:</strong> Network analysis, TLS inspection<br>
        <strong>CyberChef:</strong> Web-based crypto operations, encoding/decoding<br>
        <strong>certutil:</strong> Windows certificate management<br>
        <strong>ssh-keygen:</strong> SSH key pair generation
      </div>
    </section>

    <!-- Section 10: GAK & Ethics -->
    <section class="section" data-section="10">
      <h2>‚öñÔ∏è Government Access to Keys (GAK) & Ethical Considerations</h2>

      <p>The tension between individual privacy and law enforcement access to encrypted communications is one of the most contentious issues in modern cryptography.</p>

      <h3>What is GAK?</h3>
      <div class="info-box">
        <div class="info-box-title">Definition</div>
        Government Access to Keys (GAK) refers to proposals requiring that encryption systems include mechanisms for law enforcement to access encrypted data, typically through key escrow, backdoors, or mandatory key disclosure.
      </div>

      <div class="algo-grid mt-2">
        <div class="algo-card">
          <h4>üèõÔ∏è Government Arguments FOR</h4>
          <ul>
            <li>National security and counter-terrorism</li>
            <li>Criminal investigations</li>
            <li>Child protection and exploitation prevention</li>
            <li>Public safety outweighs individual privacy</li>
            <li>Lawful access with warrants</li>
          </ul>
        </div>

        <div class="algo-card">
          <h4>üîí Privacy Arguments AGAINST</h4>
          <ul>
            <li>Backdoors weaken security for everyone</li>
            <li>Criminals will use non-backdoored crypto</li>
            <li>Massive privacy violation potential</li>
            <li>Key escrow systems can be compromised</li>
            <li>Chilling effect on free speech</li>
            <li>Economic disadvantage for tech companies</li>
          </ul>
        </div>
      </div>

      <h3 class="mt-2">Historical Examples & Case Studies</h3>
      <div class="timeline">
        <div class="timeline-item">
          <div class="timeline-dot"></div>
          <div class="timeline-content">
            <div class="timeline-year">1993 - Clipper Chip</div>
            <p>NSA-designed encryption chip with built-in backdoor for law enforcement. Widely rejected due to security concerns and public backlash. Project abandoned.</p>
          </div>
        </div>

        <div class="timeline-item">
          <div class="timeline-dot"></div>
          <div class="timeline-content">
            <div class="timeline-year">2016 - Apple vs FBI</div>
            <p>FBI demanded Apple create custom iOS to unlock San Bernardino shooter's iPhone. Apple refused, citing security risks. FBI eventually accessed phone through third party.</p>
          </div>
        </div>

        <div class="timeline-item">
          <div class="timeline-dot"></div>
          <div class="timeline-content">
            <div class="timeline-year">2019 - EARN IT Act</div>
            <p>U.S. legislation proposing removal of Section 230 protection unless companies follow "best practices" potentially including encryption backdoors. Ongoing debate.</p>
          </div>
        </div>

        <div class="timeline-item">
          <div class="timeline-dot"></div>
          <div class="timeline-content">
            <div class="timeline-year">2020+ - Going Dark Debate</div>
            <p>Law enforcement claims widespread encryption prevents access to evidence ("going dark"). Tech industry maintains strong encryption is essential for security.</p>
          </div>
        </div>
      </div>

      <h3 class="mt-2">Technical Reality: Why Backdoors Don't Work</h3>
      <div class="info-box warning">
        <div class="info-box-title">‚ö†Ô∏è The Mathematics Don't Care About Intent</div>
        <strong>Any backdoor is a vulnerability.</strong> There's no such thing as a "golden key" that only works for good guys. Cryptography is math - it doesn't distinguish between law enforcement and criminals. If a weakness exists, it WILL be exploited.
      </div>

      <div class="algo-grid mt-2">
        <div class="algo-card">
          <h4>üö® Security Risks</h4>
          <p><strong>Key escrow compromise:</strong> Single point of failure affecting millions</p>
          <p><strong>Implementation flaws:</strong> Backdoors create attack surface</p>
          <p><strong>Insider threats:</strong> Those with access can abuse it</p>
          <p><strong>Foreign adversaries:</strong> Other nations will demand same access</p>
        </div>

        <div class="algo-card">
          <h4>üåç Global Implications</h4>
          <p><strong>Encryption is global:</strong> Criminals use foreign services</p>
          <p><strong>Open source crypto:</strong> Cannot be controlled or backdoored</p>
          <p><strong>Math is universal:</strong> Cannot legislate away strong encryption</p>
          <p><strong>Economic impact:</strong> Users flee to foreign encryption providers</p>
        </div>
      </div>

      <h3 class="mt-2">Ethical Framework for Security Professionals</h3>
      <div class="info-box success">
        <div class="info-box-title">üß≠ Professional Responsibilities</div>
        <ol>
          <li><strong>Security by Design:</strong> Build systems with strong encryption as default</li>
          <li><strong>Transparency:</strong> Be honest about security limitations and capabilities</li>
          <li><strong>User Empowerment:</strong> Give users control over their data and privacy</li>
          <li><strong>No Secret Backdoors:</strong> Refuse to implement hidden vulnerabilities</li>
          <li><strong>Legal Compliance:</strong> Follow laws while advocating for good policy</li>
          <li><strong>Public Education:</strong> Help people understand crypto importance</li>
        </ol>
      </div>

      <div class="info-box mt-2">
        <div class="info-box-title">üí≠ Critical Thinking Questions</div>
        <ul>
          <li>Can we have both strong encryption and lawful access? Or is this a fundamental tradeoff?</li>
          <li>Who should hold the "keys to the kingdom" in a key escrow system?</li>
          <li>How do we balance individual privacy with public safety?</li>
          <li>Should different countries have different encryption standards? What are the implications?</li>
          <li>As a security professional, what is your ethical obligation when asked to weaken encryption?</li>
        </ul>
      </div>

      <div class="info-box warning mt-2">
        <div class="info-box-title">‚ö†Ô∏è Real-World Consequence</div>
        <strong>WeChat & China:</strong> Chinese government has full access to WeChat messages. Citizens use it knowing everything is monitored. Activists, journalists, and dissidents face serious consequences. This is what mandatory government access looks like in practice.
      </div>
    </section>

    <!-- Algorithm Timeline -->
    <section class="section" data-section="11">
      <h2>‚è≥ Cryptographic Algorithm Timeline</h2>

      <div class="timeline">
        <div class="timeline-item">
          <div class="timeline-dot"></div>
          <div class="timeline-content">
            <div class="timeline-year">1977 - RSA</div>
            <p>Rivest-Shamir-Adleman algorithm published. First practical public key cryptosystem. Still widely used today for digital signatures and key exchange.</p>
          </div>
        </div>

        <div class="timeline-item">
          <div class="timeline-dot"></div>
          <div class="timeline-content">
            <div class="timeline-year">1977 - DES</div>
            <p>Data Encryption Standard adopted as federal standard. 56-bit key. Became obsolete by late 1990s due to small key size.</p>
          </div>
        </div>

        <div class="timeline-item">
          <div class="timeline-dot"></div>
          <div class="timeline-content">
            <div class="timeline-year">1991 - MD5</div>
            <p>Message Digest 5 published. 128-bit hash function. Broken in 2004, but still used for non-security checksums.</p>
          </div>
        </div>

        <div class="timeline-item">
          <div class="timeline-dot"></div>
          <div class="timeline-content">
            <div class="timeline-year">1995 - SHA-1</div>
            <p>Secure Hash Algorithm 1. 160-bit output. NIST deprecated it in 2011. Practical collision found in 2017 (SHAttered).</p>
          </div>
        </div>

        <div class="timeline-item">
          <div class="timeline-dot"></div>
          <div class="timeline-content">
            <div class="timeline-year">1998 - Blowfish</div>
            <p>Bruce Schneier's symmetric block cipher. Fast, public domain. Still used in some applications though successor Twofish is preferred.</p>
          </div>
        </div>

        <div class="timeline-item">
          <div class="timeline-dot"></div>
          <div class="timeline-content">
            <div class="timeline-year">2001 - AES</div>
            <p>Advanced Encryption Standard selected after 5-year competition. Replaced DES. Supports 128/192/256-bit keys. Current gold standard for symmetric encryption.</p>
          </div>
        </div>

        <div class="timeline-item">
          <div class="timeline-dot"></div>
          <div class="timeline-content">
            <div class="timeline-year">2001 - SHA-2</div>
            <p>SHA-256, SHA-384, SHA-512 published. Current recommended hash algorithms. No known vulnerabilities.</p>
          </div>
        </div>

        <div class="timeline-item">
          <div class="timeline-dot"></div>
          <div class="timeline-content">
            <div class="timeline-year">2015 - SHA-3</div>
            <p>Based on Keccak algorithm. Different structure from SHA-2, provides algorithmic diversity. NIST's newest hash standard.</p>
          </div>
        </div>

        <div class="timeline-item">
          <div class="timeline-dot"></div>
          <div class="timeline-content">
            <div class="timeline-year">2020+ - Post-Quantum Crypto</div>
            <p>NIST's post-quantum cryptography standardization process. Preparing for the threat of quantum computers breaking RSA and ECC.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Quiz Section -->
    <section class="quiz-container" id="quizSection" data-section="12">
      <div class="quiz-header">
        <h2>üéì Knowledge Assessment Quiz</h2>
        <p>Test your understanding of cryptography fundamentals. 15 questions covering all topics.</p>
      </div>

      <div class="quiz-progress">
        <div>
          <strong>Question:</strong> <span id="currentQuestion">1</span> of <span id="totalQuestions">15</span>
        </div>
        <div>
          <strong>Score:</strong> <span id="quizScore">0</span> / <span id="questionsAnswered">0</span>
        </div>
      </div>

      <div id="quizQuestions"></div>

      <div class="quiz-actions">
        <button class="btn" id="prevBtn" onclick="previousQuestion()" style="display: none;">‚Üê Previous</button>
        <button class="btn-action" id="nextBtn" onclick="nextQuestion()">Next ‚Üí</button>
        <button class="btn-action" id="submitBtn" onclick="submitQuiz()" style="display: none;">Submit Quiz</button>
      </div>

      <div id="quizResult" class="quiz-result">
        <h3>Quiz Complete!</h3>
        <div class="result-score" id="finalScore">0%</div>
        <div class="result-message" id="resultMessage"></div>
        <div class="xp-reward">+80 XP Earned!</div>
        <div class="mt-2">
          <button class="btn-action" onclick="retakeQuiz()">üîÑ Retake Quiz</button>
          <button class="btn" onclick="window.history.back()">‚Üê Return to Key House</button>
        </div>
      </div>
    </section>
  </main>

  <script>
    // Quiz Data
    const quizData = [
      {
        question: "Which of the following is NOT part of the CIA triad protected by cryptography?",
        options: [
          "Confidentiality",
          "Integrity",
          "Authentication",
          "Availability"
        ],
        correct: 3,
        explanation: "The CIA triad consists of Confidentiality, Integrity, and Availability. Authentication is a separate security principle often provided alongside CIA through cryptography."
      },
      {
        question: "What is the main advantage of symmetric encryption over asymmetric encryption?",
        options: [
          "Better security",
          "No key distribution problem",
          "Much faster performance",
          "Provides non-repudiation"
        ],
        correct: 2,
        explanation: "Symmetric encryption is significantly faster than asymmetric encryption, making it ideal for encrypting large amounts of data. However, it suffers from the key distribution problem."
      },
      {
        question: "In the Caesar cipher with a shift of 3, what does 'HELLO' encrypt to?",
        options: [
          "EBIIL",
          "KHOOR",
          "LIPPS",
          "JGNNQ"
        ],
        correct: 1,
        explanation: "Caesar cipher with shift 3: H‚ÜíK, E‚ÜíH, L‚ÜíO, L‚ÜíO, O‚ÜíR. Result: KHOOR"
      },
      {
        question: "Which of these is a block cipher?",
        options: [
          "RC4",
          "ChaCha20",
          "AES",
          "Salsa20"
        ],
        correct: 2,
        explanation: "AES is a block cipher that encrypts data in 128-bit blocks. RC4, ChaCha20, and Salsa20 are all stream ciphers."
      },
      {
        question: "How many possible keys does a 128-bit encryption key provide?",
        options: [
          "128 billion",
          "2^64",
          "2^128",
          "128^2"
        ],
        correct: 2,
        explanation: "A 128-bit key provides 2^128 possible combinations, which is approximately 3.4 √ó 10^38 - enough to be secure against brute-force attacks for the foreseeable future."
      },
      {
        question: "Which hash algorithm is currently considered secure and recommended?",
        options: [
          "MD5",
          "SHA-1",
          "SHA-256",
          "DES"
        ],
        correct: 2,
        explanation: "SHA-256 (part of the SHA-2 family) is currently secure and widely recommended. MD5 and SHA-1 are cryptographically broken, and DES is an encryption algorithm, not a hash."
      },
      {
        question: "What property of hash functions means that a small change in input causes a massive change in output?",
        options: [
          "Collision resistance",
          "Avalanche effect",
          "One-way function",
          "Deterministic"
        ],
        correct: 1,
        explanation: "The avalanche effect ensures that changing even a single bit of input produces a completely different hash output, making it impossible to predict changes."
      },
      {
        question: "In digital signatures, what key is used to CREATE the signature?",
        options: [
          "Sender's public key",
          "Sender's private key",
          "Receiver's public key",
          "Receiver's private key"
        ],
        correct: 1,
        explanation: "Digital signatures are created by encrypting the message hash with the sender's private key. Only the sender possesses this key, ensuring authenticity and non-repudiation."
      },
      {
        question: "What does PKI stand for?",
        options: [
          "Private Key Infrastructure",
          "Public Key Infrastructure",
          "Protected Key Integration",
          "Primary Key Identifier"
        ],
        correct: 1,
        explanation: "PKI stands for Public Key Infrastructure - the framework of policies, technologies, and processes that enable secure public key cryptography at scale."
      },
      {
        question: "In a PKI certificate chain, which entity is at the top?",
        options: [
          "End-entity certificate",
          "Intermediate CA",
          "Root CA",
          "Registration Authority"
        ],
        correct: 2,
        explanation: "The Root CA is at the top of the certificate chain. It is self-signed and pre-installed in browsers and operating systems as a trusted anchor."
      },
      {
        question: "What protocol provides real-time certificate status checking?",
        options: [
          "CRL",
          "OCSP",
          "TLS",
          "SSH"
        ],
        correct: 1,
        explanation: "OCSP (Online Certificate Status Protocol) provides real-time certificate validation. CRL (Certificate Revocation List) is a periodic list, not real-time."
      },
      {
        question: "Which tool is specifically designed for password cracking and hash analysis?",
        options: [
          "OpenSSL",
          "GPG",
          "Hashcat",
          "VeraCrypt"
        ],
        correct: 2,
        explanation: "Hashcat is the world's fastest password cracker, supporting 300+ hash algorithms and GPU acceleration. OpenSSL and GPG are for encryption/certificates, VeraCrypt is for disk encryption."
      },
      {
        question: "What is the main technical problem with government backdoors in encryption?",
        options: [
          "Too expensive to implement",
          "Any backdoor is a vulnerability that can be exploited",
          "Requires too much storage space",
          "Slows down encryption significantly"
        ],
        correct: 1,
        explanation: "The fundamental problem is that any backdoor creates a vulnerability. Cryptography is mathematics - there's no way to create a 'golden key' that only works for authorized parties."
      },
      {
        question: "What happened to the Clipper Chip initiative?",
        options: [
          "It was successfully deployed worldwide",
          "It was abandoned due to security concerns and public backlash",
          "It's still in use today",
          "It evolved into modern AES encryption"
        ],
        correct: 1,
        explanation: "The Clipper Chip (1993) was an NSA-designed encryption chip with a built-in law enforcement backdoor. It was widely rejected and abandoned due to security concerns and privacy backlash."
      },
      {
        question: "Which of the following provides both authentication AND non-repudiation?",
        options: [
          "Symmetric encryption",
          "Hashing",
          "Digital signatures",
          "SSL/TLS"
        ],
        correct: 2,
        explanation: "Digital signatures provide authentication (proves who sent it) and non-repudiation (sender cannot deny sending it). This is because only the sender possesses the private key needed to create the signature."
      }
    ];

    // Quiz State
    let currentQuestionIndex = 0;
    let userAnswers = [];
    let quizScore = 0;

    // Initialize Quiz
    function initializeQuiz() {
      document.getElementById('totalQuestions').textContent = quizData.length;
      renderQuestion();
    }

    // Render Current Question
    function renderQuestion() {
      const questionData = quizData[currentQuestionIndex];
      const container = document.getElementById('quizQuestions');

      const questionHTML = `
        <div class="question-card">
          <div class="question-text">
            ${currentQuestionIndex + 1}. ${questionData.question}
          </div>
          <div class="options">
            ${questionData.options.map((option, index) => `
              <div class="option" onclick="selectOption(${index})" data-option="${index}">
                <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                <div>${option}</div>
              </div>
            `).join('')}
          </div>
          <div id="explanation" style="display: none; margin-top: 1.5rem; padding: 1rem; background: var(--bg-elevated); border-left: 4px solid var(--primary); border-radius: 8px;">
            <strong>Explanation:</strong> <span id="explanationText"></span>
          </div>
        </div>
      `;

      container.innerHTML = questionHTML;

      // Restore previous answer if exists
      if (userAnswers[currentQuestionIndex] !== undefined) {
        const options = document.querySelectorAll('.option');
        options[userAnswers[currentQuestionIndex]].classList.add('selected');
      }

      updateQuizNavigation();
      updateProgress();
    }

    // Select Option
    function selectOption(optionIndex) {
      // If already answered, don't allow changes
      if (userAnswers[currentQuestionIndex] !== undefined) {
        return;
      }

      const options = document.querySelectorAll('.option');
      options.forEach(opt => opt.classList.remove('selected'));
      options[optionIndex].classList.add('selected');

      userAnswers[currentQuestionIndex] = optionIndex;

      // Check answer
      const questionData = quizData[currentQuestionIndex];
      const isCorrect = optionIndex === questionData.correct;

      if (isCorrect) {
        options[optionIndex].classList.add('correct');
        quizScore++;
      } else {
        options[optionIndex].classList.add('incorrect');
        options[questionData.correct].classList.add('correct');
      }

      // Show explanation
      document.getElementById('explanation').style.display = 'block';
      document.getElementById('explanationText').textContent = questionData.explanation;

      updateScore();
    }

    // Update Score Display
    function updateScore() {
      document.getElementById('quizScore').textContent = quizScore;
      document.getElementById('questionsAnswered').textContent = userAnswers.filter(a => a !== undefined).length;
    }

    // Navigation Functions
    function nextQuestion() {
      if (currentQuestionIndex < quizData.length - 1) {
        currentQuestionIndex++;
        renderQuestion();
      }
    }

    function previousQuestion() {
      if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
        renderQuestion();
      }
    }

    function updateQuizNavigation() {
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');
      const submitBtn = document.getElementById('submitBtn');

      prevBtn.style.display = currentQuestionIndex > 0 ? 'inline-block' : 'none';

      if (currentQuestionIndex === quizData.length - 1) {
        nextBtn.style.display = 'none';
        submitBtn.style.display = 'inline-block';
      } else {
        nextBtn.style.display = 'inline-block';
        submitBtn.style.display = 'none';
      }

      document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
    }

    // Submit Quiz
    function submitQuiz() {
      const percentage = Math.round((quizScore / quizData.length) * 100);

      document.getElementById('finalScore').textContent = percentage + '%';

      let message = '';
      if (percentage >= 90) {
        message = 'üåü Outstanding! You have mastered cryptography fundamentals!';
      } else if (percentage >= 80) {
        message = 'üéâ Excellent work! You have a strong understanding of cryptography!';
      } else if (percentage >= 70) {
        message = '‚úÖ Good job! You understand most cryptography concepts.';
      } else if (percentage >= 60) {
        message = 'üìö Passing grade. Review the material to strengthen your knowledge.';
      } else {
        message = 'üìñ Keep studying! Review the sections and try again.';
      }

      document.getElementById('resultMessage').textContent = message;
      document.getElementById('quizResult').classList.add('show');
      document.getElementById('quizQuestions').style.display = 'none';
      document.querySelector('.quiz-actions').style.display = 'none';
      document.querySelector('.quiz-progress').style.display = 'none';

      updateModuleProgress(100);
      saveProgress();
    }

    // Retake Quiz
    function retakeQuiz() {
      currentQuestionIndex = 0;
      userAnswers = [];
      quizScore = 0;

      document.getElementById('quizResult').classList.remove('show');
      document.getElementById('quizQuestions').style.display = 'block';
      document.querySelector('.quiz-actions').style.display = 'flex';
      document.querySelector('.quiz-progress').style.display = 'flex';

      updateScore();
      renderQuestion();
    }

    // Progress Tracking
    function updateModuleProgress(percentage) {
      const progressBar = document.getElementById('progressBar');
      const progressText = document.getElementById('progressText');

      progressBar.style.width = percentage + '%';
      progressText.textContent = percentage + '%';
    }

    function updateProgress() {
      const sections = document.querySelectorAll('[data-section]');
      const sectionsViewed = new Set();

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            sectionsViewed.add(entry.target.dataset.section);
            const progress = Math.min(Math.round((sectionsViewed.size / sections.length) * 100), 95);
            updateModuleProgress(progress);
          }
        });
      }, { threshold: 0.5 });

      sections.forEach(section => observer.observe(section));
    }

    // Save Progress (localStorage)
    function saveProgress() {
      const progressData = {
        completed: true,
        score: quizScore,
        totalQuestions: quizData.length,
        percentage: Math.round((quizScore / quizData.length) * 100),
        timestamp: new Date().toISOString()
      };

      localStorage.setItem('hexworth_cryptography_fundamentals', JSON.stringify(progressData));
    }

    // Scroll to Quiz
    function scrollToQuiz() {
      document.getElementById('quizSection').scrollIntoView({ behavior: 'smooth' });
    }

    // Cipher Functions - Caesar Cipher
    function caesarEncrypt() {
      const plaintext = document.getElementById('caesarPlaintext').value.toUpperCase();
      const shift = parseInt(document.getElementById('caesarShift').value);
      let ciphertext = '';

      for (let char of plaintext) {
        if (char.match(/[A-Z]/)) {
          const charCode = char.charCodeAt(0) - 65;
          const shiftedCode = (charCode + shift) % 26;
          ciphertext += String.fromCharCode(shiftedCode + 65);
        } else {
          ciphertext += char;
        }
      }

      document.getElementById('caesarCiphertext').value = ciphertext;
    }

    function caesarDecrypt() {
      const ciphertext = document.getElementById('caesarCiphertext').value.toUpperCase();
      const shift = parseInt(document.getElementById('caesarShift').value);
      let plaintext = '';

      for (let char of ciphertext) {
        if (char.match(/[A-Z]/)) {
          const charCode = char.charCodeAt(0) - 65;
          const shiftedCode = (charCode - shift + 26) % 26;
          plaintext += String.fromCharCode(shiftedCode + 65);
        } else {
          plaintext += char;
        }
      }

      document.getElementById('caesarPlaintext').value = plaintext;
    }

    // Rail Fence Cipher
    function railFenceEncrypt() {
      const plaintext = document.getElementById('railPlaintext').value.replace(/\s/g, '').toUpperCase();
      const rails = parseInt(document.getElementById('railCount').value);

      if (plaintext.length === 0) return;

      const fence = Array(rails).fill().map(() => []);
      let rail = 0;
      let direction = 1;

      for (let char of plaintext) {
        fence[rail].push(char);
        rail += direction;

        if (rail === 0 || rail === rails - 1) {
          direction *= -1;
        }
      }

      const ciphertext = fence.map(row => row.join('')).join('');
      document.getElementById('railCiphertext').value = ciphertext;

      // Visualize the rail pattern
      visualizeRailFence(plaintext, rails);
    }

    function railFenceDecrypt() {
      const ciphertext = document.getElementById('railCiphertext').value;
      const rails = parseInt(document.getElementById('railCount').value);

      if (ciphertext.length === 0) return;

      const fence = Array(rails).fill().map(() => []);
      const pattern = [];
      let rail = 0;
      let direction = 1;

      // Determine the pattern
      for (let i = 0; i < ciphertext.length; i++) {
        pattern.push(rail);
        rail += direction;

        if (rail === 0 || rail === rails - 1) {
          direction *= -1;
        }
      }

      // Count chars per rail
      const railLengths = Array(rails).fill(0);
      pattern.forEach(r => railLengths[r]++);

      // Distribute ciphertext to rails
      let index = 0;
      for (let r = 0; r < rails; r++) {
        fence[r] = ciphertext.slice(index, index + railLengths[r]).split('');
        index += railLengths[r];
      }

      // Read plaintext from pattern
      let plaintext = '';
      const railIndices = Array(rails).fill(0);
      for (let r of pattern) {
        plaintext += fence[r][railIndices[r]];
        railIndices[r]++;
      }

      document.getElementById('railPlaintext').value = plaintext;
    }

    function visualizeRailFence(text, rails) {
      const fence = Array(rails).fill().map(() => Array(text.length).fill('.'));
      let rail = 0;
      let direction = 1;

      for (let i = 0; i < text.length; i++) {
        fence[rail][i] = text[i];
        rail += direction;

        if (rail === 0 || rail === rails - 1) {
          direction *= -1;
        }
      }

      const visualization = fence.map(row => row.join(' ')).join('\n');
      document.getElementById('railPattern').textContent = visualization;
      document.getElementById('railVisualization').style.display = 'block';
    }

    // Encryption Animation
    function animateEncryption() {
      const stages = document.querySelectorAll('.stage');
      const arrows = document.querySelectorAll('.arrow');

      // Reset
      stages.forEach(s => s.classList.remove('active'));
      arrows.forEach(a => a.classList.remove('active'));

      // Animate sequentially
      let index = 0;
      const interval = setInterval(() => {
        if (index < stages.length) {
          stages[index].classList.add('active');
          if (index > 0) {
            arrows[index - 1].classList.add('active');
          }
          index++;
        } else {
          clearInterval(interval);
        }
      }, 800);
    }

    // Simple Hash Functions (for demonstration - not cryptographically secure)
    function simpleHash(str, algorithm) {
      // These are simulated hashes for demonstration purposes
      // In a real implementation, you'd use Web Crypto API or a library

      let hash = 0;
      for (let i = 0; i < str.length; i++) {
        const char = str.charCodeAt(i);
        hash = ((hash << 5) - hash) + char;
        hash = hash & hash;
      }

      // Simulate different output lengths
      let output = Math.abs(hash).toString(16);

      switch(algorithm) {
        case 'md5':
          output = output.padStart(32, '0').slice(0, 32);
          break;
        case 'sha1':
          output = output.padStart(40, '0').slice(0, 40);
          break;
        case 'sha256':
          output = output.padStart(64, '0').slice(0, 64);
          break;
        case 'sha512':
          output = output.padStart(128, '0').slice(0, 128);
          break;
      }

      return output;
    }

    function generateHashes() {
      const input1 = document.getElementById('hashInput1').value;
      const input2 = document.getElementById('hashInput2').value;
      const algorithm = document.getElementById('hashAlgorithm').value;

      const hash1 = simpleHash(input1, algorithm);
      const hash2 = simpleHash(input2, algorithm);

      document.getElementById('hashOutput1').textContent = hash1;
      document.getElementById('hashOutput2').textContent = hash2;
      document.getElementById('hashResults').style.display = 'block';
      document.getElementById('collisionAlert').classList.remove('show');
    }

    function testCollision() {
      generateHashes();

      const hash1 = document.getElementById('hashOutput1').textContent;
      const hash2 = document.getElementById('hashOutput2').textContent;

      if (hash1 === hash2 && document.getElementById('hashInput1').value !== document.getElementById('hashInput2').value) {
        document.getElementById('collisionAlert').classList.add('show');
      }
    }

    // Initialize on load
    window.addEventListener('DOMContentLoaded', () => {
      initializeQuiz();
      updateProgress();

      // Trigger initial animation
      setTimeout(() => {
        animateEncryption();
      }, 1000);
    });
  </script>
<script src="../../../components/FluxCapacitor.js"></script>
</body>
</html>