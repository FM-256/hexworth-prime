<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Access Control -->
    <script src="../../../components/AccessGuard.js"></script>
    <script>
        AccessGuard.require('sorted');
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PQC Hands-On Lab - House of the Key</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --house-color: #06b6d4;
            --house-glow: rgba(6, 182, 212, 0.4);
            --bg-dark: #0a0a12;
            --bg-card: rgba(15, 15, 25, 0.8);
            --text-primary: #e8e8f0;
            --text-secondary: #8888aa;
            --success-green: #10b981;
            --warning-red: #ef4444;
            --info-blue: #3b82f6;
            --code-bg: rgba(10, 20, 30, 0.9);
        }

        body {
            min-height: 100vh;
            background: var(--bg-dark);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: var(--text-primary);
            overflow-x: hidden;
        }

        /* Header */
        .module-header {
            padding: 20px 30px;
            background: rgba(10, 10, 18, 0.95);
            border-bottom: 1px solid rgba(6, 182, 212, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .back-btn {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            border: 1px solid rgba(6, 182, 212, 0.3);
            background: transparent;
            color: var(--house-color);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            font-size: 1.2rem;
        }

        .back-btn:hover {
            background: rgba(6, 182, 212, 0.1);
        }

        .module-title {
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-primary);
        }

        .house-badge {
            font-size: 0.7rem;
            padding: 4px 12px;
            background: rgba(6, 182, 212, 0.15);
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-radius: 20px;
            color: var(--house-color);
            letter-spacing: 0.1em;
        }

        /* Container */
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 40px 30px;
        }

        /* Page Header */
        .page-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .page-header h1 {
            font-size: 2.5rem;
            color: var(--house-color);
            margin-bottom: 10px;
        }

        .page-header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        /* Progress Bar */
        .lab-progress {
            background: var(--code-bg);
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .progress-title {
            color: var(--house-color);
            font-weight: 600;
        }

        .progress-count {
            color: var(--text-secondary);
        }

        .progress-bar-container {
            height: 10px;
            background: rgba(6, 182, 212, 0.1);
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--house-color), #22d3ee);
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Exercise Card */
        .exercise-card {
            background: var(--bg-card);
            border: 1px solid rgba(6, 182, 212, 0.2);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            transition: all 0.3s ease;
        }

        .exercise-card.completed {
            border-color: var(--success-green);
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.3);
        }

        .exercise-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .exercise-number {
            font-size: 1.5rem;
            color: var(--house-color);
            font-weight: 700;
        }

        .exercise-status {
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .status-pending {
            background: rgba(136, 136, 170, 0.2);
            color: var(--text-secondary);
        }

        .status-completed {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success-green);
        }

        .exercise-title {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 15px;
        }

        .exercise-description {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 20px;
        }

        /* Scenario Box */
        .scenario-box {
            background: var(--code-bg);
            border-left: 4px solid var(--info-blue);
            padding: 20px;
            border-radius: 6px;
            margin: 20px 0;
        }

        .scenario-box h4 {
            color: var(--info-blue);
            margin-bottom: 10px;
        }

        .scenario-box p {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Task List */
        .task-list {
            margin: 20px 0;
        }

        .task-item {
            display: flex;
            align-items: flex-start;
            padding: 12px;
            margin-bottom: 10px;
            background: rgba(6, 182, 212, 0.05);
            border-radius: 6px;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
        }

        .task-item:hover {
            background: rgba(6, 182, 212, 0.1);
        }

        .task-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid var(--house-color);
            border-radius: 4px;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: transparent;
            cursor: pointer;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .task-item.completed {
            border-left-color: var(--success-green);
        }

        .task-item.completed .task-checkbox {
            background: var(--success-green);
            color: var(--bg-dark);
            border-color: var(--success-green);
        }

        .task-text {
            color: var(--text-secondary);
            flex: 1;
            line-height: 1.5;
        }

        .task-item.completed .task-text {
            color: var(--text-primary);
        }

        /* Interactive Section */
        .interactive-section {
            background: var(--code-bg);
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-radius: 8px;
            padding: 25px;
            margin: 20px 0;
        }

        .interactive-section h4 {
            color: var(--house-color);
            margin-bottom: 15px;
        }

        /* Input Groups */
        .input-group {
            margin-bottom: 20px;
        }

        .input-label {
            display: block;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .input-field {
            width: 100%;
            padding: 12px;
            background: rgba(10, 20, 30, 0.5);
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 1rem;
            font-family: 'Segoe UI', sans-serif;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--house-color);
        }

        textarea.input-field {
            min-height: 100px;
            resize: vertical;
            font-family: 'Courier New', monospace;
        }

        /* Selection Grid */
        .selection-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .selection-card {
            background: rgba(6, 182, 212, 0.1);
            border: 2px solid rgba(6, 182, 212, 0.3);
            border-radius: 8px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }

        .selection-card:hover {
            border-color: var(--house-color);
            background: rgba(6, 182, 212, 0.2);
        }

        .selection-card.selected {
            border-color: var(--house-color);
            background: var(--house-color);
            color: var(--bg-dark);
        }

        .selection-card h5 {
            margin-bottom: 8px;
        }

        .selection-card p {
            font-size: 0.85rem;
            opacity: 0.8;
        }

        /* Comparison Table */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: left;
            border: 1px solid rgba(6, 182, 212, 0.2);
        }

        .comparison-table th {
            background: rgba(6, 182, 212, 0.15);
            color: var(--house-color);
            font-weight: 600;
        }

        .comparison-table td {
            color: var(--text-secondary);
        }

        /* Buttons */
        .btn {
            padding: 12px 24px;
            background: var(--house-color);
            border: none;
            border-radius: 6px;
            color: var(--bg-dark);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1rem;
        }

        .btn:hover {
            background: #22d3ee;
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: transparent;
            border: 1px solid var(--house-color);
            color: var(--house-color);
        }

        .btn-secondary:hover {
            background: rgba(6, 182, 212, 0.1);
        }

        /* Feedback Messages */
        .feedback {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid;
            display: none;
        }

        .feedback.show {
            display: block;
        }

        .feedback.success {
            background: rgba(16, 185, 129, 0.1);
            border-color: var(--success-green);
            color: #6ee7b7;
        }

        .feedback.error {
            background: rgba(239, 68, 68, 0.1);
            border-color: var(--warning-red);
            color: #fca5a5;
        }

        .feedback.info {
            background: rgba(6, 182, 212, 0.1);
            border-color: var(--house-color);
            color: #67e8f9;
        }

        /* Timeline Visualization */
        .timeline-viz {
            margin: 25px 0;
            padding: 20px;
            background: rgba(10, 20, 30, 0.5);
            border-radius: 8px;
        }

        .timeline-item {
            display: flex;
            margin-bottom: 15px;
            padding: 12px;
            background: rgba(6, 182, 212, 0.05);
            border-radius: 6px;
            border-left: 3px solid var(--house-color);
        }

        .timeline-year {
            min-width: 80px;
            color: var(--house-color);
            font-weight: 700;
        }

        .timeline-content {
            color: var(--text-secondary);
            flex: 1;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .page-header h1 {
                font-size: 2rem;
            }

            .selection-grid {
                grid-template-columns: 1fr;
            }

            .exercise-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="module-header">
        <div class="header-left">
            <button class="back-btn" onclick="window.location.href='../../../index.html'" title="Back to Key House">
                ←
            </button>
            <div class="module-title">PQC Hands-On Lab</div>
        </div>
        <div class="house-badge">HOUSE OF THE KEY</div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <div class="page-header">
            <h1>Post-Quantum Cryptography Lab</h1>
            <p>Practical exercises to prepare your organization for the quantum era</p>
        </div>

        <!-- Progress Tracker -->
        <div class="lab-progress">
            <div class="progress-header">
                <div class="progress-title">Lab Progress</div>
                <div class="progress-count"><span id="completedCount">0</span> of 7 exercises completed</div>
            </div>
            <div class="progress-bar-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
        </div>

        <!-- Exercise 1: Cryptographic Inventory -->
        <div class="exercise-card" id="exercise1">
            <div class="exercise-header">
                <div class="exercise-number">Exercise 1</div>
                <div class="exercise-status status-pending">Pending</div>
            </div>
            <h3 class="exercise-title">Assess Cryptographic Inventory</h3>
            <p class="exercise-description">
                Before migrating to PQC, you must understand where cryptography is used in your organization.
                In this exercise, you'll identify quantum-vulnerable systems.
            </p>

            <div class="scenario-box">
                <h4>Scenario: Financial Services Company</h4>
                <p>
                    You're the CISO of a mid-sized financial services company. Your infrastructure includes
                    web services, mobile apps, VPN access, code signing, and encrypted backups. Identify which
                    systems use quantum-vulnerable cryptography.
                </p>
            </div>

            <div class="task-list">
                <div class="task-item" onclick="toggleTask(this)">
                    <div class="task-checkbox">✓</div>
                    <div class="task-text">Identify TLS certificates and their algorithms (RSA/ECC)</div>
                </div>
                <div class="task-item" onclick="toggleTask(this)">
                    <div class="task-checkbox">✓</div>
                    <div class="task-text">Document VPN authentication mechanisms (IKEv2, DH groups)</div>
                </div>
                <div class="task-item" onclick="toggleTask(this)">
                    <div class="task-checkbox">✓</div>
                    <div class="task-text">List code signing certificates and their key sizes</div>
                </div>
                <div class="task-item" onclick="toggleTask(this)">
                    <div class="task-checkbox">✓</div>
                    <div class="task-text">Audit encrypted backup systems (key exchange methods)</div>
                </div>
                <div class="task-item" onclick="toggleTask(this)">
                    <div class="task-checkbox">✓</div>
                    <div class="task-text">Check mobile app authentication (OAuth, JWT signing)</div>
                </div>
                <div class="task-item" onclick="toggleTask(this)">
                    <div class="task-checkbox">✓</div>
                    <div class="task-text">Identify third-party services with crypto dependencies</div>
                </div>
            </div>

            <div class="interactive-section">
                <h4>Document Your Findings</h4>
                <div class="input-group">
                    <label class="input-label">List quantum-vulnerable systems you identified:</label>
                    <textarea class="input-field" id="ex1-systems" placeholder="Example: Web server TLS (RSA-2048), VPN (ECDH P-256), Code signing (RSA-4096)..."></textarea>
                </div>
                <button class="btn" onclick="completeExercise(1)">Complete Exercise 1</button>
                <div class="feedback" id="feedback1"></div>
            </div>
        </div>

        <!-- Exercise 2: Size Comparison -->
        <div class="exercise-card" id="exercise2">
            <div class="exercise-header">
                <div class="exercise-number">Exercise 2</div>
                <div class="exercise-status status-pending">Pending</div>
            </div>
            <h3 class="exercise-title">Compare Key and Signature Sizes</h3>
            <p class="exercise-description">
                Understand the bandwidth and storage implications of migrating to post-quantum algorithms
                by comparing sizes across different cryptographic systems.
            </p>

            <div class="scenario-box">
                <h4>Scenario: IoT Device Manufacturer</h4>
                <p>
                    Your company produces IoT devices that communicate over constrained networks. Each device
                    sends signed telemetry data every minute. You need to understand the bandwidth impact
                    of switching from ECDSA to PQC signatures.
                </p>
            </div>

            <div class="interactive-section">
                <h4>Calculate Bandwidth Impact</h4>

                <div class="input-group">
                    <label class="input-label">Current: ECDSA P-256 signature size</label>
                    <input type="text" class="input-field" id="ex2-ecdsa" value="64 bytes" readonly>
                </div>

                <div class="input-group">
                    <label class="input-label">Select PQC algorithm for comparison:</label>
                    <select class="input-field" id="ex2-algo" onchange="updateSizeCalculation()">
                        <option value="">-- Select --</option>
                        <option value="2420">ML-DSA-44 (Dilithium) - 2,420 bytes</option>
                        <option value="3293">ML-DSA-65 (Dilithium) - 3,293 bytes</option>
                        <option value="4595">ML-DSA-87 (Dilithium) - 4,595 bytes</option>
                        <option value="7856">SLH-DSA-128s (SPHINCS+) - 7,856 bytes</option>
                        <option value="17088">SLH-DSA-128f (SPHINCS+) - 17,088 bytes</option>
                    </select>
                </div>

                <div class="input-group">
                    <label class="input-label">Number of devices:</label>
                    <input type="number" class="input-field" id="ex2-devices" value="10000" min="1">
                </div>

                <div id="ex2-results" style="display: none; margin-top: 20px; padding: 15px; background: rgba(6, 182, 212, 0.1); border-radius: 6px;">
                    <h5 style="color: var(--house-color); margin-bottom: 10px;">Bandwidth Comparison (per minute)</h5>
                    <p style="color: var(--text-secondary); margin-bottom: 5px;">
                        <strong>ECDSA P-256:</strong> <span id="ecdsa-bandwidth"></span>
                    </p>
                    <p style="color: var(--text-secondary); margin-bottom: 5px;">
                        <strong>Selected PQC:</strong> <span id="pqc-bandwidth"></span>
                    </p>
                    <p style="color: var(--house-color); font-weight: 600; margin-top: 10px;">
                        <strong>Increase:</strong> <span id="increase-factor"></span>
                    </p>
                </div>

                <button class="btn" onclick="completeExercise(2)" style="margin-top: 15px;">Complete Exercise 2</button>
                <div class="feedback" id="feedback2"></div>
            </div>
        </div>

        <!-- Exercise 3: Lattice Problem Visualization -->
        <div class="exercise-card" id="exercise3">
            <div class="exercise-header">
                <div class="exercise-number">Exercise 3</div>
                <div class="exercise-status status-pending">Pending</div>
            </div>
            <h3 class="exercise-title">Understand Lattice-Based Cryptography</h3>
            <p class="exercise-description">
                Explore the mathematical foundation of ML-KEM and ML-DSA by understanding the Learning With
                Errors (LWE) problem that makes lattice cryptography quantum-resistant.
            </p>

            <div class="interactive-section">
                <h4>Learning With Errors (LWE) Simplified</h4>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">
                    The LWE problem: Given A·s + e = b (mod q), where 'e' is a small error, find the secret 's'.
                    The errors make it computationally hard even with many samples.
                </p>

                <div class="task-list">
                    <div class="task-item" onclick="toggleTask(this)">
                        <div class="task-checkbox">✓</div>
                        <div class="task-text">Understand: LWE is a system of linear equations with noise</div>
                    </div>
                    <div class="task-item" onclick="toggleTask(this)">
                        <div class="task-checkbox">✓</div>
                        <div class="task-text">Recognize: The "errors" prevent solving for the secret</div>
                    </div>
                    <div class="task-item" onclick="toggleTask(this)">
                        <div class="task-checkbox">✓</div>
                        <div class="task-text">Learn: Quantum computers don't have efficient LWE solvers</div>
                    </div>
                    <div class="task-item" onclick="toggleTask(this)">
                        <div class="task-checkbox">✓</div>
                        <div class="task-text">Note: Module-LWE (used in Kyber/Dilithium) is more efficient</div>
                    </div>
                </div>

                <div style="margin-top: 25px; padding: 20px; background: rgba(10, 20, 30, 0.5); border-radius: 8px;">
                    <h5 style="color: var(--house-color); margin-bottom: 15px;">Why Lattice Cryptography Wins</h5>
                    <table class="comparison-table">
                        <tr>
                            <td><strong>Fast Performance</strong></td>
                            <td>Faster than RSA, comparable to ECC</td>
                        </tr>
                        <tr>
                            <td><strong>Reasonable Sizes</strong></td>
                            <td>1-4 KB keys/signatures (vs 200+ KB for McEliece)</td>
                        </tr>
                        <tr>
                            <td><strong>Provable Security</strong></td>
                            <td>Reduces to worst-case lattice problems</td>
                        </tr>
                        <tr>
                            <td><strong>Versatile</strong></td>
                            <td>Supports encryption, signatures, and advanced protocols</td>
                        </tr>
                    </table>
                </div>

                <button class="btn" onclick="completeExercise(3)" style="margin-top: 20px;">Complete Exercise 3</button>
                <div class="feedback" id="feedback3"></div>
            </div>
        </div>

        <!-- Exercise 4: Hybrid Migration Planning -->
        <div class="exercise-card" id="exercise4">
            <div class="exercise-header">
                <div class="exercise-number">Exercise 4</div>
                <div class="exercise-status status-pending">Pending</div>
            </div>
            <h3 class="exercise-title">Plan Hybrid Migration Strategy</h3>
            <p class="exercise-description">
                Design a phased transition strategy using hybrid cryptography to maintain security during
                the migration from classical to post-quantum algorithms.
            </p>

            <div class="scenario-box">
                <h4>Scenario: E-Commerce Platform</h4>
                <p>
                    Your platform handles millions of transactions daily. You need to migrate to PQC without
                    disrupting service. Design a hybrid deployment strategy that provides both classical and
                    quantum resistance during the transition.
                </p>
            </div>

            <div class="interactive-section">
                <h4>Build Your Migration Timeline</h4>

                <div class="timeline-viz">
                    <div class="timeline-item">
                        <div class="timeline-year">Phase 1</div>
                        <div class="timeline-content">
                            <strong>Assessment (Q1 2024)</strong><br>
                            Cryptographic inventory, risk assessment, vendor engagement
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-year">Phase 2</div>
                        <div class="timeline-content">
                            <strong>Preparation (Q2-Q3 2024)</strong><br>
                            Update libraries, build crypto agility, test PQC in staging
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-year">Phase 3</div>
                        <div class="timeline-content">
                            <strong>Hybrid Deployment (Q4 2024 - 2025)</strong><br>
                            Deploy X25519+Kyber for TLS, ECDSA+Dilithium for signatures
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-year">Phase 4</div>
                        <div class="timeline-content">
                            <strong>Monitoring (2025-2027)</strong><br>
                            Monitor performance, gather data, adjust as needed
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-year">Phase 5</div>
                        <div class="timeline-content">
                            <strong>PQC-Only (2027+)</strong><br>
                            Phase out classical algorithms based on quantum threat assessment
                        </div>
                    </div>
                </div>

                <div class="input-group" style="margin-top: 25px;">
                    <label class="input-label">Select systems to migrate first (highest priority):</label>
                    <div class="task-list">
                        <div class="task-item" onclick="toggleTask(this)">
                            <div class="task-checkbox">✓</div>
                            <div class="task-text">Root CA certificates (long lifetime, high impact)</div>
                        </div>
                        <div class="task-item" onclick="toggleTask(this)">
                            <div class="task-checkbox">✓</div>
                            <div class="task-text">Long-term data storage (HNDL threat)</div>
                        </div>
                        <div class="task-item" onclick="toggleTask(this)">
                            <div class="task-checkbox">✓</div>
                            <div class="task-text">External-facing TLS (customer connections)</div>
                        </div>
                        <div class="task-item" onclick="toggleTask(this)">
                            <div class="task-checkbox">✓</div>
                            <div class="task-text">Code signing infrastructure (software updates)</div>
                        </div>
                    </div>
                </div>

                <button class="btn" onclick="completeExercise(4)" style="margin-top: 20px;">Complete Exercise 4</button>
                <div class="feedback" id="feedback4"></div>
            </div>
        </div>

        <!-- Exercise 5: Algorithm Selection -->
        <div class="exercise-card" id="exercise5">
            <div class="exercise-header">
                <div class="exercise-number">Exercise 5</div>
                <div class="exercise-status status-pending">Pending</div>
            </div>
            <h3 class="exercise-title">Evaluate Algorithm Trade-offs</h3>
            <p class="exercise-description">
                Different PQC algorithms have different strengths. Learn to select the right algorithm
                based on your specific requirements and constraints.
            </p>

            <div class="interactive-section">
                <h4>Match Algorithms to Use Cases</h4>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">
                    For each scenario below, select the most appropriate PQC algorithm and justify your choice.
                </p>

                <!-- Scenario 1 -->
                <div style="margin-bottom: 30px; padding: 20px; background: rgba(10, 20, 30, 0.5); border-radius: 8px;">
                    <h5 style="color: var(--house-color); margin-bottom: 10px;">Scenario A: High-Security Government Communications</h5>
                    <p style="color: var(--text-secondary); margin-bottom: 15px; font-size: 0.95rem;">
                        Requirements: Maximum security confidence, long-term protection (50+ years), bandwidth not critical
                    </p>
                    <div class="selection-grid">
                        <div class="selection-card" onclick="selectAlgo('5a', this, 'kyber')">
                            <h5>ML-KEM-1024</h5>
                            <p>Kyber highest security</p>
                        </div>
                        <div class="selection-card" onclick="selectAlgo('5a', this, 'sphincs')">
                            <h5>SLH-DSA-256s</h5>
                            <p>SPHINCS+ conservative</p>
                        </div>
                        <div class="selection-card" onclick="selectAlgo('5a', this, 'mceliece')">
                            <h5>Classic McEliece</h5>
                            <p>45+ years of study</p>
                        </div>
                    </div>
                </div>

                <!-- Scenario 2 -->
                <div style="margin-bottom: 30px; padding: 20px; background: rgba(10, 20, 30, 0.5); border-radius: 8px;">
                    <h5 style="color: var(--house-color); margin-bottom: 10px;">Scenario B: Mobile App Authentication</h5>
                    <p style="color: var(--text-secondary); margin-bottom: 15px; font-size: 0.95rem;">
                        Requirements: Fast performance, reasonable bandwidth, widespread compatibility
                    </p>
                    <div class="selection-grid">
                        <div class="selection-card" onclick="selectAlgo('5b', this, 'dilithium44')">
                            <h5>ML-DSA-44</h5>
                            <p>Smallest Dilithium</p>
                        </div>
                        <div class="selection-card" onclick="selectAlgo('5b', this, 'dilithium65')">
                            <h5>ML-DSA-65</h5>
                            <p>Balanced performance</p>
                        </div>
                        <div class="selection-card" onclick="selectAlgo('5b', this, 'hybrid')">
                            <h5>Hybrid ECDSA+Dilithium</h5>
                            <p>Transition compatibility</p>
                        </div>
                    </div>
                </div>

                <!-- Scenario 3 -->
                <div style="margin-bottom: 20px; padding: 20px; background: rgba(10, 20, 30, 0.5); border-radius: 8px;">
                    <h5 style="color: var(--house-color); margin-bottom: 10px;">Scenario C: Firmware Updates for IoT</h5>
                    <p style="color: var(--text-secondary); margin-bottom: 15px; font-size: 0.95rem;">
                        Requirements: Strong security, updates are infrequent, devices have limited bandwidth
                    </p>
                    <div class="selection-grid">
                        <div class="selection-card" onclick="selectAlgo('5c', this, 'dilithium44')">
                            <h5>ML-DSA-44</h5>
                            <p>Smallest signatures</p>
                        </div>
                        <div class="selection-card" onclick="selectAlgo('5c', this, 'sphincs-s')">
                            <h5>SLH-DSA-128s</h5>
                            <p>Conservative, 7.8 KB</p>
                        </div>
                        <div class="selection-card" onclick="selectAlgo('5c', this, 'sphincs-f')">
                            <h5>SLH-DSA-128f</h5>
                            <p>Faster, 17 KB</p>
                        </div>
                    </div>
                </div>

                <button class="btn" onclick="completeExercise(5)">Complete Exercise 5</button>
                <div class="feedback" id="feedback5"></div>
            </div>
        </div>

        <!-- Exercise 6: NIST Standards Review -->
        <div class="exercise-card" id="exercise6">
            <div class="exercise-header">
                <div class="exercise-number">Exercise 6</div>
                <div class="exercise-status status-pending">Pending</div>
            </div>
            <h3 class="exercise-title">Review NIST PQC Standards</h3>
            <p class="exercise-description">
                Understand the official NIST standards (FIPS 203, 204, 205) and how to apply them in
                real-world systems.
            </p>

            <div class="interactive-section">
                <h4>NIST FIPS Standards Overview</h4>

                <table class="comparison-table" style="margin: 20px 0;">
                    <thead>
                        <tr>
                            <th>Standard</th>
                            <th>Algorithm</th>
                            <th>Purpose</th>
                            <th>Publication</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>FIPS 203</strong></td>
                            <td>ML-KEM (Kyber)</td>
                            <td>Key Encapsulation Mechanism</td>
                            <td>August 2024</td>
                        </tr>
                        <tr>
                            <td><strong>FIPS 204</strong></td>
                            <td>ML-DSA (Dilithium)</td>
                            <td>Digital Signature Algorithm</td>
                            <td>August 2024</td>
                        </tr>
                        <tr>
                            <td><strong>FIPS 205</strong></td>
                            <td>SLH-DSA (SPHINCS+)</td>
                            <td>Stateless Hash-Based Signatures</td>
                            <td>August 2024</td>
                        </tr>
                    </tbody>
                </table>

                <div class="task-list">
                    <div class="task-item" onclick="toggleTask(this)">
                        <div class="task-checkbox">✓</div>
                        <div class="task-text">FIPS 203 (ML-KEM): Use for TLS key exchange, VPN tunnels, data encryption</div>
                    </div>
                    <div class="task-item" onclick="toggleTask(this)">
                        <div class="task-checkbox">✓</div>
                        <div class="task-text">FIPS 204 (ML-DSA): Primary choice for digital signatures, certificates, code signing</div>
                    </div>
                    <div class="task-item" onclick="toggleTask(this)">
                        <div class="task-checkbox">✓</div>
                        <div class="task-text">FIPS 205 (SLH-DSA): Backup signature option, conservative security for high-value assets</div>
                    </div>
                    <div class="task-item" onclick="toggleTask(this)">
                        <div class="task-checkbox">✓</div>
                        <div class="task-text">Understand parameter sets: Choose security level (128/192/256-bit equivalent)</div>
                    </div>
                    <div class="task-item" onclick="toggleTask(this)">
                        <div class="task-checkbox">✓</div>
                        <div class="task-text">Follow NIST recommendations for hybrid approaches during transition</div>
                    </div>
                    <div class="task-item" onclick="toggleTask(this)">
                        <div class="task-checkbox">✓</div>
                        <div class="task-text">Monitor Round 4 candidates (FALCON, McEliece) for future standardization</div>
                    </div>
                </div>

                <div style="margin-top: 25px; padding: 20px; background: rgba(6, 182, 212, 0.1); border-radius: 8px;">
                    <h5 style="color: var(--house-color); margin-bottom: 10px;">Implementation Guidance</h5>
                    <ul style="color: var(--text-secondary); line-height: 1.8; margin-left: 20px;">
                        <li>Use NIST-approved implementations (validated by CAVP when available)</li>
                        <li>Follow parameter recommendations for your security level</li>
                        <li>Implement crypto agility to swap algorithms if needed</li>
                        <li>Test implementations thoroughly (side-channel resistance, error handling)</li>
                        <li>Stay updated on NIST guidance and security advisories</li>
                    </ul>
                </div>

                <button class="btn" onclick="completeExercise(6)" style="margin-top: 20px;">Complete Exercise 6</button>
                <div class="feedback" id="feedback6"></div>
            </div>
        </div>

        <!-- Exercise 7: Crypto Agility Planning -->
        <div class="exercise-card" id="exercise7">
            <div class="exercise-header">
                <div class="exercise-number">Exercise 7</div>
                <div class="exercise-status status-pending">Pending</div>
            </div>
            <h3 class="exercise-title">Create Crypto Agility Plan</h3>
            <p class="exercise-description">
                Design a cryptographically agile architecture that can adapt to future algorithm changes
                without major system redesign.
            </p>

            <div class="scenario-box">
                <h4>Scenario: Software Company</h4>
                <p>
                    Your company develops enterprise software used by thousands of customers. You need to
                    ensure your cryptographic architecture can evolve as standards change, new vulnerabilities
                    are discovered, and quantum computing advances.
                </p>
            </div>

            <div class="interactive-section">
                <h4>Crypto Agility Design Principles</h4>

                <div class="task-list">
                    <div class="task-item" onclick="toggleTask(this)">
                        <div class="task-checkbox">✓</div>
                        <div class="task-text">Abstract crypto operations behind interfaces (don't hard-code algorithms)</div>
                    </div>
                    <div class="task-item" onclick="toggleTask(this)">
                        <div class="task-checkbox">✓</div>
                        <div class="task-text">Store algorithm identifiers with encrypted data (enable re-encryption)</div>
                    </div>
                    <div class="task-item" onclick="toggleTask(this)">
                        <div class="task-checkbox">✓</div>
                        <div class="task-text">Support algorithm negotiation in protocols (client/server agree on algorithms)</div>
                    </div>
                    <div class="task-item" onclick="toggleTask(this)">
                        <div class="task-checkbox">✓</div>
                        <div class="task-text">Use configurable crypto libraries (OpenSSL, BoringSSL, liboqs)</div>
                    </div>
                    <div class="task-item" onclick="toggleTask(this)">
                        <div class="task-checkbox">✓</div>
                        <div class="task-text">Implement key rotation and re-keying mechanisms</div>
                    </div>
                    <div class="task-item" onclick="toggleTask(this)">
                        <div class="task-checkbox">✓</div>
                        <div class="task-text">Plan for hybrid modes (combine multiple algorithms for transition)</div>
                    </div>
                    <div class="task-item" onclick="toggleTask(this)">
                        <div class="task-checkbox">✓</div>
                        <div class="task-text">Automate testing across algorithm combinations</div>
                    </div>
                    <div class="task-item" onclick="toggleTask(this)">
                        <div class="task-checkbox">✓</div>
                        <div class="task-text">Document crypto choices and maintain upgrade path documentation</div>
                    </div>
                </div>

                <div class="input-group" style="margin-top: 25px;">
                    <label class="input-label">Describe your crypto agility strategy:</label>
                    <textarea class="input-field" id="ex7-strategy" placeholder="How will you design for algorithm flexibility? What abstraction layers will you use? How will you handle algorithm transitions?"></textarea>
                </div>

                <div style="margin-top: 25px; padding: 20px; background: rgba(16, 185, 129, 0.1); border-left: 4px solid var(--success-green); border-radius: 6px;">
                    <h5 style="color: var(--success-green); margin-bottom: 10px;">Benefits of Crypto Agility</h5>
                    <ul style="color: var(--text-secondary); line-height: 1.8; margin-left: 20px;">
                        <li>Quick response to cryptographic vulnerabilities</li>
                        <li>Smooth transitions to new standards</li>
                        <li>Support for hybrid approaches during migrations</li>
                        <li>Reduced technical debt and maintenance costs</li>
                        <li>Future-proof architecture for ongoing quantum threats</li>
                    </ul>
                </div>

                <button class="btn" onclick="completeExercise(7)" style="margin-top: 20px;">Complete Exercise 7</button>
                <div class="feedback" id="feedback7"></div>
            </div>
        </div>

        <!-- Lab Complete Message -->
        <div id="labComplete" style="display: none; text-align: center; padding: 50px 20px; background: linear-gradient(135deg, rgba(6, 182, 212, 0.1), rgba(16, 185, 129, 0.1)); border-radius: 12px; border: 2px solid var(--success-green);">
            <h2 style="color: var(--success-green); margin-bottom: 15px; font-size: 2rem;">Lab Complete!</h2>
            <p style="color: var(--text-secondary); margin-bottom: 25px; font-size: 1.1rem;">
                You've completed all PQC lab exercises. You're now equipped to plan and execute a
                post-quantum cryptography migration in your organization.
            </p>
            <button class="btn" onclick="window.location.href='../../../index.html'">Return to Key House</button>
        </div>
    </div>

    <script>
        let exercisesCompleted = new Set();
        let algoSelections = { '5a': null, '5b': null, '5c': null };

        // Toggle task completion
        function toggleTask(element) {
            element.classList.toggle('completed');
        }

        // Update size calculation
        function updateSizeCalculation() {
            const algoSize = parseInt(document.getElementById('ex2-algo').value);
            const devices = parseInt(document.getElementById('ex2-devices').value);

            if (algoSize && devices) {
                const ecdsaSize = 64;
                const ecdsaBandwidth = (ecdsaSize * devices) / 1024; // KB
                const pqcBandwidth = (algoSize * devices) / 1024; // KB
                const increase = (algoSize / ecdsaSize).toFixed(1);

                document.getElementById('ecdsa-bandwidth').textContent = ecdsaBandwidth.toFixed(2) + ' KB';
                document.getElementById('pqc-bandwidth').textContent = pqcBandwidth.toFixed(2) + ' KB';
                document.getElementById('increase-factor').textContent = increase + 'x more bandwidth';

                document.getElementById('ex2-results').style.display = 'block';
            }
        }

        // Select algorithm for exercise 5
        function selectAlgo(scenario, element, algo) {
            // Remove selected from siblings
            element.parentElement.querySelectorAll('.selection-card').forEach(card => {
                card.classList.remove('selected');
            });

            // Mark as selected
            element.classList.add('selected');

            // Store selection
            algoSelections[scenario] = algo;
        }

        // Complete exercise
        function completeExercise(num) {
            const feedback = document.getElementById('feedback' + num);
            const card = document.getElementById('exercise' + num);
            const status = card.querySelector('.exercise-status');

            // Validation
            let valid = true;
            let message = '';

            if (num === 1) {
                const systems = document.getElementById('ex1-systems').value.trim();
                if (systems.length < 20) {
                    valid = false;
                    message = 'Please document at least a few quantum-vulnerable systems from the scenario.';
                } else {
                    message = 'Excellent! You\'ve identified the cryptographic inventory. This is the critical first step for any PQC migration.';
                }
            } else if (num === 2) {
                const algo = document.getElementById('ex2-algo').value;
                if (!algo) {
                    valid = false;
                    message = 'Please select a PQC algorithm to compare bandwidth impact.';
                } else {
                    message = 'Great work! Understanding bandwidth implications helps you plan for network capacity and choose appropriate algorithms.';
                }
            } else if (num === 3) {
                message = 'Excellent! You now understand why lattice-based cryptography is the foundation of NIST\'s primary PQC standards.';
            } else if (num === 4) {
                message = 'Well done! A phased hybrid approach minimizes risk while providing quantum resistance during the transition.';
            } else if (num === 5) {
                if (!algoSelections['5a'] || !algoSelections['5b'] || !algoSelections['5c']) {
                    valid = false;
                    message = 'Please select an algorithm for all three scenarios.';
                } else {
                    message = 'Great selections! Understanding algorithm trade-offs helps you match PQC to your specific requirements. SPHINCS+ for high-security, Dilithium for balanced use cases.';
                }
            } else if (num === 6) {
                message = 'Excellent! Following NIST standards ensures interoperability and compliance with government requirements.';
            } else if (num === 7) {
                const strategy = document.getElementById('ex7-strategy').value.trim();
                if (strategy.length < 30) {
                    valid = false;
                    message = 'Please describe your crypto agility strategy in more detail.';
                } else {
                    message = 'Outstanding! Crypto agility is essential for long-term security. Your architecture can now adapt to future cryptographic advances.';
                }
            }

            if (valid) {
                exercisesCompleted.add(num);
                card.classList.add('completed');
                status.textContent = 'Completed';
                status.classList.remove('status-pending');
                status.classList.add('status-completed');

                feedback.textContent = message;
                feedback.classList.add('success', 'show');

                updateProgress();

                if (exercisesCompleted.size === 7) {
                    setTimeout(() => {
                        document.getElementById('labComplete').style.display = 'block';
                        document.getElementById('labComplete').scrollIntoView({ behavior: 'smooth' });
                    }, 1000);
                }
            } else {
                feedback.textContent = message;
                feedback.classList.add('error', 'show');
            }

            setTimeout(() => {
                feedback.classList.remove('show');
            }, 5000);
        }

        // Update progress
        function updateProgress() {
            const total = 7;
            const completed = exercisesCompleted.size;
            const percentage = (completed / total) * 100;

            document.getElementById('completedCount').textContent = completed;
            document.getElementById('progressBar').style.width = percentage + '%';
        }

        // Initialize
        window.addEventListener('DOMContentLoaded', function() {
            updateProgress();
        });
    </script>
</body>
</html>
