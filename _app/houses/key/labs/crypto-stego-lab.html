<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Cryptography & Steganography Lab - Hexworth Prime</title>
<style>
  :root {
    --bg: #0a0a0f;
    --bg2: #1a1500;
    --card: #1f1a0a;
    --ink: #e0e0e0;
    --muted: #a0956a;
    --accent: #fbbf24;
    --accent2: #f59e0b;
    --accent-glow: rgba(251, 191, 36, 0.3);
    --ok: #2ed573;
    --bad: #ff4757;
    --border: rgba(251, 191, 36, 0.2);
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
    background: linear-gradient(135deg, #0a0a0f 0%, #1a1500 50%, #3d2e00 100%);
    color: var(--ink);
    min-height: 100vh;
    padding-bottom: 80px;
  }

  .page-header {
    padding: 15px 30px;
    background: rgba(0, 0, 0, 0.5);
    border-bottom: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: sticky;
    top: 0;
    z-index: 100;
  }

  .page-header a { color: var(--muted); text-decoration: none; font-size: 0.9rem; }
  .page-header a:hover { color: var(--accent); }
  .brand { font-weight: 600; display: flex; align-items: center; gap: 8px; }
  .brand-icon { font-size: 1.2rem; }

  .container { max-width: 1000px; margin: 0 auto; padding: 20px; }

  .progress-bar {
    background: rgba(255,255,255,0.1);
    height: 6px;
    border-radius: 6px;
    margin-bottom: 24px;
    overflow: hidden;
  }

  .progress-fill {
    background: linear-gradient(90deg, var(--accent), var(--accent2));
    height: 100%;
    width: 10%;
    transition: width 0.3s ease;
  }

  section {
    display: none;
    padding: 36px;
    background: linear-gradient(180deg, rgba(31, 26, 10, 0.9) 0%, rgba(10, 10, 15, 0.95) 100%);
    border: 1px solid var(--border);
    border-radius: 16px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
    margin: 20px 0;
    position: relative;
  }

  section.active { display: block; animation: slideIn 0.4s ease-out; }

  @keyframes slideIn {
    from { opacity: 0; transform: translateY(15px); }
    to { opacity: 1; transform: translateY(0); }
  }

  h1 {
    font-size: clamp(1.8rem, 4vw, 2.4rem);
    text-align: center;
    margin-bottom: 16px;
    background: linear-gradient(90deg, var(--accent), var(--accent2));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  h2 {
    color: var(--accent);
    font-size: 1.4rem;
    border-bottom: 2px solid var(--border);
    padding-bottom: 10px;
    margin-bottom: 20px;
  }

  h3 { color: var(--accent); margin-top: 24px; margin-bottom: 12px; font-size: 1.1rem; }

  p { color: var(--ink); line-height: 1.7; margin-bottom: 16px; }

  ul, ol { padding-left: 24px; margin: 16px 0; line-height: 1.8; }
  li { margin: 8px 0; }

  .badge {
    display: inline-block;
    padding: 4px 12px;
    background: rgba(251, 191, 36, 0.15);
    color: var(--accent);
    border: 1px solid var(--border);
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    margin: 4px;
  }

  .slide-number {
    position: absolute;
    top: 16px;
    right: 16px;
    background: var(--accent);
    color: #0a0a0f;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 600;
  }

  .controls {
    position: fixed;
    top: 80px;
    right: 20px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    z-index: 99;
  }

  .nav {
    position: fixed;
    bottom: 20px;
    right: 20px;
    display: flex;
    gap: 10px;
    z-index: 99;
  }

  button {
    padding: 12px 20px;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    font-weight: 600;
    font-size: 0.95rem;
    transition: all 0.2s;
  }

  button:hover { transform: translateY(-2px); }

  .btn-next { background: linear-gradient(135deg, var(--ok), #26a65b); color: #fff; }
  .btn-prev { background: rgba(255,255,255,0.1); color: var(--ink); border: 1px solid var(--border); }
  .btn-theme { background: rgba(34, 211, 238, 0.2); color: #22d3ee; font-size: 0.8rem; padding: 8px 12px; }
  .btn-reset { background: rgba(255, 71, 87, 0.2); color: #ff4757; font-size: 0.8rem; padding: 8px 12px; }
  .btn-action { background: linear-gradient(135deg, var(--accent), var(--accent2)); color: #0a0a0f; margin-top: 12px; }
  .btn-decode { background: linear-gradient(135deg, #d97706, #b45309); color: #fff; }

  .interactive {
    background: rgba(0, 0, 0, 0.3);
    padding: 24px;
    border: 1px solid var(--border);
    border-radius: 12px;
    margin: 20px 0;
  }

  .demo-box {
    background: rgba(251, 191, 36, 0.08);
    padding: 16px;
    border-radius: 10px;
    border-left: 4px solid var(--accent);
    margin: 16px 0;
  }

  .info-box {
    background: rgba(251, 191, 36, 0.1);
    border-left: 4px solid var(--accent);
    padding: 16px;
    border-radius: 0 10px 10px 0;
    margin: 16px 0;
  }

  .success-box {
    background: rgba(46, 213, 115, 0.15);
    border-left: 4px solid var(--ok);
    padding: 16px;
    border-radius: 0 10px 10px 0;
    margin: 16px 0;
  }

  .comparison {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
    margin: 20px 0;
  }

  .comparison-item {
    padding: 20px;
    background: rgba(0,0,0,0.3);
    border: 1px solid var(--border);
    border-radius: 12px;
  }

  .comparison-item h4 { color: var(--accent); margin-bottom: 10px; }

  .visual-demo {
    display: flex;
    align-items: center;
    justify-content: space-around;
    margin: 24px 0;
    padding: 24px;
    background: rgba(0,0,0,0.3);
    border-radius: 12px;
    flex-wrap: wrap;
    gap: 16px;
  }

  .visual-box {
    padding: 20px;
    background: rgba(251, 191, 36, 0.1);
    border: 1px solid var(--border);
    border-radius: 10px;
    text-align: center;
    min-width: 140px;
  }

  .arrow { font-size: 2rem; color: var(--accent); }

  textarea, input[type="text"], input[type="password"] {
    width: 100%;
    margin-top: 8px;
    padding: 12px;
    border: 1px solid var(--border);
    border-radius: 8px;
    background: rgba(0,0,0,0.4);
    color: var(--ink);
    font-family: 'Fira Code', monospace;
    font-size: 0.95rem;
  }

  textarea:focus, input:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 15px var(--accent-glow);
  }

  input[type="file"] { margin-top: 8px; padding: 10px; color: var(--ink); }

  pre {
    background: rgba(0,0,0,0.5);
    color: var(--accent);
    padding: 16px;
    border-radius: 8px;
    overflow-x: auto;
    font-family: 'Fira Code', monospace;
    font-size: 0.9rem;
    border: 1px solid var(--border);
    margin: 12px 0;
  }

  .result {
    background: rgba(46, 213, 115, 0.1);
    border: 1px solid rgba(46, 213, 115, 0.3);
    padding: 16px;
    border-radius: 10px;
    margin-top: 16px;
    display: none;
  }

  .algo-selector { display: flex; gap: 10px; margin: 12px 0; flex-wrap: wrap; }

  .algo-btn {
    padding: 8px 16px;
    background: rgba(255,255,255,0.08);
    color: var(--accent);
    border: 1px solid var(--border);
    border-radius: 8px;
    cursor: pointer;
  }

  .algo-btn.active {
    background: var(--accent);
    color: #0a0a0f;
    border-color: var(--accent);
  }

  .canvas-container { text-align: center; margin: 20px 0; }

  canvas {
    border: 2px solid var(--border);
    border-radius: 10px;
    max-width: 100%;
    background: rgba(0,0,0,0.3);
  }

  label { display: block; color: var(--muted); font-size: 0.9rem; margin-top: 14px; }
  label:first-child { margin-top: 0; }

  footer { text-align: center; padding: 30px; color: var(--muted); font-size: 0.85rem; }
  footer a { color: var(--accent); text-decoration: none; }

  @media (max-width: 768px) {
    .comparison { grid-template-columns: 1fr; }
    .visual-demo { flex-direction: column; }
    .controls { top: auto; bottom: 80px; right: 10px; }
    section { padding: 24px; }
  }
</style>
</head>
<body>

<header class="page-header">
  <a href="../../index.html">‚Üê Back to Key House</a>
  <span class="brand"><span class="brand-icon">üîë</span> Hexworth Prime</span>
</header>

<div class="controls">
  <button class="btn-theme" id="random">üé® Theme</button>
  <button class="btn-reset" id="reset">‚Ü∫ Reset</button>
</div>

<div class="container">
  <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>

  <!-- SLIDE 1: INTRO -->
  <section id="slide1" class="active">
    <div class="slide-number">1/10</div>
    <h1>üîê Cryptography & Steganography Lab</h1>
    <p style="text-align:center;color:var(--muted);">A Progressive, Hands-On Journey into Data Security</p>
    <div class="comparison">
      <div class="comparison-item">
        <h4>üîí Cryptography</h4>
        <p>Transforms data into an unreadable format. Everyone knows data exists, but only authorized parties can read it.</p>
        <div class="badge">Encryption</div><div class="badge">Hashing</div><div class="badge">Digital Signatures</div>
      </div>
      <div class="comparison-item">
        <h4>üé≠ Steganography</h4>
        <p>Hides data within other files. The existence of the secret message is concealed from observers.</p>
        <div class="badge">Image Hiding</div><div class="badge">Watermarking</div><div class="badge">Covert Channels</div>
      </div>
    </div>
    <div class="info-box"><strong>üí° Learning Path:</strong> This lab builds understanding through 10 interactive modules, from basic concepts to advanced encryption and steganography techniques.</div>
  </section>

  <!-- SLIDE 2: HASHING INTRO -->
  <section id="slide2">
    <div class="slide-number">2/10</div>
    <h2>üîë Introduction to Hashing</h2>
    <div class="visual-demo">
      <div class="visual-box"><strong>Input</strong><br>"Hello World"<br>(any size)</div>
      <div class="arrow">‚Üí</div>
      <div class="visual-box"><strong>Hash Function</strong><br>SHA-256</div>
      <div class="arrow">‚Üí</div>
      <div class="visual-box"><strong>Output</strong><br>a591a6d4...<br>(fixed 256 bits)</div>
    </div>
    <h3>Key Properties:</h3>
    <ul>
      <li><strong>Deterministic:</strong> Same input always produces the same hash</li>
      <li><strong>One-way:</strong> Cannot reverse the hash to get original data</li>
      <li><strong>Avalanche Effect:</strong> Tiny input change = completely different hash</li>
      <li><strong>Collision Resistant:</strong> Nearly impossible to find two inputs with same hash</li>
      <li><strong>Fixed Size:</strong> Output is always the same length regardless of input</li>
    </ul>
    <div class="info-box"><strong>üéØ Use Cases:</strong> Password storage, file integrity verification, blockchain, digital signatures, data deduplication</div>
  </section>

  <!-- SLIDE 3: LAB 1 - HASH EXPLORER -->
  <section id="slide3">
    <div class="slide-number">3/10</div>
    <h2>üß™ Lab 1: Hash Function Explorer</h2>
    <p>Experience the avalanche effect. Try changing just one character!</p>
    <div class="interactive">
      <label><strong>Select Hash Algorithm:</strong></label>
      <div class="algo-selector">
        <button class="algo-btn active" data-algo="SHA-256">SHA-256</button>
        <button class="algo-btn" data-algo="SHA-512">SHA-512</button>
        <button class="algo-btn" data-algo="SHA-1">SHA-1 (Legacy)</button>
      </div>
      <label for="hashInput"><strong>Enter text to hash:</strong></label>
      <textarea id="hashInput" rows="3" placeholder="Type anything...">Hello World</textarea>
      <button class="btn-action" id="hashBtn" style="width:100%;">üîê Compute Hash</button>
      <div id="hashResult" class="result">
        <strong>Hash Output:</strong>
        <pre id="hashOutput"></pre>
        <small><strong>Length:</strong> <span id="hashLength"></span> bits</small>
      </div>
    </div>
    <div class="demo-box"><strong>üí° Try This:</strong> Hash "password" then "Password" (capital P) - completely different hashes!</div>
  </section>

  <!-- SLIDE 4: LAB 2 - PASSWORD SALTING -->
  <section id="slide4">
    <div class="slide-number">4/10</div>
    <h2>üîê Lab 2: Password Hashing & Salting</h2>
    <p>Learn why we never store passwords in plain text and how salting prevents rainbow table attacks.</p>
    <div class="interactive">
      <label for="password"><strong>Enter a password:</strong></label>
      <input type="password" id="password" placeholder="Your password">
      <label for="salt"><strong>Salt (random value):</strong></label>
      <input type="text" id="salt" placeholder="Auto-generated" readonly>
      <button class="btn-action" id="genSalt" style="background:var(--ok);">Generate Random Salt</button>
      <button class="btn-action" id="hashPassword" style="width:100%;">üîí Hash Password with Salt</button>
      <div id="passwordResult" class="result">
        <strong>Stored in Database:</strong>
        <pre id="passwordHash"></pre>
        <div class="success-box">‚úÖ Even if hackers steal the database, they can't reverse the hash!</div>
      </div>
    </div>
  </section>

  <!-- SLIDE 5: LAB 3 - FILE INTEGRITY -->
  <section id="slide5">
    <div class="slide-number">5/10</div>
    <h2>üîÑ Lab 3: File Integrity Checker</h2>
    <p>Hash functions verify files haven't been tampered with. Crucial for software downloads!</p>
    <div class="interactive">
      <label><strong>Upload a file:</strong></label>
      <input type="file" id="fileInput">
      <button class="btn-action" id="hashFile">üìÑ Calculate File Hash</button>
      <div id="fileHashResult" class="result">
        <strong>File:</strong> <span id="fileName"></span><br>
        <strong>Size:</strong> <span id="fileSize"></span><br>
        <strong>SHA-256:</strong>
        <pre id="fileHash"></pre>
      </div>
    </div>
    <div class="demo-box"><strong>üîç Real-World:</strong> Software websites provide checksums to verify downloads weren't corrupted or tampered with.</div>
  </section>

  <!-- SLIDE 6: STEGO INTRO -->
  <section id="slide6">
    <div class="slide-number">6/10</div>
    <h2>üé≠ Introduction to Steganography</h2>
    <p>Unlike cryptography which makes data unreadable, steganography makes data invisible!</p>
    <div class="visual-demo">
      <div class="visual-box"><strong>Cover Media</strong><br>üñºÔ∏è Normal Image</div>
      <div class="arrow">+</div>
      <div class="visual-box"><strong>Secret Data</strong><br>üìù Hidden Message</div>
      <div class="arrow">=</div>
      <div class="visual-box"><strong>Stego Media</strong><br>üñºÔ∏è Looks Identical!</div>
    </div>
    <h3>Common Techniques:</h3>
    <div class="comparison">
      <div class="comparison-item"><h4>LSB (Least Significant Bit)</h4><p>Hide data in last bit of pixel colors. Invisible to human eye.</p></div>
      <div class="comparison-item"><h4>Metadata Injection</h4><p>Store data in EXIF tags, comments, or file headers.</p></div>
      <div class="comparison-item"><h4>Text Steganography</h4><p>Use invisible Unicode characters or whitespace patterns.</p></div>
      <div class="comparison-item"><h4>Audio/Video</h4><p>Embed in high-frequency components humans can't detect.</p></div>
    </div>
  </section>

  <!-- SLIDE 7: LAB 4 - IMAGE STEGO -->
  <section id="slide7">
    <div class="slide-number">7/10</div>
    <h2>üñºÔ∏è Lab 4: Image Steganography</h2>
    <p>Hide secret messages using LSB (Least Significant Bit) technique.</p>
    <div class="interactive">
      <h3>Encode: Hide a Message</h3>
      <div class="canvas-container"><canvas id="coverCanvas" width="400" height="200"></canvas></div>
      <label for="secretMsg"><strong>Secret Message:</strong></label>
      <input type="text" id="secretMsg" placeholder="Enter your secret..." maxlength="100">
      <button class="btn-action" id="generateCover" style="background:var(--ok);">üé® Generate Cover Image</button>
      <button class="btn-action" id="encodeMsg">üîí Hide Message in Image</button>
      <div id="encodeResult" class="success-box" style="display:none;">‚úÖ Message hidden! The image looks identical but contains your secret.</div>
      <h3>Decode: Reveal Hidden Message</h3>
      <button class="btn-action btn-decode" id="decodeMsg">üîç Extract Hidden Message</button>
      <div id="decodeResult" class="result"><strong>Decoded:</strong><pre id="decodedText"></pre></div>
    </div>
  </section>

  <!-- SLIDE 8: LAB 5 - TEXT STEGO -->
  <section id="slide8">
    <div class="slide-number">8/10</div>
    <h2>üìù Lab 5: Text Steganography</h2>
    <p>Hide messages using invisible Unicode characters.</p>
    <div class="interactive">
      <h3>Hide Message in Text</h3>
      <label for="coverText"><strong>Cover Text (visible):</strong></label>
      <textarea id="coverText" rows="2">Meeting scheduled for tomorrow at 3 PM.</textarea>
      <label for="hiddenText"><strong>Hidden Message (secret):</strong></label>
      <input type="text" id="hiddenText" placeholder="Your secret...">
      <button class="btn-action" id="encodeText" style="width:100%;">üîê Encode Secret</button>
      <div id="textEncodeResult" class="result">
        <strong>Stego Text:</strong>
        <textarea id="stegoText" rows="2" readonly></textarea>
        <small>üëÜ Looks normal but contains hidden data!</small>
      </div>
      <h3>Decode Hidden Message</h3>
      <label for="decodeTextInput"><strong>Paste stego text:</strong></label>
      <textarea id="decodeTextInput" rows="2" placeholder="Paste encoded text..."></textarea>
      <button class="btn-action btn-decode" id="decodeText" style="width:100%;">üîç Extract Secret</button>
      <div id="textDecodeResult" class="result"><strong>Hidden:</strong><pre id="extractedSecret"></pre></div>
    </div>
  </section>

  <!-- SLIDE 9: COMBINED -->
  <section id="slide9">
    <div class="slide-number">9/10</div>
    <h2>üõ°Ô∏è Combining: Crypto + Stego</h2>
    <p>For maximum security: encrypt your message, then hide it!</p>
    <div class="interactive">
      <label for="plainMessage"><strong>Your Message:</strong></label>
      <textarea id="plainMessage" rows="2" placeholder="Top secret..."></textarea>
      <label for="encKey"><strong>Encryption Key:</strong></label>
      <input type="password" id="encKey" placeholder="Choose a key...">
      <button class="btn-action" id="cryptoStego" style="width:100%;background:linear-gradient(135deg,#7c3aed,#6d28d9);">üîê Encrypt & Hide</button>
      <div id="cryptoStegoResult" class="result">
        <strong>Encrypted:</strong><pre id="encrypted"></pre>
        <strong>Hidden in Text:</strong><textarea id="finalStego" rows="2" readonly></textarea>
        <div class="success-box">‚úÖ Encrypted AND hidden. Maximum security!</div>
      </div>
    </div>
  </section>

  <!-- SLIDE 10: SUMMARY -->
  <section id="slide10">
    <div class="slide-number">10/10</div>
    <h2>üéì Summary & Applications</h2>
    <div class="success-box"><h3 style="margin:0;">üéâ Congratulations! Lab Complete!</h3></div>
    <h3>What You Learned:</h3>
    <ul>
      <li>‚úÖ Hash functions and their properties (SHA-256, SHA-512)</li>
      <li>‚úÖ Password hashing with salting for security</li>
      <li>‚úÖ File integrity verification using hashes</li>
      <li>‚úÖ Steganography techniques (LSB, text-based)</li>
      <li>‚úÖ Combining encryption and steganography</li>
    </ul>
    <div class="comparison">
      <div class="comparison-item">
        <h4>üîê Cryptography Uses</h4>
        <ul><li>Secure password storage</li><li>Blockchain</li><li>Digital signatures</li><li>SSL/TLS</li></ul>
      </div>
      <div class="comparison-item">
        <h4>üé≠ Steganography Uses</h4>
        <ul><li>Digital watermarking</li><li>Covert communication</li><li>Copyright protection</li><li>Forensics</li></ul>
      </div>
    </div>
    <div style="text-align:center;margin-top:24px;">
      <button id="restart" style="background:linear-gradient(135deg,#7c3aed,#6d28d9);color:#fff;font-size:1.1em;">üîÑ Restart Lab</button>
    </div>
  </section>
</div>

<div class="nav">
  <button class="btn-prev" id="prev">‚Üê Previous</button>
  <button class="btn-next" id="next">Next ‚Üí</button>
</div>

<footer>Part of <a href="../../../index.html">Hexworth Prime</a> | Key House Cryptography Lab</footer>

<script>
let slide = 1;
const total = 10;
let selectedAlgo = 'SHA-256';
let coverImageData = null;

function showSlide(n) {
  document.querySelectorAll('section').forEach((s, i) => s.classList.toggle('active', i === n - 1));
  document.getElementById('progressFill').style.width = (n / total * 100) + '%';
}

document.getElementById('next').onclick = () => { slide = slide < total ? slide + 1 : 1; showSlide(slide); window.scrollTo(0, 0); };
document.getElementById('prev').onclick = () => { slide = slide > 1 ? slide - 1 : total; showSlide(slide); window.scrollTo(0, 0); };
document.getElementById('restart').onclick = () => { slide = 1; showSlide(slide); window.scrollTo(0, 0); };

// Theme
const themes = [
  'linear-gradient(135deg, #0a0a0f 0%, #1a1500 50%, #3d2e00 100%)',
  'linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #312e81 100%)',
  'linear-gradient(135deg, #0a0a0f 0%, #164e63 50%, #0f766e 100%)',
  'linear-gradient(135deg, #0a0a0f 0%, #1c1917 50%, #44403c 100%)'
];
let theme = 0;
document.getElementById('random').onclick = () => { theme = (theme + 1) % themes.length; document.body.style.background = themes[theme]; };
document.getElementById('reset').onclick = () => { theme = 0; document.body.style.background = themes[0]; };

// Algorithm selector
document.querySelectorAll('.algo-btn').forEach(btn => {
  btn.onclick = function() {
    document.querySelectorAll('.algo-btn').forEach(b => b.classList.remove('active'));
    this.classList.add('active');
    selectedAlgo = this.dataset.algo;
  };
});

// Hash computation
async function computeHash(str, algo) {
  const data = new TextEncoder().encode(str);
  const hash = await crypto.subtle.digest(algo, data);
  return Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2, '0')).join('');
}

document.getElementById('hashBtn').onclick = async () => {
  const input = document.getElementById('hashInput').value;
  if (!input) return alert('Enter text to hash');
  const hash = await computeHash(input, selectedAlgo);
  document.getElementById('hashOutput').textContent = hash;
  document.getElementById('hashLength').textContent = hash.length * 4;
  document.getElementById('hashResult').style.display = 'block';
};

// Password salting
function generateSalt() {
  const arr = new Uint8Array(16);
  crypto.getRandomValues(arr);
  return Array.from(arr, b => b.toString(16).padStart(2, '0')).join('');
}

document.getElementById('genSalt').onclick = () => document.getElementById('salt').value = generateSalt();

document.getElementById('hashPassword').onclick = async () => {
  const pwd = document.getElementById('password').value;
  let salt = document.getElementById('salt').value;
  if (!pwd) return alert('Enter password');
  if (!salt) { salt = generateSalt(); document.getElementById('salt').value = salt; }
  const hash = await computeHash(salt + pwd, 'SHA-256');
  document.getElementById('passwordHash').textContent = `Salt: ${salt}\nHash: ${hash}`;
  document.getElementById('passwordResult').style.display = 'block';
};

// File hashing
document.getElementById('hashFile').onclick = async () => {
  const file = document.getElementById('fileInput').files[0];
  if (!file) return alert('Select a file');
  const buf = await file.arrayBuffer();
  const hash = await crypto.subtle.digest('SHA-256', buf);
  const hex = Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2, '0')).join('');
  document.getElementById('fileName').textContent = file.name;
  document.getElementById('fileSize').textContent = (file.size / 1024).toFixed(2) + ' KB';
  document.getElementById('fileHash').textContent = hex;
  document.getElementById('fileHashResult').style.display = 'block';
};

// Image steganography
const canvas = document.getElementById('coverCanvas');
const ctx = canvas.getContext('2d');

function drawNoise() {
  const img = ctx.createImageData(canvas.width, canvas.height);
  for (let i = 0; i < img.data.length; i += 4) {
    img.data[i] = Math.random() * 256 | 0;
    img.data[i+1] = Math.random() * 256 | 0;
    img.data[i+2] = Math.random() * 256 | 0;
    img.data[i+3] = 255;
  }
  ctx.putImageData(img, 0, 0);
  coverImageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
}

document.getElementById('generateCover').onclick = drawNoise;

document.getElementById('encodeMsg').onclick = () => {
  if (!coverImageData) drawNoise();
  const msg = document.getElementById('secretMsg').value;
  if (!msg) return alert('Enter a message');
  const bytes = new TextEncoder().encode(msg);
  const data = coverImageData.data;
  const len = bytes.length;
  for (let i = 0; i < 16; i++) data[i * 4] = (data[i * 4] & 0xFE) | ((len >> (15 - i)) & 1);
  let bit = 16;
  for (let b = 0; b < bytes.length; b++) {
    for (let i = 7; i >= 0; i--) data[(bit++) * 4] = (data[(bit - 1) * 4] & 0xFE) | ((bytes[b] >> i) & 1);
  }
  ctx.putImageData(coverImageData, 0, 0);
  document.getElementById('encodeResult').style.display = 'block';
};

document.getElementById('decodeMsg').onclick = () => {
  if (!coverImageData) return alert('No image');
  const data = coverImageData.data;
  let len = 0;
  for (let i = 0; i < 16; i++) len = (len << 1) | (data[i * 4] & 1);
  const bytes = new Uint8Array(len);
  let bit = 16;
  for (let b = 0; b < len; b++) {
    let byte = 0;
    for (let i = 0; i < 8; i++) byte = (byte << 1) | (data[(bit++) * 4] & 1);
    bytes[b] = byte;
  }
  document.getElementById('decodedText').textContent = new TextDecoder().decode(bytes);
  document.getElementById('decodeResult').style.display = 'block';
};

// Text steganography (zero-width chars)
function encodeZW(msg) {
  const bits = Array.from(new TextEncoder().encode(msg)).map(b => b.toString(2).padStart(8, '0')).join('');
  return bits.replace(/0/g, '\u200B').replace(/1/g, '\u200C');
}

function decodeZW(zws) {
  const bits = Array.from(zws).map(c => c === '\u200B' ? '0' : c === '\u200C' ? '1' : '').join('');
  const len = Math.floor(bits.length / 8);
  const out = new Uint8Array(len);
  for (let i = 0; i < len; i++) out[i] = parseInt(bits.slice(i * 8, i * 8 + 8), 2);
  return new TextDecoder().decode(out);
}

document.getElementById('encodeText').onclick = () => {
  const cover = document.getElementById('coverText').value;
  const secret = document.getElementById('hiddenText').value;
  if (!secret) return alert('Enter hidden text');
  document.getElementById('stegoText').value = cover + encodeZW(secret);
  document.getElementById('textEncodeResult').style.display = 'block';
};

document.getElementById('decodeText').onclick = () => {
  const decoded = decodeZW(document.getElementById('decodeTextInput').value);
  document.getElementById('extractedSecret').textContent = decoded || '(none)';
  document.getElementById('textDecodeResult').style.display = 'block';
};

// Combined crypto + stego (simple XOR for demo)
function xorCrypt(text, key) {
  return Array.from(text).map((c, i) => String.fromCharCode(c.charCodeAt(0) ^ key.charCodeAt(i % key.length))).join('');
}

document.getElementById('cryptoStego').onclick = () => {
  const msg = document.getElementById('plainMessage').value;
  const key = document.getElementById('encKey').value;
  if (!msg || !key) return alert('Enter message and key');
  const encrypted = btoa(xorCrypt(msg, key));
  document.getElementById('encrypted').textContent = encrypted;
  document.getElementById('finalStego').value = 'This is a normal message.' + encodeZW(encrypted);
  document.getElementById('cryptoStegoResult').style.display = 'block';
};

// Keyboard nav
document.addEventListener('keydown', e => {
  if (e.key === 'ArrowRight') document.getElementById('next').click();
  if (e.key === 'ArrowLeft') document.getElementById('prev').click();
});
</script>
<script src="../../../components/FluxCapacitor.js"></script>
</body>
</html>
