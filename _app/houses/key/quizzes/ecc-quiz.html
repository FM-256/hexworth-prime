<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Access Control -->
    <script src="../../../../components/AccessGuard.js"></script>
    <script>
        AccessGuard.require('sorted');
    </script>
    <!-- Achievement & Progress Integration -->
    <script src="../../../../components/AchievementManager.js"></script>
    <script src="../../../../components/ModuleProgress.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECC Quiz - House of the Key</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --house-color: #06b6d4;
            --house-glow: rgba(6, 182, 212, 0.4);
            --bg-dark: #0a0a12;
            --bg-card: rgba(15, 15, 25, 0.8);
            --text-primary: #e8e8f0;
            --text-secondary: #8888aa;
            --success-green: #10b981;
            --warning-red: #ef4444;
            --info-blue: #3b82f6;
        }

        body {
            min-height: 100vh;
            background: var(--bg-dark);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: var(--text-primary);
            overflow-x: hidden;
        }

        /* Header */
        .module-header {
            padding: 20px 30px;
            background: rgba(10, 10, 18, 0.95);
            border-bottom: 1px solid rgba(6, 182, 212, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .back-btn {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            border: 1px solid rgba(6, 182, 212, 0.3);
            background: transparent;
            color: var(--house-color);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            font-size: 1.2rem;
        }

        .back-btn:hover {
            background: rgba(6, 182, 212, 0.1);
        }

        .module-title {
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-primary);
        }

        .house-badge {
            font-size: 0.7rem;
            padding: 4px 12px;
            background: rgba(6, 182, 212, 0.15);
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-radius: 20px;
            color: var(--house-color);
            letter-spacing: 0.1em;
        }

        /* Container */
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 30px;
        }

        .intro {
            text-align: center;
            margin-bottom: 40px;
        }

        .intro h1 {
            font-size: 2rem;
            margin-bottom: 15px;
            background: linear-gradient(135deg, var(--house-color), #22d3ee);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .intro p {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Quiz Stats */
        .quiz-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid rgba(6, 182, 212, 0.2);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            color: var(--house-color);
            font-weight: 600;
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Question Card */
        .question {
            background: var(--bg-card);
            border: 1px solid rgba(6, 182, 212, 0.2);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            transition: all 0.3s ease;
        }

        .question.answered-correct {
            border-color: var(--success-green);
            background: rgba(16, 185, 129, 0.05);
        }

        .question.answered-incorrect {
            border-color: var(--warning-red);
            background: rgba(239, 68, 68, 0.05);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .question-number {
            font-size: 0.85rem;
            color: var(--house-color);
            font-weight: 600;
            padding: 4px 12px;
            background: rgba(6, 182, 212, 0.1);
            border-radius: 12px;
        }

        .question-difficulty {
            font-size: 0.75rem;
            padding: 4px 10px;
            border-radius: 10px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .difficulty-easy {
            background: rgba(16, 185, 129, 0.15);
            color: var(--success-green);
        }

        .difficulty-medium {
            background: rgba(245, 158, 11, 0.15);
            color: #f59e0b;
        }

        .difficulty-hard {
            background: rgba(239, 68, 68, 0.15);
            color: var(--warning-red);
        }

        .question-text {
            font-size: 1.1rem;
            color: var(--text-primary);
            margin-bottom: 25px;
            line-height: 1.6;
        }

        /* Answer Options */
        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            background: rgba(6, 182, 212, 0.05);
            border: 2px solid rgba(6, 182, 212, 0.2);
            border-radius: 8px;
            padding: 15px 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }

        .option:hover {
            border-color: var(--house-color);
            background: rgba(6, 182, 212, 0.1);
        }

        .option-letter {
            min-width: 28px;
            height: 28px;
            border-radius: 50%;
            background: rgba(6, 182, 212, 0.2);
            color: var(--house-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .option-text {
            flex: 1;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .option.selected {
            border-color: var(--house-color);
            background: rgba(6, 182, 212, 0.15);
        }

        .option.correct {
            border-color: var(--success-green);
            background: rgba(16, 185, 129, 0.15);
        }

        .option.correct .option-letter {
            background: var(--success-green);
            color: white;
        }

        .option.incorrect {
            border-color: var(--warning-red);
            background: rgba(239, 68, 68, 0.15);
        }

        .option.incorrect .option-letter {
            background: var(--warning-red);
            color: white;
        }

        .option.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        /* Explanation */
        .explanation {
            margin-top: 20px;
            padding: 20px;
            background: rgba(6, 182, 212, 0.05);
            border-left: 4px solid var(--house-color);
            border-radius: 4px;
            display: none;
        }

        .explanation.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .explanation-title {
            color: var(--house-color);
            font-weight: 600;
            margin-bottom: 10px;
        }

        .explanation-text {
            color: var(--text-secondary);
            line-height: 1.7;
        }

        /* Submit Button */
        .submit-section {
            text-align: center;
            margin-top: 40px;
        }

        .submit-btn {
            padding: 15px 40px;
            background: var(--house-color);
            color: var(--bg-dark);
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            background: #22d3ee;
            box-shadow: 0 0 20px var(--house-glow);
            transform: translateY(-2px);
        }

        .submit-btn:disabled {
            background: rgba(6, 182, 212, 0.3);
            cursor: not-allowed;
            transform: none;
        }

        /* Results */
        .results {
            background: var(--bg-card);
            border: 2px solid var(--house-color);
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            display: none;
            margin-top: 40px;
        }

        .results.show {
            display: block;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .results h2 {
            font-size: 2rem;
            color: var(--house-color);
            margin-bottom: 20px;
        }

        .score-display {
            font-size: 4rem;
            font-weight: 700;
            margin: 20px 0;
        }

        .score-display.excellent { color: var(--success-green); }
        .score-display.good { color: var(--house-color); }
        .score-display.passing { color: #f59e0b; }
        .score-display.failing { color: var(--warning-red); }

        .results-message {
            color: var(--text-secondary);
            font-size: 1.1rem;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .results-breakdown {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 30px 0;
        }

        .breakdown-item {
            background: rgba(6, 182, 212, 0.05);
            padding: 20px;
            border-radius: 8px;
        }

        .breakdown-value {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .breakdown-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .btn {
            padding: 12px 30px;
            border-radius: 8px;
            border: 1px solid rgba(6, 182, 212, 0.3);
            background: rgba(6, 182, 212, 0.1);
            color: var(--house-color);
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn:hover {
            background: rgba(6, 182, 212, 0.2);
        }

        .btn.primary {
            background: var(--house-color);
            color: var(--bg-dark);
            border-color: var(--house-color);
        }

        .btn.primary:hover {
            background: #22d3ee;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .quiz-stats {
                grid-template-columns: 1fr;
            }

            .results-breakdown {
                grid-template-columns: 1fr;
            }

            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="module-header">
        <div class="header-left">
            <button class="back-btn" onclick="window.location.href='../../index.html'" title="Back to Key House">‚Üê</button>
            <h1 class="module-title">ECC Knowledge Quiz</h1>
        </div>
        <div class="house-badge">HOUSE OF THE KEY</div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <div class="intro">
            <h1>Elliptic Curve Cryptography Quiz</h1>
            <p>Test your understanding of ECC concepts, algorithms, and real-world applications. 10 challenging questions covering everything from mathematical foundations to implementation security.</p>
        </div>

        <!-- Quiz Stats -->
        <div class="quiz-stats">
            <div class="stat-card">
                <div class="stat-value" id="questionsAnswered">0</div>
                <div class="stat-label">Answered</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="correctAnswers">0</div>
                <div class="stat-label">Correct</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="currentStreak">0</div>
                <div class="stat-label">Streak</div>
            </div>
        </div>

        <!-- Questions -->
        <div id="quizContainer">
            <!-- Question 1 -->
            <div class="question" data-question="1" data-correct="b">
                <div class="question-header">
                    <span class="question-number">Question 1 of 10</span>
                    <span class="question-difficulty difficulty-easy">Easy</span>
                </div>
                <div class="question-text">
                    What is the general Weierstrass form of an elliptic curve used in ECC?
                </div>
                <div class="options">
                    <div class="option" data-answer="a">
                        <span class="option-letter">A</span>
                        <span class="option-text">y = x¬≤ + ax + b</span>
                    </div>
                    <div class="option" data-answer="b">
                        <span class="option-letter">B</span>
                        <span class="option-text">y¬≤ = x¬≥ + ax + b</span>
                    </div>
                    <div class="option" data-answer="c">
                        <span class="option-letter">C</span>
                        <span class="option-text">y¬≥ = x¬≤ + ax + b</span>
                    </div>
                    <div class="option" data-answer="d">
                        <span class="option-letter">D</span>
                        <span class="option-text">y¬≤ = x¬≤ + ax + b</span>
                    </div>
                </div>
                <div class="explanation">
                    <div class="explanation-title">Explanation</div>
                    <div class="explanation-text">
                        The Weierstrass form y¬≤ = x¬≥ + ax + b is the standard equation for elliptic curves used in cryptography. The discriminant 4a¬≥ + 27b¬≤ must be non-zero to ensure the curve has no singularities. This cubic equation creates the characteristic curved shape that makes ECC secure.
                    </div>
                </div>
            </div>

            <!-- Question 2 -->
            <div class="question" data-question="2" data-correct="c">
                <div class="question-header">
                    <span class="question-number">Question 2 of 10</span>
                    <span class="question-difficulty difficulty-medium">Medium</span>
                </div>
                <div class="question-text">
                    A 256-bit ECC key provides security equivalent to which RSA key size?
                </div>
                <div class="options">
                    <div class="option" data-answer="a">
                        <span class="option-letter">A</span>
                        <span class="option-text">1024-bit RSA</span>
                    </div>
                    <div class="option" data-answer="b">
                        <span class="option-letter">B</span>
                        <span class="option-text">2048-bit RSA</span>
                    </div>
                    <div class="option" data-answer="c">
                        <span class="option-letter">C</span>
                        <span class="option-text">3072-bit RSA</span>
                    </div>
                    <div class="option" data-answer="d">
                        <span class="option-letter">D</span>
                        <span class="option-text">4096-bit RSA</span>
                    </div>
                </div>
                <div class="explanation">
                    <div class="explanation-title">Explanation</div>
                    <div class="explanation-text">
                        A 256-bit ECC key (like P-256) provides 128-bit security, which is equivalent to a 3072-bit RSA key. This 12:1 ratio demonstrates ECC's efficiency advantage. ECC-256 is recommended for most modern applications, while RSA-3072 is the equivalent recommendation for RSA-based systems.
                    </div>
                </div>
            </div>

            <!-- Question 3 -->
            <div class="question" data-question="3" data-correct="d">
                <div class="question-header">
                    <span class="question-number">Question 3 of 10</span>
                    <span class="question-difficulty difficulty-hard">Hard</span>
                </div>
                <div class="question-text">
                    What is the Elliptic Curve Discrete Logarithm Problem (ECDLP) that provides ECC's security?
                </div>
                <div class="options">
                    <div class="option" data-answer="a">
                        <span class="option-letter">A</span>
                        <span class="option-text">Given k and G, find Q = k √ó G</span>
                    </div>
                    <div class="option" data-answer="b">
                        <span class="option-letter">B</span>
                        <span class="option-text">Given P and Q, find P + Q</span>
                    </div>
                    <div class="option" data-answer="c">
                        <span class="option-letter">C</span>
                        <span class="option-text">Given a and b, find points on y¬≤ = x¬≥ + ax + b</span>
                    </div>
                    <div class="option" data-answer="d">
                        <span class="option-letter">D</span>
                        <span class="option-text">Given Q and G, find k such that Q = k √ó G</span>
                    </div>
                </div>
                <div class="explanation">
                    <div class="explanation-title">Explanation</div>
                    <div class="explanation-text">
                        The ECDLP is the hard problem underlying ECC security: given a point Q and base point G, finding the scalar k where Q = k √ó G is computationally infeasible for large k. Computing Q from k (scalar multiplication) is easy using double-and-add algorithms, but the reverse (discrete logarithm) has no known efficient solution, making it a perfect one-way function for cryptography.
                    </div>
                </div>
            </div>

            <!-- Question 4 -->
            <div class="question" data-question="4" data-correct="b">
                <div class="question-header">
                    <span class="question-number">Question 4 of 10</span>
                    <span class="question-difficulty difficulty-medium">Medium</span>
                </div>
                <div class="question-text">
                    In ECDH key exchange, what do both parties compute to derive the shared secret?
                </div>
                <div class="options">
                    <div class="option" data-answer="a">
                        <span class="option-letter">A</span>
                        <span class="option-text">Their own public key multiplied by the base point G</span>
                    </div>
                    <div class="option" data-answer="b">
                        <span class="option-letter">B</span>
                        <span class="option-text">Their private key multiplied by the other party's public key</span>
                    </div>
                    <div class="option" data-answer="c">
                        <span class="option-letter">C</span>
                        <span class="option-text">The sum of both public keys</span>
                    </div>
                    <div class="option" data-answer="d">
                        <span class="option-letter">D</span>
                        <span class="option-text">The hash of their concatenated public keys</span>
                    </div>
                </div>
                <div class="explanation">
                    <div class="explanation-title">Explanation</div>
                    <div class="explanation-text">
                        In ECDH, Alice computes S = a √ó B (her private key √ó Bob's public key) and Bob computes S = b √ó A (his private key √ó Alice's public key). Since B = b √ó G and A = a √ó G, both arrive at the same point: a √ó (b √ó G) = b √ó (a √ó G) = (a √ó b) √ó G. The x-coordinate of this shared point S becomes the shared secret.
                    </div>
                </div>
            </div>

            <!-- Question 5 -->
            <div class="question" data-question="5" data-correct="a">
                <div class="question-header">
                    <span class="question-number">Question 5 of 10</span>
                    <span class="question-difficulty difficulty-hard">Hard</span>
                </div>
                <div class="question-text">
                    What critical security vulnerability occurs if the same nonce (k) is reused in ECDSA signatures?
                </div>
                <div class="options">
                    <div class="option" data-answer="a">
                        <span class="option-letter">A</span>
                        <span class="option-text">The private key can be recovered from two different signatures</span>
                    </div>
                    <div class="option" data-answer="b">
                        <span class="option-letter">B</span>
                        <span class="option-text">The signatures become identical</span>
                    </div>
                    <div class="option" data-answer="c">
                        <span class="option-letter">C</span>
                        <span class="option-text">The signature verification always fails</span>
                    </div>
                    <div class="option" data-answer="d">
                        <span class="option-letter">D</span>
                        <span class="option-text">The public key becomes invalid</span>
                    </div>
                </div>
                <div class="explanation">
                    <div class="explanation-title">Explanation</div>
                    <div class="explanation-text">
                        Nonce reuse in ECDSA is catastrophic. If the same k is used for two messages m‚ÇÅ and m‚ÇÇ, an attacker can solve for the private key algebraically from the two signatures (r, s‚ÇÅ) and (r, s‚ÇÇ). This vulnerability compromised Sony's PlayStation 3 signing key and has led to cryptocurrency wallet thefts. Modern implementations use deterministic nonce generation (RFC 6979) to prevent this.
                    </div>
                </div>
            </div>

            <!-- Question 6 -->
            <div class="question" data-question="6" data-correct="c">
                <div class="question-header">
                    <span class="question-number">Question 6 of 10</span>
                    <span class="question-difficulty difficulty-easy">Easy</span>
                </div>
                <div class="question-text">
                    Which elliptic curve is used by Bitcoin for transaction signatures?
                </div>
                <div class="options">
                    <div class="option" data-answer="a">
                        <span class="option-letter">A</span>
                        <span class="option-text">P-256 (secp256r1)</span>
                    </div>
                    <div class="option" data-answer="b">
                        <span class="option-letter">B</span>
                        <span class="option-text">Curve25519</span>
                    </div>
                    <div class="option" data-answer="c">
                        <span class="option-letter">C</span>
                        <span class="option-text">secp256k1</span>
                    </div>
                    <div class="option" data-answer="d">
                        <span class="option-letter">D</span>
                        <span class="option-text">P-384 (secp384r1)</span>
                    </div>
                </div>
                <div class="explanation">
                    <div class="explanation-title">Explanation</div>
                    <div class="explanation-text">
                        Bitcoin uses secp256k1, a Koblitz curve with the simple equation y¬≤ = x¬≥ + 7. This curve was chosen for its computational efficiency and verifiable parameters (no "magic numbers"). While less common in traditional applications, secp256k1 has been battle-tested through billions of dollars in cryptocurrency transactions and is also used by Ethereum and other cryptocurrencies.
                    </div>
                </div>
            </div>

            <!-- Question 7 -->
            <div class="question" data-question="7" data-correct="d">
                <div class="question-header">
                    <span class="question-number">Question 7 of 10</span>
                    <span class="question-difficulty difficulty-medium">Medium</span>
                </div>
                <div class="question-text">
                    What is the primary advantage of Curve25519 over NIST P-256?
                </div>
                <div class="options">
                    <div class="option" data-answer="a">
                        <span class="option-letter">A</span>
                        <span class="option-text">Larger key size providing more security</span>
                    </div>
                    <div class="option" data-answer="b">
                        <span class="option-letter">B</span>
                        <span class="option-text">Government certification (FIPS compliance)</span>
                    </div>
                    <div class="option" data-answer="c">
                        <span class="option-letter">C</span>
                        <span class="option-text">Support for both ECDH and ECDSA</span>
                    </div>
                    <div class="option" data-answer="d">
                        <span class="option-letter">D</span>
                        <span class="option-text">Resistance to side-channel attacks and faster performance</span>
                    </div>
                </div>
                <div class="explanation">
                    <div class="explanation-title">Explanation</div>
                    <div class="explanation-text">
                        Curve25519 was designed by Daniel J. Bernstein with security and implementation safety as primary goals. It's naturally resistant to timing attacks, doesn't require point validation in many scenarios, and uses Montgomery curve arithmetic for better performance. While P-256 has FIPS certification, Curve25519 is preferred for new applications due to its security properties and speed. Note: Curve25519 (X25519) is for ECDH; Ed25519 is the signature variant.
                    </div>
                </div>
            </div>

            <!-- Question 8 -->
            <div class="question" data-question="8" data-correct="b">
                <div class="question-header">
                    <span class="question-number">Question 8 of 10</span>
                    <span class="question-difficulty difficulty-hard">Hard</span>
                </div>
                <div class="question-text">
                    What security vulnerability can occur if incoming elliptic curve points are not validated?
                </div>
                <div class="options">
                    <div class="option" data-answer="a">
                        <span class="option-letter">A</span>
                        <span class="option-text">Denial of service from computational overhead</span>
                    </div>
                    <div class="option" data-answer="b">
                        <span class="option-letter">B</span>
                        <span class="option-text">Invalid curve attacks that can leak private key information</span>
                    </div>
                    <div class="option" data-answer="c">
                        <span class="option-letter">C</span>
                        <span class="option-text">Automatic key compromise through point reflection</span>
                    </div>
                    <div class="option" data-answer="d">
                        <span class="option-letter">D</span>
                        <span class="option-text">Buffer overflow from malformed point data</span>
                    </div>
                </div>
                <div class="explanation">
                    <div class="explanation-title">Explanation</div>
                    <div class="explanation-text">
                        Invalid curve attacks exploit missing point validation. An attacker sends a point that's not on the specified curve but on a different, weaker curve. If the implementation doesn't verify the point is on the correct curve, it performs operations on the weaker curve, potentially leaking private key bits. This attack has been demonstrated against real implementations. Always validate: 1) Point is on the curve, 2) Point is in the correct subgroup, 3) Point is not the point at infinity.
                    </div>
                </div>
            </div>

            <!-- Question 9 -->
            <div class="question" data-question="9" data-correct="c">
                <div class="question-header">
                    <span class="question-number">Question 9 of 10</span>
                    <span class="question-difficulty difficulty-medium">Medium</span>
                </div>
                <div class="question-text">
                    In TLS 1.3, which protocol is used for perfect forward secrecy?
                </div>
                <div class="options">
                    <div class="option" data-answer="a">
                        <span class="option-letter">A</span>
                        <span class="option-text">ECDSA for key agreement</span>
                    </div>
                    <div class="option" data-answer="b">
                        <span class="option-letter">B</span>
                        <span class="option-text">Static ECDH with certificate-based keys</span>
                    </div>
                    <div class="option" data-answer="c">
                        <span class="option-letter">C</span>
                        <span class="option-text">Ephemeral ECDH (ECDHE)</span>
                    </div>
                    <div class="option" data-answer="d">
                        <span class="option-letter">D</span>
                        <span class="option-text">RSA key transport with ECC certificates</span>
                    </div>
                </div>
                <div class="explanation">
                    <div class="explanation-title">Explanation</div>
                    <div class="explanation-text">
                        TLS 1.3 mandates Ephemeral ECDH (ECDHE) for key exchange, providing perfect forward secrecy (PFS). In ECDHE, fresh key pairs are generated for each session and destroyed afterward. Even if the server's long-term private key is compromised later, past session keys cannot be recovered, protecting historical communications. TLS 1.3 removed support for static RSA key exchange and static ECDH precisely to enforce PFS.
                    </div>
                </div>
            </div>

            <!-- Question 10 -->
            <div class="question" data-question="10" data-correct="a">
                <div class="question-header">
                    <span class="question-number">Question 10 of 10</span>
                    <span class="question-difficulty difficulty-medium">Medium</span>
                </div>
                <div class="question-text">
                    What is the primary difference between ECDH and ECDSA?
                </div>
                <div class="options">
                    <div class="option" data-answer="a">
                        <span class="option-letter">A</span>
                        <span class="option-text">ECDH is for key agreement, ECDSA is for digital signatures</span>
                    </div>
                    <div class="option" data-answer="b">
                        <span class="option-letter">B</span>
                        <span class="option-text">ECDH uses different curves than ECDSA</span>
                    </div>
                    <div class="option" data-answer="c">
                        <span class="option-letter">C</span>
                        <span class="option-text">ECDH is faster but less secure than ECDSA</span>
                    </div>
                    <div class="option" data-answer="d">
                        <span class="option-letter">D</span>
                        <span class="option-text">ECDH requires pre-shared secrets, ECDSA does not</span>
                    </div>
                </div>
                <div class="explanation">
                    <div class="explanation-title">Explanation</div>
                    <div class="explanation-text">
                        ECDH and ECDSA serve different cryptographic purposes. ECDH (Elliptic Curve Diffie-Hellman) is a key agreement protocol where two parties establish a shared secret over an insecure channel. ECDSA (Elliptic Curve Digital Signature Algorithm) is for creating and verifying digital signatures to ensure authenticity, integrity, and non-repudiation. Both can use the same curves, but they solve different problems: ECDH for confidentiality (encryption keys), ECDSA for authentication and integrity.
                    </div>
                </div>
            </div>
        </div>

        <!-- Submit Button -->
        <div class="submit-section">
            <button class="submit-btn" id="submitBtn" onclick="submitQuiz()">Submit Quiz</button>
        </div>

        <!-- Results -->
        <div class="results" id="results">
            <h2>Quiz Complete!</h2>
            <div class="score-display" id="scoreDisplay">0%</div>
            <div class="results-message" id="resultsMessage"></div>

            <div class="results-breakdown">
                <div class="breakdown-item">
                    <div class="breakdown-value" id="finalCorrect" style="color: var(--success-green);">0</div>
                    <div class="breakdown-label">Correct</div>
                </div>
                <div class="breakdown-item">
                    <div class="breakdown-value" id="finalIncorrect" style="color: var(--warning-red);">0</div>
                    <div class="breakdown-label">Incorrect</div>
                </div>
                <div class="breakdown-item">
                    <div class="breakdown-value" id="finalPercentage" style="color: var(--house-color);">0%</div>
                    <div class="breakdown-label">Score</div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn" onclick="retakeQuiz()">Retake Quiz</button>
                <a href="../presentations/elliptic-curve.html" class="btn">Review Material</a>
                <a href="../../index.html" class="btn primary">Back to Key House</a>
            </div>
        </div>
    </div>

    <script>
        // Quiz state
        let answers = {};
        let correctCount = 0;
        let streak = 0;

        // Initialize quiz
        document.querySelectorAll('.question').forEach(question => {
            const options = question.querySelectorAll('.option');
            const questionNum = question.dataset.question;

            options.forEach(option => {
                option.addEventListener('click', () => {
                    if (answers[questionNum]) return; // Already answered

                    const selectedAnswer = option.dataset.answer;
                    const correctAnswer = question.dataset.correct;

                    // Mark selection
                    options.forEach(opt => opt.classList.add('disabled'));
                    option.classList.add('selected');

                    // Store answer
                    answers[questionNum] = selectedAnswer;

                    // Check correctness
                    const isCorrect = selectedAnswer === correctAnswer;

                    if (isCorrect) {
                        option.classList.add('correct');
                        question.classList.add('answered-correct');
                        correctCount++;
                        streak++;
                    } else {
                        option.classList.add('incorrect');
                        // Highlight correct answer
                        options.forEach(opt => {
                            if (opt.dataset.answer === correctAnswer) {
                                opt.classList.add('correct');
                            }
                        });
                        question.classList.add('answered-incorrect');
                        streak = 0;
                    }

                    // Show explanation
                    question.querySelector('.explanation').classList.add('show');

                    // Update stats
                    updateStats();

                    // Enable submit if all answered
                    if (Object.keys(answers).length === 10) {
                        document.getElementById('submitBtn').disabled = false;
                    }
                });
            });
        });

        function updateStats() {
            document.getElementById('questionsAnswered').textContent = Object.keys(answers).length;
            document.getElementById('correctAnswers').textContent = correctCount;
            document.getElementById('currentStreak').textContent = streak;
        }

        function submitQuiz() {
            const totalQuestions = 10;
            const incorrect = totalQuestions - correctCount;
            const percentage = Math.round((correctCount / totalQuestions) * 100);

            // Show results
            document.getElementById('results').classList.add('show');
            document.getElementById('finalCorrect').textContent = correctCount;
            document.getElementById('finalIncorrect').textContent = incorrect;
            document.getElementById('finalPercentage').textContent = percentage + '%';

            // Score display
            const scoreDisplay = document.getElementById('scoreDisplay');
            scoreDisplay.textContent = percentage + '%';

            if (percentage >= 90) {
                scoreDisplay.className = 'score-display excellent';
                document.getElementById('resultsMessage').innerHTML = `
                    <strong>Excellent work!</strong> You've mastered Elliptic Curve Cryptography.<br>
                    Your deep understanding of ECC mathematics, protocols, and security considerations is impressive.
                `;
            } else if (percentage >= 70) {
                scoreDisplay.className = 'score-display good';
                document.getElementById('resultsMessage').innerHTML = `
                    <strong>Good job!</strong> You have a solid understanding of ECC.<br>
                    Review the explanations for questions you missed to strengthen your knowledge.
                `;
            } else if (percentage >= 60) {
                scoreDisplay.className = 'score-display passing';
                document.getElementById('resultsMessage').innerHTML = `
                    <strong>Passing score.</strong> You grasp the basics of ECC.<br>
                    Consider reviewing the presentation material and retaking the quiz to improve.
                `;
            } else {
                scoreDisplay.className = 'score-display failing';
                document.getElementById('resultsMessage').innerHTML = `
                    <strong>More study needed.</strong> ECC concepts require more review.<br>
                    Go back through the presentation and hands-on lab before retaking this quiz.
                `;
            }

            // Scroll to results
            document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'center' });

            // Complete quiz in progress system
            if (percentage >= 70) {
                try {
                    ModuleProgress.completeQuiz('key', 'key-ecc-quiz', percentage);
                    if (typeof AchievementManager !== 'undefined' && percentage >= 90) {
                        AchievementManager.unlock('ecc-expert');
                    }
                } catch (error) {
                    console.warn('Progress tracking not available:', error);
                }
            }
        }

        function retakeQuiz() {
            // Reset state
            answers = {};
            correctCount = 0;
            streak = 0;

            // Reset UI
            document.querySelectorAll('.question').forEach(question => {
                question.classList.remove('answered-correct', 'answered-incorrect');
                question.querySelectorAll('.option').forEach(option => {
                    option.classList.remove('selected', 'correct', 'incorrect', 'disabled');
                });
                question.querySelector('.explanation').classList.remove('show');
            });

            document.getElementById('results').classList.remove('show');
            document.getElementById('submitBtn').disabled = true;
            updateStats();

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Disable submit initially
        document.getElementById('submitBtn').disabled = true;

        // Console message
        console.log('%cüîê ECC Quiz', 'color: #06b6d4; font-size: 16px; font-weight: bold;');
        console.log('%cTest your knowledge of elliptic curve cryptography', 'color: #8888aa;');
    </script>
</body>
</html>
