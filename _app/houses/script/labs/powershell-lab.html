<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PowerShell Automation Lab | Script House</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #0a0a0f 0%, #1a1025 50%, #0d0d15 100%);
            color: #e0e0e0;
            min-height: 100vh;
            line-height: 1.6;
        }

        .lab-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
        }

        .lab-header {
            text-align: center;
            margin-bottom: 3rem;
            padding: 2rem;
            background: linear-gradient(135deg, rgba(167, 139, 250, 0.1) 0%, rgba(139, 92, 246, 0.05) 100%);
            border-radius: 16px;
            border: 1px solid rgba(167, 139, 250, 0.3);
        }

        .lab-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .lab-title {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .lab-subtitle {
            color: #9ca3af;
            font-size: 1.1rem;
        }

        .lab-meta {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #a78bfa;
            font-size: 0.9rem;
        }

        .objectives-section {
            background: rgba(167, 139, 250, 0.08);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border-left: 4px solid #a78bfa;
        }

        .objectives-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #a78bfa;
            margin-bottom: 1rem;
        }

        .objectives-list {
            list-style: none;
        }

        .objectives-list li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
        }

        .objectives-list li::before {
            content: "üéØ";
            position: absolute;
            left: 0;
        }

        .exercise {
            background: rgba(30, 30, 40, 0.6);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(167, 139, 250, 0.2);
            transition: all 0.3s ease;
        }

        .exercise:hover {
            border-color: rgba(167, 139, 250, 0.4);
            box-shadow: 0 4px 20px rgba(167, 139, 250, 0.1);
        }

        .exercise-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .exercise-number {
            background: linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .exercise-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #fff;
        }

        .exercise-difficulty {
            margin-left: auto;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .difficulty-beginner { background: rgba(34, 197, 94, 0.2); color: #22c55e; }
        .difficulty-intermediate { background: rgba(234, 179, 8, 0.2); color: #eab308; }
        .difficulty-advanced { background: rgba(239, 68, 68, 0.2); color: #ef4444; }

        .exercise-content h4 {
            color: #a78bfa;
            margin: 1.5rem 0 0.75rem 0;
            font-size: 1rem;
        }

        .exercise-content p {
            color: #d1d5db;
            margin-bottom: 1rem;
        }

        .code-block {
            background: #012456;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            overflow-x: auto;
            border: 1px solid rgba(88, 166, 255, 0.3);
        }

        .code-block code {
            font-family: 'Cascadia Code', 'Consolas', monospace;
            color: #f0f0f0;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .code-block .comment { color: #6a9955; }
        .code-block .cmdlet { color: #dcdcaa; }
        .code-block .variable { color: #9cdcfe; }
        .code-block .string { color: #ce9178; }
        .code-block .keyword { color: #569cd6; }
        .code-block .operator { color: #d4d4d4; }
        .code-block .param { color: #9cdcfe; }

        .task-list {
            list-style: none;
            margin: 1rem 0;
        }

        .task-list li {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.5rem 0;
        }

        .task-list input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin-top: 3px;
            accent-color: #a78bfa;
            cursor: pointer;
        }

        .hint-box {
            background: rgba(234, 179, 8, 0.1);
            border: 1px solid rgba(234, 179, 8, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .hint-box summary {
            cursor: pointer;
            color: #eab308;
            font-weight: 500;
        }

        .hint-box p {
            margin-top: 0.75rem;
            color: #fef3c7;
        }

        .applet-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, rgba(167, 139, 250, 0.2) 0%, rgba(139, 92, 246, 0.1) 100%);
            color: #a78bfa;
            padding: 0.75rem 1.25rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 500;
            margin: 0.5rem 0.5rem 0.5rem 0;
            border: 1px solid rgba(167, 139, 250, 0.3);
            transition: all 0.3s ease;
        }

        .applet-link:hover {
            background: linear-gradient(135deg, rgba(167, 139, 250, 0.3) 0%, rgba(139, 92, 246, 0.2) 100%);
            transform: translateY(-2px);
        }

        .reflection-section {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, rgba(167, 139, 250, 0.05) 100%);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            border: 1px dashed rgba(167, 139, 250, 0.3);
        }

        .reflection-section h4 {
            color: #a78bfa;
            margin-bottom: 1rem;
        }

        .reflection-section textarea {
            width: 100%;
            min-height: 100px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(167, 139, 250, 0.3);
            border-radius: 8px;
            padding: 1rem;
            color: #e0e0e0;
            font-family: inherit;
            resize: vertical;
        }

        .reflection-section textarea:focus {
            outline: none;
            border-color: #a78bfa;
        }

        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: rgba(167, 139, 250, 0.2);
            z-index: 1000;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #a78bfa 0%, #8b5cf6 100%);
            transition: width 0.3s ease;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid rgba(167, 139, 250, 0.2);
        }

        .nav-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .nav-btn-back {
            background: rgba(107, 114, 128, 0.2);
            color: #9ca3af;
            border: 1px solid rgba(107, 114, 128, 0.3);
        }

        .nav-btn-back:hover {
            background: rgba(107, 114, 128, 0.3);
        }

        .nav-btn-next {
            background: linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%);
            color: white;
            border: none;
        }

        .nav-btn-next:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(167, 139, 250, 0.4);
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            font-size: 0.9rem;
        }

        .comparison-table th, .comparison-table td {
            padding: 0.75rem;
            border: 1px solid rgba(167, 139, 250, 0.2);
            text-align: left;
        }

        .comparison-table th {
            background: rgba(167, 139, 250, 0.1);
            color: #a78bfa;
        }

        .comparison-table code {
            background: rgba(0, 0, 0, 0.3);
            padding: 0.15rem 0.4rem;
            border-radius: 4px;
            font-size: 0.85rem;
        }

        .info-callout {
            background: rgba(56, 189, 248, 0.1);
            border: 1px solid rgba(56, 189, 248, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .info-callout h5 {
            color: #38bdf8;
            margin-bottom: 0.5rem;
        }

        @media (max-width: 768px) {
            .lab-container { padding: 1rem; }
            .lab-title { font-size: 1.8rem; }
            .exercise { padding: 1.5rem; }
            .meta-item { font-size: 0.8rem; }
        }
    </style>
</head>
<body>
    <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
    </div>

    <div class="lab-container">
        <header class="lab-header">
            <div class="lab-icon">üí†</div>
            <h1 class="lab-title">PowerShell Automation Lab</h1>
            <p class="lab-subtitle">Master Windows automation and system administration with PowerShell</p>
            <div class="lab-meta">
                <span class="meta-item">üìö 6 Exercises</span>
                <span class="meta-item">‚è±Ô∏è 90-120 minutes</span>
                <span class="meta-item">üéØ Beginner to Intermediate</span>
            </div>
        </header>

        <section class="objectives-section">
            <h2 class="objectives-title">Learning Objectives</h2>
            <ul class="objectives-list">
                <li>Understand PowerShell's object-oriented pipeline architecture</li>
                <li>Navigate the file system and manage files/folders</li>
                <li>Use cmdlets with proper Verb-Noun naming conventions</li>
                <li>Filter, sort, and format output data</li>
                <li>Write reusable PowerShell scripts and functions</li>
                <li>Manage Windows services and processes</li>
            </ul>
        </section>

        <!-- Exercise 1: PowerShell Fundamentals -->
        <article class="exercise" data-exercise="1">
            <div class="exercise-header">
                <div class="exercise-number">1</div>
                <h3 class="exercise-title">PowerShell Fundamentals</h3>
                <span class="exercise-difficulty difficulty-beginner">Beginner</span>
            </div>
            <div class="exercise-content">
                <p>PowerShell is an object-oriented shell‚Äîcommands return objects with properties and methods, not just text.</p>

                <h4>üìñ Concept Overview</h4>
                <div class="code-block">
                    <code><span class="comment"># Get help on any cmdlet</span>
<span class="cmdlet">Get-Help</span> <span class="cmdlet">Get-Process</span> <span class="param">-Detailed</span>
<span class="cmdlet">Get-Help</span> <span class="cmdlet">Get-Service</span> <span class="param">-Examples</span>

<span class="comment"># Discover commands</span>
<span class="cmdlet">Get-Command</span> <span class="param">-Verb</span> <span class="string">Get</span>           <span class="comment"># All "Get" cmdlets</span>
<span class="cmdlet">Get-Command</span> <span class="param">-Noun</span> <span class="string">*Process*</span>     <span class="comment"># Commands about processes</span>

<span class="comment"># Explore object properties</span>
<span class="cmdlet">Get-Process</span> | <span class="cmdlet">Get-Member</span>        <span class="comment"># List all properties/methods</span>
<span class="cmdlet">Get-Service</span> | <span class="cmdlet">Get-Member</span> <span class="param">-MemberType</span> Property

<span class="comment"># Variables</span>
<span class="variable">$name</span> <span class="operator">=</span> <span class="string">"PowerShell"</span>
<span class="variable">$version</span> <span class="operator">=</span> <span class="variable">$PSVersionTable</span>.PSVersion
<span class="cmdlet">Write-Host</span> <span class="string">"Running $name version $version"</span></code>
                </div>

                <div class="info-callout">
                    <h5>üí° Object Pipeline vs Text Pipeline</h5>
                    <p>Unlike Bash where commands output text, PowerShell outputs <strong>objects</strong>. When you pipe to another cmdlet, you're passing rich objects with properties‚Äînot parsing text!</p>
                </div>

                <h4>üîß Tasks</h4>
                <ul class="task-list">
                    <li><input type="checkbox" id="t1-1"> Open PowerShell and check your version with <code>$PSVersionTable</code></li>
                    <li><input type="checkbox" id="t1-2"> Use <code>Get-Command</code> to find all cmdlets with "Event" in the noun</li>
                    <li><input type="checkbox" id="t1-3"> Run <code>Get-Help</code> on 3 different cmdlets</li>
                    <li><input type="checkbox" id="t1-4"> Create variables for your name, favorite number, and a boolean</li>
                    <li><input type="checkbox" id="t1-5"> Use <code>Get-Member</code> to explore the properties of a DateTime object</li>
                </ul>

                <div class="code-block">
                    <code><span class="comment"># Exploring DateTime object</span>
<span class="variable">$now</span> <span class="operator">=</span> <span class="cmdlet">Get-Date</span>
<span class="variable">$now</span> | <span class="cmdlet">Get-Member</span>
<span class="variable">$now</span>.DayOfWeek
<span class="variable">$now</span>.AddDays(<span class="number">30</span>)</code>
                </div>

                <h4>üîó Related Visualizers</h4>
                <a href="../applets/pwsh-fundamentals.html" class="applet-link">üí† PowerShell Fundamentals</a>
            </div>
        </article>

        <!-- Exercise 2: Navigation & File Operations -->
        <article class="exercise" data-exercise="2">
            <div class="exercise-header">
                <div class="exercise-number">2</div>
                <h3 class="exercise-title">Navigation & File Operations</h3>
                <span class="exercise-difficulty difficulty-beginner">Beginner</span>
            </div>
            <div class="exercise-content">
                <p>PowerShell uses familiar navigation concepts but with object-aware cmdlets.</p>

                <h4>üìñ Concept Overview</h4>
                <div class="code-block">
                    <code><span class="comment"># Navigation (aliases work too!)</span>
<span class="cmdlet">Get-Location</span>                      <span class="comment"># pwd</span>
<span class="cmdlet">Set-Location</span> C:\Users              <span class="comment"># cd</span>
<span class="cmdlet">Get-ChildItem</span>                      <span class="comment"># ls / dir</span>
<span class="cmdlet">Get-ChildItem</span> <span class="param">-Recurse</span> <span class="param">-Filter</span> <span class="string">*.txt</span>

<span class="comment"># File operations</span>
<span class="cmdlet">New-Item</span> <span class="param">-ItemType</span> Directory <span class="param">-Name</span> <span class="string">"TestFolder"</span>
<span class="cmdlet">New-Item</span> <span class="param">-ItemType</span> File <span class="param">-Name</span> <span class="string">"test.txt"</span>
<span class="cmdlet">Copy-Item</span> test.txt backup.txt
<span class="cmdlet">Move-Item</span> backup.txt .\Archive\
<span class="cmdlet">Remove-Item</span> test.txt

<span class="comment"># Reading and writing files</span>
<span class="cmdlet">Get-Content</span> file.txt               <span class="comment"># Read file</span>
<span class="cmdlet">Set-Content</span> file.txt <span class="string">"New content"</span>  <span class="comment"># Overwrite</span>
<span class="cmdlet">Add-Content</span> file.txt <span class="string">"Appended"</span>    <span class="comment"># Append</span></code>
                </div>

                <table class="comparison-table">
                    <tr>
                        <th>Bash/CMD</th>
                        <th>PowerShell Cmdlet</th>
                        <th>PowerShell Alias</th>
                    </tr>
                    <tr>
                        <td><code>ls</code> / <code>dir</code></td>
                        <td><code>Get-ChildItem</code></td>
                        <td><code>ls</code>, <code>dir</code>, <code>gci</code></td>
                    </tr>
                    <tr>
                        <td><code>cd</code></td>
                        <td><code>Set-Location</code></td>
                        <td><code>cd</code>, <code>sl</code></td>
                    </tr>
                    <tr>
                        <td><code>cat</code> / <code>type</code></td>
                        <td><code>Get-Content</code></td>
                        <td><code>cat</code>, <code>gc</code></td>
                    </tr>
                    <tr>
                        <td><code>cp</code> / <code>copy</code></td>
                        <td><code>Copy-Item</code></td>
                        <td><code>cp</code>, <code>copy</code></td>
                    </tr>
                    <tr>
                        <td><code>rm</code> / <code>del</code></td>
                        <td><code>Remove-Item</code></td>
                        <td><code>rm</code>, <code>del</code></td>
                    </tr>
                </table>

                <h4>üîß Tasks</h4>
                <ul class="task-list">
                    <li><input type="checkbox" id="t2-1"> Navigate to your Documents folder and list all .txt files</li>
                    <li><input type="checkbox" id="t2-2"> Create a "PowerShellLab" folder with subfolders "Scripts" and "Logs"</li>
                    <li><input type="checkbox" id="t2-3"> Create a file, add content to it, then read it back</li>
                    <li><input type="checkbox" id="t2-4"> Find all files larger than 1MB in a directory recursively</li>
                    <li><input type="checkbox" id="t2-5"> Copy multiple files matching a pattern to a backup folder</li>
                </ul>

                <details class="hint-box">
                    <summary>üí° Finding Large Files</summary>
                    <p><code>Get-ChildItem -Recurse | Where-Object { $_.Length -gt 1MB }</code></p>
                </details>
            </div>
        </article>

        <!-- Exercise 3: Pipeline & Filtering -->
        <article class="exercise" data-exercise="3">
            <div class="exercise-header">
                <div class="exercise-number">3</div>
                <h3 class="exercise-title">The Pipeline: Filtering & Sorting</h3>
                <span class="exercise-difficulty difficulty-intermediate">Intermediate</span>
            </div>
            <div class="exercise-content">
                <p>PowerShell's pipeline passes objects between cmdlets, enabling powerful data manipulation.</p>

                <h4>üìñ Concept Overview</h4>
                <div class="code-block">
                    <code><span class="comment"># Where-Object: Filter objects</span>
<span class="cmdlet">Get-Process</span> | <span class="cmdlet">Where-Object</span> { <span class="variable">$_</span>.CPU <span class="operator">-gt</span> <span class="number">100</span> }
<span class="cmdlet">Get-Service</span> | <span class="cmdlet">Where-Object</span> Status <span class="operator">-eq</span> <span class="string">'Running'</span>

<span class="comment"># Select-Object: Choose properties</span>
<span class="cmdlet">Get-Process</span> | <span class="cmdlet">Select-Object</span> Name, CPU, WorkingSet <span class="param">-First</span> <span class="number">5</span>
<span class="cmdlet">Get-Service</span> | <span class="cmdlet">Select-Object</span> <span class="param">-Property</span> Name, Status

<span class="comment"># Sort-Object: Order results</span>
<span class="cmdlet">Get-Process</span> | <span class="cmdlet">Sort-Object</span> CPU <span class="param">-Descending</span> | <span class="cmdlet">Select-Object</span> <span class="param">-First</span> <span class="number">10</span>

<span class="comment"># Group-Object: Categorize</span>
<span class="cmdlet">Get-Service</span> | <span class="cmdlet">Group-Object</span> Status

<span class="comment"># Measure-Object: Statistics</span>
<span class="cmdlet">Get-ChildItem</span> | <span class="cmdlet">Measure-Object</span> <span class="param">-Property</span> Length <span class="param">-Sum</span> <span class="param">-Average</span>

<span class="comment"># Combining operations</span>
<span class="cmdlet">Get-Process</span> |
    <span class="cmdlet">Where-Object</span> { <span class="variable">$_</span>.WorkingSet <span class="operator">-gt</span> <span class="number">100MB</span> } |
    <span class="cmdlet">Sort-Object</span> WorkingSet <span class="param">-Descending</span> |
    <span class="cmdlet">Select-Object</span> Name, @{N=<span class="string">'Memory(MB)'</span>;E={[math]::Round(<span class="variable">$_</span>.WorkingSet/<span class="number">1MB</span>,<span class="number">2</span>)}}</code>
                </div>

                <h4>üîß Tasks</h4>
                <ul class="task-list">
                    <li><input type="checkbox" id="t3-1"> Find the top 10 processes by memory usage</li>
                    <li><input type="checkbox" id="t3-2"> List all running services, sorted alphabetically</li>
                    <li><input type="checkbox" id="t3-3"> Count how many services are in each status (Running/Stopped)</li>
                    <li><input type="checkbox" id="t3-4"> Find all .log files modified in the last 7 days</li>
                    <li><input type="checkbox" id="t3-5"> Calculate total size of all files in a directory</li>
                </ul>

                <div class="code-block">
                    <code><span class="comment"># Files modified in last 7 days</span>
<span class="variable">$cutoff</span> <span class="operator">=</span> (<span class="cmdlet">Get-Date</span>).AddDays(<span class="number">-7</span>)
<span class="cmdlet">Get-ChildItem</span> <span class="param">-Recurse</span> | <span class="cmdlet">Where-Object</span> { <span class="variable">$_</span>.LastWriteTime <span class="operator">-gt</span> <span class="variable">$cutoff</span> }</code>
                </div>

                <h4>üîó Related Visualizers</h4>
                <a href="../applets/pwsh-pipeline.html" class="applet-link">üí† PowerShell Pipeline</a>

                <div class="reflection-section">
                    <h4>üìù Reflection</h4>
                    <p>How does PowerShell's object pipeline differ from Bash's text-based piping? What are the advantages?</p>
                    <textarea placeholder="Write your thoughts here..."></textarea>
                </div>
            </div>
        </article>

        <!-- Exercise 4: Output Formatting -->
        <article class="exercise" data-exercise="4">
            <div class="exercise-header">
                <div class="exercise-number">4</div>
                <h3 class="exercise-title">Output Formatting & Export</h3>
                <span class="exercise-difficulty difficulty-intermediate">Intermediate</span>
            </div>
            <div class="exercise-content">
                <p>Control how data is displayed and export it to various formats for reporting.</p>

                <h4>üìñ Concept Overview</h4>
                <div class="code-block">
                    <code><span class="comment"># Format cmdlets (display only, don't pipe further!)</span>
<span class="cmdlet">Get-Process</span> | <span class="cmdlet">Format-Table</span> Name, CPU, WorkingSet <span class="param">-AutoSize</span>
<span class="cmdlet">Get-Service</span> | <span class="cmdlet">Format-List</span> *
<span class="cmdlet">Get-EventLog</span> <span class="param">-LogName</span> System <span class="param">-Newest</span> <span class="number">5</span> | <span class="cmdlet">Format-Wide</span> Message

<span class="comment"># Export to files</span>
<span class="cmdlet">Get-Process</span> | <span class="cmdlet">Export-Csv</span> processes.csv <span class="param">-NoTypeInformation</span>
<span class="cmdlet">Get-Service</span> | <span class="cmdlet">ConvertTo-Json</span> | <span class="cmdlet">Out-File</span> services.json
<span class="cmdlet">Get-Process</span> | <span class="cmdlet">ConvertTo-Html</span> | <span class="cmdlet">Out-File</span> report.html

<span class="comment"># Import data</span>
<span class="variable">$data</span> <span class="operator">=</span> <span class="cmdlet">Import-Csv</span> processes.csv
<span class="variable">$json</span> <span class="operator">=</span> <span class="cmdlet">Get-Content</span> services.json | <span class="cmdlet">ConvertFrom-Json</span>

<span class="comment"># Out cmdlets</span>
<span class="cmdlet">Get-Process</span> | <span class="cmdlet">Out-File</span> output.txt
<span class="cmdlet">Get-Process</span> | <span class="cmdlet">Out-GridView</span>              <span class="comment"># Interactive GUI!</span>
<span class="cmdlet">Get-Process</span> | <span class="cmdlet">Out-String</span> | <span class="cmdlet">clip</span>         <span class="comment"># Copy to clipboard</span></code>
                </div>

                <div class="info-callout">
                    <h5>‚ö†Ô∏è Format Cmdlets Are Terminal</h5>
                    <p>Format-* cmdlets are for display only. Once you format, you can't pipe the object data further. Always format as the last step in your pipeline!</p>
                </div>

                <h4>üîß Tasks</h4>
                <ul class="task-list">
                    <li><input type="checkbox" id="t4-1"> Display processes in a table with only Name, Id, and CPU columns</li>
                    <li><input type="checkbox" id="t4-2"> Export all running services to a CSV file</li>
                    <li><input type="checkbox" id="t4-3"> Create an HTML report of system information</li>
                    <li><input type="checkbox" id="t4-4"> Import a CSV file and filter its contents</li>
                    <li><input type="checkbox" id="t4-5"> Use <code>Out-GridView</code> to interactively explore processes</li>
                </ul>

                <details class="hint-box">
                    <summary>üí° System Info HTML Report</summary>
                    <p><code>Get-ComputerInfo | Select-Object CsName, OsName, OsVersion | ConvertTo-Html | Out-File report.html</code></p>
                </details>
            </div>
        </article>

        <!-- Exercise 5: Scripting Basics -->
        <article class="exercise" data-exercise="5">
            <div class="exercise-header">
                <div class="exercise-number">5</div>
                <h3 class="exercise-title">PowerShell Scripting</h3>
                <span class="exercise-difficulty difficulty-intermediate">Intermediate</span>
            </div>
            <div class="exercise-content">
                <p>Write reusable scripts with control flow, functions, and parameters.</p>

                <h4>üìñ Concept Overview</h4>
                <div class="code-block">
                    <code><span class="comment"># Conditional statements</span>
<span class="keyword">if</span> (<span class="variable">$value</span> <span class="operator">-gt</span> <span class="number">100</span>) {
    <span class="cmdlet">Write-Host</span> <span class="string">"High"</span>
} <span class="keyword">elseif</span> (<span class="variable">$value</span> <span class="operator">-gt</span> <span class="number">50</span>) {
    <span class="cmdlet">Write-Host</span> <span class="string">"Medium"</span>
} <span class="keyword">else</span> {
    <span class="cmdlet">Write-Host</span> <span class="string">"Low"</span>
}

<span class="comment"># Loops</span>
<span class="keyword">foreach</span> (<span class="variable">$item</span> <span class="keyword">in</span> <span class="variable">$collection</span>) {
    <span class="cmdlet">Write-Host</span> <span class="variable">$item</span>
}

<span class="keyword">for</span> (<span class="variable">$i</span> <span class="operator">=</span> <span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="number">10</span>; <span class="variable">$i</span>++) {
    <span class="cmdlet">Write-Host</span> <span class="variable">$i</span>
}

<span class="comment"># Functions</span>
<span class="keyword">function</span> Get-DiskSpace {
    <span class="keyword">param</span>(
        [<span class="keyword">string</span>]<span class="variable">$ComputerName</span> <span class="operator">=</span> <span class="variable">$env:COMPUTERNAME</span>
    )
    <span class="cmdlet">Get-WmiObject</span> Win32_LogicalDisk <span class="param">-ComputerName</span> <span class="variable">$ComputerName</span> |
        <span class="cmdlet">Where-Object</span> DriveType <span class="operator">-eq</span> <span class="number">3</span> |
        <span class="cmdlet">Select-Object</span> DeviceID,
            @{N=<span class="string">'Size(GB)'</span>;E={[math]::Round(<span class="variable">$_</span>.Size/<span class="number">1GB</span>,<span class="number">2</span>)}},
            @{N=<span class="string">'Free(GB)'</span>;E={[math]::Round(<span class="variable">$_</span>.FreeSpace/<span class="number">1GB</span>,<span class="number">2</span>)}}
}</code>
                </div>

                <h4>üîß Tasks</h4>
                <ul class="task-list">
                    <li><input type="checkbox" id="t5-1"> Write a script that checks if a file exists and creates it if not</li>
                    <li><input type="checkbox" id="t5-2"> Create a function that converts bytes to human-readable format</li>
                    <li><input type="checkbox" id="t5-3"> Write a loop that processes all files in a folder</li>
                    <li><input type="checkbox" id="t5-4"> Create a script with command-line parameters</li>
                    <li><input type="checkbox" id="t5-5"> Add error handling with try/catch blocks</li>
                </ul>

                <div class="code-block">
                    <code><span class="comment"># Error handling</span>
<span class="keyword">try</span> {
    <span class="variable">$content</span> <span class="operator">=</span> <span class="cmdlet">Get-Content</span> <span class="string">"nonexistent.txt"</span> <span class="param">-ErrorAction</span> Stop
} <span class="keyword">catch</span> {
    <span class="cmdlet">Write-Warning</span> <span class="string">"File not found: $_"</span>
} <span class="keyword">finally</span> {
    <span class="cmdlet">Write-Host</span> <span class="string">"Cleanup complete"</span>
}</code>
                </div>

                <h4>üîó Related Visualizers</h4>
                <a href="../applets/pwsh-scripting.html" class="applet-link">üí† PowerShell Scripting</a>
            </div>
        </article>

        <!-- Exercise 6: System Administration -->
        <article class="exercise" data-exercise="6">
            <div class="exercise-header">
                <div class="exercise-number">6</div>
                <h3 class="exercise-title">System Administration Tasks</h3>
                <span class="exercise-difficulty difficulty-advanced">Advanced</span>
            </div>
            <div class="exercise-content">
                <p>Use PowerShell for real-world sysadmin tasks: services, processes, event logs, and scheduled tasks.</p>

                <h4>üìñ Concept Overview</h4>
                <div class="code-block">
                    <code><span class="comment"># Service management</span>
<span class="cmdlet">Get-Service</span> <span class="param">-Name</span> <span class="string">"Spooler"</span>
<span class="cmdlet">Stop-Service</span> <span class="param">-Name</span> <span class="string">"Spooler"</span> <span class="param">-Force</span>
<span class="cmdlet">Start-Service</span> <span class="param">-Name</span> <span class="string">"Spooler"</span>
<span class="cmdlet">Restart-Service</span> <span class="param">-Name</span> <span class="string">"Spooler"</span>

<span class="comment"># Process management</span>
<span class="cmdlet">Get-Process</span> <span class="param">-Name</span> <span class="string">"notepad"</span>
<span class="cmdlet">Stop-Process</span> <span class="param">-Name</span> <span class="string">"notepad"</span> <span class="param">-Force</span>
<span class="cmdlet">Start-Process</span> <span class="string">"notepad.exe"</span> <span class="param">-ArgumentList</span> <span class="string">"file.txt"</span>

<span class="comment"># Event logs</span>
<span class="cmdlet">Get-EventLog</span> <span class="param">-LogName</span> System <span class="param">-Newest</span> <span class="number">10</span>
<span class="cmdlet">Get-EventLog</span> <span class="param">-LogName</span> Application <span class="param">-EntryType</span> Error <span class="param">-After</span> (<span class="cmdlet">Get-Date</span>).AddDays(<span class="number">-1</span>)

<span class="comment"># Scheduled tasks</span>
<span class="cmdlet">Get-ScheduledTask</span> | <span class="cmdlet">Where-Object</span> State <span class="operator">-eq</span> <span class="string">'Ready'</span>

<span class="comment"># System info</span>
<span class="cmdlet">Get-ComputerInfo</span> | <span class="cmdlet">Select-Object</span> CsName, OsName, OsArchitecture
<span class="cmdlet">Get-WmiObject</span> Win32_OperatingSystem | <span class="cmdlet">Select-Object</span> LastBootUpTime</code>
                </div>

                <h4>üîß Tasks</h4>
                <ul class="task-list">
                    <li><input type="checkbox" id="t6-1"> List all services that start automatically but are currently stopped</li>
                    <li><input type="checkbox" id="t6-2"> Find processes consuming more than 50% CPU</li>
                    <li><input type="checkbox" id="t6-3"> Search event logs for errors in the last 24 hours</li>
                    <li><input type="checkbox" id="t6-4"> Create a system health report (disk space, memory, uptime)</li>
                    <li><input type="checkbox" id="t6-5"> Write a script to monitor a service and restart if stopped</li>
                </ul>

                <div class="code-block">
                    <code><span class="comment"># Service monitoring script skeleton</span>
<span class="variable">$ServiceName</span> <span class="operator">=</span> <span class="string">"Spooler"</span>
<span class="variable">$Service</span> <span class="operator">=</span> <span class="cmdlet">Get-Service</span> <span class="param">-Name</span> <span class="variable">$ServiceName</span>

<span class="keyword">if</span> (<span class="variable">$Service</span>.Status <span class="operator">-ne</span> <span class="string">'Running'</span>) {
    <span class="cmdlet">Write-Warning</span> <span class="string">"$ServiceName is not running! Attempting restart..."</span>
    <span class="cmdlet">Start-Service</span> <span class="param">-Name</span> <span class="variable">$ServiceName</span>
    <span class="cmdlet">Write-Host</span> <span class="string">"Service restarted."</span> <span class="param">-ForegroundColor</span> Green
}</code>
                </div>

                <h4>üîó Related Visualizers</h4>
                <a href="../applets/pwsh-admin.html" class="applet-link">üí† PowerShell Admin</a>

                <div class="reflection-section">
                    <h4>üìù Final Reflection</h4>
                    <p>Design a PowerShell automation script for your daily workflow. What tasks would it automate? What parameters would it need?</p>
                    <textarea placeholder="Describe your automation script idea here..."></textarea>
                </div>
            </div>
        </article>

        <nav class="nav-buttons">
            <a href="../index.html" class="nav-btn nav-btn-back">‚Üê Back to Script House</a>
            <a href="powershell-quiz.html" class="nav-btn nav-btn-next">Take the Quiz ‚Üí</a>
        </nav>
    </div>

    <script>
        // Progress tracking
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        const progressFill = document.getElementById('progressFill');
        const STORAGE_KEY = 'hexworth_powershell_lab_progress';

        function loadProgress() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                const progress = JSON.parse(saved);
                checkboxes.forEach(cb => {
                    if (progress[cb.id]) {
                        cb.checked = true;
                    }
                });
            }
            updateProgress();
        }

        function saveProgress() {
            const progress = {};
            checkboxes.forEach(cb => {
                progress[cb.id] = cb.checked;
            });
            localStorage.setItem(STORAGE_KEY, JSON.stringify(progress));
            updateProgress();
        }

        function updateProgress() {
            const total = checkboxes.length;
            const completed = Array.from(checkboxes).filter(cb => cb.checked).length;
            const percentage = (completed / total) * 100;
            progressFill.style.width = percentage + '%';
        }

        checkboxes.forEach(cb => {
            cb.addEventListener('change', saveProgress);
        });

        // Save reflections
        const textareas = document.querySelectorAll('textarea');
        textareas.forEach((ta, index) => {
            const key = `hexworth_powershell_lab_reflection_${index}`;
            ta.value = localStorage.getItem(key) || '';
            ta.addEventListener('input', () => {
                localStorage.setItem(key, ta.value);
            });
        });

        loadProgress();
    </script>
</body>
</html>
