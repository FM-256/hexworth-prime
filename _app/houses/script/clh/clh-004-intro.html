<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CLH-004: Text Analysis & Pattern Hunting - Hexworth Prime</title>
    <style>
        :root {
            --house-primary: #a78bfa;
            --house-secondary: #8b5cf6;
            --house-glow: rgba(167, 139, 250, 0.3);
            --terminal-green: #4ade80;
            --terminal-bg: #0d1117;
            --success: #22c55e;
            --warning: #f59e0b;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: #0a0a0f;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #e0e0e0;
        }

        /* Header */
        .module-header {
            padding: 20px 40px;
            border-bottom: 1px solid rgba(167, 139, 250, 0.2);
            background: rgba(10, 10, 15, 0.95);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .back-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: #888;
            font-size: 0.8rem;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
        }

        .module-badge {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 20px;
            background: rgba(167, 139, 250, 0.1);
            border: 1px solid rgba(167, 139, 250, 0.3);
            border-radius: 25px;
        }

        .module-badge-text {
            font-size: 0.75rem;
            letter-spacing: 0.15em;
            color: var(--house-primary);
            text-transform: uppercase;
        }

        /* Main Content */
        .content-wrapper {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .module-title {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--house-primary), var(--terminal-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .module-subtitle {
            color: #888;
            font-size: 1.1rem;
            margin-bottom: 30px;
        }

        .section {
            background: rgba(15, 15, 20, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .section h2 {
            color: var(--house-primary);
            font-size: 1.4rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section p {
            line-height: 1.8;
            margin-bottom: 15px;
            color: #ccc;
        }

        /* Terminal Block */
        .terminal {
            background: var(--terminal-bg);
            border: 1px solid rgba(74, 222, 128, 0.3);
            border-radius: 8px;
            padding: 20px;
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px 0;
            position: relative;
        }

        .terminal::before {
            content: '$ terminal';
            position: absolute;
            top: -10px;
            left: 15px;
            background: var(--terminal-bg);
            padding: 0 10px;
            font-size: 0.7rem;
            color: var(--terminal-green);
            letter-spacing: 0.1em;
        }

        .terminal code {
            color: var(--terminal-green);
            display: block;
            line-height: 1.6;
        }

        .terminal .prompt {
            color: #60a5fa;
        }

        .terminal .command {
            color: #fff;
        }

        .terminal .output {
            color: #888;
        }

        .terminal .highlight {
            color: #fbbf24;
            font-weight: bold;
        }

        /* Key Points */
        .key-points {
            display: grid;
            gap: 15px;
            margin: 20px 0;
        }

        .key-point {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 15px;
            background: rgba(167, 139, 250, 0.05);
            border-left: 3px solid var(--house-primary);
            border-radius: 0 8px 8px 0;
        }

        .key-point-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .key-point-content h4 {
            color: var(--house-primary);
            margin-bottom: 5px;
        }

        .key-point-content p {
            margin: 0;
            font-size: 0.9rem;
        }

        /* Command Reference Table */
        .command-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .command-table th,
        .command-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .command-table th {
            background: rgba(167, 139, 250, 0.1);
            color: var(--house-primary);
            font-weight: 600;
        }

        .command-table code {
            background: rgba(74, 222, 128, 0.1);
            color: var(--terminal-green);
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
        }

        .command-table tr:hover {
            background: rgba(255, 255, 255, 0.02);
        }

        /* Interactive Lab Section */
        .lab-section {
            background: linear-gradient(135deg, rgba(74, 222, 128, 0.1), rgba(167, 139, 250, 0.1));
            border: 1px solid rgba(74, 222, 128, 0.3);
            border-radius: 12px;
            padding: 25px;
            margin: 30px 0;
        }

        .lab-section h3 {
            color: var(--terminal-green);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .lab-objective {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .lab-objective h4 {
            color: var(--warning);
            margin-bottom: 10px;
        }

        /* File Content Display */
        .file-content {
            background: #0a0a0f;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 15px;
            font-family: 'Consolas', monospace;
            font-size: 0.85rem;
            line-height: 1.8;
            max-height: 300px;
            overflow-y: auto;
            margin: 15px 0;
        }

        .file-content .line-number {
            color: #555;
            margin-right: 15px;
            user-select: none;
            display: inline-block;
            width: 20px;
            text-align: right;
        }

        .file-content .secret-line {
            background: rgba(74, 222, 128, 0.2);
            padding: 2px 5px;
            border-radius: 3px;
        }

        /* Interactive Terminal */
        .interactive-terminal {
            background: var(--terminal-bg);
            border: 1px solid rgba(74, 222, 128, 0.3);
            border-radius: 8px;
            overflow: hidden;
            margin: 20px 0;
        }

        .terminal-header {
            background: rgba(255, 255, 255, 0.05);
            padding: 8px 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .terminal-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .terminal-dot.red { background: #ef4444; }
        .terminal-dot.yellow { background: #fbbf24; }
        .terminal-dot.green { background: #22c55e; }

        .terminal-body {
            padding: 15px;
        }

        .terminal-output {
            color: #888;
            font-family: 'Consolas', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            min-height: 100px;
            margin-bottom: 10px;
            white-space: pre-wrap;
        }

        .terminal-input-line {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .terminal-prompt {
            color: var(--terminal-green);
            font-family: 'Consolas', monospace;
        }

        .terminal-input {
            flex: 1;
            background: transparent;
            border: none;
            color: #fff;
            font-family: 'Consolas', monospace;
            font-size: 0.9rem;
            outline: none;
        }

        .run-btn {
            padding: 8px 20px;
            background: var(--terminal-green);
            color: #000;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .run-btn:hover {
            background: #22c55e;
            transform: scale(1.05);
        }

        /* Regex Visualizer */
        .regex-box {
            background: rgba(251, 191, 36, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.3);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .regex-box h4 {
            color: var(--warning);
            margin-bottom: 15px;
        }

        .regex-pattern {
            display: flex;
            align-items: center;
            gap: 5px;
            flex-wrap: wrap;
            margin: 10px 0;
        }

        .regex-char {
            padding: 8px 12px;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
            font-size: 1.1rem;
        }

        .regex-literal {
            background: rgba(74, 222, 128, 0.2);
            color: var(--terminal-green);
        }

        .regex-meta {
            background: rgba(251, 191, 36, 0.2);
            color: var(--warning);
        }

        .regex-meaning {
            font-size: 0.8rem;
            color: #888;
            margin-left: 10px;
        }

        /* Progress Section */
        .progress-section {
            text-align: center;
            padding: 40px;
            background: rgba(167, 139, 250, 0.05);
            border-radius: 12px;
            margin-top: 40px;
        }

        .progress-section h3 {
            color: var(--house-primary);
            margin-bottom: 20px;
        }

        .module-nav {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 0.9rem;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .nav-btn.primary {
            background: linear-gradient(135deg, var(--house-primary), var(--house-secondary));
            color: #fff;
            border: none;
        }

        .nav-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px var(--house-glow);
        }

        .nav-btn.secondary {
            background: rgba(255, 255, 255, 0.05);
            color: #ccc;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
        }

        .title-badge {
            display: inline-block;
            background: linear-gradient(135deg, rgba(74, 222, 128, 0.2), rgba(167, 139, 250, 0.2));
            border: 1px solid rgba(74, 222, 128, 0.5);
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.85rem;
            color: var(--terminal-green);
            margin-top: 15px;
        }

        /* Success Animation */
        .success-message {
            display: none;
            background: rgba(34, 197, 94, 0.2);
            border: 1px solid var(--success);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            animation: fadeIn 0.3s ease;
        }

        .success-message.show {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <header class="module-header">
        <div class="header-left">
            <a href="../index.html" class="back-btn">
                <span>&larr;</span> Script House
            </a>
            <div class="module-badge">
                <span style="font-size: 1.5rem;">üîç</span>
                <span class="module-badge-text">Pattern Hunting</span>
            </div>
        </div>
        <div class="header-right">
            <span style="color: #666; font-size: 0.8rem;">CLH-004 of 015</span>
        </div>
    </header>

    <main class="content-wrapper">
        <h1 class="module-title">Text Analysis & Pattern Hunting</h1>
        <p class="module-subtitle">Use grep and regex to find needles in haystacks. Every hacker's secret weapon.</p>

        <section class="section">
            <h2>üîç The Power of Pattern Matching</h2>
            <p>
                In security work, you'll often face massive amounts of data: log files with millions of lines,
                network captures with thousands of packets, or source code spanning hundreds of files.
                <strong>grep</strong> is your searchlight in this darkness.
            </p>
            <p>
                The name "grep" comes from the <code>ed</code> editor command <code>g/re/p</code> &mdash;
                "global regular expression print." It searches files for patterns and prints matching lines.
            </p>
        </section>

        <section class="section">
            <h2>üìñ Grep Fundamentals</h2>

            <table class="command-table">
                <tr>
                    <th>Command</th>
                    <th>Purpose</th>
                    <th>Example</th>
                </tr>
                <tr>
                    <td><code>grep "word" file</code></td>
                    <td>Find lines containing "word"</td>
                    <td><code>grep "error" log.txt</code></td>
                </tr>
                <tr>
                    <td><code>grep -i</code></td>
                    <td>Case-insensitive search</td>
                    <td><code>grep -i "ERROR" log.txt</code></td>
                </tr>
                <tr>
                    <td><code>grep -n</code></td>
                    <td>Show line numbers</td>
                    <td><code>grep -n "secret" file.txt</code></td>
                </tr>
                <tr>
                    <td><code>grep -r</code></td>
                    <td>Recursive (search directories)</td>
                    <td><code>grep -r "password" /var/log/</code></td>
                </tr>
                <tr>
                    <td><code>grep -v</code></td>
                    <td>Inverse match (lines NOT containing)</td>
                    <td><code>grep -v "debug" log.txt</code></td>
                </tr>
                <tr>
                    <td><code>grep -c</code></td>
                    <td>Count matching lines</td>
                    <td><code>grep -c "failed" auth.log</code></td>
                </tr>
            </table>

            <div class="terminal">
                <code>
                    <span class="prompt">hacker@kali:~$</span> <span class="command">grep "password" /etc/passwd</span><br>
                    <span class="output"># Nothing - passwords aren't stored here!</span><br><br>
                    <span class="prompt">hacker@kali:~$</span> <span class="command">grep -i "failed" /var/log/auth.log | head -5</span><br>
                    <span class="output">Dec 25 03:14:22 server sshd[1234]: <span class="highlight">Failed</span> password for root from 192.168.1.100</span><br>
                    <span class="output">Dec 25 03:14:25 server sshd[1234]: <span class="highlight">Failed</span> password for root from 192.168.1.100</span><br>
                    <span class="output">Dec 25 03:14:28 server sshd[1234]: <span class="highlight">Failed</span> password for admin from 192.168.1.100</span><br>
                    <span class="output"># Brute force attack detected!</span>
                </code>
            </div>
        </section>

        <section class="section">
            <h2>üß© Regular Expressions (Regex)</h2>
            <p>
                Regular expressions are patterns that describe text. They're the secret language of pattern matchers.
                Master regex, and you can find almost anything.
            </p>

            <div class="regex-box">
                <h4>Common Regex Patterns</h4>
                <table class="command-table">
                    <tr>
                        <th>Pattern</th>
                        <th>Meaning</th>
                        <th>Example Match</th>
                    </tr>
                    <tr>
                        <td><code>.</code></td>
                        <td>Any single character</td>
                        <td>h.t matches "hat", "hit", "hot"</td>
                    </tr>
                    <tr>
                        <td><code>*</code></td>
                        <td>Zero or more of previous</td>
                        <td>lo*g matches "lg", "log", "looog"</td>
                    </tr>
                    <tr>
                        <td><code>+</code></td>
                        <td>One or more of previous</td>
                        <td>lo+g matches "log", "looog" (not "lg")</td>
                    </tr>
                    <tr>
                        <td><code>^</code></td>
                        <td>Start of line</td>
                        <td>^Error matches lines starting with "Error"</td>
                    </tr>
                    <tr>
                        <td><code>$</code></td>
                        <td>End of line</td>
                        <td>failed$ matches lines ending in "failed"</td>
                    </tr>
                    <tr>
                        <td><code>[abc]</code></td>
                        <td>Character class (a, b, or c)</td>
                        <td>[Ss]ecret matches "Secret" or "secret"</td>
                    </tr>
                    <tr>
                        <td><code>[0-9]</code></td>
                        <td>Any digit</td>
                        <td>ID:[0-9]+ matches "ID:12345"</td>
                    </tr>
                </table>
            </div>

            <div class="terminal">
                <code>
                    <span class="prompt">hacker@kali:~$</span> <span class="command">grep -E "[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}" access.log</span><br>
                    <span class="output"># Finds all IP addresses in the log file</span><br><br>
                    <span class="prompt">hacker@kali:~$</span> <span class="command">grep -E "^[A-Z][a-z]+ Code:" mystery.txt</span><br>
                    <span class="output"><span class="highlight">Secret Code:</span> 42XDFL</span><br>
                    <span class="output"># Found the hidden code!</span>
                </code>
            </div>
        </section>

        <!-- Interactive Lab -->
        <div class="lab-section">
            <h3>üéØ MISSION: Find the Secret Code</h3>

            <div class="lab-objective">
                <h4>OBJECTIVE</h4>
                <p>A mysterious file has been intercepted. Intelligence suggests it contains a hidden code
                buried within innocent-looking text. Your mission: use grep to extract the secret code.</p>
            </div>

            <p><strong>mystery.txt contents:</strong></p>
            <div class="file-content" id="fileContent">
                <span class="line-number">1</span>Lorem ipsum dolor sit amet, consectetur adipiscing elit.<br>
                <span class="line-number">2</span><br>
                <span class="line-number">3</span>Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.<br>
                <span class="line-number">4</span><br>
                <span class="line-number">5</span>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.<br>
                <span class="line-number">6</span><br>
                <span class="line-number">7</span>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.<br>
                <span class="line-number">8</span><br>
                <span class="line-number">9</span>Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.<br>
                <span class="line-number">10</span><br>
                <span class="line-number">11</span><span class="secret-line">Secret Code: 42XDFL</span><br>
                <span class="line-number">12</span><br>
                <span class="line-number">13</span>Curabitur pretium tincidunt lacus. Nulla gravida orci a odio.
            </div>

            <p><strong>Use the terminal below to find the secret code:</strong></p>

            <div class="interactive-terminal">
                <div class="terminal-header">
                    <span class="terminal-dot red"></span>
                    <span class="terminal-dot yellow"></span>
                    <span class="terminal-dot green"></span>
                    <span style="color: #888; margin-left: 10px; font-size: 0.8rem;">pattern-hunter</span>
                </div>
                <div class="terminal-body">
                    <div class="terminal-output" id="terminalOutput">Welcome to Pattern Hunter Lab
Available file: mystery.txt

Try grep commands like:
  grep "word" mystery.txt
  grep -n "pattern" mystery.txt
  grep -i "case" mystery.txt

Find the secret code hidden in the file!
</div>
                    <div class="terminal-input-line">
                        <span class="terminal-prompt">$</span>
                        <input type="text" class="terminal-input" id="terminalInput" placeholder="grep ..." autocomplete="off">
                        <button class="run-btn" onclick="runCommand()">Run</button>
                    </div>
                </div>
            </div>

            <div class="success-message" id="successMessage">
                <strong style="color: var(--success);">üéâ MISSION COMPLETE!</strong>
                <p style="margin-top: 10px;">You've successfully extracted the secret code: <code style="background: rgba(74, 222, 128, 0.3); padding: 2px 8px; border-radius: 4px;">42XDFL</code></p>
                <p style="color: #888; font-size: 0.9rem; margin-top: 5px;">This technique is essential for log analysis, security forensics, and threat hunting.</p>
            </div>
        </div>

        <section class="section">
            <h2>üéì Real-World Applications</h2>

            <div class="key-points">
                <div class="key-point">
                    <span class="key-point-icon">üìú</span>
                    <div class="key-point-content">
                        <h4>Log Analysis</h4>
                        <p>Search gigabytes of logs for failed logins, suspicious IPs, or error patterns that indicate attacks.</p>
                    </div>
                </div>
                <div class="key-point">
                    <span class="key-point-icon">üîê</span>
                    <div class="key-point-content">
                        <h4>Secret Hunting</h4>
                        <p>Find hardcoded credentials, API keys, or sensitive data accidentally committed to source code.</p>
                    </div>
                </div>
                <div class="key-point">
                    <span class="key-point-icon">ü¶†</span>
                    <div class="key-point-content">
                        <h4>Malware Analysis</h4>
                        <p>Extract strings from suspicious binaries to identify C2 servers, encryption keys, or IOCs.</p>
                    </div>
                </div>
                <div class="key-point">
                    <span class="key-point-icon">üîé</span>
                    <div class="key-point-content">
                        <h4>OSINT</h4>
                        <p>Parse scraped web content for email addresses, phone numbers, or other intelligence targets.</p>
                    </div>
                </div>
            </div>
        </section>

        <div class="progress-section">
            <h3>Ready to Test Your Skills?</h3>
            <p style="color: #888; margin-bottom: 20px;">
                Complete the quiz to prove your pattern hunting abilities.
            </p>
            <div class="module-nav">
                <a href="clh-004-quiz.html" class="nav-btn primary">Take the Quiz &rarr;</a>
                <a href="../index.html" class="nav-btn secondary">Back to Script House</a>
            </div>
            <div class="title-badge">
                üéñÔ∏è Completing CLH-004 to CLH-006 earns: CLI Analyst
            </div>
        </div>
    </main>

    <!-- TrailHunter Integration -->
    <script src="../../../components/TrailHunter.js"></script>
    <script src="../../../components/ModuleProgress.js"></script>

    <script>
        // File content for the lab
        const mysteryFile = `Lorem ipsum dolor sit amet, consectetur adipiscing elit.

Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.

Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.

Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.

Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

Secret Code: 42XDFL

Curabitur pretium tincidunt lacus. Nulla gravida orci a odio.`;

        const fileLines = mysteryFile.split('\n');

        function runCommand() {
            const input = document.getElementById('terminalInput');
            const output = document.getElementById('terminalOutput');
            const command = input.value.trim();

            if (!command) return;

            // Add command to output
            output.innerHTML += `\n$ ${command}\n`;

            // Parse grep command
            if (command.startsWith('grep')) {
                executeGrep(command, output);
            } else if (command === 'cat mystery.txt') {
                output.innerHTML += mysteryFile + '\n';
            } else if (command === 'ls') {
                output.innerHTML += 'mystery.txt\n';
            } else if (command === 'help') {
                output.innerHTML += `Available commands:
  grep "pattern" mystery.txt  - Search for pattern
  grep -n "pattern" mystery.txt  - Search with line numbers
  grep -i "pattern" mystery.txt  - Case-insensitive search
  cat mystery.txt  - Display file contents
  ls  - List files
  clear  - Clear terminal\n`;
            } else if (command === 'clear') {
                output.innerHTML = '';
            } else {
                output.innerHTML += `Command not found: ${command.split(' ')[0]}\nType 'help' for available commands.\n`;
            }

            // Scroll to bottom
            output.scrollTop = output.scrollHeight;
            input.value = '';
        }

        function executeGrep(command, output) {
            // Parse flags and pattern
            const parts = command.match(/grep\s+(-[invc]+\s+)?["']?([^"']+)["']?\s+mystery\.txt/);

            if (!parts) {
                output.innerHTML += 'Usage: grep [-inv] "pattern" mystery.txt\n';
                return;
            }

            const flags = parts[1] ? parts[1].trim() : '';
            const pattern = parts[2];

            const showLineNumbers = flags.includes('-n');
            const caseInsensitive = flags.includes('-i');
            const invertMatch = flags.includes('-v');
            const countOnly = flags.includes('-c');

            let matches = [];
            const regex = new RegExp(pattern, caseInsensitive ? 'i' : '');

            fileLines.forEach((line, idx) => {
                const lineMatches = regex.test(line);
                if (invertMatch ? !lineMatches : lineMatches) {
                    if (showLineNumbers) {
                        matches.push(`${idx + 1}:${line}`);
                    } else {
                        matches.push(line);
                    }
                }
            });

            if (countOnly) {
                output.innerHTML += `${matches.length}\n`;
            } else if (matches.length === 0) {
                output.innerHTML += '(no matches found)\n';
            } else {
                output.innerHTML += matches.join('\n') + '\n';
            }

            // Check for success
            if (pattern.toLowerCase().includes('secret') ||
                pattern.toLowerCase().includes('code') ||
                pattern.includes('42XDFL')) {
                const foundCode = matches.some(m => m.includes('42XDFL'));
                if (foundCode) {
                    document.getElementById('successMessage').classList.add('show');
                }
            }
        }

        // Enter key to run command
        document.getElementById('terminalInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                runCommand();
            }
        });
    </script>
</body>
</html>
