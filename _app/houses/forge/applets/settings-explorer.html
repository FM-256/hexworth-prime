<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Access Control -->
    <script src="../../../../components/AccessGuard.js"></script>
    <script>
        AccessGuard.require('sorted');
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows 11 Settings Explorer - House of the Forge</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #0d0d12 0%, #1a1520 50%, #0d0d12 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #c4b5d4;
            overflow-x: hidden;
        }

        /* Header */
        .app-header {
            padding: 20px 40px;
            background: rgba(10, 10, 15, 0.9);
            border-bottom: 1px solid rgba(139, 92, 246, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .back-btn {
            padding: 8px 16px;
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 6px;
            color: #a78bfa;
            text-decoration: none;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(139, 92, 246, 0.2);
        }

        .app-title {
            font-size: 1.1rem;
            color: #e8d5f5;
            font-weight: 400;
        }

        .house-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.75rem;
            color: #8b7a9e;
            letter-spacing: 0.1em;
        }

        /* Mode Toggle */
        .mode-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .mode-btn {
            padding: 8px 16px;
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 6px;
            color: #a78bfa;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mode-btn:hover {
            background: rgba(139, 92, 246, 0.2);
        }

        .mode-btn.active {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            border-color: #8b5cf6;
            color: white;
        }

        /* Progress Stats */
        .progress-stats {
            padding: 15px 40px;
            background: rgba(20, 15, 30, 0.6);
            border-bottom: 1px solid rgba(139, 92, 246, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
        }

        .stat-icon {
            font-size: 1.2rem;
        }

        .stat-value {
            color: #a78bfa;
            font-weight: 600;
        }

        .stat-label {
            color: #6b5b7e;
        }

        /* Main Layout */
        .main-container {
            display: flex;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            gap: 20px;
            min-height: calc(100vh - 180px);
        }

        /* Sidebar (Windows 11 Style) */
        .settings-sidebar {
            width: 280px;
            background: rgba(20, 15, 30, 0.8);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 12px;
            padding: 20px 0;
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .sidebar-header {
            padding: 0 20px 15px;
            border-bottom: 1px solid rgba(139, 92, 246, 0.1);
            margin-bottom: 10px;
        }

        .sidebar-title {
            font-size: 1.3rem;
            color: #e8d5f5;
            font-weight: 400;
        }

        .search-box {
            margin: 10px 20px;
            padding: 10px 15px;
            background: rgba(30, 25, 40, 0.6);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 6px;
            width: calc(100% - 40px);
            color: #c4b5d4;
            font-size: 0.85rem;
        }

        .search-box::placeholder {
            color: #6b5b7e;
        }

        .category-list {
            list-style: none;
        }

        .category-item {
            padding: 12px 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            border-left: 3px solid transparent;
            position: relative;
        }

        .category-item:hover {
            background: rgba(139, 92, 246, 0.1);
        }

        .category-item.active {
            background: rgba(139, 92, 246, 0.15);
            border-left-color: #8b5cf6;
        }

        .category-item.explored::after {
            content: '‚úì';
            position: absolute;
            right: 15px;
            color: #34d399;
            font-size: 0.9rem;
        }

        .category-icon {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }

        .category-name {
            font-size: 0.9rem;
            color: #c4b5d4;
        }

        .category-item.active .category-name {
            color: #e8d5f5;
            font-weight: 500;
        }

        /* Content Area */
        .settings-content {
            flex: 1;
            background: rgba(20, 15, 30, 0.6);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 12px;
            padding: 30px;
            min-height: 600px;
        }

        .content-header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(139, 92, 246, 0.1);
        }

        .content-title {
            font-size: 2rem;
            color: #e8d5f5;
            font-weight: 300;
            margin-bottom: 10px;
        }

        .content-subtitle {
            font-size: 0.9rem;
            color: #8b7a9e;
        }

        .settings-section {
            display: none;
        }

        .settings-section.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Settings Groups */
        .settings-group {
            margin-bottom: 30px;
        }

        .group-title {
            font-size: 1.1rem;
            color: #a78bfa;
            margin-bottom: 15px;
            font-weight: 500;
        }

        /* Setting Item */
        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px;
            background: rgba(30, 25, 40, 0.6);
            border: 1px solid rgba(139, 92, 246, 0.1);
            border-radius: 8px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .setting-item:hover {
            background: rgba(139, 92, 246, 0.08);
            border-color: rgba(139, 92, 246, 0.3);
        }

        .setting-info {
            flex: 1;
        }

        .setting-name {
            font-size: 0.95rem;
            color: #e8d5f5;
            margin-bottom: 4px;
        }

        .setting-desc {
            font-size: 0.8rem;
            color: #6b5b7e;
        }

        .setting-control {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        /* Toggle Switch */
        .toggle-switch {
            width: 44px;
            height: 24px;
            background: rgba(139, 92, 246, 0.2);
            border-radius: 12px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toggle-switch.on {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
        }

        .toggle-knob {
            width: 18px;
            height: 18px;
            background: white;
            border-radius: 50%;
            position: absolute;
            top: 3px;
            left: 3px;
            transition: all 0.3s ease;
        }

        .toggle-switch.on .toggle-knob {
            left: 23px;
        }

        /* Dropdown */
        .dropdown-control {
            padding: 8px 15px;
            background: rgba(30, 25, 40, 0.6);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 6px;
            color: #c4b5d4;
            font-size: 0.85rem;
            min-width: 150px;
            cursor: pointer;
        }

        /* Button */
        .btn-control {
            padding: 8px 20px;
            background: rgba(139, 92, 246, 0.2);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 6px;
            color: #a78bfa;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-control:hover {
            background: rgba(139, 92, 246, 0.3);
        }

        /* Tooltip */
        .tooltip {
            position: fixed;
            padding: 10px 15px;
            background: rgba(10, 10, 15, 0.95);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 8px;
            font-size: 0.85rem;
            color: #c4b5d4;
            max-width: 300px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s ease;
            z-index: 1000;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
        }

        .tooltip.visible {
            opacity: 1;
        }

        .tooltip-title {
            color: #a78bfa;
            font-weight: 600;
            margin-bottom: 5px;
        }

        /* Scavenger Hunt Panel */
        .hunt-panel {
            display: none;
            position: fixed;
            right: 20px;
            top: 180px;
            width: 320px;
            background: rgba(20, 15, 30, 0.95);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 30px rgba(0, 0, 0, 0.5);
            max-height: calc(100vh - 200px);
            overflow-y: auto;
        }

        .hunt-panel.active {
            display: block;
            animation: slideIn 0.4s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .hunt-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(139, 92, 246, 0.2);
        }

        .hunt-title {
            font-size: 1.2rem;
            color: #e8d5f5;
        }

        .hunt-close {
            background: none;
            border: none;
            color: #6b5b7e;
            font-size: 1.5rem;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .hunt-close:hover {
            color: #a78bfa;
        }

        .hunt-progress {
            margin-bottom: 20px;
        }

        .progress-text {
            font-size: 0.85rem;
            color: #8b7a9e;
            margin-bottom: 8px;
        }

        .progress-bar {
            height: 8px;
            background: rgba(139, 92, 246, 0.2);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #8b5cf6, #a78bfa);
            transition: width 0.5s ease;
        }

        .hunt-list {
            list-style: none;
        }

        .hunt-item {
            padding: 12px;
            background: rgba(30, 25, 40, 0.6);
            border: 1px solid rgba(139, 92, 246, 0.1);
            border-radius: 8px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }

        .hunt-item.found {
            background: rgba(52, 211, 153, 0.1);
            border-color: rgba(52, 211, 153, 0.3);
        }

        .hunt-item-text {
            font-size: 0.85rem;
            color: #c4b5d4;
            margin-bottom: 5px;
        }

        .hunt-item.found .hunt-item-text {
            color: #34d399;
        }

        .hunt-hint {
            font-size: 0.75rem;
            color: #6b5b7e;
        }

        .hunt-item.found .hunt-hint {
            color: #34d399;
            font-style: italic;
        }

        /* Welcome Screen */
        .welcome-screen {
            text-align: center;
            padding: 60px 20px;
        }

        .welcome-icon {
            font-size: 5rem;
            margin-bottom: 30px;
        }

        .welcome-title {
            font-size: 2.5rem;
            color: #e8d5f5;
            font-weight: 300;
            margin-bottom: 15px;
        }

        .welcome-subtitle {
            font-size: 1.1rem;
            color: #8b7a9e;
            margin-bottom: 40px;
        }

        .mode-selection {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            max-width: 700px;
            margin: 0 auto;
        }

        .mode-card {
            flex: 1;
            min-width: 250px;
            padding: 30px;
            background: rgba(30, 25, 40, 0.6);
            border: 2px solid rgba(139, 92, 246, 0.2);
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mode-card:hover {
            border-color: rgba(139, 92, 246, 0.5);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.2);
        }

        .mode-card-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .mode-card-title {
            font-size: 1.3rem;
            color: #e8d5f5;
            margin-bottom: 10px;
        }

        .mode-card-desc {
            font-size: 0.9rem;
            color: #8b7a9e;
            line-height: 1.5;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .main-container {
                flex-direction: column;
            }

            .settings-sidebar {
                width: 100%;
                position: static;
            }

            .hunt-panel {
                position: static;
                width: 100%;
                margin-top: 20px;
            }
        }

        @media (max-width: 768px) {
            .app-header {
                flex-direction: column;
                gap: 15px;
                padding: 15px 20px;
            }

            .progress-stats {
                flex-direction: column;
                gap: 10px;
                padding: 15px 20px;
            }

            .main-container {
                padding: 15px;
            }

            .settings-content {
                padding: 20px;
            }

            .mode-selection {
                flex-direction: column;
            }

            .mode-card {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <header class="app-header">
        <div class="header-left">
            <a href="../../dashboard.html" class="back-btn">‚Üê Back</a>
            <span class="app-title">Windows 11 Settings Explorer</span>
        </div>
        <div class="mode-toggle">
            <button class="mode-btn" id="exploreBtn" onclick="switchToExplore()">Explore Mode</button>
            <button class="mode-btn" id="huntBtn" onclick="switchToHunt()">Scavenger Hunt</button>
        </div>
        <div class="house-badge">
            <span>‚öíÔ∏è</span>
            <span>HOUSE OF THE FORGE</span>
        </div>
    </header>

    <div class="progress-stats">
        <div class="stat-item">
            <span class="stat-icon">üìä</span>
            <span class="stat-value" id="exploredCount">0</span>
            <span class="stat-label">/ 11 Categories Explored</span>
        </div>
        <div class="stat-item">
            <span class="stat-icon">üéØ</span>
            <span class="stat-value" id="settingsCount">0</span>
            <span class="stat-label">Settings Viewed</span>
        </div>
        <div class="stat-item">
            <span class="stat-icon">üèÜ</span>
            <span class="stat-value" id="huntProgress">0</span>
            <span class="stat-label">/ 10 Hunt Items Found</span>
        </div>
    </div>

    <div class="main-container" id="mainContainer">
        <!-- Welcome Screen -->
        <div class="settings-content" id="welcomeScreen">
            <div class="welcome-screen">
                <div class="welcome-icon">‚öôÔ∏è</div>
                <h1 class="welcome-title">Windows 11 Settings Explorer</h1>
                <p class="welcome-subtitle">Learn where to find every setting in Windows 11</p>

                <div class="mode-selection">
                    <div class="mode-card" onclick="startExploreMode()">
                        <div class="mode-card-icon">üîç</div>
                        <h3 class="mode-card-title">Explore Mode</h3>
                        <p class="mode-card-desc">Browse through all Windows 11 settings categories at your own pace. Click on any setting to learn what it does.</p>
                    </div>

                    <div class="mode-card" onclick="startHuntMode()">
                        <div class="mode-card-icon">üéØ</div>
                        <h3 class="mode-card-title">Scavenger Hunt</h3>
                        <p class="mode-card-desc">Find 10 specific settings to test your knowledge. Great for exam prep or learning common troubleshooting locations.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sidebar (hidden initially) -->
        <aside class="settings-sidebar" id="sidebar" style="display: none;">
            <div class="sidebar-header">
                <h2 class="sidebar-title">Settings</h2>
            </div>

            <input type="text" class="search-box" placeholder="Find a setting" id="searchBox" onkeyup="searchSettings()">

            <ul class="category-list" id="categoryList">
                <!-- Categories populated by JS -->
            </ul>
        </aside>

        <!-- Content Area (hidden initially) -->
        <main class="settings-content" id="contentArea" style="display: none;">
            <!-- Settings sections populated by JS -->
        </main>
    </div>

    <!-- Scavenger Hunt Panel -->
    <div class="hunt-panel" id="huntPanel">
        <div class="hunt-header">
            <h3 class="hunt-title">Scavenger Hunt</h3>
            <button class="hunt-close" onclick="closeHuntPanel()">√ó</button>
        </div>

        <div class="hunt-progress">
            <div class="progress-text">Progress: <span id="huntProgressText">0 / 10</span></div>
            <div class="progress-bar">
                <div class="progress-fill" id="huntProgressBar" style="width: 0%"></div>
            </div>
        </div>

        <ul class="hunt-list" id="huntList">
            <!-- Hunt items populated by JS -->
        </ul>
    </div>

    <!-- Tooltip -->
    <div class="tooltip" id="tooltip">
        <div class="tooltip-title" id="tooltipTitle"></div>
        <div id="tooltipContent"></div>
    </div>

    <script>
        // State
        let currentMode = 'welcome';
        let currentCategory = null;
        let exploredCategories = new Set();
        let viewedSettings = new Set();
        let foundHuntItems = new Set();

        // Settings Data
        const categories = [
            {
                id: 'system',
                name: 'System',
                icon: 'üíª',
                subtitle: 'Display, notifications, power, and storage',
                sections: [
                    {
                        title: 'Display',
                        settings: [
                            { id: 'display-brightness', name: 'Brightness', desc: 'Adjust screen brightness level', type: 'slider', tooltip: 'Controls the backlight intensity of your display. Lower brightness saves battery on laptops.' },
                            { id: 'display-resolution', name: 'Display resolution', desc: 'Change the size of text and apps', type: 'dropdown', tooltip: 'Higher resolution = sharper image but smaller UI elements. Recommended: use your monitor\'s native resolution.' },
                            { id: 'display-scale', name: 'Scale', desc: 'Make everything bigger or smaller', type: 'dropdown', tooltip: 'Scales UI elements without changing resolution. 100% = native size, 125%-150% common for high-DPI displays.' },
                            { id: 'display-nightlight', name: 'Night light', desc: 'Reduce blue light at night', type: 'toggle', tooltip: 'Reduces blue light emission which can interfere with sleep. Auto-schedules based on sunset/sunrise.' },
                            { id: 'display-hdr', name: 'Use HDR', desc: 'Play HDR games and apps', type: 'toggle', tooltip: 'High Dynamic Range provides better contrast and colors. Requires HDR-capable monitor.' }
                        ]
                    },
                    {
                        title: 'Sound',
                        settings: [
                            { id: 'sound-output', name: 'Output device', desc: 'Choose where to play sound', type: 'dropdown', tooltip: 'Select speakers, headphones, or other audio devices. Changes where all system audio is routed.' },
                            { id: 'sound-input', name: 'Input device', desc: 'Choose your microphone', type: 'dropdown', tooltip: 'Select which microphone to use for recording and calls.' },
                            { id: 'sound-volume', name: 'Volume', desc: 'Change system volume', type: 'slider', tooltip: 'Master volume control for all audio output.' },
                            { id: 'sound-mono', name: 'Mono audio', desc: 'Turn on mono audio', type: 'toggle', tooltip: 'Combines left and right channels. Useful if you have hearing loss in one ear.' }
                        ]
                    },
                    {
                        title: 'Notifications',
                        settings: [
                            { id: 'notif-dnd', name: 'Do not disturb', desc: 'Turn off notifications and sounds', type: 'toggle', tooltip: 'Silences all notifications. Useful during presentations or focused work.' },
                            { id: 'notif-banner', name: 'Show notification banners', desc: 'See notifications when they arrive', type: 'toggle', tooltip: 'Displays pop-up notifications in the corner. Can be distracting but keeps you informed.' },
                            { id: 'notif-sound', name: 'Play a sound when notifications arrive', desc: 'Notification sound', type: 'toggle', tooltip: 'Audible alert for incoming notifications.' },
                            { id: 'notif-lockscreen', name: 'Show notifications on the lock screen', desc: 'See notifications when locked', type: 'toggle', tooltip: 'Privacy consideration: others can see your notifications when PC is locked.' }
                        ]
                    },
                    {
                        title: 'Power & Battery',
                        settings: [
                            { id: 'power-mode', name: 'Power mode', desc: 'Balance performance and battery life', type: 'dropdown', tooltip: 'Best performance = max speed, drains battery. Best efficiency = saves battery, may reduce speed.' },
                            { id: 'power-sleep', name: 'Screen and sleep', desc: 'When to turn off screen and sleep', type: 'button', tooltip: 'Configure idle timeouts. Shorter times save power but may interrupt work.' },
                            { id: 'power-battery', name: 'Battery saver', desc: 'Save battery when running low', type: 'toggle', tooltip: 'Automatically limits background activity when battery is low.' }
                        ]
                    },
                    {
                        title: 'Storage',
                        settings: [
                            { id: 'storage-sense', name: 'Storage Sense', desc: 'Automatically free up space', type: 'toggle', tooltip: 'Auto-deletes temporary files and items in Recycle Bin after 30 days. Helps prevent disk full errors.' },
                            { id: 'storage-location', name: 'Change where new content is saved', desc: 'Choose default save locations', type: 'button', tooltip: 'Set default drives for apps, documents, photos, etc. Useful if you have multiple drives.' },
                            { id: 'storage-cleanup', name: 'Cleanup recommendations', desc: 'Free up space now', type: 'button', tooltip: 'Manual storage cleanup tool. Shows large files and suggests what to delete.' }
                        ]
                    }
                ]
            },
            {
                id: 'bluetooth',
                name: 'Bluetooth & devices',
                icon: 'üì±',
                subtitle: 'Printers, mice, keyboards, and more',
                sections: [
                    {
                        title: 'Bluetooth',
                        settings: [
                            { id: 'bt-toggle', name: 'Bluetooth', desc: 'Connect to wireless devices', type: 'toggle', tooltip: 'Master on/off switch for Bluetooth radio. Turn off to save battery.' },
                            { id: 'bt-devices', name: 'Devices', desc: 'Manage connected devices', type: 'button', tooltip: 'View, connect, and remove paired Bluetooth devices.' },
                            { id: 'bt-discovery', name: 'Make discoverable', desc: 'Let other devices find this PC', type: 'toggle', tooltip: 'Allows other Bluetooth devices to see your PC for pairing. Auto-disables after timeout.' }
                        ]
                    },
                    {
                        title: 'Printers & Scanners',
                        settings: [
                            { id: 'printer-add', name: 'Add a printer or scanner', desc: 'Add new device', type: 'button', tooltip: 'Searches for network and USB printers. Most modern printers are detected automatically.' },
                            { id: 'printer-default', name: 'Let Windows manage my default printer', desc: 'Auto-select printer', type: 'toggle', tooltip: 'Windows sets default to last-used printer. Disable if you want to manually choose.' }
                        ]
                    },
                    {
                        title: 'Mouse',
                        settings: [
                            { id: 'mouse-primary', name: 'Primary mouse button', desc: 'Left or right button', type: 'dropdown', tooltip: 'Swap left/right buttons for left-handed users.' },
                            { id: 'mouse-speed', name: 'Pointer speed', desc: 'How fast the cursor moves', type: 'slider', tooltip: 'Higher = cursor moves farther for same physical movement. Adjust to personal preference.' },
                            { id: 'mouse-scroll', name: 'Scroll inactive windows', desc: 'Scroll windows without activating them', type: 'toggle', tooltip: 'Allows scrolling background windows without clicking them first. Power user feature.' }
                        ]
                    },
                    {
                        title: 'Touchpad',
                        settings: [
                            { id: 'touchpad-toggle', name: 'Touchpad', desc: 'Enable touchpad', type: 'toggle', tooltip: 'Master on/off for laptop touchpad. Some laptops auto-disable when mouse is connected.' },
                            { id: 'touchpad-sensitivity', name: 'Touchpad sensitivity', desc: 'Adjust palm rejection', type: 'dropdown', tooltip: 'Higher sensitivity = more responsive but may register accidental touches.' },
                            { id: 'touchpad-gestures', name: 'Touchpad gestures', desc: 'Three and four finger gestures', type: 'button', tooltip: 'Configure multi-finger swipes for task switching, virtual desktops, etc.' }
                        ]
                    }
                ]
            },
            {
                id: 'network',
                name: 'Network & internet',
                icon: 'üåê',
                subtitle: 'Wi-Fi, Ethernet, VPN, and proxy',
                sections: [
                    {
                        title: 'Wi-Fi',
                        settings: [
                            { id: 'wifi-toggle', name: 'Wi-Fi', desc: 'Connect to wireless networks', type: 'toggle', tooltip: 'Master Wi-Fi radio on/off. Disable to save battery or troubleshoot network issues.' },
                            { id: 'wifi-networks', name: 'Show available networks', desc: 'View nearby Wi-Fi', type: 'button', tooltip: 'Lists all detected wireless networks. Click to connect.' },
                            { id: 'wifi-metered', name: 'Metered connection', desc: 'Limit data usage', type: 'toggle', tooltip: 'Prevents Windows Update and Store downloads over this network. Use on mobile hotspots or capped connections.' },
                            { id: 'wifi-random-mac', name: 'Random hardware addresses', desc: 'Use random MAC for privacy', type: 'toggle', tooltip: 'Prevents tracking across networks via MAC address. May cause issues with MAC filtering.' }
                        ]
                    },
                    {
                        title: 'Ethernet',
                        settings: [
                            { id: 'eth-properties', name: 'Network properties', desc: 'View IP address and DNS', type: 'button', tooltip: 'Shows IP address, subnet mask, gateway, DNS servers. Useful for troubleshooting.' },
                            { id: 'eth-metered', name: 'Metered connection', desc: 'Limit data usage', type: 'toggle', tooltip: 'Same as Wi-Fi metered connection but for wired networks.' }
                        ]
                    },
                    {
                        title: 'VPN',
                        settings: [
                            { id: 'vpn-add', name: 'Add VPN', desc: 'Set up a VPN connection', type: 'button', tooltip: 'Configure VPN for secure remote access to corporate networks.' },
                            { id: 'vpn-auto', name: 'Allow VPN over metered networks', desc: 'Connect VPN on limited connections', type: 'toggle', tooltip: 'Permits VPN connection even on metered networks. May incur data charges.' }
                        ]
                    },
                    {
                        title: 'Proxy',
                        settings: [
                            { id: 'proxy-auto', name: 'Automatically detect settings', desc: 'Auto-discover proxy', type: 'toggle', tooltip: 'Useful in corporate environments. Usually left on.' },
                            { id: 'proxy-manual', name: 'Use a proxy server', desc: 'Configure proxy manually', type: 'toggle', tooltip: 'Requires proxy server address and port. Used for content filtering or anonymity.' }
                        ]
                    }
                ]
            },
            {
                id: 'personalization',
                name: 'Personalization',
                icon: 'üé®',
                subtitle: 'Background, colors, themes, and fonts',
                sections: [
                    {
                        title: 'Background',
                        settings: [
                            { id: 'bg-picture', name: 'Personalize your background', desc: 'Picture, solid color, or slideshow', type: 'dropdown', tooltip: 'Picture = single wallpaper. Slideshow = rotating images. Solid color = performance mode.' },
                            { id: 'bg-fit', name: 'Choose a fit', desc: 'How image fills screen', type: 'dropdown', tooltip: 'Fill = covers screen, may crop. Fit = shows entire image, may letterbox. Stretch = distorts to fill.' }
                        ]
                    },
                    {
                        title: 'Colors',
                        settings: [
                            { id: 'color-mode', name: 'Choose your mode', desc: 'Light or dark theme', type: 'dropdown', tooltip: 'Dark mode reduces eye strain in low light. Light mode better for bright environments.' },
                            { id: 'color-accent', name: 'Accent color', desc: 'Choose or auto-pick from wallpaper', type: 'button', tooltip: 'Used for highlights, buttons, and links throughout Windows.' },
                            { id: 'color-transparency', name: 'Transparency effects', desc: 'Make Start, taskbar transparent', type: 'toggle', tooltip: 'Visual effect. Disable on slower systems for better performance.' },
                            { id: 'color-titlebar', name: 'Show accent color on title bars', desc: 'Color window title bars', type: 'toggle', tooltip: 'Applies accent color to tops of windows.' }
                        ]
                    },
                    {
                        title: 'Themes',
                        settings: [
                            { id: 'theme-current', name: 'Current theme', desc: 'Apply or browse themes', type: 'button', tooltip: 'Themes bundle wallpaper, colors, sounds, and cursor. Can save custom themes.' },
                            { id: 'theme-sync', name: 'Sync your theme', desc: 'Theme syncs across devices', type: 'toggle', tooltip: 'Requires Microsoft account. Applies same theme to all your Windows 11 devices.' }
                        ]
                    },
                    {
                        title: 'Fonts',
                        settings: [
                            { id: 'font-install', name: 'Get more fonts', desc: 'Download from Microsoft Store', type: 'button', tooltip: 'Free and paid fonts available. Some require license for commercial use.' },
                            { id: 'font-manage', name: 'Manage installed fonts', desc: 'View and remove fonts', type: 'button', tooltip: 'Shows all installed fonts. Remove unused fonts to reduce system bloat.' }
                        ]
                    },
                    {
                        title: 'Lock Screen',
                        settings: [
                            { id: 'lock-status', name: 'Lock screen status', desc: 'Show notifications on lock screen', type: 'dropdown', tooltip: 'Controls which app notifications appear when PC is locked. Privacy consideration.' },
                            { id: 'lock-picture', name: 'Lock screen picture', desc: 'Choose lock screen background', type: 'button', tooltip: 'Separate from desktop wallpaper. Windows Spotlight shows daily Bing images.' }
                        ]
                    }
                ]
            },
            {
                id: 'apps',
                name: 'Apps',
                icon: 'üì¶',
                subtitle: 'Installed apps, defaults, and features',
                sections: [
                    {
                        title: 'Apps & Features',
                        settings: [
                            { id: 'apps-list', name: 'Installed apps', desc: 'View and uninstall apps', type: 'button', tooltip: 'Full list of installed applications. Click to uninstall, modify, or repair.' },
                            { id: 'apps-install-location', name: 'Choose where to get apps', desc: 'App sources', type: 'dropdown', tooltip: 'Anywhere = no restrictions. Microsoft Store only = blocks non-Store apps for security.' }
                        ]
                    },
                    {
                        title: 'Default Apps',
                        settings: [
                            { id: 'default-browser', name: 'Web browser', desc: 'Choose default browser', type: 'dropdown', tooltip: 'Which browser opens web links. Can be changed anytime.' },
                            { id: 'default-email', name: 'Email', desc: 'Choose default email client', type: 'dropdown', tooltip: 'Which app opens mailto: links.' },
                            { id: 'default-filetype', name: 'Set defaults by file type', desc: 'Associate file types with apps', type: 'button', tooltip: 'Control which app opens .txt, .jpg, .mp3, etc. Granular control.' }
                        ]
                    },
                    {
                        title: 'Startup',
                        settings: [
                            { id: 'startup-apps', name: 'Startup apps', desc: 'Programs that run at login', type: 'button', tooltip: 'Disable unused startup apps to speed up boot time. Check impact rating.' },
                            { id: 'startup-impact', name: 'Sort by startup impact', desc: 'See which apps slow boot', type: 'button', tooltip: 'High impact apps significantly slow boot. Consider disabling.' }
                        ]
                    },
                    {
                        title: 'Optional Features',
                        settings: [
                            { id: 'features-view', name: 'View features', desc: 'Add or remove Windows features', type: 'button', tooltip: 'Turn on/off Windows components like Hyper-V, Linux subsystem, Internet Explorer.' },
                            { id: 'features-store', name: 'More Windows features', desc: 'Browse feature catalog', type: 'button', tooltip: 'Additional features available from Microsoft.' }
                        ]
                    }
                ]
            },
            {
                id: 'accounts',
                name: 'Accounts',
                icon: 'üë§',
                subtitle: 'Your info, email, sync, and family',
                sections: [
                    {
                        title: 'Your Info',
                        settings: [
                            { id: 'account-picture', name: 'Add a picture', desc: 'Personalize your account', type: 'button', tooltip: 'Shows on lock screen and Start menu. Can use camera or upload image.' },
                            { id: 'account-type', name: 'Account type', desc: 'Microsoft or local account', type: 'button', tooltip: 'Microsoft account enables sync, OneDrive, Store. Local account is offline-only.' }
                        ]
                    },
                    {
                        title: 'Email & Accounts',
                        settings: [
                            { id: 'email-add', name: 'Add account', desc: 'Add work or school account', type: 'button', tooltip: 'Connects to Office 365, Google, etc. Enables email sync in Mail app.' },
                            { id: 'email-manage', name: 'Manage accounts', desc: 'Remove or change account settings', type: 'button', tooltip: 'View all connected accounts and their sync status.' }
                        ]
                    },
                    {
                        title: 'Sign-in Options',
                        settings: [
                            { id: 'signin-password', name: 'Password', desc: 'Change your password', type: 'button', tooltip: 'Traditional alphanumeric password. Least secure but most compatible.' },
                            { id: 'signin-pin', name: 'PIN', desc: 'Use a PIN to sign in', type: 'button', tooltip: 'Numeric code, faster than password. Device-specific (not synced).' },
                            { id: 'signin-fingerprint', name: 'Fingerprint recognition', desc: 'Sign in with your fingerprint', type: 'button', tooltip: 'Requires fingerprint reader. Fast and secure.' },
                            { id: 'signin-face', name: 'Facial recognition', desc: 'Sign in with Windows Hello', type: 'button', tooltip: 'Requires IR camera. Fastest sign-in method.' },
                            { id: 'signin-dynamic-lock', name: 'Dynamic lock', desc: 'Auto-lock when you leave', type: 'toggle', tooltip: 'Locks PC when paired phone is out of range. Requires Bluetooth.' }
                        ]
                    },
                    {
                        title: 'Family & Other Users',
                        settings: [
                            { id: 'family-add', name: 'Add family member', desc: 'Add child or adult accounts', type: 'button', tooltip: 'Child accounts enable parental controls, screen time limits, content filtering.' },
                            { id: 'family-other', name: 'Add other user', desc: 'Add someone else to this PC', type: 'button', tooltip: 'Create separate account for guests or family. Each has their own files and settings.' }
                        ]
                    }
                ]
            },
            {
                id: 'time',
                name: 'Time & language',
                icon: 'üåç',
                subtitle: 'Date, time, region, and language',
                sections: [
                    {
                        title: 'Date & Time',
                        settings: [
                            { id: 'time-auto', name: 'Set time automatically', desc: 'Sync with internet time server', type: 'toggle', tooltip: 'Syncs with time.windows.com. Disable to manually set time.' },
                            { id: 'time-zone-auto', name: 'Set time zone automatically', desc: 'Detect time zone from location', type: 'toggle', tooltip: 'Uses location services. Useful for travelers.' },
                            { id: 'time-zone', name: 'Time zone', desc: 'Choose your time zone', type: 'dropdown', tooltip: 'Manual time zone selection. Use if auto-detect is inaccurate.' },
                            { id: 'time-format', name: 'Change date and time formats', desc: 'Customize formats', type: 'button', tooltip: 'Switch between 12/24 hour, MM/DD or DD/MM, etc.' }
                        ]
                    },
                    {
                        title: 'Language & Region',
                        settings: [
                            { id: 'lang-display', name: 'Windows display language', desc: 'Choose UI language', type: 'dropdown', tooltip: 'Changes language of menus, dialogs, and help. May require language pack download.' },
                            { id: 'lang-add', name: 'Add a language', desc: 'Install additional languages', type: 'button', tooltip: 'Download language packs for multilingual use.' },
                            { id: 'lang-region', name: 'Country or region', desc: 'Set your location', type: 'dropdown', tooltip: 'Affects Store content, news, regional formats.' }
                        ]
                    },
                    {
                        title: 'Typing',
                        settings: [
                            { id: 'typing-autocorrect', name: 'Autocorrect misspelled words', desc: 'Fix typos automatically', type: 'toggle', tooltip: 'Auto-corrects common typos as you type. Can be annoying with technical terms.' },
                            { id: 'typing-suggestions', name: 'Show text suggestions', desc: 'Predictive text', type: 'toggle', tooltip: 'Shows word suggestions above touch keyboard. Speeds up typing.' },
                            { id: 'typing-multilingual', name: 'Multilingual text suggestions', desc: 'Suggest words in multiple languages', type: 'toggle', tooltip: 'Useful if you type in multiple languages without switching keyboards.' }
                        ]
                    }
                ]
            },
            {
                id: 'gaming',
                name: 'Gaming',
                icon: 'üéÆ',
                subtitle: 'Game bar, captures, and performance',
                sections: [
                    {
                        title: 'Xbox Game Bar',
                        settings: [
                            { id: 'game-bar-enable', name: 'Enable Xbox Game Bar', desc: 'Open Game Bar with Win+G', type: 'toggle', tooltip: 'Overlay for recording, screenshots, performance monitoring. Win+G to open.' },
                            { id: 'game-bar-record', name: 'Record in the background', desc: 'Auto-record gameplay', type: 'toggle', tooltip: 'Continuously records. Win+Alt+G saves last 30 seconds. Uses disk space and resources.' },
                            { id: 'game-bar-audio', name: 'Audio to record', desc: 'Choose what to capture', type: 'dropdown', tooltip: 'Game only, all audio, or custom mix. Useful for streaming/recording.' }
                        ]
                    },
                    {
                        title: 'Captures',
                        settings: [
                            { id: 'capture-location', name: 'Capture location', desc: 'Where to save captures', type: 'button', tooltip: 'Default: Videos\\Captures. Change to save to different drive.' },
                            { id: 'capture-quality', name: 'Video quality', desc: 'Balance quality and file size', type: 'dropdown', tooltip: 'Higher quality = larger files. Standard (720p/30fps) good for most uses.' },
                            { id: 'capture-mouse', name: 'Capture mouse cursor', desc: 'Include cursor in recordings', type: 'toggle', tooltip: 'Useful for tutorials. Disable for cleaner gameplay videos.' }
                        ]
                    },
                    {
                        title: 'Game Mode',
                        settings: [
                            { id: 'gamemode-enable', name: 'Game Mode', desc: 'Optimize PC for gaming', type: 'toggle', tooltip: 'Prioritizes game performance. Disables Windows Update and notifications during gameplay.' },
                            { id: 'gamemode-auto', name: 'Auto-enable for games', desc: 'Detect games automatically', type: 'toggle', tooltip: 'Windows auto-detects full-screen games and enables Game Mode.' }
                        ]
                    }
                ]
            },
            {
                id: 'accessibility',
                name: 'Accessibility',
                icon: '‚ôø',
                subtitle: 'Vision, hearing, and interaction',
                sections: [
                    {
                        title: 'Vision',
                        settings: [
                            { id: 'access-narrator', name: 'Narrator', desc: 'Screen reader', type: 'toggle', tooltip: 'Reads on-screen text aloud. Essential for blind/low-vision users. Win+Ctrl+Enter to toggle.' },
                            { id: 'access-magnifier', name: 'Magnifier', desc: 'Zoom in on screen', type: 'toggle', tooltip: 'Enlarges portion of screen. Win++ to zoom in, Win+- to zoom out.' },
                            { id: 'access-high-contrast', name: 'High contrast themes', desc: 'Increase readability', type: 'button', tooltip: 'High contrast color schemes for low vision users. Overrides all theme colors.' },
                            { id: 'access-text-size', name: 'Text size', desc: 'Make text bigger', type: 'slider', tooltip: 'Increases text size system-wide. Alternative to display scaling.' },
                            { id: 'access-color-filters', name: 'Color filters', desc: 'Adjust for color blindness', type: 'button', tooltip: 'Filters for deuteranopia, protanopia, tritanopia. Helps colorblind users distinguish colors.' }
                        ]
                    },
                    {
                        title: 'Hearing',
                        settings: [
                            { id: 'access-captions', name: 'Captions', desc: 'Customize caption appearance', type: 'button', tooltip: 'System-wide caption styling. Affects videos, presentations, etc.' },
                            { id: 'access-mono-audio', name: 'Mono audio', desc: 'Combine left and right channels', type: 'toggle', tooltip: 'For users with hearing in only one ear.' },
                            { id: 'access-visual-alerts', name: 'Flash screen for audio alerts', desc: 'Visual notification', type: 'toggle', tooltip: 'Screen flashes instead of beep. Useful for deaf/hard-of-hearing users.' }
                        ]
                    },
                    {
                        title: 'Interaction',
                        settings: [
                            { id: 'access-voice', name: 'Voice access', desc: 'Control PC with your voice', type: 'toggle', tooltip: 'Hands-free PC control. Say commands like "Open Edge" or "Click Start".' },
                            { id: 'access-sticky-keys', name: 'Sticky Keys', desc: 'Press shortcuts one key at a time', type: 'toggle', tooltip: 'Allows Ctrl+C as Ctrl, then C. Useful with limited dexterity.' },
                            { id: 'access-mouse-keys', name: 'Mouse Keys', desc: 'Use numeric keypad as mouse', type: 'toggle', tooltip: 'Control mouse cursor with numpad. For users who can\'t use physical mouse.' },
                            { id: 'access-on-screen-keyboard', name: 'On-screen keyboard', desc: 'Virtual keyboard', type: 'toggle', tooltip: 'Click letters with mouse/touchscreen. For touchscreen devices or motor impairments.' }
                        ]
                    }
                ]
            },
            {
                id: 'privacy',
                name: 'Privacy & security',
                icon: 'üîí',
                subtitle: 'Permissions, Windows Security, and backup',
                sections: [
                    {
                        title: 'Windows Security',
                        settings: [
                            { id: 'security-open', name: 'Open Windows Security', desc: 'Virus protection and firewall', type: 'button', tooltip: 'Central hub for security status. Shows antivirus, firewall, updates, device health.' },
                            { id: 'security-realtime', name: 'Real-time protection', desc: 'Scan files as accessed', type: 'toggle', tooltip: 'Core antivirus feature. Only disable temporarily for troubleshooting.' },
                            { id: 'security-cloud', name: 'Cloud-delivered protection', desc: 'Faster threat detection', type: 'toggle', tooltip: 'Uploads suspicious files to Microsoft for analysis. Better detection but sends data.' }
                        ]
                    },
                    {
                        title: 'App Permissions',
                        settings: [
                            { id: 'privacy-location', name: 'Location', desc: 'Let apps access your location', type: 'toggle', tooltip: 'Used by maps, weather, etc. Disable for privacy.' },
                            { id: 'privacy-camera', name: 'Camera', desc: 'Let apps use your camera', type: 'toggle', tooltip: 'Required for video calls, photos. Check which apps have access.' },
                            { id: 'privacy-microphone', name: 'Microphone', desc: 'Let apps use your microphone', type: 'toggle', tooltip: 'Required for calls, recordings, voice commands. Review app access.' },
                            { id: 'privacy-notifications', name: 'Notifications', desc: 'Let apps access notifications', type: 'toggle', tooltip: 'Allows apps to read and send notifications.' },
                            { id: 'privacy-contacts', name: 'Contacts', desc: 'Let apps access your contacts', type: 'toggle', tooltip: 'For email clients, messaging apps.' },
                            { id: 'privacy-calendar', name: 'Calendar', desc: 'Let apps access your calendar', type: 'toggle', tooltip: 'For calendar apps and meeting schedulers.' }
                        ]
                    },
                    {
                        title: 'Activity History',
                        settings: [
                            { id: 'privacy-timeline', name: 'Store my activity history', desc: 'Keep history on this device', type: 'toggle', tooltip: 'Powers Timeline feature. Disable for privacy but lose cross-device activity.' },
                            { id: 'privacy-timeline-sync', name: 'Send activity history to Microsoft', desc: 'Sync across devices', type: 'toggle', tooltip: 'Requires Microsoft account. Allows Timeline access from other devices.' }
                        ]
                    },
                    {
                        title: 'Diagnostics & Feedback',
                        settings: [
                            { id: 'privacy-diagnostic', name: 'Diagnostic data', desc: 'How much data to send', type: 'dropdown', tooltip: 'Required = minimal. Optional = more data for improvements. Cannot be fully disabled.' },
                            { id: 'privacy-tailored', name: 'Tailored experiences', desc: 'Use diagnostics for personalization', type: 'toggle', tooltip: 'Personalized tips and ads based on usage. Privacy vs. convenience trade-off.' }
                        ]
                    }
                ]
            },
            {
                id: 'update',
                name: 'Windows Update',
                icon: 'üîÑ',
                subtitle: 'Updates, delivery optimization, and restart',
                sections: [
                    {
                        title: 'Windows Update',
                        settings: [
                            { id: 'update-check', name: 'Check for updates', desc: 'Scan for new updates', type: 'button', tooltip: 'Manually trigger update check. Windows normally checks daily automatically.' },
                            { id: 'update-pause', name: 'Pause updates', desc: 'Temporarily stop updates', type: 'button', tooltip: 'Pauses updates for up to 5 weeks. Useful before important events/deadlines.' },
                            { id: 'update-history', name: 'Update history', desc: 'View installed updates', type: 'button', tooltip: 'Shows all installed updates. Can uninstall recent problematic updates.' }
                        ]
                    },
                    {
                        title: 'Advanced Options',
                        settings: [
                            { id: 'update-active-hours', name: 'Active hours', desc: 'When you use your PC', type: 'button', tooltip: 'Windows won\'t auto-restart during these hours. Prevents interruptions during work.' },
                            { id: 'update-restart-notification', name: 'Restart notification', desc: 'Remind before restart', type: 'toggle', tooltip: 'Shows reminder before automatic restart. Gives chance to save work.' },
                            { id: 'update-metered', name: 'Download updates over metered connections', desc: 'Use mobile data for updates', type: 'toggle', tooltip: 'Disable to prevent large downloads on capped connections.' }
                        ]
                    },
                    {
                        title: 'Delivery Optimization',
                        settings: [
                            { id: 'delivery-enable', name: 'Allow downloads from other PCs', desc: 'P2P update delivery', type: 'toggle', tooltip: 'Downloads updates from other PCs on your network/internet. Faster but uses bandwidth.' },
                            { id: 'delivery-scope', name: 'PCs on my local network', desc: 'Limit to LAN or allow internet', type: 'dropdown', tooltip: 'LAN only = safer. Internet = faster but uploads to strangers.' },
                            { id: 'delivery-limit', name: 'Limit bandwidth', desc: 'Control upload/download speed', type: 'button', tooltip: 'Prevents updates from saturating your connection. Set percentage caps.' }
                        ]
                    }
                ]
            }
        ];

        // Scavenger hunt items
        const huntItems = [
            { id: 'display-nightlight', text: 'Find Night light setting (reduces blue light)', category: 'system', found: false },
            { id: 'notif-dnd', text: 'Find Do not disturb setting', category: 'system', found: false },
            { id: 'wifi-metered', text: 'Find Wi-Fi metered connection setting', category: 'network', found: false },
            { id: 'color-mode', text: 'Find where to switch between Light and Dark mode', category: 'personalization', found: false },
            { id: 'default-browser', text: 'Find where to change default web browser', category: 'apps', found: false },
            { id: 'signin-pin', text: 'Find where to set up a PIN for sign-in', category: 'accounts', found: false },
            { id: 'time-zone', text: 'Find where to manually set time zone', category: 'time', found: false },
            { id: 'gamemode-enable', text: 'Find Game Mode toggle', category: 'gaming', found: false },
            { id: 'access-magnifier', text: 'Find Magnifier accessibility tool', category: 'accessibility', found: false },
            { id: 'update-pause', text: 'Find where to pause Windows Updates', category: 'update', found: false }
        ];

        // Initialize
        function init() {
            loadProgress();
            updateStats();
        }

        // Start modes
        function startExploreMode() {
            currentMode = 'explore';
            document.getElementById('welcomeScreen').style.display = 'none';
            document.getElementById('sidebar').style.display = 'block';
            document.getElementById('contentArea').style.display = 'block';
            document.getElementById('exploreBtn').classList.add('active');
            renderCategories();
            selectCategory('system');
        }

        function startHuntMode() {
            currentMode = 'hunt';
            startExploreMode(); // Also enable exploration
            document.getElementById('huntBtn').classList.add('active');
            document.getElementById('huntPanel').classList.add('active');
            renderHuntItems();
        }

        function switchToExplore() {
            if (currentMode === 'welcome') {
                startExploreMode();
            } else {
                document.getElementById('huntBtn').classList.remove('active');
                document.getElementById('huntPanel').classList.remove('active');
                document.getElementById('exploreBtn').classList.add('active');
                currentMode = 'explore';
            }
        }

        function switchToHunt() {
            if (currentMode === 'welcome') {
                startHuntMode();
            } else {
                document.getElementById('exploreBtn').classList.remove('active');
                document.getElementById('huntPanel').classList.add('active');
                document.getElementById('huntBtn').classList.add('active');
                currentMode = 'hunt';
                renderHuntItems();
            }
        }

        function closeHuntPanel() {
            document.getElementById('huntPanel').classList.remove('active');
            document.getElementById('huntBtn').classList.remove('active');
        }

        // Render categories in sidebar
        function renderCategories() {
            const list = document.getElementById('categoryList');
            list.innerHTML = categories.map(cat => `
                <li class="category-item ${exploredCategories.has(cat.id) ? 'explored' : ''}"
                    data-category="${cat.id}"
                    onclick="selectCategory('${cat.id}')">
                    <span class="category-icon">${cat.icon}</span>
                    <span class="category-name">${cat.name}</span>
                </li>
            `).join('');
        }

        // Select category
        function selectCategory(categoryId) {
            currentCategory = categoryId;

            // Mark as explored
            exploredCategories.add(categoryId);

            // Update sidebar
            document.querySelectorAll('.category-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.category === categoryId) {
                    item.classList.add('active');
                }
            });

            document.querySelectorAll('.category-item').forEach(item => {
                if (exploredCategories.has(item.dataset.category)) {
                    item.classList.add('explored');
                }
            });

            // Render content
            renderCategoryContent(categoryId);
            updateStats();
            saveProgress();
        }

        // Render category content
        function renderCategoryContent(categoryId) {
            const category = categories.find(c => c.id === categoryId);
            const contentArea = document.getElementById('contentArea');

            contentArea.innerHTML = `
                <div class="content-header">
                    <h1 class="content-title">${category.icon} ${category.name}</h1>
                    <p class="content-subtitle">${category.subtitle}</p>
                </div>

                ${category.sections.map(section => `
                    <div class="settings-group">
                        <h3 class="group-title">${section.title}</h3>
                        ${section.settings.map(setting => renderSetting(setting)).join('')}
                    </div>
                `).join('')}
            `;
        }

        // Render individual setting
        function renderSetting(setting) {
            let control = '';

            if (setting.type === 'toggle') {
                control = '<div class="toggle-switch"><div class="toggle-knob"></div></div>';
            } else if (setting.type === 'dropdown') {
                control = '<select class="dropdown-control"><option>Current setting</option></select>';
            } else if (setting.type === 'button') {
                control = '<button class="btn-control">Open</button>';
            } else if (setting.type === 'slider') {
                control = '<input type="range" style="width: 150px;">';
            }

            return `
                <div class="setting-item"
                     data-setting-id="${setting.id}"
                     onmouseenter="handleSettingHover(this, '${setting.id}')"
                     onmouseleave="hideTooltip()"
                     onclick="handleSettingClick('${setting.id}')">
                    <div class="setting-info">
                        <div class="setting-name">${setting.name}</div>
                        <div class="setting-desc">${setting.desc}</div>
                    </div>
                    <div class="setting-control" onclick="event.stopPropagation();">
                        ${control}
                    </div>
                </div>
            `;
        }

        // Handle setting hover (tooltip)
        function handleSettingHover(element, settingId) {
            const setting = findSettingById(settingId);
            if (!setting) return;

            const tooltip = document.getElementById('tooltip');
            const rect = element.getBoundingClientRect();

            document.getElementById('tooltipTitle').textContent = setting.name;
            document.getElementById('tooltipContent').textContent = setting.tooltip;

            tooltip.style.left = (rect.left + 20) + 'px';
            tooltip.style.top = (rect.bottom + 10) + 'px';
            tooltip.classList.add('visible');
        }

        function hideTooltip() {
            document.getElementById('tooltip').classList.remove('visible');
        }

        // Handle setting click
        function handleSettingClick(settingId) {
            viewedSettings.add(settingId);

            // Check if this is a hunt item
            const huntItem = huntItems.find(item => item.id === settingId);
            if (huntItem && !huntItem.found) {
                huntItem.found = true;
                foundHuntItems.add(settingId);
                renderHuntItems();
                showFoundAnimation(settingId);
            }

            updateStats();
            saveProgress();
        }

        // Find setting by ID
        function findSettingById(settingId) {
            for (const category of categories) {
                for (const section of category.sections) {
                    const setting = section.settings.find(s => s.id === settingId);
                    if (setting) return setting;
                }
            }
            return null;
        }

        // Render hunt items
        function renderHuntItems() {
            const list = document.getElementById('huntList');
            list.innerHTML = huntItems.map(item => `
                <li class="hunt-item ${item.found ? 'found' : ''}">
                    <div class="hunt-item-text">${item.found ? '‚úì ' : ''}${item.text}</div>
                    <div class="hunt-hint">${item.found ? 'Found!' : `Look in ${categories.find(c => c.id === item.category).name}`}</div>
                </li>
            `).join('');

            updateHuntProgress();
        }

        // Update hunt progress
        function updateHuntProgress() {
            const found = huntItems.filter(item => item.found).length;
            const total = huntItems.length;
            const percent = (found / total) * 100;

            document.getElementById('huntProgressText').textContent = `${found} / ${total}`;
            document.getElementById('huntProgressBar').style.width = percent + '%';
        }

        // Show found animation
        function showFoundAnimation(settingId) {
            const element = document.querySelector(`[data-setting-id="${settingId}"]`);
            if (element) {
                element.style.transition = 'all 0.5s ease';
                element.style.background = 'rgba(52, 211, 153, 0.3)';
                element.style.borderColor = 'rgba(52, 211, 153, 0.6)';

                setTimeout(() => {
                    element.style.background = '';
                    element.style.borderColor = '';
                }, 1000);
            }
        }

        // Search settings
        function searchSettings() {
            const query = document.getElementById('searchBox').value.toLowerCase();

            if (query === '') {
                if (currentCategory) {
                    renderCategoryContent(currentCategory);
                }
                return;
            }

            // Search through all settings
            const results = [];
            categories.forEach(category => {
                category.sections.forEach(section => {
                    section.settings.forEach(setting => {
                        if (setting.name.toLowerCase().includes(query) ||
                            setting.desc.toLowerCase().includes(query) ||
                            setting.tooltip.toLowerCase().includes(query)) {
                            results.push({ category, section, setting });
                        }
                    });
                });
            });

            // Render search results
            const contentArea = document.getElementById('contentArea');
            if (results.length === 0) {
                contentArea.innerHTML = `
                    <div class="content-header">
                        <h1 class="content-title">üîç Search Results</h1>
                        <p class="content-subtitle">No results found for "${query}"</p>
                    </div>
                `;
            } else {
                contentArea.innerHTML = `
                    <div class="content-header">
                        <h1 class="content-title">üîç Search Results</h1>
                        <p class="content-subtitle">Found ${results.length} settings matching "${query}"</p>
                    </div>

                    <div class="settings-group">
                        ${results.map(result => `
                            <div style="margin-bottom: 5px; padding: 5px 10px; background: rgba(139, 92, 246, 0.05); border-radius: 4px; font-size: 0.8rem; color: #8b7a9e;">
                                ${result.category.icon} ${result.category.name} ‚Üí ${result.section.title}
                            </div>
                            ${renderSetting(result.setting)}
                        `).join('')}
                    </div>
                `;
            }
        }

        // Update stats
        function updateStats() {
            document.getElementById('exploredCount').textContent = exploredCategories.size;
            document.getElementById('settingsCount').textContent = viewedSettings.size;
            document.getElementById('huntProgress').textContent = foundHuntItems.size;
        }

        // Save progress
        function saveProgress() {
            const progress = {
                mode: currentMode,
                exploredCategories: Array.from(exploredCategories),
                viewedSettings: Array.from(viewedSettings),
                foundHuntItems: Array.from(foundHuntItems),
                huntItemsState: huntItems.map(item => ({ id: item.id, found: item.found }))
            };
            localStorage.setItem('settingsExplorer_progress', JSON.stringify(progress));

            // Also save to Hexworth progress
            const hexworthProgress = JSON.parse(localStorage.getItem('hexworth_progress') || '{}');
            hexworthProgress.forge = hexworthProgress.forge || {};
            hexworthProgress.forge.settingsExplorer = {
                completed: exploredCategories.size === categories.length,
                exploredCount: exploredCategories.size,
                viewedCount: viewedSettings.size,
                huntComplete: foundHuntItems.size === huntItems.length,
                date: new Date().toISOString()
            };
            localStorage.setItem('hexworth_progress', JSON.stringify(hexworthProgress));
        }

        // Load progress
        function loadProgress() {
            const saved = localStorage.getItem('settingsExplorer_progress');
            if (saved) {
                const progress = JSON.parse(saved);
                exploredCategories = new Set(progress.exploredCategories || []);
                viewedSettings = new Set(progress.viewedSettings || []);
                foundHuntItems = new Set(progress.foundHuntItems || []);

                // Restore hunt items state
                if (progress.huntItemsState) {
                    progress.huntItemsState.forEach(state => {
                        const item = huntItems.find(i => i.id === state.id);
                        if (item) item.found = state.found;
                    });
                }
            }
        }

        // Initialize on load
        init();
    </script>
</body>
</html>
