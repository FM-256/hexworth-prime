<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Access Control -->
    <script src="../../../components/AccessGuard.js"></script>
    <script>
        AccessGuard.require('sorted');
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administrative Tools Explorer - House of the Forge</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #0d0d12 0%, #1a1520 50%, #0d0d12 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #c4b5d4;
        }

        /* Header */
        .app-header {
            padding: 20px 40px;
            background: rgba(10, 10, 15, 0.9);
            border-bottom: 1px solid rgba(139, 92, 246, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .back-btn {
            padding: 8px 16px;
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 6px;
            color: #a78bfa;
            text-decoration: none;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(139, 92, 246, 0.2);
        }

        .app-title {
            font-size: 1.1rem;
            color: #e8d5f5;
            font-weight: 400;
        }

        .house-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.75rem;
            color: #8b7a9e;
            letter-spacing: 0.1em;
        }

        /* Main Content */
        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        /* Mode Selector */
        .mode-bar {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        .mode-btn {
            padding: 12px 24px;
            background: rgba(30, 25, 40, 0.6);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 8px;
            color: #c4b5d4;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mode-btn:hover {
            background: rgba(139, 92, 246, 0.1);
            border-color: rgba(139, 92, 246, 0.4);
        }

        .mode-btn.active {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
            border-color: transparent;
        }

        /* Stats Bar */
        .stats-bar {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(20, 15, 30, 0.6);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 12px;
        }

        .stat-item {
            flex: 1;
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            color: #a78bfa;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.75rem;
            color: #6b5b7e;
            letter-spacing: 0.1em;
        }

        /* Mode Containers */
        .mode-container {
            display: none;
        }

        .mode-container.active {
            display: block;
        }

        /* ==================== EXPLORER MODE ==================== */

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .tool-card {
            background: rgba(30, 25, 40, 0.6);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 12px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tool-card:hover {
            background: rgba(139, 92, 246, 0.1);
            border-color: rgba(139, 92, 246, 0.4);
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(139, 92, 246, 0.2);
        }

        .tool-card.explored {
            border-color: rgba(52, 211, 153, 0.3);
        }

        .tool-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .tool-name {
            font-size: 1.1rem;
            color: #e8d5f5;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .tool-command {
            font-family: 'Courier New', monospace;
            color: #34d399;
            font-size: 0.8rem;
            background: rgba(52, 211, 153, 0.1);
            padding: 4px 8px;
            border-radius: 4px;
            margin-bottom: 10px;
            display: inline-block;
        }

        .tool-desc {
            font-size: 0.85rem;
            color: #8b7a9e;
            line-height: 1.5;
        }

        /* ==================== MMC CONSOLE MODE ==================== */

        .mmc-container {
            background: rgba(20, 15, 30, 0.8);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        .mmc-title-bar {
            background: linear-gradient(180deg, rgba(139, 92, 246, 0.2), rgba(139, 92, 246, 0.1));
            border-bottom: 1px solid rgba(139, 92, 246, 0.3);
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .mmc-title {
            font-size: 0.9rem;
            color: #e8d5f5;
        }

        .mmc-controls {
            display: flex;
            gap: 8px;
        }

        .mmc-control-btn {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .mmc-control-btn.minimize { background: #fbbf24; }
        .mmc-control-btn.maximize { background: #34d399; }
        .mmc-control-btn.close { background: #ef4444; }

        .mmc-control-btn:hover {
            opacity: 0.7;
        }

        .mmc-menu-bar {
            background: rgba(10, 10, 15, 0.8);
            border-bottom: 1px solid rgba(139, 92, 246, 0.2);
            padding: 8px 15px;
            display: flex;
            gap: 20px;
            font-size: 0.85rem;
        }

        .mmc-menu-item {
            color: #c4b5d4;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .mmc-menu-item:hover {
            color: #e8d5f5;
        }

        .mmc-toolbar {
            background: rgba(15, 12, 20, 0.8);
            border-bottom: 1px solid rgba(139, 92, 246, 0.2);
            padding: 8px 15px;
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .mmc-toolbar-btn {
            padding: 6px 12px;
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 4px;
            color: #c4b5d4;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .mmc-toolbar-btn:hover {
            background: rgba(139, 92, 246, 0.2);
        }

        .mmc-body {
            display: flex;
            height: 600px;
        }

        .mmc-tree-pane {
            width: 280px;
            background: rgba(10, 10, 15, 0.6);
            border-right: 1px solid rgba(139, 92, 246, 0.2);
            overflow-y: auto;
            padding: 10px;
        }

        .tree-node {
            padding: 8px 10px;
            margin: 2px 0;
            cursor: pointer;
            border-radius: 4px;
            font-size: 0.85rem;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tree-node:hover {
            background: rgba(139, 92, 246, 0.1);
        }

        .tree-node.active {
            background: rgba(139, 92, 246, 0.2);
            border-left: 3px solid #8b5cf6;
        }

        .tree-node.child {
            margin-left: 20px;
        }

        .tree-node.grandchild {
            margin-left: 40px;
        }

        .tree-toggle {
            color: #8b7a9e;
            font-size: 0.7rem;
            width: 12px;
        }

        .mmc-content-pane {
            flex: 1;
            background: rgba(15, 12, 20, 0.6);
            overflow-y: auto;
            padding: 20px;
        }

        .content-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(139, 92, 246, 0.2);
        }

        .content-title {
            font-size: 1.3rem;
            color: #e8d5f5;
            margin-bottom: 8px;
        }

        .content-subtitle {
            font-size: 0.85rem;
            color: #8b7a9e;
        }

        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .content-item {
            background: rgba(30, 25, 40, 0.6);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 8px;
            padding: 15px;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .content-item:hover {
            background: rgba(139, 92, 246, 0.1);
            border-color: rgba(139, 92, 246, 0.4);
        }

        .content-item-icon {
            font-size: 1.5rem;
            margin-bottom: 8px;
        }

        .content-item-name {
            font-size: 0.9rem;
            color: #e8d5f5;
            margin-bottom: 5px;
        }

        .content-item-desc {
            font-size: 0.75rem;
            color: #8b7a9e;
        }

        .mmc-actions-pane {
            width: 220px;
            background: rgba(10, 10, 15, 0.6);
            border-left: 1px solid rgba(139, 92, 246, 0.2);
            overflow-y: auto;
            padding: 15px;
        }

        .actions-title {
            font-size: 0.85rem;
            color: #a78bfa;
            margin-bottom: 15px;
            letter-spacing: 0.1em;
        }

        .action-item {
            padding: 10px 12px;
            background: rgba(30, 25, 40, 0.6);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 6px;
            margin-bottom: 10px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s ease;
        }

        .action-item:hover {
            background: rgba(139, 92, 246, 0.1);
            border-color: rgba(139, 92, 246, 0.4);
        }

        /* ==================== BUILD YOUR OWN MMC MODE ==================== */

        .builder-container {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
        }

        .snapins-library {
            background: rgba(20, 15, 30, 0.6);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 12px;
            padding: 20px;
        }

        .library-title {
            font-size: 1rem;
            color: #a78bfa;
            margin-bottom: 15px;
            letter-spacing: 0.1em;
        }

        .snapin-item {
            padding: 12px;
            background: rgba(30, 25, 40, 0.6);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: grab;
            transition: all 0.2s ease;
        }

        .snapin-item:hover {
            background: rgba(139, 92, 246, 0.1);
            border-color: rgba(139, 92, 246, 0.4);
            transform: translateX(5px);
        }

        .snapin-item.dragging {
            opacity: 0.5;
            cursor: grabbing;
        }

        .snapin-name {
            font-size: 0.9rem;
            color: #e8d5f5;
            margin-bottom: 5px;
        }

        .snapin-desc {
            font-size: 0.75rem;
            color: #8b7a9e;
        }

        .custom-console {
            background: rgba(20, 15, 30, 0.6);
            border: 2px dashed rgba(139, 92, 246, 0.3);
            border-radius: 12px;
            padding: 30px;
            min-height: 400px;
        }

        .console-header {
            margin-bottom: 25px;
        }

        .console-name-input {
            width: 100%;
            padding: 12px;
            background: rgba(30, 25, 40, 0.8);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 8px;
            color: #e8d5f5;
            font-size: 1rem;
            margin-bottom: 10px;
        }

        .console-name-input:focus {
            outline: none;
            border-color: rgba(139, 92, 246, 0.6);
        }

        .console-actions {
            display: flex;
            gap: 10px;
        }

        .console-btn {
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .console-btn.primary {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            border: none;
            color: white;
        }

        .console-btn.secondary {
            background: transparent;
            border: 1px solid rgba(139, 92, 246, 0.3);
            color: #a78bfa;
        }

        .console-btn:hover {
            opacity: 0.8;
        }

        .dropzone {
            background: rgba(30, 25, 40, 0.4);
            border: 2px dashed rgba(139, 92, 246, 0.3);
            border-radius: 8px;
            padding: 20px;
            min-height: 300px;
            text-align: center;
        }

        .dropzone.drag-over {
            background: rgba(139, 92, 246, 0.1);
            border-color: rgba(139, 92, 246, 0.6);
        }

        .dropzone-placeholder {
            color: #6b5b7e;
            font-size: 0.9rem;
            padding: 40px;
        }

        .added-snapin {
            background: rgba(52, 211, 153, 0.1);
            border: 1px solid rgba(52, 211, 153, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .remove-snapin {
            color: #ef4444;
            cursor: pointer;
            font-size: 1.2rem;
        }

        .remove-snapin:hover {
            color: #dc2626;
        }

        /* ==================== SHORTCUTS MODE ==================== */

        .shortcuts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
        }

        .shortcut-card {
            background: rgba(30, 25, 40, 0.6);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 10px;
            padding: 20px;
            transition: all 0.2s ease;
        }

        .shortcut-card:hover {
            background: rgba(139, 92, 246, 0.1);
            border-color: rgba(139, 92, 246, 0.4);
        }

        .shortcut-tool {
            font-size: 1rem;
            color: #e8d5f5;
            margin-bottom: 10px;
        }

        .shortcut-command-display {
            font-family: 'Courier New', monospace;
            color: #34d399;
            font-size: 0.9rem;
            background: rgba(52, 211, 153, 0.1);
            padding: 10px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .shortcut-command-display:hover {
            background: rgba(52, 211, 153, 0.2);
        }

        .copy-icon {
            color: #8b7a9e;
            font-size: 0.85rem;
        }

        .shortcut-usage {
            font-size: 0.75rem;
            color: #8b7a9e;
            margin-top: 8px;
        }

        /* Tooltip */
        .tooltip {
            position: fixed;
            background: rgba(10, 10, 15, 0.95);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 6px;
            padding: 8px 12px;
            font-size: 0.75rem;
            color: #c4b5d4;
            pointer-events: none;
            z-index: 2000;
            display: none;
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(30, 25, 40, 0.6);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(139, 92, 246, 0.4);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(139, 92, 246, 0.6);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .mmc-body {
                flex-direction: column;
                height: auto;
            }

            .mmc-tree-pane,
            .mmc-actions-pane {
                width: 100%;
            }

            .mmc-content-pane {
                min-height: 400px;
            }

            .builder-container {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .app-header {
                flex-direction: column;
                gap: 15px;
                padding: 15px 20px;
            }

            .main-content {
                padding: 20px 15px;
            }

            .stats-bar {
                flex-direction: column;
                gap: 15px;
            }

            .tools-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header class="app-header">
        <div class="header-left">
            <a href="../../../dashboard.html" class="back-btn">‚Üê Back</a>
            <span class="app-title">Administrative Tools Explorer</span>
        </div>
        <div class="house-badge">
            <span>‚öíÔ∏è</span>
            <span>HOUSE OF THE FORGE</span>
        </div>
    </header>

    <main class="main-content">
        <!-- Mode Selector -->
        <div class="mode-bar">
            <button class="mode-btn active" onclick="switchMode('explorer')">üîç Explorer</button>
            <button class="mode-btn" onclick="switchMode('console')">üíª MMC Console</button>
            <button class="mode-btn" onclick="switchMode('builder')">üîß Build Your Own</button>
            <button class="mode-btn" onclick="switchMode('shortcuts')">‚ö° Shortcuts</button>
        </div>

        <!-- Stats Bar -->
        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-value" id="exploredCount">0</div>
                <div class="stat-label">TOOLS EXPLORED</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="consolesBuilt">0</div>
                <div class="stat-label">CONSOLES BUILT</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="shortcutsCopied">0</div>
                <div class="stat-label">SHORTCUTS COPIED</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="progressPercent">0%</div>
                <div class="stat-label">COMPLETION</div>
            </div>
        </div>

        <!-- Explorer Mode -->
        <div id="explorerMode" class="mode-container active">
            <div class="tools-grid" id="toolsGrid">
                <!-- Populated by JavaScript -->
            </div>
        </div>

        <!-- MMC Console Mode -->
        <div id="consoleMode" class="mode-container">
            <div class="mmc-container">
                <div class="mmc-title-bar">
                    <span class="mmc-title" id="mmcWindowTitle">Computer Management</span>
                    <div class="mmc-controls">
                        <div class="mmc-control-btn minimize"></div>
                        <div class="mmc-control-btn maximize"></div>
                        <div class="mmc-control-btn close" onclick="switchMode('explorer')"></div>
                    </div>
                </div>
                <div class="mmc-menu-bar">
                    <span class="mmc-menu-item">File</span>
                    <span class="mmc-menu-item">Action</span>
                    <span class="mmc-menu-item">View</span>
                    <span class="mmc-menu-item">Help</span>
                </div>
                <div class="mmc-toolbar">
                    <button class="mmc-toolbar-btn">‚Üê Back</button>
                    <button class="mmc-toolbar-btn">‚Üí Forward</button>
                    <button class="mmc-toolbar-btn">‚Üª Refresh</button>
                    <button class="mmc-toolbar-btn">üè† Root</button>
                </div>
                <div class="mmc-body">
                    <div class="mmc-tree-pane" id="mmcTreePane">
                        <!-- Populated by JavaScript -->
                    </div>
                    <div class="mmc-content-pane" id="mmcContentPane">
                        <!-- Populated by JavaScript -->
                    </div>
                    <div class="mmc-actions-pane">
                        <div class="actions-title">ACTIONS</div>
                        <div class="action-item">More Actions...</div>
                        <div class="action-item">Export List...</div>
                        <div class="action-item">View</div>
                        <div class="action-item">Refresh</div>
                        <div class="action-item">Properties</div>
                        <div class="action-item">Help</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Build Your Own MMC Mode -->
        <div id="builderMode" class="mode-container">
            <div class="builder-container">
                <div class="snapins-library">
                    <div class="library-title">SNAP-IN LIBRARY</div>
                    <div id="snapinsList">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
                <div class="custom-console">
                    <div class="console-header">
                        <input type="text" class="console-name-input" id="consoleName" placeholder="My Custom Console">
                        <div class="console-actions">
                            <button class="console-btn primary" onclick="saveConsole()">üíæ Save Console</button>
                            <button class="console-btn secondary" onclick="resetBuilder()">üîÑ Reset</button>
                            <button class="console-btn secondary" onclick="exportConsole()">üì§ Export .msc</button>
                        </div>
                    </div>
                    <div class="dropzone" id="dropzone">
                        <div class="dropzone-placeholder">
                            Drag snap-ins here to build your custom console
                        </div>
                        <div id="addedSnapins"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Shortcuts Mode -->
        <div id="shortcutsMode" class="mode-container">
            <div class="shortcuts-grid" id="shortcutsGrid">
                <!-- Populated by JavaScript -->
            </div>
        </div>
    </main>

    <!-- Tooltip -->
    <div class="tooltip" id="tooltip"></div>

    <script>
        // ==================== DATA STRUCTURE ====================

        const adminTools = [
            {
                id: 'compmgmt',
                name: 'Computer Management',
                icon: 'üñ•Ô∏è',
                command: 'compmgmt.msc',
                description: 'Comprehensive system management console with disk management, services, event viewer, and performance tools.',
                hasTree: true,
                tree: [
                    {
                        id: 'system-tools',
                        name: 'System Tools',
                        icon: 'üîß',
                        children: [
                            { id: 'task-scheduler', name: 'Task Scheduler', icon: 'üìÖ' },
                            { id: 'event-viewer', name: 'Event Viewer', icon: 'üìã' },
                            { id: 'shared-folders', name: 'Shared Folders', icon: 'üìÅ' },
                            { id: 'local-users', name: 'Local Users and Groups', icon: 'üë•' },
                            { id: 'performance', name: 'Performance', icon: 'üìä' },
                            { id: 'device-manager', name: 'Device Manager', icon: 'üîå' }
                        ]
                    },
                    {
                        id: 'storage',
                        name: 'Storage',
                        icon: 'üíæ',
                        children: [
                            { id: 'disk-management', name: 'Disk Management', icon: 'üíø' }
                        ]
                    },
                    {
                        id: 'services-apps',
                        name: 'Services and Applications',
                        icon: '‚öôÔ∏è',
                        children: [
                            { id: 'services', name: 'Services', icon: 'üîÑ' },
                            { id: 'wmi-control', name: 'WMI Control', icon: 'üéõÔ∏è' }
                        ]
                    }
                ]
            },
            {
                id: 'devmgmt',
                name: 'Device Manager',
                icon: 'üîå',
                command: 'devmgmt.msc',
                description: 'Manage hardware devices and drivers. View device properties, update drivers, disable devices, and troubleshoot hardware issues.',
                hasTree: true,
                tree: [
                    { id: 'audio', name: 'Audio inputs and outputs', icon: 'üîä' },
                    { id: 'disk', name: 'Disk drives', icon: 'üíø' },
                    { id: 'display', name: 'Display adapters', icon: 'üé®' },
                    { id: 'network', name: 'Network adapters', icon: 'üåê' },
                    { id: 'usb', name: 'Universal Serial Bus controllers', icon: 'üîå' }
                ]
            },
            {
                id: 'diskmgmt',
                name: 'Disk Management',
                icon: 'üíø',
                command: 'diskmgmt.msc',
                description: 'Create, delete, format, and manage disk partitions and volumes. Initialize disks, extend volumes, and assign drive letters.',
                hasTree: false
            },
            {
                id: 'eventvwr',
                name: 'Event Viewer',
                icon: 'üìã',
                command: 'eventvwr.msc',
                description: 'View detailed logs of application, security, and system events. Troubleshoot issues and monitor system activity.',
                hasTree: true,
                tree: [
                    {
                        id: 'windows-logs',
                        name: 'Windows Logs',
                        icon: 'üìÅ',
                        children: [
                            { id: 'application', name: 'Application', icon: 'üì±' },
                            { id: 'security', name: 'Security', icon: 'üîê' },
                            { id: 'setup', name: 'Setup', icon: '‚öôÔ∏è' },
                            { id: 'system', name: 'System', icon: 'üíª' },
                            { id: 'forwarded', name: 'Forwarded Events', icon: 'üì§' }
                        ]
                    },
                    {
                        id: 'apps-logs',
                        name: 'Applications and Services Logs',
                        icon: 'üìÇ',
                        children: [
                            { id: 'hardware', name: 'Hardware Events', icon: 'üîß' },
                            { id: 'internet-explorer', name: 'Internet Explorer', icon: 'üåê' },
                            { id: 'windows-powershell', name: 'Windows PowerShell', icon: 'üíô' }
                        ]
                    }
                ]
            },
            {
                id: 'services',
                name: 'Services',
                icon: 'üîÑ',
                command: 'services.msc',
                description: 'Start, stop, pause, and configure Windows services. Set startup types and manage service dependencies.',
                hasTree: false
            },
            {
                id: 'taskschd',
                name: 'Task Scheduler',
                icon: 'üìÖ',
                command: 'taskschd.msc',
                description: 'Create and manage scheduled tasks. Automate scripts, programs, and system maintenance at specific times or events.',
                hasTree: true,
                tree: [
                    { id: 'task-scheduler-library', name: 'Task Scheduler Library', icon: 'üìö' },
                    { id: 'microsoft', name: 'Microsoft', icon: 'ü™ü' },
                    { id: 'running-tasks', name: 'Running Tasks', icon: '‚ñ∂Ô∏è' }
                ]
            },
            {
                id: 'lusrmgr',
                name: 'Local Users and Groups',
                icon: 'üë•',
                command: 'lusrmgr.msc',
                description: 'Manage local user accounts and groups. Create users, set passwords, assign group memberships, and configure account properties.',
                hasTree: true,
                tree: [
                    { id: 'users', name: 'Users', icon: 'üë§' },
                    { id: 'groups', name: 'Groups', icon: 'üë•' }
                ]
            },
            {
                id: 'perfmon',
                name: 'Performance Monitor',
                icon: 'üìä',
                command: 'perfmon.msc',
                description: 'Monitor system performance in real-time. Track CPU, memory, disk, and network usage with customizable counters and reports.',
                hasTree: true,
                tree: [
                    { id: 'monitoring-tools', name: 'Monitoring Tools', icon: 'üîç' },
                    { id: 'data-collector-sets', name: 'Data Collector Sets', icon: 'üì¶' },
                    { id: 'reports', name: 'Reports', icon: 'üìà' }
                ]
            },
            {
                id: 'gpedit',
                name: 'Group Policy Editor',
                icon: 'üìú',
                command: 'gpedit.msc',
                description: 'Configure local group policies for security, software installation, scripts, and system settings. (Pro/Enterprise editions only)',
                hasTree: true,
                tree: [
                    { id: 'computer-config', name: 'Computer Configuration', icon: 'üñ•Ô∏è' },
                    { id: 'user-config', name: 'User Configuration', icon: 'üë§' }
                ]
            },
            {
                id: 'secpol',
                name: 'Local Security Policy',
                icon: 'üîê',
                command: 'secpol.msc',
                description: 'Configure security settings including password policies, user rights, security options, and audit policies. (Pro/Enterprise editions only)',
                hasTree: true,
                tree: [
                    { id: 'account-policies', name: 'Account Policies', icon: 'üîë' },
                    { id: 'local-policies', name: 'Local Policies', icon: 'üìã' },
                    { id: 'security-options', name: 'Security Options', icon: 'üõ°Ô∏è' }
                ]
            },
            {
                id: 'certmgr',
                name: 'Certificate Manager',
                icon: 'üìú',
                command: 'certmgr.msc',
                description: 'Manage digital certificates for secure authentication, encryption, and code signing. Import, export, and view certificate details.',
                hasTree: true,
                tree: [
                    { id: 'personal', name: 'Personal', icon: 'üë§' },
                    { id: 'trusted-root', name: 'Trusted Root Certification Authorities', icon: '‚úì' },
                    { id: 'intermediate', name: 'Intermediate Certification Authorities', icon: 'üîó' }
                ]
            },
            {
                id: 'wf',
                name: 'Windows Defender Firewall',
                icon: 'üî•',
                command: 'wf.msc',
                description: 'Advanced firewall configuration with inbound and outbound rules, connection security, and monitoring capabilities.',
                hasTree: true,
                tree: [
                    { id: 'inbound', name: 'Inbound Rules', icon: '‚¨áÔ∏è' },
                    { id: 'outbound', name: 'Outbound Rules', icon: '‚¨ÜÔ∏è' },
                    { id: 'connection-security', name: 'Connection Security Rules', icon: 'üîí' },
                    { id: 'monitoring', name: 'Monitoring', icon: 'üëÅÔ∏è' }
                ]
            }
        ];

        const snapIns = [
            { id: 'compmgmt', name: 'Computer Management', desc: 'Full system management' },
            { id: 'devmgmt', name: 'Device Manager', desc: 'Hardware devices' },
            { id: 'diskmgmt', name: 'Disk Management', desc: 'Disk partitions' },
            { id: 'eventvwr', name: 'Event Viewer', desc: 'System logs' },
            { id: 'services', name: 'Services', desc: 'Windows services' },
            { id: 'taskschd', name: 'Task Scheduler', desc: 'Scheduled tasks' },
            { id: 'lusrmgr', name: 'Local Users and Groups', desc: 'User accounts' },
            { id: 'perfmon', name: 'Performance Monitor', desc: 'System performance' },
            { id: 'gpedit', name: 'Group Policy Editor', desc: 'Group policies' },
            { id: 'certmgr', name: 'Certificate Manager', desc: 'Digital certificates' },
            { id: 'wf', name: 'Windows Firewall', desc: 'Firewall rules' }
        ];

        // ==================== STATE MANAGEMENT ====================

        let currentMode = 'explorer';
        let currentTool = null;
        let exploredTools = new Set();
        let consolesBuilt = 0;
        let shortcutsCopied = new Set();
        let customSnapins = [];
        let expandedNodes = new Set();

        // ==================== INITIALIZATION ====================

        function init() {
            loadProgress();
            renderToolsGrid();
            renderSnapins();
            renderShortcuts();
            updateStats();
        }

        // ==================== MODE SWITCHING ====================

        function switchMode(mode) {
            currentMode = mode;

            // Update buttons
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // Show/hide modes
            document.querySelectorAll('.mode-container').forEach(container => {
                container.classList.remove('active');
            });

            document.getElementById(mode + 'Mode').classList.add('active');

            // Special handling for console mode
            if (mode === 'console' && currentTool) {
                loadConsole(currentTool);
            }
        }

        // ==================== EXPLORER MODE ====================

        function renderToolsGrid() {
            const grid = document.getElementById('toolsGrid');
            grid.innerHTML = '';

            adminTools.forEach(tool => {
                const isExplored = exploredTools.has(tool.id);
                const card = document.createElement('div');
                card.className = `tool-card ${isExplored ? 'explored' : ''}`;
                card.onclick = () => openTool(tool);

                card.innerHTML = `
                    <div class="tool-icon">${tool.icon}</div>
                    <div class="tool-name">${tool.name}</div>
                    <div class="tool-command">${tool.command}</div>
                    <div class="tool-desc">${tool.description}</div>
                `;

                grid.appendChild(card);
            });
        }

        function openTool(tool) {
            currentTool = tool;
            exploredTools.add(tool.id);
            saveProgress();
            updateStats();
            renderToolsGrid();

            switchMode('console');
            loadConsole(tool);
        }

        // ==================== MMC CONSOLE MODE ====================

        function loadConsole(tool) {
            document.getElementById('mmcWindowTitle').textContent = tool.name;

            // Render tree
            const treePane = document.getElementById('mmcTreePane');
            treePane.innerHTML = '';

            // Root node
            const rootNode = createTreeNode(tool.name, tool.icon, 'root', false);
            rootNode.classList.add('active');
            rootNode.onclick = () => selectNode('root', tool);
            treePane.appendChild(rootNode);

            // Child nodes
            if (tool.hasTree && tool.tree) {
                tool.tree.forEach(node => {
                    const isExpanded = expandedNodes.has(node.id);
                    const parentNode = createTreeNode(
                        node.name,
                        node.icon,
                        node.id,
                        node.children && node.children.length > 0,
                        isExpanded
                    );
                    parentNode.classList.add('child');
                    parentNode.onclick = (e) => {
                        e.stopPropagation();
                        if (node.children) {
                            toggleNode(node.id);
                        }
                        selectNode(node.id, node);
                    };
                    treePane.appendChild(parentNode);

                    // Grandchildren
                    if (node.children && isExpanded) {
                        node.children.forEach(child => {
                            const childNode = createTreeNode(child.name, child.icon, child.id, false);
                            childNode.classList.add('grandchild');
                            childNode.onclick = (e) => {
                                e.stopPropagation();
                                selectNode(child.id, child);
                            };
                            treePane.appendChild(childNode);
                        });
                    }
                });
            }

            // Load root content
            selectNode('root', tool);
        }

        function createTreeNode(name, icon, id, hasChildren, isExpanded = false) {
            const node = document.createElement('div');
            node.className = 'tree-node';
            node.setAttribute('data-id', id);

            const toggle = hasChildren ? (isExpanded ? '‚ñº' : '‚ñ∂') : '';

            node.innerHTML = `
                <span class="tree-toggle">${toggle}</span>
                <span>${icon}</span>
                <span>${name}</span>
            `;

            return node;
        }

        function toggleNode(nodeId) {
            if (expandedNodes.has(nodeId)) {
                expandedNodes.delete(nodeId);
            } else {
                expandedNodes.add(nodeId);
            }
            loadConsole(currentTool);
        }

        function selectNode(nodeId, nodeData) {
            // Update active state
            document.querySelectorAll('.tree-node').forEach(node => {
                node.classList.remove('active');
            });
            document.querySelector(`[data-id="${nodeId}"]`).classList.add('active');

            // Render content
            const contentPane = document.getElementById('mmcContentPane');
            contentPane.innerHTML = `
                <div class="content-header">
                    <div class="content-title">${nodeData.icon || currentTool.icon} ${nodeData.name || currentTool.name}</div>
                    <div class="content-subtitle">${nodeData.description || currentTool.description}</div>
                </div>
            `;

            // Show sample content based on node type
            if (nodeData.children) {
                const grid = document.createElement('div');
                grid.className = 'content-grid';

                nodeData.children.forEach(child => {
                    const item = document.createElement('div');
                    item.className = 'content-item';
                    item.innerHTML = `
                        <div class="content-item-icon">${child.icon}</div>
                        <div class="content-item-name">${child.name}</div>
                        <div class="content-item-desc">Click to view details</div>
                    `;
                    grid.appendChild(item);
                });

                contentPane.appendChild(grid);
            } else {
                // Show simulated data view
                const simulatedData = getSimulatedData(nodeId);
                contentPane.innerHTML += simulatedData;
            }
        }

        function getSimulatedData(nodeId) {
            const simulations = {
                'root': `<div style="padding: 20px; color: #8b7a9e;">
                    Select an item from the tree to view its contents.
                </div>`,
                'services': `<div style="padding: 20px;">
                    <div style="color: #e8d5f5; margin-bottom: 15px;">Simulated Services List:</div>
                    <div style="display: grid; gap: 10px;">
                        ${generateServiceItems()}
                    </div>
                </div>`,
                'disk-management': `<div style="padding: 20px;">
                    <div style="color: #e8d5f5; margin-bottom: 15px;">Disk Layout:</div>
                    <div style="background: rgba(30, 25, 40, 0.6); padding: 15px; border-radius: 8px;">
                        <div style="margin-bottom: 10px;">Disk 0 - 500 GB</div>
                        <div style="display: flex; gap: 5px; height: 40px;">
                            <div style="flex: 50; background: rgba(139, 92, 246, 0.3); border-radius: 4px; display: flex; align-items: center; justify-content: center; font-size: 0.8rem;">C: (NTFS) - 250 GB</div>
                            <div style="flex: 50; background: rgba(52, 211, 153, 0.3); border-radius: 4px; display: flex; align-items: center; justify-content: center; font-size: 0.8rem;">D: (NTFS) - 250 GB</div>
                        </div>
                    </div>
                </div>`,
                'application': `<div style="padding: 20px;">
                    <div style="color: #e8d5f5; margin-bottom: 15px;">Recent Application Events:</div>
                    ${generateEventItems('Application')}
                </div>`,
                'security': `<div style="padding: 20px;">
                    <div style="color: #e8d5f5; margin-bottom: 15px;">Recent Security Events:</div>
                    ${generateEventItems('Security')}
                </div>`
            };

            return simulations[nodeId] || `<div style="padding: 20px; color: #8b7a9e;">
                This view would show detailed ${nodeId} information in the actual MMC console.
            </div>`;
        }

        function generateServiceItems() {
            const services = [
                { name: 'Windows Update', status: 'Running', startup: 'Automatic' },
                { name: 'Windows Defender', status: 'Running', startup: 'Automatic' },
                { name: 'DHCP Client', status: 'Running', startup: 'Automatic' },
                { name: 'DNS Client', status: 'Running', startup: 'Automatic' },
                { name: 'Print Spooler', status: 'Stopped', startup: 'Manual' }
            ];

            return services.map(svc => `
                <div style="background: rgba(30, 25, 40, 0.6); padding: 12px; border-radius: 6px; display: flex; justify-content: space-between;">
                    <span style="color: #e8d5f5;">${svc.name}</span>
                    <span style="color: ${svc.status === 'Running' ? '#34d399' : '#ef4444'};">${svc.status}</span>
                    <span style="color: #8b7a9e; font-size: 0.8rem;">${svc.startup}</span>
                </div>
            `).join('');
        }

        function generateEventItems(type) {
            const events = [
                { level: 'Information', source: 'Microsoft-Windows', id: '1000' },
                { level: 'Warning', source: 'Application', id: '1001' },
                { level: 'Information', source: 'System', id: '7036' },
                { level: 'Error', source: 'Service Control', id: '7031' }
            ];

            return events.map(evt => `
                <div style="background: rgba(30, 25, 40, 0.6); padding: 12px; border-radius: 6px; margin-bottom: 8px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span style="color: ${evt.level === 'Error' ? '#ef4444' : evt.level === 'Warning' ? '#fbbf24' : '#34d399'};">${evt.level}</span>
                        <span style="color: #8b7a9e; font-size: 0.8rem;">Event ID: ${evt.id}</span>
                    </div>
                    <div style="color: #c4b5d4; font-size: 0.85rem;">Source: ${evt.source}</div>
                </div>
            `).join('');
        }

        // ==================== BUILD YOUR OWN MMC MODE ====================

        function renderSnapins() {
            const container = document.getElementById('snapinsList');
            container.innerHTML = '';

            snapIns.forEach(snapin => {
                const item = document.createElement('div');
                item.className = 'snapin-item';
                item.draggable = true;
                item.setAttribute('data-snapin-id', snapin.id);

                item.innerHTML = `
                    <div class="snapin-name">${snapin.name}</div>
                    <div class="snapin-desc">${snapin.desc}</div>
                `;

                item.addEventListener('dragstart', handleDragStart);
                item.addEventListener('dragend', handleDragEnd);

                container.appendChild(item);
            });

            setupDropzone();
        }

        function setupDropzone() {
            const dropzone = document.getElementById('dropzone');

            dropzone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropzone.classList.add('drag-over');
            });

            dropzone.addEventListener('dragleave', () => {
                dropzone.classList.remove('drag-over');
            });

            dropzone.addEventListener('drop', handleDrop);
        }

        function handleDragStart(e) {
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'copy';
            e.dataTransfer.setData('text/plain', e.target.getAttribute('data-snapin-id'));
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }

        function handleDrop(e) {
            e.preventDefault();
            const dropzone = document.getElementById('dropzone');
            dropzone.classList.remove('drag-over');

            const snapinId = e.dataTransfer.getData('text/plain');
            addSnapinToConsole(snapinId);
        }

        function addSnapinToConsole(snapinId) {
            const snapin = snapIns.find(s => s.id === snapinId);
            if (!snapin || customSnapins.includes(snapinId)) return;

            customSnapins.push(snapinId);

            const container = document.getElementById('addedSnapins');
            const placeholder = document.querySelector('.dropzone-placeholder');
            if (placeholder) placeholder.style.display = 'none';

            const item = document.createElement('div');
            item.className = 'added-snapin';
            item.innerHTML = `
                <div>
                    <div class="snapin-name">${snapin.name}</div>
                    <div class="snapin-desc">${snapin.desc}</div>
                </div>
                <span class="remove-snapin" onclick="removeSnapin('${snapinId}')">‚úï</span>
            `;

            container.appendChild(item);
        }

        function removeSnapin(snapinId) {
            customSnapins = customSnapins.filter(id => id !== snapinId);
            renderCustomConsole();
        }

        function renderCustomConsole() {
            const container = document.getElementById('addedSnapins');
            const placeholder = document.querySelector('.dropzone-placeholder');

            if (customSnapins.length === 0) {
                container.innerHTML = '';
                if (placeholder) placeholder.style.display = 'block';
                return;
            }

            if (placeholder) placeholder.style.display = 'none';
            container.innerHTML = '';

            customSnapins.forEach(snapinId => {
                const snapin = snapIns.find(s => s.id === snapinId);
                if (!snapin) return;

                const item = document.createElement('div');
                item.className = 'added-snapin';
                item.innerHTML = `
                    <div>
                        <div class="snapin-name">${snapin.name}</div>
                        <div class="snapin-desc">${snapin.desc}</div>
                    </div>
                    <span class="remove-snapin" onclick="removeSnapin('${snapinId}')">‚úï</span>
                `;

                container.appendChild(item);
            });
        }

        function saveConsole() {
            const name = document.getElementById('consoleName').value || 'My Custom Console';

            if (customSnapins.length === 0) {
                showTooltip(event, 'Add at least one snap-in to save!');
                return;
            }

            consolesBuilt++;
            saveProgress();
            updateStats();

            showTooltip(event, `Console "${name}" saved successfully!`);
        }

        function resetBuilder() {
            customSnapins = [];
            document.getElementById('consoleName').value = '';
            renderCustomConsole();
        }

        function exportConsole() {
            const name = document.getElementById('consoleName').value || 'custom';

            if (customSnapins.length === 0) {
                showTooltip(event, 'Add snap-ins before exporting!');
                return;
            }

            const mscContent = generateMSCFile(name);
            const blob = new Blob([mscContent], { type: 'text/xml' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${name.replace(/\s+/g, '_')}.msc`;
            a.click();
            URL.revokeObjectURL(url);

            showTooltip(event, 'Console exported as .msc file!');
        }

        function generateMSCFile(name) {
            return `<?xml version="1.0" encoding="UTF-8"?>
<!-- Custom MMC Console: ${name} -->
<!-- Generated by Hexworth Prime Administrative Tools Explorer -->
<MMC_ConsoleFile ConsoleVersion="3.0">
    <ConsoleName>${name}</ConsoleName>
    <SnapIns>
        ${customSnapins.map(id => {
            const snapin = snapIns.find(s => s.id === id);
            return `<SnapIn Name="${snapin.name}" ID="${snapin.id}" />`;
        }).join('\n        ')}
    </SnapIns>
</MMC_ConsoleFile>`;
        }

        // ==================== SHORTCUTS MODE ====================

        function renderShortcuts() {
            const grid = document.getElementById('shortcutsGrid');
            grid.innerHTML = '';

            adminTools.forEach(tool => {
                const card = document.createElement('div');
                card.className = 'shortcut-card';

                card.innerHTML = `
                    <div class="shortcut-tool">${tool.icon} ${tool.name}</div>
                    <div class="shortcut-command-display" onclick="copyShortcut('${tool.command}', event)">
                        <span>${tool.command}</span>
                        <span class="copy-icon">üìã</span>
                    </div>
                    <div class="shortcut-usage">Win+R ‚Üí Type command ‚Üí Enter</div>
                `;

                grid.appendChild(card);
            });
        }

        function copyShortcut(command, event) {
            navigator.clipboard.writeText(command).then(() => {
                shortcutsCopied.add(command);
                saveProgress();
                updateStats();
                showTooltip(event, 'Copied to clipboard!');
            });
        }

        // ==================== UTILITIES ====================

        function showTooltip(event, text) {
            const tooltip = document.getElementById('tooltip');
            tooltip.textContent = text;
            tooltip.style.display = 'block';
            tooltip.style.left = event.clientX + 10 + 'px';
            tooltip.style.top = event.clientY + 10 + 'px';

            setTimeout(() => {
                tooltip.style.display = 'none';
            }, 2000);
        }

        function updateStats() {
            const totalTools = adminTools.length;

            document.getElementById('exploredCount').textContent = exploredTools.size;
            document.getElementById('consolesBuilt').textContent = consolesBuilt;
            document.getElementById('shortcutsCopied').textContent = shortcutsCopied.size;

            const completion = Math.round(((exploredTools.size / totalTools) * 100));
            document.getElementById('progressPercent').textContent = completion + '%';
        }

        // ==================== PROGRESS PERSISTENCE ====================

        function saveProgress() {
            const progress = {
                exploredTools: Array.from(exploredTools),
                consolesBuilt: consolesBuilt,
                shortcutsCopied: Array.from(shortcutsCopied),
                date: new Date().toISOString()
            };
            localStorage.setItem('adminToolsProgress', JSON.stringify(progress));

            // Save to global Hexworth progress
            const hexworthProgress = JSON.parse(localStorage.getItem('hexworth_progress') || '{}');
            hexworthProgress.forge = hexworthProgress.forge || {};
            hexworthProgress.forge.adminToolsExplorer = {
                completed: exploredTools.size > 0,
                exploredCount: exploredTools.size,
                consolesBuilt: consolesBuilt,
                shortcutsCopied: shortcutsCopied.size,
                date: new Date().toISOString()
            };
            localStorage.setItem('hexworth_progress', JSON.stringify(hexworthProgress));
        }

        function loadProgress() {
            const saved = localStorage.getItem('adminToolsProgress');
            if (saved) {
                const progress = JSON.parse(saved);
                exploredTools = new Set(progress.exploredTools || []);
                consolesBuilt = progress.consolesBuilt || 0;
                shortcutsCopied = new Set(progress.shortcutsCopied || []);
            }
        }

        // ==================== START ====================

        init();
    </script>
<script src="../../../components/FluxCapacitor.js"></script>
</body>
</html>
