<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Access Control -->
    <script src="../../../components/AccessGuard.js"></script>
    <script>
        AccessGuard.require('sorted');
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Tools Lab - House of the Forge</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: #0c0c0c;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #c4b5d4;
        }

        /* Header */
        .lab-header {
            padding: 15px 30px;
            background: rgba(10, 10, 15, 0.95);
            border-bottom: 1px solid rgba(139, 92, 246, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .back-btn {
            padding: 8px 16px;
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 6px;
            color: #a78bfa;
            text-decoration: none;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(139, 92, 246, 0.2);
        }

        .lab-title {
            font-size: 1rem;
            color: #e8d5f5;
        }

        .lab-badge {
            padding: 4px 12px;
            background: rgba(52, 211, 153, 0.15);
            border: 1px solid rgba(52, 211, 153, 0.3);
            border-radius: 12px;
            font-size: 0.7rem;
            color: #34d399;
            letter-spacing: 0.05em;
        }

        .task-progress {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 0.85rem;
            color: #8b7a9e;
        }

        .task-count {
            color: #a78bfa;
            font-weight: 500;
        }

        /* Main Layout */
        .lab-container {
            display: grid;
            grid-template-columns: 350px 1fr;
            height: calc(100vh - 60px);
        }

        /* Task Panel */
        .task-panel {
            background: rgba(15, 12, 20, 0.95);
            border-right: 1px solid rgba(139, 92, 246, 0.15);
            overflow-y: auto;
            padding: 20px;
        }

        .task-section {
            margin-bottom: 25px;
        }

        .task-section-title {
            font-size: 0.7rem;
            color: #6b5b7e;
            letter-spacing: 0.15em;
            margin-bottom: 12px;
            text-transform: uppercase;
        }

        .task-card {
            background: rgba(25, 20, 35, 0.8);
            border: 1px solid rgba(139, 92, 246, 0.15);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .task-card:hover {
            border-color: rgba(139, 92, 246, 0.4);
        }

        .task-card.active {
            border-color: #a78bfa;
            background: rgba(139, 92, 246, 0.1);
        }

        .task-card.completed {
            border-color: rgba(52, 211, 153, 0.3);
        }

        .task-card.completed::before {
            content: '‚úì';
            float: right;
            color: #34d399;
            font-weight: bold;
        }

        .task-number {
            font-size: 0.7rem;
            color: #a78bfa;
            margin-bottom: 5px;
        }

        .task-name {
            font-size: 0.95rem;
            color: #e8d5f5;
            margin-bottom: 5px;
        }

        .task-desc {
            font-size: 0.8rem;
            color: #8b7a9e;
            line-height: 1.5;
        }

        /* VM Panel */
        .vm-panel {
            display: flex;
            flex-direction: column;
            background: #0a0a0a;
        }

        .vm-toolbar {
            padding: 10px 20px;
            background: rgba(20, 15, 30, 0.9);
            border-bottom: 1px solid rgba(139, 92, 246, 0.15);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .vm-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .vm-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.8rem;
            color: #34d399;
        }

        .vm-status-dot {
            width: 8px;
            height: 8px;
            background: #34d399;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .vm-name {
            font-size: 0.85rem;
            color: #c4b5d4;
        }

        .vm-actions {
            display: flex;
            gap: 10px;
        }

        .vm-btn {
            padding: 6px 14px;
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 5px;
            color: #a78bfa;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .vm-btn:hover {
            background: rgba(139, 92, 246, 0.2);
        }

        /* VM Screen */
        .vm-screen {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        /* Windows Desktop Simulation */
        .windows-desktop {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0078d4 0%, #001a4d 100%);
            position: relative;
        }

        /* Windows Taskbar */
        .taskbar {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 48px;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            padding: 0 10px;
            z-index: 50;
        }

        .start-btn {
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .start-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .start-btn svg {
            width: 24px;
            height: 24px;
            fill: white;
        }

        .taskbar-apps {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-left: 10px;
        }

        .taskbar-app {
            width: 44px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border-radius: 4px;
            font-size: 1.2rem;
            transition: background 0.2s ease;
            position: relative;
        }

        .taskbar-app:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .taskbar-app.active {
            background: rgba(255, 255, 255, 0.15);
            border-bottom: 3px solid #0078d4;
        }

        .system-tray {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 0 15px;
            height: 100%;
            color: white;
            font-size: 0.75rem;
        }

        .system-tray-icon {
            cursor: pointer;
            font-size: 0.9rem;
            padding: 5px;
            border-radius: 3px;
            transition: background 0.2s ease;
        }

        .system-tray-icon:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .system-tray-time {
            text-align: right;
            line-height: 1.3;
            cursor: pointer;
            padding: 5px;
            border-radius: 3px;
            transition: background 0.2s ease;
        }

        .system-tray-time:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Context Menu */
        .context-menu {
            position: fixed;
            background: rgba(30, 30, 30, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 5px;
            min-width: 200px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 1000;
        }

        .context-menu.active {
            display: block;
        }

        .context-menu-item {
            padding: 8px 12px;
            color: white;
            font-size: 0.85rem;
            cursor: pointer;
            border-radius: 4px;
            transition: background 0.2s ease;
        }

        .context-menu-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .context-menu-separator {
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
            margin: 5px 0;
        }

        /* Windows Window */
        .win-window {
            position: absolute;
            background: #202020;
            border-radius: 8px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            display: none;
        }

        .win-window.active {
            display: block;
        }

        .win-titlebar {
            height: 32px;
            background: #1f1f1f;
            display: flex;
            align-items: center;
            padding: 0 10px;
            cursor: move;
        }

        .win-icon {
            width: 16px;
            height: 16px;
            margin-right: 8px;
        }

        .win-title {
            flex: 1;
            font-size: 0.8rem;
            color: white;
        }

        .win-controls {
            display: flex;
            gap: 0;
        }

        .win-control {
            width: 46px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .win-control:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .win-control.close:hover {
            background: #e81123;
        }

        .win-content {
            background: #282828;
            color: white;
            padding: 20px;
            overflow-y: auto;
        }

        /* Task Manager Window */
        .task-manager-window {
            width: 850px;
            height: 600px;
            top: 50px;
            left: calc(50% - 425px);
        }

        .tm-tabs {
            display: flex;
            background: #2a2a2a;
            border-bottom: 1px solid #333;
        }

        .tm-tab {
            padding: 12px 20px;
            font-size: 0.85rem;
            color: #999;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s ease;
        }

        .tm-tab:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .tm-tab.active {
            color: white;
            border-bottom-color: #0078d4;
            background: rgba(0, 120, 212, 0.1);
        }

        .tm-tab-content {
            display: none;
        }

        .tm-tab-content.active {
            display: block;
        }

        /* Processes Tab */
        .tm-processes {
            padding: 0;
        }

        .tm-process-list {
            background: #282828;
        }

        .tm-process-header {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            padding: 10px 15px;
            background: #2a2a2a;
            border-bottom: 1px solid #333;
            font-size: 0.8rem;
            color: #888;
            font-weight: 500;
        }

        .tm-process-item {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            padding: 10px 15px;
            border-bottom: 1px solid #333;
            font-size: 0.85rem;
            color: #ccc;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .tm-process-item:hover {
            background: #2a2a2a;
        }

        .tm-process-item.selected {
            background: #0078d4;
            color: white;
        }

        .tm-process-item.high-cpu {
            color: #fbbf24;
        }

        .tm-end-task-btn {
            position: absolute;
            bottom: 15px;
            right: 15px;
            padding: 8px 20px;
            background: #e81123;
            border: 1px solid #c80813;
            border-radius: 4px;
            color: white;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .tm-end-task-btn:hover {
            background: #c80813;
        }

        .tm-end-task-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Performance Tab */
        .tm-performance {
            padding: 20px;
            background: #282828;
        }

        .perf-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .perf-card {
            background: #333;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 15px;
        }

        .perf-title {
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 10px;
        }

        .perf-value {
            font-size: 2rem;
            color: white;
            font-weight: 500;
            margin-bottom: 5px;
        }

        .perf-label {
            font-size: 0.8rem;
            color: #999;
        }

        .perf-graph {
            height: 80px;
            background: #2a2a2a;
            border-radius: 4px;
            margin-top: 10px;
            position: relative;
            overflow: hidden;
        }

        /* Startup Tab */
        .tm-startup {
            padding: 0;
        }

        .startup-list {
            background: #282828;
        }

        .startup-header {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            padding: 10px 15px;
            background: #2a2a2a;
            border-bottom: 1px solid #333;
            font-size: 0.8rem;
            color: #888;
            font-weight: 500;
        }

        .startup-item {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            padding: 12px 15px;
            border-bottom: 1px solid #333;
            font-size: 0.85rem;
            color: #ccc;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .startup-item:hover {
            background: #2a2a2a;
        }

        .startup-item.selected {
            background: #0078d4;
            color: white;
        }

        .startup-status-enabled {
            color: #34d399;
        }

        .startup-status-disabled {
            color: #ef4444;
        }

        .tm-disable-btn {
            position: absolute;
            bottom: 15px;
            right: 15px;
            padding: 8px 20px;
            background: #333;
            border: 1px solid #555;
            border-radius: 4px;
            color: white;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .tm-disable-btn:hover {
            background: #3a3a3a;
        }

        .tm-disable-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Resource Monitor Window */
        .resource-monitor-window {
            width: 900px;
            height: 650px;
            top: 40px;
            left: calc(50% - 450px);
        }

        .resmon-tabs {
            display: flex;
            background: #2a2a2a;
            border-bottom: 1px solid #333;
        }

        .resmon-tab {
            padding: 10px 18px;
            font-size: 0.85rem;
            color: #999;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }

        .resmon-tab.active {
            color: white;
            border-bottom-color: #34d399;
        }

        .resmon-content {
            padding: 20px;
            background: #282828;
        }

        .disk-activity-list {
            background: #333;
            border: 1px solid #444;
            border-radius: 6px;
            margin-top: 15px;
        }

        .disk-activity-header {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            padding: 10px 15px;
            background: #2a2a2a;
            border-bottom: 1px solid #444;
            font-size: 0.8rem;
            color: #888;
        }

        .disk-activity-item {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            padding: 10px 15px;
            border-bottom: 1px solid #444;
            font-size: 0.85rem;
            color: #ccc;
        }

        /* System Information Window */
        .sysinfo-window {
            width: 800px;
            height: 600px;
            top: 60px;
            left: calc(50% - 400px);
        }

        .sysinfo-container {
            display: grid;
            grid-template-columns: 250px 1fr;
            height: 100%;
        }

        .sysinfo-tree {
            background: #2a2a2a;
            border-right: 1px solid #333;
            padding: 10px;
            overflow-y: auto;
        }

        .sysinfo-tree-item {
            padding: 8px 10px;
            font-size: 0.85rem;
            color: #ccc;
            cursor: pointer;
            border-radius: 4px;
            margin-bottom: 2px;
        }

        .sysinfo-tree-item:hover {
            background: #333;
        }

        .sysinfo-tree-item.selected {
            background: #0078d4;
            color: white;
        }

        .sysinfo-details {
            padding: 20px;
            overflow-y: auto;
        }

        .sysinfo-field {
            display: grid;
            grid-template-columns: 200px 1fr;
            padding: 8px 0;
            border-bottom: 1px solid #333;
            font-size: 0.85rem;
        }

        .sysinfo-label {
            color: #888;
        }

        .sysinfo-value {
            color: white;
        }

        /* MSConfig Window */
        .msconfig-window {
            width: 700px;
            height: 500px;
            top: 80px;
            left: calc(50% - 350px);
        }

        .msconfig-tabs {
            display: flex;
            background: #2a2a2a;
            border-bottom: 1px solid #333;
        }

        .msconfig-tab {
            padding: 10px 20px;
            font-size: 0.85rem;
            color: #999;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }

        .msconfig-tab.active {
            color: white;
            border-bottom-color: #0078d4;
        }

        .msconfig-content {
            padding: 20px;
        }

        .boot-option {
            padding: 12px;
            background: #333;
            border: 1px solid #444;
            border-radius: 6px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .boot-option input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .boot-option-label {
            flex: 1;
            font-size: 0.9rem;
            color: white;
        }

        .boot-option-desc {
            font-size: 0.75rem;
            color: #999;
            margin-top: 3px;
        }

        /* Memory Diagnostic Window */
        .memdiag-window {
            width: 600px;
            height: 400px;
            top: calc(50% - 200px);
            left: calc(50% - 300px);
        }

        .memdiag-content {
            padding: 30px;
            text-align: center;
        }

        .memdiag-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .memdiag-title {
            font-size: 1.2rem;
            color: white;
            margin-bottom: 15px;
        }

        .memdiag-text {
            font-size: 0.9rem;
            color: #ccc;
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .memdiag-btn {
            padding: 12px 30px;
            background: #0078d4;
            border: 1px solid #005a9e;
            border-radius: 6px;
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .memdiag-btn:hover {
            background: #005a9e;
        }

        /* Instructions Panel */
        .instructions-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 320px;
            background: rgba(30, 25, 40, 0.95);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 12px;
            padding: 20px;
            z-index: 100;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .instructions-title {
            font-size: 1rem;
            color: #a78bfa;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .instructions-step {
            font-size: 0.9rem;
            color: #c4b5d4;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .instructions-step code {
            background: rgba(139, 92, 246, 0.2);
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
            color: #a78bfa;
        }

        .instructions-hint {
            font-size: 0.8rem;
            color: #6b5b7e;
            font-style: italic;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(139, 92, 246, 0.15);
        }

        .verify-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.3s ease;
        }

        .verify-btn:hover {
            box-shadow: 0 5px 20px rgba(139, 92, 246, 0.3);
        }

        .verify-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Success Overlay */
        .success-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .success-overlay.active {
            display: flex;
        }

        .success-card {
            background: rgba(30, 25, 40, 0.95);
            border: 1px solid rgba(52, 211, 153, 0.3);
            border-radius: 16px;
            padding: 40px;
            text-align: center;
            max-width: 400px;
        }

        .success-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .success-title {
            font-size: 1.5rem;
            color: #34d399;
            margin-bottom: 10px;
        }

        .success-message {
            color: #c4b5d4;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .success-btn {
            padding: 12px 30px;
            background: linear-gradient(135deg, #34d399, #10b981);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .success-btn:hover {
            box-shadow: 0 5px 20px rgba(52, 211, 153, 0.3);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .lab-container {
                grid-template-columns: 1fr;
            }

            .task-panel {
                display: none;
            }

            .instructions-panel {
                position: fixed;
                bottom: 60px;
                top: auto;
                right: 10px;
                left: 10px;
                width: auto;
            }
        }
    </style>
</head>
<body>
    <header class="lab-header">
        <div class="header-left">
            <a href="../../../dashboard.html" class="back-btn">‚Üê Exit Lab</a>
            <span class="lab-title">System Tools - Hands-On Lab</span>
            <span class="lab-badge">INTERACTIVE</span>
        </div>
        <div class="task-progress">
            <span>Tasks:</span>
            <span class="task-count" id="taskProgress">0/8 Complete</span>
        </div>
    </header>

    <div class="lab-container">
        <aside class="task-panel">
            <div class="task-section">
                <div class="task-section-title">Lab Tasks</div>

                <div class="task-card active" data-task="1" onclick="selectTask(1)">
                    <div class="task-number">TASK 1</div>
                    <div class="task-name">Open Task Manager</div>
                    <div class="task-desc">Use Ctrl+Shift+Esc or right-click taskbar to open Task Manager</div>
                </div>

                <div class="task-card" data-task="2" onclick="selectTask(2)">
                    <div class="task-number">TASK 2</div>
                    <div class="task-name">End High-CPU Process</div>
                    <div class="task-desc">Find and terminate the runaway process using excessive CPU</div>
                </div>

                <div class="task-card" data-task="3" onclick="selectTask(3)">
                    <div class="task-number">TASK 3</div>
                    <div class="task-name">Check Memory Usage</div>
                    <div class="task-desc">View system memory usage in the Performance tab</div>
                </div>

                <div class="task-card" data-task="4" onclick="selectTask(4)">
                    <div class="task-number">TASK 4</div>
                    <div class="task-name">Disable Startup Program</div>
                    <div class="task-desc">Prevent a program from running at Windows startup</div>
                </div>

                <div class="task-card" data-task="5" onclick="selectTask(5)">
                    <div class="task-number">TASK 5</div>
                    <div class="task-name">Open Resource Monitor</div>
                    <div class="task-desc">Check disk activity using Resource Monitor</div>
                </div>

                <div class="task-card" data-task="6" onclick="selectTask(6)">
                    <div class="task-number">TASK 6</div>
                    <div class="task-name">Find OS Version</div>
                    <div class="task-desc">Use System Information (msinfo32) to locate OS version</div>
                </div>

                <div class="task-card" data-task="7" onclick="selectTask(7)">
                    <div class="task-number">TASK 7</div>
                    <div class="task-name">View Boot Options</div>
                    <div class="task-desc">Open msconfig and explore boot configuration settings</div>
                </div>

                <div class="task-card" data-task="8" onclick="selectTask(8)">
                    <div class="task-number">TASK 8</div>
                    <div class="task-name">Run Memory Diagnostic</div>
                    <div class="task-desc">Launch Windows Memory Diagnostic tool to check RAM</div>
                </div>
            </div>
        </aside>

        <main class="vm-panel">
            <div class="vm-toolbar">
                <div class="vm-info">
                    <div class="vm-status">
                        <span class="vm-status-dot"></span>
                        <span>Running</span>
                    </div>
                    <span class="vm-name">DESKTOP-WIN11 - Windows 11 Pro</span>
                </div>
                <div class="vm-actions">
                    <button class="vm-btn" onclick="resetVM()">üîÑ Reset VM</button>
                    <button class="vm-btn" onclick="toggleFullscreen()">‚õ∂ Fullscreen</button>
                </div>
            </div>

            <div class="vm-screen">
                <div class="windows-desktop" id="desktop">
                    <!-- Taskbar -->
                    <div class="taskbar" id="taskbar">
                        <div class="start-btn">
                            <svg viewBox="0 0 24 24">
                                <path d="M3 3h8v8H3V3zm10 0h8v8h-8V3zM3 13h8v8H3v-8zm10 0h8v8h-8v-8z"/>
                            </svg>
                        </div>
                        <div class="taskbar-apps">
                            <div class="taskbar-app" title="Task Manager">üìä</div>
                        </div>
                        <div class="system-tray">
                            <span class="system-tray-icon">üîä</span>
                            <span class="system-tray-icon">üì∂</span>
                            <div class="system-tray-time">
                                <div id="taskbarTime">2:45 PM</div>
                                <div id="taskbarDate">12/18/2025</div>
                            </div>
                        </div>
                    </div>

                    <!-- Context Menu for Taskbar -->
                    <div class="context-menu" id="taskbarContextMenu">
                        <div class="context-menu-item" onclick="openTaskManager()">Task Manager</div>
                        <div class="context-menu-separator"></div>
                        <div class="context-menu-item">Taskbar settings</div>
                    </div>

                    <!-- Task Manager Window -->
                    <div class="win-window task-manager-window" id="taskmanagerWindow">
                        <div class="win-titlebar">
                            <span class="win-icon">üìä</span>
                            <span class="win-title">Task Manager</span>
                            <div class="win-controls">
                                <span class="win-control">‚îÄ</span>
                                <span class="win-control">‚ñ°</span>
                                <span class="win-control close" onclick="closeWindow('taskmanager')">√ó</span>
                            </div>
                        </div>
                        <div class="win-content" style="padding: 0; position: relative;">
                            <div class="tm-tabs">
                                <div class="tm-tab active" onclick="switchTMTab('processes')">Processes</div>
                                <div class="tm-tab" onclick="switchTMTab('performance')">Performance</div>
                                <div class="tm-tab" onclick="switchTMTab('startup')">Startup</div>
                            </div>

                            <!-- Processes Tab -->
                            <div class="tm-tab-content active" id="processesTab">
                                <div class="tm-processes">
                                    <div class="tm-process-list">
                                        <div class="tm-process-header">
                                            <div>Name</div>
                                            <div>CPU</div>
                                            <div>Memory</div>
                                            <div>Disk</div>
                                        </div>
                                        <div class="tm-process-item" onclick="selectProcess(this)">
                                            <div>System</div>
                                            <div>0.1%</div>
                                            <div>124 MB</div>
                                            <div>0 MB/s</div>
                                        </div>
                                        <div class="tm-process-item" onclick="selectProcess(this)">
                                            <div>Windows Explorer</div>
                                            <div>0.5%</div>
                                            <div>89 MB</div>
                                            <div>0.1 MB/s</div>
                                        </div>
                                        <div class="tm-process-item high-cpu" onclick="selectProcess(this)" data-runaway="true">
                                            <div>CryptoMiner.exe</div>
                                            <div>87.3%</div>
                                            <div>512 MB</div>
                                            <div>2.4 MB/s</div>
                                        </div>
                                        <div class="tm-process-item" onclick="selectProcess(this)">
                                            <div>Microsoft Edge</div>
                                            <div>2.1%</div>
                                            <div>256 MB</div>
                                            <div>0.3 MB/s</div>
                                        </div>
                                        <div class="tm-process-item" onclick="selectProcess(this)">
                                            <div>Windows Defender</div>
                                            <div>1.2%</div>
                                            <div>178 MB</div>
                                            <div>0.8 MB/s</div>
                                        </div>
                                        <div class="tm-process-item" onclick="selectProcess(this)">
                                            <div>dwm.exe</div>
                                            <div>0.3%</div>
                                            <div>67 MB</div>
                                            <div>0 MB/s</div>
                                        </div>
                                        <div class="tm-process-item" onclick="selectProcess(this)">
                                            <div>SearchIndexer.exe</div>
                                            <div>0.8%</div>
                                            <div>145 MB</div>
                                            <div>1.2 MB/s</div>
                                        </div>
                                    </div>
                                </div>
                                <button class="tm-end-task-btn" id="endTaskBtn" disabled onclick="endTask()">End task</button>
                            </div>

                            <!-- Performance Tab -->
                            <div class="tm-tab-content" id="performanceTab">
                                <div class="tm-performance">
                                    <div class="perf-grid">
                                        <div class="perf-card">
                                            <div class="perf-title">CPU</div>
                                            <div class="perf-value">24%</div>
                                            <div class="perf-label">Intel Core i7-12700K</div>
                                            <div class="perf-graph"></div>
                                        </div>
                                        <div class="perf-card" id="memoryCard">
                                            <div class="perf-title">Memory</div>
                                            <div class="perf-value">12.4 GB</div>
                                            <div class="perf-label">78% of 16 GB</div>
                                            <div class="perf-graph"></div>
                                        </div>
                                        <div class="perf-card">
                                            <div class="perf-title">Disk 0 (C:)</div>
                                            <div class="perf-value">8%</div>
                                            <div class="perf-label">Samsung SSD 980 PRO</div>
                                            <div class="perf-graph"></div>
                                        </div>
                                        <div class="perf-card">
                                            <div class="perf-title">Network</div>
                                            <div class="perf-value">245 Kbps</div>
                                            <div class="perf-label">Ethernet</div>
                                            <div class="perf-graph"></div>
                                        </div>
                                    </div>
                                    <div style="color: #888; font-size: 0.85rem;">
                                        Click on Memory card to view detailed memory information
                                    </div>
                                </div>
                            </div>

                            <!-- Startup Tab -->
                            <div class="tm-tab-content" id="startupTab">
                                <div class="tm-startup">
                                    <div class="startup-list">
                                        <div class="startup-header">
                                            <div>Name</div>
                                            <div>Publisher</div>
                                            <div>Status</div>
                                        </div>
                                        <div class="startup-item" onclick="selectStartupItem(this)">
                                            <div>OneDrive</div>
                                            <div>Microsoft Corporation</div>
                                            <div class="startup-status-enabled">Enabled</div>
                                        </div>
                                        <div class="startup-item" onclick="selectStartupItem(this)" data-disable-target="true">
                                            <div>Adobe Creative Cloud</div>
                                            <div>Adobe Inc.</div>
                                            <div class="startup-status-enabled" id="adobeStatus">Enabled</div>
                                        </div>
                                        <div class="startup-item" onclick="selectStartupItem(this)">
                                            <div>Spotify</div>
                                            <div>Spotify AB</div>
                                            <div class="startup-status-disabled">Disabled</div>
                                        </div>
                                        <div class="startup-item" onclick="selectStartupItem(this)">
                                            <div>Steam</div>
                                            <div>Valve Corporation</div>
                                            <div class="startup-status-enabled">Enabled</div>
                                        </div>
                                        <div class="startup-item" onclick="selectStartupItem(this)">
                                            <div>Discord</div>
                                            <div>Discord Inc.</div>
                                            <div class="startup-status-enabled">Enabled</div>
                                        </div>
                                    </div>
                                </div>
                                <button class="tm-disable-btn" id="disableBtn" disabled onclick="disableStartup()">Disable</button>
                            </div>
                        </div>
                    </div>

                    <!-- Resource Monitor Window -->
                    <div class="win-window resource-monitor-window" id="resmonWindow">
                        <div class="win-titlebar">
                            <span class="win-icon">üìà</span>
                            <span class="win-title">Resource Monitor</span>
                            <div class="win-controls">
                                <span class="win-control">‚îÄ</span>
                                <span class="win-control">‚ñ°</span>
                                <span class="win-control close" onclick="closeWindow('resmon')">√ó</span>
                            </div>
                        </div>
                        <div class="win-content" style="padding: 0;">
                            <div class="resmon-tabs">
                                <div class="resmon-tab">Overview</div>
                                <div class="resmon-tab">CPU</div>
                                <div class="resmon-tab">Memory</div>
                                <div class="resmon-tab active" onclick="viewDiskActivity()">Disk</div>
                                <div class="resmon-tab">Network</div>
                            </div>
                            <div class="resmon-content">
                                <h3 style="color: white; font-size: 1rem; margin-bottom: 10px;">Disk Activity</h3>
                                <div class="disk-activity-list">
                                    <div class="disk-activity-header">
                                        <div>Process</div>
                                        <div>File</div>
                                        <div>Read (B/sec)</div>
                                        <div>Write (B/sec)</div>
                                    </div>
                                    <div class="disk-activity-item">
                                        <div>System</div>
                                        <div>C:\Windows\System32\ntoskrnl.exe</div>
                                        <div>12,456</div>
                                        <div>8,234</div>
                                    </div>
                                    <div class="disk-activity-item">
                                        <div>SearchIndexer.exe</div>
                                        <div>C:\ProgramData\Microsoft\Search</div>
                                        <div>45,678</div>
                                        <div>23,456</div>
                                    </div>
                                    <div class="disk-activity-item">
                                        <div>Chrome.exe</div>
                                        <div>C:\Users\Student\AppData\Local\Google</div>
                                        <div>34,567</div>
                                        <div>12,345</div>
                                    </div>
                                    <div class="disk-activity-item">
                                        <div>dwm.exe</div>
                                        <div>C:\Windows\System32\dwm.exe</div>
                                        <div>5,678</div>
                                        <div>2,345</div>
                                    </div>
                                </div>
                                <div style="margin-top: 20px; color: #888; font-size: 0.85rem;">
                                    Resource Monitor provides real-time monitoring of system resources including CPU, memory, disk, and network activity.
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- System Information Window -->
                    <div class="win-window sysinfo-window" id="sysinfoWindow">
                        <div class="win-titlebar">
                            <span class="win-icon">üíª</span>
                            <span class="win-title">System Information</span>
                            <div class="win-controls">
                                <span class="win-control">‚îÄ</span>
                                <span class="win-control">‚ñ°</span>
                                <span class="win-control close" onclick="closeWindow('sysinfo')">√ó</span>
                            </div>
                        </div>
                        <div class="win-content" style="padding: 0;">
                            <div class="sysinfo-container">
                                <div class="sysinfo-tree">
                                    <div class="sysinfo-tree-item selected" onclick="selectSysinfoCategory(this, 'summary')">System Summary</div>
                                    <div class="sysinfo-tree-item" onclick="selectSysinfoCategory(this, 'hardware')">Hardware Resources</div>
                                    <div class="sysinfo-tree-item" onclick="selectSysinfoCategory(this, 'components')">Components</div>
                                    <div class="sysinfo-tree-item" onclick="selectSysinfoCategory(this, 'software')">Software Environment</div>
                                </div>
                                <div class="sysinfo-details" id="sysinfoDetails">
                                    <h3 style="color: white; font-size: 1.1rem; margin-bottom: 20px;">System Summary</h3>
                                    <div class="sysinfo-field">
                                        <div class="sysinfo-label">OS Name</div>
                                        <div class="sysinfo-value" id="osName">Microsoft Windows 11 Pro</div>
                                    </div>
                                    <div class="sysinfo-field">
                                        <div class="sysinfo-label">Version</div>
                                        <div class="sysinfo-value" id="osVersion">10.0.22631 Build 22631</div>
                                    </div>
                                    <div class="sysinfo-field">
                                        <div class="sysinfo-label">System Manufacturer</div>
                                        <div class="sysinfo-value">Dell Inc.</div>
                                    </div>
                                    <div class="sysinfo-field">
                                        <div class="sysinfo-label">System Model</div>
                                        <div class="sysinfo-value">OptiPlex 7090</div>
                                    </div>
                                    <div class="sysinfo-field">
                                        <div class="sysinfo-label">Processor</div>
                                        <div class="sysinfo-value">Intel(R) Core(TM) i7-12700K @ 3.60GHz, 12 Core(s)</div>
                                    </div>
                                    <div class="sysinfo-field">
                                        <div class="sysinfo-label">Installed Physical Memory (RAM)</div>
                                        <div class="sysinfo-value">16.0 GB</div>
                                    </div>
                                    <div class="sysinfo-field">
                                        <div class="sysinfo-label">Total Physical Memory</div>
                                        <div class="sysinfo-value">16,384 MB</div>
                                    </div>
                                    <div class="sysinfo-field">
                                        <div class="sysinfo-label">Available Physical Memory</div>
                                        <div class="sysinfo-value">3,512 MB</div>
                                    </div>
                                    <div class="sysinfo-field">
                                        <div class="sysinfo-label">Total Virtual Memory</div>
                                        <div class="sysinfo-value">19,968 MB</div>
                                    </div>
                                    <div class="sysinfo-field">
                                        <div class="sysinfo-label">Page File Space</div>
                                        <div class="sysinfo-value">3,584 MB</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- MSConfig Window -->
                    <div class="win-window msconfig-window" id="msconfigWindow">
                        <div class="win-titlebar">
                            <span class="win-icon">‚öôÔ∏è</span>
                            <span class="win-title">System Configuration</span>
                            <div class="win-controls">
                                <span class="win-control">‚îÄ</span>
                                <span class="win-control">‚ñ°</span>
                                <span class="win-control close" onclick="closeWindow('msconfig')">√ó</span>
                            </div>
                        </div>
                        <div class="win-content" style="padding: 0;">
                            <div class="msconfig-tabs">
                                <div class="msconfig-tab">General</div>
                                <div class="msconfig-tab active" onclick="viewBootOptions()">Boot</div>
                                <div class="msconfig-tab">Services</div>
                                <div class="msconfig-tab">Startup</div>
                                <div class="msconfig-tab">Tools</div>
                            </div>
                            <div class="msconfig-content">
                                <h3 style="color: white; font-size: 1rem; margin-bottom: 15px;">Boot Options</h3>
                                <div class="boot-option">
                                    <input type="checkbox" id="safeBoot">
                                    <div>
                                        <div class="boot-option-label">Safe boot</div>
                                        <div class="boot-option-desc">Start Windows with minimal drivers and services</div>
                                    </div>
                                </div>
                                <div class="boot-option">
                                    <input type="checkbox" id="noGUI">
                                    <div>
                                        <div class="boot-option-label">No GUI boot</div>
                                        <div class="boot-option-desc">Do not display Windows splash screen during startup</div>
                                    </div>
                                </div>
                                <div class="boot-option">
                                    <input type="checkbox" id="bootLog">
                                    <div>
                                        <div class="boot-option-label">Boot log</div>
                                        <div class="boot-option-desc">Log all boot information to %SystemRoot%\ntbtlog.txt</div>
                                    </div>
                                </div>
                                <div class="boot-option">
                                    <input type="checkbox" id="baseVideo">
                                    <div>
                                        <div class="boot-option-label">Base video</div>
                                        <div class="boot-option-desc">Use standard VGA driver instead of GPU-specific driver</div>
                                    </div>
                                </div>
                                <div style="margin-top: 20px; color: #888; font-size: 0.85rem;">
                                    Boot timeout: <strong style="color: white;">30 seconds</strong>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Memory Diagnostic Window -->
                    <div class="win-window memdiag-window" id="memdiagWindow">
                        <div class="win-titlebar">
                            <span class="win-icon">üß™</span>
                            <span class="win-title">Windows Memory Diagnostic</span>
                            <div class="win-controls">
                                <span class="win-control close" onclick="closeWindow('memdiag')">√ó</span>
                            </div>
                        </div>
                        <div class="win-content">
                            <div class="memdiag-content">
                                <div class="memdiag-icon">üß™</div>
                                <div class="memdiag-title">Check your computer for memory problems</div>
                                <div class="memdiag-text">
                                    Memory problems can cause your computer to lose information or stop working.<br><br>
                                    To identify and repair memory problems, Windows will restart your computer. You should save your work and close any open programs.
                                </div>
                                <button class="memdiag-btn" onclick="scheduleMemoryDiagnostic()">Restart now and check for problems</button>
                            </div>
                        </div>
                    </div>

                    <!-- Instructions Panel -->
                    <div class="instructions-panel" id="instructionsPanel">
                        <div class="instructions-title">
                            üìã Task Instructions
                        </div>
                        <div class="instructions-step" id="instructionsStep">
                            Press <code>Ctrl+Shift+Esc</code> or right-click the taskbar and select <strong>Task Manager</strong> to open Task Manager.
                        </div>
                        <div class="instructions-hint" id="instructionsHint">
                            üí° Hint: Task Manager is the primary tool for monitoring system performance and managing processes
                        </div>
                        <button class="verify-btn" id="verifyBtn" onclick="verifyTask()">
                            Verify Task Completion
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Success Overlay -->
    <div class="success-overlay" id="successOverlay">
        <div class="success-card">
            <div class="success-icon">üéâ</div>
            <div class="success-title">Lab Complete!</div>
            <div class="success-message">
                You've mastered Windows System Tools! You can now use Task Manager to monitor performance and end processes, manage startup programs, check system resources with Resource Monitor, view system information, configure boot options, and run diagnostics. These are essential skills for troubleshooting and maintaining Windows systems.
            </div>
            <button class="success-btn" onclick="finishLab()">Complete Lab</button>
        </div>
    </div>

    <script>
        // State
        let currentTask = 1;
        let completedTasks = new Set();
        let taskVerification = {
            1: false, // Opened Task Manager
            2: false, // Ended high-CPU process
            3: false, // Checked memory usage
            4: false, // Disabled startup program
            5: false, // Opened Resource Monitor and viewed disk activity
            6: false, // Found OS version in System Information
            7: false, // Viewed boot options in msconfig
            8: false  // Ran Memory Diagnostic
        };

        let selectedProcess = null;
        let selectedStartupItem = null;
        let currentTMTab = 'processes';

        // Task instructions
        const taskInstructions = {
            1: {
                step: 'Press <code>Ctrl+Shift+Esc</code> or right-click the taskbar and select <strong>Task Manager</strong> to open Task Manager.',
                hint: 'üí° Hint: Task Manager is the primary tool for monitoring system performance and managing processes'
            },
            2: {
                step: 'In Task Manager, find the process <strong>CryptoMiner.exe</strong> that is using high CPU (87.3%), select it, and click <strong>End task</strong>.',
                hint: 'üí° Hint: Processes using abnormally high CPU can slow down your computer or indicate malware'
            },
            3: {
                step: 'In Task Manager, click the <strong>Performance</strong> tab, then click on the <strong>Memory</strong> card to view detailed memory usage.',
                hint: 'üí° Hint: Memory usage shows how much RAM is being used by all running programs'
            },
            4: {
                step: 'In Task Manager, go to the <strong>Startup</strong> tab, select <strong>Adobe Creative Cloud</strong>, and click <strong>Disable</strong>.',
                hint: 'üí° Hint: Disabling startup programs can significantly improve boot time'
            },
            5: {
                step: 'From Task Manager Performance tab, click <strong>Open Resource Monitor</strong> at the bottom, then click the <strong>Disk</strong> tab to view disk activity.',
                hint: 'üí° Hint: Resource Monitor provides more detailed real-time information than Task Manager'
            },
            6: {
                step: 'Press <code>Win+R</code>, type <code>msinfo32</code>, press Enter, and locate the <strong>OS Version</strong> field in System Summary.',
                hint: 'üí° Hint: System Information contains comprehensive details about your hardware and software configuration'
            },
            7: {
                step: 'Press <code>Win+R</code>, type <code>msconfig</code>, press Enter, then click the <strong>Boot</strong> tab to view boot configuration options.',
                hint: 'üí° Hint: MSConfig is used for advanced troubleshooting, including safe mode and startup configuration'
            },
            8: {
                step: 'Press <code>Win+R</code>, type <code>mdsched</code> or <code>mdsched.exe</code>, press Enter to launch Windows Memory Diagnostic.',
                hint: 'üí° Hint: Memory Diagnostic checks RAM for errors that could cause crashes or instability'
            }
        };

        // Window management
        function openWindow(windowId) {
            const win = document.getElementById(windowId + 'Window');
            if (win) {
                win.classList.add('active');

                // Track task progress
                if (windowId === 'taskmanager' && currentTask === 1) {
                    taskVerification[1] = true;
                }
                if (windowId === 'resmon' && currentTask === 5) {
                    // Will verify when disk tab is clicked
                }
                if (windowId === 'sysinfo' && currentTask === 6) {
                    // Will verify when OS version is viewed
                }
                if (windowId === 'msconfig' && currentTask === 7) {
                    // Will verify when boot tab is viewed
                }
                if (windowId === 'memdiag' && currentTask === 8) {
                    taskVerification[8] = true;
                }
            }
        }

        function closeWindow(windowId) {
            const win = document.getElementById(windowId + 'Window');
            if (win) {
                win.classList.remove('active');
            }
        }

        // Taskbar context menu
        document.getElementById('taskbar').addEventListener('contextmenu', function(e) {
            e.preventDefault();
            const menu = document.getElementById('taskbarContextMenu');
            menu.style.left = e.clientX + 'px';
            menu.style.top = e.clientY + 'px';
            menu.classList.add('active');
        });

        // Close context menu when clicking elsewhere
        document.addEventListener('click', function(e) {
            const menu = document.getElementById('taskbarContextMenu');
            if (!e.target.closest('.context-menu')) {
                menu.classList.remove('active');
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl+Shift+Esc - Task Manager
            if (e.ctrlKey && e.shiftKey && e.key === 'Escape') {
                e.preventDefault();
                openTaskManager();
            }
        });

        function openTaskManager() {
            openWindow('taskmanager');
            document.getElementById('taskbarContextMenu').classList.remove('active');
        }

        // Task Manager tabs
        function switchTMTab(tabName) {
            currentTMTab = tabName;

            // Update tab UI
            document.querySelectorAll('.tm-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');

            // Update content
            document.querySelectorAll('.tm-tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(tabName + 'Tab').classList.add('active');

            // Track task 3 (Performance tab)
            if (tabName === 'performance' && currentTask === 3) {
                // Will verify when memory card is clicked
            }
        }

        // Process selection
        function selectProcess(element) {
            document.querySelectorAll('.tm-process-item').forEach(item => item.classList.remove('selected'));
            element.classList.add('selected');
            selectedProcess = element;
            document.getElementById('endTaskBtn').disabled = false;
        }

        // End task
        function endTask() {
            if (selectedProcess && selectedProcess.dataset.runaway === 'true') {
                selectedProcess.style.opacity = '0';
                setTimeout(() => {
                    selectedProcess.remove();
                    document.getElementById('endTaskBtn').disabled = true;
                    if (currentTask === 2) {
                        taskVerification[2] = true;
                    }
                }, 300);
            } else if (selectedProcess) {
                alert('This process cannot be terminated.');
            }
        }

        // Memory card click
        document.getElementById('memoryCard').addEventListener('click', function() {
            if (currentTask === 3) {
                taskVerification[3] = true;
            }
        });

        // Startup item selection
        function selectStartupItem(element) {
            document.querySelectorAll('.startup-item').forEach(item => item.classList.remove('selected'));
            element.classList.add('selected');
            selectedStartupItem = element;

            // Enable disable button only for enabled items
            const statusElement = element.querySelector('[class^="startup-status-"]');
            const isEnabled = statusElement.classList.contains('startup-status-enabled');
            document.getElementById('disableBtn').disabled = !isEnabled;
        }

        // Disable startup
        function disableStartup() {
            if (selectedStartupItem && selectedStartupItem.dataset.disableTarget === 'true') {
                const statusElement = document.getElementById('adobeStatus');
                statusElement.textContent = 'Disabled';
                statusElement.className = 'startup-status-disabled';
                document.getElementById('disableBtn').disabled = true;
                if (currentTask === 4) {
                    taskVerification[4] = true;
                }
            } else if (selectedStartupItem) {
                const statusElement = selectedStartupItem.querySelector('[class^="startup-status-"]');
                statusElement.textContent = 'Disabled';
                statusElement.className = 'startup-status-disabled';
                document.getElementById('disableBtn').disabled = true;
            }
        }

        // Resource Monitor - Open from Performance tab
        function openResourceMonitor() {
            openWindow('resmon');
        }

        // Add button to Performance tab to open Resource Monitor
        window.addEventListener('load', function() {
            const perfTab = document.getElementById('performanceTab');
            const openResMonBtn = document.createElement('button');
            openResMonBtn.textContent = 'Open Resource Monitor';
            openResMonBtn.className = 'tm-disable-btn';
            openResMonBtn.style.position = 'absolute';
            openResMonBtn.style.bottom = '15px';
            openResMonBtn.style.left = '15px';
            openResMonBtn.onclick = openResourceMonitor;
            perfTab.appendChild(openResMonBtn);
        });

        // View disk activity
        function viewDiskActivity() {
            if (currentTask === 5) {
                taskVerification[5] = true;
            }
        }

        // System Information category selection
        function selectSysinfoCategory(element, category) {
            document.querySelectorAll('.sysinfo-tree-item').forEach(item => item.classList.remove('selected'));
            element.classList.add('selected');

            if (category === 'summary' && currentTask === 6) {
                taskVerification[6] = true;
            }
        }

        // View boot options
        function viewBootOptions() {
            if (currentTask === 7) {
                taskVerification[7] = true;
            }
        }

        // Schedule memory diagnostic
        function scheduleMemoryDiagnostic() {
            alert('Windows Memory Diagnostic scheduled. The system would normally restart to perform the memory test.');
            closeWindow('memdiag');
            if (currentTask === 8) {
                taskVerification[8] = true;
            }
        }

        // Simulate Win+R by clicking the instructions panel
        document.getElementById('instructionsPanel').addEventListener('click', function(e) {
            if (e.target.tagName === 'CODE') {
                const code = e.target.textContent.toLowerCase();
                if (code === 'ctrl+shift+esc') {
                    openTaskManager();
                } else if (code === 'win+r') {
                    // Show prompt for command
                    const cmd = prompt('Enter command:');
                    if (cmd) {
                        executeCommand(cmd);
                    }
                }
            }
        });

        function executeCommand(cmd) {
            cmd = cmd.trim().toLowerCase();

            if (cmd === 'resmon' || cmd === 'resmon.exe' || cmd === 'perfmon /res') {
                openWindow('resmon');
            } else if (cmd === 'msinfo32' || cmd === 'msinfo32.exe') {
                openWindow('sysinfo');
            } else if (cmd === 'msconfig' || cmd === 'msconfig.exe') {
                openWindow('msconfig');
            } else if (cmd === 'mdsched' || cmd === 'mdsched.exe') {
                openWindow('memdiag');
            } else if (cmd === 'taskmgr' || cmd === 'taskmgr.exe') {
                openWindow('taskmanager');
            } else {
                alert('Command not recognized: ' + cmd);
            }
        }

        // Task management
        function selectTask(taskNum) {
            currentTask = taskNum;

            // Update task cards
            document.querySelectorAll('.task-card').forEach(card => {
                card.classList.remove('active');
                if (parseInt(card.dataset.task) === taskNum) {
                    card.classList.add('active');
                }
            });

            // Update instructions
            const task = taskInstructions[taskNum];
            document.getElementById('instructionsStep').innerHTML = task.step;
            document.getElementById('instructionsHint').innerHTML = task.hint;
        }

        function verifyTask() {
            if (taskVerification[currentTask]) {
                completeTask(currentTask);
            } else {
                alert('Task not yet completed. Follow the instructions and try again.');
            }
        }

        function completeTask(taskNum) {
            completedTasks.add(taskNum);

            // Mark task as complete
            const taskCard = document.querySelector(`[data-task="${taskNum}"]`);
            taskCard.classList.add('completed');

            // Update progress
            document.getElementById('taskProgress').textContent = `${completedTasks.size}/8 Complete`;

            // Check if all tasks complete
            if (completedTasks.size === 8) {
                setTimeout(() => {
                    document.getElementById('successOverlay').classList.add('active');
                }, 500);
            } else {
                // Move to next task
                const nextTask = taskNum + 1;
                if (nextTask <= 8) {
                    selectTask(nextTask);
                }
            }
        }

        function finishLab() {
            // Save progress
            const progress = JSON.parse(localStorage.getItem('hexworth_progress') || '{}');
            progress.forge = progress.forge || {};
            progress.forge.systemToolsLab = {
                completed: true,
                tasksCompleted: completedTasks.size,
                date: new Date().toISOString()
            };
            localStorage.setItem('hexworth_progress', JSON.stringify(progress));

            window.location.href = '../../dashboard.html';
        }

        function resetVM() {
            location.reload();
        }

        function toggleFullscreen() {
            if (document.fullscreenElement) {
                document.exitFullscreen();
            } else {
                document.querySelector('.vm-screen').requestFullscreen();
            }
        }

        // Update taskbar time
        function updateTime() {
            const now = new Date();
            document.getElementById('taskbarTime').textContent = now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });
            document.getElementById('taskbarDate').textContent = now.toLocaleDateString('en-US');
        }
        setInterval(updateTime, 1000);
        updateTime();
    </script>
<script src="../../../components/FluxCapacitor.js"></script>
</body>
</html>
