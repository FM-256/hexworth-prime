<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Access Control -->
    <script src="../../../../components/AccessGuard.js"></script>
    <script>
        AccessGuard.require('sorted');
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administrative Tools Lab - House of the Forge</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: #0c0c0c;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #c4b5d4;
        }

        /* Header */
        .lab-header {
            padding: 15px 30px;
            background: rgba(10, 10, 15, 0.95);
            border-bottom: 1px solid rgba(139, 92, 246, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .back-btn {
            padding: 8px 16px;
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 6px;
            color: #a78bfa;
            text-decoration: none;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(139, 92, 246, 0.2);
        }

        .lab-title {
            font-size: 1rem;
            color: #e8d5f5;
        }

        .lab-badge {
            padding: 4px 12px;
            background: rgba(52, 211, 153, 0.15);
            border: 1px solid rgba(52, 211, 153, 0.3);
            border-radius: 12px;
            font-size: 0.7rem;
            color: #34d399;
            letter-spacing: 0.05em;
        }

        .task-progress {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 0.85rem;
            color: #8b7a9e;
        }

        .task-count {
            color: #a78bfa;
            font-weight: 500;
        }

        /* Main Layout */
        .lab-container {
            display: grid;
            grid-template-columns: 350px 1fr;
            height: calc(100vh - 60px);
        }

        /* Task Panel */
        .task-panel {
            background: rgba(15, 12, 20, 0.95);
            border-right: 1px solid rgba(139, 92, 246, 0.15);
            overflow-y: auto;
            padding: 20px;
        }

        .task-section {
            margin-bottom: 25px;
        }

        .task-section-title {
            font-size: 0.7rem;
            color: #6b5b7e;
            letter-spacing: 0.15em;
            margin-bottom: 12px;
            text-transform: uppercase;
        }

        .task-card {
            background: rgba(25, 20, 35, 0.8);
            border: 1px solid rgba(139, 92, 246, 0.15);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .task-card:hover {
            border-color: rgba(139, 92, 246, 0.4);
        }

        .task-card.active {
            border-color: #a78bfa;
            background: rgba(139, 92, 246, 0.1);
        }

        .task-card.completed {
            border-color: rgba(52, 211, 153, 0.3);
        }

        .task-card.completed::before {
            content: '‚úì';
            float: right;
            color: #34d399;
            font-weight: bold;
        }

        .task-number {
            font-size: 0.7rem;
            color: #a78bfa;
            margin-bottom: 5px;
        }

        .task-name {
            font-size: 0.95rem;
            color: #e8d5f5;
            margin-bottom: 5px;
        }

        .task-desc {
            font-size: 0.8rem;
            color: #8b7a9e;
            line-height: 1.5;
        }

        /* VM Panel */
        .vm-panel {
            display: flex;
            flex-direction: column;
            background: #0a0a0a;
        }

        .vm-toolbar {
            padding: 10px 20px;
            background: rgba(20, 15, 30, 0.9);
            border-bottom: 1px solid rgba(139, 92, 246, 0.15);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .vm-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .vm-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.8rem;
            color: #34d399;
        }

        .vm-status-dot {
            width: 8px;
            height: 8px;
            background: #34d399;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .vm-name {
            font-size: 0.85rem;
            color: #c4b5d4;
        }

        .vm-actions {
            display: flex;
            gap: 10px;
        }

        .vm-btn {
            padding: 6px 14px;
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 5px;
            color: #a78bfa;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .vm-btn:hover {
            background: rgba(139, 92, 246, 0.2);
        }

        /* VM Screen */
        .vm-screen {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        /* Windows Desktop Simulation */
        .windows-desktop {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0078d4 0%, #001a4d 100%);
            position: relative;
        }

        /* Windows Taskbar */
        .taskbar {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 48px;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            padding: 0 10px;
            z-index: 50;
        }

        .start-btn {
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .start-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .start-btn svg {
            width: 24px;
            height: 24px;
            fill: white;
        }

        .taskbar-apps {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-left: 10px;
        }

        .taskbar-app {
            width: 44px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border-radius: 4px;
            font-size: 1.2rem;
            transition: background 0.2s ease;
        }

        .taskbar-app:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .taskbar-app.active {
            background: rgba(255, 255, 255, 0.15);
            border-bottom: 3px solid #0078d4;
        }

        .system-tray {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 0 15px;
            height: 100%;
            color: white;
            font-size: 0.75rem;
        }

        .system-tray-time {
            text-align: right;
            line-height: 1.3;
        }

        /* Windows Window */
        .win-window {
            position: absolute;
            background: #202020;
            border-radius: 8px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            display: none;
        }

        .win-window.active {
            display: block;
        }

        .win-titlebar {
            height: 32px;
            background: #1f1f1f;
            display: flex;
            align-items: center;
            padding: 0 10px;
            cursor: move;
        }

        .win-icon {
            width: 16px;
            height: 16px;
            margin-right: 8px;
        }

        .win-title {
            flex: 1;
            font-size: 0.8rem;
            color: white;
        }

        .win-controls {
            display: flex;
            gap: 0;
        }

        .win-control {
            width: 46px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .win-control:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .win-control.close:hover {
            background: #e81123;
        }

        .win-content {
            background: #282828;
            color: white;
            padding: 20px;
            overflow-y: auto;
        }

        /* Run Dialog */
        .run-window {
            width: 450px;
            height: 200px;
            top: calc(50% - 100px);
            left: calc(50% - 225px);
        }

        .run-content {
            padding: 20px;
        }

        .run-label {
            font-size: 0.9rem;
            color: #ccc;
            margin-bottom: 10px;
        }

        .run-input-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .run-input {
            flex: 1;
            padding: 8px 12px;
            background: #1a1a1a;
            border: 1px solid #444;
            border-radius: 4px;
            color: white;
            font-size: 0.9rem;
            outline: none;
        }

        .run-input:focus {
            border-color: #0078d4;
        }

        .run-browse-btn {
            padding: 8px 20px;
            background: #333;
            border: 1px solid #555;
            border-radius: 4px;
            color: white;
            font-size: 0.85rem;
            cursor: pointer;
        }

        .run-browse-btn:hover {
            background: #444;
        }

        .run-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .run-btn {
            padding: 8px 24px;
            border: 1px solid #555;
            border-radius: 4px;
            color: white;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .run-btn.primary {
            background: #0078d4;
            border-color: #0078d4;
        }

        .run-btn.primary:hover {
            background: #005a9e;
        }

        .run-btn.secondary {
            background: #333;
        }

        .run-btn.secondary:hover {
            background: #444;
        }

        /* MMC Console Window */
        .mmc-window {
            width: 900px;
            height: 600px;
            top: 50px;
            left: calc(50% - 450px);
        }

        .mmc-menubar {
            background: #2a2a2a;
            padding: 5px 10px;
            border-bottom: 1px solid #333;
            display: flex;
            gap: 15px;
        }

        .mmc-menu-item {
            padding: 5px 10px;
            font-size: 0.85rem;
            color: #ccc;
            cursor: pointer;
            border-radius: 3px;
        }

        .mmc-menu-item:hover {
            background: #333;
        }

        .mmc-toolbar {
            background: #252525;
            padding: 8px 10px;
            border-bottom: 1px solid #333;
            display: flex;
            gap: 5px;
        }

        .mmc-toolbar-btn {
            padding: 5px 10px;
            background: #333;
            border: 1px solid #444;
            border-radius: 3px;
            color: #ccc;
            font-size: 0.8rem;
            cursor: pointer;
        }

        .mmc-toolbar-btn:hover {
            background: #3a3a3a;
        }

        .mmc-container {
            display: flex;
            height: calc(100% - 32px - 40px - 35px);
        }

        .mmc-tree-panel {
            width: 250px;
            background: #2a2a2a;
            border-right: 1px solid #333;
            padding: 10px;
            overflow-y: auto;
        }

        .mmc-tree-title {
            font-size: 0.75rem;
            color: #888;
            margin-bottom: 8px;
            padding-left: 5px;
        }

        .mmc-tree-item {
            padding: 6px 8px;
            font-size: 0.85rem;
            color: #ccc;
            cursor: pointer;
            border-radius: 4px;
            margin-bottom: 2px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .mmc-tree-item:hover {
            background: #333;
        }

        .mmc-tree-item.selected {
            background: #0078d4;
            color: white;
        }

        .mmc-tree-item.expandable::before {
            content: '‚ñ∂';
            font-size: 0.6rem;
            transition: transform 0.2s ease;
        }

        .mmc-tree-item.expanded::before {
            transform: rotate(90deg);
        }

        .mmc-tree-item.child {
            padding-left: 30px;
        }

        .mmc-main-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .mmc-details-header {
            background: #252525;
            padding: 10px 15px;
            border-bottom: 1px solid #333;
            font-size: 1rem;
            color: white;
            font-weight: 500;
        }

        .mmc-list-view {
            flex: 1;
            overflow-y: auto;
        }

        .mmc-list-header {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            padding: 8px 15px;
            background: #2a2a2a;
            border-bottom: 1px solid #333;
            font-size: 0.8rem;
            color: #888;
            font-weight: 500;
        }

        .mmc-list-item {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            padding: 10px 15px;
            border-bottom: 1px solid #333;
            font-size: 0.85rem;
            color: #ccc;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .mmc-list-item:hover {
            background: #2a2a2a;
        }

        .mmc-list-item.selected {
            background: #0078d4;
            color: white;
        }

        .mmc-status-running {
            color: #34d399;
        }

        .mmc-status-stopped {
            color: #ef4444;
        }

        /* Event Viewer specific */
        .event-level {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .event-level.information {
            background: rgba(59, 130, 246, 0.2);
            color: #60a5fa;
        }

        .event-level.warning {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
        }

        .event-level.error {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        /* Disk Management Window */
        .disk-mgmt-window {
            width: 850px;
            height: 550px;
            top: 60px;
            left: calc(50% - 425px);
        }

        .disk-volume-view {
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding: 20px;
        }

        .disk-item {
            border: 1px solid #444;
            border-radius: 6px;
            overflow: hidden;
        }

        .disk-header {
            background: #2a2a2a;
            padding: 10px 15px;
            font-size: 0.9rem;
            color: white;
            font-weight: 500;
        }

        .disk-partitions {
            display: flex;
            height: 60px;
        }

        .partition {
            display: flex;
            align-items: center;
            justify-content: center;
            border-right: 2px solid #1a1a1a;
            font-size: 0.8rem;
            color: white;
            font-weight: 500;
            cursor: pointer;
            transition: opacity 0.2s ease;
        }

        .partition:hover {
            opacity: 0.8;
        }

        .partition.system {
            background: #0078d4;
        }

        .partition.primary {
            background: #1e3a8a;
        }

        .partition.data {
            background: #15803d;
        }

        .partition.unallocated {
            background: #333;
            background-image: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 10px,
                rgba(0,0,0,0.2) 10px,
                rgba(0,0,0,0.2) 20px
            );
        }

        .partition-info {
            padding: 10px 15px;
            background: #252525;
            border-top: 1px solid #333;
            font-size: 0.8rem;
            color: #999;
        }

        /* Task Scheduler Window */
        .task-scheduler-window {
            width: 850px;
            height: 600px;
            top: 50px;
            left: calc(50% - 425px);
        }

        .task-scheduler-container {
            display: grid;
            grid-template-columns: 200px 1fr 250px;
            height: 100%;
        }

        .task-scheduler-tree {
            background: #2a2a2a;
            border-right: 1px solid #333;
            padding: 10px;
            overflow-y: auto;
        }

        .task-scheduler-main {
            padding: 20px;
            overflow-y: auto;
        }

        .task-scheduler-actions {
            background: #252525;
            border-left: 1px solid #333;
            padding: 15px;
            overflow-y: auto;
        }

        .actions-title {
            font-size: 0.85rem;
            color: #888;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .action-link {
            display: block;
            padding: 8px 10px;
            color: #60a5fa;
            font-size: 0.85rem;
            cursor: pointer;
            border-radius: 4px;
            margin-bottom: 5px;
        }

        .action-link:hover {
            background: rgba(96, 165, 250, 0.1);
        }

        .scheduled-task-item {
            padding: 12px 15px;
            background: #333;
            border: 1px solid #444;
            border-radius: 6px;
            margin-bottom: 10px;
        }

        .task-item-name {
            font-size: 0.9rem;
            color: white;
            margin-bottom: 5px;
        }

        .task-item-status {
            font-size: 0.8rem;
            color: #34d399;
            margin-bottom: 3px;
        }

        .task-item-trigger {
            font-size: 0.75rem;
            color: #999;
        }

        /* Service Properties Dialog */
        .service-dialog {
            width: 500px;
            height: 400px;
            top: calc(50% - 200px);
            left: calc(50% - 250px);
        }

        .service-tabs {
            display: flex;
            background: #2a2a2a;
            border-bottom: 1px solid #333;
        }

        .service-tab {
            padding: 10px 20px;
            font-size: 0.85rem;
            color: #999;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }

        .service-tab.active {
            color: white;
            border-bottom-color: #0078d4;
        }

        .service-tab-content {
            padding: 20px;
        }

        .service-field {
            margin-bottom: 15px;
        }

        .service-field-label {
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 5px;
        }

        .service-field-value {
            padding: 8px 12px;
            background: #1a1a1a;
            border: 1px solid #444;
            border-radius: 4px;
            color: white;
            font-size: 0.85rem;
            width: 100%;
        }

        .service-controls {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .service-control-btn {
            padding: 8px 16px;
            background: #333;
            border: 1px solid #555;
            border-radius: 4px;
            color: white;
            font-size: 0.85rem;
            cursor: pointer;
        }

        .service-control-btn:hover {
            background: #3a3a3a;
        }

        .service-control-btn.primary {
            background: #0078d4;
            border-color: #0078d4;
        }

        .service-control-btn.primary:hover {
            background: #005a9e;
        }

        .service-control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Custom MMC Console Builder */
        .mmc-builder-window {
            width: 800px;
            height: 550px;
            top: 60px;
            left: calc(50% - 400px);
        }

        .mmc-builder-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            height: calc(100% - 32px - 50px);
            gap: 20px;
            padding: 20px;
        }

        .snapin-available {
            border: 1px solid #444;
            border-radius: 6px;
            overflow: hidden;
        }

        .snapin-panel-title {
            background: #2a2a2a;
            padding: 10px 15px;
            font-size: 0.9rem;
            color: white;
            font-weight: 500;
        }

        .snapin-list {
            max-height: 350px;
            overflow-y: auto;
        }

        .snapin-item {
            padding: 12px 15px;
            border-bottom: 1px solid #333;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .snapin-item:hover {
            background: #2a2a2a;
        }

        .snapin-item.selected {
            background: #0078d4;
        }

        .snapin-item-name {
            font-size: 0.9rem;
            color: white;
            margin-bottom: 3px;
        }

        .snapin-item-desc {
            font-size: 0.75rem;
            color: #999;
        }

        .mmc-builder-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            padding: 15px;
            border-top: 1px solid #333;
        }

        /* Instructions Panel */
        .instructions-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 320px;
            background: rgba(30, 25, 40, 0.95);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 12px;
            padding: 20px;
            z-index: 100;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .instructions-title {
            font-size: 1rem;
            color: #a78bfa;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .instructions-step {
            font-size: 0.9rem;
            color: #c4b5d4;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .instructions-step code {
            background: rgba(139, 92, 246, 0.2);
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
            color: #a78bfa;
        }

        .instructions-hint {
            font-size: 0.8rem;
            color: #6b5b7e;
            font-style: italic;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(139, 92, 246, 0.15);
        }

        .verify-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.3s ease;
        }

        .verify-btn:hover {
            box-shadow: 0 5px 20px rgba(139, 92, 246, 0.3);
        }

        .verify-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Success Overlay */
        .success-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .success-overlay.active {
            display: flex;
        }

        .success-card {
            background: rgba(30, 25, 40, 0.95);
            border: 1px solid rgba(52, 211, 153, 0.3);
            border-radius: 16px;
            padding: 40px;
            text-align: center;
            max-width: 400px;
        }

        .success-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .success-title {
            font-size: 1.5rem;
            color: #34d399;
            margin-bottom: 10px;
        }

        .success-message {
            color: #c4b5d4;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .success-btn {
            padding: 12px 30px;
            background: linear-gradient(135deg, #34d399, #10b981);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .success-btn:hover {
            box-shadow: 0 5px 20px rgba(52, 211, 153, 0.3);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .lab-container {
                grid-template-columns: 1fr;
            }

            .task-panel {
                display: none;
            }

            .instructions-panel {
                position: fixed;
                bottom: 60px;
                top: auto;
                right: 10px;
                left: 10px;
                width: auto;
            }
        }
    </style>
</head>
<body>
    <header class="lab-header">
        <div class="header-left">
            <a href="../../dashboard.html" class="back-btn">‚Üê Exit Lab</a>
            <span class="lab-title">Administrative Tools - Hands-On Lab</span>
            <span class="lab-badge">INTERACTIVE</span>
        </div>
        <div class="task-progress">
            <span>Tasks:</span>
            <span class="task-count" id="taskProgress">0/8 Complete</span>
        </div>
    </header>

    <div class="lab-container">
        <aside class="task-panel">
            <div class="task-section">
                <div class="task-section-title">Lab Tasks</div>

                <div class="task-card active" data-task="1" onclick="selectTask(1)">
                    <div class="task-number">TASK 1</div>
                    <div class="task-name">Open Computer Management</div>
                    <div class="task-desc">Use compmgmt.msc to open the Computer Management console</div>
                </div>

                <div class="task-card" data-task="2" onclick="selectTask(2)">
                    <div class="task-number">TASK 2</div>
                    <div class="task-name">Navigate to Device Manager</div>
                    <div class="task-desc">Find Device Manager within Computer Management tree</div>
                </div>

                <div class="task-card" data-task="3" onclick="selectTask(3)">
                    <div class="task-number">TASK 3</div>
                    <div class="task-name">Open Event Viewer</div>
                    <div class="task-desc">Access Event Viewer and view Application logs</div>
                </div>

                <div class="task-card" data-task="4" onclick="selectTask(4)">
                    <div class="task-number">TASK 4</div>
                    <div class="task-name">Find Windows Update Service</div>
                    <div class="task-desc">Navigate to Services and locate Windows Update</div>
                </div>

                <div class="task-card" data-task="5" onclick="selectTask(5)">
                    <div class="task-number">TASK 5</div>
                    <div class="task-name">Stop and Start a Service</div>
                    <div class="task-desc">Simulate stopping and starting the Print Spooler service</div>
                </div>

                <div class="task-card" data-task="6" onclick="selectTask(6)">
                    <div class="task-number">TASK 6</div>
                    <div class="task-name">Open Disk Management</div>
                    <div class="task-desc">View disk partitions using diskmgmt.msc</div>
                </div>

                <div class="task-card" data-task="7" onclick="selectTask(7)">
                    <div class="task-number">TASK 7</div>
                    <div class="task-name">View Task Scheduler</div>
                    <div class="task-desc">Open Task Scheduler and explore scheduled tasks</div>
                </div>

                <div class="task-card" data-task="8" onclick="selectTask(8)">
                    <div class="task-number">TASK 8</div>
                    <div class="task-name">Create Custom MMC Console</div>
                    <div class="task-desc">Build a custom console with 2 snap-ins</div>
                </div>
            </div>
        </aside>

        <main class="vm-panel">
            <div class="vm-toolbar">
                <div class="vm-info">
                    <div class="vm-status">
                        <span class="vm-status-dot"></span>
                        <span>Running</span>
                    </div>
                    <span class="vm-name">SERVER-01 - Windows Server 2022</span>
                </div>
                <div class="vm-actions">
                    <button class="vm-btn" onclick="resetVM()">üîÑ Reset VM</button>
                    <button class="vm-btn" onclick="toggleFullscreen()">‚õ∂ Fullscreen</button>
                </div>
            </div>

            <div class="vm-screen">
                <div class="windows-desktop" id="desktop">
                    <!-- Taskbar -->
                    <div class="taskbar">
                        <div class="start-btn" onclick="toggleStartMenu()">
                            <svg viewBox="0 0 24 24">
                                <path d="M3 3h8v8H3V3zm10 0h8v8h-8V3zM3 13h8v8H3v-8zm10 0h8v8h-8v-8z"/>
                            </svg>
                        </div>
                        <div class="taskbar-apps">
                            <div class="taskbar-app" onclick="openWindow('compmgmt')" title="Computer Management">üñ•Ô∏è</div>
                        </div>
                        <div class="system-tray">
                            <div class="system-tray-time">
                                <div id="taskbarTime">10:30 AM</div>
                                <div id="taskbarDate">12/18/2025</div>
                            </div>
                        </div>
                    </div>

                    <!-- Run Dialog -->
                    <div class="win-window run-window" id="runWindow">
                        <div class="win-titlebar">
                            <span class="win-icon">‚ñ∂Ô∏è</span>
                            <span class="win-title">Run</span>
                            <div class="win-controls">
                                <span class="win-control close" onclick="closeWindow('run')">√ó</span>
                            </div>
                        </div>
                        <div class="win-content run-content">
                            <div class="run-label">Type the name of a program, folder, document, or Internet resource, and Windows will open it for you.</div>
                            <div class="run-input-container">
                                <input type="text" class="run-input" id="runInput" placeholder="Enter command..." onkeypress="handleRunKey(event)">
                                <button class="run-browse-btn">Browse...</button>
                            </div>
                            <div class="run-actions">
                                <button class="run-btn primary" onclick="executeRunCommand()">OK</button>
                                <button class="run-btn secondary" onclick="closeWindow('run')">Cancel</button>
                            </div>
                        </div>
                    </div>

                    <!-- Computer Management Window -->
                    <div class="win-window mmc-window" id="compmgmtWindow">
                        <div class="win-titlebar">
                            <span class="win-icon">üñ•Ô∏è</span>
                            <span class="win-title">Computer Management</span>
                            <div class="win-controls">
                                <span class="win-control">‚îÄ</span>
                                <span class="win-control">‚ñ°</span>
                                <span class="win-control close" onclick="closeWindow('compmgmt')">√ó</span>
                            </div>
                        </div>
                        <div class="win-content" style="padding: 0;">
                            <div class="mmc-menubar">
                                <div class="mmc-menu-item">File</div>
                                <div class="mmc-menu-item">Action</div>
                                <div class="mmc-menu-item">View</div>
                                <div class="mmc-menu-item">Help</div>
                            </div>
                            <div class="mmc-toolbar">
                                <div class="mmc-toolbar-btn">‚óÄ</div>
                                <div class="mmc-toolbar-btn">‚ñ∂</div>
                                <div class="mmc-toolbar-btn">‚ü≥</div>
                            </div>
                            <div class="mmc-container">
                                <div class="mmc-tree-panel">
                                    <div class="mmc-tree-title">Console Root</div>
                                    <div class="mmc-tree-item expandable expanded selected" onclick="toggleTreeItem(this)" data-view="root">Computer Management (Local)</div>
                                    <div class="mmc-tree-item child expandable" onclick="toggleTreeItem(this); showMMCView('system-tools')">System Tools</div>
                                    <div class="mmc-tree-item child" style="padding-left: 50px; display: none;" onclick="showMMCView('task-scheduler')">Task Scheduler</div>
                                    <div class="mmc-tree-item child" style="padding-left: 50px; display: none;" onclick="showMMCView('event-viewer')">Event Viewer</div>
                                    <div class="mmc-tree-item child" style="padding-left: 50px; display: none;" onclick="showMMCView('device-manager')">Device Manager</div>
                                    <div class="mmc-tree-item child expandable" onclick="toggleTreeItem(this); showMMCView('storage')">Storage</div>
                                    <div class="mmc-tree-item child" style="padding-left: 50px; display: none;" onclick="showMMCView('disk-management')">Disk Management</div>
                                    <div class="mmc-tree-item child expandable" onclick="toggleTreeItem(this); showMMCView('services')">Services and Applications</div>
                                    <div class="mmc-tree-item child" style="padding-left: 50px; display: none;" onclick="showMMCView('services-list')">Services</div>
                                </div>
                                <div class="mmc-main-panel">
                                    <div class="mmc-details-header" id="mmcViewTitle">Computer Management (Local)</div>
                                    <div class="mmc-list-view" id="mmcMainContent">
                                        <div style="padding: 30px; text-align: center; color: #999;">
                                            <p style="font-size: 1.2rem; margin-bottom: 10px;">Computer Management</p>
                                            <p style="font-size: 0.85rem;">Expand the tree on the left to access system tools, storage, and services.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Event Viewer Window -->
                    <div class="win-window mmc-window" id="eventviewerWindow">
                        <div class="win-titlebar">
                            <span class="win-icon">üìã</span>
                            <span class="win-title">Event Viewer</span>
                            <div class="win-controls">
                                <span class="win-control">‚îÄ</span>
                                <span class="win-control">‚ñ°</span>
                                <span class="win-control close" onclick="closeWindow('eventviewer')">√ó</span>
                            </div>
                        </div>
                        <div class="win-content" style="padding: 0;">
                            <div class="mmc-menubar">
                                <div class="mmc-menu-item">File</div>
                                <div class="mmc-menu-item">Action</div>
                                <div class="mmc-menu-item">View</div>
                                <div class="mmc-menu-item">Help</div>
                            </div>
                            <div class="mmc-container">
                                <div class="mmc-tree-panel">
                                    <div class="mmc-tree-title">Event Viewer (Local)</div>
                                    <div class="mmc-tree-item expandable expanded">Windows Logs</div>
                                    <div class="mmc-tree-item child selected" onclick="showEventLog('application')">Application</div>
                                    <div class="mmc-tree-item child" onclick="showEventLog('security')">Security</div>
                                    <div class="mmc-tree-item child" onclick="showEventLog('system')">System</div>
                                </div>
                                <div class="mmc-main-panel">
                                    <div class="mmc-details-header">Application</div>
                                    <div class="mmc-list-view">
                                        <div class="mmc-list-header">
                                            <div>Source</div>
                                            <div>Event ID</div>
                                            <div>Level</div>
                                            <div>Date/Time</div>
                                        </div>
                                        <div class="mmc-list-item">
                                            <div>Windows</div>
                                            <div>1000</div>
                                            <div><span class="event-level information">Information</span></div>
                                            <div>12/18/2025 09:15:32</div>
                                        </div>
                                        <div class="mmc-list-item">
                                            <div>Application Error</div>
                                            <div>1002</div>
                                            <div><span class="event-level warning">Warning</span></div>
                                            <div>12/18/2025 08:45:12</div>
                                        </div>
                                        <div class="mmc-list-item">
                                            <div>MSI Installer</div>
                                            <div>11707</div>
                                            <div><span class="event-level information">Information</span></div>
                                            <div>12/17/2025 16:22:05</div>
                                        </div>
                                        <div class="mmc-list-item">
                                            <div>Windows Update</div>
                                            <div>19</div>
                                            <div><span class="event-level information">Information</span></div>
                                            <div>12/17/2025 14:30:45</div>
                                        </div>
                                        <div class="mmc-list-item">
                                            <div>Application Hang</div>
                                            <div>1002</div>
                                            <div><span class="event-level error">Error</span></div>
                                            <div>12/16/2025 11:18:22</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Services Window -->
                    <div class="win-window mmc-window" id="servicesWindow">
                        <div class="win-titlebar">
                            <span class="win-icon">‚öôÔ∏è</span>
                            <span class="win-title">Services</span>
                            <div class="win-controls">
                                <span class="win-control">‚îÄ</span>
                                <span class="win-control">‚ñ°</span>
                                <span class="win-control close" onclick="closeWindow('services')">√ó</span>
                            </div>
                        </div>
                        <div class="win-content" style="padding: 0;">
                            <div class="mmc-menubar">
                                <div class="mmc-menu-item">File</div>
                                <div class="mmc-menu-item">Action</div>
                                <div class="mmc-menu-item">View</div>
                                <div class="mmc-menu-item">Help</div>
                            </div>
                            <div class="mmc-container">
                                <div class="mmc-tree-panel">
                                    <div class="mmc-tree-title">Services (Local)</div>
                                    <div class="mmc-tree-item selected">Services</div>
                                </div>
                                <div class="mmc-main-panel">
                                    <div class="mmc-details-header">Services</div>
                                    <div class="mmc-list-view">
                                        <div class="mmc-list-header">
                                            <div>Name</div>
                                            <div>Status</div>
                                            <div>Startup Type</div>
                                            <div>Log On As</div>
                                        </div>
                                        <div class="mmc-list-item">
                                            <div>Application Experience</div>
                                            <div class="mmc-status-running">Running</div>
                                            <div>Manual</div>
                                            <div>Local System</div>
                                        </div>
                                        <div class="mmc-list-item">
                                            <div>DHCP Client</div>
                                            <div class="mmc-status-running">Running</div>
                                            <div>Automatic</div>
                                            <div>Local Service</div>
                                        </div>
                                        <div class="mmc-list-item" ondblclick="openServiceDialog('printspooler')">
                                            <div>Print Spooler</div>
                                            <div class="mmc-status-running" id="printSpoolerStatus">Running</div>
                                            <div>Automatic</div>
                                            <div>Local System</div>
                                        </div>
                                        <div class="mmc-list-item">
                                            <div>Remote Desktop Services</div>
                                            <div class="mmc-status-running">Running</div>
                                            <div>Automatic</div>
                                            <div>Local System</div>
                                        </div>
                                        <div class="mmc-list-item">
                                            <div>Windows Defender Firewall</div>
                                            <div class="mmc-status-running">Running</div>
                                            <div>Automatic</div>
                                            <div>Local Service</div>
                                        </div>
                                        <div class="mmc-list-item">
                                            <div>Windows Search</div>
                                            <div class="mmc-status-running">Running</div>
                                            <div>Automatic</div>
                                            <div>Local System</div>
                                        </div>
                                        <div class="mmc-list-item" onclick="selectService('windowsupdate')">
                                            <div>Windows Update</div>
                                            <div class="mmc-status-running">Running</div>
                                            <div>Manual</div>
                                            <div>Local System</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Service Properties Dialog -->
                    <div class="win-window service-dialog" id="servicedialogWindow">
                        <div class="win-titlebar">
                            <span class="win-icon">‚öôÔ∏è</span>
                            <span class="win-title">Print Spooler Properties</span>
                            <div class="win-controls">
                                <span class="win-control close" onclick="closeWindow('servicedialog')">√ó</span>
                            </div>
                        </div>
                        <div class="win-content" style="padding: 0;">
                            <div class="service-tabs">
                                <div class="service-tab active">General</div>
                                <div class="service-tab">Log On</div>
                                <div class="service-tab">Recovery</div>
                                <div class="service-tab">Dependencies</div>
                            </div>
                            <div class="service-tab-content">
                                <div class="service-field">
                                    <div class="service-field-label">Service name:</div>
                                    <div class="service-field-value">Spooler</div>
                                </div>
                                <div class="service-field">
                                    <div class="service-field-label">Display name:</div>
                                    <div class="service-field-value">Print Spooler</div>
                                </div>
                                <div class="service-field">
                                    <div class="service-field-label">Service status:</div>
                                    <div class="service-field-value" id="serviceDialogStatus">Running</div>
                                </div>
                                <div class="service-controls">
                                    <button class="service-control-btn" id="startServiceBtn" onclick="startService()" disabled>Start</button>
                                    <button class="service-control-btn" id="stopServiceBtn" onclick="stopService()">Stop</button>
                                    <button class="service-control-btn" onclick="pauseService()" disabled>Pause</button>
                                    <button class="service-control-btn" onclick="resumeService()" disabled>Resume</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Disk Management Window -->
                    <div class="win-window disk-mgmt-window" id="diskmgmtWindow">
                        <div class="win-titlebar">
                            <span class="win-icon">üíæ</span>
                            <span class="win-title">Disk Management</span>
                            <div class="win-controls">
                                <span class="win-control">‚îÄ</span>
                                <span class="win-control">‚ñ°</span>
                                <span class="win-control close" onclick="closeWindow('diskmgmt')">√ó</span>
                            </div>
                        </div>
                        <div class="win-content">
                            <div class="disk-volume-view">
                                <div class="disk-item">
                                    <div class="disk-header">Disk 0 - 500 GB - Online</div>
                                    <div class="disk-partitions">
                                        <div class="partition system" style="width: 10%;" title="System Reserved - 500 MB">
                                            System<br>500 MB
                                        </div>
                                        <div class="partition primary" style="width: 50%;" title="C: - Windows - 250 GB">
                                            C:<br>250 GB<br>NTFS
                                        </div>
                                        <div class="partition data" style="width: 30%;" title="D: - Data - 150 GB">
                                            D:<br>150 GB<br>NTFS
                                        </div>
                                        <div class="partition unallocated" style="width: 10%;" title="Unallocated - 50 GB">
                                            Unallocated<br>50 GB
                                        </div>
                                    </div>
                                    <div class="partition-info">
                                        MBR - Basic - 500 GB - 450 GB Free
                                    </div>
                                </div>

                                <div class="disk-item">
                                    <div class="disk-header">Disk 1 - 1 TB - Online</div>
                                    <div class="disk-partitions">
                                        <div class="partition data" style="width: 100%;" title="E: - Storage - 1 TB">
                                            E:<br>1 TB<br>NTFS
                                        </div>
                                    </div>
                                    <div class="partition-info">
                                        GPT - Basic - 1 TB - 650 GB Free
                                    </div>
                                </div>

                                <div class="disk-item">
                                    <div class="disk-header">Disk 2 - 256 GB - Online (SSD)</div>
                                    <div class="disk-partitions">
                                        <div class="partition primary" style="width: 70%;" title="F: - Programs - 179.2 GB">
                                            F:<br>179.2 GB<br>NTFS
                                        </div>
                                        <div class="partition unallocated" style="width: 30%;" title="Unallocated - 76.8 GB">
                                            Unallocated<br>76.8 GB
                                        </div>
                                    </div>
                                    <div class="partition-info">
                                        GPT - Basic - 256 GB - 120 GB Free
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Task Scheduler Window -->
                    <div class="win-window task-scheduler-window" id="taskschedulerWindow">
                        <div class="win-titlebar">
                            <span class="win-icon">üìÖ</span>
                            <span class="win-title">Task Scheduler</span>
                            <div class="win-controls">
                                <span class="win-control">‚îÄ</span>
                                <span class="win-control">‚ñ°</span>
                                <span class="win-control close" onclick="closeWindow('taskscheduler')">√ó</span>
                            </div>
                        </div>
                        <div class="win-content" style="padding: 0;">
                            <div class="mmc-menubar">
                                <div class="mmc-menu-item">File</div>
                                <div class="mmc-menu-item">Action</div>
                                <div class="mmc-menu-item">View</div>
                                <div class="mmc-menu-item">Help</div>
                            </div>
                            <div class="task-scheduler-container">
                                <div class="task-scheduler-tree">
                                    <div class="mmc-tree-item expandable expanded selected">Task Scheduler Library</div>
                                    <div class="mmc-tree-item child">Microsoft</div>
                                    <div class="mmc-tree-item child">Custom Tasks</div>
                                </div>
                                <div class="task-scheduler-main">
                                    <h3 style="font-size: 1rem; color: white; margin-bottom: 20px;">Active Tasks</h3>
                                    <div class="scheduled-task-item">
                                        <div class="task-item-name">System Backup</div>
                                        <div class="task-item-status">Ready</div>
                                        <div class="task-item-trigger">Daily at 2:00 AM</div>
                                    </div>
                                    <div class="scheduled-task-item">
                                        <div class="task-item-name">Windows Update Check</div>
                                        <div class="task-item-status">Running</div>
                                        <div class="task-item-trigger">Daily at 3:00 AM</div>
                                    </div>
                                    <div class="scheduled-task-item">
                                        <div class="task-item-name">Disk Cleanup</div>
                                        <div class="task-item-status">Ready</div>
                                        <div class="task-item-trigger">Weekly on Sunday at 1:00 AM</div>
                                    </div>
                                    <div class="scheduled-task-item">
                                        <div class="task-item-name">Security Scan</div>
                                        <div class="task-item-status">Ready</div>
                                        <div class="task-item-trigger">Daily at 12:00 AM</div>
                                    </div>
                                </div>
                                <div class="task-scheduler-actions">
                                    <div class="actions-title">Actions</div>
                                    <div class="action-link">Create Basic Task...</div>
                                    <div class="action-link">Create Task...</div>
                                    <div class="action-link">Import Task...</div>
                                    <div class="action-link">Display All Running Tasks</div>
                                    <div class="action-link">Enable All Tasks History</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- MMC Console Builder Window -->
                    <div class="win-window mmc-builder-window" id="mmcbuilderWindow">
                        <div class="win-titlebar">
                            <span class="win-icon">üîß</span>
                            <span class="win-title">Add or Remove Snap-ins</span>
                            <div class="win-controls">
                                <span class="win-control close" onclick="closeWindow('mmcbuilder')">√ó</span>
                            </div>
                        </div>
                        <div class="win-content" style="padding: 0;">
                            <div class="mmc-builder-content">
                                <div class="snapin-available">
                                    <div class="snapin-panel-title">Available snap-ins</div>
                                    <div class="snapin-list">
                                        <div class="snapin-item" onclick="selectSnapin(this, 'devicemanager')">
                                            <div class="snapin-item-name">Device Manager</div>
                                            <div class="snapin-item-desc">Manage hardware devices</div>
                                        </div>
                                        <div class="snapin-item" onclick="selectSnapin(this, 'eventviewer')">
                                            <div class="snapin-item-name">Event Viewer</div>
                                            <div class="snapin-item-desc">View system and application events</div>
                                        </div>
                                        <div class="snapin-item" onclick="selectSnapin(this, 'services')">
                                            <div class="snapin-item-name">Services</div>
                                            <div class="snapin-item-desc">Manage system services</div>
                                        </div>
                                        <div class="snapin-item" onclick="selectSnapin(this, 'diskmgmt')">
                                            <div class="snapin-item-name">Disk Management</div>
                                            <div class="snapin-item-desc">Manage disk drives and partitions</div>
                                        </div>
                                        <div class="snapin-item" onclick="selectSnapin(this, 'taskscheduler')">
                                            <div class="snapin-item-name">Task Scheduler</div>
                                            <div class="snapin-item-desc">Schedule automated tasks</div>
                                        </div>
                                        <div class="snapin-item" onclick="selectSnapin(this, 'perfmon')">
                                            <div class="snapin-item-name">Performance Monitor</div>
                                            <div class="snapin-item-desc">Monitor system performance</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="snapin-available">
                                    <div class="snapin-panel-title">Selected snap-ins (<span id="snapinCount">0</span>)</div>
                                    <div class="snapin-list" id="selectedSnapins">
                                        <div style="padding: 30px; text-align: center; color: #666; font-size: 0.85rem;">
                                            No snap-ins selected
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mmc-builder-actions">
                                <button class="run-btn primary" onclick="createCustomConsole()">OK</button>
                                <button class="run-btn secondary" onclick="closeWindow('mmcbuilder')">Cancel</button>
                            </div>
                        </div>
                    </div>

                    <!-- Instructions Panel -->
                    <div class="instructions-panel" id="instructionsPanel">
                        <div class="instructions-title">
                            üìã Task Instructions
                        </div>
                        <div class="instructions-step" id="instructionsStep">
                            Press <code>Win+R</code> (click this panel), then type <code>compmgmt.msc</code> and press Enter to open Computer Management.
                        </div>
                        <div class="instructions-hint" id="instructionsHint">
                            üí° Hint: Computer Management is a central console for system administration
                        </div>
                        <button class="verify-btn" id="verifyBtn" onclick="verifyTask()">
                            Verify Task Completion
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Success Overlay -->
    <div class="success-overlay" id="successOverlay">
        <div class="success-card">
            <div class="success-icon">üéâ</div>
            <div class="success-title">Lab Complete!</div>
            <div class="success-message">
                You've mastered Windows Administrative Tools! You can now navigate MMC consoles, manage services, analyze event logs, configure disks, and build custom management consoles. These are essential skills for Windows system administration.
            </div>
            <button class="success-btn" onclick="finishLab()">Complete Lab</button>
        </div>
    </div>

    <script>
        // State
        let currentTask = 1;
        let completedTasks = new Set();
        let taskVerification = {
            1: false, // Opened Computer Management
            2: false, // Navigated to Device Manager
            3: false, // Opened Event Viewer and viewed Application logs
            4: false, // Found Windows Update service
            5: false, // Stopped and started a service
            6: false, // Opened Disk Management
            7: false, // Viewed Task Scheduler
            8: false  // Created custom MMC console
        };

        let currentMMCView = 'root';
        let selectedSnapins = [];
        let serviceRunning = true;

        // Task instructions
        const taskInstructions = {
            1: {
                step: 'Press <code>Win+R</code> (click this panel), then type <code>compmgmt.msc</code> and press Enter to open Computer Management.',
                hint: 'üí° Hint: Computer Management is a central console for system administration'
            },
            2: {
                step: 'In Computer Management, expand <strong>System Tools</strong> in the tree and click on <strong>Device Manager</strong>.',
                hint: 'üí° Hint: Device Manager shows all hardware components installed on the computer'
            },
            3: {
                step: 'Expand <strong>System Tools</strong>, then expand <strong>Event Viewer</strong>, expand <strong>Windows Logs</strong>, and click on <strong>Application</strong>.',
                hint: 'üí° Hint: Event Viewer tracks system events, errors, and warnings'
            },
            4: {
                step: 'Expand <strong>Services and Applications</strong>, click <strong>Services</strong>, then scroll to find and click on <strong>Windows Update</strong>.',
                hint: 'üí° Hint: Services are background processes that keep Windows running'
            },
            5: {
                step: 'Double-click the <strong>Print Spooler</strong> service, then use the <strong>Stop</strong> button to stop it, then <strong>Start</strong> to restart it.',
                hint: 'üí° Hint: Starting and stopping services is a common troubleshooting technique'
            },
            6: {
                step: 'Press <code>Win+R</code>, type <code>diskmgmt.msc</code> and press Enter to open Disk Management and view partitions.',
                hint: 'üí° Hint: Disk Management shows all physical disks and their partition layouts'
            },
            7: {
                step: 'Press <code>Win+R</code>, type <code>taskschd.msc</code> and press Enter to open Task Scheduler and view scheduled tasks.',
                hint: 'üí° Hint: Task Scheduler automates running programs at specific times'
            },
            8: {
                step: 'Press <code>Win+R</code>, type <code>mmc</code>, press Enter, then select <strong>Add/Remove Snap-ins</strong> from the File menu. Select 2 snap-ins.',
                hint: 'üí° Hint: Custom MMC consoles let you create personalized admin tool collections'
            }
        };

        // Open window
        function openWindow(windowId) {
            document.querySelectorAll('.win-window').forEach(w => w.classList.remove('active'));
            const win = document.getElementById(windowId + 'Window');
            if (win) {
                win.classList.add('active');

                // Track task progress
                if (windowId === 'compmgmt' && currentTask === 1) {
                    taskVerification[1] = true;
                }
                if (windowId === 'eventviewer' && currentTask === 3) {
                    taskVerification[3] = true;
                }
                if (windowId === 'services' && currentTask === 4) {
                    // Services window opened
                }
                if (windowId === 'diskmgmt' && currentTask === 6) {
                    taskVerification[6] = true;
                }
                if (windowId === 'taskscheduler' && currentTask === 7) {
                    taskVerification[7] = true;
                }
                if (windowId === 'mmcbuilder' && currentTask === 8) {
                    // MMC builder opened
                }
            }
        }

        function closeWindow(windowId) {
            document.getElementById(windowId + 'Window').classList.remove('active');
        }

        // Simulate Win+R by clicking the instructions panel
        document.getElementById('instructionsPanel').addEventListener('click', function(e) {
            if (e.target.tagName === 'CODE' || e.target.closest('.instructions-step')) {
                if (!document.getElementById('runWindow').classList.contains('active')) {
                    openWindow('run');
                    setTimeout(() => document.getElementById('runInput').focus(), 100);
                }
            }
        });

        function handleRunKey(event) {
            if (event.key === 'Enter') {
                executeRunCommand();
            }
        }

        function executeRunCommand() {
            const input = document.getElementById('runInput');
            const cmd = input.value.trim().toLowerCase();

            if (cmd === 'compmgmt.msc') {
                closeWindow('run');
                openWindow('compmgmt');
                input.value = '';
            } else if (cmd === 'eventvwr.msc') {
                closeWindow('run');
                openWindow('eventviewer');
                input.value = '';
            } else if (cmd === 'services.msc') {
                closeWindow('run');
                openWindow('services');
                input.value = '';
            } else if (cmd === 'diskmgmt.msc') {
                closeWindow('run');
                openWindow('diskmgmt');
                input.value = '';
            } else if (cmd === 'taskschd.msc') {
                closeWindow('run');
                openWindow('taskscheduler');
                input.value = '';
            } else if (cmd === 'mmc') {
                closeWindow('run');
                openWindow('mmcbuilder');
                input.value = '';
            } else if (cmd) {
                alert('Command not recognized: ' + cmd);
            }
        }

        // MMC Tree navigation
        function toggleTreeItem(item) {
            const siblings = item.parentElement.querySelectorAll('.mmc-tree-item');
            const itemIndex = Array.from(siblings).indexOf(item);

            // Toggle expansion
            if (item.classList.contains('expandable')) {
                item.classList.toggle('expanded');

                // Show/hide children
                let nextItem = item.nextElementSibling;
                while (nextItem && nextItem.classList.contains('child')) {
                    if (item.classList.contains('expanded')) {
                        nextItem.style.display = 'flex';
                    } else {
                        nextItem.style.display = 'none';
                    }
                    nextItem = nextItem.nextElementSibling;
                }
            }

            // Select item
            siblings.forEach(s => s.classList.remove('selected'));
            item.classList.add('selected');
        }

        // Show MMC views
        function showMMCView(view) {
            currentMMCView = view;
            const content = document.getElementById('mmcMainContent');
            const title = document.getElementById('mmcViewTitle');

            if (view === 'device-manager') {
                if (currentTask === 2) taskVerification[2] = true;
                title.textContent = 'Device Manager';
                content.innerHTML = `
                    <div class="mmc-list-item">
                        <div>üíª Computer</div>
                        <div></div>
                        <div></div>
                        <div></div>
                    </div>
                    <div class="mmc-list-item">
                        <div>üíæ Disk drives</div>
                        <div></div>
                        <div></div>
                        <div></div>
                    </div>
                    <div class="mmc-list-item">
                        <div>üñ•Ô∏è Display adapters</div>
                        <div></div>
                        <div></div>
                        <div></div>
                    </div>
                    <div class="mmc-list-item">
                        <div>üåê Network adapters</div>
                        <div></div>
                        <div></div>
                        <div></div>
                    </div>
                `;
            } else if (view === 'event-viewer') {
                title.textContent = 'Event Viewer';
                content.innerHTML = `
                    <div style="padding: 30px; text-align: center; color: #999;">
                        <p>Expand Windows Logs to view specific event types</p>
                    </div>
                `;
            } else if (view === 'services-list') {
                title.textContent = 'Services';
                content.innerHTML = `
                    <div class="mmc-list-header">
                        <div>Name</div>
                        <div>Status</div>
                        <div>Startup Type</div>
                        <div>Log On As</div>
                    </div>
                    <div class="mmc-list-item">
                        <div>DHCP Client</div>
                        <div class="mmc-status-running">Running</div>
                        <div>Automatic</div>
                        <div>Local Service</div>
                    </div>
                    <div class="mmc-list-item" onclick="selectService('windowsupdate')">
                        <div>Windows Update</div>
                        <div class="mmc-status-running">Running</div>
                        <div>Manual</div>
                        <div>Local System</div>
                    </div>
                `;
            }
        }

        // Select service
        function selectService(service) {
            if (service === 'windowsupdate' && currentTask === 4) {
                taskVerification[4] = true;
            }
        }

        // Event log selection
        function showEventLog(logType) {
            if (logType === 'application' && currentTask === 3) {
                taskVerification[3] = true;
            }
        }

        // Service dialog
        function openServiceDialog(service) {
            openWindow('servicedialog');
        }

        function stopService() {
            serviceRunning = false;
            document.getElementById('serviceDialogStatus').textContent = 'Stopped';
            document.getElementById('printSpoolerStatus').textContent = 'Stopped';
            document.getElementById('printSpoolerStatus').className = 'mmc-status-stopped';
            document.getElementById('startServiceBtn').disabled = false;
            document.getElementById('stopServiceBtn').disabled = true;
        }

        function startService() {
            serviceRunning = true;
            document.getElementById('serviceDialogStatus').textContent = 'Running';
            document.getElementById('printSpoolerStatus').textContent = 'Running';
            document.getElementById('printSpoolerStatus').className = 'mmc-status-running';
            document.getElementById('startServiceBtn').disabled = true;
            document.getElementById('stopServiceBtn').disabled = false;

            if (currentTask === 5 && !taskVerification[5]) {
                taskVerification[5] = true;
            }
        }

        function pauseService() {
            // Simulated
        }

        function resumeService() {
            // Simulated
        }

        // MMC Snap-in selection
        function selectSnapin(element, snapinId) {
            if (selectedSnapins.includes(snapinId)) {
                // Remove
                selectedSnapins = selectedSnapins.filter(s => s !== snapinId);
                element.classList.remove('selected');
            } else {
                // Add
                selectedSnapins.push(snapinId);
                element.classList.add('selected');
            }

            updateSelectedSnapins();
        }

        function updateSelectedSnapins() {
            const container = document.getElementById('selectedSnapins');
            const count = document.getElementById('snapinCount');
            count.textContent = selectedSnapins.length;

            if (selectedSnapins.length === 0) {
                container.innerHTML = '<div style="padding: 30px; text-align: center; color: #666; font-size: 0.85rem;">No snap-ins selected</div>';
            } else {
                const snapinNames = {
                    'devicemanager': 'Device Manager',
                    'eventviewer': 'Event Viewer',
                    'services': 'Services',
                    'diskmgmt': 'Disk Management',
                    'taskscheduler': 'Task Scheduler',
                    'perfmon': 'Performance Monitor'
                };

                container.innerHTML = selectedSnapins.map(id => `
                    <div class="snapin-item selected">
                        <div class="snapin-item-name">${snapinNames[id]}</div>
                    </div>
                `).join('');
            }
        }

        function createCustomConsole() {
            if (selectedSnapins.length >= 2) {
                taskVerification[8] = true;
                closeWindow('mmcbuilder');
                alert('Custom MMC console created successfully with ' + selectedSnapins.length + ' snap-ins!');
            } else {
                alert('Please select at least 2 snap-ins to create a custom console.');
            }
        }

        // Task management
        function selectTask(taskNum) {
            currentTask = taskNum;

            // Update task cards
            document.querySelectorAll('.task-card').forEach(card => {
                card.classList.remove('active');
                if (parseInt(card.dataset.task) === taskNum) {
                    card.classList.add('active');
                }
            });

            // Update instructions
            const task = taskInstructions[taskNum];
            document.getElementById('instructionsStep').innerHTML = task.step;
            document.getElementById('instructionsHint').innerHTML = task.hint;
        }

        function verifyTask() {
            if (taskVerification[currentTask]) {
                completeTask(currentTask);
            } else {
                alert('Task not yet completed. Follow the instructions and try again.');
            }
        }

        function completeTask(taskNum) {
            completedTasks.add(taskNum);

            // Mark task as complete
            const taskCard = document.querySelector(`[data-task="${taskNum}"]`);
            taskCard.classList.add('completed');

            // Update progress
            document.getElementById('taskProgress').textContent = `${completedTasks.size}/8 Complete`;

            // Check if all tasks complete
            if (completedTasks.size === 8) {
                setTimeout(() => {
                    document.getElementById('successOverlay').classList.add('active');
                }, 500);
            } else {
                // Move to next task
                const nextTask = taskNum + 1;
                if (nextTask <= 8) {
                    selectTask(nextTask);
                }
            }
        }

        function finishLab() {
            // Save progress
            const progress = JSON.parse(localStorage.getItem('hexworth_progress') || '{}');
            progress.forge = progress.forge || {};
            progress.forge.adminToolsLab = {
                completed: true,
                tasksCompleted: completedTasks.size,
                date: new Date().toISOString()
            };
            localStorage.setItem('hexworth_progress', JSON.stringify(progress));

            window.location.href = '../../dashboard.html';
        }

        function resetVM() {
            location.reload();
        }

        function toggleFullscreen() {
            if (document.fullscreenElement) {
                document.exitFullscreen();
            } else {
                document.querySelector('.vm-screen').requestFullscreen();
            }
        }

        // Update taskbar time
        function updateTime() {
            const now = new Date();
            document.getElementById('taskbarTime').textContent = now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });
            document.getElementById('taskbarDate').textContent = now.toLocaleDateString('en-US');
        }
        setInterval(updateTime, 1000);
        updateTime();
    </script>
</body>
</html>
