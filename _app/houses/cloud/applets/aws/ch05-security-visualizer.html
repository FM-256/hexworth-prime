<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Access Control -->
    <script src="../../../../components/AccessGuard.js"></script>
    <script>
        AccessGuard.require('sorted');
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IAM Security Visualizer - Chapter 5 - Hexworth Prime</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #333;
            padding-bottom: 40px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 30px 20px;
            color: white;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .home-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 10px 20px;
            font-size: 1em;
            background: rgba(255,255,255,0.2);
            border: 2px solid white;
            color: white;
            border-radius: 10px;
            cursor: pointer;
            z-index: 1000;
            text-decoration: none;
            transition: all 0.3s;
        }

        .home-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 15px 30px;
            font-size: 1.1em;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        .tab-btn.active {
            background: #e94560;
            border-color: #e94560;
        }

        .tab-content {
            display: none;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: fadeIn 0.5s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h2 {
            color: #1a1a2e;
            font-size: 2em;
            margin-bottom: 25px;
            border-bottom: 3px solid #e94560;
            padding-bottom: 10px;
        }

        .policy-builder {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 30px;
        }

        .builder-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #e0e0e0;
        }

        .builder-section h3 {
            color: #e94560;
            margin-bottom: 20px;
            font-size: 1.3em;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        .form-group select,
        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: #e94560;
        }

        .action-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .chip {
            padding: 8px 15px;
            background: #e3f2fd;
            border: 2px solid #2196F3;
            border-radius: 20px;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .chip:hover {
            background: #2196F3;
            color: white;
        }

        .chip.selected {
            background: #e94560;
            border-color: #e94560;
            color: white;
        }

        .policy-output {
            background: #1a1a2e;
            color: #00ff00;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.6;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
        }

        .btn {
            padding: 12px 25px;
            background: #e94560;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn:hover {
            background: #d63651;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(233, 69, 96, 0.3);
        }

        .permissions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .permission-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s;
            cursor: pointer;
        }

        .permission-card:hover {
            border-color: #e94560;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .permission-card h4 {
            color: #e94560;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .permission-card p {
            color: #666;
            line-height: 1.6;
            font-size: 0.95em;
        }

        .permission-details {
            display: none;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid #e0e0e0;
        }

        .permission-details.show {
            display: block;
        }

        .permission-list {
            list-style: none;
            padding-left: 0;
        }

        .permission-list li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            color: #333;
        }

        .permission-list li:before {
            content: "‚Üí";
            position: absolute;
            left: 0;
            color: #e94560;
            font-weight: 700;
        }

        .mfa-demo {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 30px;
        }

        .demo-card {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #e0e0e0;
            text-align: center;
        }

        .demo-card h3 {
            color: #e94560;
            margin-bottom: 20px;
        }

        .mfa-device {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
            border: 3px solid #e0e0e0;
        }

        .qr-code {
            width: 150px;
            height: 150px;
            background: linear-gradient(45deg, #1a1a2e 25%, transparent 25%, transparent 75%, #1a1a2e 75%, #1a1a2e),
                        linear-gradient(45deg, #1a1a2e 25%, transparent 25%, transparent 75%, #1a1a2e 75%, #1a1a2e);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            margin: 20px auto;
            border: 5px solid #1a1a2e;
        }

        .otp-code {
            font-size: 2.5em;
            font-weight: 700;
            color: #e94560;
            letter-spacing: 10px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
        }

        .security-group-viz {
            margin-top: 30px;
        }

        .sg-diagram {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            border: 2px solid #e0e0e0;
            margin-top: 20px;
        }

        .instance-box {
            background: white;
            padding: 30px;
            border-radius: 15px;
            border: 3px solid #e94560;
            text-align: center;
            margin: 30px auto;
            max-width: 300px;
        }

        .instance-box h4 {
            color: #e94560;
            margin-bottom: 15px;
        }

        .traffic-rules {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .traffic-box {
            background: white;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #e0e0e0;
        }

        .traffic-box h4 {
            color: #1a1a2e;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }

        .rule-item {
            padding: 10px;
            margin: 10px 0;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #4caf50;
        }

        .rule-item.deny {
            border-left-color: #f44336;
        }

        .arrow {
            font-size: 3em;
            color: #e94560;
            text-align: center;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .policy-builder,
            .mfa-demo,
            .traffic-rules {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <a href="../../../../index.html" class="home-btn">üè† Home</a>

    <div class="container">
        <header>
            <h1>IAM Security Visualizer</h1>
            <p>Interactive exploration of AWS IAM, policies, and security controls</p>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab(0)">Policy Builder</button>
            <button class="tab-btn" onclick="switchTab(1)">Permissions Explorer</button>
            <button class="tab-btn" onclick="switchTab(2)">MFA Demo</button>
            <button class="tab-btn" onclick="switchTab(3)">Security Groups</button>
        </div>

        <div id="tab0" class="tab-content active">
            <h2>IAM Policy Builder</h2>
            <p style="margin-bottom: 20px; color: #666;">Create and visualize IAM policies with this interactive builder. Select options below to generate a JSON policy.</p>

            <div class="policy-builder">
                <div class="builder-section">
                    <h3>Policy Configuration</h3>

                    <div class="form-group">
                        <label>Effect</label>
                        <select id="effect" onchange="updatePolicy()">
                            <option value="Allow">Allow</option>
                            <option value="Deny">Deny</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Service</label>
                        <select id="service" onchange="updateServiceActions()">
                            <option value="s3">S3 (Simple Storage Service)</option>
                            <option value="ec2">EC2 (Elastic Compute Cloud)</option>
                            <option value="iam">IAM (Identity and Access Management)</option>
                            <option value="lambda">Lambda</option>
                            <option value="dynamodb">DynamoDB</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Actions (Click to select)</label>
                        <div class="action-chips" id="actionChips"></div>
                    </div>

                    <div class="form-group">
                        <label>Resource ARN</label>
                        <input type="text" id="resource" placeholder="arn:aws:s3:::my-bucket/*" onchange="updatePolicy()">
                    </div>

                    <button class="btn" onclick="copyPolicy()">Copy Policy to Clipboard</button>
                </div>

                <div class="builder-section">
                    <h3>Generated Policy</h3>
                    <div class="policy-output" id="policyOutput"></div>
                </div>
            </div>
        </div>

        <div id="tab1" class="tab-content">
            <h2>AWS Permissions Explorer</h2>
            <p style="margin-bottom: 20px; color: #666;">Click on any card to explore the permissions and actions available for each AWS service.</p>

            <div class="permissions-grid">
                <div class="permission-card" onclick="togglePermissionDetails(0)">
                    <h4>Amazon S3</h4>
                    <p>Object storage service with industry-leading scalability, data availability, security, and performance.</p>
                    <div class="permission-details" id="details0">
                        <ul class="permission-list">
                            <li><strong>s3:GetObject</strong> - Read objects from buckets</li>
                            <li><strong>s3:PutObject</strong> - Write objects to buckets</li>
                            <li><strong>s3:DeleteObject</strong> - Delete objects from buckets</li>
                            <li><strong>s3:ListBucket</strong> - List bucket contents</li>
                            <li><strong>s3:CreateBucket</strong> - Create new S3 buckets</li>
                            <li><strong>s3:DeleteBucket</strong> - Delete S3 buckets</li>
                        </ul>
                    </div>
                </div>

                <div class="permission-card" onclick="togglePermissionDetails(1)">
                    <h4>Amazon EC2</h4>
                    <p>Secure and resizable compute capacity in the cloud. Launch virtual servers as needed.</p>
                    <div class="permission-details" id="details1">
                        <ul class="permission-list">
                            <li><strong>ec2:RunInstances</strong> - Launch EC2 instances</li>
                            <li><strong>ec2:StopInstances</strong> - Stop running instances</li>
                            <li><strong>ec2:TerminateInstances</strong> - Terminate instances</li>
                            <li><strong>ec2:DescribeInstances</strong> - View instance information</li>
                            <li><strong>ec2:CreateSecurityGroup</strong> - Create security groups</li>
                            <li><strong>ec2:AuthorizeSecurityGroupIngress</strong> - Add inbound rules</li>
                        </ul>
                    </div>
                </div>

                <div class="permission-card" onclick="togglePermissionDetails(2)">
                    <h4>AWS IAM</h4>
                    <p>Securely manage access to AWS services and resources for your users.</p>
                    <div class="permission-details" id="details2">
                        <ul class="permission-list">
                            <li><strong>iam:CreateUser</strong> - Create new IAM users</li>
                            <li><strong>iam:DeleteUser</strong> - Delete IAM users</li>
                            <li><strong>iam:AttachUserPolicy</strong> - Attach policies to users</li>
                            <li><strong>iam:CreateRole</strong> - Create IAM roles</li>
                            <li><strong>iam:CreatePolicy</strong> - Create custom policies</li>
                            <li><strong>iam:GetUser</strong> - View user information</li>
                        </ul>
                    </div>
                </div>

                <div class="permission-card" onclick="togglePermissionDetails(3)">
                    <h4>AWS Lambda</h4>
                    <p>Run code without provisioning or managing servers. Pay only for compute time consumed.</p>
                    <div class="permission-details" id="details3">
                        <ul class="permission-list">
                            <li><strong>lambda:CreateFunction</strong> - Create Lambda functions</li>
                            <li><strong>lambda:InvokeFunction</strong> - Execute Lambda functions</li>
                            <li><strong>lambda:UpdateFunctionCode</strong> - Update function code</li>
                            <li><strong>lambda:DeleteFunction</strong> - Delete Lambda functions</li>
                            <li><strong>lambda:GetFunction</strong> - View function details</li>
                            <li><strong>lambda:ListFunctions</strong> - List all functions</li>
                        </ul>
                    </div>
                </div>

                <div class="permission-card" onclick="togglePermissionDetails(4)">
                    <h4>Amazon DynamoDB</h4>
                    <p>Fast and flexible NoSQL database service for any scale.</p>
                    <div class="permission-details" id="details4">
                        <ul class="permission-list">
                            <li><strong>dynamodb:CreateTable</strong> - Create DynamoDB tables</li>
                            <li><strong>dynamodb:PutItem</strong> - Write items to tables</li>
                            <li><strong>dynamodb:GetItem</strong> - Read items from tables</li>
                            <li><strong>dynamodb:DeleteItem</strong> - Delete items from tables</li>
                            <li><strong>dynamodb:Query</strong> - Query table data</li>
                            <li><strong>dynamodb:Scan</strong> - Scan entire tables</li>
                        </ul>
                    </div>
                </div>

                <div class="permission-card" onclick="togglePermissionDetails(5)">
                    <h4>Amazon RDS</h4>
                    <p>Set up, operate, and scale relational databases in the cloud.</p>
                    <div class="permission-details" id="details5">
                        <ul class="permission-list">
                            <li><strong>rds:CreateDBInstance</strong> - Create database instances</li>
                            <li><strong>rds:DeleteDBInstance</strong> - Delete database instances</li>
                            <li><strong>rds:DescribeDBInstances</strong> - View database info</li>
                            <li><strong>rds:CreateDBSnapshot</strong> - Create database snapshots</li>
                            <li><strong>rds:RestoreDBInstanceFromSnapshot</strong> - Restore from backup</li>
                            <li><strong>rds:ModifyDBInstance</strong> - Modify database settings</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div id="tab2" class="tab-content">
            <h2>Multi-Factor Authentication (MFA) Demo</h2>
            <p style="margin-bottom: 20px; color: #666;">Understand how MFA adds an extra layer of security to your AWS account.</p>

            <div class="mfa-demo">
                <div class="demo-card">
                    <h3>Virtual MFA Device</h3>
                    <p style="margin-bottom: 20px;">Scan this QR code with an authenticator app like Google Authenticator or Authy.</p>
                    <div class="mfa-device">
                        <div class="qr-code"></div>
                        <p style="color: #666; margin-top: 15px;">QR Code for setup</p>
                    </div>
                    <button class="btn" onclick="simulateSetup()">Simulate MFA Setup</button>
                </div>

                <div class="demo-card">
                    <h3>Time-Based OTP</h3>
                    <p style="margin-bottom: 20px;">The authenticator app generates a new code every 30 seconds.</p>
                    <div class="mfa-device">
                        <div class="otp-code" id="otpCode">123456</div>
                        <div style="color: #666; margin-top: 10px;">
                            <span id="otpTimer">30</span> seconds remaining
                        </div>
                        <div style="width: 100%; height: 8px; background: #e0e0e0; border-radius: 10px; margin-top: 15px; overflow: hidden;">
                            <div style="height: 100%; background: #e94560; width: 100%; transition: width 1s linear;" id="otpProgress"></div>
                        </div>
                    </div>
                    <button class="btn" onclick="startOTPSimulation()">Start OTP Generation</button>
                </div>
            </div>

            <div style="background: #f8f9fa; padding: 25px; border-radius: 15px; margin-top: 30px; border: 2px solid #e0e0e0;">
                <h3 style="color: #e94560; margin-bottom: 15px;">MFA Benefits</h3>
                <ul class="permission-list">
                    <li>Protects against password theft and phishing attacks</li>
                    <li>Required for sensitive operations in well-secured environments</li>
                    <li>Complies with security standards and regulations</li>
                    <li>Minimal user friction with modern authenticator apps</li>
                    <li>Works even without internet connectivity (TOTP-based)</li>
                    <li>Can be required via IAM policies for specific actions</li>
                </ul>
            </div>
        </div>

        <div id="tab3" class="tab-content">
            <h2>Security Groups Visualizer</h2>
            <p style="margin-bottom: 20px; color: #666;">Security groups act as virtual firewalls controlling inbound and outbound traffic to EC2 instances.</p>

            <div class="security-group-viz">
                <div class="sg-diagram">
                    <div class="instance-box">
                        <h4>EC2 Instance</h4>
                        <p style="color: #666;">Web Server<br>172.31.10.5</p>
                    </div>

                    <div class="traffic-rules">
                        <div class="traffic-box">
                            <h4>Inbound Rules</h4>
                            <div class="rule-item">
                                <strong>Type:</strong> HTTP<br>
                                <strong>Port:</strong> 80<br>
                                <strong>Source:</strong> 0.0.0.0/0<br>
                                <strong>Status:</strong> ALLOWED
                            </div>
                            <div class="rule-item">
                                <strong>Type:</strong> HTTPS<br>
                                <strong>Port:</strong> 443<br>
                                <strong>Source:</strong> 0.0.0.0/0<br>
                                <strong>Status:</strong> ALLOWED
                            </div>
                            <div class="rule-item">
                                <strong>Type:</strong> SSH<br>
                                <strong>Port:</strong> 22<br>
                                <strong>Source:</strong> 203.0.113.0/24<br>
                                <strong>Status:</strong> ALLOWED
                            </div>
                            <div class="rule-item deny">
                                <strong>Type:</strong> All Other<br>
                                <strong>Port:</strong> All<br>
                                <strong>Source:</strong> 0.0.0.0/0<br>
                                <strong>Status:</strong> DENIED (Default)
                            </div>
                        </div>

                        <div class="traffic-box">
                            <h4>Outbound Rules</h4>
                            <div class="rule-item">
                                <strong>Type:</strong> All Traffic<br>
                                <strong>Port:</strong> All<br>
                                <strong>Destination:</strong> 0.0.0.0/0<br>
                                <strong>Status:</strong> ALLOWED (Default)
                            </div>
                            <p style="margin-top: 15px; color: #666; font-size: 0.9em;">
                                By default, security groups allow all outbound traffic. This can be restricted based on security requirements.
                            </p>
                        </div>
                    </div>

                    <div style="background: white; padding: 25px; border-radius: 12px; margin-top: 25px; border: 2px solid #e0e0e0;">
                        <h3 style="color: #e94560; margin-bottom: 15px;">Key Security Group Concepts</h3>
                        <ul class="permission-list">
                            <li><strong>Stateful:</strong> Return traffic is automatically allowed regardless of outbound rules</li>
                            <li><strong>Default Deny:</strong> All inbound traffic is denied by default until explicitly allowed</li>
                            <li><strong>Allow Rules Only:</strong> You can only create allow rules, not explicit deny rules</li>
                            <li><strong>Instance Level:</strong> Applied at the EC2 instance network interface level</li>
                            <li><strong>Multiple Groups:</strong> Up to 5 security groups can be attached to an instance</li>
                            <li><strong>Aggregated Rules:</strong> All rules from attached groups are evaluated together</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const serviceActions = {
            s3: ['GetObject', 'PutObject', 'DeleteObject', 'ListBucket', 'CreateBucket', 'DeleteBucket'],
            ec2: ['RunInstances', 'StopInstances', 'TerminateInstances', 'DescribeInstances', 'CreateSecurityGroup'],
            iam: ['CreateUser', 'DeleteUser', 'AttachUserPolicy', 'CreateRole', 'CreatePolicy'],
            lambda: ['CreateFunction', 'InvokeFunction', 'UpdateFunctionCode', 'DeleteFunction', 'GetFunction'],
            dynamodb: ['CreateTable', 'PutItem', 'GetItem', 'DeleteItem', 'Query', 'Scan']
        };

        let selectedActions = [];
        let otpInterval = null;

        function switchTab(tabIndex) {
            document.querySelectorAll('.tab-btn').forEach((btn, index) => {
                btn.classList.toggle('active', index === tabIndex);
            });
            document.querySelectorAll('.tab-content').forEach((content, index) => {
                content.classList.toggle('active', index === tabIndex);
            });
        }

        function updateServiceActions() {
            const service = document.getElementById('service').value;
            const container = document.getElementById('actionChips');
            const resourceInput = document.getElementById('resource');

            container.innerHTML = '';
            selectedActions = [];

            serviceActions[service].forEach(action => {
                const chip = document.createElement('div');
                chip.className = 'chip';
                chip.textContent = action;
                chip.onclick = () => toggleAction(service, action, chip);
                container.appendChild(chip);
            });

            const arnExamples = {
                s3: 'arn:aws:s3:::my-bucket/*',
                ec2: 'arn:aws:ec2:us-east-1:123456789012:instance/*',
                iam: 'arn:aws:iam::123456789012:user/*',
                lambda: 'arn:aws:lambda:us-east-1:123456789012:function:*',
                dynamodb: 'arn:aws:dynamodb:us-east-1:123456789012:table/*'
            };

            resourceInput.value = arnExamples[service];
            updatePolicy();
        }

        function toggleAction(service, action, chipElement) {
            const fullAction = `${service}:${action}`;
            const index = selectedActions.indexOf(fullAction);

            if (index > -1) {
                selectedActions.splice(index, 1);
                chipElement.classList.remove('selected');
            } else {
                selectedActions.push(fullAction);
                chipElement.classList.add('selected');
            }

            updatePolicy();
        }

        function updatePolicy() {
            const effect = document.getElementById('effect').value;
            const resource = document.getElementById('resource').value || '*';

            const policy = {
                Version: '2012-10-17',
                Statement: [
                    {
                        Effect: effect,
                        Action: selectedActions.length > 0 ? selectedActions : ['*'],
                        Resource: resource
                    }
                ]
            };

            document.getElementById('policyOutput').textContent = JSON.stringify(policy, null, 2);
        }

        function copyPolicy() {
            const policyText = document.getElementById('policyOutput').textContent;
            navigator.clipboard.writeText(policyText).then(() => {
                alert('Policy copied to clipboard!');
            });
        }

        function togglePermissionDetails(index) {
            const details = document.getElementById(`details${index}`);
            details.classList.toggle('show');
        }

        function simulateSetup() {
            alert('MFA Setup Simulated!\n\nIn a real scenario:\n1. Scan the QR code with your authenticator app\n2. Enter the 6-digit code to verify\n3. MFA is now enabled on your account');
        }

        function startOTPSimulation() {
            if (otpInterval) {
                clearInterval(otpInterval);
            }

            let timeLeft = 30;

            function generateOTP() {
                return Math.floor(100000 + Math.random() * 900000).toString();
            }

            function updateOTP() {
                document.getElementById('otpCode').textContent = generateOTP();
                timeLeft = 30;
            }

            updateOTP();

            otpInterval = setInterval(() => {
                timeLeft--;
                document.getElementById('otpTimer').textContent = timeLeft;
                document.getElementById('otpProgress').style.width = (timeLeft / 30 * 100) + '%';

                if (timeLeft <= 0) {
                    updateOTP();
                }
            }, 1000);
        }

        updateServiceActions();
    </script>
<script src="../../../../components/FluxCapacitor.js"></script>
</body>
</html>