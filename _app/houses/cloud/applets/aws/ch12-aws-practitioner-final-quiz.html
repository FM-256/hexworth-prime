<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Access Control -->
    <script src="../../../../components/AccessGuard.js"></script>
    <script>
        AccessGuard.require('sorted');
    </script>
    <!-- Achievement & Progress Integration -->
    <script src="../../../../components/AchievementManager.js"></script>
    <script src="../../../../components/ModuleProgress.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS Cloud Practitioner Final Exam - Chapters 9-12</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #ffffff;
            min-height: 100vh;
            padding: 2rem;
        }

        .home-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: #e94560;
            color: white;
            text-decoration: none;
            padding: 12px 24px;
            border-radius: 30px;
            font-weight: bold;
            z-index: 1000;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(233, 69, 96, 0.3);
        }

        .home-btn:hover {
            background: #c13a50;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(233, 69, 96, 0.5);
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding-top: 20px;
        }

        h1 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            color: #e94560;
            text-shadow: 0 2px 10px rgba(233, 69, 96, 0.3);
        }

        .subtitle {
            text-align: center;
            font-size: 1.1rem;
            color: #a0a0a0;
            margin-bottom: 1rem;
        }

        .exam-info {
            text-align: center;
            background: rgba(233, 69, 96, 0.1);
            border: 2px solid #e94560;
            border-radius: 15px;
            padding: 1rem;
            margin-bottom: 2rem;
        }

        .exam-info p {
            margin: 0.5rem 0;
            color: #ffffff;
        }

        .quiz-header {
            background: white;
            color: #1a1a2e;
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #e94560, #ff6b81);
            width: 0%;
            transition: width 0.3s ease;
        }

        .stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .stat-label {
            font-weight: bold;
            color: #555;
        }

        .stat-value {
            color: #e94560;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .question-card {
            background: white;
            color: #1a1a2e;
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: none;
            animation: slideIn 0.5s ease;
        }

        .question-card.active {
            display: block;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .question-number {
            color: #e94560;
            font-size: 0.9rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .question-category {
            display: inline-block;
            background: #e94560;
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 0.8rem;
            margin-bottom: 1rem;
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 2rem;
            color: #1a1a2e;
            line-height: 1.6;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .option {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .option:hover {
            background: #e8f4ff;
            border-color: #e94560;
            transform: translateX(5px);
        }

        .option-letter {
            background: #e94560;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .option-text {
            flex: 1;
            color: #333;
        }

        .option.selected {
            background: #fff3e0;
            border-color: #e94560;
        }

        .option.correct {
            background: #d4edda;
            border-color: #28a745;
        }

        .option.correct .option-letter {
            background: #28a745;
        }

        .option.incorrect {
            background: #f8d7da;
            border-color: #dc3545;
        }

        .option.incorrect .option-letter {
            background: #dc3545;
        }

        .option.disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }

        .explanation {
            margin-top: 2rem;
            padding: 1.5rem;
            background: #e8f5e9;
            border-left: 4px solid #28a745;
            border-radius: 10px;
            display: none;
        }

        .explanation.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .explanation-title {
            font-weight: bold;
            color: #28a745;
            margin-bottom: 0.5rem;
        }

        .explanation-text {
            color: #333;
            line-height: 1.6;
        }

        .button-container {
            display: flex;
            justify-content: space-between;
            gap: 1rem;
            margin-top: 2rem;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 30px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .btn-primary {
            background: #e94560;
            color: white;
        }

        .btn-primary:hover {
            background: #c13a50;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(233, 69, 96, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .results-card {
            background: white;
            color: #1a1a2e;
            border-radius: 20px;
            padding: 3rem;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: none;
        }

        .results-card.show {
            display: block;
            animation: scaleIn 0.5s ease;
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .results-icon {
            font-size: 5rem;
            margin-bottom: 1rem;
        }

        .results-title {
            font-size: 2rem;
            color: #e94560;
            margin-bottom: 1rem;
        }

        .results-score {
            font-size: 3rem;
            font-weight: bold;
            color: #e94560;
            margin-bottom: 2rem;
        }

        .results-message {
            font-size: 1.2rem;
            color: #555;
            margin-bottom: 2rem;
        }

        .results-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .breakdown-item {
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 15px;
        }

        .breakdown-value {
            font-size: 2rem;
            font-weight: bold;
            color: #e94560;
        }

        .breakdown-label {
            color: #555;
            font-size: 0.9rem;
        }

        .category-breakdown {
            margin-top: 2rem;
            text-align: left;
        }

        .category-item {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
        }

        .category-name {
            font-weight: bold;
            color: #e94560;
            margin-bottom: 0.5rem;
        }

        .category-score {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .score-bar {
            flex: 1;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 0 1rem;
        }

        .score-fill {
            height: 100%;
            background: #e94560;
            transition: width 0.5s ease;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }

            .question-text {
                font-size: 1.1rem;
            }

            .option {
                padding: 1rem;
            }

            .button-container {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <a href="../../../../index.html" class="home-btn">üè† Home</a>

    <div class="container">
        <h1>AWS Cloud Practitioner Final Exam</h1>
        <p class="subtitle">Comprehensive Assessment: Chapters 9-12</p>

        <div class="exam-info">
            <p><strong>Total Questions:</strong> 20 | <strong>Passing Score:</strong> 70% (14/20) | <strong>Time:</strong> Untimed</p>
            <p>This exam covers Database Services, Networking, Automation, and Use Cases</p>
        </div>

        <div class="quiz-header">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="stats">
                <div class="stat-item">
                    <span class="stat-label">Question:</span>
                    <span class="stat-value" id="currentQuestion">1</span>
                    <span class="stat-label">/ 20</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Score:</span>
                    <span class="stat-value" id="currentScore">0</span>
                    <span class="stat-label">/ 20</span>
                </div>
            </div>
        </div>

        <div id="quizContainer"></div>

        <div class="results-card" id="resultsCard">
            <div class="results-icon" id="resultsIcon">üéâ</div>
            <div class="results-title" id="resultsTitle">Exam Complete!</div>
            <div class="results-score" id="resultsScore">0%</div>
            <div class="results-message" id="resultsMessage"></div>
            <div class="results-breakdown">
                <div class="breakdown-item">
                    <div class="breakdown-value" id="correctCount">0</div>
                    <div class="breakdown-label">Correct</div>
                </div>
                <div class="breakdown-item">
                    <div class="breakdown-value" id="incorrectCount">0</div>
                    <div class="breakdown-label">Incorrect</div>
                </div>
                <div class="breakdown-item">
                    <div class="breakdown-value" id="percentageScore">0%</div>
                    <div class="breakdown-label">Score</div>
                </div>
                <div class="breakdown-item">
                    <div class="breakdown-value" id="passStatus">-</div>
                    <div class="breakdown-label">Status</div>
                </div>
            </div>

            <div class="category-breakdown" id="categoryBreakdown"></div>

            <button class="btn btn-primary" onclick="restartQuiz()" style="margin-top: 2rem;">Retake Exam</button>
        </div>
    </div>

    <script>
        const questions = [
            // Database Services (Ch 9) - 5 questions
            {
                question: "A company needs a database that provides single-digit millisecond latency for a high-traffic gaming application. Which AWS service should they use?",
                options: [
                    "Amazon RDS with read replicas",
                    "Amazon DynamoDB",
                    "Amazon Redshift",
                    "Amazon Aurora"
                ],
                correct: 1,
                category: "Database Services",
                explanation: "Amazon DynamoDB provides single-digit millisecond latency at any scale, making it ideal for high-traffic applications like gaming. RDS and Aurora have higher latency, and Redshift is designed for analytics, not OLTP workloads."
            },
            {
                question: "Which AWS database service would be MOST appropriate for a data warehouse that needs to analyze petabytes of data using SQL?",
                options: [
                    "Amazon RDS",
                    "Amazon DynamoDB",
                    "Amazon Redshift",
                    "Amazon ElastiCache"
                ],
                correct: 2,
                category: "Database Services",
                explanation: "Amazon Redshift is a fully managed data warehouse service designed for analyzing large amounts of data using SQL. It uses columnar storage and massively parallel processing to deliver fast query performance on petabyte-scale datasets."
            },
            {
                question: "What is the primary benefit of using Amazon ElastiCache in an application architecture?",
                options: [
                    "Long-term data archival",
                    "Reducing database load by caching frequently accessed data",
                    "Running complex analytical queries",
                    "Storing unstructured data"
                ],
                correct: 1,
                category: "Database Services",
                explanation: "ElastiCache is an in-memory caching service that reduces database load by storing frequently accessed data in memory, providing sub-millisecond response times. This significantly improves application performance and reduces costs by decreasing database reads."
            },
            {
                question: "A company wants to use a MongoDB-compatible database service in AWS. Which service should they choose?",
                options: [
                    "Amazon DynamoDB",
                    "Amazon RDS",
                    "Amazon DocumentDB",
                    "Amazon Neptune"
                ],
                correct: 2,
                category: "Database Services",
                explanation: "Amazon DocumentDB is a fully managed document database service that supports MongoDB workloads. It implements the MongoDB 3.6, 4.0, and 5.0 APIs, making it compatible with existing MongoDB applications and tools."
            },
            {
                question: "Which feature of Amazon Aurora makes it different from standard MySQL or PostgreSQL on RDS?",
                options: [
                    "It only supports NoSQL data models",
                    "It provides up to 5x better performance and cloud-native architecture",
                    "It requires manual backups",
                    "It doesn't support read replicas"
                ],
                correct: 1,
                category: "Database Services",
                explanation: "Amazon Aurora is a cloud-native relational database that delivers up to 5x the performance of MySQL and 3x the performance of PostgreSQL. It features a distributed, fault-tolerant storage system that automatically scales up to 128TB and provides better availability than standard RDS."
            },

            // VPC & Networking (Ch 10) - 5 questions
            {
                question: "What is the maximum number of Internet Gateways that can be attached to a single VPC?",
                options: [
                    "Unlimited",
                    "One per subnet",
                    "Only one",
                    "One per Availability Zone"
                ],
                correct: 2,
                category: "VPC & Networking",
                explanation: "Only one Internet Gateway can be attached to a VPC at a time. The IGW is horizontally scaled, redundant, and highly available by default, so multiple IGWs are not needed or supported for redundancy."
            },
            {
                question: "A company has instances in a private subnet that need to download software updates from the internet. What should they use?",
                options: [
                    "Internet Gateway",
                    "NAT Gateway",
                    "Virtual Private Gateway",
                    "VPC Peering"
                ],
                correct: 1,
                category: "VPC & Networking",
                explanation: "A NAT Gateway enables instances in a private subnet to initiate outbound connections to the internet (for updates, downloads, etc.) while preventing the internet from initiating inbound connections. It must be placed in a public subnet."
            },
            {
                question: "Which statement is TRUE about the difference between Security Groups and Network ACLs?",
                options: [
                    "Security Groups are stateless, Network ACLs are stateful",
                    "Security Groups are stateful, Network ACLs are stateless",
                    "Both are stateless",
                    "Both are stateful"
                ],
                correct: 1,
                category: "VPC & Networking",
                explanation: "Security Groups are stateful (return traffic is automatically allowed), while Network ACLs are stateless (both inbound and outbound rules must be configured). Security Groups operate at the instance level, while NACLs operate at the subnet level."
            },
            {
                question: "Which type of load balancer operates at Layer 7 (Application Layer) and is best suited for HTTP/HTTPS traffic with advanced routing capabilities?",
                options: [
                    "Classic Load Balancer",
                    "Network Load Balancer",
                    "Application Load Balancer",
                    "Gateway Load Balancer"
                ],
                correct: 2,
                category: "VPC & Networking",
                explanation: "Application Load Balancer (ALB) operates at Layer 7 and is designed for HTTP/HTTPS traffic. It provides advanced routing features like host-based routing, path-based routing, and can route to multiple target groups based on request content."
            },
            {
                question: "What AWS service would you use to privately connect your VPC to S3 without requiring internet access?",
                options: [
                    "NAT Gateway",
                    "Internet Gateway",
                    "VPC Endpoint",
                    "Direct Connect"
                ],
                correct: 2,
                category: "VPC & Networking",
                explanation: "VPC Endpoints enable private connectivity between your VPC and supported AWS services without requiring an Internet Gateway, NAT device, VPN, or AWS Direct Connect. S3 uses Gateway Endpoints, which are free of charge."
            },

            // Automation (Ch 11) - 5 questions
            {
                question: "Which AWS service allows you to model and provision AWS resources using JSON or YAML templates?",
                options: [
                    "AWS Elastic Beanstalk",
                    "AWS CloudFormation",
                    "AWS OpsWorks",
                    "AWS Systems Manager"
                ],
                correct: 1,
                category: "Automation & Deployment",
                explanation: "AWS CloudFormation provides Infrastructure as Code (IaC) capabilities using JSON or YAML templates. It allows you to model, provision, and manage AWS and third-party resources by treating infrastructure as code, enabling version control and repeatable deployments."
            },
            {
                question: "A developer wants to quickly deploy a web application without managing any infrastructure. Which service is BEST suited for this requirement?",
                options: [
                    "AWS CloudFormation",
                    "AWS Elastic Beanstalk",
                    "AWS OpsWorks",
                    "Amazon EC2"
                ],
                correct: 1,
                category: "Automation & Deployment",
                explanation: "AWS Elastic Beanstalk is a Platform as a Service (PaaS) that allows developers to deploy applications by simply uploading code. Beanstalk automatically handles deployment, capacity provisioning, load balancing, auto-scaling, and health monitoring without requiring infrastructure management."
            },
            {
                question: "What is a primary benefit of using Infrastructure as Code (IaC)?",
                options: [
                    "It eliminates the need for version control",
                    "It allows infrastructure to be version controlled and deployed consistently",
                    "It requires more manual configuration than traditional methods",
                    "It only works with on-premises infrastructure"
                ],
                correct: 1,
                category: "Automation & Deployment",
                explanation: "Infrastructure as Code allows you to manage infrastructure using code that can be version controlled, tested, and deployed consistently across environments. This reduces manual errors, improves repeatability, and enables infrastructure to be treated with the same rigor as application code."
            },
            {
                question: "Which AWS service provides a managed Chef and Puppet automation platform?",
                options: [
                    "AWS CloudFormation",
                    "AWS Elastic Beanstalk",
                    "AWS OpsWorks",
                    "AWS CodeDeploy"
                ],
                correct: 2,
                category: "Automation & Deployment",
                explanation: "AWS OpsWorks provides managed instances of Chef and Puppet, which are popular configuration management platforms. OpsWorks helps automate server configuration, deployment, and management tasks using recipes (Chef) or manifests (Puppet)."
            },
            {
                question: "What AWS Systems Manager feature allows you to securely access EC2 instances without opening inbound ports or managing SSH keys?",
                options: [
                    "Run Command",
                    "Session Manager",
                    "Patch Manager",
                    "Parameter Store"
                ],
                correct: 1,
                category: "Automation & Deployment",
                explanation: "AWS Systems Manager Session Manager provides secure, browser-based shell access to EC2 instances without requiring open inbound ports, bastion hosts, or SSH keys. It also provides audit logging of all session activity for compliance."
            },

            // Use Cases & Best Practices (Ch 12) - 5 questions
            {
                question: "Which disaster recovery strategy provides the fastest recovery time (RTO) but has the highest cost?",
                options: [
                    "Backup and Restore",
                    "Pilot Light",
                    "Warm Standby",
                    "Multi-Site Active-Active"
                ],
                correct: 3,
                category: "Use Cases & Architecture",
                explanation: "Multi-Site Active-Active is the most expensive DR strategy but provides the fastest recovery (near-zero RTO and RPO). It runs full production capacity simultaneously in multiple regions, allowing instant failover but requiring payment for all resources at all times."
            },
            {
                question: "A company wants to host a static website with global low-latency access. Which combination of services is MOST cost-effective?",
                options: [
                    "EC2 with Auto Scaling and CloudFront",
                    "S3 with CloudFront",
                    "Elastic Beanstalk with Route 53",
                    "Lambda with API Gateway"
                ],
                correct: 1,
                category: "Use Cases & Architecture",
                explanation: "For static websites, S3 with CloudFront is the most cost-effective solution. S3 provides cheap, durable storage with built-in static website hosting, and CloudFront provides global CDN caching for low-latency access worldwide. No servers are needed, significantly reducing costs."
            },
            {
                question: "Which AWS service combination is BEST for building a real-time data processing pipeline from IoT devices?",
                options: [
                    "S3 and Redshift",
                    "Kinesis Data Streams and Lambda",
                    "RDS and ElastiCache",
                    "CloudFormation and Elastic Beanstalk"
                ],
                correct: 1,
                category: "Use Cases & Architecture",
                explanation: "Kinesis Data Streams can ingest real-time data from millions of IoT devices, and Lambda can process each record as it arrives in real-time. This serverless combination scales automatically and processes data with minimal latency."
            },
            {
                question: "A company needs to connect their on-premises data center to AWS with a dedicated, private network connection. Which service should they use?",
                options: [
                    "VPN Connection",
                    "AWS Direct Connect",
                    "Internet Gateway",
                    "VPC Peering"
                ],
                correct: 1,
                category: "Use Cases & Architecture",
                explanation: "AWS Direct Connect provides a dedicated private connection from on-premises to AWS, bypassing the public internet. It offers more consistent network performance, lower latency, and can reduce network costs compared to internet-based connections, making it ideal for hybrid architectures."
            },
            {
                question: "What is the primary benefit of using a multi-account strategy with AWS Organizations?",
                options: [
                    "It increases the cost of AWS services",
                    "It provides blast radius containment and simplified billing",
                    "It eliminates the need for IAM roles",
                    "It requires separate billing for each account"
                ],
                correct: 1,
                category: "Use Cases & Architecture",
                explanation: "A multi-account strategy using AWS Organizations provides blast radius containment (isolating failures and security issues to individual accounts), simplified consolidated billing, volume discounts, environment isolation (dev/test/prod), and centralized governance through Service Control Policies (SCPs)."
            }
        ];

        let currentQuestionIndex = 0;
        let score = 0;
        let selectedAnswer = null;
        let categoryScores = {};

        function initQuiz() {
            // Initialize category scores
            questions.forEach(q => {
                if (!categoryScores[q.category]) {
                    categoryScores[q.category] = { correct: 0, total: 0 };
                }
                categoryScores[q.category].total++;
            });
            renderQuestion();
        }

        function renderQuestion() {
            const container = document.getElementById('quizContainer');
            const question = questions[currentQuestionIndex];

            const questionHTML = `
                <div class="question-card active">
                    <div class="question-number">Question ${currentQuestionIndex + 1} of ${questions.length}</div>
                    <div class="question-category">${question.category}</div>
                    <div class="question-text">${question.question}</div>
                    <div class="options" id="options">
                        ${question.options.map((option, index) => `
                            <div class="option" onclick="selectOption(${index})">
                                <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                                <div class="option-text">${option}</div>
                            </div>
                        `).join('')}
                    </div>
                    <div class="explanation" id="explanation">
                        <div class="explanation-title">‚úì Correct Answer</div>
                        <div class="explanation-text">${question.explanation}</div>
                    </div>
                    <div class="button-container">
                        <button class="btn btn-secondary" onclick="previousQuestion()" ${currentQuestionIndex === 0 ? 'style="visibility: hidden;"' : ''}>
                            ‚Üê Previous
                        </button>
                        <button class="btn btn-primary" id="submitBtn" onclick="submitAnswer()" disabled>
                            Submit Answer
                        </button>
                        <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" style="display: none;">
                            ${currentQuestionIndex === questions.length - 1 ? 'View Results ‚Üí' : 'Next ‚Üí'}
                        </button>
                    </div>
                </div>
            `;

            container.innerHTML = questionHTML;
            updateProgress();
        }

        function selectOption(index) {
            if (selectedAnswer !== null) return;

            const options = document.querySelectorAll('.option');
            options.forEach(opt => opt.classList.remove('selected'));
            options[index].classList.add('selected');

            selectedAnswer = index;
            document.getElementById('submitBtn').disabled = false;
        }

        function submitAnswer() {
            if (selectedAnswer === null) return;

            const question = questions[currentQuestionIndex];
            const options = document.querySelectorAll('.option');

            options.forEach(opt => {
                opt.classList.add('disabled');
                opt.onclick = null;
            });

            if (selectedAnswer === question.correct) {
                options[selectedAnswer].classList.add('correct');
                score++;
                categoryScores[question.category].correct++;
                updateScore();
            } else {
                options[selectedAnswer].classList.add('incorrect');
                options[question.correct].classList.add('correct');
            }

            document.getElementById('explanation').classList.add('show');
            document.getElementById('submitBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'block';
        }

        function nextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                selectedAnswer = null;
                renderQuestion();
            } else {
                showResults();
            }
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                selectedAnswer = null;
                renderQuestion();
            }
        }

        function updateProgress() {
            const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
        }

        function updateScore() {
            document.getElementById('currentScore').textContent = score;
        }

        function showResults() {
            document.getElementById('quizContainer').style.display = 'none';
            document.querySelector('.quiz-header').style.display = 'none';
            document.querySelector('.exam-info').style.display = 'none';

            const percentage = Math.round((score / questions.length) * 100);
            const passed = percentage >= 70;
            const resultsCard = document.getElementById('resultsCard');

            let icon, title, message;
            if (passed) {
                if (percentage >= 90) {
                    icon = 'üèÜ';
                    title = 'Outstanding Achievement!';
                    message = 'You have demonstrated excellent mastery of AWS Cloud Practitioner concepts!';
                } else if (percentage >= 80) {
                    icon = 'üéâ';
                    title = 'Congratulations!';
                    message = 'You passed with a strong understanding of AWS fundamentals.';
                } else {
                    icon = '‚úÖ';
                    title = 'You Passed!';
                    message = 'You have met the requirements for AWS Cloud Practitioner knowledge.';
                }
            } else {
                icon = 'üìö';
                title = 'Keep Learning!';
                message = 'Review the material and retake the exam. You need 70% to pass.';
            }

            document.getElementById('resultsIcon').textContent = icon;
            document.getElementById('resultsTitle').textContent = title;
            document.getElementById('resultsScore').textContent = percentage + '%';
            document.getElementById('resultsMessage').textContent = message;
            document.getElementById('correctCount').textContent = score;
            document.getElementById('incorrectCount').textContent = questions.length - score;
            document.getElementById('percentageScore').textContent = percentage + '%';
            document.getElementById('passStatus').textContent = passed ? 'PASS' : 'FAIL';
            document.getElementById('passStatus').style.color = passed ? '#28a745' : '#dc3545';

            // Category breakdown
            const categoryBreakdownHTML = Object.entries(categoryScores).map(([category, scores]) => {
                const categoryPercentage = Math.round((scores.correct / scores.total) * 100);
                return `
                    <div class="category-item">
                        <div class="category-name">${category}</div>
                        <div class="category-score">
                            <span>${scores.correct}/${scores.total}</span>
                            <div class="score-bar">
                                <div class="score-fill" style="width: ${categoryPercentage}%"></div>
                            </div>
                            <span>${categoryPercentage}%</span>
                        </div>
                    </div>
                `;
            }).join('');

            document.getElementById('categoryBreakdown').innerHTML = '<h3 style="color: #e94560; margin-bottom: 1rem;">Performance by Category</h3>' + categoryBreakdownHTML;

            resultsCard.classList.add('show');

            // Trigger achievement system
            if (typeof ModuleProgress !== 'undefined') {
                ModuleProgress.completeQuiz('cloud', 'ch12-aws-final-quiz', percentage, {
                    maxScore: 100,
                    showNotification: true
                });
            }
        }

        function restartQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            selectedAnswer = null;

            // Reset category scores
            Object.keys(categoryScores).forEach(category => {
                categoryScores[category].correct = 0;
            });

            document.getElementById('quizContainer').style.display = 'block';
            document.querySelector('.quiz-header').style.display = 'block';
            document.querySelector('.exam-info').style.display = 'block';
            document.getElementById('resultsCard').classList.remove('show');

            updateScore();
            renderQuestion();
        }

        initQuiz();
    </script>
<script src="../../../../components/FluxCapacitor.js"></script>
</body>
</html>
