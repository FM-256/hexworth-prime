<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="../../../components/AccessGuard.js"></script>
    <script>AccessGuard.require('sorted');</script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSE-07 Quiz: Risk Assessment & Management - House of the Cloud</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --cloud-primary: #06b6d4; --cloud-light: #22d3ee; --cloud-dark: #0891b2;
            --dark-bg: #0f172a; --darker-bg: #020617; --card-bg: #1e293b;
            --light-text: #f1f5f9; --gray-text: #94a3b8;
            --correct: #10b981; --incorrect: #ef4444;
        }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: linear-gradient(135deg, var(--darker-bg) 0%, var(--dark-bg) 100%); color: var(--light-text); min-height: 100vh; line-height: 1.6; }
        .header { background: linear-gradient(135deg, var(--cloud-dark) 0%, var(--cloud-primary) 100%); padding: 1.25rem 2rem; position: sticky; top: 0; z-index: 100; }
        .header-content { max-width: 900px; margin: 0 auto; display: flex; align-items: center; justify-content: space-between; }
        .back-button { background: rgba(255, 255, 255, 0.15); border: 2px solid rgba(255, 255, 255, 0.25); color: white; padding: 0.5rem 1.25rem; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.3s ease; }
        .back-button:hover { background: rgba(255, 255, 255, 0.25); }
        .quiz-badge { background: white; color: var(--cloud-dark); padding: 0.5rem 1rem; border-radius: 20px; font-weight: 700; font-size: 0.85rem; }
        .container { max-width: 800px; margin: 0 auto; padding: 2rem; }
        .quiz-header { text-align: center; margin-bottom: 2rem; }
        .quiz-title { font-size: 1.75rem; color: var(--cloud-primary); margin-bottom: 0.5rem; }
        .quiz-subtitle { color: var(--gray-text); }
        .progress-bar { background: var(--card-bg); border-radius: 10px; height: 8px; margin-bottom: 2rem; overflow: hidden; }
        .progress-fill { background: linear-gradient(90deg, var(--cloud-primary), var(--cloud-light)); height: 100%; width: 0%; transition: width 0.3s ease; border-radius: 10px; }
        .question-card { background: var(--card-bg); border-radius: 16px; padding: 2rem; margin-bottom: 1.5rem; border: 1px solid rgba(255, 255, 255, 0.05); }
        .question-number { color: var(--cloud-primary); font-size: 0.85rem; font-weight: 600; margin-bottom: 0.5rem; }
        .question-text { font-size: 1.1rem; margin-bottom: 1.5rem; color: var(--light-text); }
        .options { display: flex; flex-direction: column; gap: 0.75rem; }
        .option { background: rgba(255, 255, 255, 0.03); border: 2px solid rgba(255, 255, 255, 0.1); border-radius: 10px; padding: 1rem 1.25rem; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 0.75rem; }
        .option:hover:not(.disabled) { border-color: var(--cloud-primary); background: rgba(6, 182, 212, 0.1); }
        .option.selected { border-color: var(--cloud-primary); background: rgba(6, 182, 212, 0.15); }
        .option.correct { border-color: var(--correct); background: rgba(16, 185, 129, 0.15); }
        .option.incorrect { border-color: var(--incorrect); background: rgba(239, 68, 68, 0.15); }
        .option.disabled { cursor: not-allowed; opacity: 0.7; }
        .option-letter { width: 28px; height: 28px; border-radius: 50%; background: rgba(255, 255, 255, 0.1); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.85rem; flex-shrink: 0; }
        .option.selected .option-letter { background: var(--cloud-primary); color: var(--darker-bg); }
        .option.correct .option-letter { background: var(--correct); color: white; }
        .option.incorrect .option-letter { background: var(--incorrect); color: white; }
        .explanation { margin-top: 1rem; padding: 1rem; background: rgba(16, 185, 129, 0.1); border-radius: 8px; border-left: 3px solid var(--correct); display: none; }
        .explanation.show { display: block; }
        .explanation-title { color: var(--correct); font-weight: 600; margin-bottom: 0.25rem; font-size: 0.9rem; }
        .explanation-text { color: var(--gray-text); font-size: 0.9rem; }
        .submit-btn { width: 100%; padding: 1rem; background: var(--cloud-primary); color: var(--darker-bg); border: none; border-radius: 12px; font-size: 1.1rem; font-weight: 700; cursor: pointer; transition: all 0.3s ease; margin-top: 1rem; }
        .submit-btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(6, 182, 212, 0.4); }
        .submit-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .results { background: var(--card-bg); border-radius: 16px; padding: 2rem; text-align: center; display: none; }
        .results.show { display: block; }
        .results-score { font-size: 3rem; font-weight: 700; color: var(--cloud-primary); margin-bottom: 0.5rem; }
        .results-text { color: var(--gray-text); margin-bottom: 1.5rem; }
        .results-bar { background: rgba(255, 255, 255, 0.1); border-radius: 10px; height: 12px; overflow: hidden; margin-bottom: 1.5rem; }
        .results-fill { height: 100%; border-radius: 10px; transition: width 0.5s ease; }
        .retry-btn { background: transparent; border: 2px solid var(--cloud-primary); color: var(--cloud-primary); padding: 0.75rem 2rem; border-radius: 10px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
        .retry-btn:hover { background: var(--cloud-primary); color: var(--darker-bg); }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="../index.html" class="back-button">< Cloud House</a>
            <span class="quiz-badge">CSE-07 Quiz</span>
        </div>
    </header>

    <div class="container">
        <div class="quiz-header">
            <h1 class="quiz-title">Risk Assessment & Management</h1>
            <p class="quiz-subtitle">Test your knowledge of cloud risk management concepts</p>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>

        <div id="quizContainer"></div>

        <button class="submit-btn" id="submitBtn" disabled onclick="submitQuiz()">Submit Answers</button>

        <div class="results" id="results">
            <div class="results-score" id="scoreText">0%</div>
            <p class="results-text" id="resultMessage">Keep studying!</p>
            <div class="results-bar">
                <div class="results-fill" id="resultsFill"></div>
            </div>
            <button class="retry-btn" onclick="retryQuiz()">Try Again</button>
        </div>
    </div>

    <script>
        const questions = [
            {
                question: "According to Gartner, what percentage of cloud security failures through 2025 will be due to human error?",
                options: ["50%", "75%", "99%", "85%"],
                correct: 2,
                explanation: "According to Gartner, through 2025, 99% of all cloud security failures will be due to some level of human error. This highlights the importance of training, automation, and proper configuration management."
            },
            {
                question: "What are the four steps in the Risk Management cycle?",
                options: ["Plan, Do, Check, Act", "Frame, Assess, Respond, Monitor", "Identify, Analyze, Evaluate, Treat", "Detect, Contain, Eradicate, Recover"],
                correct: 1,
                explanation: "The Risk Management cycle consists of four continuous steps: Frame (define strategy and tolerance), Assess (identify threats and vulnerabilities), Respond (implement controls), and Monitor (ongoing assessment)."
            },
            {
                question: "What does the formula ALE = SLE × ARO calculate?",
                options: ["Average Liability Expense", "Annualized Loss Expectancy", "Asset Loss Estimate", "Annual Liability Estimation"],
                correct: 1,
                explanation: "ALE (Annualized Loss Expectancy) = SLE (Single Loss Expectancy) × ARO (Annualized Rate of Occurrence). This quantitative formula helps calculate the expected yearly financial loss from a specific risk."
            },
            {
                question: "Which risk category describes catastrophic impact where the business may cease to exist?",
                options: ["Low Risk", "Moderate Risk", "High Risk", "Critical Risk"],
                correct: 2,
                explanation: "High Risk represents severe and catastrophic impact to the company. Financial loss will most likely cause the business to cease to exist, recovery is very unlikely, and it could involve loss of life."
            },
            {
                question: "What is the principle of 'Defense in Depth'?",
                options: ["Using the deepest encryption algorithms", "One strong layer of protection is sufficient", "Multiple layers of security controls", "Protecting only the most critical assets"],
                correct: 2,
                explanation: "Defense in Depth is the principle that one level of protection is not enough. It requires a complete approach using multiple layers of security controls to protect data and systems."
            },
            {
                question: "Which risk response involves purchasing cyber insurance?",
                options: ["Mitigate", "Avoid", "Accept", "Transfer"],
                correct: 3,
                explanation: "Transfer (or Share) means having someone else take on the risk. Examples include cyber insurance or using cloud services where the provider assumes some responsibility."
            },
            {
                question: "What are the seven steps in NIST Risk Management Framework (SP 800-37)?",
                options: ["Plan, Do, Check, Act, Monitor, Review, Approve", "Prepare, Categorize, Select, Implement, Assess, Authorize, Monitor", "Identify, Protect, Detect, Respond, Recover, Govern, Monitor", "Frame, Analyze, Design, Build, Test, Deploy, Maintain"],
                correct: 1,
                explanation: "NIST RMF (SP 800-37) consists of seven steps: Prepare, Categorize, Select, Implement, Assess, Authorize, and Monitor. This provides a structured approach to managing security and privacy risk."
            },
            {
                question: "What type of risk analysis is subjective, quick to implement, and uses probability/impact rankings?",
                options: ["Quantitative", "Qualitative", "Statistical", "Financial"],
                correct: 1,
                explanation: "Qualitative Risk Analysis is subjective and quick to implement. It identifies potential threats, assesses likelihood and impact, and presents results through a probability/impact ranking matrix using High/Medium/Low ratings."
            },
            {
                question: "Which common cloud vulnerability refers to the explosion of publicly available workloads from microservices adoption?",
                options: ["Human Error", "Misconfiguration", "Unmanaged Attack Surface", "Data Breach"],
                correct: 2,
                explanation: "Unmanaged Attack Surface refers to the total exposure of your environment. The adoption of microservices can lead to an explosion of publicly available workloads, which significantly adds to the attack surface."
            },
            {
                question: "What should you NEVER do when identifying a risk?",
                options: ["Accept it", "Transfer it", "Mitigate it", "Ignore it"],
                correct: 3,
                explanation: "You should NEVER ignore a risk! All identified risks must have a documented response - whether that's mitigate, avoid, accept, or transfer. Ignoring risks leaves the organization vulnerable to unmanaged threats."
            }
        ];

        let selectedAnswers = {};
        let submitted = false;

        function renderQuiz() {
            const container = document.getElementById('quizContainer');
            container.innerHTML = questions.map((q, i) => `
                <div class="question-card" id="question${i}">
                    <div class="question-number">Question ${i + 1} of ${questions.length}</div>
                    <div class="question-text">${q.question}</div>
                    <div class="options">
                        ${q.options.map((opt, j) => `
                            <div class="option" onclick="selectOption(${i}, ${j})" id="q${i}o${j}">
                                <span class="option-letter">${String.fromCharCode(65 + j)}</span>
                                <span>${opt}</span>
                            </div>
                        `).join('')}
                    </div>
                    <div class="explanation" id="exp${i}">
                        <div class="explanation-title">Explanation</div>
                        <div class="explanation-text">${q.explanation}</div>
                    </div>
                </div>
            `).join('');
        }

        function selectOption(questionIndex, optionIndex) {
            if (submitted) return;
            document.querySelectorAll(`#question${questionIndex} .option`).forEach(opt => opt.classList.remove('selected'));
            document.getElementById(`q${questionIndex}o${optionIndex}`).classList.add('selected');
            selectedAnswers[questionIndex] = optionIndex;
            updateProgress();
            document.getElementById('submitBtn').disabled = Object.keys(selectedAnswers).length !== questions.length;
        }

        function updateProgress() {
            const progress = (Object.keys(selectedAnswers).length / questions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function submitQuiz() {
            submitted = true;
            let correct = 0;
            questions.forEach((q, i) => {
                const options = document.querySelectorAll(`#question${i} .option`);
                options.forEach(opt => opt.classList.add('disabled'));
                if (selectedAnswers[i] === q.correct) {
                    document.getElementById(`q${i}o${q.correct}`).classList.add('correct');
                    correct++;
                } else {
                    if (selectedAnswers[i] !== undefined) {
                        document.getElementById(`q${i}o${selectedAnswers[i]}`).classList.add('incorrect');
                    }
                    document.getElementById(`q${i}o${q.correct}`).classList.add('correct');
                }
                document.getElementById(`exp${i}`).classList.add('show');
            });
            const percentage = Math.round((correct / questions.length) * 100);
            document.getElementById('scoreText').textContent = percentage + '%';
            document.getElementById('resultsFill').style.width = percentage + '%';
            document.getElementById('resultsFill').style.background = percentage >= 70 ? 'var(--correct)' : 'var(--incorrect)';
            document.getElementById('resultMessage').textContent = percentage >= 70 ? 'Great job! You passed!' : 'Keep studying and try again!';
            document.getElementById('submitBtn').style.display = 'none';
            document.getElementById('results').classList.add('show');
            if (typeof ProgressManager !== 'undefined' && percentage >= 70) {
                ProgressManager.markProgress('cloud', 'cse-07-quiz', 'complete');
            }
        }

        function retryQuiz() {
            submitted = false;
            selectedAnswers = {};
            document.getElementById('submitBtn').style.display = 'block';
            document.getElementById('submitBtn').disabled = true;
            document.getElementById('results').classList.remove('show');
            renderQuiz();
            updateProgress();
        }

        renderQuiz();
    </script>
    <script src="../../../components/ProgressManager.js"></script>
</body>
</html>
