<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hexworth Prime - Choose Your Reality</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #0a0a0a 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #fff;
            overflow: hidden;
        }

        .reality-fork {
            text-align: center;
            padding: 40px;
            position: relative;
            z-index: 10;
        }

        .title {
            font-size: 2.5rem;
            font-weight: 300;
            letter-spacing: 0.5em;
            margin-bottom: 10px;
            text-transform: uppercase;
            opacity: 0;
            animation: fadeSlideDown 1s ease 0.3s forwards;
        }

        .subtitle {
            font-size: 1rem;
            color: #666;
            letter-spacing: 0.3em;
            margin-bottom: 60px;
            opacity: 0;
            animation: fadeSlideDown 1s ease 0.5s forwards;
        }

        @keyframes fadeSlideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .choices {
            display: flex;
            gap: 60px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .choice {
            width: 280px;
            padding: 40px 30px;
            border: 1px solid #222;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.4s ease;
            opacity: 0;
            animation: fadeIn 1s ease forwards;
            background: rgba(20, 20, 30, 0.5);
        }

        .choice:nth-child(1) { animation-delay: 0.8s; }
        .choice:nth-child(2) { animation-delay: 1s; }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        .choice:hover {
            transform: translateY(-10px);
            border-color: #444;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }

        .choice-icon {
            font-size: 3rem;
            margin-bottom: 20px;
        }

        .choice-title {
            font-size: 1.5rem;
            font-weight: 600;
            letter-spacing: 0.1em;
        }

        /* Magic Theme Preview */
        .choice.magic:hover {
            border-color: #9f7aea;
            box-shadow: 0 20px 40px rgba(159, 122, 234, 0.2);
        }

        .choice.magic:hover .choice-icon {
            text-shadow: 0 0 30px rgba(159, 122, 234, 0.8);
        }

        /* Matrix Theme Preview */
        .choice.matrix:hover {
            border-color: #22c55e;
            box-shadow: 0 20px 40px rgba(34, 197, 94, 0.2);
        }

        .choice.matrix:hover .choice-icon {
            text-shadow: 0 0 30px rgba(34, 197, 94, 0.8);
        }

        .footer-note {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7rem;
            color: #333;
            letter-spacing: 0.2em;
            opacity: 0;
            animation: fadeIn 1s ease 1.5s forwards;
            z-index: 10;
        }

        /* Returning User Panel */
        .returning-user {
            display: none;
            text-align: center;
            padding: 40px;
            position: relative;
            z-index: 10;
        }

        .returning-user.show {
            display: block;
        }

        .returning-user .welcome-back {
            font-size: 1.2rem;
            color: #888;
            letter-spacing: 0.2em;
            margin-bottom: 10px;
            opacity: 0;
            animation: fadeSlideDown 0.8s ease 0.2s forwards;
        }

        .returning-user .identity {
            font-size: 1.8rem;
            font-weight: 300;
            letter-spacing: 0.15em;
            margin-bottom: 30px;
            opacity: 0;
            animation: fadeSlideDown 0.8s ease 0.4s forwards;
        }

        .returning-user .identity.magic {
            color: #9f7aea;
            text-shadow: 0 0 20px rgba(159, 122, 234, 0.4);
        }

        .returning-user .identity.matrix {
            color: #00ff41;
            text-shadow: 0 0 20px rgba(0, 255, 65, 0.4);
            font-family: 'Courier New', monospace;
        }

        .returning-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            opacity: 0;
            animation: fadeSlideDown 0.8s ease 0.6s forwards;
        }

        .return-btn {
            padding: 15px 40px;
            border-radius: 8px;
            font-size: 0.9rem;
            letter-spacing: 0.15em;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .return-btn.primary {
            background: linear-gradient(135deg, #9f7aea, #7c3aed);
            border: none;
            color: #fff;
        }

        .return-btn.primary.matrix {
            background: linear-gradient(135deg, #00aa2a, #006620);
        }

        .return-btn.primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(159, 122, 234, 0.3);
        }

        .return-btn.primary.matrix:hover {
            box-shadow: 0 10px 30px rgba(0, 255, 65, 0.3);
        }

        .return-btn.secondary {
            background: transparent;
            border: 1px solid #444;
            color: #666;
        }

        .return-btn.secondary:hover {
            border-color: #888;
            color: #aaa;
        }

        .reality-fork.hidden {
            display: none;
        }

        /* Placeholder notice */
        .dev-notice {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
            border-radius: 6px;
            font-size: 0.75rem;
            color: #ffc107;
            letter-spacing: 0.1em;
            z-index: 10;
        }
    </style>
</head>
<body>
    <div class="dev-notice">PRIME v0.1.0 - DEVELOPMENT</div>

    <!-- Returning User Panel -->
    <div class="returning-user" id="returningUser">
        <div class="welcome-back">WELCOME BACK</div>
        <div class="identity" id="userIdentity"></div>
        <div class="returning-buttons">
            <button class="return-btn primary" id="continueBtn" onclick="continueJourney()">CONTINUE</button>
            <button class="return-btn secondary" onclick="startFresh()">START FRESH</button>
        </div>
    </div>

    <!-- New User - Choose Reality -->
    <div class="reality-fork" id="realityFork">
        <h1 class="title">Choose Your Reality</h1>
        <p class="subtitle">Two paths lie before you. Which will you take?</p>

        <div class="choices">
            <div class="choice magic" onclick="selectReality('magic')">
                <div class="choice-icon">âœ¨</div>
                <div class="choice-title">Magic</div>
            </div>

            <div class="choice matrix" onclick="selectReality('matrix')">
                <div class="choice-icon">ðŸ”¢</div>
                <div class="choice-title">Matrix</div>
            </div>
        </div>
    </div>

    <div class="footer-note">HEXWORTH PRIME</div>

    <!-- Transitions -->
    <link rel="stylesheet" href="styles/transitions.css">

    <!-- Load configuration -->
    <script src="config/cipher.js"></script>
    <script src="config/paths.js"></script>

    <!-- Digital Life - Ambient Backdrop -->
    <!-- Core -->
    <script src="digital-life/core/Firefly.js"></script>
    <script src="digital-life/core/Ecosystem.js"></script>
    <!-- Effects -->
    <script src="digital-life/effects/Particles.js"></script>
    <script src="digital-life/effects/ShootingStar.js"></script>
    <script src="digital-life/effects/AmbientEffects.js"></script>
    <script src="digital-life/effects/Trails.js"></script>
    <!-- Entities -->
    <script src="digital-life/entities/BlackHole.js"></script>
    <script src="digital-life/entities/Moon.js"></script>
    <script src="digital-life/entities/Planet.js"></script>
    <script src="digital-life/entities/EnergyWell.js"></script>
    <script src="digital-life/entities/PredatorStar.js"></script>
    <script src="digital-life/entities/ShadowFirefly.js"></script>
    <script src="digital-life/entities/VoidSerpent.js"></script>
    <script src="digital-life/entities/Parasite.js"></script>
    <script src="digital-life/entities/Portal.js"></script>
    <script src="digital-life/entities/Sanctuary.js"></script>
    <!-- Interactions -->
    <script src="digital-life/interactions/PlayerTools.js"></script>
    <!-- Behaviors -->
    <script src="digital-life/behaviors/Hunting.js"></script>
    <script src="digital-life/behaviors/Swarming.js"></script>
    <script src="digital-life/behaviors/Constellation.js"></script>
    <script src="digital-life/behaviors/Reproduction.js"></script>
    <script src="digital-life/behaviors/HousePersonality.js"></script>
    <script src="digital-life/behaviors/RareFireflies.js"></script>
    <script src="digital-life/behaviors/InteractionSystem.js"></script>
    <script src="digital-life/behaviors/EnvironmentalSystem.js"></script>
    <script src="digital-life/behaviors/Genetics.js"></script>
    <script src="digital-life/behaviors/Pheromones.js"></script>
    <script src="digital-life/behaviors/PredatorManager.js"></script>
    <!-- Cosmic Events -->
    <script src="digital-life/events/CosmicEventManager.js"></script>
    <script src="digital-life/events/SolarFlare.js"></script>
    <script src="digital-life/events/MeteorShower.js"></script>
    <script src="digital-life/events/VoidStorm.js"></script>
    <script src="digital-life/events/Eclipse.js"></script>
    <script src="digital-life/events/NebulaDrift.js"></script>
    <!-- Meta Systems (disabled in ambient mode, but needed for class) -->
    <script src="digital-life/meta/Achievements.js"></script>
    <script src="digital-life/meta/Statistics.js"></script>
    <script src="digital-life/meta/EventLog.js"></script>
    <!-- Audio (disabled in ambient mode) -->
    <script src="digital-life/audio/SoundManager.js"></script>
    <script src="digital-life/audio/EventSounds.js"></script>
    <script src="digital-life/audio/AmbientLayer.js"></script>
    <!-- Main -->
    <script src="digital-life/index.js"></script>
    <!-- Components -->
    <script src="components/SoundToggle.js"></script>
    <!-- Transitions -->
    <script src="utils/transitions.js"></script>

    <script>
        // Digital Life - Ambient Mode
        let digitalLife;

        // House name mappings for display
        const houseNames = {
            'web': 'House of the Web',
            'shield': 'House of the Shield',
            'forge': 'House of the Forge',
            'script': 'House of the Script',
            'cloud': 'House of the Cloud',
            'code': 'House of the Code',
            'key': 'House of the Key',
            'eye': 'House of the Eye',
            'dark-arts': 'House of the Dark Arts',
            'operator': 'OPERATOR'
        };

        function initDigitalLife() {
            // Initialize in ambient mode - non-intrusive backdrop
            digitalLife = DigitalLife.createAmbient();
            digitalLife.init(document.body);
            console.log('âœ¨ Digital Life ambient backdrop initialized');

            // Add floating sound toggle
            const soundToggle = new SoundToggle(digitalLife, {
                position: 'bottom-right',
                margin: 25
            });
            soundToggle.init();
        }

        function selectReality(theme) {
            // Store theme preference
            localStorage.setItem('hexworth_theme', theme);

            if (theme === 'matrix') {
                // Matrix users bypass sorting - they chose their identity
                PageTransition.navigateTo('connect.html', 'matrix');
            } else {
                // Magic users go through the sorting quiz
                PageTransition.navigateTo('sorting.html', 'magic');
            }
        }

        function continueJourney() {
            const theme = localStorage.getItem('hexworth_theme');
            const house = localStorage.getItem('hexworth_house');

            if (theme === 'matrix') {
                PageTransition.navigateTo('terminal.html', 'matrix');
            } else if (house) {
                PageTransition.navigateTo('dashboard.html', 'magic');
            } else {
                // Has theme but no house - go to sorting
                PageTransition.navigateTo('sorting.html', 'magic');
            }
        }

        function startFresh() {
            // Clear all user data
            localStorage.removeItem('hexworth_theme');
            localStorage.removeItem('hexworth_house');
            localStorage.removeItem('hexworth_progress');

            // Show the reality selection
            document.getElementById('returningUser').classList.remove('show');
            document.getElementById('realityFork').classList.remove('hidden');
        }

        function checkReturningUser() {
            const theme = localStorage.getItem('hexworth_theme');
            const house = localStorage.getItem('hexworth_house');

            // User has completed setup (has theme AND house/operator)
            if (theme && house) {
                const identityEl = document.getElementById('userIdentity');
                const continueBtn = document.getElementById('continueBtn');

                if (theme === 'matrix') {
                    identityEl.textContent = '> OPERATOR STATUS: ACTIVE';
                    identityEl.classList.add('matrix');
                    continueBtn.classList.add('matrix');
                } else {
                    identityEl.textContent = houseNames[house] || house;
                    identityEl.classList.add('magic');
                }

                // Show returning user panel, hide reality fork
                document.getElementById('returningUser').classList.add('show');
                document.getElementById('realityFork').classList.add('hidden');

                return true;
            }

            return false;
        }

        // Initialize after DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            // Start ambient fireflies
            initDigitalLife();

            // Check if returning user
            checkReturningUser();
        });
    </script>
</body>
</html>
