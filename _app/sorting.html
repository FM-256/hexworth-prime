<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hexworth Prime - The Sorting</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #0a0a0a 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #fff;
            overflow-x: hidden;
        }

        .sorting-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
            position: relative;
            z-index: 10;
        }

        .sorting-header {
            text-align: center;
            margin-bottom: 40px;
            opacity: 0;
            animation: fadeIn 1s ease 0.3s forwards;
        }

        .sorting-title {
            font-size: 2rem;
            font-weight: 300;
            letter-spacing: 0.4em;
            text-transform: uppercase;
            margin-bottom: 10px;
        }

        .sorting-subtitle {
            font-size: 0.9rem;
            color: #666;
            letter-spacing: 0.2em;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        /* Question Card */
        .question-card {
            background: rgba(20, 20, 30, 0.8);
            border: 1px solid #333;
            border-radius: 12px;
            padding: 40px;
            max-width: 700px;
            width: 100%;
            opacity: 0;
            animation: fadeIn 0.5s ease forwards;
        }

        .question-number {
            font-size: 0.75rem;
            color: #555;
            letter-spacing: 0.2em;
            margin-bottom: 20px;
        }

        .question-text {
            font-size: 1.15rem;
            line-height: 1.6;
            margin-bottom: 30px;
            color: #ddd;
        }

        .answers {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .answer {
            background: rgba(40, 40, 50, 0.5);
            border: 1px solid #333;
            border-radius: 8px;
            padding: 14px 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #aaa;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .answer:hover {
            border-color: #9f7aea;
            background: rgba(159, 122, 234, 0.1);
            color: #fff;
            transform: translateX(5px);
        }

        .answer.selected {
            border-color: #9f7aea;
            background: rgba(159, 122, 234, 0.2);
            color: #fff;
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            max-width: 700px;
            margin-bottom: 30px;
            opacity: 0;
            animation: fadeIn 1s ease 0.5s forwards;
        }

        .progress-bar {
            height: 4px;
            background: #222;
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #9f7aea, #38bdf8);
            border-radius: 2px;
            transition: width 0.5s ease;
        }

        .progress-text {
            text-align: right;
            font-size: 0.7rem;
            color: #555;
            margin-top: 8px;
            letter-spacing: 0.1em;
        }

        /* Result Screen */
        .result-container {
            text-align: center;
            max-width: 600px;
            display: none;
        }

        .result-container.show {
            display: block;
            animation: fadeIn 1s ease forwards;
        }

        .result-announcement {
            font-size: 1rem;
            color: #666;
            letter-spacing: 0.3em;
            margin-bottom: 20px;
        }

        .result-house {
            font-size: 2.5rem;
            font-weight: 300;
            letter-spacing: 0.15em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--house-color, #9f7aea), #38bdf8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .result-crest {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .result-domain {
            font-size: 1.1rem;
            color: #888;
            margin-bottom: 30px;
        }

        .result-description {
            font-size: 0.95rem;
            color: #aaa;
            line-height: 1.8;
            margin-bottom: 40px;
            padding: 0 20px;
        }

        .enter-button {
            background: linear-gradient(135deg, #9f7aea, #7c3aed);
            border: none;
            color: #fff;
            padding: 15px 50px;
            font-size: 1rem;
            letter-spacing: 0.2em;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .enter-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(159, 122, 234, 0.3);
        }

        /* House Colors - Aligned with content-registry.js */
        .house-web { --house-color: #60a5fa; }
        .house-shield { --house-color: #f87171; }
        .house-cloud { --house-color: #38bdf8; }
        .house-forge { --house-color: #fbbf24; }
        .house-script { --house-color: #a78bfa; }
        .house-code { --house-color: #4ade80; }
        .house-key { --house-color: #f472b6; }
        .house-eye { --house-color: #c084fc; }
        .house-dark-arts { --house-color: #6b21a8; }

        .footer-note {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7rem;
            color: #333;
            letter-spacing: 0.2em;
            z-index: 10;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .question-card {
                padding: 25px 20px;
            }
            .question-text {
                font-size: 1rem;
            }
            .answer {
                font-size: 0.85rem;
                padding: 12px 15px;
            }
            .result-house {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="sorting-container">
        <div class="sorting-header">
            <h1 class="sorting-title">The Sorting</h1>
            <p class="sorting-subtitle">Answer truthfully. The algorithm knows.</p>
        </div>

        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div class="progress-text"><span id="currentQ">1</span> / <span id="totalQ">15</span></div>
        </div>

        <div class="question-card" id="questionCard">
            <div class="question-number" id="questionNumber">QUESTION I</div>
            <div class="question-text" id="questionText"></div>
            <div class="answers" id="answers"></div>
        </div>

        <div class="result-container" id="resultContainer">
            <div class="result-announcement">YOU BELONG TO</div>
            <div class="result-crest" id="resultCrest"></div>
            <div class="result-house" id="resultHouse"></div>
            <div class="result-domain" id="resultDomain"></div>
            <div class="result-description" id="resultDescription"></div>
            <button class="enter-button" onclick="enterHouse()">ENTER</button>
        </div>
    </div>

    <div class="footer-note">HEXWORTH PRIME</div>

    <!-- Transitions -->
    <link rel="stylesheet" href="styles/transitions.css">

    <!-- Digital Life Scripts -->
    <script src="config/cipher.js"></script>
    <script src="config/paths.js"></script>
    <script src="digital-life/core/Firefly.js"></script>
    <script src="digital-life/core/Ecosystem.js"></script>
    <script src="digital-life/effects/Particles.js"></script>
    <script src="digital-life/effects/ShootingStar.js"></script>
    <script src="digital-life/effects/AmbientEffects.js"></script>
    <script src="digital-life/effects/Trails.js"></script>
    <script src="digital-life/entities/BlackHole.js"></script>
    <script src="digital-life/entities/Moon.js"></script>
    <script src="digital-life/entities/Planet.js"></script>
    <script src="digital-life/entities/EnergyWell.js"></script>
    <script src="digital-life/entities/PredatorStar.js"></script>
    <script src="digital-life/entities/ShadowFirefly.js"></script>
    <script src="digital-life/entities/VoidSerpent.js"></script>
    <script src="digital-life/entities/Parasite.js"></script>
    <script src="digital-life/entities/Portal.js"></script>
    <script src="digital-life/entities/Sanctuary.js"></script>
    <script src="digital-life/interactions/PlayerTools.js"></script>
    <script src="digital-life/behaviors/Hunting.js"></script>
    <script src="digital-life/behaviors/Swarming.js"></script>
    <script src="digital-life/behaviors/Constellation.js"></script>
    <script src="digital-life/behaviors/Reproduction.js"></script>
    <script src="digital-life/behaviors/HousePersonality.js"></script>
    <script src="digital-life/behaviors/RareFireflies.js"></script>
    <script src="digital-life/behaviors/InteractionSystem.js"></script>
    <script src="digital-life/behaviors/EnvironmentalSystem.js"></script>
    <script src="digital-life/behaviors/Genetics.js"></script>
    <script src="digital-life/behaviors/Pheromones.js"></script>
    <script src="digital-life/behaviors/PredatorManager.js"></script>
    <script src="digital-life/events/CosmicEventManager.js"></script>
    <script src="digital-life/events/SolarFlare.js"></script>
    <script src="digital-life/events/MeteorShower.js"></script>
    <script src="digital-life/events/VoidStorm.js"></script>
    <script src="digital-life/events/Eclipse.js"></script>
    <script src="digital-life/events/NebulaDrift.js"></script>
    <script src="digital-life/meta/Achievements.js"></script>
    <script src="digital-life/meta/Statistics.js"></script>
    <script src="digital-life/meta/EventLog.js"></script>
    <script src="digital-life/audio/SoundManager.js"></script>
    <script src="digital-life/audio/EventSounds.js"></script>
    <script src="digital-life/audio/AmbientLayer.js"></script>
    <script src="digital-life/index.js"></script>
    <script src="components/SoundToggle.js"></script>
    <script src="utils/transitions.js"></script>

    <script>
        // House definitions - 9 houses
        // Dark Arts is rare to get sorted into - represents those drawn to offensive security
        const houses = {
            web: {
                name: 'House of the Web',
                crest: 'ðŸ•¸ï¸',
                domain: 'Networking & Connections',
                description: 'You see the world as an interconnected tapestry. Where others see chaos, you see patterns of communication and flow. Networks speak to youâ€”every packet tells a story, every protocol a language waiting to be mastered.'
            },
            shield: {
                name: 'House of the Shield',
                crest: 'ðŸ›¡ï¸',
                domain: 'Security & Defense',
                description: 'Protection is your calling. You stand as the guardian between systems and those who would breach them. Your mind naturally fortifies, anticipates threats, and builds walls that others cannot see until they fail to penetrate them.'
            },
            forge: {
                name: 'House of the Forge',
                crest: 'âš’ï¸',
                domain: 'Hardware & Systems',
                description: 'The physical calls to you. While others live in abstraction, you understand that all magic flows through silicon and copper. You build with your hands what others only imagine in code.'
            },
            script: {
                name: 'House of the Script',
                crest: 'ðŸ“œ',
                domain: 'Automation & Efficiency',
                description: 'Why do something twice when a script can do it forever? You see repetition as a problem to be solved, manual work as an insult to intelligence. Your code works while you sleep.'
            },
            cloud: {
                name: 'House of the Cloud',
                crest: 'â˜ï¸',
                domain: 'Infrastructure & Scale',
                description: 'You think in architectures and infinite scale. The cloud is not abstract to youâ€”it is a realm of endless possibility where resources flex to your will. You build empires in the ether.'
            },
            code: {
                name: 'House of the Code',
                crest: 'ðŸ’»',
                domain: 'Development & DevOps',
                description: 'You are a builder of digital worlds. Logic flows through you like poetry, and systems emerge from your fingertips fully formed. Where others see problems, you see architectures waiting to be born.'
            },
            key: {
                name: 'House of the Key',
                crest: 'ðŸ”‘',
                domain: 'Cryptography & Identity',
                description: 'Secrets fascinate you. The dance of encryption and decryption, the mathematics of trust, the art of hiding in plain sightâ€”these are your tools. You speak in ciphers and think in algorithms.'
            },
            eye: {
                name: 'House of the Eye',
                crest: 'ðŸ‘ï¸',
                domain: 'Monitoring & Analysis',
                description: 'Nothing escapes your notice. You watch the watchers, analyze the analysts, and find meaning in the noise. Patterns emerge from chaos under your gaze, and anomalies reveal themselves to you alone.'
            },
            'dark-arts': {
                name: 'House of the Dark Arts',
                crest: 'ðŸŒ‘',
                domain: 'Offensive Security & Research',
                description: 'You walk the shadow path. To defend, one must understand attack. You study what others fear to touch, master techniques that others pretend do not exist. Knowledge is your weapon, curiosity your guide into the darkness.'
            }
        };

        // 15 Sorting Questions - each answer maps to one of 9 houses
        const questions = [
            {
                text: "When faced with a complex problem you've never seen before, what's your first instinct?",
                answers: [
                    { text: "Map out all the connections and trace the flow of data", house: 'web' },
                    { text: "Identify what could go wrong and secure the weak points first", house: 'shield' },
                    { text: "Take it apart to understand its physical components", house: 'forge' },
                    { text: "Write a small test program to isolate and understand the issue", house: 'script' },
                    { text: "Spin up a test environment in the cloud to experiment safely", house: 'cloud' },
                    { text: "Automate data collection to understand patterns first", house: 'code' },
                    { text: "Analyze the encryption and authentication mechanisms", house: 'key' },
                    { text: "Check the logs and metrics to see what's actually happening", house: 'eye' },
                    { text: "Find a way to break itâ€”understanding flaws reveals truth", house: 'dark-arts' }
                ]
            },
            {
                text: "You discover a critical flaw in a system everyone relies on. What do you do?",
                answers: [
                    { text: "Design an alternative path that routes around the problem", house: 'web' },
                    { text: "Document it responsibly and help patch the vulnerability", house: 'shield' },
                    { text: "Build a physical workaround or replacement component", house: 'forge' },
                    { text: "Write automation to detect and prevent exploitation", house: 'script' },
                    { text: "Deploy a cloud-based failover to maintain availability", house: 'cloud' },
                    { text: "Create a CI/CD pipeline to rapidly deploy the fix", house: 'code' },
                    { text: "Strengthen the cryptographic controls around the flaw", house: 'key' },
                    { text: "Set up real-time alerts to detect any exploitation attempts", house: 'eye' },
                    { text: "Study how an attacker would exploit it before disclosing", house: 'dark-arts' }
                ]
            },
            {
                text: "If you could master one ancient art, which would it be?",
                answers: [
                    { text: "Cartography - mapping unknown territories and connections", house: 'web' },
                    { text: "Alchemy - transforming and protecting precious materials", house: 'shield' },
                    { text: "Smithing - forging powerful artifacts from raw materials", house: 'forge' },
                    { text: "Rune-writing - encoding spells with precise symbols", house: 'script' },
                    { text: "Weather control - commanding the elements from above", house: 'cloud' },
                    { text: "Automation - creating golems to do repetitive work", house: 'code' },
                    { text: "Secret keeping - the art of unbreakable ciphers", house: 'key' },
                    { text: "Divination - seeing patterns others cannot perceive", house: 'eye' },
                    { text: "Shadow walking - moving unseen through forbidden places", house: 'dark-arts' }
                ]
            },
            {
                text: "What keeps you awake at night thinking?",
                answers: [
                    { text: "How to make distant systems communicate seamlessly", house: 'web' },
                    { text: "What threats exist that nobody has discovered yet", house: 'shield' },
                    { text: "How to build something more efficient and reliable", house: 'forge' },
                    { text: "An elegant algorithm to solve a persistent problem", house: 'script' },
                    { text: "How to architect systems that scale infinitely", house: 'cloud' },
                    { text: "Ways to automate away tedious manual processes", house: 'code' },
                    { text: "Whether current encryption will survive quantum computing", house: 'key' },
                    { text: "What anomalies in the data might indicate a larger problem", house: 'eye' },
                    { text: "What techniques attackers are developing that we don't know about", house: 'dark-arts' }
                ]
            },
            {
                text: "Which philosophical question resonates most with you?",
                answers: [
                    { text: "How do we connect every person on Earth?", house: 'web' },
                    { text: "Can absolute security ever truly exist?", house: 'shield' },
                    { text: "What are the limits of what we can physically build?", house: 'forge' },
                    { text: "Can machines ever truly think like humans?", house: 'script' },
                    { text: "Should computing resources be unlimited for everyone?", house: 'cloud' },
                    { text: "Can every process in the world be automated?", house: 'code' },
                    { text: "Is privacy a fundamental right in the digital age?", house: 'key' },
                    { text: "Can we ever truly understand complex systems?", house: 'eye' },
                    { text: "Must one understand destruction to truly protect?", house: 'dark-arts' }
                ]
            },
            {
                text: "You have unlimited resources for one project. What do you create?",
                answers: [
                    { text: "A global mesh network with no single point of failure", house: 'web' },
                    { text: "An impenetrable digital fortress protecting critical infrastructure", house: 'shield' },
                    { text: "A self-repairing data center that runs for centuries", house: 'forge' },
                    { text: "An AI system that writes and maintains perfect code", house: 'script' },
                    { text: "Unlimited computing power accessible to everyone on Earth", house: 'cloud' },
                    { text: "A platform that lets anyone build software without coding", house: 'code' },
                    { text: "Quantum-resistant encryption protecting all communications", house: 'key' },
                    { text: "An all-seeing system that predicts problems before they occur", house: 'eye' },
                    { text: "A research lab to study malware and develop countermeasures", house: 'dark-arts' }
                ]
            },
            {
                text: "What aspect of the digital world do you find most beautiful?",
                answers: [
                    { text: "The way packets find their path across continents in milliseconds", house: 'web' },
                    { text: "The mathematical elegance of encryption algorithms", house: 'shield' },
                    { text: "The precise engineering of a well-designed circuit board", house: 'forge' },
                    { text: "The logic of a perfectly structured codebase", house: 'script' },
                    { text: "Services that scale from zero to millions seamlessly", house: 'cloud' },
                    { text: "A pipeline that deploys code automatically and safely", house: 'code' },
                    { text: "The unbreakable mathematics behind PKI and digital signatures", house: 'key' },
                    { text: "Dashboards that turn chaos into understandable patterns", house: 'eye' },
                    { text: "The ingenuity of exploits that find impossible weaknesses", house: 'dark-arts' }
                ]
            },
            {
                text: "If technology ceased to exist tomorrow, what role would you take?",
                answers: [
                    { text: "Messenger or diplomat - keeping communities connected", house: 'web' },
                    { text: "Guardian or sentinel - protecting people from threats", house: 'shield' },
                    { text: "Builder or engineer - constructing essential infrastructure", house: 'forge' },
                    { text: "Scribe or scholar - documenting and systematizing knowledge", house: 'script' },
                    { text: "Merchant - providing resources where they're needed most", house: 'cloud' },
                    { text: "Inventor - creating tools to make work more efficient", house: 'code' },
                    { text: "Keeper of secrets - protecting sensitive information", house: 'key' },
                    { text: "Oracle - interpreting signs and advising leaders", house: 'eye' },
                    { text: "Spy or infiltrator - gathering intelligence from the shadows", house: 'dark-arts' }
                ]
            },
            {
                text: "What's your relationship with failure?",
                answers: [
                    { text: "It reveals where connections are weakest", house: 'web' },
                    { text: "It's data about what attacks succeeded", house: 'shield' },
                    { text: "It shows me which parts need better engineering", house: 'forge' },
                    { text: "It's a bug to be traced, understood, and eliminated", house: 'script' },
                    { text: "It means I need better redundancy and failover", house: 'cloud' },
                    { text: "It's a chance to improve my automation pipeline", house: 'code' },
                    { text: "It reveals weaknesses in my trust model", house: 'key' },
                    { text: "It's an anomaly that should have triggered an alert", house: 'eye' },
                    { text: "It's a lesson in what worksâ€”knowledge for the next attempt", house: 'dark-arts' }
                ]
            },
            {
                text: "Which historical figure would you want as a mentor?",
                answers: [
                    { text: "Vint Cerf - architect of the internet protocols", house: 'web' },
                    { text: "Alan Turing - who broke unbreakable codes", house: 'shield' },
                    { text: "Nikola Tesla - inventor of revolutionary hardware", house: 'forge' },
                    { text: "Ada Lovelace - the first programmer", house: 'script' },
                    { text: "Werner Vogels - architect of AWS cloud computing", house: 'cloud' },
                    { text: "Linus Torvalds - creator of Linux and Git", house: 'code' },
                    { text: "Whitfield Diffie - inventor of public key cryptography", house: 'key' },
                    { text: "John Tukey - pioneer of data analysis and visualization", house: 'eye' },
                    { text: "Kevin Mitnick - who understood systems by breaking them", house: 'dark-arts' }
                ]
            },
            {
                text: "Your team faces an impossible deadline. What's your contribution?",
                answers: [
                    { text: "Coordinate everyone and keep information flowing smoothly", house: 'web' },
                    { text: "Ensure we don't create vulnerabilities in the rush", house: 'shield' },
                    { text: "Get the physical infrastructure running flawlessly", house: 'forge' },
                    { text: "Write efficient code that does more with less", house: 'script' },
                    { text: "Provision cloud resources to parallelize the work", house: 'cloud' },
                    { text: "Automate the repetitive tasks so we can focus on the hard stuff", house: 'code' },
                    { text: "Make sure authentication and authorization are airtight", house: 'key' },
                    { text: "Set up monitoring so we know immediately if something breaks", house: 'eye' },
                    { text: "Find shortcuts others wouldn't considerâ€”unconventional solutions", house: 'dark-arts' }
                ]
            },
            {
                text: "What's the most dangerous thing in technology?",
                answers: [
                    { text: "A single point of failure that brings everything down", house: 'web' },
                    { text: "Trust in systems that haven't been properly vetted", house: 'shield' },
                    { text: "Building on foundations that aren't solid", house: 'forge' },
                    { text: "Code that nobody understands but everyone depends on", house: 'script' },
                    { text: "Vendor lock-in that traps you with one provider", house: 'cloud' },
                    { text: "Manual processes that can't scale with demand", house: 'code' },
                    { text: "Weak encryption that gives false sense of security", house: 'key' },
                    { text: "Blind spots where problems grow undetected", house: 'eye' },
                    { text: "Defenders who don't understand how attackers think", house: 'dark-arts' }
                ]
            },
            {
                text: "When you explain something technical, how do you approach it?",
                answers: [
                    { text: "Draw diagrams showing how everything connects", house: 'web' },
                    { text: "Explain the risks and how to protect against them", house: 'shield' },
                    { text: "Show the physical components and how they interact", house: 'forge' },
                    { text: "Walk through the logic step by step", house: 'script' },
                    { text: "Demonstrate by spinning up a live example in minutes", house: 'cloud' },
                    { text: "Share a script that automates the whole process", house: 'code' },
                    { text: "Explain the trust boundaries and verification methods", house: 'key' },
                    { text: "Show the metrics and what they tell us about system health", house: 'eye' },
                    { text: "Demonstrate by showing how an attacker would see it", house: 'dark-arts' }
                ]
            },
            {
                text: "If you could solve one global technology challenge, which would it be?",
                answers: [
                    { text: "Bringing reliable connectivity to every person on Earth", house: 'web' },
                    { text: "Eliminating cyber threats and online crime", house: 'shield' },
                    { text: "Creating sustainable, long-lasting hardware", house: 'forge' },
                    { text: "Making programming accessible to everyone", house: 'script' },
                    { text: "Providing unlimited computing to developing nations", house: 'cloud' },
                    { text: "Automating away all the world's tedious work", house: 'code' },
                    { text: "Giving everyone true privacy in the digital age", house: 'key' },
                    { text: "Making sense of the world's data to solve big problems", house: 'eye' },
                    { text: "Training defenders to truly understand the adversary mindset", house: 'dark-arts' }
                ]
            },
            {
                text: "What legacy do you want to leave in the tech world?",
                answers: [
                    { text: "Infrastructure that connects generations", house: 'web' },
                    { text: "A safer digital world for everyone", house: 'shield' },
                    { text: "Innovations in hardware that outlast me", house: 'forge' },
                    { text: "Code and tools that empower others to create", house: 'script' },
                    { text: "Platforms that democratize access to computing power", house: 'cloud' },
                    { text: "Automation frameworks that make developers more productive", house: 'code' },
                    { text: "Cryptographic standards that protect privacy forever", house: 'key' },
                    { text: "Analytics systems that help humanity understand itself", house: 'eye' },
                    { text: "Knowledge of threats that helps defenders stay ahead", house: 'dark-arts' }
                ]
            }
        ];

        // Quiz state
        let currentQuestion = 0;
        let scores = {};
        Object.keys(houses).forEach(h => scores[h] = 0);

        // Initialize Digital Life
        document.addEventListener('DOMContentLoaded', function() {
            const digitalLife = DigitalLife.createAmbient();
            digitalLife.init(document.body);

            // Add floating sound toggle
            const soundToggle = new SoundToggle(digitalLife, {
                position: 'bottom-right',
                margin: 25
            });
            soundToggle.init();

            document.getElementById('totalQ').textContent = questions.length;
            showQuestion();
        });

        function showQuestion() {
            const q = questions[currentQuestion];

            document.getElementById('questionNumber').textContent =
                'QUESTION ' + toRoman(currentQuestion + 1);
            document.getElementById('questionText').textContent = q.text;
            document.getElementById('currentQ').textContent = currentQuestion + 1;

            const progress = ((currentQuestion) / questions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';

            // Shuffle answers for variety
            const shuffledAnswers = [...q.answers].sort(() => Math.random() - 0.5);

            const answersDiv = document.getElementById('answers');
            answersDiv.innerHTML = '';

            shuffledAnswers.forEach((answer, index) => {
                const btn = document.createElement('div');
                btn.className = 'answer';
                btn.textContent = answer.text;
                btn.onclick = () => selectAnswer(answer.house);
                answersDiv.appendChild(btn);
            });

            // Re-animate card
            const card = document.getElementById('questionCard');
            card.style.animation = 'none';
            card.offsetHeight; // Trigger reflow
            card.style.animation = 'fadeIn 0.5s ease forwards';
        }

        function selectAnswer(house) {
            // Add point to selected house
            scores[house]++;

            // Visual feedback
            event.target.classList.add('selected');

            // Next question after brief delay
            setTimeout(() => {
                currentQuestion++;
                if (currentQuestion < questions.length) {
                    showQuestion();
                } else {
                    showResult();
                }
            }, 350);
        }

        function showResult() {
            // Find highest scoring house
            let maxScore = 0;
            let resultHouse = 'web';

            Object.entries(scores).forEach(([house, score]) => {
                if (score > maxScore) {
                    maxScore = score;
                    resultHouse = house;
                }
            });

            // Store result
            localStorage.setItem('hexworth_house', resultHouse);

            // Hide question, show result
            document.getElementById('questionCard').style.display = 'none';
            document.querySelector('.progress-container').style.display = 'none';

            const house = houses[resultHouse];
            document.getElementById('resultCrest').textContent = house.crest;
            document.getElementById('resultHouse').textContent = house.name.toUpperCase();
            document.getElementById('resultDomain').textContent = house.domain;
            document.getElementById('resultDescription').textContent = house.description;

            // Apply house color class
            document.getElementById('resultContainer').classList.add(`house-${resultHouse}`);
            document.getElementById('resultContainer').classList.add('show');
        }

        function enterHouse() {
            // Navigate to the house dashboard with transition
            PageTransition.navigateTo('dashboard.html', 'magic');
        }

        function toRoman(num) {
            const roman = ['I', 'II', 'III', 'IV', 'V', 'VI', 'VII', 'VIII', 'IX', 'X', 'XI', 'XII', 'XIII', 'XIV', 'XV'];
            return roman[num - 1] || num;
        }
    </script>
</body>
</html>
